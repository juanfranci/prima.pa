define("odsp-next/roots/odc/OneDriveNext",["require","exports","tslib","@ms/odc-core/lib/Init","../../roots/odc/OneDrivePrefetch","../../utilities/features/Features","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/Navigation"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.default();var a=i.resources,f=new u.default;a.expose(o.navigation,f);n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return s.isFeatureEnabled(s.UseItemsScopeInOneDrive)?[4,new Promise(function(t,n){e(["./OneDriveNextWithItemsScopeApp"],t,n)})]:[3,2];case 1:(0,t.sent().initialize)(a);return[3,4];case 2:return[4,new Promise(function(t,n){e(["./OneDriveNextApp"],t,n)})];case 3:(0,t.sent().initialize)(a);t.label=4;case 4:return[2]}})})});
define("@ms/odc-core/lib/Init",["require","exports","tslib","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/PageInit","@ms/odsp-utilities/lib/aria/AriaLogger","./AriaContext","./Tenants","@ms/odsp-utilities/lib/logging/ManagerExtended","@ms/odsp-utilities/lib/logging/UnhandledErrorHandler","@ms/odsp-utilities/lib/logging/RequireJSErrorHandler","@ms/odsp-utilities/lib/logging/PromiseErrorHandler","@ms/odsp-utilities/lib/logging/ErrorUI","@ms/odsp-utilities/lib/logging/QOEHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=2048,f=/authkey=[!a-zA-Z0-9%]*/gi,l=/authkey/gi;0;function c(e,t){if(!l.test(t)){if(e){(e+="").length>a&&(e=e.substring(0,a));e=e.replace(f,"")}return e}}r.Manager.cleanString=c;Object.getPrototypeOf(r.Manager).cleanString=c;t.default=function(e){void 0===e&&(e={});i.default.init();var t=o.getAriaInfo(),r=t.ariaEnvironment,a=t.ariaContext;s.default.Init("prod"===r?u.ODCTenantTokens.prod:u.ODCTenantTokens.ppe,n.__assign(n.__assign({},a),{context:e.context}))}});
define("@ms/odsp-utilities/lib/logging/PageInit",["require","exports","./events/PageInit.event","./ManagerExtended"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=(function(){function e(){}e.init=function(){r||(r=n.PageInit.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return r};return e})();t.default=i});
define("@ms/odsp-utilities/lib/logging/events/PageInit.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PageInit=n.createSingleEvent({eventName:"PageInit,",shortEventName:"PageInit",requiresParent:!1},{screenWidth:2,screenHeight:2,availableScreenWidth:2,availableScreenHeight:2,renderWidth:2,renderHeight:2,browserWidth:2,browserHeight:2,devicePixelRatio:2,referrer:1});t.default=t.PageInit});
define("@ms/odsp-utilities/lib/logging/ManagerExtended",["require","exports","@ms/telemetry-manager/lib/Manager","../features/Features","@ms/telemetry-manager/lib/ManagerExtended"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addFeatureEnabler(function(e){return r.default.isFeatureEnabled(e)})});
define("@ms/telemetry-manager/lib/ManagerExtended",["require","exports","./Manager","./EventBase","./events/ValidationError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addValidationErrorLogger(function(e,t){var s=r.ValidationErrorType[t];i.ValidationError.enabled()&&i.ValidationError.logData({message:"Validation error for "+e.shortEventName+" of type "+s,validatedEventName:e.shortEventName,validatedFullEventName:e.eventName,validationType:s,stack:n.Manager.getStack()||""},e)})});
define("@ms/telemetry-manager/lib/events/ValidationError.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=n.createSingleEvent({eventName:"ValidationError,",shortEventName:"ValidationError",samplingFeature:{ODB:-1,ODC:"ValidationErrorSampling",Fallback:!1},critical:!0,requiresParent:!1},{message:1,validationType:1,validatedEventName:1,validatedFullEventName:1,stack:1,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredDiagnostic"})});
define("@ms/odsp-utilities/lib/aria/AriaLogger",["require","exports","../features/Features","./AriaLoggerCore"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(){return new Promise(function(t,n){e(["aria"],t,n)})}var s=(function(){function e(){}e.Init=function(e,t,s){void 0===s&&(s=i);(t.forceEnabled||n.default.isFeatureEnabled(this.EnableAriaLogging))&&s().then(function(n){r.default.Init(e,t,n)},function(e){})};Object.defineProperty(e,"logStartEvents",{get:function(){return r.default.logStartEvents},set:function(e){r.default.logStartEvents=e},enumerable:!0,configurable:!0});e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,r=Math.floor(t/60);return(e>0?"-":"+")+(r>=10?r:"0"+r)+":"+(n>=10?n:"0"+n)};e.EnableAriaLogging={ODB:588,ODC:"EnableAriaLogging",Fallback:!1};return e})();t.default=s});
define("@ms/odsp-utilities/lib/aria/AriaLoggerCore",["require","exports","tslib","../logging/EventBase","../logging/Manager","../logging/events/Beacon.event","../logging/ErrorHelper","../browser/PlatformDetection","../logging/DataCompletenessInfo","../uri/SimpleUri","@ms/telemetry-addon-aria/lib/AriaTelemetryHandler","@ms/telemetry-addon-aria/lib/decorators/withPrivacyClassification","../async/Promise"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,d={logStartEvents:!1,Init:function(e,t,n,r){void 0===r&&(r={});try{d.logStartEvents=!0;var u=m(t,r.platformDetection),l=new f.SimpleUri(t.completenessCallbackEndpoint),c={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,callbackEndpoint:l},g=(p=new v({ariaLoader:function(){return h.default.resolve(n)},context:u,tenantToken:e,disableCookies:t.disableCookies,logStartEvents:d.logStartEvents,ariaQos:{isQosEvent:function(e){return s.Beacon.isTypeOf(e)&&!!e.data&&"AriaBeacon"===e.data.name},reportQos:function(e){var t=e.result,n=e.statusCode,r=e.events;new s.Beacon({name:"AriaBeacon",retryCount:0,totalRetries:0,eventCount:r?r.length:0}).end({success:0===t,status:n+""});0;""!==l.authority&&new a.DataCompletenessInfo(c,t,n,(new Date).getTime(),r).send()}}})).attach(i.Manager);return function(){g();p=void 0}}catch(e){e instanceof n.Exception&&(e=new Error("Aria error: "+e.toString()));o.default.log(e);p=void 0;return function(){}}},updateContext:function(e,t){void 0===t&&(t={});if(p){var n=m(e,t.platformDetection);p.updateContext(n)}},isInitialized:function(e){return!!p}};t.default=d;var v=c.withPrivacyClassification("requiredService")(l.AriaTelemetryHandler);function m(e,t){void 0===t&&(t=new u.default);var i=n.__assign({AccountType:r.AccountType[e.accountType],BrowserIsMobile:t.isMobile,BrowserMajVer:t.browserMajor,BrowserMinVer:t.browserMinor,BrowserName:t.browserName,BrowserUserAgent:t.userAgent,Environment:e.environment,FarmLabel:e.farmLabel,IsAuthenticated:e.isAuthenticated?1:0,Market:e.market,Manifest:e.manifest,OSName:t.osName,OSVersion:t.osVersion,Session:e.session,SiteSubscriptionId:e.siteSubscriptionId||"",UserId:e.userId,Version:e.version,Workload:e.workload,SiteId:e.siteId,WebId:e.webId,WebTemplateId:e.webTemplateId},e.context||{});e.farmLabel&&(i.FarmLabel=e.farmLabel);return i}});
define("@ms/odsp-utilities/lib/logging/events/Beacon.event",["require","exports","../PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Beacon=n.createPairedEvent({eventName:"Beacon,",shortEventName:"Beacon",requiresParent:!1},{name:1,status:1,success:3,retryCount:2,totalRetries:2,eventCount:2});t.default=t.Beacon});
define("@ms/odsp-utilities/lib/logging/DataCompletenessInfo",["require","exports","../xhr/XHR","./ErrorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var s={};if(i)for(var o=0;o<i.length;++o)s[i[o].EventType]=s[i[o].EventType]+1||1;var u={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:r,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:s,Workload:e.workload||"",FarmLabel:e.farmLabel||""};this._dataCompletenessJson=JSON.stringify(u)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!0,configurable:!0});e.prototype.send=function(){new n.default({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){0})};return e})();t.DataCompletenessInfo=i});
define("@ms/odsp-utilities/lib/xhr/XHR",["require","exports","../async/Async","../logging/ErrorHelper","../object/ObjectUtil"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.blocked=0]="blocked";e[e.exception=-1]="exception";e[e.timeout=-2]="timeout";e[e.abort=-3]="abort"})(t.XHRStatus||(t.XHRStatus={}));var s=(function(){function e(t){this._async=new n.default(this);var r=t.url,i=t.requestTimeoutInMS,s=void 0===i?e.DEFAULT_TIMEOUT_MS:i,o=t.json,u=t.responseType,a=void 0===u?"":u,f=t.headers,l=void 0===f?{}:f,c=t.withCredentials,h=void 0!==c&&c,p=t.needsCors,d=void 0!==p&&p,v=t.onProgress,m=t.onUploadProgress,g=t.method,y=void 0===g?o?"POST":"GET":g;this._url=r;this._requestTimeoutInMS=s;this._postData=o;this._headers=l;this._method=y;this._withCredentials=h;this._needsCors=d;this._responseType=a;this._progressCallback=v;this._uploadProgressCallback=m}e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};e.prototype.start=function(e,t){var n=this;this._successCallback=e;this._failureCallback=t;var s=this._method,o=this._headers;try{this._request=this._getRequest();var u=this._progressCallback,a=this._uploadProgressCallback,f=this._request,l=this._responseType;u&&(f.onprogress=function(e){try{u(e)}catch(e){r.default.logError(e)}});a&&(f.upload.onprogress=function(e){try{a(e)}catch(e){r.default.logError(e)}});this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS);f.onreadystatechange=function(){if(!n._completed){var e=4;try{e=f.DONE||4}catch(e){}f.readyState===e&&n._requestEndCallback()}};f.open(s,this._url,!0);"withCredentials"in f&&(f.withCredentials=this._withCredentials);f.responseType=l;for(var c in o)f.setRequestHeader(c,o[c]);f.send(this._postData)}catch(e){r.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:i.safeSerialize(o),method:s});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};e.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){r.default.log(e)}};e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){r.default.log(e)}};e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1;r.default.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}};e.DEFAULT_TIMEOUT_MS=3e4;return e})();t.default=s});
define("@ms/telemetry-addon-aria/lib/AriaTelemetryHandler",["require","exports","tslib","@ms/telemetry-manager/lib/EventBase","./AriaEventBuilder","@ms/telemetry-manager/lib/ErrorHelper","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e){var t=this;this.logEvent=function(e){var n=t._onLogEvent?t._onLogEvent(e):e;t._createLogHandler().then(function(e){return e(n)})};this._getAria=f(function(){return e.ariaLoader().then(function(t){(function(e,t){if(!e.LogManager.isInitialized()){e.LogManager.initialize(t.tenantToken,n.__assign(n.__assign({disableCookies:t.disableCookies},t.offlineCache?{browserOverrides:{onGetData:t.offlineCache.getData,onSaveData:t.offlineCache.saveData}}:{}),t.ariaLogConfiguration||{}));"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(){e.LogManager.flush()})}e.LogManager.addCallbackListener(function(e,n,r,i){r===t.tenantToken&&t.ariaQos&&t.ariaQos.reportQos({result:e,statusCode:n,events:i})})})(t,e);return t})});this._getLogger=f(function(){return t._getAria().then(function(t){return[(function(e,t,n){void 0===n&&(n={});var r=new e.Logger(t);a(r,n);return r})(t,e.tenantToken,e.context),t]})});this._createLogHandler=f(function(){return t._getLogger().then(function(t){var n=t[0];return(function(e,t,n,o){void 0===n&&(n=!0);void 0===o&&(o=void 0);return function(u){try{if(u.enabled&&(u.eventType!==r.ClonedEventType.Start||n)&&(!o||!o.isQosEvent(u))){var a=i.buildAriaEvent(e,u);t.logEvent(a)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: "+t.toString()));t&&t.handled||s.log(f||t)}}})(t[1],n,e.logStartEvents,e.ariaQos)})});this._onLogEvent=e.onLogEvent}e.prototype.attach=function(e){this._createLogHandler();var t=this.logEvent;e.addLogHandler(t).forEach(t);return function(){return e.removeLogHandler(t)}};e.prototype.updateContext=function(e){this._getLogger().then(function(t){return a(t[0],e)})};return e})();t.AriaTelemetryHandler=u;function a(e,t){var r=t.Session,i=t.Version,s=t.OSName,u=t.OSVersion,a=t.Market,f=t.UserId,l=t.Manifest,c=n.__rest(t,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),h=e.getSemanticContext();r&&e.setContext("AppInfo.Session",r);l&&e.setContext("AppInfo.Manifest",l);i&&h.setAppVersion(i);h.setUserLanguage(a||"");f&&h.setUserId(f);s&&h.setDeviceOsName(s);u&&h.setDeviceOsVersion(u);for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var d=c[p];if(null==d)continue;var v=o.capitalize(p);e.setContext(v,c[p])}}function f(e){var t=void 0;return function(){t||(t=e());return t}}});
define("@ms/telemetry-addon-aria/lib/AriaEventBuilder",["require","exports","@ms/telemetry-manager/lib/EventBase","@ms/utilities-strings/lib/index","@ms/telemetry-manager/lib/ErrorHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e){var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:n.ClonedEventType[e.eventType]};e.eventType===n.ClonedEventType.End&&(t.Duration=e.endTime-e.startTime);for(var i=e.eventName.split(","),s=0,o=i;s<o.length;s++){var u=o[s];u&&(t["WebLog_Type_"+u]=1)}var a=e.data,f=e.context;if(f)for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l)){if(null==(h=f[l]))continue;t[d=r.capitalize(l)]=h}if(a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var h;if(null==(h=a[c]))continue;var p=e.metadata[c];if(p){var d=p.isPrefixingDisabled?r.capitalize(c):r.capitalize(p.definedInName)+"_"+c,v=p.type;if(4===v){for(var m in h)if(Object.prototype.hasOwnProperty.call(h,m)){var g=h[m];if(null!=g&&""!==g){var y=void 0;if("object"==typeof g)try{y=JSON.stringify(g)}catch(e){y=g}else y=g;t[d+"_"+m.replace(".","_")]=y}}}else t[d]=6===v?p.typeRef[h]:h}}return{name:e.isEventTypePrefixingDisabled?i[i.length-2]:"ev_"+i[i.length-2],values:t}}t.getAriaEventInfo=s;t.buildAriaEvent=function(e,t){var n=s(t),r=n.name,o=n.values,u=new e.EventProperties;u.name=r;(function(e,t,n){var r;try{for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){r=s;t.setProperty(s,n[s])}}catch(t){var o=void 0,u=void 0;if(t instanceof e.Exception){o=t.ErrorCode();u=new Error("Aria error: "+t.toString())}if(u){t.handled=!0;i.logError(u,{errorCode:o,propertyKey:r})}throw t}})(e,u,o);return u}});
define("@ms/telemetry-addon-aria/lib/decorators/withPrivacyClassification",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withPrivacyClassification=function(e){return function(t){var r="function"==typeof e?e:function(){return e};return(function(e){n.__extends(t,e);function t(t){var i=t.onLogEvent;return e.call(this,n.__assign(n.__assign({},t),{onLogEvent:function(e){var t=i?i(e):e;if(t.data)return n.__assign(n.__assign({},t),{data:n.__assign(n.__assign({},t.data),{privacyClassification:r(t)})})}}))||this}return t})(t)}}});
define("@ms/odc-core/lib/AriaContext",["require","exports","@ms/odsp-utilities/lib/logging/EventBase","./PageConfig"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window.Flight,s=i.UserGroup&&i.UserGroup.toLowerCase(),o="dev"!==i.version&&("df"===s||"prod"===s),u=i.version,a=i.manifest,f="ODC_"+i.UserGroup,l=o?"prod":"ppe",c={isAuthenticated:r.default.isAuthenticated(),market:r.default.getMarket(),session:i.session,version:u,manifest:a,userId:r.default.isAuthenticated()&&"0"!==i.cid?i.cid:i.xid,accountType:r.default.isAuthenticated()?n.AccountType.Consumer:n.AccountType.ConsumerAnonymous,environment:f,workload:"ODC",disableCookies:!r.default.isAuthenticated()};t.getAriaInfo=function(){return{version:u,manifest:a,appEnvironment:f,ariaEnvironment:l,ariaContext:c}}});
define("@ms/odc-core/lib/PageConfig",["require","exports","cookies"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e.ANON_ID_COOKIE_KEY="ANON";e.getAnid=function(){var t=n.get(e.ANON_ID_COOKIE_KEY),r="";if(t)for(var i=t.split("&"),s=0;s<i.length;s++){var o=i[s];0===o.indexOf("A=")&&o.length>2&&(r=o.substr(2,o.length))}return r};e.getMarket=function(){return $Config.mkt};e.getLanguage=function(){return $Config.lang};e.isNewUser=function(){return 0===FilesConfig.freRenderIndex};e.isAuthenticated=function(){return $Config.isAuthenticated||window.FilesConfig&&!FilesConfig.si}})(r||(r={}));t.default=r});
define("@ms/odc-core/lib/Tenants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ODCTenantTokens={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}});
define("@ms/odsp-utilities/lib/logging/UnhandledErrorHandler",["require","exports","./events/UnhandledError.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MAXERRORS=100;var r=0;function i(e){var t;if(e){var n=e&&e.toString?e.toString():"InvalidMethod()",r=8===n.indexOf(" ")?9:0,i=n.indexOf(")")+1;if(0===(t=n.substring(r,i)).indexOf("function")||t.indexOf("(")<3){var s=i+50;t=(function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e})(n=n.replace(/\s\s*/g," "),s)+(s<n.length?"}":"")}}return t}function s(e,o,u,a,f){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,o,u,a,f])}catch(e){}var l=f&&f.stack,c=(function e(){var t,n=[];try{t=arguments.callee;for(;t===s||t===e;)t=t?t.caller:t}catch(e){t=null}var r=0;try{for(;t&&r<10;){n.push(i(t));t=t.caller;r++}}catch(e){}return n})().join("\n"),h={message:e,url:o,line:u,col:a,stack:l=l?l.replace(/[ \t]{2,}/g," "):"",builtStack:c=c.replace(/[ \t]{2,}/g," ")};r<t.MAXERRORS?n.UnhandledError.logData(h):r===t.MAXERRORS&&n.UnhandledError.logData({message:"Hit max error limit of "+t.MAXERRORS,url:"NA",line:0,col:0,stack:"",builtStack:""});r++}t.handleOnError=s;window.onerror=s});
define("@ms/odsp-utilities/lib/logging/events/UnhandledError.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledError=n.createSingleEvent({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0,requiresParent:!1},{message:1,stack:1,builtStack:1,line:2,col:2,url:1,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"});t.default=t.UnhandledError});
define("@ms/odsp-utilities/lib/logging/PromiseErrorHandler",["require","exports","./ErrorHelper","../async/Async","../async/Promise","../events/EventGroup","../object/ObjectUtil","../logging/events/UnhandledPromise.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new((function(){function e(){this._outstandingPromiseErrors={};this._async=new r.default}e.prototype.log=function(e){var t=this,r=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[r];else{this._outstandingPromiseErrors[r]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(e).forEach(function(t){var r=e[t],s=r.exception?r.exception:r.error;s instanceof Error||s&&s.stack?i.default.isCanceled(r)||n.default.log(s):u.UnhandledPromise.logData({message:"Promise with no error callback",extraData:o.safeSerialize(s)});if(window.console&&console.log){var a="Promise with no error callback:"+r.id;console.warn?console.warn(a):console.log(a);console.log(r);s&&s.stack&&console.log(s.stack)}})},0)}};return e})());new s.default(a).on(i.default,"error",a.log)});
define("@ms/odsp-utilities/lib/logging/events/UnhandledPromise.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledPromise=n.createSingleEvent({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise",samplingFeature:{ODB:!0,ODC:"UnhandledPromiseLogging",Fallback:!1},requiresParent:!1},{message:1,extraData:1}).withData({privacyClassification:"requiredService"});t.default=t.UnhandledPromise});
define("@ms/odsp-utilities/lib/logging/ErrorUI",["require","exports","./Manager","./events/UnhandledError.event","./events/CaughtError.event","./events/QosError.event","./events/RequireJSError.event","./events/ValidationError.event","./EventBase"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0});
define("@ms/odsp-utilities/lib/logging/events/CaughtError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/CaughtError.event","@ms/telemetry-manager/lib/events/CaughtError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.CaughtError});
define("@ms/odsp-utilities/lib/logging/events/QosError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/QosError.event","@ms/telemetry-manager/lib/events/QosError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.QosError});
define("@ms/odsp-utilities/lib/logging/events/ValidationError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/ValidationError.event","@ms/telemetry-manager/lib/events/ValidationError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ValidationError});
define("@ms/odsp-utilities/lib/logging/QOEHelper",["require","exports","./events/Qoe.event","./Manager","./events/Qos.event","./events/CaughtError.event","./events/RequireJSError.event","./events/UnhandledError.event","./events/PLT.event","./ErrorHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.AppLoad=0]="AppLoad";e[e.PLT=1]="PLT";e[e.SessionError=2]="SessionError"})(l=t.Stages||(t.Stages={}));var c=!1,h=!1,p=-1;function d(){p===l.SessionError-1&&y.markStage(l.SessionError)}function v(e){if(i.Qos.isTypeOf(e)){if(e.data.resultType===i.ResultTypeEnum.Failure){h=!0;d();c=!0}}else if(s.default.isTypeOf(e)||o.default.isTypeOf(e)||u.default.isTypeOf(e)){h=!0;d();c=!0}else if(a.default.isTypeOf(e)){y.markStage(l.PLT);c&&d()}}for(var m=0,g=r.Manager.addLogHandler(v);m<g.length;m++){v(g[m])}var y=(function(){function e(){}e.markStage=function(e){if(e-1===p||e===l.AppLoad){n.default.logData({stage:l[e],errorBeforeStage:c,errorDuringStage:h});h=!1;p=e}else try{throw new Error("Stage "+l[e]+" - "+e+" came out of order - previous stage "+l[p]+" - "+p)}catch(e){f.default.log(e)}};e.reset=function(){p=-1;c=!1;h=!1};return e})();t.default=y;y.markStage(l.AppLoad)});
define("@ms/odsp-utilities/lib/logging/events/Qoe.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Qoe=n.createSingleEvent({eventName:"Qoe,",shortEventName:"Qoe",requiresParent:!1},{stage:{isKey:!0,type:1},errorBeforeStage:3,errorDuringStage:3});t.default=t.Qoe});
define("@ms/odsp-shared/lib/utilities/navigation/Navigation",["require","exports","tslib","@ms/odsp-utilities/lib/beforeUnload/BeforeUnload","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/logging/events/Nav.event","./NavigationHelper","@ms/odsp-utilities/lib/scope/Scope"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.history,f=window.applicationCache,l=a&&!!a.pushState&&(!f||f.status===f.UNCACHED),c=(function(){function e(e){void 0===e&&(e={});this._viewParamsString="";this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t;this._performHashConversion=!n;this.viewParams={};this._scope=new u.default;this.beforeUnload=new r.default;this._scope.attach(this.beforeUnload);this._events=new i.default(this);this._events.declare("change");this._events.on(window,"hashchange",this._updateUrlState);this._events.on(window,"popstate",this._updateUrlState);this._updateUrlState(null)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)},null)){var n="string"==typeof e?{url:e}:e,r=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:null,s=e.hasOwnProperty("directOpen")?e.directOpen:null,o=void 0,u=void 0;if(i&&"#"===i[0]){o=i.substr(1);u=r}else{o="#"===r[0]?r.substr(1):null;u=null}if(o)n.ignoreHistory?this._replaceState(o,!1,u):this._pushState(o,u);else{var a=void 0,f=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{a=window.open(s?r:"",n.frameId);"_blank"===n.frameId&&(a.opener=null);s||(a.location.href=r);f=!0}catch(e){}if(!a&&!f)try{window.location.href=r}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?o.deserializeQuery(e):e,i=n.__assign(n.__assign({},t.clearOtherParams?{}:this.viewParams),r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,n=!1,r=window.document.location,i=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var u="";if(r.href.indexOf("#")>-1){u=r.hash.substr(1);i=!0}else r.search.length&&(u=r.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),f=o.deserializeQuery(u),c=o.deserializeQuery(a),h=c,p=a;for(var d in f)if(c[d]!==f[d]){h=f;p=u;break}if(p!==this._viewParamsString){this._viewParamsString=p||"";this.viewParams=h;n=!0}i&&this._performHashConversion&&l&&this._replaceState(p);if(n){s.Nav.logData({url:r.href,viewParams:this.viewParams});this._events.raise("change")}this._prevHash=r.hash}else{n=!1;e&&e.preventDefault()}return n};e.prototype._tryGetViewParamsBasedOnState=function(e){var t=null;if(e&&"popstate"===e.type&&e.state){var n=e.state,r=n.useViewParamsFromState,i=n.viewParams;r&&i&&(t=this._getViewParamsString(i))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(l)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(l)try{history.pushState({},null,this._getStateUrl(n))}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(null);t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,n){var r=this._getViewParamsString(e);if(l)try{history.replaceState({},null,this._getStateUrl(r,t))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState(null);n&&this._setMaskUrl(n)};e.prototype._setMaskUrl=function(e){if(e&&l){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,null,e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:o.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(e.length>0?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e})();t.Navigation=c;t.default=c});
define("@ms/odsp-utilities/lib/beforeUnload/BeforeUnload",["require","exports","../logging/ErrorHelper","../async/Async"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){this._localHandlers=[]}e.init=function(){var e=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)}}};e.registerHandler=function(e){this._handlers.push(e)};e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var r=0;r<this._handlers.length;r++)try{if(t=this._handlers[r](!0))break}catch(e){n.default.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){n.default.log(e)}}return t||void 0};e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};e.prototype.allowHashNav=function(t,r){var i=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var s=0;s<e._handlers.length;s++)try{if(i=e._handlers[s](!1))break}catch(e){n.default.log(e)}if(i){e._isDialogOpen=!0;this._hashNavDialogCallback(i).then(function(){e._isDialogOpen=!1;e._allowNavs=!0;e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1;e._blockNavsAgainId=null}));t&&t()},function(){e._isDialogOpen=!1;r&&r()})}}return!i&&!e._isDialogOpen};e.prototype.registerHandler=function(t){this._localHandlers.push(t);e.registerHandler(t)};e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)};e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var r=n[t];e.unRegisterHandler(r)}};e._handlers=[];e._async=new r.default;e._initialized=!1;return e})();t.default=i;i.init()});
define("@ms/odsp-utilities/lib/logging/events/Nav.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Nav=n.createSingleEvent({eventName:"Nav,",shortEventName:"Nav"},{viewParams:4,url:1});t.default=t.Nav});
define("odsp-next/bindings/css/VisibilityBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.update=function(e,t){var r=n.unwrap(t());e.style.visibility=r?"inherit":"hidden"};return e})();t.default=r});
define("odsp-next/roots/odc/OneDriveNextApp",["require","exports","@ms/odsp-utilities/lib/auth/DomainAuthenticator","knockout","@ms/odsp-utilities/lib/resources/Resources","../../resources/ModelResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ODCResourceKeys","../../resources/LoggingResourceKeys","../../resources/ProviderResourceKeys","../../models/store/UserSettingsStore","../../models/store/UserInfoStore","../../dataSources/settings/odc/SettingsDataSource","../../dataSources/item/odc/ItemDataSource","../../dataSources/rootItems/RootItems.key","../../dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key","../../dataSources/restore/odc/RestoreOperationDataSource.key","../../dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key","../../dataSources/search/odc/SearchDataSource.key","../../dataSources/item/odc/RecycleBinDataSource","../../dataSources/language/odc/LanguageDataSource","../../dataSources/languagePicker/odc/LanguagePickerDataSource","../../dataSources/leftNav/odc/LeftNavDataSource","../../dataSources/peoplePicker/odc/PeoplePickerDataSource","../../dataSources/sharing/odc/SharingDataSource","../../dataSources/sharing/odc/SharingDataDataSource","../../dataSources/suiteNav/odc/SuiteNavDataSource","../../dataSources/mobileAppPath/odc/IOSMobilePathDataSource","../../dataSources/url/odc/UrlDataSource","../../dataSources/moduleLoader/ModuleLoaderDataSource.key","../../dataSources/moduleLoader/odc/ModuleLoaderDataSource","../../resources/UtilityResourceKeys","../../dataSources/download/odc/DownloadDataSource.key","../../dataSources/identity/odc/IdentityDataSource","../../dataSources/identity/odc/PWAAppIdentityDataSource","../../dataSources/userInfo/odc/UserInfoDataSource","../../dataSources/versionControl/VersionControlDataSource","../../dataSources/versionHistory/odc/VersionHistoryDataSource","../../dataSources/vault/odc/VaultDataSource.key","../../controls/vaultTeachingBubble/react/odc/VaultTeachingBubble.key","../../dataSources/album/odc/AlbumDataSource","../../dataSources/tag/odc/TagDataSource","../../dataSources/photo/odc/PhotoDataSource","../../resources/ControlResourceKeys","../../providers/instrumentation/InstrumentationProvider","@ms/odsp-utilities/lib/logging/events/Nav.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../utilities/logging/odc/CommonQos","../../dataSources/feedback/odc/FeedbackDataSource","../../dataSources/sendFeedback/odc/SendFeedbackDataSource","../../dataSources/userActivity/odc/UserActivityDataSource","../../providers/userActivity/UserActivityProvider","../../providers/feedback/FeedbackProvider","../../providers/embed/EmbedProvider","../../dataSources/embed/odc/EmbedDataSource","../../providers/userInfo/UserInfoProvider","../../providers/teachingBubble/TeachingBubbleProvider","../../providers/ransomwareDetection/RansomwareDetectionProvider","../../providers/tag/TagProvider","../../providers/photo/PhotoProvider","../../providers/storageInfo/StorageInfoProvider","../../providers/storageOptions/StorageOptionsProvider","../../providers/notification/NotificationProvider.key","../../providers/notificationManager/NotificationManager.key","../../dataSources/notifications/odc/NotificationsDataSource.key","../../dataSources/application/odc/ApplicationDataSource","../../dataSources/storageInfo/odc/StorageInfoDataSource","../../dataSources/storageOptions/odc/StorageOptionsDataSource","../../providers/subscriptions/SubscriptionsProvider","../../dataSources/subscriptions/vroom/SubscriptionsDataSource","../../providers/thumbnail/ThumbnailProvider","../../dataSources/instrumentation/odc/InstrumentationDataSource","../../dataSources/encoding/odc/EncodingDataSource","../../dataSources/videoItem/odc/VideoItemDataSource.key","../../dataSources/item/odc/MoveCopyDataSource","../../dataSources/upsell/odc/UpsellDataSource","../../providers/upsell/UpsellProvider","../../utilities/features/Features","../../utilities/features/PLTFeatures","../../actions/odc/ActionMap","../../dataSources/itemCommand/odc/ItemCommandDataSource","../../dataSources/processFilters/odc/ProcessFiltersDataSource","../../providers/processFilters/ProcessFiltersProvider","../../utilities/purchaseLogging/AwaHelper","../../controls/oneDriveApp/OneDriveApp","../../providers/winApp/xbox/DirectionalNavigation","../../utilities/experiment/ExperimentHelper","../../utilities/attribution/AttributionHelper","../../utilities/educationAndUpsells/EducationAndUpsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/teachingBubble/odc/TeachingBubbleDataSource","../../dataSources/recycleBin/odc/RecycleBinDataSource","../../providers/recycleBin/RecycleBinProvider","../../providers/dragAndDropRobot/DragAndDropRobotProvider","../../controls/overlayContent/NeedsOverlayContent.key","../../dataSources/winApp/wip/odc/WIPDataSource","../../controls/list/columns/ListColumns","@ms/odsp-utilities/lib/performance/PerformanceCollection","../../dataSources/pushChannel/odc/PushChannelDataSource.key","../../providers/pushChannel/PushChannelProvider.key","../../dataSources/rootItems/odc/RootItems.key","../../dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key","../../providers/itemAutoRefresh/ItemAutoRefreshProvider.key","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource.key","../../utilities/browser/WebViewDetector","../../dataSources/floodgate/FloodgateDataSource.key","../../dataSources/mruRecent/odc/MruRecentDataSource.key","../../dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper.key","../../dataSources/itemActivityFeed/helper/odc/ItemActivityFeedSharingHelper.key","../../dataSources/itemActivityFeed/odc/ItemCommentsDataSource.key","../../dataSources/checkUserAccess/CheckUserAccessDataSource.key","../../providers/winApp/communication/WinAppCommunicator.key","../../dataSources/winApp/communication/odc/WinAppCommunicatorDataSource.key","../../providers/winApp/keyboardHelper/WinAppKeyboardHelper.key","../../providers/quota/WinAppQuotaProvider.key","../../providers/profilechangehandler/ProfileChangeHandler.key","../../resources/FloodgateResourceKeys","@ms/odsp-datasources/lib/providers/theming/FabricCustomizations","../../dataSources/infoPane/InfoPaneManager.key","../../dataSources/infoPane/odc/InfoPaneManager.key","../../dataSources/item/odc/ItemMuteNotificationDataSource","../../utilities/dom/DomLoad","../../dataSources/firstRunExperience/odc/FirstRunExperienceDataSource.key","../../dataSources/firstRunExperience/FirstRunExperienceDataSource.key","../../utilities/logging/odc/RUMOneHelperFull","../../dataSources/url/odc/UrlDataSourceLite","../../dataSources/searchBox/SearchBoxDataSource.key","../../dataSources/searchBox/odc/ODCSearchBoxDataSource","../../dataSources/searchBox/SearchBoxConfig.key","../../dataSources/searchBox/odc/ODCSearchBoxConfig","../../dataSources/item/ItemCacheToKOStoreDataSource.key","../../dataSources/item/od/ItemCacheToKOStoreDataSource.key","../../controls/itemsScope/odc/DefaultClickActionControlHandler.key","../../dataSources/itemInvalidator/odc/ItemInvalidator.key","../../controls/itemsScope/ItemsScopeControlHandlerResourceKeys","../../controls/itemsScope/od/ItemsScopeControlHandlerResourceKeys","../../models/itemCache/ItemCacheConfiguration.key","../../models/itemCache/od/ItemCacheConfiguration.key","../../models/itemsScope/ItemsScopeAddon.key","../../models/itemsScope/od/ItemsScopeAddon.key","../../models/itemsScope/ItemsScopeKeyConverter.key","../../models/itemsScope/od/ItemsScopeKeyConverter.key","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider","ODCOneDrive_css","../../controls/FabricIconsDeferred","../../utilities/TestHooks"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se,xe,Te,Ne,Ce,ke,Le,Ae,Oe,Me,_e,De,Pe,He,Be,je,Fe,Ie,qe,Re,Ue,ze,We,Xe,Ve,$e,Je,Ke,Qe,Ge,Ye,Ze,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!window.$Config||$Config.aadClientId&&"live.com"===$Config.domain||"UnAuth"===$Config.cid||n.default.initializeAuthenticators([/^https?:\/\/(?:[A-Za-z0-9]*[.])*livefilestore(?:-int)?[.]com\//i,/^https?:\/\/(?:[A-Za-z0-9\-]*[.])*1drv(?:-int)?[.]com\//i],window.cookieToss);ze.default.mark("EUPL.ODCAppBoot.NewStart");t.initialize=function(t){ze.default.mark("EUPL.ODCAppBoot.Start");t.expose(s.userSettingsStore,new l.default({defaultRootItemId:"root",viewerId:L.default.viewerId}));t.expose(s.userInfoStore,new c.default);var n=new(t.injected(H.default));t.expose(o.userInfo,n);t.expose(f.userInfo,new(t.injected(te.default)));t.expose(M.experimentHelper,new(t.injected(_e.default)));t.expose(De.resourceKey,new(t.injected(De.default)));var Pt=new(t.injected(L.default)),Ht=t.consume(He.navigation);X.Nav.logData({url:location.href,viewParams:Ht.viewParams});Ht.viewParams&&"1"===Ht.viewParams.su?V.Engagement.logData({name:"SignUpCompletedODC"}):Ht.viewParams&&"1"===Ht.viewParams.gologin&&V.Engagement.logData({name:"SignInCompletedODC"});"/photos"===location.pathname&&Ht.updateViewParams({v:"photos"},{ignoreHistory:!0,clearPath:!0});t.exposeFactory(A.resourceKey,new i.AliasResourceFactory(O.resourceKey));t.expose(o.url,Pt);t.expose(u.urlDataSource,Pt);t.exposeFactory(o.itemActivityFeedHelper,new i.AliasResourceFactory(Ze.resourceKey));xe.isFeatureEnabled(xe.EnableNewCommentExperience)&&t.exposeFactory(o.itemCommentDataSource,new i.AliasResourceFactory(tt.resourceKey));if(xe.isFeatureEnabled(xe.EnableItemFeedAtMention)){t.exposeFactory(o.checkUserAccessDataSource,new i.AliasResourceFactory(nt.resourceKey));t.exposeFactory(o.itemActivityFeedSharingHelper,new i.AliasResourceFactory(et.resourceKey))}t.exposeFactory(o.itemMuteNotificationDataSource,new i.AliasResourceFactory(ht.resourceKey));if(Qe.isOneDriveWinApp()){t.exposeFactory(o.winAppCommunicator,new i.AliasResourceFactory(it.resourceKey));t.consumeAsync(rt.resourceKey.bypass);xe.isFeatureEnabled(xe.UseItemsScopeInOneDrive)||t.exposeFactory(o.identity,new i.AliasResourceFactory(P.resourceKey));t.consumeAsync(st.resourceKey);t.consumeAsync(ot.resourceKey);xe.isFeatureEnabled(xe.EnableDirectionalNavigationForXbox)&&Qe.isOneDriveXboxApp()&&Me.default.init()}else xe.isFeatureEnabled(xe.UseItemsScopeInOneDrive)||t.exposeFactory(o.identity,new i.AliasResourceFactory(D.resourceKey));t.exposeFactory(o.wip,new i.AliasResourceFactory(Re.resourceKey));var Bt=t.consume(f.bundleLoader);Bt.waitForPLT().then(function(){return Ae.default.init()});t.exposeFactory(o.subscriptions,new i.AliasResourceFactory(ve.resourceKey));t.expose(f.subscriptions,new(t.injected(de.default)));var jt=new(t.injected(p.default));t.expose(o.getItem,jt);t.expose(o.items,jt);t.expose(o.deleteRestore,jt);t.expose(o.schema,jt);t.expose(u.itemDataSource,jt);t.expose(o.storageInfo,new(t.injected(he.default)));t.expose(f.storageInfo,new(t.injected(oe.default)));t.expose(o.storageOptions,new(t.injected(pe.default)));t.expose(f.storageOptions,new(t.injected(ue.default)));t.expose(u.recycleBinDataSource,new(t.injected(b.default)));t.expose(z.useMobileList,!1);t.exposeFactory(o.search,new i.AliasResourceFactory(y.resourceKey));t.exposeFactory(o.ransomwareDetection,new i.AliasResourceFactory(v.resourceKey));t.exposeFactory(o.restore,new i.AliasResourceFactory(m.resourceKey));t.exposeFactory(o.restoreActivities,new i.AliasResourceFactory(g.resourceKey));t.exposeFactory(o.language,new i.AliasResourceFactory(w.resourceKey));t.exposeFactory(o.languagePicker,new i.AliasResourceFactory(E.resourceKey));t.expose(o.settings,new h.default);t.expose(Pe.resourceKey,new(t.injected(Pe.default)));t.expose(z.isGuidedTourVisible,r.observable(!1));t.expose(z.isPremiumUpsellVisible,r.observable(!1));t.expose(z.isVaultFreVisible,r.observable(!1));t.expose(z.hasSeenPositioningThisSession,r.observable(!1));t.expose(z.mobileUpsellDismissedThisSession,r.observable(!1));function Ft(e){return e.resourceKey}t.exposeAsync(o.graphUrl,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/graphUrl/GraphUrlDataSource"],t,n)}).then(Ft)}));t.exposeAsync(f.graphToken,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../providers/graphToken/GraphTokenProvider"],t,n)}).then(Ft)}));t.exposeAsync(o.peopleService,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/people/graph/PeopleDataSource"],t,n)}).then(Ft)}));t.exposeFactory(d.resourceKey,new i.AliasResourceFactory(Ve.resourceKey));t.expose(o.people,new(t.injected(x.default)));t.expose(o.suiteNav,new(t.injected(C.default))({}));t.expose(o.application,new(t.injected(ce.default)));t.expose(o.album,new(t.injected(q.default)));t.expose(o.tag,new(t.injected(R.default)));t.expose(o.iosMobileAppPath,new(t.injected(k.default)));t.exposeFactory(o.download,new i.AliasResourceFactory(_.resourceKey));t.expose(o.versionControl,new B.default);t.expose(o.versionHistory,new(t.injected(j.default)));t.exposeFactory(o.vault,new i.AliasResourceFactory(F.resourceKey));t.exposeFactory(z.vaultTeachingBubble,new i.AliasResourceFactory(I.resourceKey));t.expose(o.instrumentation,new(t.injected(ge.default)));t.expose(f.instrumentation,new(t.injected(W.default)));t.expose(o.sharing,new(t.injected(T.default)));t.expose(o.sharingData,new(t.injected(N.default)));t.expose(z.isDebugWindowVisible,r.observable(!0));t.expose(z.isItemSetRendered,r.observable(!1));t.expose(o.feedback,new(t.injected(J.default)));t.expose(f.feedback,new(t.injected(Y.default)));t.expose(o.sendFeedback,new(t.injected(K.default)));t.expose(o.embed,new(t.injected(ee.default)));t.expose(f.embed,new(t.injected(Z.default)));t.expose(o.userActivity,new(t.injected(Q.default)));t.expose(f.userActivity,new(t.injected(G.default)));if(!xe.isFeatureEnabled(xe.UseItemsScopeInOneDrive)){t.expose(z.viewParams,r.observable({}));t.exposeFactory(o.urlLite,new i.AliasResourceFactory(gt.resourceKey));t.expose(a.rumOneScenarioPrefix,"ODCNext");t.exposeFactory(a.rumOneHelper,new i.AliasResourceFactory(mt.resourceKey))}t.expose(o.copy,new(t.injected(we.default)));t.expose(o.teachingBubble,new(t.injected(Be.default)));t.exposeFactory(f.teachingBubble,new i.AliasResourceFactory(ne.resourceKey));t.exposeFactory(f.ransomwareDetection,new i.AliasResourceFactory(re.resourceKey));t.expose(o.photo,new(t.injected(U.default)));t.expose(f.photo,new(t.injected(se.default)));t.expose(o.processFilters,new(t.injected(ke.default)));t.expose(f.processFilters,new(t.injected(Le.default)));t.expose(f.tag,new(t.injected(ie.default)));t.exposeFactory(f.notification,new i.AliasResourceFactory(ae.resourceKey));t.expose(f.thumbnail,new(t.injected(me.default)));t.exposeAsync(o.ticketRedeemer,{load:function(){return new Promise(function(t,n){e(["../../dataSources/ticketRedeemer/odc/TicketRedeemerManager"],t,n)}).then(function(e){return{create:function(){return{instance:e}},dependencies:[]}})}});t.expose(o.encoding,new ye.default);t.exposeFactory(o.videoItem,new i.AliasResourceFactory(be.resourceKey));t.expose(o.upsell,new(t.injected(Ee.default))({}));t.expose(f.upsell,new(t.injected(Se.default))({}));t.expose(z.actionMap,new Ne.default);t.expose(o.itemCommand,new(t.injected(Ce.default)));t.expose(o.leftNav,new(t.injected(S.default)));t.expose(o.recycleBin,new(t.injected(je.default)));t.expose(f.recycleBin,new(t.injected(Fe.default)));t.expose(f.dragAndDropRobot,new(t.injected(Ie.default))({},{needsOverlayContent:t.consume(qe.resourceKey)}));t.expose(z.didUserUploadOrCreateFile,r.observable(!1));t.expose(z.didUserEnterPasswordForFile,r.observable(!1));t.exposeAsync(Ue.columnMenuHelperTypeResourceKey,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../controls/columnsHeader/SortColumnCommandHelper"],t,n)}).then(function(e){return e.typeResourceKey.local})}));t.exposeAsync(o.batchUploaderType,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/upload/odc/BatchUploader"],t,n)}).then(function(e){return e.typeResourceKey})}));t.exposeAsync(o.vroomItemIdentityProcessor,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/base/odc/vroom/ItemIdentityProcessor"],t,n)}).then(Ft)}));t.exposeAsync(o.graph,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/graph/odc/GraphDataSource"],t,n)}).then(Ft)}));t.exposeAsync(o.zip,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/zip/odc/ZipDataSource"],t,n)}).then(Ft)}));t.exposeAsync(o.worker,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/worker/odc/WorkerDataSource"],t,n)}).then(Ft)}));if(xe.isFeatureEnabled(xe.UseItemsScopeInAllPhotos)&&!xe.isFeatureEnabled(xe.UseItemsScopeInOneDrive)){t.exposeFactory(Lt.resourceKey,new i.AliasResourceFactory(At.resourceKey));t.exposeFactory(Ot.resourceKey,new i.AliasResourceFactory(Mt.resourceKey));t.exposeFactory(_t.resourceKey,new i.AliasResourceFactory(Dt.resourceKey))}if(xe.isFeatureEnabled(xe.EnableFloodgate)){t.expose(at.floodgateAppId,2160);t.exposeFactory(o.floodgate,new i.AliasResourceFactory(Ge.resourceKey));var It=Ht.viewParams;Bt.waitForPLT().then(function(){t.consume(f.instrumentation).userExecuteAction({name:"NewSession"});t.consumeAsync(Ge.resourceKey).then(function(e){e.processViewParams(It)})})}Bt.waitForPLT().then(function(){ft.applyDeferredFabricCustomizations()});if(xe.isFeatureEnabled(xe.QuotaBundleEnabled)){var qt=Bt.createDeferredContext(2);qt.expose(o.quota,function(){return new Promise(function(t,n){e(["../../dataSources/quota/odc/QuotaDataSource"],t,n)})});qt.expose(f.quota,function(){return new Promise(function(t,n){e(["../../providers/quota/UserStateProvider"],t,n)})})}xe.isFeatureEnabled(xe.LanguageProfileChange)&&Bt.waitForPLT().then(function(){t.consumeAsync(ut.resourceKey)});var Rt=Bt.createDeferredContext(4);t.exposeFactory(vt.resourceKey,new i.AliasResourceFactory(dt.resourceKey));Rt.expose(o.guidedTour,function(){return new Promise(function(t,n){e(["../../dataSources/guidedTour/odc/GuidedTourDataSource"],t,n)})});Bt.createDeferredContext(1);if(xe.isFeatureEnabled(xe.EnablePushChannel)){t.exposeFactory(o.pushChannel,new i.AliasResourceFactory(We.resourceKey));t.exposeFactory(o.itemAutoRefresh,new i.AliasResourceFactory($e.resourceKey));t.consumeAsync(xe.isFeatureEnabled(xe.EnablePushChannelAutoRefresh)?Je.resourceKey:Xe.resourceKey)}t.exposeFactory(o.inAppMessaging,new i.AliasResourceFactory(Ke.resourceKey));t.exposeFactory(o.notifications,new i.AliasResourceFactory(le.resourceKey));t.exposeFactory(f.notificationManager,new i.AliasResourceFactory(fe.resourceKey));t.exposeFactory(o.mruRecent,new i.AliasResourceFactory(Ye.resourceKey));if(xe.isFeatureEnabled(Te.OdcSuiteNavSearchBox)){t.exposeFactory(wt.resourceKey,new i.AliasResourceFactory(Et.resourceKey));t.exposeFactory(yt.resourceKey,new i.AliasResourceFactory(bt.resourceKey))}t.exposeFactory(St.resourceKey,new i.AliasResourceFactory(xt.resourceKey));t.exposeFactory(Ct.defaultClickHandler,new i.AliasResourceFactory(Tt.resourceKey));t.exposeFactory(Ct.itemSetColumns,new i.AliasResourceFactory(kt.itemSetColumns));t.exposeFactory(o.itemInvalidator,new i.AliasResourceFactory(Nt.resourceKey));t.exposeFactory(lt.typeResourceKey,new i.AliasResourceFactory(ct.typeResourceKey));$.logCDNFailOverQoS();pt.waitForDomLoad(function(e){e&&ze.default.mark("EUPL.ODCAppBoot.DOMContentLoaded");var n=document.createElement("div");document.body.appendChild(n);r.applyBindingsToNode(n,{component:{name:Oe.default.tagName,params:{resources:t}}});ze.default.mark("EUPL.ODCAppBoot.End")});window.__ko=r}});
define("@ms/odsp-utilities/lib/auth/DomainAuthenticator",["require","exports","../async/Promise","../async/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[],s=(function(){function e(e,t,n){this.complete=!1;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=n}e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var r=n.s,s=n.r,o=0;r&&o<r.length;o++)i.push(new e(t[o],r[o],!s[o]));n.c=function(e){i[e].onAuthComplete()};e.authenticate("https://livefilestore.com/");e.authenticate("https://1drv.com/")}};e.authenticate=function(e){for(var t,r=0;r<i.length;r++){var s=i[r];if(s.requiresAuth(e)){t=s.authenticate(e);break}}for(var o=[t||n.default.wrap(!0)],u=0,a=this._cookieCheckers;u<a.length;u++){var f=a[u];f.isApplicable(e)&&o.push(f.check(e))}return n.default.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new r.default;var n=document.createElement("IFRAME");n.src=this.iframeSrc;n.style.display="none";document.body.appendChild(n)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};e._cookieCheckers=[];return e})();t.default=s});
define("odsp-next/resources/ModelResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataStore=new n.ResourceKey("dataStore");t.userSettingsStore=new n.ResourceKey("userSettingsStore");t.userInfoStore=new n.ResourceKey("userInfoStore");t.smartFiltersStore=new n.ResourceKey("smartFiltersStore")});
define("odsp-next/resources/LoggingResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rumOneScenarioPrefix=new n.ResourceKey("RUMOneScenarioPrefix");t.rumOneHelper=new n.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new n.ResourceKey("rumOneEmbedVideoHelper");t.rumOneListsHomeHelper=new n.ResourceKey("rumOneListsHomeHelper")});
define("odsp-next/models/store/UserSettingsStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,"UserSettingsStore",i.default.local)||this;n._defaultRootItemId=t&&t.defaultRootItemId||"";n._viewerId=t&&t.viewerId||"";return n}t.prototype.setAllPhotosUserSettings=function(e){this.setValue(this._getLocalStorageKey(),e)};t.prototype.getAllPhotosUserSettings=function(){var e=this.getValue(this._getLocalStorageKey());if(!e){e={isAscending:!1,rootId:this._defaultRootItemId};this.setAllPhotosUserSettings(e);e=this.getValue(this._getLocalStorageKey())}return e};t.prototype._getLocalStorageKey=function(){return"allPhotosUserSettings&viewerId="+this._viewerId};return t})(r.default);t.default=s});
define("odsp-next/models/store/UserInfoStore",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/models/store/BaseDataStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return e.call(this,"UserInfoStore")||this}t.prototype.getUserInfo=function(){var e=this.getValue("userInfo");if(!e){e=r.observable(null);this.setValue("userInfo",e)}return e};return t})(i.default);t.default=s});
define("odsp-next/dataSources/settings/odc/SettingsDataSource",["require","exports","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=window.Flight,t=e&&e.Config,r=t&&t.odsp_media,i=r?"odsp-media/"+r+"/media":"odsp-media";n.default.addPaths({"@ms/odsp-media/lib":i});this.mediaBaseUrl=i};t.default=r});
define("@ms/odsp-utilities/lib/require/RequireConfigInjector",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.default=n});
define("odsp-next/dataSources/item/odc/ItemDataSource",["require","exports","tslib","./SkyApiItemDataSource","@ms/odsp-utilities/lib/async/Promise","../../url/QueryType","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(r,t);function r(){return null!==t&&t.apply(this,arguments)||this}r.prototype.getItem=function(e){var n,r=this._urlDataSource.getKeyParams(e.parentKey),i=this._urlDataSource.getQueryType(r);e.qosName=e.qosName||"Odc."+s.default[i]+".ItemDataSource.getItem";switch(i){case s.default.SharedWithMe:n=this._getSharedDataSource().then(function(t){return t.getItem(e)});break;case s.default.Recent:n=this._getRecentDataSource().then(function(t){return t.getItem(e)});break;case s.default.RecycleBin:n=this._getRecycleBinDataSource().then(function(t){return t.getItem(e)});break;case s.default.Search:n=this._getSearchDataSource().then(function(t){return t.getItem(e)});break;default:n=t.prototype.getItem.call(this,e)}return n};r.prototype._getRecentDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./RecentDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getRecentDataSource=function(){return n};return n};r.prototype._getSearchDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./SearchDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getSearchDataSource=function(){return n};return n};r.prototype._getRecycleBinDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./RecycleBinDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getRecycleBinDataSource=function(){return n};return n};r.prototype._getSharedDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./SharedDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getSharedDataSource=function(){return n};return n};return r})(r.default);t.default=u});
define("odsp-next/dataSources/item/odc/SkyApiItemDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","../../../controls/leftPane/LeftPane.resx","../../item/odc/ODCDataSource.resx","../../base/odc/BatchRequest","../../base/odc/DataRequest","../../base/odc/ItemResultProcessor","knockout","../DeletionType","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","./ColumnsHelper","../../../models/store/ItemsStore","./SortDirectionMap","./SortFieldMap","../../url/odc/UrlDataSource","../../base/odc/ItemErrorProcessor","./ItemDataSourceHelper","../../../roots/odc/OneDrivePrefetchCache","@ms/odsp-utilities/lib/performance/PerformanceCollection","./MoveCopyDataSource","@ms/odsp-utilities/lib/async/Semaphore","../../base/odc/Config","../ItemTaskObserver","../../item/odc/SkyApiErrorHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=0,H=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._itemDataSourceHelper=new(t.managed(T.default));t.isLargeRecycleBin=c.observable(!1);t._pendingGetItemRequests={};t._itemsStore=t.resources.consume(b.resourceKey);t._urlDataSource=t.resources.consume(m.urlDataSource);t._identity=t.resources.consume(g.identity);t._itemResultProcessor=new(t.managed(l.default))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)});t._itemErrorProcessor=new(t.managed(x.default));t._rotationSemaphore=new L.default;return t}t.getServerDocumentType=function(e){var t;switch(e){case p.DocumentType.Word:t="w";break;case p.DocumentType.Excel:t="x";break;case p.DocumentType.PowerPoint:t="p";break;case p.DocumentType.OneNote:t="n";break;case p.DocumentType.ExcelSurvey:t="f"}return t};t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)};t.prototype.getSpecifiedItems=function(e){return null};t.prototype.getColumns=function(e,t){void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer));return y.getColumns(e,this.resources,t)};t.prototype.deleteItems=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),r=e.items;r&&r[0].key&&!r[0].id&&(r=r.map(function(e){return t._itemsStore.getItem(e.key).peek()}));return a.default.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:r,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:h.default.Recycle,targetId:n.id,cid:S.default.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++){n[t].eTag=""}}})};t.prototype.renameItem=function(e){var t=this,n=this._getUpdateItemsUrl(),r=e.item.name,s=e.newName+e.item.extension;if(e.nameHasExtension){var o=e.newName.lastIndexOf(".");if(o>0){var u=e.newName.substr(o+1);Array.isArray(A.Files.createTextDocumentExts)&&A.Files.createTextDocumentExts.indexOf(u)>=0&&(s=e.newName)}}var a=new f.default,l=this._urlDataSource.getKeyParams(e.parentKey),c=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:s,lid:l.id,rset:S.default.scenarioName,ownerId:e.ownerId});return a.send({apiName:"UpdateItem",url:n,requestType:"POST",postData:c,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e,r).errorTitle)})};t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new f.default).send({apiName:"GetOpenInClientDetails",url:t})};t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:S.default.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),r=new f.default,s=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:S.default.viewerId,group:0,desc:e.desc,ref:window.location.href});return r.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),r=window.$Config,s=new f.default,o=JSON.stringify({email:r.email,ids:e.items.map(function(e){return e.id})});return s.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:o,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),r=new f.default,s=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return r.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new f.default,r=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,r)};t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new f.default,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:S.default.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)};t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new f.default,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:S.default.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)};t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r=JSON.stringify({id:e.item.id,category:e.category,cid:S.default.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.updateItemProperty=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r={id:e.item.id,lid:e.item.parent.id,overrideLock:(!!e.overrideLock).toString(),rset:S.default.scenarioName};r[e.propertyName]=e.propertyValue||"";var i=e.qosPostfix?"UpdateItem_"+e.qosPostfix:"UpdateItem";return n.sendPost(i,t,JSON.stringify(r))};t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),r=this._urlDataSource.getKeyParams(e.parent.key),s=new f.default,o=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var u=0,a=e.selectedPeople;u<a.length;u++){var l=a[u];o.push({role:2,type:0,email:l.email})}var c={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:o},h=JSON.stringify({parentId:r.id,cid:r.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?c:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return s.send({apiName:"AddFolder",url:n,requestType:"POST",postData:h,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var r=new(t.resources.consume(O.resourceKey)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:v.default.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:r});r.flush();return i?r.getItem({key:i.item.key}):null},function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createDocument=function(e,n,r){var s=this;if(n===p.DocumentType.Text)return i.default.wrap(this._createTextDocument(e));var o=this._getCreateDocumentUrl(),u=t.getServerDocumentType(n),a=new f.default,l=this._urlDataSource.getKeyParams(e),c=JSON.stringify({parentId:l.id,nameConflict:r?0:2,overrideLock:!1,cid:l.cid,group:0,name:r,docType:u});return a.send({apiName:"CreateDocument",url:o,requestType:"POST",postData:c,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var r="";if((t=t.items||t.item)&&t.length>0){var i=new(s.resources.consume(O.resourceKey)),o=s._getItemResult({requestKey:e,itemFromServer:t[0],queryType:v.default.Files,isPrimaryRequestedItem:!0,observer:i});i.flush();r=(r=i.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view","");n===p.DocumentType.OneNote&&(r+="&nd=1")}return r},function(e){return i.default.wrapError(s._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createCustomDocument=function(e,t,n){return null};t.prototype.createShortcut=function(e,t,n){return null};t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(m.urlDataSource).getCreateTextDocumentUrl(t.id,t.cid)};t.prototype.createDocumentInTab=function(e,n,r){var i,s=t.getServerDocumentType(e);if(e===p.DocumentType.Text)i=this._createTextDocument(n.key);else{i=this.resources.consume(m.urlDataSource).getCreateDocumentInTabUrl(n,s,r)}return i};t.prototype.getFilterData=function(e,t,n){return null};t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return a.default.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var r={targetId:t.id,cid:S.default.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===u.default.ProductName?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};e.nameConflict&&(r.nameConflict=e.nameConflict);return r}})};t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new f.default;return new i.default(function(e,r){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},r)})};t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())};t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())};t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),r=new f.default,i=[],s=0;s<e.items.length;s++)i.push(e.items[s].id);t=JSON.stringify({items:i});return r.sendPost("RemoveFromMRU",n,t)};t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),r=new f.default;t=JSON.stringify({id:e.item.properties.ghostId||e.item.id});return r.sendPost("RemoveMountPoint",n,t)};t.prototype.createMountPoint=function(e){var t,n=this,r=this._getCreateMountPointUrl(),s=new f.default,o=this._urlDataSource.getAuthKeyParamValue();t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:o});return s.sendPost("MountFolder",r,t).then(function(e){var t=new(n.resources.consume(O.resourceKey)),r=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:v.default.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;t.flush();return r?t.getItem({key:r.key}):null},function(e){return i.default.wrapError(e)})};t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new f.default;return e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})};t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();(new f.default).sendPost("CancelWork",t,JSON.stringify(e));return i.default.wrap(!0)};t.prototype.getItemOcrTextContent=function(e){var t=new f.default,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",S.default.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return s.default.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this._getUpdateItemsUrl(),i=new f.default,s=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:e.parent.id,rset:S.default.scenarioName});return i.sendPost("UpdateItem",r,s)};t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),r=new f.default,i={inviterId:e};t&&""!==t&&(i.inviteSrc=t);return r.sendPost("ProcessReferral",n,JSON.stringify(i))};t.prototype.rotateItems=function(e){for(var t=this,r=new(this.resources.consume(O.resourceKey)),s=this._getRotateItemUrl(),o=[],u=function(u){var l=a.peekUnwrapObservable(a._itemsStore.getItem(u.key)),c=++P;if(l.thumbnail){var h=l.orientedThumbnail;h=h?n.__assign(n.__assign({},h),{rotation:h.rotation+e.rotation,version:c}):{rotation:e.rotation,thumbnail:n.__assign({},l.thumbnail),version:c};r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:O.Graft.replace(h)}})])}var p=new f.default,d=JSON.stringify({targetId:u.id,numberOfClockwiseRotations:-e.rotation,cid:S.default.viewerId});o.push(a._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",s,d).then(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)),i=n.itemFromServer&&n.itemFromServer.commands;e.item.commands=i||e.item.commands;t._itemResultProcessor.processItemResult({observer:r,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:u.key});var s=n.orientedThumbnail;s&&s.version===c&&r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:O.Graft.remove()}})]);return n},function(n){var s=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)).orientedThumbnail;if(s){s=s.version===c?O.Graft.remove():{rotation:s.rotation-e.rotation};r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:s}})])}var o=new Error(n.data.message);o.data={key:u.key,error:n.data};return i.default.wrapError(o)})}))},a=this,l=0,c=e.items;l<c.length;l++){u(c[l])}r.flush();return i.default.all(o).then(function(e){r.flush();if(t.resources.consume(D.isItemsScopeEnabledInAllPhotosPivotResourceKey))for(var n=function(e){var n=_.deserializeQuery(e.key);t.resources.consumeAsync(g.itemInvalidator).then(function(e){e.invalidateItems(_.serializeQuery(n))})},i=0,s=e;i<s.length;i++){n(s[i])}return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));n&&n.parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.parent.key);return n})},function(e){r.flush();var t=new Error;t.data=Object.keys(e).map(function(t){return e[t].data});return i.default.wrapError(t)})};t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),r=new f.default,i={id:e.item.id,authKey:t};return r.sendPost("RedeemPermissionToken",n,JSON.stringify(i))};t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==S.default.viewerId});return 0===t.length?i.default.wrap(null):a.default.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:S.default.viewerId,ids:e.map(function(e){return e.id})}}})};t.prototype.getRootItemTitle=function(e){return o.default.Files};t.prototype._getRootFileId=function(){return"root"};t.prototype._getParentItemId=function(){return""};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._handleMoveCopyApiRequest=function(e,t,r){for(var s,o=new f.default,u=t.items.map(function(e){return e.id}),a=k.convertMoveCopyContextToPostData(t),l=[],c=new L.default,h=function(){var i=u.splice(0,100);a.items=i;var f=JSON.stringify(a);!1!==t.ackMoveIfShared&&(s={prefer:"Block-Move-Into-Vault-If-Shared"});var h=c.enqueue(function(){return o.send({apiName:e,url:r,requestType:"POST",headers:s,postData:f,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:return!0;case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[n.__assign(n.__assign({},e),{error:e.data})]}})});l.push(h)};u.length;)h();return i.default.all(l).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})};t.prototype._getItem=function(e,t,r){var s,o=this,u=String(Math.random()),a=((s={})["X-SkyApiOriginId"]=u,s),l=this._pendingGetItemRequests[e];if(!l){var c=N.prefetchDataRequest[e];if(c){u=N.prefetchDataRequestOrigin;delete N.prefetchDataRequest[e]}var h=!r.skipCache&&c||(new f.default).send({apiName:"GetItems",qosName:r.qosName,url:e,headers:a,isErrorExpectedCallback:M.isExpectedSkyApiError}),p=!1;l=h.then(function(i){p=!0;C.default.mark("ItemsDataSource.GetItems.Normalizing");var s,a=i.originId,f=i.items||i.item&&[i.item]||[];if(f&&f.length>0){for(var l=new(o.resources.consume(O.resourceKey)),c=void 0,h=f.length-1;h>=0;h--){var v=0===h;if(!f[0].isBundle||v){var m=h>0,g=o._getItemResult({observer:l,requestKey:r.parentKey,itemFromServer:f[h],queryType:r.queryType,requestMetadata:{tokenNeedsRedeeming:i.tokenNeedsRedeeming,tokenType:i.tokenType,restoreAllWorkItemCount:i.restoreAllWorkItemCount||0,deleteAllWorkItemCount:i.deleteAllWorkItemCount||0},setItemKey:!m,skipSettingChildren:m,isPrimaryRequestedItem:v});v&&(c=g)}}l.flush();if(c&&c.item){var b=l.getItem({key:c.item.key}),w=f[0],E=o._getDefaultSortInformation(w);if(r.sortField){var S=E&&E.defaultSortField;E={sortField:r.sortField,defaultSortField:S,isAscending:r.isAscending,isSortEnabled:!o.isLargeRecycleBin.peek()}}var x=void 0;E&&(x=E.isAscending);var T=a!==u;T||b.type!==d.default.Folder||o._itemDataSourceHelper.persistResultVersion(r,t);var N=y.getColumns(b,o.resources,E),k=void 0;if(N&&E)for(var L=0,A=N;L<A.length;L++){var M=A[L];if(M.internalName===E.sortField){k=M.key;break}}s=n.__assign(n.__assign({},c),{schema:N,startIndex:w.folder?w.folder.startIndex:r.startIndex,isFromBrowserCache:T,sortField:k,isAscending:x})}}delete o._pendingGetItemRequests[e];return s},function(t){delete o._pendingGetItemRequests[e];var n=new(o.resources.consume(O.resourceKey)),s=o._itemErrorProcessor.processError({requestKey:r.parentKey,error:t,observer:n}).error;n.flush();return i.default.wrapError(s)});p||(this._pendingGetItemRequests[e]=l)}return l};t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}};t.prototype._getDefaultSortInformation=function(e){var t;e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(E.default).length/2>e.folder.defaultSort&&(t={sortField:E.default[e.folder.defaultSort],defaultSortField:E.default[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===w.default.ascending.toString(),isSortEnabled:!0});return t};t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)};t.prototype._getCreateDocumentUrl=function(){return S.default.skyApiBaseUrl+"CreateDocument"};t.prototype._getCreateFolderUrl=function(){return S.default.skyApiBaseUrl+"AddFolder?lct=1"};t.prototype._getDeleteItemsUrl=function(){return S.default.skyApiBaseUrl+"DeleteItems"};t.prototype._getUpdateViewCountUrl=function(){return S.default.skyApiBaseUrl+"UpdateViewCount"};t.prototype._getRestoreItemsUrl=function(){return S.default.skyApiBaseUrl+"RestoreItems"};t.prototype._getOpenInClientDetailsUrl=function(){return S.default.skyApiBaseUrl+"GetOpenInClientDetails"};t.prototype._getRequestReviewUrl=function(){return S.default.skyApiBaseUrl+"OwnerRequestReview"};t.prototype._getReportAbuseUrl=function(){return S.default.skyApiBaseUrl+"ReportAbuse"};t.prototype._getRemoveFromSharedListUrl=function(){return S.default.skyApiBaseUrl+"AbdicatePermissions"};t.prototype._getAddCoverPhotoUrl=function(){return S.default.skyApiBaseUrl+"AddFavorites"};t.prototype._getRemoveCoverPhotoUrl=function(){return S.default.skyApiBaseUrl+"RemoveFavorites"};t.prototype._getUpdateItemsUrl=function(){return S.default.skyApiBaseUrl+"UpdateItem?lct=1"};t.prototype._getUpdateBundleUrl=function(){return S.default.skyApiBaseUrl+"UpdateBundle"};t.prototype._getCopyItemsUrl=function(){return S.default.skyApiBaseUrl+"CopyItemsAsync"};t.prototype._getMoveItemsUrl=function(){return S.default.skyApiBaseUrl+"MoveItems"};t.prototype._getRemoveFromRecentUrl=function(){return S.default.skyApiBaseUrl+"RemoveFromMRU"};t.prototype._getRemoveMountPointUrl=function(){return S.default.skyApiBaseUrl+"RemoveMountPoint"};t.prototype._getCreateMountPointUrl=function(){return S.default.skyApiBaseUrl+"AddFolder"};t.prototype._getRestoreAllUrl=function(){return S.default.skyApiBaseUrl+"RestoreAll"};t.prototype._getWorkProgressUrl=function(e){return S.default.skyApiBaseUrl+"GetWorkProgress?type="+e.type};t.prototype._getRotateItemUrl=function(){return S.default.skyApiBaseUrl+"ChangeImageOrientation"};t.prototype._getCancelWorkUrl=function(){return S.default.skyApiBaseUrl+"CancelWork"};t.prototype._getProcessReferralUrl=function(){return S.default.skyApiBaseUrl+"ProcessReferral"};t.prototype._getRedeemPermissionTokenUrl=function(){return S.default.skyApiBaseUrl+"RedeemPermissionToken"};return t})(r.default);t.default=H});
define("@ms/odsp-utilities/lib/xhr/XHRPromise",["require","exports","./XHR","../async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.start=function(e){var t=new n.default(e);return new r.default(function(e,n){t.start(e,n)},function(){t.abort(!0)})};e.startAndPostProcess=function(e,t){var i=new n.default(e);return new r.default(function(e,n){i.start(function(n,r){e(t(n,r))},n)},function(){i.abort(!0)})};return e})();t.default=i});
define("odsp-next/dataSources/base/odc/BatchRequest",["require","exports","@ms/odsp-utilities/lib/async/Signal","./DataRequest"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.start=function(e){var t=new n.default(function(){for(var e=0,t=o;e<t.length;e++){t[e].cancel()}}),i=e.items.slice(),s=e.parallelRequests||1,o=[];function u(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function a(){var n=new r.default,s=i.splice(0,e.batchSize),f=JSON.stringify(e.getPostData(s)),l=n.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:f,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){u(l);e.onBatchComplete&&e.onBatchComplete(s);i.length?a():t.complete()},function(e){u(l);(function(e){t.error(e)})(e)});o.push(l)}for(var f=0;i.length>0&&f<s;f++)a();return t.getPromise()};return e})();t.default=i});
define("odsp-next/dataSources/base/odc/ItemResultProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/VirtualItemType","../../../models/item/ItemType","../../../models/item/SharingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","../../../controls/photos/Photos.resx","../../vault/odc/VaultDataSource.key","../../item/ItemDataSource.resx","../../item/odc/ODCDataSource.resx","../../../controls/leftPane/LeftPane.resx","../../url/QueryType","../../url/SearchTypeChecker","../../url/odc/UrlDataSource","../../item/odc/SkyApiCommands","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/locale/Locale","./ThumbnailProcessor","../../../utilities/features/Features","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/dateTime/DateTime","../../album/odc/AlbumDataSource","../../../utilities/array/ArrayHelper","../../item/ItemTaskObserver","../../../utilities/mime/MimeHelper","@ms/odsp-microservice/lib/microService/helpers/BabylonSupport","../../photo/odc/GetOneDriveItemWithSupportedCommands"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _={0:0,1:2,2:1,3:3,4:4,5:5};function D(e){if("number"==typeof e)return N.getDateFromDotNetTicks(e)}var P=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.getRootItemTitle,i=void 0===r?n._getRootItemTitle:r,s=t.getItemKeyExtension,o=void 0===s?n._getItemKeyExtension:s;n._getRootItemTitle=i;n._getItemKeyExtension=o;n._urlDataSource=n.resources.consume(x.urlDataSource);n._identityDataSource=n.resources.consume(T.identity);n._thumbnailProcessor=new(n.managed(E.default));return n}t.prototype.processItemResult=function(e){var t,r,o=this,l=e.requestKey,h=e.itemFromServer,E=e.requestMetadata,x=e.setItemKey,T=e.skipSettingChildren,C=e.isPrimaryRequestedItem,A=e.isPlaceholder,P=e.observer,B=this._urlDataSource.getKeyParams(l),j=e.queryType,F=void 0===j?this._urlDataSource.getQueryType(B):j;if(h){var I=this.getItemKey({requestKey:l,itemFromServer:h}),q={key:I},R=h.itemStatus;q.itemStatus=R;var U="";h.locatedIn?U=h.locatedIn:h.deletedFromLocation?U="/"===h.deletedFromLocation[0]?h.deletedFromLocation.substr(1):h.deletedFromLocation:h.ownerCid&&h.ownerCid===v.default.viewerId?U=c.default.ProductName:h.ownerName&&(U=g.format(c.default.UsersOneDrive,h.ownerName));var z=h.internalPath;z&&(q.internalPath=z);var W=this._identityDataSource.getIdentity(),X=h.ownerCid||W.id,V=this._getNormalizedId(h);q.id=V;var $="root"===h.id?h.rootResourceId||"root":V,J=h.resourcePartitionCid||X;q.itemId=$;void 0!==h.mruId&&(q.mruState={mruId:h.mruId,app:h.mruApp,type:h.mruType});q.graph={itemId:$,driveId:J,driveType:"personal"};q.statistics={views:h.visitorViews};q.eTag=h.eTag;q.isSharerFolder=h.isSharerFolder;q.parentKey=this._getParentKey(h,{requestKeyParams:B});var K=this._getVirtualItemType(h);q.virtualItemType=K;var Q=this._isPhotosRoot(h,{requestKeyParams:B}),G=this._isPhotosSubRoot(h,{requestKeyParams:B,isPhotosRoot:Q}),Y=this._getIsRootFolder(h,{isPhotosSubRoot:G});q.isRootFolder=Y;var Z=h.name,ee="";q.comments={count:h.commentCount||0,settings:{isCommentDisabled:h.commentSettings&&h.commentSettings.commentingDisabled&&!!h.commentSettings.commentingDisabled.isDisabled}};C||(q.isStub=h.isPlaceholder);var te=h.iconType?y.OfficeIconFileTypeMap[h.iconType.toLowerCase()]:"";q.appMap=te;var ne=this._getItemType(h,te),re=h.extension||"";q.extension=re;q.size=Number(h.size);var ie,se=h.sharingLevelValue;q.sharingType=se;q.isBundle=!!h.isBundle;q.locations=h.locations;q.creatorName=h.creatorName;q.caption=h.caption||"";q.itemFromServer=h;(h.photo||h.video||h.isAlbum)&&(ie=h.tags||[]);q.tags=ie;q.ocr=h.ocr;q.urls=h.urls;var oe=h.userRole in _?_[h.userRole]:5;if("MountPoint"===h.groupFolderType){oe=2;q.mountPoint={}}q.vault=h.vault;var ue=h.vault;ue&&ue.root&&this.resources.consumeAsync(f.resourceKey).then(function(e){e.setVaultLockState(ue)});q.defaultSubText=this._getDefaultSubText(oe,se,h.sharingLevel);q.location=U;q.ownerId=X;q.ownerName=h.ownerName||"";q.uploadOwnerId=J;q.specialFolderCanonicalName=h.specialFolderCanonicalName||"";q.isSpecialFolder=!!h.isSpecialFolder;var ae={};if(Y){if(q.ownerId!==v.default.viewerId)Z=c.default.SharedRoot;else{Z=this._getRootItemTitle(I);oe=0}E&&(q.taskStatus={restoreAllCount:E.restoreAllWorkItemCount,deleteAllCount:E.deleteAllWorkItemCount})}if(E){q.tokenNeedsRedeeming=E.tokenNeedsRedeeming;q.tokenType=E.tokenType}if(h.settings){ae.allPhotosFolderId=h.settings.allPhotosFolderId;ae.allPhotosSortAscending=h.settings.allPhotosSortAscending}h.displayQuotaExceeded&&(ae.quota={display:{exceeded:h.displayQuotaExceeded,remaining:h.displayQuotaRemaining,total:h.displayQuotaTotal,used:h.displayQuotaUsed,size:h.displaySize},exceeded:h.quotaExceeded,remaining:h.quotaRemaining,status:h.quotaStatus,total:h.quotaTotal});ae.ghostId=h.ghostId;if(h.thumbnailSet){q.thumbnail=this._thumbnailProcessor.processThumbnailSet(h.thumbnailSet,h);var fe=this._thumbnailProcessor.getProcessFiltersUrl(h.thumbnailSet,h);fe&&(q.processFilters={thumbnailUrl:fe})}var le=h.folder;if(le){var ce=[];q.folder={childCount:le.childCount,documentCount:le.documentCount,folderCount:le.folderCount,photoCount:le.photoCount,totalCount:le.totalCount,covers:ce};var he=le.covers;if(he)for(var pe=0,de=he;pe<de.length;pe++){var ve=de[pe],me=this._thumbnailProcessor.processThumbnailSet(ve,h);me&&ce.push(me)}}var ge,ye=h.photo;ye&&(ge={width:ye.width,height:ye.height,cameraMake:ye.cameraMake,cameraModel:ye.cameraModel,exposureNumerator:ye.exposureNumerator,exposureDenominator:ye.exposureDenominator,focalLength:ye.focalLength,focalRatio:ye.focalRatio,iso:ye.iso,originalUrl:h.urls[u.default[u.default.open]],displayDateTaken:ye.displayDateTaken,dateTaken:ye.dateTaken,quality:L.Graft.optional(ye.quality?{isBad:ye.quality.isBad}:void 0),isLivePhoto:L.Graft.optional(ye.isLivePhoto)});q.photo=ge;(null===(t=ye)||void 0===t?void 0:t.isLivePhoto)&&S.isFeatureEnabled(S.EnableLivePhotoVideos)?q.video=n.__assign(n.__assign({},(function(e){return{width:e.width,height:e.height,fourCC:"H264"}})(ye)),h.video):q.video=h.video;q.audio=h.audio;q.panorama=h.panorama;q.geoLocation=h.location;var be=h.textEditorMimeType;q.textEditorMimeType=be;var we=!!h.isAlbum;q.isAlbum=we;var Ee,Se=h.photo||h.video,xe=D(h.dateModifiedOnClient),Te=D(h.creationDate),Ne=D(h.lastAccess),Ce=D(h.dateShared),ke=D(h.dateDeleted),Le=D(h.dateExpires),Ae=Se&&D(Se.dateTaken),Oe=h.displayModifiedDate,Me=h.displayCreationDate,_e=h.displayLastAccess,De=h.displayDateShared,Pe=h.displayDateDeleted,He=h.displayExpiryDate;try{xe&&(Oe=N.getFriendlyDateTimeStringPast(xe));Te&&(Me=N.getShortDisplayDate(Te));Ne&&(_e=N.getShortDisplayDate(Ne));Ce&&(De=N.getShortDisplayDate(Ce));ke&&(Pe=N.getShortDisplayDate(ke));Le&&(He=N.getShortDisplayDate(Le));Ae&&(Ee=N.getFriendlyDateTimeStringPast(Ae,!1,!1,!0))}catch(e){}q.dateModifiedValue=h.dateModifiedOnClient;q.dateModifiedTime=q.vault&&q.vault.root?"":xe;q.dateCreatedTime=Te;q.dateAccessedTime=Ne;q.dateSharedTime=Ce;q.dateDeletedTime=ke;q.dateExpiresTime=Le;q.dateModified=q.vault&&q.vault.root?q.vault.isLocked?" ":"Unlocked":Oe;q.dateCreated=Me;q.dateAccessed=_e;q.dateShared=De;q.dateDeleted=Pe;q.dateExpires=He;if(Se){q.dateTakenTime=L.Graft.optional(Ae);q.dateTaken=L.Graft.optional(Ee)}q.itemFromServer=h;q.lifeCycleStatus=L.Graft.optional(this._getItemLifeCycleStatus(q));var Be={},je={};if(h.isAlbumRoot){je[m.download]=!0;je[m.share]=!0;je[m.rename]=!0}if((null===(r=ye)||void 0===r?void 0:r.isLivePhoto)&&S.isFeatureEnabled(S.EnableLivePhotoVideos)){je[m.applyOfficeLens]=!0;je[m.rotate]=!0;je[m.viewOriginal]=!0;Be[m.addCoverPhoto]="1"}(ye||h.video)&&(Be[m.addToAlbum]="1");ye&&!M.isPhotoExtensionSupportedForRotate(q.extension)&&(je[m.rotate]=!0);if(h.commands)for(var Fe=h.commands.split(","),Ie=0;Ie<Fe.length;Ie+=2){Fe[Ie]in je||(Be[Fe[Ie]]=Fe[Ie+1])}else"root"===q.id&&d.isSearchType(F)&&(Be[m.defaultClick]="1");if(h.audio){delete Be[m.playAudio];Be[m.defaultClick]="1"}var qe,Re,Ue,ze=!!Be[m.requestReview];q.isViolation=ze;q.queryType=F;q.displayType=!le||1!==le.category||F===p.default.Files&&Y?F:p.default.Photos;q.queryType===p.default.Recent&&Y&&(Be[m.defaultClick]="1");if(ne===s.default.Folder&&!q.isStub)switch(oe){case 0:case 4:case 2:Ue=q.queryType===p.default.Files||q.queryType===p.default.SharedWithMe&&!Y;break;default:Ue=!1}q.sharingRole=oe;q.isDropEnabled=Ue;q.iconName=b.getIconNameFromItem({type:ne,extension:re,sharingType:se,textEditorMimeType:be});q.iconName=this._isFluidFile(h)?"fluid":q.iconName;q.documentFormat=h.docFormat||0;K===i.default.AlbumRoot&&(Z=a.default.albumsNavLink);z&&(ee=w.default.isRightToLeft?z.slice(0).reverse().join(" < "):z.join(" > "));A||(q.isPlaceholder=!1);q.isDraggable=q.queryType===p.default.Files&&!q.mountPoint;if(le){q.childCount=h.estimatedResultCount||le.totalCount;q.category=le.category;qe=[];le.itemGroupings&&(Re=le.itemGroupings.map(function(e){var t=e.itemGroups,r=n.__rest(e,["itemGroups"]);return n.__assign(n.__assign({},r),{itemGroups:t.map(function(e){return n.__assign(n.__assign({},e),{state:o.observables.create({isCollapsed:!1})})})})}));var We={};if(le.children&&!T)for(var Xe=0,Ve=le.children;Xe<Ve.length;Xe++){var $e=Ve[Xe],Je=this.processItemResult({observer:P,requestKey:l,itemFromServer:$e,queryType:F,requestMetadata:E,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;qe.push(Je);We[Je.key]={newTag:this.getNewTagIfExists($e),autoAlbumTag:this.getAutoAlbumTagIfExists($e)}}if(K===i.default.AlbumRoot){for(var Ke={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Qe=[],Ge=0,Ye=[],Ze=Math.max(3,10-qe.length),et=0,tt=qe;et<tt.length;et++){var nt=tt[et],rt=We[nt.key];if(rt&&rt.newTag&&rt.autoAlbumTag)if(++Ge>Ze){Qe.push(nt);Ke.count++}else Ye.push(nt);else Ye.push(nt)}Ke.startIndex=Ye.length;qe=Ye.concat(Qe);var it={name:"newAutoAlbumsGrouping",itemGroups:[Ke]};Re.push(it)}}else h.name&&this._isFluidFile(h)?q.openUrl=this._generateOpenUrlForFluidFile(h.name,J,$):h.urls&&(h.urls.oneNoteWeb?q.openUrl=h.urls.oneNoteWeb:q.openUrl=h.urls.viewInBrowser);var st=re&&re.toLowerCase(),ot=st&&st.slice(1);if(".pdf"===st||".ai"===st&&Be[m.download]){Be[m.defaultClick]="1";q.openUrl=this._urlDataSource.getDownloadItemUrl({key:I,id:$,ownerId:X,extension:re},FilesConfig.canary,!0);S.isFeatureEnabled(S.UseWebPdfViewer)&&(ne=s.default.Media)}var ut,at,ft=v.default.getVroomBaseUrl()+"/drives/"+J+"/items/"+$;if(S.isFeatureEnabled(S.EnableZipFilePreviewing)&&(".zip"===st||".rar"===st)){Be[m.defaultClick]="1";ne=s.default.Media;q.zip=L.Graft.optional((ut=ot,(at=ft)?{downloadZipContentsUrl:H("zipcontent",ut,at),zipMetaDataUrl:H("zipmetadata",ut,at)}:void 0))}var lt=(function(e,t){var n=O.canConvert(e),r=O.canRenderNative(e);if(!n&&!r)return;return{canConvert:n,canRenderNative:r,conversionUrl:n&&t?H("glb",e,t)+"&{.authParams}":void 0}})(ot,ft);if(lt){ne=s.default.Media;q.model3d=lt;Be[m.defaultClick]="1"}q.type=ne;q.thumbnail&&"4"===Be[m.defaultClick]&&(Be[m.defaultClick]="1");!C&&h.isPlaceholder&&(Be[m.defaultClick]="1");if("allmyphotos"===B.qt&&q.id===B.id){Be[m.defaultClick]="1";Z=""}var ct=le?le.childCount:0;q.name=Z;q.displayName=ee||""+Z+re;h.estimatedResultCount&&(ct=qe.length+(h.folder&&h.folder.startIndex||0));if(h.isRecycled&&h.folder&&!ct){ct=qe.length;q.childCount=ct}ae.newTag=this.getNewTagIfExists({tags:ie});ae.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:we,tags:ie});var ht=[I];x&&l&&ht.push(l);e.keyAlias&&ht.push(e.keyAlias);var pt=!0;"allmyphotos"===B.qt&&q.id===B.id&&(pt=!1);ae.commandsSupported=L.Graft.replace(Be);q.properties=ae;for(var dt=0,vt=k.removeDuplicates(ht);dt<vt.length;dt++){var mt=vt[dt];P.update([new L.Task(mt).succeed({item:pt?q:{key:I}})])}var gt=h.hasMoreResults?""+h.estimatedResultCount:"";h.isRecycled&&h.folder&&h.folder.hasMoreRecycledItems&&(gt=h.folder.pagingToken);return{item:{key:I},children:qe,groupings:Re,totalChildren:ct,nextRequestToken:gt}}};t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.tag===C.AUTO_ALBUM_TAG){t=s;break}}return t};t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.tag===C.NEW_ALBUM_TAG){n=s;break}}return n};t.prototype.getItemKey=function(e){var t,r,i,s,o,u=e.itemFromServer,a=e.requestKey,f=this._urlDataSource.getKeyParams(a);if(u.isAlbumRoot)o=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=f.tagFilter,t));else if(u.isTagsRoot)o=this._urlDataSource.getKey(((r={}).id="tags",r));else{var l=this._getItemKeyExtension(u,a),c=u.ownerCid,h=u.internalPath,d=void 0===h?[]:h,v=this._getNormalizedId(u),m=this._urlDataSource.isCurrentQuery(p.default.SharedWithMe,f);if(m&&"1209427492"===u.ownerDCid&&"0000000048166624"===u.ownerCid){v="1209427492";c="0000000048166624"}o=this._urlDataSource.getKey(n.__assign(n.__assign(n.__assign({},l),((i={}).id=v,i.cid=c,i.internalPath=d.join(","),i)),S.isFeatureEnabled(S.AttachGroupIdToSharedByKey)&&m&&u.groupId?((s={}).u="group_"+u.groupId,s):{}))}return o};t.prototype._generateOpenUrlForFluidFile=function(e,t,n){var r=S.isFeatureEnabled(S.UseFluidPreview)?"https://fluidpreview.office.net/p":"https://dev.fluidpreview.office.net/p",i=encodeURIComponent(btoa("spo:https://api.onedrive.com")),s=encodeURIComponent(e);return r+"/"+i+"/"+encodeURIComponent(t)+"/"+encodeURIComponent(n)+"/"+s};t.prototype._getDefaultSubText=function(e,t,n){var r;switch(e){case 0:r=t===o.default.Private?"":l.default.Owner;break;case 1:r=l.default.CanView;break;case 2:case 4:r=l.default.CanEdit;break;default:r=""}return r};t.prototype._getItemType=function(e,t){return e.isPlaceholder?s.default.Folder:17===e.itemType?s.default.OneNote:e.folder?s.default.Folder:e.video||e.photo||e.audio?s.default.Media:t||this._isTextEditorFile(e)||this._isFluidFile(e)?s.default.File:e.thumbnailSet?s.default.Media:s.default.File};t.prototype._isFluidFile=function(e){return!!e.extension&&".fluid"===e.extension.toLowerCase()};t.prototype._isTextEditorFile=function(e){return A.canOpenInMonaco(e.extension||"")};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._getRootItemTitle=function(e){return h.default.Files};t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id};t.prototype._getParentKey=function(e,t){var n,r,i=t.requestKeyParams;e.isRecycled&&"root"!==e.id?r=this._urlDataSource.getRootItemKey(p.default.RecycleBin):e.isSharerFolder?r=this._urlDataSource.getRootItemKey(p.default.SharedWithMe):e.isAlbumRoot?r=void 0:e.parentId&&(r=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n)));return r};t.prototype._getVirtualItemType=function(e){var t;e.isAlbumRoot?t=i.default.AlbumRoot:e.isAlbum?t=i.default.Album:e.isTagsRoot&&(t=i.default.TagsRoot);return t};t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n};t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id};t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)};t.prototype._getItemLifeCycleStatus=function(e){var t={};this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0);return t};t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5};return t})(r.default);t.default=P;function H(e,t,n){return"https://southcentralus1-media"+(window.FilesConfig&&window.FilesConfig.df?"s":"p")+".svc.ms/transform/"+e+"?provider=odc&cs=V2VifE9EQw==&inputFormat="+t+"&docid="+encodeURIComponent(n)}});
define("odsp-next/models/item/SharingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/item/UrlType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl";e[e.mediaBaseUrl=10]="mediaBaseUrl"})(n=t.UrlType||(t.UrlType={}));t.default=n});
define("odsp-next/dataSources/vault/odc/VaultDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VaultDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/item/odc/SkyApiCommands",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.abdicatePermissions="ab";t.addCoverPhoto="acp";t.applyOfficeLens="aol";t.addTag="at";t.addToAlbum="ata";t.addToSharedList="ats";t.changeExpiration="ce";t.comment="cm";t.copy="cp";t.createExcel="cxls";t.createExcelSurvey="cxlsf";t.createFolder="cf";t.createMountPoint="cmp";t.createOneNote="con";t.createPowerPoint="cppt";t.createWord="cdoc";t.defaultClick="defc";t.deleteCommand="de";t.download="dl";t.editSurvey="ef";t.embed="em";t.emptyRecycleBin="erb";t.modifyCaption="mc";t.move="mv";t.openInOffice="oo";t.openInTextEditor="openInTextEditor";t.openPdfInBrowser="openPdfInBrowser";t.playAudio="pl";t.rearrange="ar";t.removeCoverPhoto="rcp";t.removeFromAlbum="rfa";t.removeFromRecent="rmru";t.removeMountPoint="rmp";t.rename="rn";t.removeOfficeLens="rol";t.reportAbuse="ra";t.requestReview="orr";t.restore="rst";t.restoreAll="rai";t.rotate="rot";t.share="sh";t.shareSurvey="sf";t.upload="up";t.viewInBrowser="vb";t.viewOriginal="vo";t.viewSurvey="pf";t.viewVersions="vv"});
define("odsp-next/dataSources/base/odc/ThumbnailProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./ISkyApiItem","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/interfaces/item/UrlType"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.SkyApiThumbnailType[i.SkyApiThumbnailType.unRes],a=i.SkyApiThumbnailType[i.SkyApiThumbnailType.doc],f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.processThumbnailSet=function(e,t){for(var r={},i={},s=0,o=e.thumbnails;s<o.length;s++){var f=o[s];r[f.name]=f;if(0===f.name.indexOf("scaled")){i[f.name.substring("scaled".length).toLowerCase()]=f}}var l,c={thumbnailSet:e,thumbnailsByType:r,thumbnailsBySize:i,item:t},h=r[u],p=r[a];h?l=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(h,c):this._getUnResThumbnail(h,c):p?l=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(n.__assign(n.__assign({},p),{width:t.video.width,height:t.video.height}),c):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(n.__assign(n.__assign({},p),{width:t.photo.width,height:t.photo.height}),c):this._getDocThumbnail(p,c):Object.keys(i).length&&(l=this._getScaledThumbnail(c));return l};t.prototype.getProcessFiltersUrl=function(e,t){for(var n,r=0,i=e.thumbnails;r<i.length;r++){var s=i[r];"custom"===s.name&&(n=s)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""};t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[o.default[o.default.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,r){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)};t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,r)}}}};t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:r.width,height:Math.max(r.height,2048)})}}}};t.prototype._getScaledThumbnail=function(e){var t,n=this,r=[];for(var i in e.thumbnailsBySize){var s=e.thumbnailsBySize[i];switch(i){case"largest":t=s;break;default:r.push(s)}}r.sort(function(e,t){return e.width*e.height-t.width*t.height});t=t||r[r.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,s){for(var u,a=i.width*i.height,f=0,l=r;f<l.length;f++){var c=l[f];if(c.width*c.height>.9*a){u=c.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,u||t.url)}}}};t.prototype._createSizedUrl=function(e,t,n){var r={width:Math.ceil(n.width),height:Math.ceil(n.height)};n.width===n.height&&(r.cropMode="center");return this._createUrl(e,t,r)};t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})};t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var r=""+e+t,i=s.serializeQuery(n)?r.indexOf("?")>-1?"&":"?":"";return""+r+i+s.serializeQuery(n)};t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,r=e.photo;return".gif"===n.toLowerCase()&&!!r};return t})(r.default);t.default=f});
define("odsp-next/dataSources/base/odc/ISkyApiItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unRes=0]="unRes";e[e.doc=1]="doc"})(t.SkyApiThumbnailType||(t.SkyApiThumbnailType={}))});
define("@ms/odsp-utilities/lib/dateTime/DateTime",["require","exports","tslib","@ms/utilities-date-time/lib/DateTime.resx","./DateTime.resx","../locale/Locale","../string/StringHelper","../features/Features","@ms/utilities-date-time/lib/index","@ms/utilities-date-time/lib/index"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,c,h,p,d,v,m,g,y,b,w=void 0,E={ODB:1469,ODC:"ChromiumDateFix"};t.createDateStringFormatter=function(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){var t;return function(n){t||(t=new Intl.DateTimeFormat(x(s.default.language),e));return t.format(n)}}return function(t){return t.toLocaleDateString(x(s.default.language),e)}};t.getRelativeDateTimeStringPast=function(e,t){void 0===t&&(t=!1);return a.getRelativeDateTimeStringPast(e,x(s.default.language),t)};t.getFriendlyDateTimeStringPast=function(e,t,n,o,u){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===o&&(o=!1);var f=Date.now()-e.getTime(),l=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),c=k(l,-1),h=k(l,-6),p=u||{},d=p.displayMinutesToOneHour,v=void 0===d||d,m=p.displayHoursToOneDay,g=void 0===m||m,y=p.displayHoursInDates,b=void 0===y||y,w=p.displayShortenedWeekday,E=void 0===w||w,S=x(s.default.language);if(v&&f<-5*a.ONE_MINUTE)return e.toLocaleDateString(S,A({month:"short",day:"numeric"},o));if(f<a.TWO_MINUTES)return n?i.default.FriendlyDateTime_JustNow_withinSentence:i.default.FriendlyDateTime_JustNow_asSentence;if(v&&f<a.ONE_HOUR)return L(f,i.default.FriendlyDateTime_minutesShort,a.ONE_MINUTE);if(a.isSameDay(l,e))return g?L(f,i.default.FriendlyDateTime_hoursShort,a.ONE_HOUR):a.getRelativeDateTimeResx("Today",n);if(e>=c)return t||!b?a.getRelativeDateTimeResx("Yesterday",n):a.getRelativeDateTimeResx("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o)));if(e>=h){var T=e.toLocaleDateString(S,A({weekday:"short"},o));return t?T:E||b?r.default.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o))):e.toLocaleDateString(S,A({weekday:"long"},o))}return a.isSameYear(l,e)?S.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(S,A({month:"long",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric",year:"numeric"},o))};t.getRelativeDateTimeStringPastWithHourMinute=function(e){return a.getRelativeDateTimeStringPastWithHourMinute(e,x(s.default.language))};function S(){var e=l(),t=T();if(window.Intl&&window.Intl.DateTimeFormat){var n={},r={hour:"2-digit",minute:"2-digit"};h=new Intl.DateTimeFormat(e,n);p=new Intl.DateTimeFormat(e,r);if(t){n.timeZone="UTC";r.timeZone="UTC"}d=new Intl.DateTimeFormat(e,n);v=new Intl.DateTimeFormat(e,r);m=h.format;g=p.format;y=d.format;b=v.format}else{m=y=function(t){return t.toLocaleDateString(e)};g=b=function(t){return t.toLocaleTimeString(e)}}}t.getShortDisplayDate=function(e,t){if(!e)return"";m||S();var n=a.isSameDay(new Date,e);return(t?n?b:y:n?g:m)(e)};t.getFileSafeShortDate=function(e,t){if(!e)return"";m||S();return(t?y:m)(e).replace(/[:\/\\]/g,"-")};t.getFullDisplayDate=function(e,t){m||S();var n=t?y(e):m(e),r=t?b(e):g(e);return o.format(i.default.DateAndTime,n,r)};t.toLocaleDateString=function(e,t){return a.toLocaleDateString(e,x(s.default.language),t)};t.toLocaleTimeString=function(e,t){return a.toLocaleTimeString(e,x(s.default.language),t)};function x(e){if(void 0===w)try{w=u.default.isFeatureEnabled(E)}catch(e){w=!1}return w&&(function(e){void 0===C&&(function(){C={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=N;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(C[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return C[e]}return})(e)?"en":e}t.getBrowserSafeLocale=x;l=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,s.default.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var r=n[t];try{(new Date).toLocaleDateString(r);e=r;break}catch(e){}}e=x(e);l=function(){return e};return e};function T(){if(void 0===c)try{var e=l();(new Date).toLocaleDateString(e,{timeZone:"UTC"});c=!0}catch(e){c=!1}return c}var N=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],C=void 0;function k(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function L(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function A(e,t){return T()&&t&&e?n.__assign(n.__assign({},e),{timeZone:"UTC"}):e}n.__exportStar(f,t)});
define("@ms/utilities-date-time/lib/index",["require","exports","tslib","./dotNet","./relativePast","./helpers","./iso","./sharePoint"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("@ms/utilities-date-time/lib/dotNet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDateFromDotNetTicks=function(e){return new Date(e/1e4-621355968e5)}});
define("@ms/utilities-date-time/lib/relativePast",["require","exports","@ms/utilities-strings/lib/index","./helpers","./DateTime.resx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){void 0===n&&(n=!1);var i=Date.now()-e.getTime();if(i<-5*r.ONE_MINUTE)return f(e,t);if(i<r.ONE_MINUTE)return o("LessThanAMinute",n);if(i<r.TWO_MINUTES)return o("AboutAMinute",n);if(i<r.ONE_HOUR){return u(Math.floor(i/r.ONE_MINUTE),"XMinutes")}if(i<r.TWO_HOURS)return o("AboutAnHour",n);if(i<r.ONE_DAY){return u(Math.floor(i/r.ONE_HOUR),"XHours")}if(i<r.TWO_DAYS){var s=e.toLocaleTimeString(t);return o("YesterdayAndTime",n).replace("{0}",s)}if(i<r.ONE_MONTH){return u(Math.floor(i/r.ONE_DAY),"XDays")}return f(e,t)}t.getRelativeDateTimeStringPast=s;t.getRelativeDateTimeStringPastWithHourMinute=function(e,t){var o=Date.now()-e.getTime(),u=e.toLocaleDateString(t),a=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return o<r.ONE_DAY?s(e,t):o<r.TWO_DAYS?n.format(i.default.RelativeDateTime_YesterdayAndTime,a):n.format(i.default.DateTime_DateAndTime,u,a)};function o(e,t,n,r){return i.default[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}t.getRelativeDateTimeResx=o;function u(e,t,r,i){var s=o(t,!!i&&r,i),u=o(t,!1,i,!0);return(n.getLocalizedCountValue(s,u,e)||"").replace("{0}",e+"")}t.getRelativeDateTimeIntervalString=u;var a={};function f(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){a[t]||(a[t]=new Intl.DateTimeFormat(t));return a[t].format(e)}return e.toLocaleDateString(t)}});
define("@ms/utilities-date-time/lib/helpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ONE_SECOND=1e3;t.ONE_MINUTE=60*t.ONE_SECOND;t.TWO_MINUTES=2*t.ONE_MINUTE;t.ONE_HOUR=60*t.ONE_MINUTE;t.TWO_HOURS=2*t.ONE_HOUR;t.ONE_DAY=24*t.ONE_HOUR;t.TWO_DAYS=2*t.ONE_DAY;t.ONE_WEEK=7*t.ONE_DAY;t.ONE_MONTH=32*t.ONE_DAY;t.isSameDay=function(e,n){return e.getDate()===n.getDate()&&Math.abs(n.getTime()-e.getTime())<t.ONE_DAY};t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};t.isSameYear=function(e,t){return e.getFullYear()===t.getFullYear()};t.isThisWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.isLastWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY-t.ONE_WEEK),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.toLocaleDateString=function(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}};t.toLocaleTimeString=function(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}});
define("@ms/utilities-date-time/lib/iso",["require","exports","@ms/utilities-strings/lib/index"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.iso8601DateTimeToJsDate=function(e){return new Date(e)};t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,s=r.getFullYear()+"",o=n.leftPad(r.getMonth()+1+"",2),u=n.leftPad(r.getDate()+"",2),a=n.leftPad(r.getHours()+"",2),f=n.leftPad(r.getMinutes()+"",2),l=n.leftPad(r.getSeconds()+"",2),c=(i?"+":"-")+n.leftPad(i?(Math.ceil(r.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(r.getTimezoneOffset()/60)+"",2)+n.leftPad((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}});
define("@ms/utilities-date-time/lib/sharePoint",["require","exports","@ms/utilities-strings/lib/index","./relativePast","./DateTime.resx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var s=e.split("|");if("0"===s[0])return e.substring(2);var o="1"===s[1],u=s[2],a=s[3]||"",f=s[4]||"";switch(u){case"1":return r.getRelativeDateTimeResx("AFewSeconds",t,o);case"2":return r.getRelativeDateTimeResx("AboutAMinute",t,o);case"3":return r.getRelativeDateTimeIntervalString(Number(a),"XMinutes",t,o);case"4":return r.getRelativeDateTimeResx("AboutAnHour",t,o);case"5":return a?n.format(r.getRelativeDateTimeResx(o?"TomorrowAndTime":"YesterdayAndTime",t),a):r.getRelativeDateTimeResx(o?"Tomorrow":"Yesterday",t);case"6":return r.getRelativeDateTimeIntervalString(Number(a),"XHours",t,o);case"7":return f?n.format(i.default.RelativeDateTime_DayAndTime,a,f):a;case"8":return r.getRelativeDateTimeIntervalString(Number(a),"XDays",t,o);case"9":return r.getRelativeDateTimeResx("Today",t)}return null}});
define("odsp-next/dataSources/album/odc/AlbumDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","../../base/odc/DataRequest","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/dataSources/upload/Upload","../../base/odc/ISkyApiErrorCodes","../../item/odc/SkyApiErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NEW_ALBUM_TAG="__New";t.AUTO_ALBUM_TAG="__Auto";t.WEEKEND_RECAP_ALBUM_TAG="__WeekendRecap";t.EVENT_RECAP_ALBUM_TAG="__EventRecap";var p=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(s.urlDataSource);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,s=this._getIdsFromKeyArray(n),u=s.slice(0,20),a={id:null,name:e,items:u,action:t.CREATE_ALBUM_ACTION};return(new o.default).send({requestType:"POST",postData:JSON.stringify(a),apiName:t.MODIFY_ALBUM_API_NAME+"."+a.action,url:this._getModifyAlbumUrl(),isErrorExpectedCallback:h.isExpectedSkyApiError}).then(function(e){if(!n||n&&n.length<20)return e;u=s.slice(20);var o={id:e.id,items:u,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(u,o).then(function(t){return e},function(e){var t={errorType:l.UploadErrorType.other,error:new Error(e.data.message)};return i.default.wrapError(t)})},function(e){var t=l.UploadErrorType.other;e.data.code===c.ISkyApiErrorCodes.nameCollision&&(t=l.UploadErrorType.conflict);var n={errorType:t,error:new Error(e.data.message)};return i.default.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new o.default).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new o.default,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+i.action,url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:h.isExpectedSkyApiError})};t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return f.serializeQuery(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),s=new o.default,u={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return s.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+u.action,url:r,requestType:"POST",postData:JSON.stringify(u),isErrorExpectedCallback:h.isExpectedSkyApiError}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return i.default.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return a.default.start({apiName:t.MODIFY_ALBUM_API_NAME+"."+n.action,url:r,batchSize:20,items:e,isErrorExpectedCallback:h.isExpectedSkyApiError,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return u.default.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return f.deserializeQuery(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums";return t})(r.default);t.default=p});
define("@ms/odsp-datasources/lib/dataSources/upload/Upload",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(t.UploadState||(t.UploadState={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.invalidName=4]="invalidName";e[e.fileSize=5]="fileSize";e[e.emptyFileOrFolder=6]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib";e[e.overQuota=8]="overQuota";e[e.accessDenied=9]="accessDenied";e[e.lockMismatch=10]="lockMismatch";e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder";e[e.folderUploadNotSupported=12]="folderUploadNotSupported";e[e.versionMismatch=13]="versionMismatch";e[e.authFailure=14]="authFailure";e[e.targetFolderMissing=15]="targetFolderMissing";e[e.itemNotFound=16]="itemNotFound";e[e.malwareDetected=17]="malwareDetected";e[e.throttled=18]="throttled";e[e.pathTooLong=19]="pathTooLong";e[e.disconnected=20]="disconnected";e[e.unlockRequired=21]="unlockRequired";e[e.insufficientVaultQuota=22]="insufficientVaultQuota"})(t.UploadErrorType||(t.UploadErrorType={}))});
define("odsp-next/dataSources/base/odc/ISkyApiErrorCodes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ISkyApiErrorCodes={nameCollision:1e3,fileSizeLimit:2e3,moveIntoMounted:2028,moveIntoOwn:2029}});
define("odsp-next/utilities/array/ArrayHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeDuplicates=function(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.findMatch=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return{value:r,index:n}}}});
define("odsp-next/dataSources/item/ItemTaskObserver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.Graft=a;var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(o.resourceKey):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,o=r;i<o.length;i++){var a=o[i],f=t[a],l=new s.default(a),c=this._getStoreItem(a);if(c){c.parent;var h=n.__rest(c,["parent"]);u.default(l,h)}u.default(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];u.default(l,v)}e[a]=l}for(var m=0,g=r;m<g.length;m++){var y=(l=e[a=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new s.default(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=r;w<E.length;w++){a=E[w];delete(f=t[a]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemsStore:o.resourceKey});return t})(r.default);t.ItemTaskObserver=l;t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ResolvedResourceTypeFactory(l)});t.default=l});
define("odsp-next/models/task/Task",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.default=n});
define("odsp-next/models/item/OneDriveItem",["require","exports","../../dataSources/url/QueryType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=n.default.Files;this.displayType=n.default.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.default=r});
define("odsp-next/models/store/ItemsStore",["require","exports","tslib","../item/OneDriveItem","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../item/ItemType","../../utilities/array/ArrayHelper","@ms/odsp-utilities/lib/graft/Graft","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.isFeatureEnabled(h.ReadOnlyItemsStore);function d(e){return e&&e.item&&e.item.peek().key}function v(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var m=(function(e){n.__extends(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new s.default({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._handleSetItem.apply(this,n.__spreadArrays([e],t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&v(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&v(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=d(t=this.getValue(n));if(r){var i=u.deserializeQuery(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=d(t=this.getValue(n));if(r){var i=u.deserializeQuery(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=n.__spreadArrays(this._vaultItemsToPurge);e<t.length;e++){var i=t[e],s=void 0;if(i.vault&&i.vault.root){(s=new r.default(i.key)).name=i.name;s.displayName=i.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(i,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){if(t){var r=t.peek(),i=!1,s=[];if(r){s.push(r);switch(r.type){case f.default.Folder:case f.default.Media:i=!0}}for(var o in this._itemSetsKeys){var u=this.getValue(o),a=u.item&&u.item.peek(),l=a&&a.key;if(l&&(l===e||i&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,u.key,""):s.push(a);u.isExpired=!0}}s.forEach(n?this._purgeItem:this._invalidateItem,this)}};t.prototype._purgeItem=function(e,t){var n=t||new r.default(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new r.default(e.key);c.default(t,e);c.default(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=[];p&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="item="+t,r=p?"item_write="+t:n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=a.objectStrictEquality;o.setValue(r,u);s=p?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,f=l.removeDuplicates(n.__spreadArrays([e.key],t));u<f.length;u++){var c=f[u];s(c)}return i[0]};return t})(i.default);t.ItemsStore=m;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(m)});t.default=m});
define("@ms/odsp-utilities/lib/graft/Graft",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"})(t.GraftOperationType||(t.GraftOperationType={}));t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=function e(t,l){if(!r(t))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!r(l))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(l===t)return t;for(var c=0,h=Object.keys(l);c<h.length;c++){var p=h[c],d=l[p],v=t[p];if(d!==v){var m=d;if(o(m))if(1===m.graftOperationType){v=void 0;d=g=m.value}else if(u(m)){var g=m.value;if(void 0!==t[p])continue;d=g}else{if(!f(m)){if(a(m)){delete t[p];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(g=m.value))continue;d=g}var y=void 0;if(i(d))y=new Date(d.getTime());else if(s(d)){var b=v;s(b)||(b=[]);b.splice.apply(b,n.__spreadArrays([0,b.length],d));y=b}else if(r(d)){var w=v;r(w)||(w={});e(w,d);y=w}else y=d;t[p]=y}}return t};function r(e){return"object"==typeof e&&!!e}function i(e){return e instanceof Date}function s(e){return Array.isArray(e)}function o(e){return r(e)&&!!e.graftOperationType}function u(e){return 4===e.graftOperationType}function a(e){return 3===e.graftOperationType}function f(e){return 2===e.graftOperationType}});
define("@ms/odsp-microservice/lib/microService/helpers/BabylonSupport",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["glb","gltf"],r=["cool","fbx","obj","ply","stl","3mf"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("odsp-next/dataSources/photo/odc/GetOneDriveItemWithSupportedCommands",["require","exports","tslib","../../item/odc/SkyApiCommands"],function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});var s=((i={})[r.addTag]="1",i[r.addToAlbum]="1",i[r.deleteCommand]="3",i[r.defaultClick]="1",i[r.download]="3",i[r.embed]="3",i[r.modifyCaption]="1",i[r.rename]="1",i[r.share]="1",i[r.viewOriginal]="1",i),o=[".jfif",".jfif-tbnl",".jpe",".jpg",".jpeg"];t.getOneDriveItemWithSupportedCommands=function(e){var t;return n.__assign(n.__assign({},e),{properties:{commandsSupported:n.__assign(n.__assign({},s),e.extension&&u(e.extension)?(t={},t[r.rotate]="1",t):{})}})};function u(e){return o.some(function(t){return e.toLowerCase()===t})}t.isPhotoExtensionSupportedForRotate=u});
define("odsp-next/dataSources/item/DeletionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/list/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio";e[e.Bohemia=9]="Bohemia";e[e.Prague=10]="Prague"})(n=t.DocumentType||(t.DocumentType={}));t.default=n});
define("odsp-next/dataSources/item/odc/ColumnsHelper",["require","exports","tslib","knockout","../../../models/item/ItemType","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../../dataSources/url/QueryType","./ODCDataSource.resx","../../../controls/infoPane/InfoPane.resx","@ms/odsp-utilities/lib/locale/Locale","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getColumns=function(e,t,r){void 0===r&&(r={});var f;if(r){var b=(function(e,t){var r,i=t.consume(c.platformDetection).isMobile&&!!t.consume(l.useMobileList.optional),f=n.__assign(n.__assign({},p("type","","FileTypeIcon",!1)),{minWidth:i?48:16,width:i?48:16,isIcon:!0,fieldType:s.ColumnFieldType.FileIcon}),b=v(!0),w=y(!0),E=m(),S=d(!0),x=n.__assign(n.__assign({},p("_shareHeroCommand","","_shareHeroCommand",!1)),{isIcon:!0,minWidth:16,width:16,fieldType:s.ColumnFieldType.ShareCommand}),T=v(!1),N=y(!1),C=d(!1),k=n.__assign(n.__assign({},p("dateTaken",a.default.informationDateTaken,"dateTaken",!0)),{fieldType:s.ColumnFieldType.DateTime}),L=i?h(f,[[b],[w,S,E]],n.__spreadArrays("userArranged"===e?[g()]:[],[b,w],"dateTaken"===e?[k]:[],[S,E])):n.__spreadArrays("userArranged"===e?[g()]:[],[f,b],[x],[w],"dateTaken"===e?[k]:[],[E,S]),A=i?h(f,[[b],[w,S,E]],[b,w,k,S,E]):n.__spreadArrays("userArranged"===e?[g()]:[],[f,b],[x],[w,k,E,S]),O=n.__assign(n.__assign({},p("dateAccessed",u.default.SchemaColumnLastOpened,"dateAccessed",!0)),{fieldType:s.ColumnFieldType.DateTime}),M=n.__assign(n.__assign({},p("location",u.default.SchemaColumnLocation,"",!1)),{showTooltip:!0}),_=i?h(f,[[b],[O,S,E]],[b,O,S,E]):[f,b,O,w,M,S],D=m(),P=[f,b,D,S],H=[f,b,D,S],B=i?h(f,[[T],[N,C,E]],[T,N,C,E]):[f,T,E,N,M,C],j=n.__assign(n.__assign({},p("location",u.default.SchemaColumnOriginalLocation,"location",!0)),{width:300,showTooltip:!0}),F=n.__assign(n.__assign({},p("dateDeleted",u.default.SchemaColumnDateDeleted,"dateDeleted",!0)),{fieldType:s.ColumnFieldType.DateTime}),I=i?h(f,[[b],[S,F,j]],[b,F,S,j]):[f,b,j,F,S];return(r={})[o.default.Files]=L,r[o.default.Photos]=A,r[o.default.Recent]=_,r[o.default.SharedWithMe]=P,r[o.default.DocsInCommon]=H,r[o.default.Search]=B,r[o.default.RecycleBin]=I,r})(r.defaultSortField,t);e.type===i.default.Folder&&(f=b[e.displayType]||b[o.default.Files]);f&&(f=f.map(function(e){return n.__assign(n.__assign({},e),r.isSortEnabled?(e.internalName||e.key)===r.sortField?{isSorted:!0,isAscending:r.isAscending}:{isSorted:!1}:{sortable:!1})}))}return f};function h(e,t,r){for(var i=[],s=0;s<t.length;s++)for(var o=0,u=t[s];o<u.length;o++){var a=u[o];i.push(n.__assign(n.__assign({},a),{customRowNumber:s}))}for(var f=[e,n.__assign(n.__assign({},p("","","",!1)),{width:900,customFields:i})],l=0,c=r;l<c.length;l++){var h=c[l];f.push(n.__assign(n.__assign({},h),{isVisible:!1,isVisibleMobile:!1}))}return f}function p(e,t,n,i,o){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:i,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:s.ColumnFieldType.Text,filterable:!1,isFocused:r.observable(!1)}}function d(e){return n.__assign(n.__assign({},p("size",u.default.SchemaColumnSize,"size",e)),{isHtml:!0,fieldType:s.ColumnFieldType.FileSize,sortable:e})}function v(e){return n.__assign(n.__assign({},p("displayName",u.default.SchemaColumnName,"displayName",e)),{isCollapsable:!1,minWidth:220,width:440,fieldType:s.ColumnFieldType.Name,sortable:e,hasListItemMenu:!0})}function m(){return n.__assign(n.__assign({},p("defaultSubText",u.default.SchemaColumnSharing,"",!1)),{fieldType:s.ColumnFieldType.Shared})}function g(){return n.__assign(n.__assign({},p("",u.default.SchemaColumnUserArranged,"userArranged",!0)),{isVisible:!1,isVisibleMobile:!1})}function y(e){var t=u.default.SchemaColumnModified;return n.__assign(n.__assign(n.__assign({},p("dateModified",t,"dateModified",e)),{sortable:e,sortDescFirst:e,fieldType:s.ColumnFieldType.DateTime}),"ml"===(""+f.default.language).toLowerCase()?{width:150}:{})}});
define("@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity";e[e.MruName=36]="MruName";e[e.ShareCommand=37]="ShareCommand";e[e.PinCommand=38]="PinCommand";e[e.Thumbnail=39]="Thumbnail";e[e.ImageSize=40]="ImageSize";e[e.Location=41]="Location";e[e.Geolocation=42]="Geolocation"})(n=t.ColumnFieldType||(t.ColumnFieldType={}));t.default=n});
define("odsp-next/dataSources/base/odc/ItemErrorProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/ItemType","../../item/ItemDataSource.resx","@ms/odsp-utilities/lib/string/StringHelper","../../item/ItemTaskObserver","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.processError=function(e){var t,n=e.requestKey,r=e.error,s=e.itemName,o=e.observer;switch(r&&r.data&&r.data.code||0){case 101:case 102:case 103:case 152:t=1;break;case 161:t=7;break;case 162:t=8;break;case 200:t=4;break;case 201:t=5;break;case 202:t=3;break;case 3e3:case 10009:t=2;break;case 3403:t=6;break;case 3404:t=9;break;case 9017:break;default:t=0}var a=this.getError(r,s);o.update([new u.Task(n).succeed({item:{key:n,type:i.default.Error,error:{type:t,data:a},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]);return{error:a,key:n}};t.prototype.getError=function(e,t){var n,r,i,u=e&&e.data&&e.data.code||0;switch(u){case 209:n=s.default.ThrottledItemTitle;r=s.default.ThrottledItemSubText;break;case 509:n=s.default.StorageBandwidthLimitViewTitle;break;case 1e3:n=s.default.DuplicateName;break;case 1006:n=s.default.InvalidChar;break;case 2005:case 2006:n=s.default.LengthExceeded;break;case 3e3:n=s.default.ItemNotFoundTitle;r=s.default.ItemNotFoundSubText;break;case 9001:n=o.format(s.default.ItemInUse,t);break;case 9006:n=s.default.SharingBlockedVisitorViewTitle;break;default:n=s.default.DefaultTitle;r=s.default.DefaultSubText}if(161===u){i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null;this.resources.consumeAsync(a.vault).then(function(e){return e.setVaultLockState({root:void 0,isLocked:!0},void 0,!0)})}return{errorCode:u,errorTitle:n,errorDetailedText:r,actionUrl:i}};return t})(r.default);t.default=f});
define("odsp-next/dataSources/item/odc/MoveCopyDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../url/odc/UrlDataSource"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){this._capabilities||(this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!0,supportsMoveCopyFilterParams:!1,supportsCopyCrossSite:!1,supportsMoveCrossSite:!1,supportsThrottling:!1,supportsProgressCaching:!1});return this._capabilities};t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())};t.prototype.hasMatchingId=function(e,t){return e===t.id};t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new i.default,r=u(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(r),isErrorExpectedCallback:function(e){switch(e.errorCode){case 2001:return!0;default:return!1}}})};t.prototype._getCopyItemsAsyncUrl=function(){return s.default.skyApiBaseUrl+"CopyItemsAsync"};return t})(r.default);t.default=o;function u(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}t.convertMoveCopyContextToPostData=u});
define("@ms/odsp-utilities/lib/async/Semaphore",["require","exports","./Promise","./Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var i={callback:e,signal:null,canceled:!1,result:null};i.signal=new r.default(function(){i.canceled=!0;n.default.is(i.result)&&i.result.cancel()});this._queue.push(i);t=i.signal.getPromise()}return n.default.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.default=i});
define("odsp-next/models/itemsScope/ItemsScopeFeature.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/PLTFeatures","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isItemsScopeEnabledResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabled",factory:{dependencies:{},create:function(e){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive)||r.isFeatureEnabled(r.UseItemsScopeInSitesForODB):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInFilesPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInFilesPivot",factory:{dependencies:{},create:function(){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInRecentPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInRecentPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.EnableRecentWithGraphAddon)}}}});t.isItemsScopeEnabledInSharedPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSharedPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.UseItemsScopeInShared)}}}});t.isItemsScopeEnabledInCrossSitePivotsResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInCrossSitePivots",factory:{dependencies:{},create:function(){return{instance:!!r.isOneDrive&&r.isFeatureEnabled(r.UseItemsScopeInSitesForODB)}}}});t.isItemsScopeEnabledInAllPhotosPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPhotosPivot",factory:{dependencies:{platformDetection:i.platformDetection},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllPhotos)&&(!e.platformDetection.isIE||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableIE))&&(!e.platformDetection.isSafari||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableSafari))&&(!e.platformDetection.isMobile||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableMobile))}}}});t.isItemsScopeEnabledInSingleAlbumViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSingleAlbumView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSingleAlbum)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInSingleTagViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSingleTag)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInSinglePlaceViewResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSinglePlace",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInSinglePlace)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllPhotosFilePickerResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPhotosFilePicker",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableInFilePicker)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllTagsPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllTagsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllTags)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllPlacesPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllPlacesPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInPlaces)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isItemsScopeEnabledInAllAlbumsPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInAllAlbumsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAlbums)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isVroomEnabledInItemsScopeAllPhotosPivotResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInAllPhotosPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:t.isItemsScopeEnabledInAllPhotosPivotResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeAllPhotos)&&e.isItemsScopeEnabledInAllPhotosPivot}}}});t.isVroomEnabledInItemsScopeSingleTagViewResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInSingleTagView:t.isItemsScopeEnabledInSingleTagViewResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeSingleTag)&&e.isItemsScopeEnabledInSingleTagView}}}});t.isVroomEnabledInItemsScopeSinglePlaceViewResourceKey=new n.ResourceKey({name:e("module").id+".isVroomEnabledInSinglePlaceView",factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:t.isItemsScopeEnabledInSinglePlaceViewResourceKey},create:function(e){return{instance:r.isFeatureEnabled(r.UseVroomInItemsScopeSinglePlace)&&e.isItemsScopeEnabledInSinglePlaceView}}}})});
define("odsp-next/dataSources/rootItems/RootItems.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("rootItems")});
define("odsp-next/dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RansomwareDetectionDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/restore/odc/RestoreOperationDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RestoreOperationDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RestoreActivitiesDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/search/odc/SearchDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./SearchDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/item/odc/RecycleBinDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/odc/UrlDataSource","../../url/QueryType","../DeletionType","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=u.default[u.default.RecycleBin].toLowerCase(),p=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(u.default.RecycleBin),r=t.getRootItemTitle(n),i=new(t.resources.consume(c.resourceKey));i.update([new c.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:u.default.RecycleBin,displayType:u.default.RecycleBin,name:r,displayName:r}})]);i.flush();return t}t.prototype.getItem=function(t){var n=this;return e.prototype.getItem.call(this,t).then(function(e){return f.default.wrap(e)},function(r){if(9017===r.errorCode){n.isLargeRecycleBin(!0);return e.prototype.getItem.call(n,t)}return f.default.wrapError(r)})};t.prototype.emptyRecycleBin=function(e,t){t&&this.isLargeRecycleBin(!0);return this._deleteNextBatch(e,t)};t.prototype.emptyRecycleBinAsync=function(){return this._deleteAll()};t.prototype.getRootItemTitle=function(e){return r.default.RecycleBin};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=h,r):e.prototype._getItemKeyExtension.call(this,t,n)};t.prototype._deleteAll=function(){var e=o.default.skyApiBaseUrl+"DeleteAll";return(new l.default).sendPost("DeleteAll",e,"")};t.prototype._deleteNextBatch=function(t,n){var r=this,i=this._urlDataSource.getRootItemKey(u.default.RecycleBin);return e.prototype.getItem.call(this,{parentKey:i,startIndex:0,pageSize:100}).then(function(s){if(s.children&&s.children.length)return e.prototype.deleteItems.call(r,{parentKey:i,deletionType:a.default.PermanantDelete,items:s.children}).then(function(){if(s.nextRequestToken||n){t(t()+s.children.length);return r._deleteNextBatch(t,n)}})})};return t})(i.default);t.default=p});
define("odsp-next/dataSources/language/odc/LanguageDataSource",["require","exports","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.prototype.getCurrentLanguage=function(){return n.default.language||$Config.lang};e.prototype.getCurrentLanguageCode=function(){return $Config.mkt};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{})});
define("odsp-next/dataSources/languagePicker/odc/LanguagePickerDataSource",["require","exports","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/resources/Resources","../../language/odc/LanguageDataSource"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._languageDataSource=t.languageDataSource;this._startXHR=t.startXHR||n.default.startAndPostProcess}e.prototype.getLanguages=function(){var e=this;return this._startXHR({url:"/GetLanguageList"},function(t,n){var r=JSON.parse(t.responseText),i=r.Canary,s=r.LanguageInfoList,o=[];for(var u in s)s.hasOwnProperty(u)&&o.push(s[u]);var a=e._languageDataSource.getCurrentLanguage();return{languageList:o,canary:i,currentLanguage:a=a&&a.toLowerCase()}})};e.prototype.saveLanguage=function(e,t){var n="canary="+encodeURIComponent(t)+"&lang="+e;return this._startXHR({url:"/handlers/languagesave.mvc?"+n,json:n},function(e,t){return e.responseText})};return e})();t.default=s;t.resourceKey=r.createResolvedResourceKey(e("module").id,s,{languageDataSource:i.resourceKey})});
define("odsp-next/dataSources/leftNav/odc/LeftNavDataSource",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../utilities/features/Features","../../../utilities/features/PLTFeatures","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-datasources/lib/Permissions","../../url/PageType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../controls/leftNav/LeftNav.resx","./ODCLeftNavDataSource.resx","../../../dataSources/base/odc/DataRequest","../../../controls/leftPane/LeftPane.resx","../../../resources/DataSourceResourceKeys","./NotificationLinks","../../../utilities/attribution/AttributionHelper","../../../controls/fluentStyling/FluentStyling.key","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(){var t,n=e.call(this)||this;n.mapPageToLeftNavSections=((t={})[f.default.StorageInfo]=[4,3],t[f.default.StorageOptions]=[4,3],t[f.default.PhotoPreferences]=[4,3],t[f.default.ManageVault]=[4,3],t[f.default.Restore]=[4,3],t[f.default.AppData]=[4,3],t[f.default.Files]=[0,1,2],t[f.default.Photos]=[0,1,2],t[f.default.TextFileEditor]=[0,1,2],t);n._urlDataSource=n.resources.consume(c.urlDataSource);n._identity=n.resources.consume(m.identity).getIdentity();n._attributionHelper=n.resources.consume(y.resourceKey);n._linkGroups=r.observableArray([]);n._notificationLinks=new(n.managed(g.default));n.needsBottomPadding=n._notificationLinks.needsBottomPadding;n._isFluentEnabled=n.resources.consume(b.resourceKey);return n}t.prototype.getLinkGroups=function(e){var t=this._urlDataSource.getPageType();if(!(t===this._previousPage||this._previousPage!==f.default.Files&&this._previousPage!==f.default.Photos||t!==f.default.Files&&t!==f.default.Photos)){this._previousPage=t;return this._linkGroups}this._previousPage=t;this._linkGroups.removeAll();if(this._isPartApplicable(0)){this._getNavLinks(e);this._linkGroups.push(this._navLinks)}this._isPartApplicable(1)&&this._identity.type===a.IdentityType.msa&&this._getDevices();if(this._isPartApplicable(3)){this._getOptions(e);this._linkGroups.push(this._optionsLinks)}return this._linkGroups};t.prototype.getNotificationLinks=function(){var e=this._notificationLinks.items;this._isPartApplicable(2)?this._notificationLinks.populateItems():this._notificationLinks.clearItems();return e};t.prototype._isPartApplicable=function(e){var t=this._urlDataSource.getPageType(),n=this.mapPageToLeftNavSections[t];return n&&-1!==n.indexOf(e)};t.prototype._getNavLinks=function(e){var t,n,i=this,u={text:s.isFeatureEnabled(o.OdcSuiteNavSearchBox)&&(null===(n=null===(t=FilesConfig)||void 0===t?void 0:t.SuiteNavConfig)||void 0===n?void 0:n.UserDisplayName)?FilesConfig.SuiteNavConfig.UserDisplayName:"OneDrive",url:this._urlDataSource.getFilesQueryUrl(),isExpanded:r.observable(!0),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQueryFiles()}),isFocused:r.observable(!1),automationId:"LeftNav-OneDriveGrouping",links:r.observableArray([{text:v.default.Files,automationId:"FilesPageLink",url:this._urlDataSource.getFilesQueryUrl(),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQueryFiles()}),isFocused:r.observable(!1),altText:h.default.filesAlt,engagementName:"Files",icon:this._isFluentEnabled?new w.default("FabricFolder"):void 0},{text:v.default.Recent,url:this._urlDataSource.getRecentQueryUrl(),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQueryRecent()}),isFocused:r.observable(!1),altText:h.default.recentAlt,engagementName:"Recent",icon:this._isFluentEnabled?new w.default("History"):void 0},{text:v.default.Photos,automationId:"PhotosPageLink",url:this._urlDataSource.getAllMyPhotosQueryUrl(),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQuery(l.default.Photos)}),isFocused:r.observable(!1),altText:h.default.photosAlt,engagementName:"Photos",icon:this._isFluentEnabled?new w.default("Photo2"):void 0},{text:v.default.Shared,url:this._urlDataSource.getSharedByQueryUrl(),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQuerySharedByMe()||i._urlDataSource.isCurrentQuerySharedWithMe()}),isFocused:r.observable(!1),altText:h.default.sharedAltOdc,engagementName:"Shared",icon:this._isFluentEnabled?new w.default("People"):void 0},{text:v.default.RecycleBin,url:this._urlDataSource.getRecycleBinQueryUrl(),isActive:this.createPureComputed(function(){e();return i._urlDataSource.isCurrentQueryRecycleBin()}),isFocused:r.observable(!1),altText:h.default.recycleBinAlt,engagementName:"RecycleBin",icon:this._isFluentEnabled?new w.default("RecycleBin"):void 0}])};this._navLinks=u};t.prototype._getOptions=function(e){var t=this,n=this._attributionHelper.getPurchaseAttribution({source:"LeftNavPageList",cta:"UpgradePage"});this._optionsLinks={text:p.default.Options,url:this._urlDataSource.getNewManageStorageUrl(),isExpanded:r.observable(!0),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===f.default.StorageInfo}),isFocused:r.observable(!1),automationId:"LeftNav-OptionsGrouping",links:r.observableArray([{text:v.default.NewManageStorage,url:this._urlDataSource.getNewManageStorageUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===f.default.StorageInfo}),isFocused:r.observable(!1),altText:v.default.NewManageStorage},{text:v.default.PlansAndUpgrades,url:this._urlDataSource.getUpgradeOptionsUrl(n),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===f.default.StorageOptions}),isFocused:r.observable(!1),altText:v.default.PlansAndUpgrades},{text:p.default.OfficeFileFormats,url:this._urlDataSource.getOfficeFileOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:p.default.OfficeFileFormats},{text:p.default.Vault,url:this._urlDataSource.getManageVaultUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===f.default.ManageVault}),isFocused:r.observable(!1),altText:p.default.Vault},{text:p.default.Photos,url:this._urlDataSource.getPhotoPreferencesUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===f.default.PhotoPreferences}),isFocused:r.observable(!1),altText:p.default.Photos},{text:p.default.Tagging,url:this._urlDataSource.getPhotosOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:p.default.Tagging},{text:p.default.Notifications,url:this._urlDataSource.getNotificationOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:p.default.Notifications},{text:p.default.DeviceBackups,url:this._urlDataSource.getDeviceBackupsOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:p.default.DeviceBackups},{text:p.default.Restore,url:this._urlDataSource.getNewRestoreOptionsUrl("PROD_OneDrive-Web_LeftNav_AppDataLink"),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===f.default.Restore}),isFocused:r.observable(!1),altText:p.default.Restore},{text:p.default.AppData,url:this._urlDataSource.getNewAppDataOptionsUrl("PROD_OneDrive-Web_LeftNav_AppDataLink"),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===f.default.AppData}),isFocused:r.observable(!1),isHidden:r.observable(!s.isFeatureEnabled(s.EnableManageAppDataPage)),altText:p.default.AppData},{text:p.default.Search,url:this._urlDataSource.getSearchOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:p.default.Search}])}};t.prototype._getDevices=function(){var e=this,t=this._urlDataSource.getDevicesApiUrl();(new d.default).send({apiName:"GetDevices",url:t}).then(function(t){var n=t.devices;n&&e._isPartApplicable(1)&&n[0]&&e._navLinks.links.push({text:v.default.Devices,url:e._urlDataSource.getDevicesPageUrl(),isActive:r.observable(!1),isFocused:r.observable(!1),openInNewTab:r.observable(!0),icon:e._isFluentEnabled?new w.default("ThisPC"):void 0})},function(e){u.default.log(e,"GetDevices")})};return t})(i.default);t.default=E});
define("odsp-next/dataSources/leftNav/odc/NotificationLinks",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../models/quota/QuotaStatus","../../../models/quota/QuotaEventSource","../../../actions/NavigationAction","../../../resources/ODCResourceKeys","../../../controls/leftPane/LeftPane.resx","../../../resources/ControlResourceKeys","../../../models/quota/QuotaEventDestination","../../../resources/ProviderResourceKeys","./ODCLeftNavDataSource.resx","../../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(a.urlDataSource);t._bundleLoader=t.resources.consume(h.bundleLoader);t._viewParams=t.resources.consume(l.viewParams);t._appsLink=t._getAppsLink();t._confidentialText=t._getConfidentialText();t.items=r.observableArray([]);t.needsBottomPadding=t.createObservable(!1);t._populate=t.createObservable(!1);t._isSearchPassThrough=t.createPureComputed(t._computeIsSearchPassThrough);t._quotaLoaded=t.createPureComputed(t._computeQuotaLoaded);t._items=t.createPureComputed(t._computeItems);t.createBackgroundComputed(t._updateItems);t._showUpsellBanner=t.createObservable(!1);t._userInfoProvider=t.resources.consume(h.userInfo.optional);t._storageOptionsProvider=t.resources.consume(h.storageOptions);t._isPremiumEligible=t.createPureComputed(t._computeIsPremiumEligible);t._isFluentEnabled=t.resources.consume(d.resourceKey);return t}t.prototype.populateItems=function(){this._populate(!0)};t.prototype.clearItems=function(){this._populate(!1)};t.prototype._computeIsPremiumEligible=function(){return this._storageOptionsProvider.isReady()?this._storageOptionsProvider.isEligibleForPremium():null};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(2).isLoaded()){if(!this._userStateProvider){this._userStateProvider=this.resources.consume(h.quota);this._quotaBarComponent=this._getQuotaBarComponent();this._overQuotaWarning=this._getOverQuotaWarning();this._premiumUpsellComponent=this._getPremiumUpsellComponent()}return!0}return!1};t.prototype._computeIsSearchPassThrough=function(){return this._urlDataSource.isSearchPassThrough(this._viewParams())};t.prototype._computeItems=function(){var e=this._computeBaseItems();window.FilesConfig&&(FilesConfig.df||FilesConfig.int)&&e.push(this._confidentialText);this._showUpsellBanner()&&this._quotaLoaded()&&e.indexOf(this._appsLink)>=0&&e.unshift(this._getAppUpsellComponent());return e};t.prototype._computeBaseItems=function(){if(!this._populate()){this.needsBottomPadding(!1);return[]}if(!this._quotaLoaded()){this.needsBottomPadding(!0);return[this._appsLink]}var e,t,n,r=this._userStateProvider.status(),i=this._userStateProvider.canUpgrade(),o=1===this._userStateProvider.accountState(),u=this._isSearchPassThrough(),a=r!==s.default.unknown&&r<s.default.critical&&(!i||this._isPremiumEligible());t=this._userStateProvider.isSoftLocked();e=this._userStateProvider.isGoingToBeLockedSoon();n=this._userStateProvider.isTemporararilyUnfrozen();var f=[];a&&this._isFluentEnabled&&f.push(this._premiumUpsellComponent);(o||t)&&f.push(this._quotaBarComponent);var l=n||e||t,c=!l&&r>=s.default.overQuota;if(o&&c&&!this._isFluentEnabled){this.needsBottomPadding(!1);f.push(this._overQuotaWarning)}else this.needsBottomPadding(!0);if(!l&&i&&!a&&!c&&!this._isFluentEnabled){var h=this._getUpgradeLink();(u||r===s.default.normal)&&(h.renderAs=this._appsLink.renderAs);f.push(h)}var p=r>=s.default.full||!i&&r===s.default.critical;l||u||!o||c||!p||this._isFluentEnabled||f.push(this._getCleanUpLink());a&&!this._isFluentEnabled&&f.push(this._premiumUpsellComponent);r<s.default.critical&&f.push(this._appsLink);return f};t.prototype._updateItems=function(){var e,t=this._items(),r=this.items.peek();t.length?(e=this.items).splice.apply(e,n.__spreadArrays([0,r.length],t)):this.items.removeAll()};t.prototype._getOverQuotaWarning=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-over-quota",params:{}}}};t.prototype._getQuotaBarComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-quota-bar",params:{}}}};t.prototype._getPremiumUpsellComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-premium-upsell-banner",params:{}}}};t.prototype._getUpgradeLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(o.default.leftNav,c.default.upgrade);return{text:f.default.Upgrade,url:t,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),action:new(this.managed(u.default))({beforeNavigation:function(){e._userStateProvider.logEvent(o.default.leftNav,c.default.upgrade)},url:t}),renderAs:6}};t.prototype._getAppUpsellComponent=function(){var e=this;return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-app-upsell",params:{message:p.default.AppUpsellMessage,buttonText:p.default.AppUpsellButtonText,action:new(this.managed(u.default))({url:"https://aka.ms/xhkpi9"}),onDismiss:function(){e._showUpsellBanner(!1);e._userInfoProvider.setUserInfo(7,3,null,"26C6F29F-016D-4309-8FA2-1C9B8151AFC9")}}}}};t.prototype._getAppsLink=function(){var e=this._urlDataSource.getOneDriveAppsUrl();return{text:f.default.GetOneDriveApps,url:e,action:new(this.managed(u.default))({url:e,target:"_blank"}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!0),renderAs:6,engagementName:"GetOneDriveApps"}};t.prototype._getCleanUpLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(o.default.leftNav,c.default.cleanUpFiles);return{text:f.default.cleanUpFiles,url:t,action:new(this.managed(u.default))({beforeNavigation:function(){e._userStateProvider.logEvent(o.default.leftNav,c.default.cleanUpFiles)},url:t}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!1),renderAs:6}};t.prototype._getConfidentialText=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:2,text:"Microsoft Confidential"}};return t})(i.default);t.default=v});
define("odsp-next/models/quota/QuotaStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unknown=-1]="unknown";e[e.normal=0]="normal";e[e.critical=1]="critical";e[e.full=2]="full";e[e.outOfSpace=3]="outOfSpace";e[e.overQuota=4]="overQuota"})(n||(n={}));t.default=n});
define("odsp-next/models/quota/QuotaEventSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.update=0]="update";e[e.leftNav=1]="leftNav";e[e.quotaBlock=2]="quotaBlock";e[e.frozenBlock=3]="frozenBlock";e[e.manageStorage=4]="manageStorage";e[e.lockedBlock=5]="lockedBlock";e[e.dragAndDrop=6]="dragAndDrop";e[e.premiumLeftNav=7]="premiumLeftNav";e[e.quotaBanner=8]="quotaBanner"})(n||(n={}));t.default=n});
define("odsp-next/actions/NavigationAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,a=t.target,f=void 0===a?"_top":a,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(o.navigation):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(u.viewParams):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),o=this._beforeNavigation;o&&o(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+a.serializeQuery(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=a.deserializeQuery(s);return!f.deepCompare(n,o)}return e!==r};t.dependencies={resources:l.resourceScopeKey,navigation:o.navigation,viewParamsObservable:u.viewParams};return t})(r.default);t.default=c;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/base/BaseAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-shared/lib/base/BaseModel","../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../dataSources/url/PageType","../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../providers/engagement/Engagement","@ms/utilities-error/lib/ApiError","../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,u=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(o.url.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(h.instrumentation.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=u.create(0);var p={deferEvaluation:!0};r.isAvailable=u.pureCompute(r._computeIsAvailable,p);r.isToggled=u.pureCompute(r._computeIsToggled,p);r.isExecuting=u.pureCompute(r._computeIsExecuting,p);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i&&!v.default.isActivated("E25DF3CA-AF06-4063-A8AE-BC792E58E3BB","5/7/2020","Obtain Engagement before launching action")?this.getEngagement():void 0,o=!v.default.isActivated("14943A66-AD8E-448D-84E4-A073B4A2EB23","5/21/2020","Log engagement before executing action"),f=!v.default.isActivated("BD7EDAD8-6C11-4782-B305-09BA04E543A7","6/23/2020","Call trackUserAction before executing action");try{if(i&&o){this._logEngagementEvent(i.data.extraData,s);f&&this.trackUserAction(this.name)}if(!(t=this.onExecute(e,i)))throw new Error("Action did not return a promise")}catch(e){a.default.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);if(i&&!o){r._logEngagementEvent(i.data.extraData,s);r.trackUserAction(r.name);i.end(e)}},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!u.default.isCanceled(t)&&a.default.log(t);if(i&&!o){r._logEngagementEvent(i.data.extraData,s);i.end(r.onCreateErrorEventArg(e,t,!1))}})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=u.default.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new r.Action({name:this.name,pageType:t&&f.default[t.getPageType()]||"",queryType:t&&l.default[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&u.default.isCanceled(t)?{resultType:c.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:t instanceof d.ApiError?{resultType:t.isExpected?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:c.ResultTypeEnum.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:c.ResultTypeEnum.Failure};return u.default.resolve(n)};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(p.resourceKey)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var r=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:i.UsageType[i.UsageType.Click],currentPage:r&&r.currentPageName()||"NA",previousPage:r&&r.previousPageName()||"NA",extraData:n.__assign(n.__assign({},e||{}),r&&r.getEngagementData()||{})})}};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{urlDataSource:o.url,instrumentationProvider:h.instrumentation.optional});return t})(s.default);t.default=m});
define("@ms/odsp-shared/lib/utilities/logging/events/Action.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.Action=n.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},r.Qos);t.default=t.Action});
define("@ms/odsp-utilities/lib/logging/events/UsageType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard";e[e.Drop=4]="Drop"})(t.UsageType||(t.UsageType={}))});
define("@ms/utilities-error/lib/ApiError",["require","exports","tslib","./CustomError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(r){var i=e.call(this,r)||this;i.name="ApiError";var s=r.innerError,o=s instanceof t?{correlationId:s.correlationId,isExpected:s.isExpected,code:s.code,extraData:s.extraData}:s instanceof Error?{code:s.name}:{},u=r.correlationId,a=void 0===u?o.correlationId:u,f=r.isExpected,l=void 0===f?o.isExpected:f,c=r.extraData;i.correlationId=a;i.isExpected=!!l;i.code=r.code||o.code||"";i.extraData=n.__assign(n.__assign({},o.extraData||{}),c||{});return i}return t})(r.CustomError);t.ApiError=i});
define("@ms/utilities-error/lib/CustomError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);this.message=t.message;this.innerError=e.innerError;for(var n in this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var r=Object.getPrototypeOf(this);Error.captureStackTrace&&Error.captureStackTrace(t,r);if(Object.setPrototypeOf){Object.setPrototypeOf(t,r);return t}};t.CustomError=n;if(Object.setPrototypeOf){n.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(n,Error)}});
define("odsp-next/models/quota/QuotaEventDestination",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unknown=0]="unknown";e[e.none=1]="none";e[e.learnMore=2]="learnMore";e[e.upgrade=3]="upgrade";e[e.cleanUpFiles=4]="cleanUpFiles";e[e.manageStorage=5]="manageStorage";e[e.wac=6]="wac";e[e.officePlans=7]="officePlans"})(n||(n={}));t.default=n});
define("odsp-next/utilities/attribution/AttributionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../models/quota/QuotaStatus","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/resources/Resources","../../utilities/purchaseLogging/AwaHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey("attributionHelper");var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(i.navigation);n._viewParams=n._navigation.viewParams;return n}t.prototype.appendPurchaseAttributionAndLogAction=function(e,t){return this.appendPurchaseAttribution(e,t)};t.prototype.appendPurchaseAttribution=function(e,t){var n=new u.default(t),r=this._viewParams.ocid||this._viewParams["WT.mc_id"];r||(r=this.getPurchaseAttribution(e));n.setQueryParameter("ocid",r);return n.toString()};t.prototype.getPurchaseAttribution=function(e){var t=this._viewParams.ocid||this._viewParams["WT.mc_id"];if(t)return t;var n=this._getUserState();return"PROD_OneDrive-"+(e.attributionEndpoint||"Web")+"_"+e.source+"_"+n+"_"+e.cta};t.prototype.logAttributionViaAWA=function(e){void 0===e&&(e={});f.default.logPagePurchaseAction(n.__assign({},e))};t.prototype._convertStatus=function(e){switch(e){case o.default.normal:return"Normal";case o.default.critical:return"Critical";case o.default.full:return"Full";case o.default.overQuota:case o.default.outOfSpace:return"OverLimit";default:case o.default.unknown:return"Unknown"}};t.prototype._getUserState=function(){return this._isUserStateProviderAvailable()&&this._userStateProvider.status?this._convertStatus(this._userStateProvider.status.peek()):"Unknown"};t.prototype._isUserStateProviderAvailable=function(){this._userStateProvider=this.resources.consume(s.quota.optional);this._bundleLoader=this.resources.consume(s.bundleLoader.optional);if(this._bundleLoader){return this._bundleLoader.getBundleInfo(2).isLoaded()}return!1};return t})(r.default);t.default=l});
define("odsp-next/utilities/purchaseLogging/AwaHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/ModuleLoader","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=/authkey=[!a-zA-Z0-9%]*/gi,a=/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi;function f(e){if(e){(e=decodeURIComponent(e+"")).length>2048&&(e=e.substring(0,2048));e=e.replace(u,"").replace(a,"")}return e}var l=window.$Config&&window.$Config.mkt,c=(function(){function e(){}e.init=function(){var t;if(!e.awaInit){var n=new o.Qos({name:"LoadAwaLibrary"});s.default.addPaths(((t={}).AWALIB="https://az725175.vo.msecnd.net/scripts/jsll-4",t));e.awaInit=i.loadModule({path:"AWALIB",getModule:function(){return new r.default(function(e,t){window.require(["AWALIB"],e,t)})}}).then(function(){var t={autoCapture:{onLoad:!1,onUnload:!1,click:!1,addIn:!1,jsError:!1,perf:!1,eventTooLong:!1},coreData:{appId:"OneDrive",market:l,referrerUri:f(document.referrer),requestUri:f(document.location.href),uri:f(document.location.href),title:"OneDrive"},cookiesToCollect:["_mkto_trk"],syncMuid:!0,ix:{a:!0,g:!0}};window.awa.init(t);e.hasBeenInitialized=!0;n.end({resultType:o.ResultTypeEnum.Success})},function(e){n.end({resultType:o.ResultTypeEnum.Failure})})}return e.awaInit};e.logPagePurchaseAction=function(t){var r=this;e.init().then(function(){var e=n.__assign(n.__assign({},t),{behavior:awa.behavior.ADDTOCART});r.logEvent(e,function(e){awa.ct.captureContentPageAction(e)})})};e.logPageViewed=function(t){var n=this;e.init().then(function(){n.logEvent(t,function(e){awa.ct.capturePageView(e)})})};e.logEvent=function(t,r){var i=this;e.init().then(function(){var e=n.__assign(n.__assign({},t),{uri:i._getFullCleanUrl(t.uri||document.location.href),referrerUri:i._getFullCleanUrl(t.referrerUri||document.referrer)});r(e)})};e._getFullCleanUrl=function(e){void 0===e&&(e="");var t=e;"#"===t.charAt(0)&&(t=e.replace("#",document.location.origin+"?"));return f(t)};e.hasBeenInitialized=!1;return e})();t.default=c});
define("odsp-next/dataSources/peoplePicker/odc/PeoplePickerDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/EmailAddressParser","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){return{supportsMruCaching:!1}};t.prototype.search=function(e,t){return this.resources.consumeAsync(o.peopleService).then(function(t){return t.getContacts(e)}).then(function(e){return e.map(function(e){var t="",n=e.emailAddresses;if(n&&n.length>0)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s&&s.address&&s.address.length>0){t=s.address;break}}return{userId:e.displayName,name:e.displayName,email:t}})})};t.prototype.resolve=function(e,t){var n,r=this,s=function(){if(n){n.cancel();n=void 0}};return new i.default(function(o,u){var a=function(e){s();o(e)};n=i.default.timeout(2e3).then(function(){a(r._getPersonFromQuery(e))});r.search(e,t).then(function(t){0===t.length?a(r._getPersonFromQuery(e)):a(t[0])},function(t){a(r._getPersonFromQuery(e))})},s)};t.prototype.getPersonaDetails=function(e){return null};t.prototype.subscribePresence=function(e,t){return{dispose:function(){}}};t.prototype.getPickerEntityInformation=function(e){return null};t.prototype._getPersonFromQuery=function(e){var t=new s.default(e),n={};if(t.getEmail()){n.name=t.getName()||"";n.image="";n.sharingInfo={type:0};n.isResolved=!0}n.email=t.getEmail()||e;return n};return t})(r.default);t.default=u});
define("@ms/odsp-utilities/lib/string/EmailAddressParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.default=n});
define("odsp-next/dataSources/sharing/odc/SharingDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/dateTime/DateTime","../SharingDataSource.resx","../../../models/item/ItemHelper","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./SharingDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._sharingDataHelper=new(t.managed(h.default));t._urlDataSource=t.resources.consume(c.urlDataSource);return t}t.prototype.manageSharingLinks=function(e,t){var n=this,r=t.name||t.link&&t.link.name,s=t.id||t.link&&t.link.id,o=t.link&&t.link.entityType||3,u=t.expiration,a=t.password,f=[t.person||{userId:s,name:void 0,email:void 0,sharingInfo:{item:e[0].item,role:t.role,type:o,userId:s}}],l={items:e.map(function(e){return e.item}),sendEmail:t.create,roleValue:this._sharingDataHelper.convertToSharingRole(t.create?t.role:5)},c={modifyPermissions:!t.create,link:{linkType:t.type,linkName:r}};u&&(c.link.expirationDateTime=u);void 0!==a&&(c.link.password=a);return this._setPermissions(f,l,c).then(function(e){return n._sharingDataHelper.getSharingLinks(e,{})},function(e){return e.people?n._sharingDataHelper.getSharingLinks([e],{}):i.default.wrapError(e)})};t.prototype.share=function(e,t){return this._setPermissions(e,t,{modifyPermissions:!1}).then(function(e){return{statusCode:0,errorMessage:"",people:e[0].people,itemId:e[0].item.id}},function(e){return e.people?e:i.default.wrapError(e)})};t.prototype.unshare=function(e){return this.updatePermissions(null,e,5)};t.prototype.updatePermissions=function(e,t,n,r){var s={items:[t],roleValue:this._sharingDataHelper.convertToSharingRole(n),sendEmail:!1,expiration:r};return this._setPermissions(e,s,{modifyPermissions:!0}).then(function(t){return{statusCode:0,errorMessage:"",people:5===n?e.map(function(e){e.sharingInfo.role=5;return e}):t[0].people}},function(e){return e.people?e:i.default.wrapError(e)})};t.prototype._setPermissions=function(e,n,r){var s=this,o={message:n.message,requireSignIn:n.requireSignIn,suppressNotification:!n.sendEmail,userAction:r.modifyPermissions?1:0,entities:[]},u=n.items;u&&u.length||(u=[]);if(u.length>1){var f=u.map(function(e){return s._urlDataSource.getKeyParams(e.key).id});o.ids=f;o.bundleName=this._getBundleName(u)}else{var l=u[0],c=this._urlDataSource.getKeyParams(l.key);o.id=c.id}for(var h=0;h<e.length;h++){var p=e[h],d={role:n.roleValue,type:0,email:p.email};p.sharingInfo&&(d.id=p.sharingInfo.userId);n.expiration&&(d.expirationDateTime=n.expiration);n.password&&(d.password=n.password);if(r.link){d.type=p.sharingInfo&&p.sharingInfo.type||3;d.linkType=r.link.linkType;d.linkName=r.link.linkName;d.expirationDateTime=r.link.expirationDateTime;d.password=r.link.password;p.sharingInfo&&(d.id=p.sharingInfo.userId)}else if(!p.email&&p.sharingInfo){d.id=p.userId;d.type=p.sharingInfo.type}else p.sharingInfo&&p.sharingInfo.type&&(d.type=p.sharingInfo.type);if(3===p.entityType){d.clientId=p.userId;if(r.link){d.type=3;d.linkType=4}else{d.type=7;d.expiry=1}delete d.email}o.entities.push(d)}var v=JSON.stringify(o);return(new a.default).send({apiName:"SetPermissions",url:t._ShareUrl,requestType:"POST",postData:v,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1007:return!0;case 3006:case 3007:case 3009:case 3012:case 3033:case 3034:case 3035:case 3036:case 3037:return!0;default:return!1}}}).then(function(e){if(e.permissions&&e.permissions.permissionScopes)return e.permissions.permissionScopes.map(function(e){return s._sharingDataHelper.getSharingScope(u,e)});if(e.primaryError&&e.primaryError.code){var t=e.errorResult.entity;return i.default.wrapError({statusCode:e.primaryError.code,errorMessage:e.primaryError.message,people:[s._sharingDataHelper.transformEntity(t,{statusCode:0,role:s._sharingDataHelper.parseEntityRole(t),type:void 0,userId:t.id||t.clientId})]})}return i.default.wrapError(e)},function(e){return e.data?i.default.wrapError(e.data):i.default.wrapError(e)})};t.prototype._getBundleName=function(e){var t="";if(e&&e.length){for(var n,r=e[0].parent,i=o.default.BundleNameShared,a=s.getFileSafeShortDate(new Date),f=!0,c=!0,h=0,p=e;h<p.length;h++){var d=p[h];if(d.photo&&!d.video)c=!1;else{if(!u.isOfficeDoc(d.extension)){c=f=!1;break}f=!1}}n=f?"Photos":c?"Documents":"Items";r&&!r.isRootFolder&&!r.isSpecialFolder&&r.name&&(i=l.format(o.default.BundleNameFolderName,r.name,"{0}","{1}"));t=l.format(i,o.default["BundleNameType"+n],a)}return t};t._ShareUrl=f.SKY_API_DOMAIN+"/API/2/SetPermissions";return t})(r.default);t.default=p});
define("odsp-next/models/item/ItemHelper",["require","exports","../../models/item/ItemType","./Item.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/interfaces/list/DocumentType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],u="Doc",a="Ppt",f="Xls",l="Vsd",c="Lib",h={WinDocuments:c,WinLibrary:c,WinMusic:c,WinPictures:c,WinPodcastLibrary:c,WinVideos:c,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:u,Docm:u,Docx:u,Dot:u,Dotm:u,Dotx:u,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:a,Ods:f,Odt:u,One:"One",Onepkg:"One",Onetoc2:"One",Notebook:"OneNotebook",Pot:a,Potm:a,Potx:a,Ppa:a,Ppam:a,Pps:a,Ppsm:a,Ppsx:a,Ppt:a,Pptm:a,Pptx:a,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:l,Vsd:l,Vsdm:l,Vsdx:l,Vsl:l,Vss:l,Vssm:l,Vssx:l,Vst:l,Vstm:l,Vstx:l,Xaml:"Xaml",Xla:f,Xlam:f,Xll:f,Xls:f,Xlsb:f,Xlsm:f,Xlsx:f,Xlt:f,Xltm:f,Xltx:f,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};t.getFriendlyItemType=function(e,t,s){var o=e.extension,u=o&&o.slice("."===o[0]?1:0),a=u&&u.toUpperCase(),f=p(e.itemFromServer&&e.itemFromServer.iconType||u);return e.isDocSet?r.default.fileTypeDocSet:f||e.type!==n.default.Folder?s||(e.panorama?r.default.fileTypePanorama:e.photo&&!e.video?i.format(r.default.fileTypeImage,a||"").trim():f?r.default["fileType"+f]:a?i.format(r.default.fileTypeUnknown,a):t?r.default.listItemType:r.default.fileTypeNoExtension):r.default.fileTypeFolder};t.getShortcutFileType=function(e){var t=e.slice(e.lastIndexOf(".")+1);return i.format(r.default.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):r.default.fileTypeNoExtension)};t.getShortcutFileTypeFromExtension=function(e){var t=r.default.fileTypeNoExtension;if(!e)return t;var n=p(i.capitalize(e));if(n)return r.default["fileType"+n];var s=e.toUpperCase();return s?i.format(r.default.fileTypeUnknown,s):t};function p(e){return h[e]}t.getNormalizedExtension=p;t.isOfficeDoc=function(e){return e&&-1!==o.indexOf(e)};t.getItemRoot=function(e){for(var t=e;t&&!t.isRootFolder;)t=t.parent;return t};t.isAutoAlbum=function(e){return d(e)&&!!e.properties.newTag};function d(e){return!!e.properties&&!!e.properties.autoAlbumTag}t.hasAutoAlbumTag=d;t.GetDocumentTypeFromExtension=function(e){if(!e)return s.DocumentType.Word;var t=p(i.capitalize(e.split(".").pop()));return"One"===t?s.DocumentType.OneNote:t===a?s.DocumentType.PowerPoint:t===f?s.DocumentType.Excel:t===l?s.DocumentType.Visio:s.DocumentType.Word}});
define("odsp-next/dataSources/sharing/odc/SharingDataHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","../../base/odc/ItemResultProcessor","../../item/ItemTaskObserver","../../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f={"-1":0,0:5,1:1,2:2,3:3,4:4,5:0},l=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(s.urlDataSource);t._itemResultProcessor=new(t.managed(o.default))({getRootItemTitle:function(){return""},getItemKeyExtension:function(e,t){return{}}});t._itemProvider=t.resources.consume(a.resourceKey);return t}t.prototype.getSharingLinks=function(e,t){for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];if(!t.filterScope||t.filterScope(o))for(var u=0,a=o.people;u<a.length;u++){var f=a[u].sharingInfo;if(3===f.type){var l=n.__assign(n.__assign({},f.link),{item:o.item});r.push(l)}}}return r};t.prototype.getSharingScope=function(e,t){var n=this,r=this._getShareItem(e,t),s=t.entities.map(function(e){var t=n.transformEntity(e,{statusCode:e.status,errorMessage:e.errorMessage,role:n.parseEntityRole(e),isChangeable:e.isChangeable,type:e.type,userId:e.id||e.clientId,link:n._getLinkFromEntity(r,e),email:e.email,name:e.name,expiration:e.expirationDateTime,hasPassword:e.hasPassword});1===t.sharingInfo.type&&(t.image=i.default.getProfileImage(t.userId||t.sharingInfo.userId));return t});return{id:t.id,refId:t.refId,canChange:t.canChange,item:r,people:s,hasPendingAccessRequests:!1}};t.prototype.parseEntityRole=function(e){return f[e.role]||5};t.prototype.convertToSharingRole=function(e){return f[e]};t.prototype.transformEntity=function(e,t){return{name:e.name,email:e.email,userId:e.id,sharingInfo:t}};t.prototype._getShareItem=function(e,t){var n,r=e.length>1,i=this._urlDataSource.getOwnerId(),s=t.id,o=this._urlDataSource.getKey(((n={}).id=s,n.cid=i,n)),a=!r&&this._findItem(e[0],s,o);if(!a){var f=new(this.resources.consume(u.resourceKey));this._itemResultProcessor.processItemResult({requestKey:o,isPlaceholder:!0,isPrimaryRequestedItem:!0,itemFromServer:{id:t.id,name:t.name,ownerCid:i,isBundle:r,commands:"sh,1"},observer:f});f.flush();a=f.getItem({key:o})}return a};t.prototype._getLinkFromEntity=function(e,t){return t.link?{url:t.link,type:t.linkType,name:t.linkName,role:this.parseEntityRole(t),id:t.id||t.clientId,isActive:!0,item:e,entityType:t.type,expiration:t.expirationDateTime||"",supportsExpiration:!0,hasPassword:t.hasPassword}:null};t.prototype._findItem=function(e,t,n){for(var r=null;e;){if(e.id===t){r=e;break}e=e.parent}if(!r){var i=this._itemProvider.getItemSync({parentKey:n}).item.peek();i&&i.isBundle&&(r=i)}return r};return t})(r.default);t.default=l});
define("odsp-next/providers/item/ItemProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../operation/OperationProvider","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ModelResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/operation/OperationError","../../models/itemSet/ItemSet","../ProviderHelpers","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","../../models/task/Task","@ms/odsp-utilities/lib/async/Signal","../quota/UserStateProvider.key","./ItemSetGrouper","../../utilities/browser/ServiceWorkerAgent","../../utilities/features/Features","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._smartFiltersStore=n.smartFiltersStore;r._serviceWorkerAgent=n.serviceWorkerAgent;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="";n+="parentKey="+e.parentKey;function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var o=new s.default(n),u=e.queryType,a=void 0===u?o.queryType:u;o.queryType=a;this._store.setItem(o);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new v.default(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var r=void 0===t?{}:t,i=r.triggerFetch,s=void 0!==i&&i,o=r.emptyAllOtherSets,u=void 0!==o&&o,a=r.refreshSchema,f=void 0!==a&&a,l=r.updateGrouping,c=void 0!==l&&l,h=r.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(v=this._store.getItemSetFromItemKey(e))&&v.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);var d=this._serviceWorkerAgent;d&&d.isServiceWorkerActive()&&d.invalidateFileMetadataCache();if(s){var v=this._store.getItemSetFromItemKey(e);this._getItem(n.__assign(n.__assign({parentKey:e},v&&v.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return u.default.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(T.isFeatureEnabled(T.NewDocumentTemplates)&&i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return u.default.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new b.default(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return u.default.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new h.default,n=this._operationProvider.register({name:e.item.name||"",type:p.default.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(c.default.started);n.progress.maximum(1);return r.then(function(e){n.state(c.default.completed);n.progress.current(1);return e},function(e){n.state(c.default.failed);n.error(new d.default({message:e}));return u.default.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new h.default,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:p.default.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(c.default.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(c.default.completed)}var u=e.items[0].parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new d.default({message:e}));i.state(c.default.failed)}return u.default.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new b.default(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new v.default(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var r,i=this,s=g.deepCopy(e),o=this._store;if(e.keyAlias){r=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=r.peek().key}else r=this.getItemSync(e).item;var a=e.skipCache,l=void 0!==a&&a,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,y=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!l&&r&&!r.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||m.resultSetHasData(d,{start:0,end:d.length})),E=e.startIndex,x=void 0===E?0:E,T=e.pageSize,N=void 0===T?100:T,C=e.endIndex||x+N;C=d&&d.length>0&&!y?Math.min(d.length,C):C;x=Math.max(0,Math.min(C,x));var k=o.getNextRequestToken(h);e.requestToken="end"===k?"":k;var L=new S.default(e,o,y,t.TOKEN_BASED_API_EXTRA_ITEMS);L.initialize(p,x);var A=!1,O=p&&p.content.peek();if(O&&(1===O.partialResultStatus||2===O.partialResultStatus)){A=!0;1===O.partialResultStatus&&p.content({items:O.items,groupings:O.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!A&&L.isResultSetValid(d,{start:x,end:C}))return u.default.wrap(p);if(r&&r.peek().isStub){var M=e.startKey;if(M){if(o.getItem(M)){p.content.peek().items=[o.getItem(M)];p.isPlaceholder=!0;p.isExpired=!1;var _=this._schemaDataSource,D=_&&_.getColumns(r.peek());D&&D.length>0&&p.schema(D);p.content.valueHasMutated&&p.content.valueHasMutated()}}return u.default.wrap(p)}var P=p&&!p.isExpired&&p.content.peek().groupings;P&&P.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,x,C,!b);var H=this._getRequestKey(e),B=this._pendingGetItemRequests[H];if(B)return e.itemSetProjections?B.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):B.getPromise();y&&!k&&(e.startIndex=0);this._pendingGetItemRequests[H]=B=new w.default;this.resources.consumeAsync(f.getItem.bypass).then(function(t){return t.getItem(n.__assign(n.__assign({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var n=e.itemSetProjections?i.getItemSetKey(e,!0):c;r=o.getItem(e.parentKey);var u=o.getItemSet(n);b=!(!r||!u);var a=L.computeNewChildren(t,e,u,n,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(y=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new v.default(n,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=y;o.setItemSet(n,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;y&&e.mergeGroupings&&(w=L.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[H];if(e.requestAllChildren&&!m.resultSetHasData(f,{start:0,end:t.totalChildren})){var A=g.deepCopy(e),O=A.startIndex,M=void 0===O?0:O;A.startIndex=M+100;return i._getItem(A)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[H];return u.default.wrapError(e)}).then(function(e){B.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):B.error(t)});return B.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new h.default,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(c.default.started)}return u.then(function(e){r.invalidateItem(s.key);for(var t=0,n=o;t<n.length;t++){var i=n[t];i.progress.current(1);i.state(c.default.completed)}return e},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(c.default.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return this.resources.consumeAsync(f.items)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{groupThrottle:a.groupThrottle.optional,schemaDataSource:f.schema.optional,itemsStore:o.resourceKey,operationProvider:i.resourceKey,smartFiltersStore:l.smartFiltersStore.optional,updateQuota:E.resourceKey,serviceWorkerAgent:x.resourceKey.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(r.default);t.default=N;t.resourceKey=y.createResolvedResourceKey(e("module").id,N)});
define("odsp-next/models/operation/OperationError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.OperationError=n;t.default=n});
define("odsp-next/models/itemSet/ItemSet",["require","exports","./ItemSetContent","knockout","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,s){this.key=e||"";this.content=r.observable(new n.default(s));this.content.equalityComparer=i.objectStrictEquality;this.schema=r.observableArray([]);this.schema.equalityComparer=i.arrayStrictEquality;this.context=r.utils.extend({},t);this.contentTypes=r.observableArray([]);this.isPlaceholder=!0;this.version=0};t.default=s});
define("odsp-next/models/itemSet/ItemSetContent",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.default=n});
define("odsp-next/providers/ProviderHelpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=function(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}});
define("odsp-next/providers/quota/UserStateProvider.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("odsp-next/providers/item/ItemSetGrouper",["require","exports","knockout","../ProviderHelpers"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&r.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,r,i,s){var o=this._isExpandingGroup?i.group:null,u=i.itemsPerGroup,a=e&&e.length>0?e[0].itemGroups:null,f=null;a&&a.length>0&&a[a.length-1].isPlaceholder&&(f=a.pop());var l=this._mergeGroupings(e,t,s,r);if(o&&l){l[0].isAllCollapsed(!1);o.state({isCollapsed:!1})}if(r&&r.length>0&&!r[r.length-1]&&(a=l&&l.length>0?l[0].itemGroups:null)&&a.length>0){var c=a[a.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(c.hasMoreData=!0);var h=r[c.startIndex+(-1!==u?Math.min(c.count,u):c.count)-1]&&!(this._context.groupReplace&&c.count<u),p=l[0].isAllCollapsed.peek();if(h||this._isFetchingNextGroup||p){var d=c.startIndex+c.count;f?f.startIndex=d:f={groupingId:"__next__",startIndex:d,count:1,isPlaceholder:!0,state:n.observable({isCollapsed:!1})};r.length<d&&(r.length=d+1);a.push(f)}}return l};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})();t.default=i});
define("odsp-next/utilities/browser/ServiceWorkerAgent",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/PLTFeatures","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;(function(){try{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(function(e){e&&e.navigationPreload.getState().then(function(e){s=e.enabled})})}catch(e){}})();var o=(function(){function e(){this._isOneDriveWinApp=-1!==navigator.userAgent.indexOf("OneDriveWinApp")}e.prototype.isServiceWorkerActive=function(){var e="serviceWorker"in navigator&&!!navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state;this.isServiceWorkerActive=function(){return e};return e};e.prototype.getServiceWorkerInfo=function(){return{isServiceWorkerRegistered:localStorage&&!!localStorage.getItem("isServiceWorkerRegisteredKey")||!1,isServiceWorkerFlightEnabled:this._isOneDriveWinApp?!r.isFeatureEnabled(r.DisableServiceWorkerPWA):r.isFeatureEnabled(r.EnableODBServiceWorker),isSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment),isServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment)&&this._isOdbServiceWorkerExperimentOn(),isDocLibServiceWorkerFlightEnabled:r.isFeatureEnabled(r.EnableCommonServiceWorker),isDocLibSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment),isDocLibServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment)&&this._isDocLibServiceWorkerExperimentOn(),isNavigationPreloadEnabled:s||void 0,swNavigationInfo:this.getSWNavigationInfo()||void 0}};e.prototype.getServiceWorkerStatus=function(){var e="unknown";try{e="serviceWorker"in navigator?navigator.serviceWorker.controller?navigator.serviceWorker.controller.state:"unavailable":"unsupported"}catch(e){console.error(e)}return e};e.prototype.invalidateFileMetadataCache=function(){this._invalidateCache("FileMetadata")};e.prototype._invalidateCache=function(e){var t=navigator.serviceWorker.controller;t&&t.postMessage(JSON.stringify({operation:"invalidate",cacheName:e}))};e.prototype._isOdbServiceWorkerExperimentOn=function(){this._odbServiceWorkerExperiment||(this._odbServiceWorkerExperiment=new i.ABExperiment({name:"ODBServiceWorkerExperimentV2",startDate:"7/01/2019",targetType:i.TargetType.user,version:i.ABExpHash.v2}));return this._odbServiceWorkerExperiment.IsExperimentOn()};e.prototype._isDocLibServiceWorkerExperimentOn=function(){this._docLibServiceWorkerExperiment||(this._docLibServiceWorkerExperiment=new i.ABExperiment({name:"CommonServiceWorkerExperiment",startDate:"8/19/2019"}));return this._docLibServiceWorkerExperiment.IsExperimentOn()};e.prototype.getSWNavigationInfo=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:t.workerStart,fetchStart:t.fetchStart,requestStart:t.requestStart}}};return e})();t.default=o;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(o)})});
define("odsp-next/dataSources/sharing/odc/SharingDataDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../SharingDataSource.resx","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../resources/ODCResourceKeys","../../../utilities/features/Features","./SharingDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._sharingDataHelper=new(t.managed(l.default));t._urlDataSource=t.resources.consume(a.urlDataSource);return t}t.prototype.getSettings=function(e){var t=this,n=e.item;return e.getPermissions().then(function(e){var r={itemId:n.id,itemName:n.name,pickerProperties:{AllowEmailAddresses:!0},canManagePermissions:!0,canManageLinks:!0,canSendLink:!0,canSendEmail:!0,anonymousLinksEnabled:!0,organizationLinksEnabled:!1,networkLinksEnabled:!0,showAdvanced:!1,advancedUrl:"",itemUrl:"",supportsSharingPropagation:!1,showAdditionalExternalWarning:!1,sharedWithMany:!1,sharingRoles:t._getSharingRolesForItem(n),requiredAnonymousLinkExpirationInDays:0,mailSettings:{defaultCharacterLimit:4e3},contactInviteLimit:20};r.sharedWith=e.length?e[0].people:null;return i.default.wrap(r)})};t.prototype.getPermissions=function(e){var t=this,n=e.item,r=this._urlDataSource.getPermissionsUrl(n);return(new u.default).send({apiName:"GetPermissions",url:r}).then(function(e){var r=[];if(0!==n.sharingRole){var i={item:n,canChange:!1,people:[{userId:e.ownerCid,name:e.ownerName,email:"",image:o.default.getProfileImage(e.ownerCid),sharingInfo:{type:1,item:n,role:0,isChangeable:!1}}],hasPendingAccessRequests:!1,canUnshare:!1};r.push(i)}for(var s=0,u=e.permissionScopes;s<u.length;s++){var a=u[s];r.push(t._sharingDataHelper.getSharingScope([n],a))}return r})};t.prototype.getBestSharingLink=function(e){var t=e.item;return e.getLinks().then(function(e){if(e){for(var n=null,r=0,s=e;r<s.length;r++){var o=s[r];if(t.id===o.item.id){if(6===o.type){n=o;break}5===o.type&&(n=o)}}return i.default.wrap(n)}return i.default.wrap(null)},function(e){return i.default.wrap(null)})};t.prototype.getLinks=function(e){var t=this;return e.getPermissions().then(function(e){return t._sharingDataHelper.getSharingLinks(e,{})})};t.prototype.doSharingScopesContainLinks=function(){return!0};t.prototype.getRawResponse=function(e){return i.default.wrap({})};t.prototype._getSharingRolesForItem=function(e){var t={name:s.default.CanEdit,value:this._sharingDataHelper.convertToSharingRole(2)},n={name:s.default.CanView,value:this._sharingDataHelper.convertToSharingRole(1)};return e.isAlbum&&!f.isFeatureEnabled(f.CollaborativeAlbumsEnabled)?[n]:[t,n]};return t})(r.default);t.default=c});
define("odsp-next/dataSources/suiteNav/odc/SuiteNavDataSource",["require","exports","tslib","../../../resources/ODCResourceKeys","./ODCSuiteNav.resx","../../../models/suiteNav/SuiteNavData","../../../models/suiteNav/SuiteNavClientData","../../../models/suiteNav/SuiteNavLinkIds","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/require/RequireConfigInjector","../../url/odc/UrlDataSource","@ms/odsp-datasources/lib/Permissions","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/attribution/AttributionHelper","@ms/odsp-shared/lib/base/BaseModel","../../../actions/odc/SignOutAction","../../../actions/NavigationAction","../../../actions/userActivity/odc/UserActivityAction","../../../actions/LanguagePickerAction","../../../actions/ToggleDebugWindowAction","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../dataSources/footer/odc/Footer.resx","../../../utilities/features/Features","../../../utilities/features/PLTFeatures","../../../pages/accountChooser/odc/sections/disambiguateEmail/DisambiguateEmail.resx","../../../providers/suiteNav/O365ShellWrapper","../../../providers/engagement/Engagement","../../../dataSources/searchBox/SearchBoxConfig.key","@uifabric/styling/lib/utilities/icons"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=FilesConfig&&FilesConfig.SuiteNavConfig,D="https://go.microsoft.com/fwlink/p/?LinkId=822563",P=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._fillConsumerData=function(e,t,r){var s=new L.default;t.HasEXOLicense=!0;t.NewFlexPane=!0;t.MeFlexPaneEnabled=!0;t.LyncIntegrationDisabled=!1;t.IsRTL=f.default.isRightToLeft;e.CurrentWorkloadSettingsSubLinks=n._getSettingsLinks(n._urlDataSource,!1);e.CurrentWorkloadHelpSubLinks=[{Id:u.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:i.default.Help,Url:D}];e.CurrentWorkloadHelpSubLinks=n._getHelpLinks();e.SignOutLink={Id:u.default.SIGN_OUT,Text:i.default.SignOut,Url:"#"};e.ActionsMap={};e.ActionsMap[u.default.DIAGNOSTICS]=function(e){s.FlexPane.CloseFlexPaneForProvider("Settings");var t=new(e.injected(E.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.USER_ACTIVITY]=function(e){var t=new(e.injected(b.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.SIGN_OUT]=function(e){var t=new(e.injected(g.default))({url:_.Urls.SignOut});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.ONEDRIVE]=function(e){var t=new(e.injected(y.default))({url:n._urlDataSource.getFilesQueryUrl(),forceNavigation:!0});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.LANGUAGE]=function(e){s.FlexPane.CloseFlexPaneForProvider("Settings");n._engagement.logData({name:"SuiteNav.Language.Click",isIntentional:!0});if(N.isFeatureEnabled(N.LanguageRedirect)){var t=new(e.injected(y.default))({url:n._urlDataSource.getLanguageWithAuthenRedirectUrl(),forceNavigation:!0,target:n._urlDataSource.getAuthKeyParamValue()?"_blank":null});t.execute(null);t.dispose()}else{var r=new(e.injected(w.default))({});r.execute(null).done(function(){r.dispose()})}return!1};if(r){e.CurrentWorkloadUserSubLinks=[];e.SignOutLink.Text=k.default.title}return t};_&&(n._model={data:null,cssUrl:_.CssPath,requireConfig:n._getRequireConfig()});n._identity=n.resources.consume(p.identity).getIdentity();n._urlDataSource=n.resources.consume(r.urlDataSource);n._navigation=n.resources.consume(d.navigation);n._attributionHelper=n.resources.consume(v.resourceKey);n._engagement=n.resources.consume(A.resourceKey);return n}t.prototype.getCapabilities=function(){return{supportsCaching:!1,supportsRealSuiteNav:!("syncpremiumupsell"===this._navigation.viewParams.v)&&_,showO365Text:!1}};t.prototype.getUserTileUrl=function(){return _&&_.UserTileUrl};t.prototype.getUserName=function(){return _&&_.UserDisplayName};t.prototype.getUserEmail=function(){return this._identity.email};t.prototype.getRenderSetting=function(e){var t=this,r={isThinHeader:!0,top:e,initialRenderData:{Culture:$Config.mkt,IsConsumer:!0,UPN:this.getUserEmail(),UserDisplayName:$Config.UserDisplayName,WorkloadId:"ShellDocuments",UserID:$Config.upsellUserId,ShellBootHost:"",AppBrandTheme:{Primary:"#0078D4"},IsRtl:f.default.isRightToLeft},shellDataOverrides:{SignOutLink:{Id:u.default.SIGN_OUT,Text:i.default.SignOut,Url:"#",Action:function(){var e=new(t.resources.injected(g.default))({url:_.Urls.SignOut});e.execute(null);e.dispose();return!1}},SignInLink:{Id:"ShellSignIn",Text:i.default.SignIn,Url:FilesConfig.si}},disableShellPlus:!1,collapseO365Settings:!1,mePhotoSource:FilesConfig.SuiteNavConfig.UserTileUrl,UserID:$Config.upsellUserId,workloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!1),workloadSettingsSubLinksTitle:i.default.OneDriveSettings,workloadHelpSubLinks:this._getHelpLinks(),layout:"Mouse",AppHeaderLinkText:i.default.OneDrive,AppHeaderLinkUrl:""};if(N.isFeatureEnabled(C.OdcSuiteNavSearchBox)){var s=this.resources.consume(O.resourceKey);r=n.__assign(n.__assign({},r),{enableLegacyResponsiveBehavior:!1,enableSearchUX:s.isEnabled(),initialSearchUXVisibility:s.isEnabled(),initialSearchUXPlaceholderText:s.getPlaceholderText(),initialSearchUXSearchText:s.getSearchText(),shellDataOverrides:n.__assign(n.__assign({},r.shellDataOverrides),{GetSearchConfigurationFromECS:!0}),searchBoxInstrumenter:s.getInstrumenter()})}return r};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;this._model.requireConfig=this._getRequireConfig();this._dataPromise=new a.default(function(e,n){if(_){var r=function(n,r){t._model.data=new s.default(n,r);e(t._model)};if(t._identity.type===h.IdentityType.aad)S.default.start({url:t._urlDataSource.getSuiteNavConfigUrl()}).then(function(n){try{var s=JSON.parse(n.responseText);s.navBarData.HelpLink.Url=D;s.navBarData.CurrentWorkloadSettingsSubLinks=[{Id:u.default.CUSTOM_SETTINGS_1,Text:i.default.Options,Url:t._urlDataSource.getOptionsUrl(),TargetWindow:"_top"}];t._model={data:s.navBarData,requireConfig:{paths:{shellcore:s.jsUrl.replace(/\.js$/,"")},shim:{shellcore:{exports:"O365"}}},cssUrl:s.cssUrl};t._model.data.ActionsMap={};t._model.data.ActionsMap[u.default.SIGN_OUT]=function(){new(t.managed(g.default))({url:_.Urls.SignOut}).execute(null);return!1};e(t._model)}catch(e){x.default.log(e);var o=t._getSuiteNavFallbackData();r(o.data,o.clientData)}},function(e){x.default.log(e);var n=t._getSuiteNavFallbackData();r(n.data,n.clientData)});else if(t.getCapabilities().supportsRealSuiteNav){l.default.addConfig(t._getRequireConfig());var a=t._identity.type===h.IdentityType.anonymous;window.require(["shellcore"],function(){var e=new o.default,n=new s.default(null,e);e=t._fillConsumerData(n,e,a);r(n,e)})}else{var f=t._getSuiteNavFallbackData();r(f.data,f.clientData)}}else e(null)});return this._dataPromise};t.prototype._getSuiteNavFallbackData=function(){var e=this,t=this._identity.type===h.IdentityType.aad,n=_.Urls,r=new o.default;r.IsFallbackShell=!0;r.IsRTL=f.default.isRightToLeft;var s={WorkloadLinks:[{Id:u.default.ONEDRIVE,Text:i.default.OneDrive,Url:"https://onedrive.live.com"}],CurrentWorkloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!t),CurrentWorkloadHelpSubLinks:this._getHelpLinks(),CurrentWorkloadUserSubLinks:t?[]:[{Id:u.default.ABOUT_ME,Text:i.default.EditProfile,Url:n.Profile},{Id:u.default.SETTINGS,Text:i.default.AccountSettings,Url:n.Account}],IsAuthenticated:_.IsAuthenticated,SignOutLink:{Id:u.default.SIGN_OUT,Text:i.default.SignOut,Url:n.SignOut},UserDisplayName:_.UserDisplayName,ActionsMap:{}};s.ActionsMap[u.default.SIGN_OUT]=function(){new(e.managed(g.default))({url:_.Urls.SignOut}).execute(null);return!1};return{data:s,clientData:r}};t.prototype._getHelpLinks=function(){var e=[{Id:u.default.FEEDBACK,Text:i.default.Support,TargetWindow:"_blank",Url:"https://go.microsoft.com/fwlink/?linkid=2131409&clcid="+$Config.langPref},{Id:u.default.ABUSE,TargetWindow:"_blank",Text:T.default.ReportAbuse,Url:"https://go.microsoft.com/fwlink/?linkid=2131312&clcid="+$Config.langPref}],n=c.default.getImpressumUrl();n&&e.push({Id:u.default.IMPRESSUM,TargetWindow:"_blank",Text:t.impressumText,Url:n});f.default.language&&f.default.language.toLowerCase().indexOf("en")>=0&&e.splice(2,0,{Id:u.default.USERVOICE,TargetWindow:"_blank",Text:i.default.SuggestFeature,Url:"https://go.microsoft.com/fwlink/?linkid=2131313&clcid="+$Config.langPref});return e};t.prototype._getSettingsLinks=function(e,t){var n=this,r=_.Urls,s=[],o=this.getCapabilities().supportsRealSuiteNav?new L.default:null;s.push({Id:u.default.CUSTOM_SETTINGS_1,Text:i.default.Options,Url:e.getOptionsUrl(),TargetWindow:"_top",Action:function(){o&&o.FlexPane.CloseFlexPaneForProvider("Settings")}});var a=this._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"UpgradePage"});s.push({Id:u.default.CUSTOM_SETTINGS_2,Text:i.default.Upgrade,Url:e.getUpgradeOptionsUrl(a,!0),TargetWindow:"_top",Action:function(){o&&o.FlexPane.CloseFlexPaneForProvider("Settings");n._engagement.logData({name:"SuiteNav.UpgradeOption.Click"})}});if(o){var l=M.getIcon("Diamond"),c=l&&l.subset.fontFace&&l.subset.fontFace.fontFamily||"";o.Extensibility.AddOrUpdateCustomHeaderButton({iconFontFamily:c,iconFontName:"",isStateless:!0,onShow:function(){n._engagement.logData({name:"SuiteNav.Diamond.Click"});var t=n._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"HeaderDiamond"}),r=new(n.resources.injected(y.default))({url:e.getUpgradeOptionsUrl(t,!0),forceNavigation:!0});r.execute(null);r.dispose();return!1},onHide:function(){},id:"PROD_OneDrive-Web_SuiteNav_Unknown_HeaderDiamond",ariaLabel:i.default.ClickToLearnMore,affordanceMenuItemText:i.default.ClickToLearnMore})}t&&s.push({Id:u.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:i.default.Help,Url:D});FilesConfig&&FilesConfig.df&&s.push({Id:u.default.DIAGNOSTICS,Text:i.default.Diagnostics,Url:r.Diagnostics});FilesConfig&&FilesConfig.df&&N.isFeatureEnabled(N.UserActivity)&&s.push({Id:u.default.USER_ACTIVITY,Text:"Activity",Url:r.Diagnostics});this._identity.type===h.IdentityType.anonymous&&N.isFeatureEnabled(N.HideLanguagePickerForAnonymous)||s.push({Id:u.default.LANGUAGE,Text:T.default["langname_"+f.default.language],Url:"#"});return s};t.prototype._getRequireConfig=function(){return{paths:{shellcore:"https://shellprod.msocdn.com/api/shellbootstrapper/consumer/oneshell?noext"},shim:{shellcore:{exports:"O365Shell"}}}};t.impressumText="Impressum";return t})(m.default);t.default=P});
define("odsp-next/models/suiteNav/SuiteNavData",["require","exports","./SuiteNavLinkIds"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){for(var r in e)this[r]=e[r];this.ClientData=t.toString();void 0===this.CurrentMainLinkElementID&&(this.CurrentMainLinkElementID=n.default.ONEDRIVE)};t.default=r});
define("odsp-next/models/suiteNav/SuiteNavLinkIds",["require","exports","@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.SUITE_NAV_LINK_IDS});
define("@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",LISTS:"Lists",SHAREPOINT:"Sharepoint"};t.SuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});
define("odsp-next/models/suiteNav/SuiteNavClientData",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.IsRTL=!1;this.IsFallbackShell=!1;this.LyncIntegrationDisabled=!1;this.NewFlexPane=!1;this.MeFlexPaneEnabled=!1;this.LogUrl="";this.LogLevelSwitches=[!1,!1,!1,!1];e&&n.utils.extend(this,JSON.parse(e))}e.prototype.toString=function(){return JSON.stringify(this)};return e})();t.default=r});
define("odsp-next/actions/odc/SignOutAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/identity/odc/IdentityDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SignOut";n.url=t.url;n.target=t.target||"_top";n._navigation=n.resources.consume(u.navigation);n._sessionProvider=n.resources.consume(o.resourceKey);return n}t.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target});return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};return t})(r.default);t.default=a});
define("odsp-next/dataSources/identity/odc/IdentityDataSource",["require","exports","@ms/odsp-datasources/lib/utilities/permissions/Identity","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","../IIdentityCache","../../../utilities/features/Features","../../base/odc/DataRequest","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/async/Async","cookies"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.enableCooldownAfterAuthFlowResourceKey=new a.ResourceKey({name:e("module").id+".enableCooldownAfterAuthFlow",factory:new a.ConstantResourceFactory(l.isFeatureEnabled(l.EnableCooldownAfterAuthFlow))});t.enableTokenCacheResourceKey=new a.ResourceKey({name:e("module").id+".enableTokenCache",factory:new a.ConstantResourceFactory(l.isFeatureEnabled(l.UseTokenCacheForOAuth))});var m=(function(){function e(e,t){var r=this;this._navigation=t.navigation;this._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow;t.enableTokenCache&&(this._tokenCache=new f.IdentityCache);this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0};this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};this._scope=new p.default;this._async=this._scope.attach(new d.default);if(this.getIdentity().type===n.IdentityType.msa){var i=this._scope.attach(new h.default(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname;i.on(window,"message",this._onMessageReceived);this._sessionId=$Config.authSessionId||"0";if(l.isFeatureEnabled(l.CanaryRefresh)){this._lastCanaryRefreshTime=Date.now();i.on(window,"focus",function(){if(Date.now()-r._lastCanaryRefreshTime>6e4){r._lastCanaryRefreshTime=Date.now();r._refreshCanary()}})}}}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.getIdentity=function(){var e=n.IdentityType.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?n.IdentityType.aad:n.IdentityType.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};e.prototype.getSignInUrl=function(){return FilesConfig.si};e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:");this._expireAuthCookie("graph_auth:")};e.prototype.getSessionToken=function(e,t){void 0===e&&(e=!1);void 0===t&&(t=!1);return this._getToken(t?"msa_strong_auth:":"msa_auth:",e)};e.prototype.getGraphToken=function(e){var t=e.forceRefresh,n=void 0!==t&&t;return this._getToken("graph_auth:",n)};e.prototype.getAuthUrl=function(e,t){if(this.getIdentity().type===n.IdentityType.msa){var r="sa.html";t?r="saroot.html":"soak2"===FilesConfig.env?r="sasoak2.html":"soak3"===FilesConfig.env?r="sasoak3.html":"dev"===FilesConfig.env&&(r="sadev.html");var i=encodeURIComponent("https://p.sfx.ms/"+r),s=t||"msa_strong_auth:"===e?"":"&display=none",o=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":o="dev"===FilesConfig.env?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":if(l.isFeatureEnabled(l.UseNewShareDialog)){o="contacts.read Files.ReadWrite";l.isFeatureEnabled(l.ShareSearchToPeopleApi)&&(o+=" people.read");l.isFeatureEnabled(l.FamilySharing)&&(o+=" Family.Read")}else o="contacts.read"}return"https://login.live.com/oauth20_authorize.srf?client_id=00000000481710A4&scope="+o+"&res=success&resuictx=selection&response_type=token&redirect_uri="+i+s}return $Config.silentAuth};e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe);this._rpsIFrameQosEvent=new u.Qos({name:"IdentityDataSource.refreshAuthTicket"});this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(r.default.encodeURIComponent("{{RU}}"),r.default.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1"));document.body.appendChild(this._silentAuthRpsIframe)};e.prototype._refreshCanary=function(){(new c.default).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})};e.prototype._getToken=function(e,t){if(this.getIdentity().type===n.IdentityType.aad)return s.default.reject("Unable to get a token for a business account");var r;switch(e){case"graph_auth:":r="Graph";break;case"msa_strong_auth:":r="MSAStrong";break;default:r="MSA"}var i=new u.Qos({name:"IdentityDataSource.get"+r+"Token"}),a=this._getTokenFromCache(e),f=a.token,l=a.shouldRefresh,c=a.hadCookie;if(t){f=void 0;var h=this._tokenRefreshCooldowns[e];h&&h.complete()}if((l||!f)&&!this._pendingSignals[e]){this._pendingSignals[e]=new o.default;this._setupSilentAuthIframe(e)}if(f){i.end({resultType:u.ResultTypeEnum.Success,resultCode:l?"withinExpiration":"cached",error:c?void 0:"noCookie"});return s.default.resolve({accessToken:f})}return this._pendingSignals[e].getPromise().then(function(e){i.end({resultType:u.ResultTypeEnum.Success,resultCode:"fullRefresh"});return e},function(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e&&e.message});return s.default.reject(e)})};e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var r=Date.now()+1e3*n;if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,{value:t,expiration:r})}};e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),r=this._getTokenCacheKey(e),i=this._tokenCache.getValue(r,n);if(i)return{token:i.value,shouldRefresh:n+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}};e.prototype._writeAuthCookie=function(e,t,n){var r=this._getTokenCacheKey(e),i=Date.now()+1e3*n;v.set(r,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})};e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return v.get(t)};e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);v.expire(t,{secure:!0,path:"/"})};e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId};e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;if("MSA_AuthenticationSuccess"===e.data){this._refreshCanary();t.end({resultType:u.ResultTypeEnum.Success})}else"MSA_AuthenticationError"===e.data&&t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",r=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source){n=e.data.token;r=parseInt(e.data.expiresIn,10)}else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length){n=i[0];r=parseInt(i[1],10)}else if(1===i.length){var s=i[0].split("&");t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"error"});if(0===s[0].indexOf("error=access_denied")){var o=v.get("ANON");l.isFeatureEnabled(l.EnableMsaOauthErrorRedirect)&&o&&this._navigation.navigateTo({url:this.getAuthUrl(this._silentAuthIframeTokenType,!0)})}return}}if(!!n&&r>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,r);t.end({resultType:u.ResultTypeEnum.Success});var a=this._pendingSignals[this._silentAuthIframeTokenType];a&&a.complete({accessToken:n})}else t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}};e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++;this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];s.default.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new u.Qos({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe");t._silentAuthIframe.style.display="none";t._silentAuthIframe.src=t.getAuthUrl(e);document.body.appendChild(t._silentAuthIframe);t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0;n.end({resultType:u.ResultTypeEnum.Failure,resultCode:"timeout"});if(t._authFrameAttempts[e]<5){t._removeSilentAuthIframe(e,!1);t._setupSilentAuthIframe(e)}else t._removeSilentAuthIframe(e,!0)},3e4)})}};e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0;if(this._silentAuthIframe){document.body.removeChild(this._silentAuthIframe);this._silentAuthIframe=void 0}if(void 0!==this._silentAuthIframeTimeoutId){this._async.clearTimeout(this._silentAuthIframeTimeoutId);this._silentAuthIframeTimeoutId=void 0}if(this._enableCooldownAfterAuthFlow){var n=this._tokenRefreshCooldowns[e]=new o.default;this._async.setTimeout(function(){n.complete()},3e4)}if(t){var r=this._pendingSignals[e];r&&r.error(new Error("Timed out acquiring OAuth token."));this._pendingSignals[e]=void 0;this._authFrameAttempts[e]=0;this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]&&this._setupSilentAuthIframe("graph_auth:")}};e.dependencies={navigation:i.navigation,enableCooldownAfterAuthFlow:t.enableCooldownAfterAuthFlowResourceKey,enableTokenCache:t.enableTokenCacheResourceKey};return e})();t.default=m;t.resourceKey=a.createResolvedResourceKey(e("module").id,m)});
define("odsp-next/dataSources/identity/IIdentityCache",["require","exports","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]};e.prototype.setValue=function(e,t){this._state[e]=t};return e})();t.IdentityCache=i;var s=(function(){function e(e){var t=e.userId;this._store=new n.default("Identity.OAuth."+t,r.default.local)}e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)};e.prototype.setValue=function(e,t){this._store.setValue(e,t)};return e})();t.DataStoreIdentityCache=s});
define("odsp-next/actions/userActivity/odc/UserActivityAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(r,t);function r(n){void 0===n&&(n={});var r=t.call(this,n)||this;r.name="UserActivity";r._executorLoader=new(r.managed(s.default))({path:"./UserActivityExecutor",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["./UserActivityExecutor"],t,n)}))},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r})(r.default);t.default=o});
define("odsp-next/actions/base/ExecutorLoader",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._getModule=t.getModule;n._path=t.path;n._getExecutorParams=t.getExecutorParams;n._bundleLoader=n.resources.consume(s.bundleLoader);n._bundleLoader.queueLoad(n._path,n._getModule).done();return n}t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(i){return"function"!=typeof i?r.default.wrapError(new Error("Cannot create action from "+i+": "+n._path)):r.default.as(n._getExecutorParams()).then(function(s){var o=new(n.resources.injected(i))(s);return r.default.as(o.execute(e,t))})}):r.default.wrapError(new Error("Cannot create action from nothing: "+this._path))};t.prototype._loadExecutorType=function(){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return t})(i.default);t.default=o});
define("odsp-next/actions/LanguagePickerAction",["require","exports","tslib","../base/BaseAction","../resources/DataSourceResourceKeys","../controls/languagePicker/LanguagePicker","../controls/languagePicker/LanguagePicker.resx","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../utilities/icons/Icon","../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="LanguagePicker";n._languagePickerDataSource=n.resources.consume(i.languagePicker);n._navigation=n.resources.consume(f.navigation);n._dialogProvider=n.resources.consume(c.resourceKey);n._lang=n.observables.create("");n._canary=n.observables.create("");return n}t.prototype.onExecute=function(e,t){var n=this;return this._dialogProvider.requestDialog({title:o.default.language,automationId:"languagePicker",component:{name:s.default.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:o.default.save,execute:function(){return n.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new l.default("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){e._navigation.navigateTo(u.replaceQuery(window.location.href,"mkt",t));return 2})};return t})(r.default);t.default=h});
define("odsp-next/controls/languagePicker/LanguagePicker",["require","exports","./LanguagePicker.html","./LanguagePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-language-picker",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/languagePicker/LanguagePicker.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<form class="LanguagePicker">\x3c!--ko if:$data.isLoading--\x3e<div data-bind="text:loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:$data.isLoading--\x3e<select name="language" data-bind="value:selectedLanguage,foreach:languages,automation:\'dropDown\'"><option data-bind="attr:{selected:isoValue===$parent.currentLanguage()},value:isoValue,html:displayText"></option></select>\x3c!--/ko--\x3e</form>'});
define("odsp-next/controls/languagePicker/LanguagePickerViewModel",["require","exports","tslib","../../resources/DataSourceResourceKeys","./LanguagePicker.resx","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.canary=t.canary;n.selectedLanguage=t.selectedLanguage;n.loadingText=i.default.loading;var o=n.observables;n.isLoading=o.create(!0);n.languages=o.createArray([]);n.currentLanguage=o.create("");var u=n.resources.consume(r.languagePicker.optional);u&&u.getLanguages().then(function(e){n.canary(e.canary);n.currentLanguage(e.currentLanguage);for(var t=e.languageList,r=0,i=t;r<i.length;r++){var o=i[r];o.displayText=(s.default.isRightToLeft?"&rlm;":"&lrm;")+o.nativeName+" - "+o.name}n.languages(t);n.isLoading(!1)});return n}return t})(o.default);t.default=u});
define("odsp-next/actions/ToggleDebugWindowAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../controls/debugWindow/DebugWindowInit","../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="ToggleDebugWindow";return t}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){if(o.default.isInitialized()){var n=this.resources.consume(u.isDebugWindowVisible);n(!n())}else o.default.init(this.resources);return s.default.wrap({resultType:i.ResultTypeEnum.Success})};return t})(r.default);t.default=a});
define("odsp-next/providers/suiteNav/O365ShellWrapper",["require","exports","tslib","@ms/odsp-datasources/lib/providers/suiteNav/O365ShellWrapper","./FlexPaneWrapper","./NavigationWrapper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._flexPane=new i.FlexPaneWrapper;t._navigation=new s.NavigationWrapper;return t}Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!0,configurable:!0});return t})(r.O365ShellWrapper);t.O365ShellWrapper=o;t.default=o});
define("@ms/odsp-datasources/lib/providers/suiteNav/O365ShellWrapper",["require","exports","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/killswitch/Killswitch","./O365ShellPromises"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){var e=this;this._PostRenderSignal=new n.default;if(!r.Killswitch.isActivated("8c769ed4-d666-4f61-b371-8a7061ed7035","04/30/2020","Hook signals to render and postrender promises")){i.O365ShellPromises.GetLoadPromise()&&i.O365ShellPromises.GetLoadPromise().then(function(){e._signalAction(function(){})});i.O365ShellPromises.GetRenderPromise()&&i.O365ShellPromises.GetRenderPromise().then(function(){e._signalAction(function(){})});i.O365ShellPromises.GetPostRenderPromise()&&i.O365ShellPromises.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}}Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!0,configurable:!0});e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})};e.prototype.RenderAsync=function(e,t,n){var r=this;O365Shell.RenderAsync(e,function(){return r._signalAction(t)},function(){return r._signalAction(n)})};e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})};e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new n.default;t.complete()};return e})();t.O365ShellWrapper=s});
define("@ms/odsp-datasources/lib/providers/suiteNav/O365ShellPromises",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.GetLoadPromise=function(){return window.o365ShellLoadPromise};e.GetRenderPromise=function(){return window.o365ShellRenderPromise};e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise};return e})();t.O365ShellPromises=n});
define("odsp-next/providers/suiteNav/FlexPaneWrapper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){n.default.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){n.default.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){n.default.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){n.default.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}};return e})();t.FlexPaneWrapper=r});
define("odsp-next/providers/suiteNav/NavigationWrapper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){n.default.log(e,"NavigationWrapper","OnLinkClick")}};e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){n.default.log(e,"NavigationWrapper","OnHamburgerButtonClick")}};e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){n.default.log(e,"NavigationWrapper","RemoveOnLinkClick")}};e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){n.default.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}};e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){n.default.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}};e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){n.default.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}};e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){n.default.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}};return e})();t.NavigationWrapper=r});
define("odsp-next/dataSources/searchBox/SearchBoxConfig.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("searchBoxConfig")});
define("odsp-next/dataSources/mobileAppPath/odc/IOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./ViewQueryEnum","../BaseIOSMobilePathDataSource","../../url/ExternalAliasEnum","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.PARAM_EQUALS_FORMAT="{0}={1}";n._queryParamDictionary={id:"resId",cid:"ownerCid",authkey:"authKey",accountId:"accountId",ticket:"ticket"};n._navigation=n.resources.consume(a.navigation);n._urlDataSource=n.resources.consume(i.urlDataSource);return n}t.prototype.getPath=function(){var e=this.getQueryStringParams(),t=this.getView(),n=r.format(o.default.APP_PATH_PRE_FIX+this.FIRST_PARM_FORMAT,t||"",e||"");e&&(n+="&");return n+=o.default.APP_PATH_POST_FIX};t.prototype.getStorePath=function(){return this._urlDataSource.getExternalUrl(u.default.iosappstore)};t.prototype.getView=function(){var e,t=this._navigation.viewParams.qt;if(t&&t.length>0){t=t.toLowerCase();switch(s.default[t]){case s.default.mru:e="recent";break;case s.default.shared:case s.default.sharedby:e="shared";break;case s.default.folders:e="files";break;default:e=t}}else e="files";return e};t.prototype.getQueryStringParams=function(){var e;for(var t in this._queryParamDictionary)if(this._queryParamDictionary.hasOwnProperty(t)){var n=this._navigation.viewParams[t];if("accountId"===t&&!n){var i=window.$Config;n=i&&i.hcid}if(n){if("root"===n)continue;e?e+="&":e="";e+=r.format(this.PARAM_EQUALS_FORMAT,this._queryParamDictionary[t],n)}}return e};return t})(o.default);t.default=f});
define("odsp-next/dataSources/mobileAppPath/odc/ViewQueryEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.folders=0]="folders";e[e.shared=1]="shared";e[e.mru=2]="mru";e[e.search=3]="search";e[e.photos=4]="photos";e[e.recyclebin=5]="recyclebin";e[e.allmyphotos=6]="allmyphotos";e[e.sharedby=7]="sharedby"})(n||(n={}));t.default=n});
define("odsp-next/dataSources/mobileAppPath/BaseIOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.FIRST_PARM_FORMAT="{0}?{1}";return t}t.prototype.getPath=function(){return r.format(this.FIRST_PARM_FORMAT,t.APP_PATH_PRE_FIX,t.APP_PATH_POST_FIX)};t.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"};t.APP_PATH_PRE_FIX="ms-onedrive://";t.APP_PATH_POST_FIX="from=web";return t})(i.default);t.default=s});
define("odsp-next/resources/UtilityResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.idle=new n.ResourceKey("idle");t.beforeUnload=new n.ResourceKey("beforeUnload");t.syncActiveXClient=new n.ResourceKey("syncActiveXClient");t.experimentHelper=new n.ResourceKey("experimentHelper");t.attributionHelper=new n.ResourceKey("attributionHelper");t.educationAndUpsells=new n.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new n.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new n.ResourceKey("clientSideExtensionHelper");t.needsAttentionViewHelper=new n.ResourceKey("needsAttentionViewHelper");t.shyConductor=new n.ResourceKey("shyConductor")});
define("odsp-next/dataSources/download/odc/DownloadDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DownloadDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/identity/odc/PWAAppIdentityDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/features/Features","../IIdentityCache","../../../providers/winApp/communication/WinAppCommunicator.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;t.appEnableTokenCacheResourceKey=new a.ResourceKey({name:e("module").id+".enableTokenCache",factory:new a.ConstantResourceFactory(f.isFeatureEnabled(f.UseTokenCacheForOAuth))});(function(e){e.MSA="MSA";e.Graph="Graph";e.MsaStrongAuth="MsaStrongAuth"})(h||(h={}));var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._tokenCache=new l.IdentityCache;r._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};r._silentTokenAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0};r._silentAuthTokenTimeoutId={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};r._tokenExpiryInSeconds={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};return r}t.prototype.getIdentity=function(){var e=r.IdentityType.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?r.IdentityType.aad:r.IdentityType.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};t.prototype.getSignInUrl=function(){return FilesConfig.si};t.prototype.signOut=function(){};t.prototype.getSessionToken=function(e,t){void 0===e&&(e=!1);void 0===t&&(t=!1);return this._getToken(t?"msa_strong_auth:":"msa_auth:",e)};t.prototype.getGraphToken=function(){return this._getToken("graph_auth:")};t.prototype.receiveTokenFromWinApp=function(e,t,n,r){var i=this._mapWAMStringToAuthType(t),s=this._pendingSignals[i];if(null!==r&&""!==r.trim()){s.error(i+": "+r);this._resetTokenFetchState(i);return!1}"msa_strong_auth:"!==i&&this._writeTokenToCache(i,e,n);this._silentAuthTokenTimeoutId[i]&&this.async.clearTimeout(this._silentAuthTokenTimeoutId[i]);this._silentAuthTokenTimeoutId[i]=void 0;this._tokenExpiryInSeconds[i]=n;s&&("graph_auth:"===i?s.complete({accessToken:e,wlidToken:void 0}):s.complete({accessToken:void 0,wlidToken:e}));this._resetTokenFetchState(i);return!0};t.prototype._mapWAMStringToAuthType=function(e){return e===h.MSA?"msa_auth:":e===h.MsaStrongAuth?"msa_strong_auth:":"graph_auth:"};t.prototype._getToken=function(e,t){if(this.getIdentity().type===r.IdentityType.aad)return o.default.reject("Unable to get a token for a business account");var n=this._getTokenFromCache(e),i=n.token;t&&(i=void 0);if((n.shouldRefresh||!i)&&!this._pendingSignals[e]){this._pendingSignals[e]=new u.default;this._initiateTokenFetching(e)}return i?"graph_auth:"===e?o.default.resolve({accessToken:i,wlidToken:void 0}):o.default.resolve({accessToken:void 0,wlidToken:i}):this._pendingSignals[e].getPromise().then(function(e){return e},function(e){return o.default.reject(e)})};t.prototype._initiateTokenFetching=function(e){var t=this;this._silentTokenAttempts[e]++;this.resources.consumeAsync(c.resourceKey).then(function(t){var n;switch(e){case"msa_strong_auth:":n=h.MsaStrongAuth;break;case"graph_auth:":n=h.Graph;break;case"msa_auth:":n=h.MSA}var r={authType:n,notification:"TokenRequestEvent"};t.sendNotification(r)});"msa_strong_auth:"!==e&&(this._silentAuthTokenTimeoutId[e]=this.async.setTimeout(function(){t._silentAuthTokenTimeoutId[e]=void 0;if(t._silentTokenAttempts[e]<5)t._initiateTokenFetching(e);else{t._pendingSignals[e].error("Token retries completed");t._resetTokenFetchState(e)}},3e3))};t.prototype._resetTokenFetchState=function(e){this._silentTokenAttempts[e]=0;this._pendingSignals[e]=void 0};t.prototype._writeTokenToCache=function(e,t,n){var r=Date.now()+1e3*n;this._tokenCache&&this._tokenCache.setValue(e,{value:t,expiration:r})};t.prototype._getTokenFromCache=function(e){if(this._tokenCache){var t=Date.now(),n=this._tokenCache.getValue(e,t);if(n)return{token:n.value,shouldRefresh:t+6e4>n.expiration}}return{token:null,shouldRefresh:!0}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{navigation:s.navigation});return t})(i.default);t.default=p;t.resourceKey=a.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/providers/winApp/communication/WinAppCommunicator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppCommunicator"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/userInfo/odc/UserInfoDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odc-core/lib/PageConfig","../../../models/upsell/AvailableUpsells","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/upsell/AvailableUpsells","../../../models/upsell/Upsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../GuidedTourDataHelper","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=window.$Config&&window.$Config.isINT,m=1;d.isFeatureEnabled(d.EnableSecurityMomentLightbox)&&(m=2);var g=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pendingRequests={};n._urlDataSource=n.resources.consume(i.urlDataSource);n._currentParamUpsells={};n._experimentMap={};n._wasInOriginalGuidedTourExperiment=!1;n._guidedTourDataHelper=new p.default;n._navigation=n.resources.consume(h.navigation);return n}t.pruneInactiveExperiments=function(e,t){if(t){var n={};for(var r in e)t.indexOf(Number(r))>-1&&(n[r]=e[r]);return n}return e};t.getExperimentMapFromUserInfo=function(e){var t={};try{if(e.param){var n=JSON.parse(e.param);for(var r in n)t[r]=n[r]}if(e.data){var i=JSON.parse(e.data);for(var r in i)t[r]=i[r]}}catch(e){}return t};t.prototype.canPersistUserInfo=function(){return!0};t.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells};t.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e};t.prototype.getAnid=function(){return u.default.getAnid()};t.prototype.getMarket=function(){return u.default.getMarket()};t.prototype.getLanguage=function(){return u.default.getLanguage()};t.prototype.isNewUser=function(){return u.default.isNewUser()};t.prototype.isAuthenticated=function(){return u.default.isAuthenticated()};t.prototype.getUserInfo=function(e){var n=this,r=this._urlDataSource.getUserInfoApiUrl(),i=e?r+"?v="+Math.random():r,u=new o.default;if(this._pendingRequests[r])return this._pendingRequests[r];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return s.default.wrap(this._cachedUserInfo);var a=u.send({apiName:"GetUserInfo",url:i}).then(function(e){delete n._pendingRequests[r];n._cachedUserInfo=e;if(e&&e.notifications)for(var i=0,s=e.notifications;i<s.length;i++){var o=s[i];7===o.type&&o.param&&(n._currentParamUpsells=JSON.parse(o.param))}if(e&&e.info)for(var u=0,a=e.info;u<a.length;u++){var f=a[u];if(32===f.type&&f.param){var l=new Date(2017,4,3);Date.parse(f.createdDate)<l.getTime()&&(n._wasInOriginalGuidedTourExperiment=!0);n._guidedTourDataHelper.setGuidedTourData(JSON.parse(f.param))}else 24===f.type?n._positioningData=f:40===f.type&&(d.isFeatureEnabled(d.ExpFactCleanup)?n._experimentMap=t.getExperimentMapFromUserInfo(f):f.param&&(n._experimentMap=JSON.parse(f.param)))}return e},function(e){delete n._pendingRequests[r];return s.default.wrapError(e)});this._pendingRequests[r]=a;return a};t.prototype.setUserInfo=function(e){var t=this._urlDataSource.setUserInfoApiUrl();return(new o.default).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})};t.prototype.setUserInfoWithUserFacts=function(e,t,n,r,i){var s={type:e,action:t};n&&(s.param=n);i&&(s.data=i);r&&(s.id=r);n&&7===e&&(this._currentParamUpsells=JSON.parse(n));return this.setUserInfo(s)};t.prototype.sendShowUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"SHOWED")};t.prototype.sendCloseUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"CLOSE")};t.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))};t.prototype.handleUpdateUpsellData=function(e,t,n){var r=this.getUpsellVariationIfApplicable(e),i=this._currentParamUpsells[r.id];if(i){t&&(i.d=1);n&&i.v++}else this._currentParamUpsells[r.id]={d:t?1:0,v:n?1:0}};t.prototype.updateUpsellData=function(e,t,n){this.handleUpdateUpsellData(e,t,n);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.hasUserFact=function(e){var t=this;return this.getUserInfo(!1).then(function(n){var r=!1;if(!t._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");(r=t._cachedUserInfo.info.some(function(t){return t.type===e&&t.isSet}))||(r=t._cachedUserInfo.rewards.some(function(t){return t.type===e&&t.isSet}));return r})};t.prototype.getUserFact=function(e){return this.getUserInfo(!1).then(function(t){if(t&&t.info)for(var n=t.info,r=0;r<n.length;r++)if(n[r].type===e)return n[r];return null})};t.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,n=0;n<t.length;n++)if(35===t[n].type)return!0;return!1})};t.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?s.default.wrap(t):this.checkThrottle(l.default[c.default.OneRmO365Upsell]).then(function(e){return e?l.default[c.default.OneRmO365Upsell]:null})};t.prototype.getUpsellViewCount=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=0;t._currentParamUpsells[n.id]&&(r=t._currentParamUpsells[n.id].v);return r},function(e){return null})};t.prototype.getUpsellDismissed=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=!1;t._currentParamUpsells[n.id]&&(r=!!t._currentParamUpsells[n.id].d);return r},function(e){return null})};t.prototype.checkThrottle=function(e){var t=this._navigation.viewParams,n=this.getUpsellDismissed(e),r=this.getUpsellViewCount(e);return s.default.all({didUserDismiss:n,viewCount:r}).then(function(n){var r=n.didUserDismiss,i=n.viewCount;return null!==r&&null!==i&&e.checkThrottle({viewCount:i,didUserDismiss:r,viewParams:t,market:$Config.mkt})})};t.prototype.getUpsellIframeSrc=function(e,t){var n=this;return this.getUserInfo(!1).then(function(r){if(e.getUpsellIframeUrl)return n.getIsPremium(!1).then(function(r){return e.getUpsellIframeUrl({anid:n.getAnid(),market:$Config.mkt,override:0,isNewUser:n.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:e.id,availableUpsells:l.default,isO365:r,bytesAvailable:n._getTotalQuotaInBytes(t),bytesUsed:n._getQuotaUsedInBytes(t)})})})};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?l.default[e.variation]:e};t.prototype.getUpsellDismissedById=function(e,t){return s.default.wrap(void 0)};t.prototype.getUpsellViewCountById=function(e,t){return s.default.wrap(void 0)};t.prototype.markUpsellAsSeen=function(e){return s.default.wrap(void 0)};t.prototype.markUpsellAsDismissed=function(e){return s.default.wrap(void 0)};t.prototype.getFirstRunExperienceDismissed=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=!1;e._currentParamUpsells[c.default.FirstRunExperienceDialog]&&(n=!!e._currentParamUpsells[c.default.FirstRunExperienceDialog].d);return n},function(e){return!0})};t.prototype.getFirstRunExperienceViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=0,r=e._currentParamUpsells[c.default.FirstRunExperienceDialog];r&&(n=r.v);return n})};t.prototype.updateFirstRunExperienceData=function(e,t){this.handleUpdateFirstRunExperienceData(e,t);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.handleUpdateFirstRunExperienceData=function(e,t){var n=this._currentParamUpsells[c.default.FirstRunExperienceDialog];if(n){e&&(n.d=1);t&&n.v++}else this._currentParamUpsells[c.default.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}};t.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})};t.prototype.datePositioningViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t)return new Date(t.createdDate+"z")})};t.prototype.getPremiumUpsellsViewed=function(){return s.default.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t){if(t.param){return JSON.parse(t.param).v>=m}return!1}return!0},function(e){return!0})};t.prototype.setPositioningUserFactWithParams=function(e){if(d.isFeatureEnabled(d.DisablePremiumUserFactUpdate))return s.default.resolve(!0);var t={v:0};this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param));e&&(t.v=m);return this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")};t.prototype.getGuidedTourCompleted=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._navigation.viewParams;return!(!e._wasInOriginalGuidedTourExperiment||t.ignoreGTUserFactCreationDate)||e._guidedTourDataHelper.getGuidedTourCompleted()},function(e){return!0})};t.prototype.getGuidedTourViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getGuidedTourViewCount()})};t.prototype.updateGuidedTourData=function(e,t){this._guidedTourDataHelper.updateGuidedTourData(e,t);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};t.prototype.completeGuidedTourAction=function(e){this._guidedTourDataHelper.completeGuidedTourAction(e);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};t.prototype.getCompletedGuidedTourActions=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getCompletedGuidedTourActions()})};t.prototype.resetGuidedTourUserFact=function(){var e=this;return this.getUserInfo(!1).then(function(t){e._guidedTourDataHelper.resetGuidedTourUserFact();return e.setUserInfoWithUserFacts(32,3,JSON.stringify(e._guidedTourDataHelper.getGuidedTourData()))})};t.prototype.getExpiringSharingLinksSeen=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=e._currentParamUpsells[c.default.ExpiringSharingLinks];return n&&!!n.d},function(e){return!0})};t.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[c.default.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[c.default.ExpiringSharingLinks]={d:1,v:1};this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.getEXPExperimentVariation=function(e){return this._getExperimentVariation(e)};t.prototype.setEXPExperimentVariation=function(e,t,n){return this._setExperimentVariation(e,t,n)};t.prototype._getExperimentVariation=function(e){var t=this;return this.getUserInfo(!0).then(function(){return t._experimentMap&&t._experimentMap[e]?t._experimentMap[e]:0},function(e){return s.default.wrap(0)})};t.prototype._setExperimentVariation=function(e,n,r){var i=this;return this.getUserInfo(!0).then(function(){i._experimentMap[e]=n;if(d.isFeatureEnabled(d.ExpFactCleanup)){i._experimentMap=t.pruneInactiveExperiments(i._experimentMap,r);return i.setUserInfoWithUserFacts(40,3,void 0,void 0,JSON.stringify(i._experimentMap))}return i.setUserInfoWithUserFacts(40,3,JSON.stringify(i._experimentMap))},function(e){return s.default.wrap(!1)})};t.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=e.upsell;if(t)return l.default[t];e.resetUpsells?this.resetUpsellUserFact():e.resetGuidedTour&&this.resetGuidedTourUserFact();return null};t.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total};t.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null};t.prototype._sendUpsell=function(e,t,n,r){var i=new o.default,s=v?a.intBaseUrl:a.baseUrl,u={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:n,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:r},l=s+"api/v1/messaging/web/useraction?"+f.serializeQuery(u);return i.sendPost("OneRM",l,"").then(function(e){return!0},function(e){return!1})};return t})(r.default);t.default=g});
define("odsp-next/models/upsell/AvailableUpsells",["require","exports","./UpsellTypes","./Upsells","../../utilities/features/Features"],function(e,t,n,r,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});var o=window.$Config&&window.$Config.isINT;t.intBaseUrl="https://messaging-int.msonerm.com/";t.baseUrl="https://dynmsg.modpim.com/";var u=((s={})[r.default.NewBrandFRE]={id:r.default.NewBrandFRE,type:n.default.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&Source=OneDriveFRE"},shouldSendMessageOnClose:!0,renderType:0},s[r.default.OneRmO365Upsell]={id:r.default.OneRmO365Upsell,type:n.default.ONEUNIT,ramp:i.OneRmO365UpsellEnabled,checkThrottle:function(e){return i.isFeatureEnabled(i.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&data="+encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable}))+"&Source=OneDriveWebBanner"},shouldSendMessageOnClose:!0,renderType:1},s);t.default=u});
define("odsp-next/models/upsell/UpsellTypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"})(n||(n={}));t.default=n});
define("odsp-next/models/upsell/Upsells",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"})(n||(n={}));t.default=n});
define("odsp-next/dataSources/userInfo/GuidedTourDataHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){this.resetGuidedTourUserFact()}e.prototype.getGuidedTourData=function(){return this._guidedTourData};e.prototype.setGuidedTourData=function(e){this._guidedTourData=e};e.prototype.getGuidedTourCompleted=function(){var e=this._guidedTourData;return!(!e||!e.c)};e.prototype.getGuidedTourViewCount=function(){var e=this._guidedTourData.v;return void 0===e?0:e};e.prototype.updateGuidedTourData=function(e,t){var n=this._guidedTourData;e&&(n.c=!0);t&&(n.v=(n.v||0)+1)};e.prototype.completeGuidedTourAction=function(e){var t=this._guidedTourData;switch(e){case 0:t.u=!0;break;case 1:t.m=!0;break;case 2:t.s=!0;break;case 3:t.sh=!0;break;case 4:t.f=!0;break;default:return}};e.prototype.getCompletedGuidedTourActions=function(){var e=this._guidedTourData,t=[];e.u&&t.push(0);e.m&&t.push(1);e.s&&t.push(2);e.sh&&t.push(3);e.f&&t.push(4);return t};e.prototype.resetGuidedTourUserFact=function(){this._guidedTourData={c:!1,v:0,u:!1,m:!1,s:!1,sh:!1,f:!1}};return e})();t.GuidedTourDataHelper=n;t.default=n});
define("odsp-next/dataSources/versionControl/VersionControlDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.prototype.checkOutItem=function(e){return n.default.wrap()};e.prototype.undoCheckOutItem=function(e){return n.default.wrap()};e.prototype.checkInItem=function(e){return n.default.wrap()};e.prototype.getVersionHistoryUrl=function(e){return""};e.prototype.supportsDocSetVersioning=function(){return!1};return e})();t.default=r});
define("odsp-next/dataSources/versionHistory/odc/VersionHistoryDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/path/Path","../../base/vroom/VroomDataRequestor","../../../providers/sessionManagement/SessionManagementProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/xhr/XHRPromise"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._sessionManagementProvider=n.resources.consume(u.resourceKey);n._urlDataSource=n.resources.consume(a.url);return n}t.prototype.getVersionHistoryInfo=function(e){var t=this;return this._sessionManagementProvider.getToken().then(function(n){return t._getVersionHistory(s.encodePath(e.id)).then(function(r){var i=t._parseVersionHistory(r,e,n);i[0].isCurrentVersion=!0;return i})})};t.prototype.restoreVersionByLabel=function(e,t){var n=this;return this._sessionManagementProvider.getToken().then(function(r){var i="/drive/items/"+s.encodePath(e.id)+"/versions/"+s.encodePath(t)+"/action.restoreVersion",o=n._getUrl(i,r),u={Accept:"application/json","Content-Type":"application/json","Content-Length":"0"};return l.default.start({url:o,headers:u,method:"POST"}).then(function(e){return e.status>=200&&e.status<=299})})};t.prototype.deleteVersionByLabel=function(e,t){return i.default.wrap()};t.prototype.canRestoreVersions=function(){return!0};t.prototype.canDeleteVersions=function(){return!1};t.prototype.showVersionLabel=function(){return!1};t.prototype._parseVersionHistory=function(e,t,n){var r=this;return e.value.map(function(e,i){var o="/drive/items/"+s.encodePath(t.id)+"/versions/"+s.encodePath(e.id)+"/content",u=r._getUrl(o,n);return{created:e.lastModifiedDateTime,id:null,isCurrentVersion:0===i,size:e.size,url:u,versionLabel:e.id,appMap:t.appMap,createdBy:{Id:e.lastModifiedBy.user.id,Title:e.lastModifiedBy.user.displayName}}})};t.prototype._getVersionHistory=function(e){return this._getRequestor().send({apiName:"versions",path:"/drive/items/"+e+"/versions"})};t.prototype._getRequestor=function(){var e=this.resources.consume(o.resourceKey);this._getRequestor=function(){return e};return e};t.prototype._getUrl=function(e,t){var n,r=this._urlDataSource.getApiBaseUrl();t&&t.tokenUrl&&0===e.indexOf("/drive/")?n=new f.default(t.tokenUrl+"/"+e.substring(7)):(n=new f.default(e)).getScheme()||(n=new f.default(r+e));t&&t.accessToken&&n.setQueryParameter("access_token",t.accessToken);return n.toString()};return t})(r.default);t.default=c});
define("@ms/odsp-utilities/lib/path/Path",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.splitFileName=function(e){var t=n(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t}};function n(e,t){void 0===t&&(t=!1);var n="";if(e){var r=e.lastIndexOf(".");r>=0&&(n=t?e.substr(r+1):e.substr(r))}return n}t.getFileExtension=n;t.encodePath=function(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}});
define("odsp-next/dataSources/base/vroom/VroomDataRequestor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","../../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-graph/lib/Base"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new n.ResourceKey({name:"cookieOrigin",factory:new n.ConstantResourceFactory(window.location.origin)});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:i.resourceKey,urlDataSource:r.url,cookieOrigin:o})});
define("odsp-next/providers/sessionManagement/SessionManagementProvider",["require","exports","@ms/odsp-datasources/lib/Permissions","../../dataSources/microService/MicroServiceDataSource.key","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/utilities-error/lib/ApiError","@ms/odsp-utilities/lib/uri/SimpleUri","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=f.isFeatureEnabled(f.UseSelfIssuedTokenForSPOWebAuth)&&f.isFeatureEnabled(f.UseIdentityAuthForVroom),c=f.isFeatureEnabled(f.UseIdentityDataSourceAuthToken),h=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var r=this._identityDataSource.getIdentity().type;if(r===n.IdentityType.aad){if(t&&(l||c&&t.indexOf("$expand=notificationPreferences")>0)){var s=new a.default(t).authority;return this._identityDataSource.getSharePointToken(s)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return i.default.resolve()})}else if(r===n.IdentityType.msa)return this._identityDataSource.getSessionToken();return i.default.reject(new u.ApiError({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:s.identity,microServiceDataSource:r.resourceKey.optional};return e})();t.default=h;t.resourceKey=o.createResolvedResourceKey(e("module").id,h)});
define("odsp-next/dataSources/microService/MicroServiceDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("@ms/odsp-graph/lib/Base",["require","exports","tslib","./base/dataRequestor/DataRequestor","./base/urlHelper/UrlHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@ms/odsp-graph/lib/base/dataRequestor/DataRequestor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/logging/RequestDurationLoggingHelper","../../models/error/Error","@ms/odsp-utilities/lib/guid/Guid","@ms/telemetry-manager/lib/ErrorHelper","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=window&&window.performance,p={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},d=(function(){function e(e,t){var n=e.alwaysSendContentType,r=void 0!==n&&n,i=t.sessionManagementProvider,o=t.urlDataSource,u=t.apiEvent,a=void 0===u?s.Api:u,f=t.cookieOrigin,l=t.isOffline;this._sessionManagementProvider=i;this._alwaysSendContentType=r;this._apiEvent=a;this._apiName=o&&"function"==typeof o.getApiName?o.getApiName():"Vroom";this._apiBaseUrl=o?"function"==typeof o.getApiBaseUrl?o.getApiBaseUrl():o.getVroomApiBaseUrl():void 0;this._cookieOrigin=f;this._isOffline=l}e.prototype.send=function(e){var t=this,d=e.headers,m=void 0===d?{}:d,g=e.path,y=e.endpoint,b=void 0===y?this._apiBaseUrl:y,w=e.driveUrl,E=e.apiName,S=e.disableLogging,x=void 0!==S&&S,T=e.timeout,N=e.onProgress,C=e.onUploadProgress,k=e.qosExtraData,L=e.apiVersion,A=void 0===L?"v2.0":L,O=e.needsAuthorization,M=void 0===O||O,_=e.useAuthorizationHeaders,D=void 0!==_&&_,P=e.accessToken,H=e.postProcessQos,B=e.breakCache,j=e.allowCookies,F=e.hasContentType,I=void 0===F||F,q=e.useMultiPart,R=void 0!==q&&q,U=e.getErrorAsMessage,z=void 0!==U&&U,W=e.expectedErrors,X=n.__assign(n.__assign({},p),e.expectedErrorCodes||{}),V=e.requestType,$=void 0===V?"GET":V,J=this._cookieOrigin,K=new c.default(g).authority?g:""+b+g,Q=function(c){var p,d="",v={};v=R?{"Content-Type":"multipart/form-data;boundary="+(d=f.default.generate())}:n.__assign(n.__assign(n.__assign(n.__assign({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&I?{"Content-Type":"application/json"}:{}),c.useCookies&&c.digestValue?{"x-requestdigest":c.digestValue}:{}),z?{prefer:"rich-error-as-message"}:{}),m);if(c.sessionToken&&c.sessionToken.tokenUrl&&0===g.indexOf("/drive/"))p=new o.default(c.sessionToken.tokenUrl+"/"+g.substring(7));else{p=new o.default(g);b&&!p.getScheme()&&(p=new o.default(b+g))}if(R){p.setQueryParameter("ump","1");"POST"!==$&&(m["X-HTTP-Method-Override"]=$);$="POST"}var y,w=p.toString();if(!R&&c.sessionToken){var S=c.sessionToken,L=S.accessToken,A=S.proofToken,O=S.wlidToken,M=S.isBadger;if(O)v=n.__assign(n.__assign({},v),{Authorization:"wlid1.1 "+O});else if(D){L&&(v=M?n.__assign(n.__assign({},v),{Authorization:"badger "+L}):n.__assign(n.__assign({},v),{Authorization:"bearer "+L}));A&&(v=n.__assign(n.__assign({},v),{"X-PROOF_TOKEN":A}))}else{L&&p.setQueryParameter("access_token",L);A&&p.setQueryParameter("prooftoken",A)}}if(R){var _="";_+="--"+d+"\r\n";_+="Content-Disposition: form-data;name=data\r\n";if(m)for(var P=0,j=Object.keys(m);P<j.length;P++){var F=j[P];_+=F+": "+m[F]+"\r\n"}_+="Content-Type: application/json\r\n";_+="Authorization: bearer "+c.sessionToken.accessToken+"\r\n";z&&(_+="prefer: rich-error-as-message\r\n");_+="\r\n";_+=(void 0!==e.postData?e.postData:"")+"\r\n";_+="--"+d+"--"}B&&p.setQueryParameter("r",Math.random().toFixed(8));if(!x){var q={url:w=(w=w.replace(/(?:(?:access_|proof)token|tempauth|authkey)=[^&]+/gi,"")).replace(/(?:eyJ[A-Za-z0-9_-]+(?:\.|%2E|%252E)){2}(?:[A-Za-z0-9_-]+)/gi,"$REDACTED$"),name:t._apiName+"DataRequest."+E,extraData:k};y=new t._apiEvent(q)}var U=p.toString(),V=h&&h.now();return i.default.start({url:U,headers:v,method:$,json:_||e.postData||"",requestTimeoutInMS:T,withCredentials:c.useCookies,onProgress:N,onUploadProgress:C}).then(function(t){var n=u.getRequestEntryDurationMetrics(U,V);if(y){var r={resultType:s.ResultTypeEnum.Success,extraData:{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:t.getResponseHeader("request-id")||t.getResponseHeader("sprequestguid"),MSCorrelationVector:t.getResponseHeader("MS-CV")}};y.end(r)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var i,o=function(e,t){H&&(e=H(e,t));y&&y.end(e);return r.default.reject(t)},f=u.getRequestEntryDurationMetrics(U,V);if(e instanceof Error){var h=r.default.isCanceled(e),d=h?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,v={error:e.message,resultCode:h?"Canceled":"",resultType:d,extraData:{rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}};return o(v,e)}if(e.responseText)try{i=JSON.parse(e.responseText)}catch(e){}if(z)try{var m=JSON.parse(atob(i.error.message));i={error:m}}catch(e){}var g=e.status,b=e.statusText,w=(i||{}).error,E=void 0===w?{}:w,S=E.message,x=void 0===S?"":S,T=E.innerError,N=void 0===T?{}:T,C=N.stackTrace,L=void 0===C?"":C,A=N.debugMessage,O=void 0===A?"":A;return(g||!t._isOffline?r.default.resolve(!1):t._isOffline()).then(function(t){var r=t?"Offline":"",u=e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),h=t||!!a.getErrorResolutionFromResponse(i,g,function(e){return X[e]}),d=new a.GraphError(new Error(x||r),{response:i,status:g,request:e,correlationId:u,isExpected:h});W&&l.isExpectedError({code:d.code,message:x},W)&&(h=!0);var v={resultType:h?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:x,resultCode:d.code,extraData:n.__assign(n.__assign(n.__assign({},k||{}),a.getQosExtraDataFromError(d)),{stack:L,httpStatus:g,httpStatusText:b,requestId:u,MSCorrelationVector:e.getResponseHeader("MS-CV"),debugMessage:O,accessTokenLength:c.sessionToken&&c.sessionToken.accessToken?c.sessionToken.accessToken.length:-1,urlLength:p.toString().length,useCookies:!!c.useCookies,isOffline:t,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)})};return o(v,d)})})},G=this._sessionManagementProvider;if(M){if(P)return Q({sessionToken:P});if(j&&J&&new c.default(K).authority===J)return G&&G.getFormDigest?G.getFormDigest().then(function(e){return Q({digestValue:e,useCookies:!0})}):Q({useCookies:!0});if(G&&G.getSessionToken){var Y={apiVersion:A,endpoint:b,driveUrl:w,path:K};return r.default.resolve(G.getSessionToken(Y)).then(function(e){return Q({sessionToken:e}).catch(function(t){return e&&(function(e){if(e instanceof a.GraphError){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&"Bearer"===n.slice(0,"Bearer".length)&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1})(t)?G.getSessionToken(n.__assign(n.__assign({},Y),{claimsChallenge:{sessionToken:e,claims:v(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?Q({sessionToken:n}):r.default.reject(t)}):r.default.reject(t)})})}if(G&&G.getToken)return G.getToken(A,K).then(function(e){return Q({sessionToken:e})})}return Q({})};return e})();t.DataRequestor=d;t.default=d;function v(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate");if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1)return t.slice(n+'claims="'.length,r)}}}});
define("@ms/odsp-graph/lib/models/error/Error",["require","exports","tslib","@ms/utilities-error/lib/ApiError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t,r){var i=this,s=r.response,o=(void 0===s?{}:s).error,a=(void 0===o?{}:o).innerError,f=(void 0===a?{}:a).stackTrace,l=void 0===f?"":f,c=r.response,h=r.request,p=r.status,d=r.code,v=void 0===d?u(c,p,function(e){return""+e})||"unhandled":d,m=n.__assign({innerError:t,code:v},r);(i=e.call(this,m)||this).name="GraphError";i.response=c;i.status=p;i.serverStack=l;i.request=h;i.error=t;return i}return t})(r.ApiError);t.GraphError=i;t.getQosExtraDataFromError=function(e){var t={};t.errorMessage=e.message;if(s(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var r=n.error;t.vroomErrorCode=r.code;t.vroomErrorMessage=r.message;var i=r.innerError||r.innererror;if(i){t.vroomErrorInnerCode=i.code;t.vroomErrorInnerMessage=i.message;t.vroomErrorInnerDebugMessage=i.debugMessage;t.vroomErrorInnerStack=i.stackTrace}}}return t};function s(e){return e instanceof i}t.isGraphError=s;function o(e,t){if(s(e)){return u(e.response,e.status,function(n){return t(n,e)})}}t.getErrorResolution=o;t.getResultCodeFromError=function(e){return o(e,function(e){return""+e})||"unhandled"};function u(e,t,n){if(e){for(var r=[],i=e.error;i;){r.push(i);i=i.innerError||i.innererror}for(;i=r.pop();)if(void 0!==i.code){var s=n(i.code);if(void 0!==s)return s}}return n(t)}t.getErrorResolutionFromResponse=u});
define("@ms/odsp-graph/lib/base/urlHelper/UrlHelper",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._getEndpoint()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getEndpoint=function(){var e,t=(this._url+"/").indexOf("/drives/"),n=(this._url+"/").indexOf("/drive/"),r=(this._url+"/").indexOf("/me/");t>-1?e=this._url.substring(0,t):r>-1&&n>-1&&n>r?e=this._url.substring(0,r):n>-1&&(e=this._url.substring(0,n));e&&0===e.indexOf("https:")&&(e=e.replace(":443/","/"));this._getEndpoint=function(){return e};return e};e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment(),n=this._getIndexOfDriveSegment();if(t>-1){var r=this._getPathSegments();e=r[t+1]}else if(n>-1){"me"===(r=this._getPathSegments())[n-1]&&(e="me")}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments(),r=(e=n[t+1])?e.indexOf("?"):-1;-1!==r&&(e=e.substring(0,r))}else{var i=this._getIndexOfDrivesSegment(),s=this._getIndexOfDriveSegment();n=this._getPathSegments();i>-1?"root"===n[i+2]&&(e="root"):s>-1&&"root"===n[s+1]&&(e="root")}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new n.default(t).segments:[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDriveSegment=function(){var e=this._getPathSegments().indexOf("drive");this._getIndexOfDriveSegment=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})();t.getUrlParts=function(e){return new r(e)}});
define("odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VaultTeachingBubble"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/dataSources/tag/odc/TagDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../models/tag/TagType","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(f.urlDataSource);return n}t.prototype.updateTags=function(e){return a.default.start({apiName:"UpdateTags",url:this._getUpdateTagUrl(),batchSize:200,items:e.items,getPostData:function(t){return{tagsToDelete:e.tagsToDelete,tagsToAdd:e.tagsToAdd,ids:t.map(function(e){return e.id})}}})};t.prototype.getAllTags=function(e){var t;switch(e){case o.default.allTags:t=this._getAllTagsUrl();break;case o.default.allPlaces:t=this._getAllGeolocationTagsUrl();break;default:return s.default.wrap(null)}return(new i.default).send({apiName:"GetAllTags",url:t})};t.prototype.getParentKeyForTagType=function(e){var t,n;e===o.default.allTags?n="tags":e===o.default.allPlaces&&(n="places");return this._urlDataSource.getKey(((t={}).id=n,t))};t.prototype._getUpdateTagUrl=function(){return u.default.skyApiBaseUrl+"UpdateTags"};t.prototype._getAllTagsUrl=function(){return u.default.skyApiBaseUrl+"AllTags"};t.prototype._getAllGeolocationTagsUrl=function(){return u.default.skyApiBaseUrl+"AllTags?qt=Geolocation"};return t})(r.default);t.default=l});
define("odsp-next/models/tag/TagType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.allTags=0]="allTags";e[e.allPlaces=1]="allPlaces";e[e.singleTag=2]="singleTag";e[e.singlePlace=3]="singlePlace"})(n||(n={}));t.default=n});
define("odsp-next/dataSources/photo/odc/PhotoDataSource",["require","exports","tslib","cookies","../../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../models/store/ItemsStore","../../../resources/ModelResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./ISkyApiAllPhotosResponse","../../base/odc/ItemErrorProcessor","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../utilities/tag/GroupPacker","../../base/odc/ThumbnailProcessor","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../item/ItemTaskObserver","../../../models/task/Task","../../item/odc/SkyApiErrorHelper","knockout","../../../controls/photos/Photos.resx","../../../dataSources/base/vroom/VroomDataRequestor","./GetOneDriveItemWithSupportedCommands"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";var A;Object.defineProperty(t,"__esModule",{value:!0});var O,M=((A={})[p.GroupType[p.GroupType.Event]]=0,A[p.GroupType[p.GroupType.AlbumSuggestion]]=1,A[p.GroupType[p.GroupType.Highlights]]=2,A[p.GroupType[p.GroupType.Burst]]=3,A),_=["facesFolder","albumFolder","ascending","minRating","maxRating","favorites","highlights","etrmin","bmtsec","bhash","artmin","amtsec","ahashd","abadt","abadu","aminph","atagsout","aexpbph","wtrmin","wmtsec","whashd","wbadt","wbadu","wminph","wtagsout","wexpbph","wtaglist","wtagsother","wtagsnone","wphcount"];(function(e){e[e.ObjectDetectors=0]="ObjectDetectors";e[e.SystemDefined=1]="SystemDefined";e[e.OCR=2]="OCR";e[e.UserDefined=3]="UserDefined";e[e.LocationAndEventsApi=4]="LocationAndEventsApi"})(O=t.TagSource||(t.TagSource={}));var D=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemsStore=n.resources.consume(f.resourceKey);n._itemDataSource=n.resources.consume(c.getItem);n._urlDataSource=n.resources.consume(y.urlDataSource);n._itemErrorProcessor=new(n.managed(d.default));n._identityDataSource=n.resources.consume(c.identity);n._navigation=n.resources.consume(E.navigation);n._userSettingsStore=n.resources.consume(l.userSettingsStore);n._allPhotosUserSettings=N.observable(n._userSettingsStore&&n._userSettingsStore.getAllPhotosUserSettings());n._pendingRequests={};n._thumbnailProcessor=new(n.managed(w.default));n._requestor=n.resources.consume(k.resourceKey);return n}t.prototype.getAllPhotos=function(e){var t,n=this,s=new a.default,u={pagingToken:e.pagingToken,ascending:e.ascending?1:0,pageSize:e.pageSize,rootItemId:e.rootItemId||"root",tagFilter:e.tagFilter,locationFilter:e.locationFilter,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights,verbose:2},f="ap";e.tagFilter&&(f="tag");e.locationFilter&&(f="loc");r.set("thumb-perf-sd",h.serializeQuery({view_id:f,new_ux:i.isFeatureEnabled(i.UseItemsScopeInAllPhotos)}),{secure:!0,domain:".live.com"});0;var l=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.locationFilter=e.locationFilter,t.tagFilter=e.tagFilter,t)),c=this._getAllPhotosUrl()+"?"+h.serializeQuery(u,null,!0),p=this._pendingRequests[c];if(!p){var d=function(e){e.update([new x.default(l).succeed({item:{key:l,isPlaceholder:!1,queryType:g.default.AllMyPhotos,type:m.default.Folder,name:C.default.allPhotosNavLink,properties:{commandsSupported:{defc:"1"}},revision:0}})])};if(e.tagFilter&&!i.isFeatureEnabled(i.EnableTagsInODC)){var v=new(this.resources.consume(S.resourceKey));d(v);v.flush();return o.default.resolve({items:[],futurePagingToken:"",itemGroupings:[],pastPagingToken:""})}p=this._pendingRequests[c]=s.send({apiName:"AllPhotos",url:c,isErrorExpectedCallback:T.isExpectedSkyApiError}).then(function(e){delete n._pendingRequests[c];var t=new(n.resources.consume(S.resourceKey));d(t);var r=n._processAllPhotosResponse(e,t);t.flush();return r},function(e){delete n._pendingRequests[c];var t=new(n.resources.consume(S.resourceKey));n._processError({requestKey:l,error:e,observer:t});t.flush();return o.default.wrapError(e)})}return p};t.prototype.setAllPhotosSettings=function(e){var t=this,n=new a.default,r=u.default.skyApiBaseUrl+"UpdateItem?lct=1",i=this._pendingRequests[r];i||(i=this._pendingRequests[r]=n.sendPost("UpdateItem",r,JSON.stringify(e)).then(function(e){delete t._pendingRequests[r];return e},function(e){delete t._pendingRequests[r];return o.default.wrapError(e)}));return i};t.prototype.getPhotoSetKey=function(e){var t=e.ascending,n=void 0!==t&&t,r=e.rootItemId,i=void 0===r?"root":r;return h.serializeQuery({parentKey:this.getItemKey(e),rootItemId:i,isAscending:n,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights},null,!0)};t.prototype.getItemKey=function(e){var t;return this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t.onThisDay=e.onThisDay,t.u=e.uniqueName,t))};t.prototype.getAllPhotosSettings=function(e){var t,n=this,r=this._allPhotosUserSettings.peek(),i={parentKey:this._urlDataSource.getKey((t={},t.id="root",t.u="allphotossettings",t)),skipCache:!0,skipInMemoryCache:!!e,pageSize:0,itemSetKey:""},s="",o=!1;this._itemDataSource.getItem(i).then(function(e){if(e){var t=n.peekUnwrapObservable(n._itemsStore.getItem(e.item.key));if(t&&t.properties){s=void 0!==t.properties.allPhotosFolderId?t.properties.allPhotosFolderId:r.rootId;o=void 0!==t.properties.allPhotosSortAscending?t.properties.allPhotosSortAscending:r.isAscending;return n._requestor.send({apiName:"Items",path:"/drive/items/"+s+"?$select=specialFolder",requestType:"GET",useAuthorizationHeaders:!0})}}}).done(function(e){var t={rootId:s,isAscending:o,folderName:e.specialFolder?e.specialFolder.name:"root"};n._userSettingsStore.setAllPhotosUserSettings(t);n._allPhotosUserSettings(t)},function(e){});return this._allPhotosUserSettings};t.prototype.getMetadataContext=function(e){var t,n=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t)),r=this._urlDataSource.getKeyParams(n);return{avoidSeamSnapping:!0,parentKey:n,ownerId:this._urlDataSource.getOwnerId(),pageSize:0,filters:{tagFilter:r.tagFilter,locationFilter:r.locationFilter}}};t.prototype._processAllPhotosResponse=function(e,t){for(var n=[],r=[],i=0,s=e.items;i<s.length;i++){var o=s[i];n.push(this._processItem(o,t))}for(var u=0,a=e.itemGroupings;u<a.length;u++){var f=a[u],l=this._processGrouping(f);r.push(l)}return{futurePagingToken:e.futurePagingToken,pastPagingToken:e.pastPagingToken,items:n,itemGroupings:r}};t.prototype._processItem=function(e,t){var n,r=this._urlDataSource.getKey(((n={}).id=e.resId,n)),i={key:r,queryType:g.default.AllMyPhotos,name:e.name,displayName:e.name,extension:e.extension},s=e.thumbnailBaseUrl?this._createThumbnail(e):void 0;if(e.isVideo){i.video={height:e.height,width:e.width};i.iconName="video"}else{i.photo={height:e.height,width:e.width,quality:{isBad:e.isBad}};i.iconName="photo"}var o=e.resId,a=u.default.viewerId;i.id=o;i.itemId=o;i.ownerId=a;i.graph={itemId:o,driveId:a,driveType:"personal"};i.dateTakenTime=e.dateTaken&&new Date(e.dateTaken.isoDate);i.dateTaken=e.dateTaken&&e.dateTaken.date;(i=L.getOneDriveItemWithSupportedCommands(i)).sharingRole=0;i.type=m.default.Media;var f=[];e.tags&&(f=e.tags.filter(function(e){return!e.source||e.source.toLowerCase()!==O[O.OCR].toLowerCase()&&e.source.toLowerCase()!==O[O.LocationAndEventsApi].toLowerCase()}));if(e.location){i.geoLocation=N.utils.extend({},e.location);i.geoLocation.displayString=b.makePlaceName(i.geoLocation)}i.tags=f;i.isPlaceholder=!1;i.thumbnail=s;t.update([new x.default(r).succeed({item:i})]);return i};t.prototype._processGrouping=function(e){for(var t={},n={},r=[],i=0,s=e.groups;i<s.length;i++){var o=s[i],u=this._processGroup(o);t[u.id]=u;for(var a=0,f=u.keys;a<f.length;a++){n[f[a]]=u.id}r.push(u)}return{name:void 0,itemGroups:void 0,groupType:this._getGroupType(e.groupType),groups:r,groupMap:t,itemToGroupMap:n}};t.prototype._processGroup=function(e){for(var t,n=[],r=0,i=e.resIds;r<i.length;r++){var s=i[r],o=this._urlDataSource.getKey(((t={}).id=s,t));n.push(o)}var u=N.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.earliestPhotoTime.isoDate)},e.earliestPhotoTime),a=N.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.latestPhotoTime.isoDate)},e.latestPhotoTime);return{closedFuture:e.closedFuture,closedPast:e.closedPast,earliestPhotoTime:u,id:e.id,latestPhotoTime:a,location:e.location,keys:n,featuredKey:e.featuredResIds&&e.featuredResIds[0]}};t.prototype._extractUTCFullYearFromIsoDate=function(e){return new Date(e).getUTCFullYear().toString()};t.prototype._processError=function(e){var t=e.requestKey,n=e.error,r=e.observer;2===(n&&n.data&&n.data.code)&&this._identityDataSource.getIdentity().type===v.IdentityType.anonymous&&(n.data.code=152);this._itemErrorProcessor.processError({requestKey:t,error:n,observer:r})};t.prototype._getAllPhotosUrl=function(){return u.default.skyApiBaseUrl+"AllPhotos"};t.prototype._createThumbnail=function(e){return this._thumbnailProcessor.processThumbnailSet({baseUrl:"",thumbnails:[{name:"unRes",url:e.thumbnailBaseUrl+"?"+h.serializeQuery({psid:2}),width:e.width,height:e.height}]},{id:e.resId,ownerCid:u.default.viewerId,photo:{width:e.width,height:e.height}})};t.prototype._getGroupType=function(e){return M[e]||0};t.prototype._addDebugParamsToRequest=function(e){for(var t=this._navigation.viewParams,n=0,r=_;n<r.length;n++){var i=r[n];i in t&&(e[i]=t[i])}};return t})(s.default);t.default=D});
define("odsp-next/dataSources/photo/odc/ISkyApiAllPhotosResponse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Event=0]="Event";e[e.AlbumSuggestion=1]="AlbumSuggestion";e[e.Highlights=2]="Highlights";e[e.Burst=3]="Burst"})(t.GroupType||(t.GroupType={}))});
define("odsp-next/utilities/tag/GroupPacker",["require","exports","knockout","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/string/StringHelper","../../models/item/OneDriveItem","../../dataSources/url/odc/UrlDataSource","../../models/item/ItemType","../../models/tag/TagType","../../dataSources/url/QueryType","../../dataSources/album/odc/AlbumDataSource","../../controls/allTagsHeader/AllTagsHeader.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={"pokémon":!0},p={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},d=[l.NEW_ALBUM_TAG,l.AUTO_ALBUM_TAG,l.WEEKEND_RECAP_ALBUM_TAG,l.EVENT_RECAP_ALBUM_TAG];t.ALLPLACES_GEOLOCATION_DELIMITER=String.fromCharCode(9);t.ALLPLACES_GEOLOCATION_HARDCODED="%09";t.HEADER_GROUPINGID="tagHeader";var v=0;t.packAllTags=function(e,r,s,o,u){var f=e.length,l=0,v=[];if(1!==r){for(var g=0,y=e;g<y.length;g++){k=y[g];if(h[k.tag.toLowerCase()]||l<11&&p[k.tag.toLowerCase()]&&-1===d.indexOf(k.tag)){s.push(n.observable(m(a.default.allTags,k,null,u)));l++}}if(l>0){var b={groupingId:t.HEADER_GROUPINGID,startIndex:0,count:l,tagHeader:{title:c.default.topTagsTitleText,countSubtitle:""}};v.push(b)}e.sort(function(e,t){var n=e.localizedTag||e.tag,r=t.localizedTag||t.tag;return n.localeCompare(r)});for(var w=0,E=e;w<E.length;w++){k=E[w];-1===d.indexOf(k.tag)?s.push(n.observable(m(a.default.allTags,k,null,u))):f--}if(f>0){var S=i.pluralSelect(f,c.default.numberTagsSingularSubtitleText,i.format(c.default.numberTagsPluralSubtitleText,f)),x={groupingId:t.HEADER_GROUPINGID,startIndex:l,count:f,tagHeader:{title:c.default.allTagsTitleText,countSubtitle:S}};v.push(x)}var T={name:"tagGrouping",itemGroups:v};o.push(T)}else for(var N=0,C=e;N<C.length;N++){var k=C[N];-1===d.indexOf(k.tag)&&s.push(n.observable(m(a.default.allTags,k,null,u)))}};t.packAllPlaces=function(e,r,i,s,o,u){for(var f={},l=0,h=r;l<h.length;l++){var p=h[l];f[p.hierarchyIndex]=!0}e=e.filter(function(e){return f[e]});for(var d=[],v=[],g={name:c.default.otherRegionsTitleText,places:[],totalPlaces:0},x=0,T=r;x<T.length;x++){var N=T[x],C=N.country;if(""===C){g.places.push(N);g.totalPlaces++}else if(v.indexOf(C)<0){d.push(y(C,N));v.push(C)}else b(C,N,d)}d.sort(function(e,t){return t.totalPlaces-e.totalPlaces});g.totalPlaces>0&&d.push(g);for(var k={},L=e.length,A=[],O=L,M=0,_=d;M<_.length;M++){var D=_[M],P=D.places;w(P);P.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var H=P.length,B=void 0,j=0,F=P;j<F.length;j++){var I=F[j];B=m(a.default.allPlaces,null,I,o);i.push(n.observable(B));e.indexOf(I.hierarchyIndex)>-1&&(k[I.hierarchyIndex]=S(B))}A.push(E(O,H,D.name,u(D.name)));O+=H}var q=r.length;if(L>0&&q>=L){for(var R=L-1;R>-1;R--)i.unshift(n.observable(k[e[R]]));var U={groupingId:t.HEADER_GROUPINGID,startIndex:0,count:L,tagHeader:{title:c.default.recentPlacesTitleText,countSubtitle:""}};A.unshift(U)}var z={name:"tagGrouping",itemGroups:A};s.push(z)};function m(e,t,n,r){var i,l=((i={}).qt="allmyphotos",i.v="photos",i.id=r.rootItemId,i);switch(e){case a.default.allTags:var c=void 0;c=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag;l.tagFilter=c;break;case a.default.allPlaces:l.locationFilter=n.hierarchyIndex}l.u=""+v++;var h=o.default.getKey(l),p=new s.default(h);p.type=u.default.Folder;p.queryType=f.default.AllMyPhotos;var d={tagType:e};p.tagInfo=d;p.folder={photoCount:0,covers:[]};switch(e){case a.default.allTags:p.name="#"+(t.localizedTag||t.tag);p.id=t.tag;p.folder.childCount=t.count;p.childCount=t.count;break;case a.default.allPlaces:p.name=n.displayString;p.id=n.hierarchyIndex;p.folder.childCount=n.count;p.childCount=n.count;break;default:return null}p.properties.commandsSupported={defc:"1"};p.isDraggable=!1;return p}t.createNewTagItem=m;function g(e){var t="";e.city&&(t+=e.city+", ");e.state&&(t+=e.state+", ");return 0===t.length?e.country||"":t.slice(0,-2)}t.makePlaceName=g;function y(e,t){var n=[];n.push(t);return{name:e,places:n,totalPlaces:1}}function b(e,t,n){for(var r,i=n.length,s=0;s<i;s++)if(e===(r=n[s]).name){r.places.push(t);r.totalPlaces++;break}}function w(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.displayString=g(r)}}function E(e,n,r,s){var o=i.pluralSelect(n,c.default.numberPlacesSingularSubtitleText,i.format(c.default.numberPlacesPluralSubtitleText,n));return{groupingId:t.HEADER_GROUPINGID,startIndex:e,count:n,tagHeader:{title:r,countSubtitle:o,regionUrl:s}}}function S(e){var t=r.deserializeQuery(e.key);t.u=v++;var n=o.default.getKey(t),i=new s.default(n);i.type=e.type;i.queryType=e.queryType;var u={tagType:e.tagInfo.tagType};i.tagInfo=u;i.name=e.name;i.id=e.id;var a={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};i.folder=a;i.properties.commandsSupported={defc:"1"};i.isDraggable=!1;return i}});
define("odsp-next/providers/instrumentation/InstrumentationProvider",["require","exports","tslib","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/images/ImagePromise","../../resources/DataSourceResourceKeys","../engagement/Engagement","./Page.event","../../dataSources/url/SearchTypeChecker","../../models/search/SearchSession.key","../../resources/ProviderResourceKeys","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},b=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.searchSessionStarted=!1;n._dataStore=new i.default("",s.default.session);n._instrumentationDataSource=n.resources.consume(c.instrumentation.optional);n._pageEvent=void 0;n._engagement=n.resources.consume(h.resourceKey);n._searchSession=n.resources.consume(v.resourceKey.optional);return n}t.prototype.logStartSearchOnSubmit=function(){if(!this.searchSessionStarted){var e={name:"StartSearchSession",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(e)}};t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};t.prototype.userViewPage=function(e){var t=e.name,n=e.item,r="(none)";if(this._pageEvent){r=this._pageEvent.data.currentName;this._pageEvent.end();this.userExecuteAction({name:"NavigatePage"})}this._pageEvent=new p.Page({currentName:t,previousName:r});this._engagement.logData({name:"Page.View",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:t,previousPage:r,extraData:this._getExtraData(t)});g.isFeatureEnabled(g.WriteMruSignalWhenMediaViewedOneUp)&&n&&(n.video||n.audio||n.photo)&&this.resources.consumeAsync(m.mruRecent.optional).then(function(e){e&&e.recordDocumentView(n)})};t.prototype.userSeeItem=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userSeeItem(e)};t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e)};t.prototype.userClickItem=function(e){var t=o.default[o.default.bingClickInstrumentation];if(d.isSearchType(e.queryType)&&e.urls&&e.urls[t]){var n=new a.Qos({name:"SearchResultClickItem"});l.request(e.urls[t]).done(function(){n.end({resultType:f.ResultTypeEnum.Success})},function(){n.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)};t.prototype.userClickSuggestion=function(e){if(e){var t=new a.Qos({name:"SearchSuggestionClickItem"});l.request(e).done(function(){t.end({resultType:f.ResultTypeEnum.Success})},function(){t.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e}})})}};t.prototype.getEngagementData=function(){return this._getExtraData()};t.prototype._getExtraData=function(e){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName()):null};t.prototype._startSearchSession=function(){this.searchSessionStarted=!0};t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=this._engagement;n.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:t,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(y[t]){var r=new Date(e.dateModifiedValue),i=Math.ceil(((new Date).getTime()-r.getTime())/1e3);i>0&&n.logData({name:"OfficeDocument.Clicked",extraData:{extension:t,age:i,dateModified:e.dateModifiedValue}})}}}catch(e){}};return t})(r.default);t.default=b});
define("@ms/odsp-utilities/lib/images/ImagePromise",["require","exports","../async/Signal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.request=function(e){var t=new n.default,r=document.createElement("img");r.onload=function(){t.complete()};r.onerror=function(){t.error()};r.src=e;return t.getPromise()}});
define("odsp-next/providers/instrumentation/Page.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Page=n.createPairedEvent({eventName:"Page,",shortEventName:"Page"},{previousName:1,currentName:1});t.default=t.Page});
define("odsp-next/models/search/SearchSession.key",["require","exports","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(n.default.generate())})});
define("odsp-next/utilities/logging/odc/CommonQos",["require","exports","../CommonQos"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logCDNFailOverQoS=function(){var e=window.__cdnFailOverState;n.logCDNFailOverQoS(e)};t.logSubresourceIntegrityQoS=function(){n.logSubresourceIntegrityQoS()}});
define("odsp-next/utilities/logging/CommonQos",["require","exports","tslib","@ms/telemetry-manager/lib/events/Qos.event","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logCDNFailOverQoS=function(e){var t,n,o,u,a,f=new r.Qos({name:"ModernCDN.odsp-next"});if(e){var l=e.baseUrlFailedOver,c=e.modulesFalledBack;if(l)f.end({resultType:r.ResultTypeEnum.Failure,extraData:{countOfModulesFalledBack:c.length,modulesFalledBack:c,currentBaseUrl:window.require.toUrl("")}});else if(0===c.length)f.end({resultType:r.ResultTypeEnum.Success});else{var h=c[0],p=window.require.toUrl(h)+".js";s({primaryRequestUrl:(t=c[0],n=window.require.toUrl(t)+".js",o=new i.default(n).getHost(),u=window.require.toUrl(""),a=new i.default(u).getHost(),n.replace(o,a)),backupRequestUrl:p,cdnFailOverState:e})}}else f.end({resultType:r.ResultTypeEnum.Success})};t.logSubresourceIntegrityQoS=function(){new r.Qos({name:"SubresourceIntegrity.odsp-next"}).end({resultType:r.ResultTypeEnum.Success});window.__integrityViolationCallBack||(window.__integrityViolationCallBack=function(e){s({primaryRequestUrl:e,backupRequestUrl:(t=e,n=new i.default(t).getHost(),r=new i.default(window.__backupBaseUrl).getHost(),t.replace(n,r)),cdnFailOverState:void 0});var t,n,r})};function s(e){var t=e.primaryRequestUrl,i=e.backupRequestUrl,s=e.cdnFailOverState;Promise.all([o(t),o(i)]).then(function(e){var t=e[0],i=e[1],o=new r.Qos({name:"ModernCDN.odsp-next"});if(t&&i&&200===t.httpStatus&&200===i.httpStatus&&t.content!==i.content){new r.Qos({name:"SubresourceIntegrity.odsp-next"}).end({resultType:r.ResultTypeEnum.Failure,resultCode:t.httpStatus.toString(),error:"integrity mismatch",extraData:n.__assign({},t)});o.end({resultType:r.ResultTypeEnum.Failure,resultCode:t.httpStatus.toString(),error:"integrity mismatch",extraData:n.__assign(n.__assign({},s?{countOfModulesFalledBack:s.modulesFalledBack.length,modulesFalledBack:s.modulesFalledBack,baseUrlFailedOver:s.baseUrlFailedOver}:{}),t)})}else s&&s.baseUrlFailedOver?o.end(n.__assign(n.__assign({resultType:r.ResultTypeEnum.Failure},t&&{resultCode:t.httpStatus.toString()}),{error:"multiple network errors and complete fail-over",extraData:n.__assign({countOfModulesFalledBack:s.modulesFalledBack.length,modulesFalledBack:s.modulesFalledBack,baseUrlFailedOver:s.baseUrlFailedOver},t)})):o.end(n.__assign(n.__assign({resultType:r.ResultTypeEnum.ExpectedFailure},t&&{resultCode:t.httpStatus.toString()}),{error:"single network error",extraData:n.__assign(n.__assign({},s?{countOfModulesFalledBack:s.modulesFalledBack.length,modulesFalledBack:s.modulesFalledBack,baseUrlFailedOver:!!s.baseUrlFailedOver}:{}),t)}))})}function o(e){var t;return"fetch"in window&&void 0!==window.fetch?fetch(e).then(function(e){t=e;return e.text()}).then(function(n){return{url:e,httpStatus:t.status,content:encodeURIComponent(n)}}).catch(function(t){return{url:e,httpStatus:void 0,content:JSON.stringify(t)}}):Promise.resolve(void 0)}});
define("odsp-next/dataSources/feedback/odc/FeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(u.urlDataSource);return t}t.prototype.getFeedbackUrl=function(){var e=new i.default,t=this._urlDataSource.getFeedbackUrl();return e.send({apiName:"GetFeedbackUrl",url:t}).then(function(e){var t=window.Flight&&window.Flight.version,n=$Config.isINT,r=window.FilesConfig&&window.FilesConfig.df,i="https://"+(n?"onedrive.live-int.com":"onedrive.live.com")+("/handlers/clientstring.mvc?mkt="+$Config.mkt+"&group=Parature"),o={v:"dev"===t?$Config.build+"-DF":t+(r?"-DF":""),isRtl:s.default.isRightToLeft?1:0,localeUrl:i,isDf:r?1:0,curUrl:window.location.href.replace(/authkey=![^&]*/i,"authkey=!!!")},u=n?"&ACSIdx=4":"",f=a.serializeQuery(o);return e.feedbackUrl+encodeURIComponent(encodeURIComponent("&"+f))+u},function(e){return o.default.wrapError(e)})};t.prototype.getFeedbackEndpoints=function(){return["https://onedrive-feedback.ts.parature.com","https://onedrivesmoketest.azurewebsites.net"]};return t})(r.default);t.default=f});
define("odsp-next/dataSources/sendFeedback/odc/SendFeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._platform=t.resources.consume(l.platformDetection);t._urlDataSource=t.resources.consume(u.urlDataSource);return t}t.prototype.sendFeedback=function(e){var t=FilesConfig.SuiteNavConfig.UserDisplayName,n=$Config.email,r=this._getBoundaryString(),u=window.FilesConfig&&window.FilesConfig.df,f=this._platform.osName+" "+this._platform.osVersion,l=$Config.pageContextInfo.pageType,c=a.format(o.default.feedbackBaseUrl,o.default.viewerId)+"/SendFeedback?mkt="+$Config.mkt,h=this._platform.browserName,p=this._platform.browserMajor,d=new i.default,v={};v["Content-Type"]="multipart/related; boundary="+r;var m="\r\n--"+r+"\r\nContent-ID: <Feedback>\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify({device:{platform:"Web",platformVersion:f,deviceModel:h,deviceVersion:p},appVersion:Flight.version,feedbackType:"Bug",app:"OneDrive",isDogfoodBuild:u?1:0,comment:e,backendVersion:l,user:{email:n,firstName:t,isBusiness:!1,authType:"MSA",authEnvironment:"Prod"},extraData:[{id:"360018226372",value:Flight.session}]})+"\r\n\r\n--"+r+"\r\n";return d.send({headers:v,apiName:"SendFeedback",url:c,requestType:"POST",postData:m,returnRawXHR:!0,useDefaultHeaders:!0}).then(function(e){return s.default.wrap(e.statusText)},function(e){return s.default.wrapError(e)})};t.prototype._getBoundaryString=function(){return f.default.generate()};return t})(r.default);t.default=c});
define("odsp-next/dataSources/userActivity/odc/UserActivityDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../../models/item/ItemType","../../url/odc/UrlDataSource","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){return"system"!==e.userId&&"anonymous"!==e.userId}var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(u.urlDataSource);return n}t.prototype.getActivities=function(){var e=this,t=this._getActivityUrl();return(new r.default).send({apiName:"GetActivites",url:t,requestType:"GET"}).then(function(t){for(var n,r=[],s=0,o=t.activities;s<o.length;s++){for(var u=o[s],f=[],l=0,c=u.actors;l<c.length;l++){var h=c[l],p=e._getActorImageUrl(h);f.push({userId:h.id,name:h.displayName,email:"",image:p})}var d=void 0;switch(u.object.it){case 3:d=i.default.File;break;case 6:case 5:case 4:d=i.default.Media;break;case 2:d=i.default.Folder;break;default:d=i.default.Unknown}var v=u.object.rid,m=1===f.length&&a(f[0])?f[0]:void 0;r.push({actors:f,item:{id:v,name:u.object.n,itemType:d},message:u.messageText,timestamp:new Date(u.timestamp),key:e._urlDataSource.getKey((n={},n.id=v,n.cid=m?m.userId:void 0,n))})}return{activities:r}})};t.prototype._getActivityUrl=function(){return s.default.activityApiBaseUrl+"Activities?$take=20"};t.prototype._getActorImageUrl=function(e){return"system"===e.id?"https://p.sfx.ms/Activity/v1/od_icon_96x96_square.png":"anonymous"===e.id?null:s.default.getProfileImage(e.id)};return t})(o.default);t.default=f});
define("odsp-next/providers/userActivity/UserActivityProvider",["require","exports","../../resources/DataSourceResourceKeys"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._dataSource=this.resources.consume(n.userActivity)}e.prototype.getActivities=function(){return this._dataSource.getActivities()};return e})();t.default=r});
define("odsp-next/providers/feedback/FeedbackProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._feedbackDataSource=n.resources.consume(s.feedback);return n}t.prototype.getFeedbackUrl=function(){return this._feedbackDataSource.getFeedbackUrl().then(function(e){return e},function(e){return i.default.wrapError(e)})};t.prototype.getFeedbackEndpoints=function(){return this._feedbackDataSource.getFeedbackEndpoints()};return t})(r.default);t.default=o});
define("odsp-next/providers/embed/EmbedProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._embedDataSource=n.resources.consume(i.embed);return n}t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)};return t})(r.default);t.default=s});
define("odsp-next/dataSources/embed/odc/EmbedDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(o.urlDataSource);return t}t.prototype.getEmbedInfo=function(e){var t=this,n=new i.default,r=this._urlDataSource.getEmbedInfoUrl(e);return n.send({apiName:"GetEmbedInfo",url:r,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return t._isExpected(e)?null:s.default.wrapError(e)})};t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code};return t})(r.default);t.default=u});
define("odsp-next/providers/userInfo/UserInfoProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/upsell/AvailableUpsells"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.dataSource=n.resources.consume(r.userInfo);n.canPersistUserInfo=n.dataSource.canPersistUserInfo();return n}t.prototype.getAnid=function(){return this.dataSource.getAnid()};t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){t._cachedUserInfo=e;return e},function(e){return i.default.wrapError(null)}):i.default.wrap(null):i.default.wrap(this._cachedUserInfo)};t.prototype.setUserInfo=function(e,t,n,r,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,r,i)};t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};t.prototype.getBubbleUserFact=function(e,t){var n=this;return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t):this.getUserInfo(t).then(function(t){if(t&&t.info)for(var r=0,i=t.info;r<i.length;r++){var s=i[r],o=n.peekUnwrapObservable(e),u=n.peekUnwrapObservable(o.campaignGuid);if(s.id&&s.id.toLowerCase()===u.toLowerCase())return JSON.parse(s.data)}return{d:!1,v:0}},function(e){return i.default.wrapError(null)})};t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};t.prototype.getSurveyStatusUserFact=function(e,t,n){return t?i.default.resolve({activated:!1,dateLastModified:new Date}):this.dataSource.getSurveyStatusUserFact?this.dataSource.getSurveyStatusUserFact(e):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){return this.dataSource.setSurveyStatusUserFact?this.dataSource.setSurveyStatusUserFact(e,t):this.setUserInfo(47,3,null,e,JSON.stringify({a:t.activated}))};t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)};t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)};t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?o.default[e.variation]:e};t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)};t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)};t.prototype.getMarket=function(){return this.dataSource.getMarket()};t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};t.prototype.getGuidedTourCompleted=function(){return this.dataSource.getGuidedTourCompleted()};t.prototype.getGuidedTourViewCount=function(){return this.dataSource.getGuidedTourViewCount()};t.prototype.updateGuidedTourData=function(e,t){return this.dataSource.updateGuidedTourData(e,t)};t.prototype.completeGuidedTourAction=function(e){return this.dataSource.completeGuidedTourAction(e)};t.prototype.getCompletedGuidedTourActions=function(){return this.dataSource.getCompletedGuidedTourActions()};t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};t.prototype.getEXPExperimentVariation=function(e){return this.dataSource.getEXPExperimentVariation(e)};t.prototype.setEXPExperimentVariation=function(e,t,n){return this.dataSource.setEXPExperimentVariation(e,t,n)};return t})(s.default);t.default=u});
define("odsp-next/providers/ransomwareDetection/RansomwareDetectionProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../dataSources/url/PageType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.pageType=n.pageType;r._urlDataSource=n.urlDataSource;r._navigation=n.navigation;r._ransomwareDetectionDataSource=n.ransomwareDataSource;r.activeAnomaly=r.observables.create();r.createBackgroundComputed(function(){var e=r.activeAnomaly.peek()||r.activeAnomaly();r._redirectByAnomalyState(e&&e.state)});return r}t.prototype.checkActiveAnomalies=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly().then(function(t){e.activeAnomaly(t);return t})};t.prototype.getAnomalyDetectedDate=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly(!0).then(function(t){if(t&&t.detectedDateTime){var n=e.activeAnomaly.peek();n.detectedDateTime=t.detectedDateTime;n.id=t.id;e.activeAnomaly(n)}return t&&t.detectedDateTime})};t.prototype.updateActiveAnomalyState=function(e){var t=this.activeAnomaly();return t?this._ransomwareDetectionDataSource.updateAnomalyState(t.id,e):Promise.resolve(null)};t.prototype._redirectByAnomalyState=function(e){switch(e){case 0:case 1:this.pageType()!==f.default.RansomwareDetection&&this._navigation.updateViewParams({v:"RansomwareDetection"},{ignoreHistory:!0});break;case 2:this.pageType()!==f.default.Restore&&this._navigation.updateViewParams({v:"restore"},{ignoreHistory:!0});break;case 4:case 3:case 5:this.pageType()===f.default.RansomwareDetection&&this._navigation.navigateTo({url:this._urlDataSource.getCurrentPageBaseUrl()});break;default:return}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{bundleLoaderProvider:o.bundleLoader,pageType:a.currentPage,urlDataSource:u.url,navigation:s.navigation,ransomwareDataSource:u.ransomwareDetection});return t})(r.default);t.default=l;t.resourceKey=i.createResolvedResourceKey(e("module").id,l)});
define("odsp-next/providers/tag/TagProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/tag/GroupPacker","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../models/itemSet/ItemSet","../item/ItemProvider","../../dataSources/item/ItemTaskObserver","../engagement/Engagement","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/tag/TagType","../../dataSources/url/QueryType","../../utilities/regex/Regex","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/Permissions","../../dataSources/base/odc/ItemErrorProcessor","../../models/item/ItemType","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Semaphore","knockout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._store=n.resources.consume(p.resourceKey);n._tagDataSource=n.resources.consume(o.tag);n._photoProvider=n.resources.consume(u.photo);n._identityDataSource=n.resources.consume(o.identity);n._urlDataSource=n.resources.consume(o.url);n._engagement=n.resources.consume(c.resourceKey);n._itemErrorProcessor=new(n.managed(w.default));return n}t.prototype.getAllTags=function(e){var t=this,n=this.getAllTagsSync(e,v.default.allTags);return n.isPlaceholder||n.isExpired?this._tagDataSource.getAllTags(v.default.allTags).then(function(r){t._clearPlaceholder(n.item.peek());var s=[],o=[];i.packAllTags(t._normalizeTags(r.tags),e.skipGrouping?1:0,s,o,e);n.isExpired=!1;n.isPlaceholder=!1;n.content({items:s,groupings:o});return n},function(e){t._processError(n.item.peek().key,e);return s.default.wrapError(e)}):n.content.peek().items.length>0?this._getThumbnails(n,e,v.default.allTags):s.default.wrap(n)};t.prototype.ensureHasThumbnails=function(e,t,n){for(var r=e.content.peek().items,i=0;i<r.length;i++)!r[i].peek().folder.covers.length&&i>=t.start&&i<=t.end&&this._fetchThumbnails(r[i],v.default.allTags,n)};t.prototype.getAllTagsForQuery=function(e,t){var n=this._photoProvider.getAllPhotosSettings().peek();return this.getAllTags({parentKey:null,startIndex:0,skipGrouping:!0,rootItemId:n.rootId}).then(function(n){for(var r=[],i=n.content.peek().items,s="#"===e[0]?e.substring(1):e,o=new RegExp("(^|\\s|/)"+g.default.escapeUserInput(s),"i"),u=new a.default,f="",l={},c=0,h=t;c<h.length;c++){l[h[c].toLocaleLowerCase()]=!0}for(var p=0,d=i;p<d.length;p++){var v=d[p];f=v.peek().name;e&&!o.test(f.substring(1))||l[f.toLocaleLowerCase()]||r.push(v)}u.item=n.item;u.content.peek().items=r;return u})};t.prototype.getAllPlaces=function(e){var t=this,n=this.getAllTagsSync(e,v.default.allPlaces);if(n.isPlaceholder||n.isExpired){var r=[],o=[],u=[];r.push(this._fetchRecentPlaces(o));r.push(this._fetchPlaceTags(n.item.peek().key,u));return s.default.all(r).then(function(){var r=[],s=[],a=t._urlDataSource.getAllPhotosForPlaceUrl.bind(t._urlDataSource);i.packAllPlaces(o,u,r,s,e,a);n.isPlaceholder=!1;t._clearPlaceholder(n.item.peek());n.content({items:r,groupings:s});return n},function(e){return s.default.wrapError(e)})}return this._getThumbnails(n,e,v.default.allPlaces)};t.prototype.getAllTagsSync=function(e,t){var n=this._getAllTagsSetKey(t,e),r=this._store.getItemSet(n);if(!r){var i=this._tagDataSource.getParentKeyForTagType(t),s=this._store.getItem(i);if(!s){var o=new d.default(i);o.type=E.default.Folder;o.virtualItemType=S.default.TagsRoot;o.queryType=m.default.AllMyPhotos;o.isRootFolder=!0;this._store.setItem(o);s=this._store.getItem(i)}(r=new h.default(n,e)).item=s;this._store.setItemSet(n,r)}return r};t.prototype.updateTags=function(e){var t=this,n=this.resources.consume(f.resourceKey);return this._tagDataSource.updateTags(e).then(function(r){for(var i,s=e.skipInvalidate,u=0,a=e.items.length;u<a;u++)if((i=e.items[u]).parent)if(s){var f={parentKey:i.key,ownerId:t._urlDataSource.getOwnerId(),skipCache:!0};n.getItem(f)}else n.invalidateItem(i.parent.key);if(e.parentKey&&!s){n.invalidateItem(e.parentKey);t.resources.consumeAsync(o.itemInvalidator).then(function(e){e.invalidateCurrentItemSet()})}t.invalidateAllTags("root");for(var l=0,c=[].concat(e.tagsToAdd).concat(e.tagsToDelete);l<c.length;l++){var h=c[l];h&&h.tag&&t._store.invalidateTag(h.tag)}t._engagement.logData({name:"TagProvider.UpdateTags",isIntentional:!0,extraData:{itemCount:e.items&&e.items.length,tagsAddedCount:e.tagsToAdd&&e.tagsToAdd.length,tagsRemovedCount:e.tagsToDelete&&e.tagsToDelete.length}});return r},function(e){return s.default.wrapError(e)})};t.prototype.invalidateAllTags=function(e){var t={parentKey:null,skipGrouping:!1};this._store.invalidateItemSet(this._getAllTagsSetKey(v.default.allTags,t));t.skipGrouping=!0;this._store.invalidateItemSet(this._getAllTagsSetKey(v.default.allTags,t))};t.prototype._getThumbnails=function(e,t,n){for(var r=this,i=e.content.peek().items,o=[],u=Math.min(i.length,t.endIndex),a=new x.default(4),f=function(e,t,n){return function(){return r._fetchThumbnails(e,t,n)}},l=t.startIndex;l<u;l++){var c=i[l].peek();c&&!c.folder.covers.length&&o.push(a.enqueue(f(i[l],n,t)))}return s.default.all(o).then(function(){return e},function(e){return s.default.wrapError(e)})};t.prototype._fetchThumbnails=function(e,t,n){var r=this,i={parentKey:n.parentKey,rootItemId:n&&n.rootItemId,ascending:n&&n.ascending,pageSize:5,startIndex:0};switch(t){case v.default.allTags:i.tagFilter=e.peek().id;i.photoType=2;break;case v.default.allPlaces:i.locationFilter=e.peek().id;i.photoType=3;break;default:return s.default.wrap()}return this._photoProvider.getAllPhotos(i).then(function(t){for(var n=[],i=0,o=t;i<o.length;i++){var u=o[i];u.thumbnail&&n.push(u.thumbnail)}var a=new d.default(e.peek().key);T.utils.extend(a,e.peek());a.folder=T.utils.extend({},e.peek().folder);a.folder.covers=n;e(a);r._store.setItem(a);return s.default.wrap()},function(e){return s.default.wrapError(e)})};t.prototype._fetchRecentPlaces=function(e){var t={parentKey:void 0,startIndex:0,pageSize:100};return this._photoProvider.getAllPhotos(t).then(function(t){for(var n=t.length,r=0;e.length<5&&r<n;r++){var i=t[r].geoLocation,o=i&&i.hierarchyIndex;if(o){o=o.trim();e.indexOf(o)<0&&e.push(o)}}return s.default.wrap()},function(e){return s.default.wrapError(e)})};t.prototype._fetchPlaceTags=function(e,t){var n=this;return this._tagDataSource.getAllTags(v.default.allPlaces).then(function(e){for(var n=0,r=e.locations;n<r.length;n++){var i=r[n],o=i.hierarchyIndex&&i.hierarchyIndex.trim();if(o){i.hierarchyIndex=o;t.push(i);if(!i.country){var u=o.split("\t");i.country=u[0];!i.city&&u.length>1&&(i.city=u[u.length-1])}}}return s.default.wrap()},function(t){n._processError(e,t);return s.default.wrapError(t)})};t.prototype._processError=function(e,t){2===(t&&t.data&&t.data.code||0)&&this._identityDataSource.getIdentity().type===b.IdentityType.anonymous&&(t.data.code=152);var n=new(this.resources.consume(l.resourceKey));this._itemErrorProcessor.processError({requestKey:e,error:t,observer:n});n.flush()};t.prototype._getAllTagsSetKey=function(e,t){var n={tagType:v.default[e],grouped:t.skipGrouping?0:1};return y.serializeQuery(n,null,!0)};t.prototype._normalizeTags=function(e){for(var t={},n=[],r=0,i=e;r<i.length;r++){t[f=(a=i[r]).localizedTag||a.tag]?n.push(f):t[f]=!0}if(n.length){for(var s=[],o=0,u=e;o<u.length;o++){var a,f=(a=u[o]).localizedTag||a.tag,l=-1!==n.indexOf(f);(!l||l&&a.localizedTag!==a.tag)&&s.push(a)}return s}return e};t.prototype._clearPlaceholder=function(e){if(e.isPlaceholder){var t=new d.default(e.key);T.utils.extend(t,e);t.isPlaceholder=!1;t.queryType=m.default.AllMyPhotos;t.type=E.default.Folder;this._store.setItem(t)}};return t})(r.default);t.default=N});
define("odsp-next/models/photo/AllPhotosSet",["require","exports","knockout","../itemSet/ItemSetContent","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){this.key=e||"";this.content=n.observable(new r.default);this.content.equalityComparer=i.objectStrictEquality;this.schema=n.observableArray([]);this.schema.equalityComparer=i.arrayStrictEquality;this.context=n.utils.extend({},t);this.isPlaceholder=!0};t.default=s});
define("odsp-next/utilities/regex/Regex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.escapeUserInput=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};return e})();t.default=n});
define("odsp-next/providers/photo/PhotoProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../ProviderHelpers","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/locale/Locale","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/item/ItemType","../../models/item/VirtualItemType","../../dataSources/url/QueryType","../item/ItemProvider","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/dateTime/DateTime","./logging/OnThisDay.event","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b,w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._store=n.resources.consume(f.resourceKey);n._photoDataSource=n.resources.consume(o.photo);n._urlDataSource=n.resources.consume(o.url);n._itemProvider=n.resources.consume(d.resourceKey);n.pages={};n._photoSetIsUpdating={};n._indicesBeingRequested={};n._pendingMetadataRequests={};n._totalChildCount={};n._photoGroupingData={};n._photoKeyToIndexMap={};var r=(function(){if(!b)for(var e=[window.$Config&&window.$Config.mkt,u.default.language,navigator.language,"en"],t=0,n=e;t<n.length;t++){var r=n[t];if(r)try{(new Date).toLocaleDateString(r);b=r;break}catch(e){}}return b})();n._formatDate=function(e){return e.toLocaleDateString(r)};if("Intl"in window&&"object"==typeof window.Intl)try{n._dateFormatter=new Intl.DateTimeFormat(r,{month:"long",day:"numeric"});n._formatDate=n._dateFormatter.format}catch(e){}return n}t.prototype.getAllPhotos=function(e){var t=this,n=this.getAllPhotosSync(e),r=n.content.peek().items;if(e.tagFilter){e.tagFilter=decodeURIComponent(e.tagFilter);n.isPlaceholder&&this.getAllPhotosMetadata(e).done(function(e){t.virtualizeAllPhotosSet(n)})}return this._photoDataSource.getAllPhotos(e).then(function(i){n.isPlaceholder=!1;if(n.isExpired){var s=Math.max(t._getAllPhotosCount(n.key).peek(),0);r=new Array(s)}var o=i.items,u=e.tagFilter?[]:t._mergeGroupings(n,i);t._mergeItemSets(i,n,e,r);n.content({items:r,groupings:u});return o})};t.prototype.determineStartEndRange=function(e,t,n){if(0===n)return{start:0,end:0};if(t.isExpired)return this.determineStartEndRangeForExpiredSet(e);var r=e.startIndex,i=e.endIndex||r+(e.pageSize||200);i=n>0?Math.min(n,i):i;return{start:r=Math.max(0,Math.min(i,r)),end:i}};t.prototype.determineStartEndRangeForExpiredSet=function(e){var t=this.getPhotoSetKey(e),n=e.startIndex;n<0&&(n=0);var r=e.pageSize;if(n<r&&e.endIndex<r)return{start:0,end:r};var i=this.findMonthGroupingByIndex(t,n);if(!i)return{start:0,end:0};r=i.count;return{start:i.startIndex,end:i.startIndex+r}};t.prototype.hasAllItemsInRange=function(e,t,n,r,s){return!s&&!!t.length&&!e.isExpired&&(r<=0||i.resultSetHasData(t,{start:n,end:r}))||!e.isExpired&&this._areAllPhotosInSetBeingRequested(e.key,t,n,r)};t.prototype.getAllPhotosForPage=function(e){var t=this;return y.isFeatureEnabled(y.UseItemsScopeInAllPhotos)?this._getAllPhotosForPagePromise=r.default.wrap(this._getAllPhotosForPagePromise).then(function(){return t.getAllPhotosForPage_original(e)},function(){return t.getAllPhotosForPage_original(e)}):this.getAllPhotosForPage_original(e)};t.prototype.getAllPhotosForPage_original=function(e){var t,n=this,i=this.getAllPhotosSync(e);switch(e.photoType){case 0:case 6:i.isPlaceholder&&(t=this.getAllPhotosMetadata(e))}if(i.isExpired){this._invalidatePhotoSet(i.key);t=this.getAllPhotosMetadata(e)}return r.default.wrap(t).then(function(t){n.virtualizeAllPhotosSet(i);var s=i.content.peek().items;e.endIndex&&e.endIndex>0&&!s[e.endIndex]&&(e.endIndex=e.endIndex+1);var o=n.determineStartEndRange(e,i,s.length),u=o.start,a=o.end,f=!!t&&s.length!==t.items.length&&0!==s.length;if(n.hasAllItemsInRange(i,s,u,a,f))return r.default.wrap(i);if(i.isExpired){var l=Math.max(n._getAllPhotosCount(i.key).peek(),0);s=new Array(l)}var c=[],h=n.getPageForIndex(i.key,u,a),p=n.getPastPageForIndex(i.key,u,a,e.pageSize),d=n.getFuturePageForIndex(i.key,u,a,e.pageSize),m=n.findMonthGroupingByIndex(i.key,u),g=n.determinePagingTypeForContext(u,a,p,d,m,e.pageSize),y=v.deepCopy(e);if(1===g){if(!p.pastPagingToken)return;y.pagingToken=p.pastPagingToken;y.startIndex=p.endIndex;y.endIndex=p.endIndex+e.pageSize}else if(2===g){if(!d.futurePagingToken)return;y.pagingToken=d.futurePagingToken;y.startIndex=d.startIndex-e.pageSize;y.endIndex=d.startIndex;y.ascending=!0}else if(3===g){var b=!0,w=n._getStartDateForMonthGroup(m,b),E=m.count>e.pageSize,S=E?e.pageSize:m.count,x=m.startIndex+m.count;if(e.jumpToStartDate){w=e.jumpToStartDate;var T=e.endIndex-e.startIndex;S=(E=T>e.pageSize)?e.pageSize:T;x=e.endIndex;b=e.ascending}if(!w)return r.default.wrap(i);y.startDate=w;y.startIndex=x-S;y.endIndex=x;y.pageSize=S;y.ascending=b;if(E)for(var N=0,C=c=n.makeBatchedContextsForDateJumping(y,m,S);N<C.length;N++){var k=C[N];n._storePage(null,i,k)}}else if(0===g){y.startIndex=u;y.endIndex=e.pageSize}h=n._storePage(h,i,y);c.unshift(y);var L=function(e){return n._photoDataSource.getAllPhotos(e).then(function(t){i.isPlaceholder=!1;for(var r=e.startIndex;r<e.endIndex;r++){var o=r-e.startIndex,u=t.items[o];u&&(n._photoKeyToIndexMap[u.key]=r)}if(!(h=n.getPageForIndex(i.key,e.startIndex,e.endIndex))){h={startIndex:e.startIndex,endIndex:e.endIndex};n.insertPage(i.key,h)}if(!h.futurePagingToken&&!h.pastPagingToken){h.futurePagingToken=t.futurePagingToken;h.pastPagingToken=t.pastPagingToken}var a=e.tagFilter?[]:n._mergeGroupings(i,t);n._mergeItemSets(t,i,e,s);for(r=e.startIndex;r<=e.endIndex;r++)n._indicesBeingRequested[i.key][r]=!1;if(c&&c.length){var f=e.ascending?c.shift():c.pop();f.pagingToken=e.ascending?t.futurePagingToken:t.pastPagingToken;f.ascending=e.ascending;h=n.getPageForIndex(i.key,f.startIndex,f.endIndex);h=n._storePage(h,i,f);n._photoSetIsUpdating[i.key]=!0;return L(f)}i.isExpired=!1;i.content({items:s,groupings:a});n._photoSetIsUpdating[i.key]=!1;return i},function(e){for(var t=!0,n=0,i=s;n<i.length;n++){var o=i[n];if(o&&o.peek()){t=!1;break}}if(t)return r.default.wrapError(e)})};return 1===c.length?L(c.shift()):r.default.all([L(c.shift()),L(c.pop())])},function(e){})};t.prototype.makeBatchedContextsForDateJumping=function(e,t,n){for(var r=[],i=Math.ceil((t.count-e.pageSize)/e.pageSize),s=1;s<=i;s++){var o=v.deepCopy(e),u=n*s,a=e.startIndex-u;o.startIndex=a<0?0:a;o.endIndex=e.endIndex-u;if(s===i){o.ascending=!1;o.startDate=m.getLastDayOfMonth(this.getDateStringForAllPhotos(new Date(Date.parse(t.data.isoDate)),!0)).toISOString();o.startIndex=t.startIndex;o.pageSize=Math.abs(o.endIndex-o.startIndex)}else{o.ascending=!0;delete o.startDate}r.push(o)}return r};t.prototype.virtualizeAllPhotosSet=function(e){var t=e.content.peek(),n=t.items,r=!1,i=this._getAllPhotosCount(e.key).peek();if(-1!==i)if(n.length<i){for(var s=n.length;s<i;s++)n.push(null);r=!0}else if(n.length>i){var o=n.length-i;n.splice(-1*o);r=!0}r&&e.content({items:n,groupings:t.groupings})};t.prototype.determinePagingTypeForContext=function(e,t,n,r,i,s){var o=0;n&&e<=n.endIndex?o=1:r&&e<r.startIndex?o=2:e<s&&t<=s?o=0:i&&(o=3);return o};t.prototype.getItemSync=function(e){var t=this._photoDataSource.getItemKey(e),n=this._store.getItem(t);if(!n){var r=new l.default(t);r.properties.commandsSupported={defc:"1"};r.queryType=p.default.AllMyPhotos;r.displayType=p.default.AllMyPhotos;r.type=c.default.Folder;if(e.tagFilter){var i=e.tagFilter.split(";"),s=i[0],o=i[1];r.virtualItemType=h.default.Tag;r.name="#"+s;r.tags=[{source:null,type:null,tag:s,localizedTag:o}]}e.locationFilter&&(r.virtualItemType=h.default.Location);if(e.onThisDay){r.folder={childCount:0,photoCount:0,covers:[]};r.ownerId=this._urlDataSource.getOwnerId(t);var u=new Date(Date.parse(e.startDate));r.dateTakenTime=u;r.isAlbum=!0;r.virtualItemType=h.default.Album}e.tagFilter||e.locationFilter||(r.isRootFolder=!0);n=this._store.setItem(r)}return n};t.prototype.getAllPhotosSync=function(e){var t=this.getPhotoSetKey(e),n=this._store.getItemSet(t),r=this.getItemSync(e);if(!n){var i=e.ascending,s=void 0!==i&&i;(n=new a.default(t,e)).content.peek().groupings=[];n.item=r;n.isAscending=s;this._store.setItemSet(t,n)}return n};t.prototype.getAllPhotosMetadata=function(e){var t=this,i=this._photoDataSource.getMetadataContext(e),s=this.getPhotoSetKey(e);if(e.tagFilter&&!y.isFeatureEnabled(y.EnableTagsInODC)){var o={items:[],groupings:[]};this._store.getItemSet(s).content(o);return r.default.resolve(o)}if(this._pendingMetadataRequests[s])return this._pendingMetadataRequests[s];var u=!1,a=this._itemProvider.getItem(i).then(function(e){var r=e.content.peek(),i=t.getPhotoGroupingData(s);t._totalChildCount[s]?t._totalChildCount[s](r.items.length):t._totalChildCount[s]=t.createObservable(r.items.length);var o=t._getGroupingByKey(r.groupings,"Month");i.itemGroup(o.itemGroups);var a=t._store.getItemSet(s),f=r.groupings,l=a.content.peek().groupings||[];if(a&&f){for(var c=!1,h=0,p=f;h<p.length;h++){for(var d=p[h],v=!1,m=0;m<l.length;m++){var g=l[m];if(g&&g.name===d.name){v=!0;if(g!==d){c=!0;l.splice(m,1);break}}}v||(c=!0)}if(c){l.splice.apply(l,n.__spreadArrays([0,0],f));a.content({items:a.content.peek().items,groupings:l})}}t._resolvePhotoSetGroupingData(s);u=!0;delete t._pendingMetadataRequests[s];return r},function(e){t._resolvePhotoSetGroupingData(s);delete t._pendingMetadataRequests[s];u=!0;return r.default.wrapError(e)});u||(this._pendingMetadataRequests[s]=a);return a};t.prototype.getPhotoGroupingData=function(e){this._photoGroupingData[e]||(this._photoGroupingData[e]={hasResolved:this.createObservable(!1),itemGroup:this.observables.createArray([])});return this._photoGroupingData[e]};t.prototype.getOnThisDayPhotos=function(e){var t,n=this,i=this.getAllPhotosSync(e),s=0===e.startIndex;s&&(t=new g.OnThisDay);return i.isPlaceholder||i.isExpired?this.getAllPhotosMetadata(e).then(function(o){for(var u=[],a=new Date(Date.parse(e.startDate)),f=n._getGroupingByKey(o.groupings,"Month"),c=a.getMonth(),h=a.getDate(),p=a.getFullYear(),d=new Date(p,c,h),m=new Date(p,c,h+1),g={},y=0,b=f.itemGroups;y<b.length;y++){var w=b[y],E=new Date(Date.parse(w.data.isoDate));if(!(E.getTime()>m.getTime())){var S=new Date(E.getTime());S.setUTCMonth(E.getUTCMonth()+1);for(;S.getTime()<=d.getTime()||d.getDate()!==h;){p--;d=new Date(p,c,h);m=new Date(p,c,h+1)}E.getTime()<m.getTime()&&S.getTime()>d.getTime()&&(g[d.toISOString()]=m.toISOString())}}for(var x in g)u.push({parentKey:void 0,startDate:x,endDate:g[x],highlights:e.highlights,pageSize:100,ascending:!0,rootItemId:e.rootItemId,startIndex:e.startIndex,endIndex:e.endIndex});return r.default.all(u.map(function(e){return n.getAllPhotos(e)})).then(function(r){var o,a=[].concat.apply([],r),f=[],c=null;if(a.length){c=u.map(function(e){return n.getAllPhotosSync(e)}).filter(function(e){return!!e.content.peek().items.length}).map(function(e){o||(o=new Date(Date.parse(e.context.startDate)));return e.content.peek().groupings[0]}).reduce(function(e,t){return{name:t.name,itemGroups:v.extend(e.itemGroups,t.itemGroups),groupMap:v.extend(e.groupMap,t.groupMap),groups:e.groups.concat(t.groups),groupType:2,itemToGroupMap:v.extend(e.itemToGroupMap,t.itemToGroupMap)}},{name:"",itemGroups:[],groupMap:{},groups:[],groupType:2,itemToGroupMap:{}});var h=0;c.groups=c.groups.map(function(e){e.startIndex=h;h+=e.keys.length;return e});f=a.map(function(e){return n._store.getItem(e.key)})}i.isPlaceholder=!1;i.isExpired=!1;var p=n.getItemSync(e).peek(),d={covers:a.map(function(e){return e.thumbnail}).filter(function(e){return!(!e||!e.url)}),photoCount:a.length},m=o?n._formatDate(o):"";i.item(v.extend(v.extend(new l.default(p.key),p),{childCount:a.length,folder:d,isPlaceholder:!1,name:m}));i.content({items:f,groupings:[c]});s&&t.end({itemsInFirstPage:f.length});return i},function(e){})}):r.default.wrap(i)};t.prototype.getPastPageForIndex=function(e,t,n,r){for(var i=0,s=this.pages[e]||(this.pages[e]=[]);i<s.length;i++){var o=s[i],u=o.endIndex+r,a=t<=o.endIndex&&t>=o.startIndex&&n<=u,f=t>=o.endIndex&&t<=u&&n<u,l=o.startIndex===t&&o.endIndex===n;if((a||f)&&!l)return o}return null};t.prototype.getFuturePageForIndex=function(e,t,n,r){for(var i=0,s=this.pages[e]||(this.pages[e]=[]);i<s.length;i++){var o=s[i],u=o.startIndex-r,a=n>=o.startIndex&&n<=o.endIndex&&t>=u,f=n>=o.startIndex&&n<=u&&t<=u,l=o.startIndex===t&&o.endIndex===n;if((a||f)&&!l)return o}return null};t.prototype.getPageForIndex=function(e,t,n){for(var r=0,i=this.pages[e]||(this.pages[e]=[]);r<i.length;r++){var s=i[r];if(t>=s.startIndex&&n<=s.endIndex)return s}return null};t.prototype.insertPage=function(e,t){for(var n=this.pages[e]||(this.pages[e]=[]),r=0;r<n.length;r++){var i=n[r];if(i.startIndex===t.startIndex&&i.endIndex===t.endIndex)return;if(t.endIndex<i.endIndex||t.endIndex===i.endIndex&&t.startIndex<i.startIndex){n.splice(r,0,t);return}}n.push(t)};t.prototype.findMonthGroupingByIndex=function(e,t){var n=this.getPhotoGroupingData(e),r=this.getPhotoGroupingData(e)&&n.itemGroup.peek();if(!r)return null;for(var i=0,s=r;i<s.length;i++){var o=s[i],u=o.startIndex+o.count;if(t>=o.startIndex&&t<u)return o}return null};t.prototype.getPhotoSetKey=function(e){return this._photoDataSource.getPhotoSetKey(e)};t.prototype.setAllPhotosSettings=function(e){return this._photoDataSource.setAllPhotosSettings(e)};t.prototype.getAllPhotosSettings=function(e){!e&&this._allPhotosSettings||(this._allPhotosSettings=this._photoDataSource.getAllPhotosSettings(e));return this._allPhotosSettings};t.prototype.getDateStringForAllPhotos=function(e,t){var n=new Date(e.getTime());n.setUTCDate(1);n.setUTCHours(0);n.setUTCMinutes(0);n.setUTCSeconds(0);n.setUTCMilliseconds(0);if(!t){var r=n.getUTCMonth();n.setUTCMonth(r+1)}return n};t.prototype._getGroupingByKey=function(e,t){for(var n=null,r=0,i=e;r<i.length;r++){var s=i[r];if(s&&s.name===t){n=s;break}}return n};t.prototype._mergeItemSets=function(e,t,n,r){var i=e.items,s=n.startIndex;if(n.ascending)for(var o=i.length-1;o>=0;o--,s++)r[s]=this._store.getItem(i[o].key);else for(o=0;o<i.length;o++,s++)r[s]=this._store.getItem(i[o].key);var u=this.getPhotoGroupingData(t.key),a=u&&u.itemGroup.peek().length>0,f=!e.futurePagingToken&&!e.pastPagingToken;(!n.locationFilter&&!n.tagFilter||n.pageSize!==i.length||f)&&(a||!u.hasResolved.peek()||f)||r.push(null)};t.prototype._getAllPhotosCount=function(e){var t=this._totalChildCount[e];t||(t=this._totalChildCount[e]=this.createObservable(-1));return t};t.prototype._storePage=function(e,t,n){if(!e){var r=t.key,i=n.startIndex,s=void 0===i?0:i,o=n.endIndex;e={startIndex:s,endIndex:void 0===o?n.pageSize:o};this.insertPage(r,e);var u=this._indicesBeingRequested[r];u||(u=this._indicesBeingRequested[r]={});for(var a=e.startIndex;a<e.endIndex;a++)u[a]=!0}return e};t.prototype._invalidatePhotoSet=function(e){delete this._photoGroupingData[e];delete this.pages[e];this._photoKeyToIndexMap={}};t.prototype._areAllPhotosInSetBeingRequested=function(e,t,n,r){var i=!0;if(!this._indicesBeingRequested[e])return!1;for(var s=n;s<r;s++)if(!this._indicesBeingRequested[e][s]){i=!1;break}return i};t.prototype._resolvePhotoSetGroupingData=function(e){this.getPhotoGroupingData(e).hasResolved(!0)};t.prototype._getStartDateForMonthGroup=function(e,t){var n,r;if(!e)return n;r=e.data.isoDate?new Date(Date.parse(e.data.isoDate)):this._getDateFromString(e.data.monthName,e.data.year);return(n=this.getDateStringForAllPhotos(r,t)).toISOString()};t.prototype._getDateFromString=function(e,t){var n=Date.parse(e+" 1, "+t);return isNaN(n)?null:new Date(n)};t.prototype._mergeGroupings=function(e,t){for(var n=e.content.peek().groupings,r=0,i=t.itemGroupings;r<i.length;r++){for(var s=i[r],o=s.groupType,u=void 0,a=0,f=n;a<f.length;a++){var l=f[a];if(l.groupType===o){u=l;break}}u||n.push(s);this._createMapsFromGroups(u||s,s)}return n};t.prototype._createMapsFromGroups=function(e,t){if(t)for(var n=0,r=t.groups;n<r.length;n++){var i=r[n],s=i.id;if(e.groupMap[s]){for(var o={},u=0,a=e.groupMap[s].keys;u<a.length;u++){o[d=a[u]]=!0}for(var f=0,l=i.keys;f<l.length;f++){o[d=l[f]]=!0}e.groupMap[s].keys=Object.keys(o)}else{e.groupMap[s]=i;e.groups.push(i)}for(var c=void 0,h=0,p=i.keys;h<p.length;h++){var d=p[h];e.itemToGroupMap[d]=s;var v=this._photoKeyToIndexMap[d];(void 0===c||v<c)&&(c=v)}i.startIndex=c}};return t})(s.default);t.default=w});
define("odsp-next/providers/photo/logging/OnThisDay.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OnThisDay=n.createPairedEvent({eventName:"OnThisDay,",shortEventName:"OnThisDay"},{itemsInFirstPage:2});t.default=t.OnThisDay});
define("odsp-next/providers/storageInfo/StorageInfoProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._storageInfoDataSource=n.resources.consume(i.storageInfo);return n}t.prototype.getStorageInfo=function(){return this._storageInfoDataSource.getStorageInfo()};t.prototype.redeemCode=function(e){return this._storageInfoDataSource.redeemCode(e)};t.prototype.sendInvitation=function(e){return this._storageInfoDataSource.sendInvitation(e)};return t})(r.default);t.default=s});
define("odsp-next/providers/storageOptions/StorageOptionsProvider",["require","exports","tslib","../../models/storageOptions/IStorageOptions","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","./StorageOptionsRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._storageOptionsDataSource=n.resources.consume(s.storageOptions);n._storageOptionsRequestor=new(n.managed(o.default));n._storageOptionsRequestor.updateStorageOptions();n.isReady=n.createPureComputed(n._computeIsReady);n.isEligibleForPremium=n.createPureComputed(n._computeIsEligibleForPremium);n.hasOffice=n.createPureComputed(n._computeHasOffice);n._data=n.createPureComputed(function(){return n._storageOptionsRequestor.storageOptionsData()});return n}t.prototype.getStorageOptions=function(){return this._storageOptionsDataSource.getStorageOptions()};t.prototype.getPremiumPurchaseInformation=function(e){var t=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var n=t._parsePremiumPlans(e),r=n[0],i=n[1];return r&&r.pricePerMonth?t._getPurchaseInfo(r,!0,!0):i&&i.pricePerMonth?t._getPurchaseInfo(i,!0,!1):r&&r.pricePerYear?t._getPurchaseInfo(r,!1,!0):i&&i.pricePerYear?t._getPurchaseInfo(i,!1,!1):void 0})};t.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})};t.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var i=n[t];if(r.PlanType[i.type]===r.PlanType.Home||r.PlanType[i.type]===r.PlanType.Personal||r.PlanType[i.type]===r.PlanType.Solo)for(var s=0,o=i.purchaseActions;s<o.length;s++){var u=o[s];if(1===u.durationInMonths||12===u.durationInMonths)return!0}}}return!1})};t.prototype._getPurchaseInfo=function(e,t,n){return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl,planName:e.type,planType:n?r.PlanType.Personal:r.PlanType.Home}};t.prototype._parsePremiumPlans=function(e){var t,n;if(e&&e.officePlans)for(var i=0,s=e.officePlans;i<s.length;i++){var o=s[i];if(r.PlanType[o.type]!==r.PlanType.Trial){for(var u=0,a=o.purchaseActions;u<a.length;u++){var f=a[u];if(1===f.durationInMonths){o.pricePerMonth=f.price;o.secondaryOfficePlanUrl=f.purchaseUrl}if(12===f.durationInMonths){o.pricePerYear=f.price;o.mainOfficePlanUrl=f.purchaseUrl}}r.PlanType[o.type]===r.PlanType.Home?t=o:n=o}}return[n,t]};t.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var i=n[t];if(r.PlanType[i.type]===r.PlanType.Home||r.PlanType[i.type]===r.PlanType.Personal||r.PlanType[i.type]===r.PlanType.Solo)for(var s=0,o=i.purchaseActions;s<o.length;s++){var u=o[s];if(1===u.durationInMonths||12===u.durationInMonths)return!0}}return!1}};t.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan};t.prototype._computeIsReady=function(){return!!this._data()};return t})(i.default);t.default=u});
define("odsp-next/models/storageOptions/IStorageOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Home=1]="Home";e[e.Personal=2]="Personal";e[e.Solo=3]="Solo";e[e.Trial=4]="Trial";e[e.Storage=5]="Storage"})(t.PlanType||(t.PlanType={}))});
define("odsp-next/providers/storageOptions/StorageOptionsRequestor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.storageOptionsData=n.createObservable(null);n._storageOptionsDataSource=n.resources.consume(i.storageOptions);return n}t.prototype.updateStorageOptions=function(e){void 0===e&&(e=!1);if(!e&&this.storageOptionsData.peek())return o.default.wrap(this.storageOptionsData.peek());var t=new s.Qos({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)};t.prototype._storageOptionsHelper=function(e,t){var n=this;if(e<=7)return this._storageOptionsDataSource.getStorageOptions().then(function(r){t.end({resultType:s.ResultTypeEnum.Success,extraData:{retries:e}});n.storageOptionsData(r);return r},function(r){r.data&&159===r.data.code?n.async.setTimeout(function(){n._storageOptionsHelper(e+1,t)},1e3):t.end({resultType:s.ResultTypeEnum.Failure,extraData:{retries:e}})});t.end({resultType:s.ResultTypeEnum.Failure,extraData:{retries:e}})};return t})(r.default);t.default=u});
define("odsp-next/providers/notification/NotificationProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./NotificationProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/notificationManager/NotificationManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./NotificationManager"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/notifications/odc/NotificationsDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./NotificationsDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/application/odc/ApplicationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../url/odc/UrlDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.default.skyApiBaseUrl+"GetApplicationDetails",a=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getApplicationDetails=function(e){var t=this;return(new i.default).send({apiName:"GetApplicationDetails",url:u+"?"+s.serializeQuery({appId:e.clientId}),requestType:"GET"}).then(function(n){return{userId:t._convertClientIdToUserId(e.clientId),email:null,name:n.name,image:n.logoUrl,profilePage:n.appUrl,entityType:3}})};t.prototype._convertClientIdToUserId=function(e){return parseInt(e,16).toString(10)};return t})(r.default);t.default=a});
define("odsp-next/dataSources/storageInfo/odc/StorageInfoDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","../../item/ItemDataSource.resx","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(a.urlDataSource);return t}t.prototype.getStorageInfo=function(){var e=this;return(new s.default).send({apiName:"GetStorageInfo",url:t._storageInfoUrl}).then(function(e){return e},function(t){return r.default.wrapError(e._getError(t.data.code))})};t.prototype.redeemCode=function(e){var n=new s.default,i=JSON.stringify({token:e.token,trackingGuid:e.trackingGuid});return n.sendPost("RedeemQuotaToken",t._redeemCodeUrl,i).then(function(e){return e=e.items||e.item},function(e){return r.default.wrapError(e.data.message)})};t.prototype.sendInvitation=function(e){var n=this,i=new s.default;if(!e)return null;var o=JSON.stringify({recipients:e.map(function(e){return{RecipientType:0,EmailAddress:e}})});return i.sendPost("SendInvitation",t._sendInvitationUrl,o).then(function(e){return e},function(e){return r.default.wrapError(n._getError(e.data.code).errorTitle)})};t.prototype._getError=function(e,t){var n={errorCode:e,errorDetailedText:"",errorTitle:""};switch(e){case 4102:n.errorTitle=u.default.InvalidCodeFailedToRedeem;break;default:n.errorTitle=u.default.DefaultTitle;n.errorDetailedText=u.default.DefaultSubText}return n};t._storageInfoUrl=o.SKY_API_DOMAIN+"/API/2/GetStorageInfo?planDetails=true&quotaForDisabled=true";t._redeemCodeUrl=o.SKY_API_DOMAIN+"/API/2/RedeemQuotaToken";t._sendInvitationUrl=o.SKY_API_DOMAIN+"/API/2/SendInvitation";return t})(i.default);t.default=f});
define("odsp-next/dataSources/storageOptions/odc/StorageOptionsDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._navigation=t.resources.consume(u.navigation);return t}t.prototype.getStorageOptions=function(){var e=new r.default,n=this._navigation.viewParams.ctpMkt,i=this._navigation.viewParams.accountid,s=new o.default(t._storageOptionsUrl);s.setQueryParameter("ctpMkt",n,!1);s.setQueryParameter("accountid",i,!1);return e.send({apiName:"GetUpgradeOptions",url:s.toString()})};t._storageOptionsUrl=i.SKY_API_DOMAIN+"/API/2/GetUpgradeOptions";return t})(s.default);t.default=a});
define("odsp-next/providers/subscriptions/SubscriptionsProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getSubscriptions=function(e,t){return this._getSubscriptionsDataSource().then(function(n){return n.getSubscriptions(e,t)})};t.prototype.updateSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateSubscription(e)})};t.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})};t.prototype.createRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.createRootSubscription(e)})};t.prototype.updateRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateRootSubscription(e)})};t.prototype.deleteRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.deleteRootSubscription(e)})};t.prototype._getSubscriptionsDataSource=function(){var e=this;if(this._subscriptionsDataSource)return r.default.wrap(this._subscriptionsDataSource);if(this.resources.isExposed(s.subscriptions)){this._subscriptionsDataSource=this.resources.consume(s.subscriptions);return r.default.wrap(this._subscriptionsDataSource)}return this.resources.consumeAsync(s.subscriptions).then(function(t){e._subscriptionsDataSource=t;return t})};return t})(i.default);t.default=o});
define("odsp-next/dataSources/subscriptions/vroom/SubscriptionsDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getSubscriptions=function(e,t){var n=this;return e.itemId?this._vroomDataRequestor.send({apiName:t?t+"subscriptions":"subscriptions",path:"/drive/items/"+e.itemId+"/subscriptions"}).then(function(e){return e.value.map(function(e){return n._translateToSubscriptionModel(e)})}):r.default.wrap([])};t.prototype.updateSubscription=function(e){var t=this,n=new Date;n.setMonth(n.getMonth()+1);var r={notificationUrl:"ActivityService://activity",expirationDateTime:n.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:e.apiNamePrefix?e.apiNamePrefix+"subscriptions":"subscriptions",path:"/drives/"+e.item.ownerId+"/items/"+e.item.itemId+"/subscriptions",requestType:"POST",postData:JSON.stringify(r)}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.getRootSubscriptions=function(){var e=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(t){return t.value.map(function(t){return e._translateToSubscriptionModel(t)})})};t.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"deleteSubscription",requestType:"DELETE",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0})};t.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}});return t};t.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{vroomDataRequestor:o.resourceKey});return t})(i.default);t.default=u;t.resourceKey=s.createResolvedResourceKey(e("module").id,u)});
define("odsp-next/providers/thumbnail/ThumbnailProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/base/vroom/VroomDataRequestor"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var r=t.map(o).join(",");return this.resources.consume(i.resourceKey).send({apiName:"thumbnails",path:"/drives/"+e.driveId+"/items/"+e.itemId+"/thumbnails?select="+r+(n?"&authkey="+n:""),needsAuthorization:!n})};t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,999999):this.getThumbnailForSize(e,999999,t)};t.prototype.getThumbnailForSize=function(e,t,n){var r="c"+t+"x"+n;return e.value[0][r]};return t})(r.default);t.default=s;function o(e){return"c"+(e.width||999999)+"x"+(e.height||999999)}});
define("odsp-next/dataSources/instrumentation/odc/InstrumentationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-datasources/lib/Permissions","../../../dataSources/url/PageType","../../../providers/teachingBubble/TeachingBubbleProvider","../../../resources/ControlResourceKeys","../../../dataSources/floodgate/FloodgateDataSource.key","../../../dataSources/identity/odc/IdentityDataSource","../../../dataSources/url/odc/UrlDataSource","../../../dataSources/url/odc/UrlHelpers","../../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../../controls/firstRunExperience/FirstRunExperienceStatus","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(i.navigation);n._identityDataSource=n.resources.consume(l.resourceKey);n._urlDataSource=n.resources.consume(c.resourceKey);n._teachingBubbleProvider=n.resources.consume(u.resourceKey);n._firstRunExperienceStatus=n.resources.consume(p.resourceKey);n._isGuidedTourVisible=n.resources.consume(a.isGuidedTourVisible);return n}t.prototype.getEngagementData=function(e){if(e===o.default[o.default.StorageOptions])return{purchaseSource:this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"]}};t.prototype.userExecuteAction=function(e){var t=this;if(v.isFeatureEnabled(v.EnableFloodgate)&&e){var n=e.name;this.resources.consumeAsync(f.resourceKey).then(function(e){0===n.indexOf("Upload")&&(n="Upload");if(t._identityDataSource.getIdentity().type!==s.IdentityType.anonymous){"NewSession"===n&&t._isValidNpsSurveyContext()&&e.recordUserAction("NewNpsSession");t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction");"Navigation"===n&&h.isAllMyPhotos(t._navigation.viewParams)&&e.recordUserAction("EnteredAllPhotosView")}e.recordUserAction(n)})}};t.prototype.userSeeItem=function(e){};t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSource.getPageType(),t=e===o.default.Files||e===o.default.Photos;return!this._teachingBubbleProvider.currentBubble.peek()&&this._firstRunExperienceStatus.peek()!==d.FirstRunExperienceStatus.visible&&!this._isGuidedTourVisible.peek()&&t};t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||/Create[a-zA-Z]+DocumentAction/.test(e)};return t})(r.default);t.default=m});
define("odsp-next/dataSources/floodgate/FloodgateDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./FloodgateDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/firstRunExperience/FirstRunExperienceStatus.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","./FirstRunExperienceStatus"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".FirstRunExperienceStatus",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(i.FirstRunExperienceStatus.notConfigured),disposable:t}}}})});
define("odsp-next/controls/firstRunExperience/FirstRunExperienceStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(t.FirstRunExperienceStatus||(t.FirstRunExperienceStatus={}))});
define("odsp-next/dataSources/encoding/odc/EncodingDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.prototype.getEncoding=function(){return"undefined"!=typeof FilesConfig&&FilesConfig&&FilesConfig.defaultCodePage?FilesConfig.defaultCodePage:null};return e})();t.default=n});
define("odsp-next/dataSources/videoItem/odc/VideoItemDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VideoItemDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/upsell/odc/UpsellDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getUpsellFromOneRm=function(e){var t=new s.default,n=new o.Qos({name:this.getMarketingRequestApiId()}),r={url:e,apiName:"OneRM",returnRawXHR:!0,useDefaultHeaders:!0};return t.send(r).then(function(e){var t;try{t=e&&e.response&&JSON.parse(e.response)}catch(e){}t?2===t.ContentType?n.end({resultType:u.ResultTypeEnum.ExpectedFailure}):0===t.ContentType?n.end({resultType:u.ResultTypeEnum.Success}):n.end({resultType:u.ResultTypeEnum.Failure}):n.end({resultType:u.ResultTypeEnum.Failure});return t},function(e){n.end({resultType:u.ResultTypeEnum.Failure});return i.default.wrapError(e)})};t.prototype.getMarketingRequestApiId=function(){return"SkyDriveWeb_Internal_Control_FirstRunView_MarketingRequest"};return t})(r.default);t.default=a});
define("odsp-next/providers/upsell/UpsellProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._upsellDataSource=n.resources.consume(i.upsell);return n}t.prototype.getUpsellFromOneRm=function(e){return this._upsellDataSource.getUpsellFromOneRm(e)};t.prototype.getMarketingRequestApiId=function(){return this._upsellDataSource.getMarketingRequestApiId()};return t})(r.default);t.default=s});
define("odsp-next/actions/odc/ActionMap",["require","exports","tslib","../BaseActionMap","./ExternalNavigateAction","../OpenInDesktopAction","./AddCoverPhotoAction","../addToAlbum/odc/AddToAlbumAction","../addToFolder/odc/AddToFolderAction","../ChangeFolderTypeAction","../ClearSelectionAction","./CreateDocumentAction","../createFolder/odc/CreateFolderAction","./CreateMountPointAction","./DefaultClickAction","../delete/odc/DeleteAction","../download/odc/DownloadAction","../editTags/odc/EditTagsAction","../editTags/odc/ShowTagsEditorAction","../embed/odc/EmbedAction","../emptyRecycleBin/odc/EmptyRecycleBinAction","../feedback/odc/FeedbackAction","../LanguagePickerAction","../navigateToItem/NavigateToItemAction","../NavigationAction","../sort/od/OneDriveSortAction","./OpenAction","../preview/PreviewAction","./OpenInOfficeClientAction","../OpenPdfInBrowserAction","./OpenInOfficeOnlineAction","../openInTextEditor/OpenInTextEditorAction","../orderPrints/odc/OrderPrintsAction","./PlayAudioAction","./PlaySlideShowAction","./StopSlideShowAction","./RemoveCoverPhotoAction","../RemoveFromRecentAction","./RemoveTagAction","../rename/odc/RenameAction","../restore/RestoreAction","../restoreAll/odc/RestoreAllAction","../rotate/RotateAction","./SaveSortOrderAction","../SetFocusAction","../shareByLink/odc/ShareByLinkAction","../showKeyboardMap/ShowKeyboardMapAction","../showOperations/ShowOperationsAction","../showPermissions/ShowPermissionsAction","../showSuggestedFiles/ShowSuggestedFilesAction","../ShowPropertiesAction","../ShowSelectionAction","../sort/SortAction","../toggleListLayout/odc/ToggleListLayoutAction","../viewOriginal/ViewOriginalAction","./UploadAction","./UpdateCaptionAction","./SurveyAction","./AddToSharedListAction","../removeFromSharedList/odc/RemoveFromSharedListAction","../addToBundle/odc/AddToBundleAction","./RemoveFromBundleAction","../reportAbuse/odc/ReportAbuseAction","./RemoveMountPointAction","../requestReview/odc/RequestReviewAction","./ViewInFolderAction","./SignOutAction","../ToggleDebugWindowAction","../RemoveFromAlbumAction","../addPhotosToAlbum/AddPhotosToAlbumAction","../createAlbum/CreateAlbumAction","../SelectAction","../SelectAllAction","../FilterSearchAction","../RemoveTagFromItemAction","../setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction","../setPhotosRoot/odc/SetPhotosRootAction","../FilterSearchByDateAction","../launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction","./AutoExecuteAction","../toggleSelectionMode/ToggleSelectionModeAction","../redeemCode/odc/RedeemCodeAction","../save/odc/SaveAction","../redeem/odc/RedeemAction","../switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction","../createAlbumFromFolder/odc/CreateAlbumFromFolderAction","./VersionHistoryAction","./RearrangeAction","../applyOfficeLens/odc/ApplyOfficeLensAction","../removeOfficeLens/odc/RemoveOfficeLensAction","../base/OverrideAction","../printPdf/odc/PrintPdfAction","../saveAutoAlbum/odc/SaveAutoAlbumAction","../discardAutoAlbum/odc/DiscardAutoAlbumAction","../saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction","../vault/odc/VaultAction","../showShareMultiItem/ShowShareMultiItemAction","../DeferredAction","@ms/odsp-utilities/lib/modules/ModuleHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se,xe,Te,Ne,Ce,ke,Le,Ae,Oe,Me,_e,De,Pe,He,Be,je,Fe,Ie,qe,Re,Ue,ze,We){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function Xe(e,t){return ze.create(e,function(){return t().then(We.getDefaultExport)})}var Ve=(function(t){n.__extends(r,t);function r(){var n=t.call(this)||this,r=Xe("../quotaBlock/odc/QuotaBlockAction",function(){return new Promise(function(t,n){e(["../quotaBlock/odc/QuotaBlockAction"],t,n)})});n.ExternalNavigateAction=i.default;n.OpenInDesktopAction=s.default;n.AddCoverPhotoAction=o.default;n.AddPhotosToAlbumAction=ve.default;n.AddToAlbumAction=u.default;n.AddToBundleAction=oe.default;n.AddToFolderAction=a.default;n.AddToSharedListAction=ie.default;n.ApplyOfficeLensAction=Pe.default;n.AutoExecuteAction=Ne.default;n.ChangeFolderTypeAction=f.default;n.ClearSelectionAction=l.default;n.CreateAlbumAction=me.default;n.CreateAlbumFromFolderAction=Me.default;n.CreateDocumentAction=Be.default.create(c.default,r);n.CreateFolderAction=h.default;n.CreateNewFolderAction=Xe("../createNewFolder/odc/CreateNewFolderAction",function(){return new Promise(function(t,n){e(["../createNewFolder/odc/CreateNewFolderAction"],t,n)})});n.CreateMountPointAction=p.default;n.DefaultClickAction=d.default;n.DeleteAction=v.default;n.DiscardAutoAlbumAction=Ie.default;n.DownloadAction=m.default;n.DownloadZipContentsAction=Xe("../downloadZipContents/odc/DownloadZipContentsAction",function(){return new Promise(function(t,n){e(["../downloadZipContents/odc/DownloadZipContentsAction"],t,n)})});n.EditTagsAction=g.default;n.ShowTagsEditorAction=y.default;n.EmbedAction=b.default;n.EmptyRecycleBinAction=w.default;n.FeedbackAction=E.default;n.FilterSearchAction=be.default;n.FilterSearchByDateAction=xe.default;n.ImplicitSaveAutoAlbumAction=qe.default;n.LanguagePickerAction=S.default;n.LaunchMoveCopyPanelAction=Te.default;n.MoveCopyAction=Xe("../moveCopy/odc/MoveCopyAction",function(){return new Promise(function(t,n){e(["../moveCopy/odc/MoveCopyAction"],t,n)})});n.NavigateToItemAction=x.default;n.NavigationAction=T.default;n.OneDriveSortAction=N.default;n.OpenAction=C.default;n.PreviewAction=k.default;n.OpenInOfficeClientAction=L.default;n.OpenPdfInBrowserAction=A.default;n.OpenInOfficeOnlineAction=Be.default.create(O.default,r);n.OpenInTextEditorAction=M.default;n.OrderPrintsAction=_.default;n.PlayAudioAction=D.default;n.PlaySlideShowAction=P.default;n.PrintPdfAction=je.default;n.RearrangeAction=De.default;n.RedeemAction=Ae.default;n.RedeemCodeAction=ke.default;n.RemoveCoverPhotoAction=B.default;n.RemoveFromAlbumAction=de.default;n.RemoveFromBundleAction=ue.default;n.RemoveFromRecentAction=j.default;n.RemoveFromSharedListAction=se.default;n.RemoveMountPointAction=fe.default;n.RemoveOfficeLensAction=He.default;n.RemoveTagAction=F.default;n.RemoveTagFromItemAction=we.default;n.RenameAction=I.default;n.ReportAbuseAction=ae.default;n.RequestReviewAction=le.default;n.RestoreAction=q.default;n.RestoreAllAction=R.default;n.RotateAction=U.default;n.SaveAction=Le.default;n.SaveAutoAlbumAction=Fe.default;n.SaveSortOrderAction=z.default;n.SelectAction=ge.default;n.SelectAllAction=ye.default;n.SetAlbumCoverPhotoAction=Ee.default;n.SetFocusAction=W.default;n.SetPhotosRootAction=Se.default;n.ShareByLinkAction=X.default;n.ShowKeyboardMapAction=V.default;n.ShowOperationsAction=$.default;n.ShowPermissionsAction=J.default;n.ShowSuggestedFilesAction=K.default;n.ShowPropertiesAction=Q.default;n.ShowSelectionAction=G.default;n.ShowVersionHistoryAction=_e.default;n.SignOutAction=he.default;n.SortAction=Y.default;n.StopSlideShowAction=H.default;n.SurveyAction=re.default;n.SwitchPhotoFolderLayoutTypeAction=Oe.default;n.ToggleDebugWindowAction=pe.default;n.ToggleListLayoutAction=Z.default;n.ToggleSelectionModeAction=Ce.default;n.UpdateCaptionAction=ne.default;n.UploadAction=Be.default.create(te.default,r);n.QuotaBlockAction=r;n.VaultAction=Re.default;n.ViewInFolderAction=ce.default;n.ViewOriginalAction=ee.default;n.ShowShareMultiItemAction=Ue.default;return n}return r})(r.default);t.default=Ve});
define("odsp-next/actions/BaseActionMap",["require","exports","./UnsupportedAction"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.AddCoverPhotoAction=n.default;this.AddExistingAppViewAction=n.default;this.AddFlowAction=n.default;this.AddPhotosToAlbumAction=n.default;this.AddToAlbumAction=n.default;this.AddToBundleAction=n.default;this.AddToFolderAction=n.default;this.AddToFolderAction=n.default;this.AddToQuickLaunchAction=n.default;this.AddToSharedListAction=n.default;this.AddToSpotlightAction=n.default;this.AlertAction=n.default;this.ApplyOfficeLensAction=n.default;this.ApproveRejectAction=n.default;this.AuthenticationPolicyWarningAction=n.default;this.AutoExecuteAction=n.default;this.CancelEditAction=n.default;this.ChangeAppViewVisibilityAction=n.default;this.ChangeFolderTypeAction=n.default;this.CheckInAction=n.default;this.CheckOutAction=n.default;this.ClearFilterAction=n.default;this.ClearSelectionAction=n.default;this.ComplianceDetailsAction=n.default;this.ContentTypeNavigationAction=n.default;this.LaunchConfigureFlowsPanelAction=n.default;this.CopyFieldAction=n.default;this.CopyFormAction=n.default;this.CreateAlbumAction=n.default;this.CreateAlbumFromFolderAction=n.default;this.CreateAppViewAction=n.default;this.CreateColumnAction=n.default;this.CreateCustomDocumentAction=n.default;this.CreateDocumentAction=n.default;this.CreateFileRequestAction=n.default;this.CreateFolderAction=n.default;this.CreateItemAction=n.default;this.CreateMountPointAction=n.default;this.CreateNewFolderAction=n.default;this.CreateSitePageAction=n.default;this.CustomActionNavigationAction=n.default;this.CustomizeClientFormAction=n.default;this.CustomizeFormsNavigationAction=n.default;this.CustomizeViewAction=n.default;this.DefaultClickAction=n.default;this.DeleteAction=n.default;this.DeleteTemplateAction=n.default;this.DeleteAppAction=n.default;this.DeleteViewAction=n.default;this.DiscardAutoAlbumAction=n.default;this.DownloadAction=n.default;this.DownloadZipContentsAction=n.default;this.EditAction=n.default;this.EditItemAction=n.default;this.EditItemCancelAction=n.default;this.EditItemSaveAction=n.default;this.EditNewAppViewAction=n.default;this.EditNewMenuAction=n.default;this.EditNewMenuPaneAction=n.default;this.EditRenditionsAction=n.default;this.EditTagsAction=n.default;this.EmbedAction=n.default;this.EmptyRecycleBinAction=n.default;this.ExportListAction=n.default;this.ExternalNavigateAction=n.default;this.FeedbackAction=n.default;this.FileHandlerOpenAction=n.default;this.FilterAction=n.default;this.FilterSearchAction=n.default;this.FilterSearchByDateAction=n.default;this.GetLinkAction=n.default;this.GroupItemsAction=n.default;this.ImplicitSaveAutoAlbumAction=n.default;this.InvokeFirstRunExperienceAction=n.default;this.LanguagePickerAction=n.default;this.LaunchChangeTheLookPanelAction=n.default;this.LaunchColumnCustomizationPaneAction=n.default;this.LaunchColumnManagementPanelAction=n.default;this.LaunchCreateAppViewPanelAction=n.default;this.LaunchCreateGroupPanelAction=n.default;this.LaunchCreateListDialog=n.default;this.LaunchCreateShortcutPanel=n.default;this.LaunchFilterPanelAction=n.default;this.LaunchFlowWidgetPanelAction=n.default;this.LaunchFormatViewPaneAction=n.default;this.LaunchGroupifyPanelAction=n.default;this.LaunchGroupMembershipPanelAction=n.default;this.LaunchListCreationPanelAction=n.default;this.LaunchListFormAction=n.default;this.LaunchMoveCopyPanelAction=n.default;this.LaunchSitePermissionsPanelAction=n.default;this.LaunchSiteSettingsPanelAction=n.default;this.LaunchUserExpirationPanelAction=n.default;this.ListFormActivityPaneToggleAction=n.default;this.MakeHomepageAction=n.default;this.VaultAction=n.default;this.ModifyColumnAction=n.default;this.ModifyShowInFiltersPaneAction=n.default;this.MoveCopyAction=n.default;this.MoveLeftSpotlightAction=n.default;this.MoveRightSpotlightAction=n.default;this.NavigateToItemAction=n.default;this.NavigateToSharePointHomeAction=n.default;this.NavigationAction=n.default;this.OneDriveSortAction=n.default;this.OpenAction=n.default;this.OpenChatAction=n.default;this.OpenAppAction=n.default;this.OpenHyperlinkAction=n.default;this.OpenInExplorerAction=n.default;this.OpenInfoPathAction=n.default;this.OpenInOfficeClientAction=n.default;this.OpenInOfficeOnlineAction=n.default;this.OpenInSharePointAction=n.default;this.OpenInDesktopAction=n.default;this.OpenInTextEditorAction=n.default;this.OpenNeedsAttentionViewAction=n.default;this.OpenPdfInBrowserAction=n.default;this.OpenInPowerBIAction=n.default;this.OpenShortcutAction=n.default;this.OpenSiteAction=n.default;this.OrderPrintsAction=n.default;this.PinToMruAction=n.default;this.PlayAudioAction=n.default;this.PlaySlideShowAction=n.default;this.PolicyTipAction=n.default;this.PreviewAction=n.default;this.PrintPdfAction=n.default;this.PublishAction=n.default;this.RearrangeAction=n.default;this.RedeemAction=n.default;this.RedeemCodeAction=n.default;this.RemoveCoverPhotoAction=n.default;this.RemoveFromAlbumAction=n.default;this.RemoveFromBundleAction=n.default;this.RemoveFromRecentAction=n.default;this.RemoveFromSharedListAction=n.default;this.RemoveFromSpotlightAction=n.default;this.RemoveMountPointAction=n.default;this.RemoveOfficeLensAction=n.default;this.RemoveTagAction=n.default;this.RemoveTagFromItemAction=n.default;this.RenameAction=n.default;this.RenameColumnAction=n.default;this.ReportAbuseAction=n.default;this.RequestReviewAction=n.default;this.RestoreAction=n.default;this.RestoreAllAction=n.default;this.RestoreFilesAction=n.default;this.RotateAction=n.default;this.SaveAction=n.default;this.SaveAutoAlbumAction=n.default;this.SaveSortOrderAction=n.default;this.SaveViewAction=n.default;this.SeeAllAppsAction=n.default;this.SelectAction=n.default;this.SelectAllAction=n.default;this.SetAlbumCoverPhotoAction=n.default;this.SetDefaultViewAction=n.default;this.SetFocusAction=n.default;this.SetPhotosRootAction=n.default;this.SetUpApprovalFlowAction=n.default;this.SetUpReminderFlowAction=n.default;this.ShareAction=n.default;this.ShareByLinkAction=n.default;this.ShowExistingFlowsAction=n.default;this.ShowFiltersAction=n.default;this.ShowItemAnalyticsAction=n.default;this.ShowSuggestedFilesAction=n.default;this.ShowKeyPointsAction=n.default;this.ShowKeyboardMapAction=n.default;this.ShowMalwareDetectedAction=n.default;this.ShowOperationsAction=n.default;this.ShowPermissionsAction=n.default;this.ShowPropertiesAction=n.default;this.ShowRunReportAction=n.default;this.ShowSelectionAction=n.default;this.ShowVersionHistoryAction=n.default;this.SignOutAction=n.default;this.StopSlideShowAction=n.default;this.SurveyAction=n.default;this.SwitchPhotoFolderLayoutTypeAction=n.default;this.SwitchSharingLinkAction=n.default;this.SwitchViewAction=n.default;this.SyncAction=n.default;this.SynchronizeAppViewAction=n.default;this.LaunchTeamChannelAction=n.default;this.ToggleAction=n.default;this.ToggleDebugWindowAction=n.default;this.ToggleListLayoutAction=n.default;this.ToggleSelectionModeAction=n.default;this.TriggerFlowAction=n.default;this.TriggerFlowByIdAction=n.default;this.TriggerODBConvertToPdfFlowAction=n.default;this.TriggerODBRequestSignOffFlowAction=n.default;this.TriggerSignoffFlowAction=n.default;this.UndoCheckOutAction=n.default;this.UnPublishAction=n.default;this.UpdateCaptionAction=n.default;this.UpdatePermissionsAction=n.default;this.UploadAction=n.default;this.UploadTemplateAction=n.default;this.QuotaBlockAction=n.default;this.ViewInFolderAction=n.default;this.ViewItemAction=n.default;this.ViewOriginalAction=n.default;this.WorkflowAction=n.default};t.default=r});
define("odsp-next/actions/UnsupportedAction",["require","exports","tslib","../base/BaseAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="Unsupported";return t}t.prototype.onIsAvailable=function(){return!1};return t})(r.default);t.default=i});
define("odsp-next/actions/odc/ExternalNavigateAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/BaseAction","../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ExternalNavigate";n._item=t.item;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank"),i=this._item.peek();return this.resources.consumeAsync(s.urlDataSource).then(function(e){var s=void 0;if(s=t._isOfficeItem()&&i.openUrl?i.openUrl:e.getItemUrl(i.key,{item:i})){n.location.href=s;return{resultType:r.ResultTypeEnum.Success}}n.close();return{resultType:r.ResultTypeEnum.Failure}})};t.prototype._isOfficeItem=function(){var e=this._item.peek(),t=e.extension&&e.extension.replace(/^\./,"");return t&&o.OfficeIconFileTypeMap[t]&&".pdf"!==e.extension};return t})(i.default);t.default=u});
define("odsp-next/actions/OpenInDesktopAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./base/ItemSelectionHelper","../resources/DataSourceResourceKeys","../models/item/ItemType","@ms/odsp-datasources/lib/interfaces/item/UrlType","../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;(function(e){e[e.DefaultClick=0]="DefaultClick";e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline";e[e.OpenFileLocation=2]="OpenFileLocation";e[e.OpenItemActivityItem=3]="OpenItemActivityItem";e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"})(c=t.DesktopActionType||(t.DesktopActionType={}));var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item,i=t.openRelation,s=void 0===i?0:i,a=t.actionType;n.name="OpenInDesktop";n._itemSelectionHelper=new(n.child(o.typeResourceKey))({overrideItem:2===s?r:void 0,allowMultiSelect:!1,canFallback:0!==s,ignoreSelection:0!==s});n._urlDataSource=n.resources.consume(u.url);n._actionType=a;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),r={id:n.id,name:n.name,actionType:c[this._actionType],queryType:l.default[n.queryType],itemType:a.default[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[f.default.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};window.external.notify(JSON.stringify(r));return i.default.wrap({resultType:s.ResultTypeEnum.Success})};return t})(r.default);t.default=h});
define("odsp-next/actions/base/ItemSelectionHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/resources/Resources","../../models/item/OneDriveItem"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,u=i.resources,f=i.observables,l=n.getCurrentItem,c=void 0===l?u.consume(s.currentItem.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?u.consume(s.itemsSelection.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?u.consume(o.resourceKey.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new a.default);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=f.pureCompute(r._computeSelection);r.firstItem=f.pureCompute(r._computeFirstItem);r.currentItem=f.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return r.default.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return r.default.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():r.default.reject(new Error("Unable to resolve selection."))};return t})(i.default);t.ItemSelectionHelper=f;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,f,n.__assign(n.__assign({},i.default.dependencies),{currentItem:s.currentItem.lazy.optional,itemSetSelectionModel:s.itemsSelection.lazy.optional,selectionHelper:o.resourceKey.lazy.optional}));t.default=f});
define("odsp-next/utilities/selection/SelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../controls/commands/Commands.resx","./SelectionHelper.resx","../../utilities/icons/Icon","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(a.default.resolveDescription),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(a.default.resolveError);r(!1);i(!0)}return o.default.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=o.default.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:a.default.resolveTitle,isDismissable:!1,component:{name:s.default.tagName,params:{text:e}},actions:[{name:u.default.cancelActionText,execute:function(){return o.default.wrap(3)},isVisible:t,icon:new f.default("Cancel"),isDefault:!0},{name:u.default.ok,execute:function(){return o.default.wrap(3)},isVisible:n,icon:new f.default("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{dialogProvider:i.resourceKey,promiseTracker:l.promiseTracker.optional,itemSetSelectionModel:l.itemsSelection});return t})(r.default);t.default=p;t.getSelectedItemApp=function(e){var t=e.selection();if(1===t.length){var n=c.unwrap(t[0]);return n.appMap?n.appMap:"nonOfficeApp"}};t.resourceKey=h.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/actions/odc/AddCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../../dataSources/url/QueryType","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../base/ItemSelectionHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddCoverPhotoAction";r._itemReedemer=r.resources.consume(s.resourceKey);r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._itemSelectionHelper.currentItem();return t.queryType!==o.default.Search&&t.queryType!==o.default.SharedWithMe&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,c.addAsCoverPhoto)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t.resources.consume(f.resourceKey),r=e[0].parent;return n.addCoverPhotos({items:e,target:r}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(a.default);t.default=h});
define("odsp-next/actions/base/ItemRedeemer",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};e.prototype.redeemItems=function(e,t,i){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||i?n.default.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:r.ResultTypeEnum.Success}}):n.default.resolve({resultType:r.ResultTypeEnum.Success})};return e})();t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o,{ticketRedeemer:s.ticketRedeemer.async.optional})});
define("odsp-next/actions/base/ItemCommandHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/itemCommand/ItemCommandProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,s=n.itemCommandProvider,o=void 0===s?r.resources.consume(i.resourceKey):s;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemCommandProvider:i.resourceKey});return t})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/providers/itemCommand/ItemCommandProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemCommandDataSource:i.itemCommand});return t})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/models/item/command/CustomizationItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromRecent=new n.default("removeFromRecent");t.rearrange=new n.default("rearrange");t.addAsCoverPhoto=new n.default("addCoverPhoto");t.removeAsCoverPhoto=new n.default("removeCoverPhoto")});
define("odsp-next/models/item/command/ItemCommandKey",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.default=n});
define("odsp-next/actions/addToAlbum/odc/AddToAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/DataSourceResourceKeys","../../../providers/panel/PanelProvider","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToAlbum";n._panelProvider=n.resources.consume(o.resourceKey);n._urlDataSource=n.resources.consume(s.url);return n}i.prototype.getExecutorPath=function(){return"./AddToAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./AddToAlbumExecutor"],t,n)}))}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,u.addToAlbum)};return i})(i.default);t.default=a});
define("odsp-next/actions/base/templates/ExecutorAction",["require","exports","tslib","../ExecutorLoader","./SelectionAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._loader=new(n.managed(r.default))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return n.selectionHelper.resolveSelection().then(function(e){return n.getExecutorParameters({selection:e})})}});return n}t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return t})(i.default);t.default=s});
define("odsp-next/actions/base/templates/SelectionAction",["require","exports","tslib","../../../base/BaseAction","../ItemCommandHelper","../ItemSelectionHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this;r.itemCommandHelper=new(r.managed(i.default));r.selectionHelper=new(r.child(s.typeResourceKey))(n.__assign(n.__assign({},r.getSelectionOptions()),{overrideItem:t.item}));return r}t.prototype.getSelectionOptions=function(){return{}};return t})(r.default);t.default=o});
define("odsp-next/providers/panel/PanelProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../models/panel/Panel","../../controls/overlayContent/NeedsOverlayContent.key"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent(!0);var t=new s.default(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{needsOverlayContent:o.resourceKey});return t})(r.default);t.default=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u)});
define("odsp-next/models/panel/Panel",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){var t=this,i=e.noTitle,s=void 0!==i&&i,o=e.title,u=void 0===o?r.observable(""):o,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?r.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M;this.size=p;this.title=r.isObservable(u)?u:r.observable(u);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=s;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.disableEscape=_;this.state=r.observable(0);this._promise=new n.default(function(e){var n=r.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})();t.default=i});
define("odsp-next/models/item/command/PhotoItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.play=new n.default("play");t.rotate=new n.default("rotate");t.editCaption=new n.default("editCaption");t.editTags=new n.default("editTags");t.removeTags=new n.default("removeTags");t.viewOriginal=new n.default("viewOriginal");t.applyOfficeLens=new n.default("applyOfficeLens");t.removeOfficeLens=new n.default("removeOfficeLens");t.addToAlbum=new n.default("addToAlbum");t.removeFromAlbum=new n.default("removeFromAlbum");t.addPhotosToAlbum=new n.default("addPhotosToAlbum")});
define("odsp-next/actions/addToFolder/odc/AddToFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/ItemParentHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToFolderAction";n._itemParentHelper=n.resources.consume(s.resourceKey);return n}i.prototype.getExecutorPath=function(){return"./AddToFolderExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./AddToFolderExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault","root"));return!!t&&!t.vault.isLocked};return i})(i.default);t.default=o});
define("odsp-next/models/item/ItemParentHelper",["require","exports","../store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){return this.getAncestorOrSelf(e,function(t){return t.key===e.parentKey})};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n;e;){var r=this._itemsStore.getItem(e.key),i=r&&r.peek();if(!i)break;if(t(i)){n=r;break}e=e.parent}return n};e.dependencies={itemsStore:n.resourceKey};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i)});
define("odsp-next/actions/ChangeFolderTypeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-datasources/lib/utilities/permissions/Identity","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/icons/Icon","../controls/infoPane/InfoPane.resx","../base/BaseAction","../controls/folderTypeEditor/FolderTypeEditor","../resources/DataSourceResourceKeys","../providers/item/ItemProvider","../providers/dialog/DialogProvider","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ChangeFolderType";r._itemProvider=r.resources.consume(c.resourceKey);r._urlDataSource=r.resources.consume(l.url);r._identityDataSource=r.resources.consume(l.identity);r._itemSelectionHelper=new(r.child(p.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!e||!t||void 0===e.queryType||t.type===i.IdentityType.anonymous||void 0===e.category||this._urlDataSource.isRecycleBin(e.queryType))};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t,i,a,l=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];t=e.category;i=this.observables.create(t);a=this.resources.consume(h.resourceKey);return[2,a.requestDialog({title:u.default.informationChangeFolderTitle,component:{name:f.default.tagName,params:{category:i}},actions:[{name:u.default.informationSave,execute:function(){return r.default.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==i()}),isDefault:!0,icon:new o.default("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return l._itemProvider.changeFolderType({category:i(),item:e}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})]}})})};return t})(a.default);t.ChangeFolderTypeAction=d;t.default=d});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditor",["require","exports","./FolderTypeEditor.html","./FolderTypeEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-folder-type-editor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="FolderTypeEditor"><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input class="ms-RadioButton-input" type="radio" name="folderType" id="folderTypeDocuments" data-bind="attr:{value:typeDocuments},checked:categoryText"><label for="folderTypeDocuments" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypeDocuments"></span></label></div></div><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input type="radio" name="folderType" id="folderTypePhotos" value="photos" data-bind="attr:{value:typePhotos},checked:categoryText" class="ms-RadioButton-input"><label for="folderTypePhotos" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypePhotos"></span></label></div></div></div>'});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../infoPane/InfoPane.resx","../../models/item/FolderCategory","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.infoPaneResx=i.default;n.category=t.category;n.typeDocuments=s.default[s.default.documents];n.typePhotos=s.default[s.default.photos];n.categoryText=o.observable(s.default[n.category()]);n.subscribe(n.categoryText,function(){n.category(s.default[n.categoryText()])});return n}return t})(r.default);t.default=u});
define("odsp-next/models/item/FolderCategory",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"})(n||(n={}));t.default=n});
define("odsp-next/actions/ClearSelectionAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ClearSelection";var i=r.resources;r._urlDataSource=i.consume(o.url);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper,t=this._urlDataSource,n=t.getKeyParams(e.currentItem().key),r=t.getQueryType(n);return e.selection().length>0&&!t.isRecycleBin(r)};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();return i.default.resolve({resultType:s.ResultTypeEnum.Success})};return t})(r.default);t.default=a});
define("odsp-next/actions/odc/CreateDocumentAction",["require","exports","tslib","../CreateDocumentAction","cookies","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/odsp-utilities/lib/async/Promise","../../resources/ODCResourceKeys","../../controls/createDocumentForm/CreateDocumentForm","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./SkyApiHelper","../../dataSources/url/odc/UrlDataSource","../../dataSources/identity/odc/IdentityDataSource","../../providers/hiddenDom/HiddenDomProvider","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","../../models/item/command/WebItemCommandKeys","../base/ItemRedeemer","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../utilities/features/Features","../../providers/operation/OperationProvider","../../dataSources/createDocument/odc/CreateDocumentDataSource","./CreateDocumentAction.resx","../../controls/commands/Commands.resx","../../models/operation/OperationError","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-utilities/lib/icons/IconSelector","../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.c_pathLimitError="folderPathLimitExceeded";n.c_accessDeniedError="accessDenied";n.c_pathLengthErrorLearnMoreLink="https://support.office.com/article/0b10108f-8459-4a7a-b912-28f8adec5a81";n._identityDataSource=n.resources.consume(p.resourceKey);n._itemDataSource=n.resources.consume(u.itemDataSource);n._hiddenDomProvider=n.resources.consume(d.resourceKey);n._createDocumentDataSource=n.resources.consume(x.resourceKey);n._forceRedeem=!n.resources.consume(w.userInfo).isAuthenticated();n._operationProvider=n.resources.consume(S.resourceKey);n._itemCommandHelper=new(n.managed(v.default));n._itemReedemer=n.resources.consume(y.resourceKey);n.askForFileName=!!t.autoInvokedItem;t.autoInvokedItem&&t.docType===s.DocumentType.Text&&(n.redirect=!1);n._itemCommandKey=n._getItemCommandKey(n.docType);n._didUserUploadOrCreateFile=n.resources.consume(b.didUserUploadOrCreateFile.optional);n.docType===s.DocumentType.ExcelSurvey&&E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)&&(n.name="CreateFormsSurveyDocumentAction");E.isFeatureEnabled(E.CreateDocumentToVroom)&&(n._vroomDocTypes=[s.DocumentType.Word,s.DocumentType.Excel,s.DocumentType.PowerPoint]);return n}t.prototype.onIsAvailable=function(){var t=this.item();return!(t&&t.vault&&t.vault.isLocked)&&!!this._itemCommandKey&&this._itemCommandHelper.isCommandSupported(t,this._itemCommandKey)&&e.prototype.onIsAvailable.call(this)};t.prototype.onExecute=function(t,n){var r,i=this,u=this.item.peek(),f=u.documentFormat&&1===u.documentFormat;!f&&E.isFeatureEnabled(E.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType)&&(r=window.open("","_blank"));return this._itemReedemer.redeemItem(u,this,this._forceRedeem).then(function(){var h=i._itemDataSource;if(i.askForFileName)return e.prototype.onExecute.call(i,t,n);i._didUserUploadOrCreateFile&&i._didUserUploadOrCreateFile(!0);if(i.docType===s.DocumentType.OneNote||2===i._itemCommandHelper.getCommandBehavior(u,i._itemCommandKey)){var p=i.navigation,d=h.createDocumentInTab(i.docType,u,!0);p.navigateTo({url:d,frameId:"_blank"});c.refreshItemWhenVisible(u,i.resources);return{resultType:l.ResultTypeEnum.Success}}if(i.docType===s.DocumentType.ExcelSurvey&&E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)){p=i.navigation;var v=i._identityDataSource.getIdentity(),m="Action=Create&Host=ODC&Title="+encodeURIComponent(N.default.FormDefaultName),g="https://forms.office.com/Pages/DesignPage.aspx?Action=Create&auth_pvr=WindowsLiveId"+(v.email?"&auth_upn="+encodeURIComponent(v.email):"")+"&Fragment="+encodeURIComponent(m);p.navigateTo({url:g,frameId:"_blank"});return{resultType:l.ResultTypeEnum.Success}}if(!f&&E.isFeatureEnabled(E.CreateDocumentToVroom)&&-1!==i._vroomDocTypes.indexOf(i.docType))return i._createDocumentDataSource.create(u,i.docType).then(function(e){if(r)r.location.href=e;else{i.navigation.navigateTo({url:e})}i._writePerfForWac();c.refreshItemWhenVisible(u,i.resources);return{resultType:l.ResultTypeEnum.Success}}).catch(function(e){r&&r.close();var t=i._createDocumentDataSource.getDefaultExtension(i.docType);i._showError(e,u,t);return{resultType:l.ResultTypeEnum.Failure}});var y=i._hiddenDomProvider,b=(d=h.createDocumentInTab(i.docType,u,!1),y.requestControl({name:a.default.tagName,params:{canary:FilesConfig.navCanary,formAction:d,resources:i.resources}}));i._writePerfForWac();document.getElementById("create_form").submit();y.disposeControl(b);c.refreshItemWhenVisible(u,i.resources);return o.default.wrap({resultType:l.ResultTypeEnum.Success})})};t.prototype._showError=function(e,t,n){var r,i=this,s=this.observables;(r=this._operationProvider.register({iconName:A.getIconNameFromItem({type:O.default.File,extension:n}),name:"",type:L.default.createItem,payloads:{uploadItems:{name:"New file",parent:t}},actions:{close:{isAvailable:s.create(!0),execute:function(){r.actions().learnMore.isAvailable(!1);r.state(k.default.canceled);return o.default.wrap(null)}},learnMore:{isAvailable:s.create(!0),execute:function(){window.open(i.c_pathLengthErrorLearnMoreLink,"_blank");return o.default.wrap()}}}})).progress.maximum(1);r.progress.current(0);var u=r.actions().learnMore;switch(e.code){case this.c_pathLimitError:u.isAvailable(!0);r.error(new C.default({message:T.default.CreateDocFailureDialogBodyPathLength}));break;case this.c_accessDeniedError:u.isAvailable(!1);r.error(new C.default({message:T.default.CreateDocFailureDialogBodyAccessDenied}));break;default:u.isAvailable(!1);r.error(new C.default({message:T.default.CreateDocFailureDialogBodyDefault}))}r.state(k.default.failed)};t.prototype._writePerfForWac=function(){var e={FR:"SDX.Skydrive*Root",ST:(new Date).getTime()};i.set("BP",f.serializeQuery(e),{domain:h.default.getCookieDomain()});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}};t.prototype._getItemCommandKey=function(e){var t;switch(e){case s.DocumentType.Word:t=m.createWord;break;case s.DocumentType.Excel:t=m.createExcel;break;case s.DocumentType.PowerPoint:t=m.createPowerPoint;break;case s.DocumentType.ExcelSurvey:t=m.createSurvey;break;case s.DocumentType.OneNote:t=m.createOneNote;break;case s.DocumentType.Text:t=g.upload}return t};return t})(r.default);t.default=M});
define("odsp-next/actions/CreateDocumentAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../controls/itemNameEditor/ItemNameEditor","@ms/odsp-utilities/lib/async/Promise","../controls/commands/Commands.resx","../dataSources/url/QueryType","../utilities/icons/Icon","../providers/item/ItemProvider","../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore","../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemOperatorAsyncTypeResourceKey=new m.ResourceKey({name:e("module").id+".createItemOperator",loader:new m.AliasResourceLoader(function(){return a.default.resolve(new Promise(function(t,n){e(["../providers/operator/CreateItemOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var b=(function(e){n.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.docType=t.docType;n.templateUrl=t.templateUrl;n.name="Create"+(o.DocumentType[n.docType]||"")+"DocumentAction";n.navigation=n.resources.consume(i.navigation);n.itemProvider=n.resources.consume(h.resourceKey);n._dialogProvider=n.resources.consume(p.resourceKey);n.platformDetection=n.resources.consume(d.platformDetection);n.redirect=!0;n.openInNewTab=!1;n.askForFileName=n.docType===o.DocumentType.OneNote;n._didUserUploadCreateFile=n.resources.consume(v.didUserUploadOrCreateFile.optional);n._isOneDriveWinApp=y.isOneDriveWinApp();return n}r.prototype.createDocument=function(e,t){var n=this,r=this.navigation,i=this.itemProvider,o=null,u=i.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){e&&(o=e);return a.default.wrap({resultType:s.ResultTypeEnum.Success})});u.done(function(e){o&&!window._isRunningTABTest&&n.async.setImmediate(function(){return r.navigateTo({url:o,frameId:n.openInNewTab?"_blank":null})})});return u};r.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad||this._isOneDriveWinApp)&&this.item().queryType===l.default.Files};r.prototype.isCommandSupported=function(){return!0};r.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():a.default.wrap({resultType:s.ResultTypeEnum.Success})};r.prototype.onExecuteCore=function(){if(!this._isCreatingFile){this._didUserUploadCreateFile&&this._didUserUploadCreateFile(!0);var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}};r.prototype.createNewFile=function(e,n){var r=this;return this.resources.consumeAsync(t.createItemOperatorAsyncTypeResourceKey).then(function(t){var n=new t({fileName:e,parentItem:r.item.peek()});return r.trackPromise(n.start())})};r.prototype._createDocumentWithDialog=function(e){var t=this,n=this._dialogProvider,r=this.observables.create(""),i=this.observables.create(""),a=this.observables.create(!1),l=this.observables.create(!0),h=null,p=g.getDocExtension(this.docType);this._isCreatingFile=!0;var d=function(e){a(!0);l(!0);i(e);return 1},v=n.requestDialog({title:g.getDialogTitle(this.docType,f.default),isDismissable:this.docType!==o.DocumentType.Text,component:{name:u.default.tagName,params:{name:r,automationId:"createDocumentDialog",extension:p,status:i,hasError:a,isEnabled:l}},actions:[{name:f.default.CreateCommit,execute:function(){i(f.default.Saving);l(!1);a(!1);return(function(){var n=t.docType===o.DocumentType.OneNote||t.docType===o.DocumentType.ExcelSurvey||t.docType===o.DocumentType.ExcelForm?r.peek():r.peek()+p;if(t.redirect){return t.itemProvider.createDocument(e.key,t.docType,n,t.templateUrl).then(function(e){h=e;return 2},d)}return t.createNewFile(n,e).then(function(){return 2},d)})()},isAvailable:this.observables.pureCompute(function(){return t._isCreateAvailable(l,r)}),isDefault:!0,icon:new c.default("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}},function(){return{resultType:s.ResultTypeEnum.ExpectedFailure}});v.done(function(){t._isCreatingFile=!1;if(h){var e=t.navigation;t.async.setImmediate(function(){return e.navigateTo({url:h,frameId:t.openInNewTab?"_blank":null})})}});return v};r.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var n=t();return!!n&&" "!==n[0]};return r})(r.default);t.default=b});
define("odsp-next/base/BaseItemAction",["require","exports","tslib","./BaseAction","../models/item/ItemParentHelper","../actions/base/ItemSelectionHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,o=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(s.typeResourceKey.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(i.resourceKey):f;r.isItemSpecified=!!o;r.item=o||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{getItemSelectionHelperType:s.typeResourceKey.lazy,itemParentHelper:i.resourceKey});return t})(r.default);t.default=o});
define("odsp-next/controls/itemNameEditor/ItemNameEditor",["require","exports","./ItemNameEditor.html","./ItemNameEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-item-name-editor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemNameEditor/ItemNameEditor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ItemNameEditor" data-bind="css:{\'od-ItemNameEditor--noExtension\':!extension,\'is-focused\':hasFocus,\'is-error\':hasError}"><div class="od-TextField"><span class="od-ItemNameEditor-input"><input class="od-TextField-field" id="ItemNameEditor-input" type="text" data-bind="textInput:name,hasFocus:hasFocus,selectOnFocus,attr:{\'aria-label\':nameAriaLabel,placeholder:namePlaceholder},css:{\'od-ItemNameEditor-input--error\':hasError},click:onClick,enable:isEnabled,automation:\'itemNameEditor-Input\'"></span><span class="od-ItemNameEditor-extension" data-bind="text:extension"></span></div>\x3c!--ko if:hasError--\x3e<div class="od-ItemNameEditor-status" aria-live="assertive" role="status" data-bind="text:status,css:{\'od-ItemNameEditor-status--error\':hasError}"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/itemNameEditor/ItemNameEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./ItemNameEditor.resx","../../bindings/focus/SelectOnFocusBinding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=s.default.NewNamePlaceholder;n.name=t.name;n.extension=t.extension;n.status=t.status||r.observable("");n.hasError=t.hasError||r.observable(!1);n.isEnabled=t.isEnabled||r.observable(!0);n.hasFocus=t.hasFocus||r.observable(!0);n.namePlaceholder=t.namePlaceholder||n.namePlaceholder;n.nameAriaLabel=t.nameAriaLabel||"";n.addBindingHandlers({selectOnFocus:o.default});return n}t.prototype.onClick=function(e,t){t.stopPropagation()};return t})(i.default);t.default=u});
define("odsp-next/bindings/focus/SelectOnFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this,s=r.valueAccessor();r._platform=r.resources.consume(i.platformDetection.optional);r._isPermanent="object"==typeof s&&s.isPermanent||!1;r._isReentrant="object"==typeof s&&s.isReentrant||!1;document.activeElement===r.element&&r._select();var o=n.__assign({focus:r._onFocus,focusin:r._onFocus,mouseup:r._onMouseUp},r._isReentrant?{focusout:r._onFocusOut}:{});r.events.onAll(r.element,o);return r}t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}this._hasSelected=!0;return!0}return!1};t.prototype._onFocus=function(e){this._select();return!0};t.prototype._onFocusOut=function(){this._hasSelected=!1;return!0};t.prototype._onMouseUp=function(e){if(this._select())return!1};return t})(r.default);t.default=s});
define("@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore",["require","exports","tslib","@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper",["require","exports","../../../operations/createDocument/DocumentType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDocExtension=function(e){switch(e){case n.DocumentType.Word:return".docx";case n.DocumentType.Excel:case n.DocumentType.ExcelSurvey:case n.DocumentType.ExcelForm:return".xlsx";case n.DocumentType.PowerPoint:return".pptx";case n.DocumentType.OneNote:return"";case n.DocumentType.Text:return".txt";case n.DocumentType.Visio:return".vsdx";case n.DocumentType.Bohemia:return".b";case n.DocumentType.Prague:return".prague"}};t.getDialogTitle=function(e,t){var r="";switch(e){case n.DocumentType.Word:r=t.CreateWord;break;case n.DocumentType.Excel:r=t.CreateExcel;break;case n.DocumentType.PowerPoint:r=t.CreatePowerPoint;break;case n.DocumentType.OneNote:r=t.CreateOneNote;break;case n.DocumentType.ExcelSurvey:r=t.CreateExcelSurvey;break;case n.DocumentType.Text:r=t.CreateText;break;case n.DocumentType.ExcelForm:r=t.CreateFormForExcel;break;case n.DocumentType.Visio:r=t.CreateVisio;break;case n.DocumentType.Bohemia:r=t.CreateBohemia;break;case n.DocumentType.Prague:r=t.CreatePrague}return r}});
define("@ms/items-view/lib/private/operations/createDocument/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio";e[e.Bohemia=9]="Bohemia";e[e.Prague=10]="Prague"})(t.DocumentType||(t.DocumentType={}))});
define("odsp-next/utilities/browser/WebViewDetector",["require","exports","../../roots/teams/TeamsUtil","./webView/OriginalQueryString","./webView/IsWebViewHostedList"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isWebViewHostedList=i.isWebViewHostedList;var s,o,u,a;t.isWebViewHosted=function(){void 0===s&&(s=/[?&]env=WebView/.test(r.originalQueryString)||l()||(function(){try{return window.parent&&window.parent!==window&&-1===navigator.userAgent.indexOf("PhantomJS/")||/[?&]env=Embedded/.test(r.originalQueryString)}catch(e){return!1}})()||n.isTeamsListApp());return s};function f(){return!!window.sessionStorage.getItem("_isOneDriveWinApp")}t.isOneDriveWinAppTest=f;t.isOneDriveWinApp=function(){void 0===o&&(o=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||f());return o};t.isOneDriveXboxApp=function(){if(void 0===u){var e=navigator.userAgent;u=-1!==e.indexOf("Xbox")&&-1!==e.indexOf("OneDriveWinApp")}return u};function l(){if(!a){var e=navigator.userAgent;a=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)}return a||n.isTeamsListApp()||n.isTeamsFileApp()}t.isTeamsWebView=l});
define("odsp-next/roots/teams/TeamsUtil",["require","exports","./TeamsConstants"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.Page=2]="Page";e[e.Portal=3]="Portal";e[e.File=4]="File"})(r=t.TeamsApp||(t.TeamsApp={}));var i=function(){};t.TeamsTabContext=i;var s=r.None,o=new i;t.setTeamsListApp=function(e){s=r.List;window._TeamsListApp=e;window._ListInTeamsApp=e;a()};t.isTeamsListApp=function(){return s===r.List};t.setTeamsPageApp=function(e){s=r.Page;window._TeamsPageApp=e;a()};t.isTeamsPageApp=function(){return s===r.Page};t.setTeamsFileApp=function(e){s=r.File;window._TeamsFileApp=e;a()};t.isTeamsFileApp=function(){return s===r.File};var u=r.None;t.setTeamsPortalApp=function(e){u=r.Portal;window._TeamsPortalApp=e};t.isTeamsPortalApp=function(){return u===r.Portal};t.isTeamsApp=function(){return t.isTeamsListApp()||t.isTeamsPageApp()||t.isTeamsPortalApp()||t.isTeamsFileApp()};t.getExtraDataHost=function(){return t.isTeamsListApp()?"TeamsList":t.isTeamsPageApp()?"TeamsPage":t.isTeamsFileApp()?"TeamsFile":"SP"};t.getTeamsListUrl=function(e,t,n){return encodeURI(e+"/_layouts/15/listallitems.aspx?listUrl="+t+("&"===n.substr(0,1)?n:"&"+n))};t.getClientName=function(){return t.isTeamsListApp()?""+n.Constants.TeamsListClientName:t.isTeamsPageApp()?""+n.Constants.TeamsPagesClientName:t.isTeamsFileApp()?""+n.Constants.TeamsFileClientName:void 0};t.getTeamsImagesUrl=function(e){var t="odsp-media/images/teams/"+e+".svg";return window&&window.require&&window.require.toUrl?window.require.toUrl(t):t};t.getTeamsTabContextFromUrl=function(){void 0===o.TeamId&&a();return o};t.getSpListMigrationMarker=function(){return t.getUrlQueryParam("mg",!0)};t.getUrlQueryParam=function(e,t){void 0===t&&(t=!1);var n=window.location.href.split("?")[1];if(n)for(var r=n.split("&"),i=0;i<r.length;i++){var s=r[i].split("=");if(s[0]===e)return t?decodeURIComponent(s[1]):s[1]}};t.getSubEntityDetails=function(){var e=t.getUrlQueryParam("subEntityId");if(e&&!Number.isNaN(+e)){var n=t.getUrlQueryParam("listUrl"),r=t.getUrlQueryParam("theme"),i=window.location.href,s=void 0;if(e&&i&&n){s=""+i.split("?")[0].toLowerCase().split("/teams/")[0]+n+"/dispform.aspx?ID="+e+"&app=teamslist&theme="+r}return{itemId:e,itemOpenUrl:s}}};t.isTeamsSubEntityPresent=function(){var e=t.getUrlQueryParam("subEntityId");return!(!e||Number.isNaN(+e))};function a(){var e=t.getUrlQueryParam("teamId",!0);void 0!==e&&(o.TeamId=e.split("@")[0]);var n=t.getUrlQueryParam("channelId",!0);void 0!==n&&(o.ChannelId=n.split("@")[0]);o.EntityId=t.getUrlQueryParam("entityId",!0);o.RingId=t.getUrlQueryParam("ringId",!0);o.AppSessionId=t.getUrlQueryParam("asid",!0);o.SessionId=t.getUrlQueryParam("sid",!0)}});
define("odsp-next/roots/teams/TeamsConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.DefaultLocale="en-US";e.TeamsListClientName="Teams.List";e.TeamsPagesClientName="Teams.Page";e.TeamsFileClientName="Teams.File";e.PageContextKey="_spPageContextInfo";return e})();t.Constants=n});
define("odsp-next/utilities/browser/webView/OriginalQueryString",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.originalQueryString=location.search});
define("odsp-next/utilities/browser/webView/IsWebViewHostedList",["require","exports","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","./OriginalQueryString"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;t.isWebViewHostedList=function(e){void 0===s&&(s=/[?&]env=WebViewList/.test(i.originalQueryString));return s||!!e&&(Number(e.webTemplate)===n.default.mySite&&!!e.listId&&e.listBaseType!==r.ListBaseType.invalidType&&!r.isDocLib(e.listBaseType))}});
define("@ms/odsp-datasources/lib/dataSources/web/WebTemplateType",["require","exports","tslib","../../interfaces/WebTemplateType","../../interfaces/WebTemplateType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r;(function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.customGrid=120]="customGrid";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.promotedLinks=170]="promotedLinks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary";e[e.publishingPageLibrary=850]="publishingPageLibrary";e[e.publishingAsset=851]="publishingAsset";e[e.issueTracking=1100]="issueTracking";e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary";e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary";e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary";e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList"})(n=t.ListTemplateType||(t.ListTemplateType={}));(function(e){e[e.invalidType=-1]="invalidType";e[e.GenericList=0]="GenericList";e[e.DocumentLibrary=1]="DocumentLibrary"})(r=t.ListBaseType||(t.ListBaseType={}));var i=[n.mySiteDocumentLibrary,n.documentLibrary,n.pictureLibrary,n.xmlFormLibrary,n.webPageLibrary,n.publishingPageLibrary,n.publishingAsset];t.isDocumentLibrary=function(e){var t=Number(e);return-1!==i.indexOf(t)};t.isDocLib=function(e){return Number(e)===r.DocumentLibrary};t.isGenericList=function(e){return e===n.genericList||e===n.announcements||e===n.issueTracking||e===n.contacts||e===n.customGrid};t.isPromotedLinksList=function(e){return Number(e)===n.promotedLinks};t.default=n});
define("odsp-next/controls/createDocumentForm/CreateDocumentForm",["require","exports","./CreateDocumentForm.html","./CreateDocumentFormViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-create-doc-form",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/createDocumentForm/CreateDocumentForm.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<form class="CreateDocumentForm" id="create_form" name="create_form" method="post" data-bind="attr:{action:formAction,target:target}"><input name="canary" type="hidden" data-bind="value:canary"></form>'});
define("odsp-next/controls/createDocumentForm/CreateDocumentFormViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(i.platformDetection);n.formAction=t.formAction;n.canary=t.canary;n.target=n._platform.isMobile?"":"_blank";return n}return t})(r.default);t.default=s});
define("odsp-next/actions/odc/SkyApiHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/DataSourceResourceKeys","./OfficeActionIdMap","./OfficeClient","@ms/odsp-utilities/lib/events/EventGroup","../../models/item/ItemType","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){var n;e&&e.properties&&e.properties.commandsSupported&&(n=e.properties.commandsSupported[t]);return n}t.getActionId=l;t.isCommandSupported=function(e,t){return void 0!==l(e,t)};t.tryAutoRedeemItem=function(e,t,n){return c([e],t,n)};function c(e,t,s){return(function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r&&r.tokenNeedsRedeeming)return!0}return!1})(e)||s?(function(e,t){return e.resources.consumeAsync(i.ticketRedeemer).then(function(n){return n.startRedeem(e,t)},function(e){return n.default.reject({})})})(t,e[0]):n.default.wrap({resultType:r.ResultTypeEnum.Success})}t.tryAutoRedeemItems=c;t.openInClient=function(e,t,n,r,i){var u;e.type===a.default.OneNote&&(u=e.urls.oneNoteClient);var f={url:u,isDavUrl:!!u,fileName:e.name,iconType:e.iconName,appType:r,extension:r===s.default[2].toString()?".one":e.extension,item:e};return o.default.executeOpenInClient(f,i)};t.refreshWhenVisible=function(e){var t=h(),n=t?t+"Hidden":"hidden",r=t+"visibilitychange",i=new u.default(this),s=window.document;if(n){var o=function(){if(!s[n]){i.off(s,r,o);e(!0)}};i.on(s,r,o)}};t.refreshItemWhenVisible=function(e,t,n){var r=h(),i=r?r+"Hidden":"hidden",s=r+"visibilitychange",o=new u.default({}),a=window.document;if(i){var l=function(){if(!a[i]){o.off(a,s,l);t.consume(f.resourceKey).invalidateItem(e.key,{triggerFetch:n})}};o.on(a,s,l)}};function h(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}});
define("odsp-next/actions/odc/OfficeActionIdMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Excel=1]="Excel";e[e.OneNote=2]="OneNote";e[e.PowerPoint=3]="PowerPoint";e[e.Word=4]="Word";e[e.Visio=5]="Visio";e[e.Project=6]="Project";e[e.Publisher=7]="Publisher"})(n||(n={}));t.default=n});
define("odsp-next/actions/odc/OfficeClient",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./ClientUtils","./OfficeActionIdMap","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}e.executeOpenInClient=function(t,i){e._item=t.item;e._provider=i.consume(o.resourceKey);if(t.isDavUrl){e._openInClient(t);return n.default.wrap({resultType:r.ResultTypeEnum.Success})}return e._getOpenInClientDetails(t)};e._getOpenInClientDetails=function(t){return e._provider.getOpenInClientDetails(e._item).then(function(i){if(i){var s=i.davUrl;t.url=s;t.isDavUrl=!0;e._openInClient(t)}return n.default.wrap({resultType:r.ResultTypeEnum.Success})})};e._openInClient=function(e){if(!e.useDirectInvoke){var t=i.default.OpenDocumentMode.WriteOnly;1===e.item.sharingRole&&(t=i.default.OpenDocumentMode.ReadOnly);e.appType===s.default[7].toString()&&(t=i.default.OpenDocumentMode.WriteOnly);var n=i.default.OpenDocumentOptions.None;e.Mode=t;e.Options=n;var r={DocumentUrl:e.url,Mode:t,Options:n,Application:i.default.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};i.default.EditDocumentInClient(r,null,null)}};return e})();t.default=u});
define("odsp-next/actions/odc/ClientUtils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){var e,t,n,r,i,s,o,u,a,f="";var l={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},c={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},h={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},p={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},d={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function v(){return(function(){(function(){if(s)return;s=!0;o=y("Windows NT")})();return o>=6.1})()&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(T()||L()||k())}function m(){return window.navigator.userAgent.indexOf("Windows")>=0}function g(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function y(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;if(null!=t&&t.length>=2){n=parseFloat(t[1]);isNaN(n)&&(n=-1)}return n}function b(){(function(){if(!u){u=!0;a=y("Windows Phone")}})();return a>=8}function w(){return"function"==typeof navigator.msLaunchUri&&!g()&&!x()}function E(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function S(){return window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0}function x(){return window.navigator.userAgent.indexOf("Edge/")>=0}function T(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function N(){return!!T()&&8==window.document.documentMode}function C(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function k(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function L(){return(function(){if(C())return O("firefox/");return 0})()>=3}function A(){return(function(){if(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0)return O("version/");return 0})()>=3}function O(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var r=n+e.length,i=t.length;return parseInt(t.substring(r,i))}return 0}function M(e,t,n){w()?navigator.msLaunchUri(e,t,n):!k()&&!S()||x()?(function(e,t,n){var r=document.getElementById("OICFrame");if(null==r){(r=document.createElement("iframe")).className="ObjectInDialog";r.style.visibility="hidden";r.src="about:blank";document.body.appendChild(r);r.id="OICFrame"}try{r.contentWindow.location.href=e}catch(e){null!=n&&n();return}null!=t&&t()})(e,t,n):(function(e,t,n){var r=document.getElementById("OICLinkTag");if(null==r){(r=document.createElement("a")).id="OICLinkTag";r.style.visibility="hidden";r.href="";r.target="_top";document.body.appendChild(r);null!=r.addEventListener&&r.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1)}try{r.href=e;r.click()}catch(e){null!=n&&n();return}null!=t&&t()})(e,t,n)}function _(e){return 0!=(e.Options&c.SkipProtocolHandler)||N()}function D(e){return!_(e)&&(!!(function(e){return E()&&(e.Application==d.OneNote||V("application/x-sharepoint-protocolhandler",!1)||V("application/x-sharepoint-webkit-protocolhandler",!1))})(e)||(!!w()||(!(P()||"ActiveXObject"in window&&!g()||k())||Z()>=15)))}function P(){return E()&&(L()||A())||L()}function H(e){return e===l.ReadOnly||e===l.ReadWrite}function B(e,t,n,r){var s=(function(e){if(e!=d.OneNote&&g()&&!b())return"office:";switch(e){case d.Excel:return"ms-excel:";case d.OneNote:return"onenote:";case d.PowerPoint:return"ms-powerpoint:";case d.Visio:return"ms-visio:";case d.Word:return"ms-word:";case d.Project:return"ms-project:";case d.Publisher:return"ms-publisher:";case d.Infopath:return"ms-infopath:";case d.Access:return"ms-access:";default:return""}})(e);if(null==s){Y(h.Unattempted,i.Application);return!1}e==d.Visio&&n==l.ReadWrite&&(n=l.WriteOnly);var o=s;if(!(r=r||g()&&!b())){var u="";H(n)?u+="ofv|":u+="ofe|";o+=j(u+="u|")}M(o+=j(t),F,I);return!0}function j(e){if(E()&&k()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function F(){G(p.ProtocolHandler)}function I(){i.Options|=c.SkipProtocolHandler;Q(i,e,t)}function q(){if(w())return!0;if(k()){void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(!1);return!!navigator.mimeTypes["application/x-vnd.officeondemand"]}if(C()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");t.initEvent("RoamingOfficeInstalled",!0,!1);e.dispatchEvent(t);return!!e.getAttribute("installed")}if(T())try{return new ActiveXObject("RoamingOfficeActiveX.RoamingOffice").HrExists()}catch(e){}return!1}function R(e,t,n,r,i,s){U(e,t,(function(e){switch(e){case d.Excel:return"root\\office15\\excel.exe";case d.PowerPoint:return"root\\office15\\powerpnt.exe";case d.Visio:return"root\\office15\\visio.exe";case d.Word:return"root\\office15\\winword.exe";case d.Project:return"root\\office15\\winproj.exe";case d.Publisher:return"root\\office15\\mspub.exe";case d.Infopath:return"root\\office15\\infopath.exe";case d.Access:return"root\\office15\\msaccess.exe";default:return null}})(n),r,"x86",f,i,s)}function U(e,t,i,s,o,u,a,f){var l="";null!=s&&(l+=" "+s);null!=e&&(l+=' "'+e+'"');if(w()||k()){n=a;r=f;var c="office:";c+=' "'+u+'"';c+=' "'+i+'"';c+=' "ROAMING"';c+=' "'+t+'"';c+=' "'+o+'"';M(c+=" "+l,z,W)}else if(C()){var d=document.createElement("RoamingExtensionElement");d.setAttribute("cabUrl",u);d.setAttribute("app",i);d.setAttribute("licensingEntitlements",t);d.setAttribute("platform",o);d.setAttribute("args",l);document.documentElement.appendChild(d);var v=document.createEvent("Events");v.initEvent("RoamingOfficeLaunch",!0,!1);d.dispatchEvent(v);null!=a&&a(p.RoamingFFExtension)}else if(T()){var m=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice");if(null!=m)try{m.HrConfigureSingle(u,i,t,o,l);null!=a&&a(p.RoamingActiveX)}catch(e){}}else null!=f&&f(h.Failed)}function z(){null!=n&&n(p.RoamingProtocolHandler)}function W(){null!=r&&r(h.ControlNeeded)}function X(){var e=document.getElementById("npSharePointPlugin");if(null==e){var t="application/x-sharepoint";E()&&A()&&$("application/x-sharepoint-webkit")&&(t="application/x-sharepoint-webkit");if(!$(t)){if(!E()||!$("application/officelive"))return null;t="application/officelive"}var n=document.createElement("object");n.id="npSharePointPlugin";n.type=t;n.style.width="0px";n.style.height="0px";n.style.setProperty("visibility","hidden","");document.body.appendChild(n);e=document.getElementById("npSharePointPlugin")}return e}function V(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var r=n[e];return!!r&&!(t&&!r.enabledPlugin)}function $(e){return V(e,!0)}function J(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function K(e){switch(e){case d.OneNote:return"OneNote.Notebook";default:return""}}function Q(n,r,s){i=n;e=r;t=s;if(n.DocumentUrl){var o=n.DocumentUrl;try{o=decodeURIComponent(n.DocumentUrl)}catch(e){}n.Mode===l.ReadWrite&&c.CheckoutRequired===(n.Options&c.CheckoutRequired)&&(n.Mode=l.ForceCheckout);c.HostIsEditOnly===(n.Options&c.HostIsEditOnly)&&(n.Mode=l.WriteOnly);if(D(n))B(n.Application,n.DocumentUrl,n.Mode,n.Application==d.OneNote);else if(N()&&(function(e,t,n,r){try{var i=new ActiveXObject("SharePoint.OpenDocuments.5");if(i)return i.ViewDocument3(window.self,e,t,r)}catch(e){}return!1})(o,n.Mode,n.Options,K(n.Application)))G(p.O15ActiveX);else{var u;if(P())u=(function(e,t,n){var r=X();if(null==r)return h.Unattempted;var i=!1;try{i=r.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=H(t)?r.ViewDocument2(window.self,e,n):r.EditDocument2(window.self,e,n)}catch(e){}if(i){G(p.NpapiPlugin);return h.None}return h.Failed})(o,n.Mode,K(n.Application));else{(function(){try{var e=new ActiveXObject("IDBHO.IDBHOCtrl");null!=e&&e.SaveSSOCreds()}catch(e){}})();u=(function(e,t,n,r){var i;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.4")){if(i.ViewDocument3(window.self,e,t,r)){G(p.O14ActiveX);return h.None}return h.Failed}}catch(e){}if(c.O14Only===(n&c.O14Only))return h.Unattempted;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.3")){if(i.ViewDocument3(window.self,e,t,r)){G(p.O12ActiveX);return h.None}return h.Failed}}catch(e){}if(c.O12UpOnly===(n&c.O12UpOnly))return h.Unattempted;try{if(i=new ActiveXObject("SharePoint.OpenDocuments.2")){if(H(t)?i.ViewDocument2(window.self,e,r):i.EditDocument2(window.self,e,r)){G(p.O11ActiveX);return h.None}return h.Failed}}catch(e){}return h.Unattempted})(o,n.Mode,n.Options,K(n.Application))}if(u!=h.None){if(n.CouldUseRoamingApps&&v()&&n.Application!=d.OneNote){if(!q()){Y(h.ControlNeeded,i.Application);return}if(n.RoamingAppsLauncher){(function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?R(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):U(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):Y(h.Unattempted,i.Application)})(n);return}if(!n.ContinueIfLauncherIsNull){Y(h.LauncherNeeded,i.Application);return}}if(!(c.NoProtocolHandlerFallback==(n.Options&c.NoProtocolHandlerFallback)||_(n)||T()||E()&&u!=h.Unattempted)){B(n.Application,n.DocumentUrl,n.Mode,n.Application==d.OneNote);return}Y(u,i.Application)}}}else Y(h.Unattempted,i.Application)}function G(t){null!=e&&e(t)}function Y(e,n){void 0===n&&(n=null);null!=t&&t(e,n)}function Z(){var e=0;if(P()||k()){var t=X();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else J("SharePoint.OpenDocuments.5")?e=15:J("SharePoint.OpenDocuments.4")?e=14:J("SharePoint.OpenDocuments.3")?e=12:J("SharePoint.OpenDocuments.2")&&(e=11);return e}function ee(){return E()&&($("application/x-sharepoint")||$("application/x-sharepoint-webkit"))}return{OpenDocumentMode:l,OpenDocumentOptions:c,OpenDocumentFailureType:h,OpenDocumentControl:p,OfficeApplication:d,EditDocumentInClient:Q,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=d.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl=""},OfficeVersionInstalled:Z,IsO14MacPluginInstalled:ee,OfferOfficeInDialog:function(){return m()&&Z()<=11},OfferOfficeNoIntrusive:function(){return m()&&Z()<15},OfferMacOffice:function(){return E()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!ee()},CanUseRoamingControl:q,InitUrls:function(e,t,n){f=e},LaunchRoamingApps:R,LaunchRoamingApps2:U,ShouldShowDialog:function(){return!g()}}})();t.default=n});
define("odsp-next/providers/hiddenDom/HiddenDomProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this,s=i._controls=i.observables.createArray([]),o=document.createElement("div");o.style.display="none";var u=document.createElement("div");u.setAttribute("data-bind","component: $data");document.body.appendChild(o);r.applyBindingsToNode(o,{template:{nodes:[u],foreach:s}});return i}t.prototype.requestControl=function(e){this._controls.push(e);return e};t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)};return t})(i.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/models/item/command/OfficeItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createExcel=new n.default("createExcel");t.createOneNote=new n.default("createOneNote");t.createPowerPoint=new n.default("createPowerPoint");t.createWord=new n.default("createWord");t.createSurvey=new n.default("createSurvey");t.viewSurvey=new n.default("viewSurvey");t.editSurvey=new n.default("editSurvey");t.publishSurvey=new n.default("publishSurvey");t.openOnline=new n.default("openOnline");t.openInClient=new n.default("openInClient");t.viewVersionHistory=new n.default("viewVersionHistory");t.openInPowerBI=new n.default("openInPowerBI");t.contentTypeNavigation=new n.default("contentTypeNavigation");t.editNewMenu=new n.default("editNewMenu");t.uploadTemplate=new n.default("uploadTemplate")});
define("odsp-next/models/item/command/WebItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.upload=new n.default("upload");t.download=new n.default("download");t.sync=new n.default("sync")});
define("odsp-next/dataSources/createDocument/odc/CreateDocumentDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.create=function(e,t){var n=this;return this.getCreateUrl(e,t).then(function(e){return n._vroomDataRequestor.send({apiName:"CreateDocument",path:e,requestType:"PUT",useAuthorizationHeaders:!0,headers:{Prefer:"allow-zerobyte"}}).then(function(e){return e.webUrl})})};t.prototype.getCreateUrl=function(e,t){var n=this;return this.getGraphItemUrl(e).then(function(e){return e+"/"+n.getDefaultExtension(t)+":/content?@name.conflictBehavior=defaultName"})};t.prototype.getGraphItemUrl=function(e){return this.resources.consumeAsync(u.graph).then(function(t){return t.getItemUrl(e,{isPath:!0,useDirectEndpoint:!0})})};t.prototype.getDefaultExtension=function(e){var t="";switch(e){case i.DocumentType.Word:t=".docx";break;case i.DocumentType.Excel:t=".xlsx";break;case i.DocumentType.PowerPoint:t=".pptx";break;default:throw new TypeError("Invalid DocumentType")}return t};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{vroomDataRequestor:o.resourceKey});return t})(r.default);t.default=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a,n.__assign(n.__assign({},r.default.dependencies),{vroomDataRequestor:o.resourceKey}))});
define("odsp-next/actions/createFolder/odc/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(s,t);function s(){var e=null!==t&&t.apply(this,arguments)||this;e.name="CreateFolder";return e}s.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"};s.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./CreateFolderExecutor"],t,n)}))}};s.prototype.getSelectionOptions=function(){return{canFallback:!0}};s.prototype.getExecutorParameters=function(){var e=this;return this.selectionHelper.resolveFirst().then(function(t){return{actionName:e.name,item:t}})};s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!(e&&e.vault&&e.vault.isLocked)&&e&&e.queryType===i.default.Files&&this.itemCommandHelper.isCommandSupported(e,o.createFolder)};return s})(s.default);t.default=u});
define("odsp-next/models/item/command/FileSystemItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolder=new n.default("createFolder");t.rename=new n.default("rename");t.moveFrom=new n.default("moveFrom");t.copyFrom=new n.default("copyFrom");t.moveTo=new n.default("moveTo");t.copyTo=new n.default("copyTo");t.deleteItem=new n.default("deleteItem");t.restoreItem=new n.default("restoreItem");t.deleteAllItems=new n.default("deleteAllItems");t.restoreAllItems=new n.default("restoreAllItems");t.createText=new n.default("createText");t.changeExpiration=new n.default("changeExpiration");t.open=new n.default("open");t.openInTextEditor=new n.default("openInTextEditor");t.openPdfInBrowser=new n.default("openPdfInBrowser");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.createShortcut=new n.default("createShortcut");t.pinToMru=new n.default("pinToMru");t.printPdf=new n.default("printPdf")});
define("odsp-next/actions/odc/CreateMountPointAction",["require","exports","tslib","../../base/BaseAction","../../controls/commands/Commands.resx","../../controls/createMountPoint/CreateMountPoint","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/icons/Icon","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../base/ItemRedeemer","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/scope/Scope","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.isSingleSelectAction=!0;r.canFallbackToParent=!0;r.name="CreateMountPoint";r._actionMap=r.resources.consume(g.actionMap);r._itemReedemer=r.resources.consume(d.resourceKey);r._itemCommandHelper=new(r.managed(h.default));r._itemSelectionHelper=new(r.child(v.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,p.addAsMountPoint)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,o.default,function(){var e,t,r,h,p,d,v,g,y,b=this;return n.__generator(this,function(w){switch(w.label){case 0:e=this.resources.consume(u.resourceKey);return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=w.sent())?[4,this._itemReedemer.redeemItem(t,this)]:[2,{resultType:a.ResultTypeEnum.ExpectedFailure}];case 2:w.sent();r=new(this.scope.attached(m.default));h=this.observables.create(!0);p=this.observables.create(!0);d=this.observables.create(i.default.CreateMountPointDetails);v=f.format(i.default.CreateMountPointTitle,t.name);g=function(){return n.__awaiter(b,void 0,o.default,function(){var e,r,s;return n.__generator(this,function(n){switch(n.label){case 0:e=this.resources.consume(c.resourceKey);h(!1);p(!1);d(i.default.CreateMountPointWait);n.label=1;case 1:n.trys.push([1,3,,4]);return[4,e.createMountPoint({item:t})];case 2:r=n.sent();new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this.createObservable(r)}).execute(null);return[2,2];case 3:if((s=n.sent()).data&&s.data.message){d(s.data.message);return[2,1]}return[2,1];case 4:return[2]}})})};y=e.requestDialog({title:v,component:{name:s.default.tagName,params:{text:d,isLearnMoreVisible:h}},actions:[{name:i.default.CreateMountPointConfirm,execute:function(){return g()},isAvailable:h,isVisible:h,icon:new l.default("FabricFolderLink"),isDefault:!0},{name:i.default.Close,execute:function(){return o.default.resolve(2)},isAvailable:this.observables.create(!0),isVisible:r.attach(this.observables.pureCompute(function(){return!h()})),icon:new l.default("Cancel"),isDefault:!0}]});w.label=3;case 3:w.trys.push([3,,5,6]);return[4,y.wait()];case 4:w.sent();this._itemSelectionHelper.clearSelection();return[3,6];case 5:r.dispose();return[7];case 6:return[2,{resultType:a.ResultTypeEnum.Success}]}})})};return t})(r.default);t.default=y});
define("odsp-next/controls/createMountPoint/CreateMountPoint",["require","exports","./CreateMountPoint.html","./CreateMountPointViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-create-mp",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/createMountPoint/CreateMountPoint.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="CreateMountPoint"><span data-bind="text:text"></span><a data-bind="attr:{href:learnMoreUrl},text:learnMoreText,visible:isLearnMoreVisible"></a></div>'});
define("odsp-next/controls/createMountPoint/CreateMountPointViewModel",["require","exports","tslib","../commands/Commands.resx","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(n){var i=e.call(this,n)||this;i.text=n.text;i.isLearnMoreVisible=n.isLearnMoreVisible;i.learnMoreText=r.default.CreateMountPointLearnMore;i.learnMoreUrl=t.LEARNMORE_URL;return i}t.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986";return t})(i.default);t.default=s});
define("odsp-next/models/item/command/SocialItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.share=new n.default("share");t.addToShared=new n.default("addToShared");t.embed=new n.default("embed");t.comment=new n.default("comment");t.removeFromShared=new n.default("removeFromShared");t.addAsMountPoint=new n.default("addAsMountPoint");t.removeAsMountPoint=new n.default("removeAsMountPoint");t.reportAbuse=new n.default("reportAbuse");t.requestReview=new n.default("requestReview");t.alertItem=new n.default("alertItem");t.addToSpotlight=new n.default("alertItem")});
define("odsp-next/actions/odc/DefaultClickAction",["require","exports","tslib","../DefaultClickAction","../../resources/ODCResourceKeys","./ShowNotSharedAction","../../dataSources/url/AutoActionType","../base/ItemCommandHelper","../../models/item/command/CoreItemCommandKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._odcUrlDataSource=n.resources.consume(i.urlDataSource);n._itemCommandHelper=new(n.managed(u.default));n._defaultClickBehavior=n.createPureComputed(n._computeDefaultClickBehavior);n._isOneDriveWinApp=f.isOneDriveWinApp();n._isOneDriveXboxApp=f.isOneDriveXboxApp();return n}t.prototype.onIsAvailable=function(){var t=this.item(),n=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(t,a.defaultClick);return e.prototype.onIsAvailable.call(this)&&!n};t.prototype.onComputeAction=function(){var t,n=this;switch(this._defaultClickBehavior()){case 1:t=e.prototype.onComputeAction.call(this);break;case 2:case 3:t=this._isOneDriveWinApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,focusUrl:!0}):new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 7:t=this._isOneDriveXboxApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,focusUrl:!0}):new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 10:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 11:t=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=n._odcUrlDataSource.qualifyUrl(n._odcUrlDataSource.getDefaultClickUrl(n.item(),{action:o.default.defaultClick,viewParams:n.viewParams()}));return n._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 15:t=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 50:t=new(this.managed(s.default))}return t};t.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),a.defaultClick)};return t})(r.default);t.default=l});
define("odsp-next/actions/DefaultClickAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../models/item/ItemType","../resources/DataSourceResourceKeys","../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../dataSources/url/PageType","./base/ItemSelectionHelper","../models/item/engagement/ItemEngagementParts","@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts","../models/engagement/Engagement","../providers/engagement/Engagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openEngagementPart=new v.EngagementPart("Open",2);var g=(function(e){n.__extends(r,e);function r(n,r){void 0===r&&(r={});var i=e.call(this,n,r)||this;i.name="DefaultClick";i.isQosLogged=!1;var o=n.item,f=n.userInvokedItem,c=void 0!==f&&f,p=n.hideIfDefaultIsDownload,d=void 0!==p&&p,m=n.sourceEngagement,g=void 0===m?"":m,y=i,b=y.resources,w=y.observables;b.expose(v.engagementSourceResourceKey,b.consume(v.engagementSourceResourceKey).withPart(t.openEngagementPart));i._itemSelectionHelper=new(i.child(h.typeResourceKey))({overrideItem:o,allowMultiSelect:!1,canFallback:!1});i.item=i._itemSelectionHelper.firstItem;i.sourceEngagement=g;i.userInvokedItem=c;i.hideIfDefaultIsDownload=d;i.actionMap=b.consume(s.actionMap);i.urlDataSource=b.consume(u.url);i.viewParams=b.consume(s.viewParams);i._isFilePickerPage=w.pureCompute(i._computeIsFilePickerPage);i._action=w.pureCompute(i._computeAction);i._action.equalityComparer=l.objectStrictEquality;i._instrumentationProvider=b.consume(a.instrumentation);return i}r.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};r.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var r=this._instrumentationProvider;r&&n&&r.userClickItem(n);var s=t.peekUnwrap(this._action);return s&&s.execute(e)||f.default.resolve({resultType:i.ResultTypeEnum.ExpectedFailure})};r.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};r.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===c.default.FilePicker};r.prototype._computeAction=function(){var e,t=this._lastAction;if(t){t.dispose();this._lastAction=void 0}var n=this.item();this._isFilePickerPage()&&n&&n.type!==o.default.Folder||(e=this.onComputeAction());this._lastAction=e;return e};r.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var r;if(e)switch(e.type){case o.default.File:r="FileOpen."+n;break;case o.default.Folder:r="FolderOpen."+n;break;case o.default.App:r="AppOpen."+n;break;case o.default.Subsite:r="SubsiteOpen."+n;break;default:r="Open."+n}else r="Open."+n;this.resources.consume(m.resourceKey).withPart(d.clickEngagementPart).withPart(p.itemEngagementPart,{item:e}).logData({name:r,extraData:{action:t?t.type:"unknown"}})}};return r})(r.default);t.default=g});
define("odsp-next/models/item/engagement/ItemEngagementParts",["require","exports","../../engagement/Engagement"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementPart=new n.EngagementPart("Item",1)});
define("odsp-next/actions/odc/ShowNotSharedAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/textContainer/TextContainer.resx","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ShowNotShared";t._dialogProvider=t.resources.consume(a.resourceKey);return t}t.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:s.default.titleNotShared,component:{name:o.default.tagName,params:{text:s.default.textNotShared}},actions:[]}).wait().then(function(){return u.default.wrap({resultType:i.ResultTypeEnum.Success})})};return t})(r.default);t.default=f});
define("odsp-next/models/item/command/CoreItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClick=new n.default("defaultClick")});
define("odsp-next/actions/delete/odc/DeleteAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="Delete";n.logStartEnd=!0;n._currentItem=n.resources.consume(o.currentItem);return n}s.prototype.getExecutorPath=function(){return"./DeleteExecutor"};s.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./DeleteExecutor"],t,n)}))}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};s.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};s.prototype.onIsAvailable=function(){var e=this;return this._currentItem()&&this.selectionHelper.filterItems(function(t){var n=!!t.parent&&t.parent.isBundle,r=!!t.parent&&t.parent.isAlbum;return e.itemCommandHelper.isCommandSupported(t,u.deleteItem)&&t.queryType!==i.default.SharedWithMe&&t.queryType!==i.default.DocsInCommon&&!n&&!r})};return s})(s.default);t.default=a});
define("odsp-next/actions/download/odc/DownloadAction",["require","exports","tslib","cookies","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../dataSources/url/QueryType","../../../models/item/command/WebItemCommandKeys","../../../actions/base/ItemCommandHelper","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n._itemCommandHelper=new(n.managed(f.default));n.name="Download";n._currentItem=n.resources.consume(o.currentItem);n._itemCommandHelper=new(n.managed(f.default));n._isOneDriveWinApp=l.isOneDriveWinApp();n._isOneDriveXboxApp=l.isOneDriveXboxApp();return n}s.prototype.getExecutorPath=function(){return"./DownloadExecutor"};s.prototype.getModuleFactory=function(){return function(){return i.default.resolve(new Promise(function(t,n){e(["./DownloadExecutor"],t,n)}))}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!this._isOneDriveWinApp,canFallback:!0}};s.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};s.prototype.onIsAvailable=function(){var e=this,t=this.selectionHelper.selection(),n=this.selectionHelper.firstItem();if((t.length>1||n&&n.folder)&&r.get("BadgerAuth"))return!1;var i=this._currentItem();return!(t.length>1&&i.queryType===u.default.SharedWithMe&&i.isRootFolder)&&(!this._isOneDriveXboxApp&&this.selectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,a.download)}))};return s})(s.default);t.default=c});
define("odsp-next/actions/editTags/odc/EditTagsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.name="EditTagsAction";n._itemCommandHelper=new(n.managed(i.default));n._currentItem=n.resources.consume(u.currentItem);return n}o.prototype.getExecutorPath=function(){return"./EditTagsExecutor"};o.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./EditTagsExecutor"],t,n)}))}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};o.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};o.prototype.onIsAvailable=function(){var e=this;return a.isFeatureEnabled(a.EnableTagsInODC)&&this.selectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&e._itemCommandHelper.isCommandSupported(t,s.editTags)})};return o})(o.default);t.default=f});
define("odsp-next/actions/editTags/odc/ShowTagsEditorAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemCommandHelper","../../base/ControlExecutorAction","../../base/ItemSelectionHelper","../../../resources/ControlResourceKeys","../../../models/item/command/PhotoItemCommandKeys","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._itemSelectionHelper=new(n.child(u.typeResourceKey))({allowMultiSelect:!0,canFallback:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(s.default));n._currentItem=n.resources.consume(a.currentItem);return n}t.prototype.getParams=function(){return{actionName:"ShowTagsEditor",selectionHelper:this._itemSelectionHelper,currentItem:this._currentItem.peek()}};t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}};t.prototype._isAvailable=function(){var e=this;return l.isFeatureEnabled(l.EnableTagsInODC)&&this._itemSelectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&e._itemCommandHelper.isCommandSupported(t,f.editTags)})};return t})(i.default);t.ShowTagsEditorHandler=c;var h=o.create({name:"ShowTagsEditor",source:{moduleDefinition:{path:"./ShowTagsEditorExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./ShowTagsEditorExecutor"],t,n)}))}}},handlerType:c});t.default=h});
define("odsp-next/actions/base/ControlExecutorAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ControlExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.name,i=t.source,o=t.handlerType,u=t.actionParams,a=t.useToggleBehavior,f=void 0!==a&&a;n.name=r;var l=o?new(n.managed(o))(u):void 0,c=l&&l.state||n.createObservable({isAvailable:!0}),h=l&&l.getParams?function(){return l.getParams()}:function(){};n._controlExecutorLoader=new(n.managed(s.default))({source:i,state:c,useToggleBehavior:f,getParams:h});return n}t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t})(r.default);t.ControlExecutorAction=o;t.create=function(e){var t=e.name,r=e.source,i=e.useToggleBehavior,s=e.handlerType;return(function(e){n.__extends(o,e);function o(n){return e.call(this,{name:t,source:r,useToggleBehavior:i,actionParams:n,handlerType:s})||this}return o})(o)}});
define("odsp-next/actions/base/ControlExecutorLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","../../providers/hiddenDom/HiddenDomProvider"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.state,s=t.source,a=t.useToggleBehavior,f=t.getParams;if((function(e){return!!e.moduleDefinition})(s)){var l=s.moduleDefinition;n._getComponentDefinition=function(){return o.loadModule(l)}}else{var c=s.component;n._getComponentDefinition=function(){return i.default.wrap(c)}}n._useToggleBehavior=a;n._state=r;n._getParams=f;n._action=n.createObservable();n._hiddenDomProvider=n.resources.consume(u.resourceKey);n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}t.prototype.execute=function(e){var t,r=this;if(this._useToggleBehavior){var o=this._action.peek();if(o){o.cancel();return i.default.wrap()}}var u=new s.default,a={complete:function(){u.complete()},fail:function(e){u.error(e)},cancel:function(){u.cancel()}};this._useToggleBehavior&&this._action(a);return i.default.as(this._getParams()).then(function(i){return r._getComponentDefinition().then(function(s){t={name:s.tagName,params:n.__assign(n.__assign({action:a,event:e},i||{}),{resources:r.resources})};r._hiddenDomProvider.requestControl(t);return u.getPromise()})}).then(function(){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0)},function(e){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0);return i.default.wrapError(e)})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t})(r.default);t.default=a});
define("odsp-next/actions/embed/odc/EmbedAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="Embed";n._isOneDriveXboxApp=o.isOneDriveXboxApp();return n}i.prototype.getExecutorPath=function(){return"./EmbedExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./EmbedExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!this._isOneDriveXboxApp&&e&&this.itemCommandHelper.isCommandSupported(e,s.embed)};return i})(i.default);t.default=u});
define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/DataSourceResourceKeys","../../../controls/commands/Commands.resx","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(t){n.__extends(o,t);function o(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="EmptyRecycleBin";n._urlDataSource=n.resources.consume(l.url);n._strings=c.default;n._usePollGetItemsForDeletion=e.usePollGetItemsForDeletion;n._currentItem=n.resources.consume(u.currentItem);return n}o.prototype.getExecutorPath=function(){return"./EmptyRecycleBinExecutor"};o.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./EmptyRecycleBinExecutor"],t,n)}))}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};o.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}};o.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,h.deleteAllItems)&&this._urlDataSource.isRecycleBin(t.queryType)&&t.childCount>0&&0===e.length};o.prototype.onExecute=function(e){var n=this;return this._usePollGetItemsForDeletion?t.prototype.onExecute.call(this,e):this.resources.consume(f.resourceKey).requestDialog({title:this._strings.emptyRecycleBin,component:{name:a.default.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return r.default.wrap(2)},isAvailable:this.createObservable(!0),icon:new i.default("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return r.default.wrap(3)},isAvailable:this.createObservable(!0),icon:new i.default("Cancel"),isDefault:!0}]}).wait().then(function(){return t.prototype.onExecute.call(n,e)}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return o})(o.default);t.default=p});
define("odsp-next/actions/feedback/odc/FeedbackAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(r,t);function r(n){void 0===n&&(n={});var r=t.call(this,n)||this;r.name="Feedback";r._executorLoader=new(r.managed(s.default))({path:"./FeedbackExecutor",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["./FeedbackExecutor"],t,n)}))},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r})(r.default);t.default=o});
define("odsp-next/actions/navigateToItem/NavigateToItemAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.name="NavigateToItem";r._urlDataSource=r.resources.consume(s.url);r._viewParams=r.resources.consume(i.viewParams);var u=t.item,a=t.itemSet,f=void 0===a?r.resources.consume(i.currentItemSet.optional):a,l=t.parentItem,c=t.forceAsFocusItem,h=void 0!==c&&c,p=t.isRedirect,d=void 0!==p&&p,v=t.forceInSameWindow,m=void 0!==v&&v,g=t.shouldPreserveAction,y=void 0!==g&&g;r._itemSet=f;r._parentItem=l;r._forceAsFocusItem=r.wrapObservable(h);r._isRedirect=d;r._forceInSameWindow=r.wrapObservable(m);r._shouldPreserveAction=r.wrapObservable(y);var b=n.itemSelectionHelperType,w=void 0===b?r.resources.consume(o.typeResourceKey):b;r._itemSelectionHelper=new(r.scope.attached(w))({overrideItem:u,allowMultiSelect:!1,canFallback:!0});r._url=r.createPureComputed(r._computeUrl);r._target=r.createPureComputed(r._computeTarget);var E=r.resources.consume(i.actionMap);r._navigationAction=new(r.managed(E.NavigationAction))({url:r._url,ignoreHistory:r._isRedirect,target:r._target});return r}t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:this._forceAsFocusItem(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""};t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return t})(r.default);t.default=u});
define("odsp-next/actions/sort/od/OneDriveSortAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./../SortAction","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","./SortActionMode"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Sort";n._sortManager=n.resources.consume(a.sortManager);n._currentItemSet=n.resources.consume(u.currentItemSet);n._mode=t.mode;n._column=t.column;n._ascending=t.ascending;return n}t.prototype.onExecute=function(e,t){var n=o.default.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=n);var r={sortMode:f.default[this._mode],sortAscending:"Ascending"};this._column&&(r.sortColumn=this._column.internalName||this._column.key);if(this._mode===f.default.Column)this.updateCurrentSort(this._column,n.isAscending);else if(this._mode===f.default.Order){if(this._currentItemSet&&this._currentItemSet().schema){r.sortAscending=this._ascending?"Ascending":"Descending";this.updateCurrentSort(n,this._ascending)}}else i.default.wrap({resultType:s.ResultTypeEnum.Failure});return i.default.wrap({resultType:s.ResultTypeEnum.Success,extraData:r})};t.prototype.onIsAvailable=function(){return!!this._currentItemSet&&(!this._isVaultLocked()&&!!o.default.getSortedColumn(this._currentItemSet().schema))};t.prototype.onIsToggled=function(){var e=!1;if(this._mode===f.default.Column&&this._column)e=this._column.isSorted;else if(this._mode===f.default.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=o.default.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return!this._isVaultLocked()&&e};t.prototype.updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};t.prototype._isVaultLocked=function(){var e=this._currentItemSet&&this._currentItemSet().item();return e&&e.vault&&e.vault.isLocked};return t})(r.default);t.default=l});
define("odsp-next/actions/sort/SortAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/PagesResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SortAction";n.isExecutionIntentional=!0;n._sortManager=n.resources.consume(o.sortManager);n._column=t.column;n._ascending=t.ascending;return n}t.getSortedColumn=function(e){var t,n=e();if(n)for(var r=0;r<n.length;r++)if(n[r]&&n[r].isSorted){t=n[r];break}return t};t.prototype.onExecute=function(e,t){this._updateCurrentSort(this._column,this._ascending);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){var e=!1;this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending);return e};t.prototype._updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};return t})(r.default);t.default=u});
define("odsp-next/resources/PagesResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortManager=new n.ResourceKey("sortManager");t.dataManager=new n.ResourceKey("dataManager");t.listViewContextMenuCommandSet=new n.ResourceKey("listViewContextMenuCommandSet");t.topCommandSet=new n.ResourceKey("topCommandSet");t.listViewContextMenuHelper=new n.ResourceKey("listViewContextMenuHelper");t.fileContent=new n.ResourceKey("fileContent");t.contentRange=new n.ResourceKey("contentRange");t.error=new n.ResourceKey("error");(function(e){(function(e){e.isLeftNavClosing=new n.ResourceKey("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new n.ResourceKey("base.leftNav.isLeftNavVisible");e.hideLeftNav=new n.ResourceKey("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new n.ResourceKey("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new n.ResourceKey("base.leftNav.toggleIsLeftNavUserExpanded")})(e.leftNav||(e.leftNav={}));(function(e){e.context=new n.ResourceKey("base.suiteNav.context");e.isTopBarVisible=new n.ResourceKey("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new n.ResourceKey("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new n.ResourceKey("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new n.ResourceKey("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new n.ResourceKey("base.suiteNav.isSuiteNavHidden")})(e.suiteNav||(e.suiteNav={}));(function(e){e.transclusionProvider=new n.ResourceKey("base.commandBar.transclusionProvider");e.isDarkTheme=new n.ResourceKey("base.commandBar.isDarkTheme");e.isSearchHidden=new n.ResourceKey("base.commandBar.isSearchHidden")})(e.commandBar||(e.commandBar={}));(function(e){e.isInfoPaneAvailable=new n.ResourceKey("base.infoPane.isInfoPaneAvailable");e.hidePreview=new n.ResourceKey("base.infoPane.hidePreview")})(e.infoPane||(e.infoPane={}));(function(e){e.isFiltersPaneAvailable=new n.ResourceKey("base.filtersPane.isFiltersPaneAvailable")})(e.filtersPane||(e.filtersPane={}));(function(e){e.isColumnCustomizationPaneExpanded=new n.ResourceKey("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new n.ResourceKey("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new n.ResourceKey("base.columnCustomizationPane.viewToFormat")})(e.columnCustomizationPane||(e.columnCustomizationPane={}));(function(e){e.isPhotosOnly=new n.ResourceKey("base.oneUpOverlay.isPhotosOnly")})(e.oneUpOverlay||(e.oneUpOverlay={}));(function(e){e.hasFooter=new n.ResourceKey("base.footer.hasFooter")})(e.footer||(e.footer={}));e.isSPLightSpeed=new n.ResourceKey("base.isSPLightSpeed");e.isScrollbarHidden=new n.ResourceKey("base.isScrollbarHidden");e.addPaddingBottom=new n.ResourceKey("base.addPaddingBottom");e.makeFlexBox=new n.ResourceKey("base.makeFlexBox");e.contextMenuHelper=new n.ResourceKey("base.contextMenuHelper");e.isRetrievingData=new n.ResourceKey("base.isRetrievingData");e.isSmartBannerVisible=new n.ResourceKey("base.isSmartBannerVisible")})(t.base||(t.base={}));(function(e){e.layoutType=new n.ResourceKey("files.layoutType");e.resx=new n.ResourceKey("files.resx");e.isArrangeControlVisible=new n.ResourceKey("files.isArrangeControlVisible")})(t.files||(t.files={}));(function(e){e.layoutType=new n.ResourceKey("photos.layoutType")})(t.photos||(t.photos={}));(function(e){e.layoutType=new n.ResourceKey("storageInfo.layoutType")})(t.storageInfo||(t.storageInfo={}));t.eventScope=new n.ResourceKey("eventScope")});
define("odsp-next/actions/sort/od/SortActionMode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Column=0]="Column";e[e.Order=1]="Order"})(n||(n={}));t.default=n});
define("odsp-next/actions/odc/OpenAction",["require","exports","tslib","../OpenAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../models/item/command/CoreItemCommandKeys","../base/ItemCommandHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../vault/VaultActionType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemCommandHelper=new(n.managed(u.default));n._skipVaultChecks=!!t.ignoreHistory;return n}t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,o.defaultClick)};t.prototype.onExecute=function(t,n){var r=this,o=this.item.peek();if(o&&o.vault&&!this._skipVaultChecks){var u=this.resources.consume(s.url),c=this.resources.consume(i.viewParams),h=u.getPageType(c.peek()),p=h===f.default.FilePicker||h===f.default.FolderPicker;if(o.vault.isLocked||p){var d=this.resources.consume(i.actionMap);return new(this.managed(d.VaultAction))({actionType:l.default.Unlock,item:this.item}).execute(null).then(function(i){if(i.resultType===a.ResultTypeEnum.Success)return e.prototype.onExecute.call(r,t,n)})}}return e.prototype.onExecute.call(this,t,n)};return t})(r.default);t.default=c});
define("odsp-next/actions/OpenAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../models/item/engagement/ItemEngagementParts","../models/item/OneDriveItem","../resources/ControlResourceKeys","../models/item/ItemType","./base/ItemSelectionHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=new u.default,p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Open";var i=t.item,s=t.openRelation,o=void 0===s?0:s,u=t.ignoreHistory,f=void 0!==u&&u,c=t.itemSet,h=t.openLocal,p=void 0!==h&&h,d=t.focusUrl,v=void 0!==d&&d,m=t.preserveAction,g=void 0!==m&&m,y=t.nonFoldersOnly,b=void 0!==y&&y;r._openRelation=o;r._nonFoldersOnly=b;r._focusUrl=r.wrapObservable(v);r._itemSelectionHelper=new(r.child(l.typeResourceKey))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});r.item=r.createComputed(r._computeItem,{deferEvaluation:!0,pure:!0});var w=r.resources.consume(a.actionMap);r._navigateToItemAction=new(r.managed(w.NavigateToItemAction))({item:r.item,itemSet:c,parentItem:r._itemSelectionHelper.currentItem,forceAsFocusItem:r.createPureComputed(r._computeForceAsFocusItem),forceInSameWindow:p,isRedirect:f,shouldPreserveAction:g});return r}t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()};t.prototype.onExecute=function(e,t){var n=this.item.peek();if(!n)return i.default.resolve({resultType:s.ResultTypeEnum.ExpectedFailure});n.type===f.default.Folder&&t&&t.data&&(t.data.folder=!0);t.data.extraData||(t.data.extraData={});c.extend(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0});return this._navigateToItemAction.execute(e).then(function(){var e={fileType:f.default[n.type||f.default.Unknown],extension:n.extension||""};return i.default.resolve({resultType:s.ResultTypeEnum.Success,extraData:e})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(o.itemEngagementPart,{item:this.item.peek()})};t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case f.default.File:e.prototype.trackUserAction.call(this,"Open.File");break;case f.default.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}};t.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e||h};t.prototype._computeForceAsFocusItem=function(){return this._focusUrl()};return t})(r.default);t.default=p});
define("odsp-next/actions/vault/VaultActionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"})(n||(n={}));t.default=n});
define("odsp-next/actions/preview/PreviewAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../base/ItemSelectionHelper","../../dataSources/url/QueryType","../../models/item/engagement/ItemEngagementParts","../../models/item/ItemParentHelper","../../utilities/uri/EnvironmentHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var r=n.resources.consume(i.actionMap);n._dataStore=new s.default("",o.default.local);n._itemSelectionHelper=new(n.child(u.typeResourceKey))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1});n._openAction=new(n.managed(r.OpenAction))({focusUrl:n.observables.compute(n._computeFocusUrl),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0});n._itemParentHelper=n.resources.consume(l.resourceKey);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=null;e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")));return e&&!e.external&&this._openAction.isAvailable()&&(!c.isGallatin()||e.queryType!==a.default.SharedWithMe)&&(!t||!t.list||t.list.isDocumentLibrary)};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date);return this._openAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(f.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeFocusUrl=function(){var e=this._itemSelectionHelper.firstItem();return!(e&&e.queryType===a.default.Recent)};return t})(r.default);t.default=h});
define("odsp-next/utilities/uri/EnvironmentHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isGallatin=function(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3};t.isBlackForest=function(e){return e?"blackforest"===e:location.origin.indexOf(".de")===location.origin.length-3};t.isGovernmentTenant=function(e){return"pathfinder"===e||"trailblazer"===e};t.isPPE=function(e){return"prodbubble"===e};t.isGCCLow=function(e){return"US_2_Content"===e||"US_86_Content"===e||"US_96_Content"===e||"US_105_Content"===e}});
define("odsp-next/actions/odc/OpenInOfficeClientAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./SkyApiHelper","../base/ItemRedeemer","./OfficeActionIdMap","../base/ItemCommandHelper","../../resources/ODCResourceKeys","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../base/ItemSelectionHelper","../../models/item/command/OfficeItemCommandKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";var y;Object.defineProperty(t,"__esModule",{value:!0});var b=((y={})[1]=l.default.Excel,y[2]=l.default.OneNote,y[3]=l.default.PowerPoint,y[4]=l.default.Word,y[5]=l.default.Visio,y[6]=l.default.Project,y[7]=l.default.Publisher,y),w=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInOfficeClient";r._itemReedemer=r.resources.consume(f.resourceKey);r._navigation=r.resources.consume(o.navigation);r._platform=r.resources.consume(u.platformDetection);r._itemCommandHelper=new(r.managed(c.default));r._urlDataSource=r.resources.consume(h.urlDataSource);r._isOneDriveXboxApp=g.isOneDriveXboxApp();r._itemSelectionHelper=new(r.child(v.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();return(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)&&!this._isOneDriveXboxApp&&!!t&&this._itemCommandHelper.isCommandSupported(t,m.openInClient)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,o=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];t.data.extraData||(t.data.extraData={});i.extend(t.data.extraData,{fileType:e.extension?e.extension.toLowerCase():void 0});return[2,this._itemReedemer.redeemItem(e,this).then(function(){if(o._platform.isMobile){var t=o._navigation,n=o._urlDataSource;t.navigateTo(n.getOpenInOfficeClientUrl(e,o._navigation.viewParams,p.default.viewerId));return{resultType:s.ResultTypeEnum.Success}}var r=o._itemCommandHelper.getCommandBehavior(e,m.openInClient),i=b[r];return a.openInClient(e,p.default.viewerId,!!e.isGroup,l.default[i],o.resources)})]}})})};return t})(d.default);t.default=w});
define("odsp-next/actions/OpenPdfInBrowserAction",["require","exports","tslib","./base/ItemCommandHelper","./base/ItemSelectionHelper","../base/BaseAction","../models/item/command/FileSystemItemCommandKeys","../resources/ControlResourceKeys","../resources/DataSourceResourceKeys","../utilities/item/ListItemTypeConverter","../utilities/browser/WebViewDetector","./OpenInDesktopAction","../models/item/engagement/ItemEngagementParts"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var s=n,o=s.observables,f=s.resources;n._itemCommandHelper=f.consume(r.resourceKey);n._itemSelectionHelper=new(n.child(i.typeResourceKey))({overrideItem:t.item});n._urlDataSource=f.consume(a.url);var h=o.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),p=f.consume(u.actionMap);n._navigationAction=new(n.managed(p.NavigationAction))({url:h,target:"_blank"});l.isOneDriveWinApp()&&(n._openInDesktopAction=new(n.managed(p.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:c.DesktopActionType.OpenPdfInBrowser}));return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&(!!e&&f.canListItemBeOpened(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,o.openPdfInBrowser)&&".pdf"===e.extension.toLowerCase())};t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};return t})(s.default);t.default=p});
define("odsp-next/utilities/item/ListItemTypeConverter",["require","exports","@ms/odsp-datasources/lib/Permissions"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertToISPListItem=function(e){return e};t.convertToIOneDriveItem=function(e){return e};t.canListItemBeOpened=function(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.openItems)}});
define("odsp-next/actions/odc/OpenInOfficeOnlineAction",["require","exports","tslib","cookies","../OpenInOfficeOnlineAction","./SkyApiHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/url/QueryType","../../dataSources/url/odc/UrlDataSource","../../models/item/command/OfficeItemCommandKeys","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.onIsAvailable=function(){var e=this.item();return!!e&&((e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,f.openOnline))&&e.queryType!==u.default.RecycleBin)};t.prototype.onExecute=function(t,n){var i=this.item.peek();i.queryType!==u.default.Search&&s.refreshItemWhenVisible(i.parent.isStub?i:i.parent,this.resources,!0);n.data.extraData||(n.data.extraData={});l.extend(n.data.extraData,{fileType:i.extension?i.extension.toLowerCase():void 0});r.set("BP",o.serializeQuery({FR:"SDX.Skydrive*Root",ST:(new Date).getTime()}),{domain:a.default.getCookieDomain()});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return e.prototype.onExecute.call(this,t,n)};return t})(i.default);t.default=c});
define("odsp-next/actions/OpenInOfficeOnlineAction",["require","exports","tslib","../base/BaseAction","../models/item/engagement/ItemEngagementParts","../resources/DataSourceResourceKeys","./base/ItemCommandHelper","../models/item/command/OfficeItemCommandKeys","./base/ItemSelectionHelper","../resources/ControlResourceKeys","../utilities/browser/WebViewDetector","../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var r=t.openLocal,i=void 0!==r&&r,u=t.forceReadOnly,h=void 0!==u&&u,p=t.useDefaultAction,d=void 0!==p&&p;n._forceReadOnly=h;n._useDefaultAction=d;n._urlDataSource=n.resources.consume(s.url);n._viewParams=n.resources.consume(f.viewParams);n._itemSelectionHelper=new(n.child(a.typeResourceKey))({overrideItem:t.item});n._itemCommandHelper=n.resources.consume(o.resourceKey);n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var v=!1;c.default.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(v=l.isTeamsWebView());var m=n.resources.consume(f.actionMap);n._navigationAction=new(n.managed(m.NavigationAction))({url:n._url,target:i||v?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}});return n}t.prototype._postProcessUrl=function(e){return e};t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,u.openOnline)&&this._navigationAction.isAvailable()};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(i.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return t})(r.default);t.default=h});
define("odsp-next/actions/openInTextEditor/OpenInTextEditorAction",["require","exports","tslib","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/BaseAction","../../resources/DataSourceResourceKeys","../../utilities/mime/MimeHelper","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/FileSystemItemCommandKeys","../../models/item/engagement/ItemEngagementParts","../../resources/ControlResourceKeys","../../dataSources/url/QueryType","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.name="OpenInTextEditor";var o=i.resources,f=n.urlDataSource,l=void 0===f?o.consume(s.url):f,h=n.viewParams,d=void 0===h?o.consume(c.viewParams):h,v=n.itemCommandHelper,m=void 0===v?o.consume(a.resourceKey):v,g=n.platformDetection,y=void 0===g?o.consume(r.platformDetection):g,b=n.actionMap,w=void 0===b?o.consume(c.actionMap):b;i._urlDataSource=l;i._viewParams=d;i._itemCommandHelper=m;i._platformDetection=y;i._url=i.createPureComputed(i._computeUrl);i._itemSelectionHelper=new(i.child(u.typeResourceKey))({overrideItem:t.item});i._navigationAction=new(i.managed(w.NavigationAction))({url:i._url,target:"_blank"});i._isOneDriveWinApp=p.isOneDriveWinApp();return i}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n);return this._itemCommandHelper.isCommandSupported(e,f.openInTextEditor)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&!!e.parent&&o.canOpenItemInMonaco(e)&&r!==h.default.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&4!==e.itemStatus&&3!==e.itemStatus};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(l.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.parent?this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this._itemSelectionHelper.currentItem(),viewParams:this._viewParams()}):""};return t})(i.default);t.OpenInTextEditorAction=d;t.default=d});
define("odsp-next/actions/orderPrints/odc/OrderPrintsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","@ms/odsp-datasources/lib/Permissions","../../../dataSources/url/QueryType","../../../dataSources/url/SearchTypeChecker","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/templates/ExecutorAction","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(t){n.__extends(l,t);function l(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="OrderPrints";n._platformDetection=n.resources.consume(f.platformDetection);n._identity=n.resources.consume(i.identity).getIdentity();n._isOneDriveXboxApp=c.isOneDriveXboxApp();return n}l.prototype.getExecutorPath=function(){return"./OrderPrintsExecutor"};l.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./OrderPrintsExecutor"],t,n)}))}};l.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};l.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};l.prototype.onIsAvailable=function(){if(!s.isFeatureEnabled(s.EnableOrderPrints))return!1;if(this._identity.type===o.IdentityType.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,n=e&&e.queryType,r=n===u.default.Files||n===u.default.Photos||a.isSearchType(n)||n===u.default.AllMyPhotos||n===u.default.SharedWithMe;return!(!t||!r||this._isOneDriveXboxApp)&&(this._identity.type!==o.IdentityType.aad&&e.photo&&t>=1&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac)};return l})(l.default);t.default=h});
define("odsp-next/actions/odc/PlayAudioAction",["require","exports","tslib","../base/ItemSelectionHelper","../../base/BaseAction","../../dataSources/url/QueryType","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PlayAudio";var i=n.resources.consume(o.actionMap),s=n.observables;n._item=new(n.child(r.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}).firstItem;var u=new(n.managed(i.OpenAction))({focusUrl:s.pureCompute(n._computeFocusUrl),item:t.item,nonFoldersOnly:!0});n._action=u;return n}t.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()};t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype._computeFocusUrl=function(){var e=this._item();return!(e&&e.queryType===s.default.Recent)};return t})(i.default);t.default=u});
define("odsp-next/actions/odc/PlaySlideShowAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="PlaySlideShow";r._slideshowState=r.resources.consume(s.slideshowState);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e,t,n=this._itemSelectionHelper.firstItem(),r=!(!a.isFeatureEnabled(a.EnableLivePhotoVideos)||!(null===(t=null===(e=n)||void 0===e?void 0:e.photo)||void 0===t?void 0:t.isLivePhoto));return!(!n||!n.photo||r||this._slideshowState.isSlideShowModeEnabled())};t.prototype.onExecute=function(e,t){this._slideshowState.isSlideShowModeEnabled(!0);return this._slideshowState.enterSlideshowMode()?r.default.resolve({resultType:i.ResultTypeEnum.Success}):r.default.resolve({resultType:i.ResultTypeEnum.Failure})};return t})(o.default);t.default=f});
define("odsp-next/actions/odc/StopSlideShowAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="StopSlideShow";r._slideshowState=r.resources.consume(s.slideshowState);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){return!!this._itemSelectionHelper.firstItem()&&this._slideshowState.isSlideShowModeEnabled()};t.prototype.onExecute=function(e,t){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?r.default.resolve({resultType:i.ResultTypeEnum.Success}):r.default.resolve({resultType:i.ResultTypeEnum.Failure})};return t})(o.default);t.default=a});
define("odsp-next/actions/odc/RemoveCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../../dataSources/url/QueryType","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../base/ItemSelectionHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveCoverPhotoAction";r._itemReedemer=r.resources.consume(s.resourceKey);r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this;return this._itemSelectionHelper.currentItem().queryType!==o.default.SharedWithMe&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,c.removeAsCoverPhoto)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t.resources.consume(f.resourceKey),r=e[0].parent;return n.removeCoverPhotos({items:e,target:r}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(a.default);t.default=h});
define("odsp-next/actions/RemoveFromRecentAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/mruRecent/MruRecentProvider","./base/ItemSelectionHelper","../resources/DataSourceResourceKeys","../utilities/features/Features","./base/ItemCommandHelper","../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromRecent";r._urlDataSource=r.resources.consume(a.url);r._itemCommandHelper=new(r.managed(l.default));r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!f.isFeatureEnabled(f.MruToMruPlusPlusSkyApi),canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this._itemSelectionHelper.currentItem().key),t=this._urlDataSource.getQueryType(e),n=this._itemSelectionHelper.firstItem();return t===s.default.Recent&&!!n&&this._itemCommandHelper.isCommandSupported(n,c.removeFromRecent)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();return n.resources.consumeAsync(o.resourceKey).then(function(t){return t.removeFromRecent({parentKey:r.key,items:e})})}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t})(r.default);t.default=h});
define("odsp-next/providers/mruRecent/MruRecentProvider",["require","exports","tslib","../item/ItemProvider","../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-microservice/lib/microService/helpers/PdfSupport","@ms/sp-resource-path","@ms/odsp-utilities/lib/list/SharingType","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._dataSource=n.mruRecentDataSource;r._itemProvider=n.itemProvider;var i=n.location,s=void 0===i?window.location:i;r._origin=new a.SPResourcePath(s.href).authority;return r}t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)};t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()};t.prototype.removeFromRecent=function(e){var t=this;return i.isFeatureEnabled(i.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){t._itemProvider.invalidateItem(e.parentKey);return n}):this._itemProvider.removeFromRecent(e)};t.prototype.recordDocumentView=function(e){var t=e.graph,r=new a.SPResourcePath(e.openUrl),i=""+(r.authority||this._origin)+r.path,s=e.sharingType,o=e.dateCreatedTime,u=e.dateModifiedTime,l=e.mruState,c=e.properties,d=void 0===c?{}:c,v=d.editorName,m=void 0===v?[]:v,g=d.creatorName,y=void 0===g?[]:g,b=l&&l.mruId,w=m[0],E=y[0],S=n.__assign(n.__assign(n.__assign(n.__assign({category:"Document",type:"DocumentUrl",app:h(e),url:i},(function(e){var t=e.name,n=e.extension,r=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp("."+r+"$"),""):t),extension:r}})(e)),{file_size:e.size}),b?{mru_id:b}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.parent&&e.parent.graph&&e.parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId}),{sharing_info:{state:"number"==typeof s&&s<f.default.Private?1:0},modification_info:p(w,u),creation_info:p(E,o)});return this._dataSource.recordDocumentView(e,S)};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{itemProvider:r.resourceKey,mruRecentDataSource:l.mruRecent});return t})(s.default);t.default=c;function h(e){return u.canRenderNative(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function p(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}t.resourceKey=o.createResolvedResourceKey(e("module").id,c)});
define("@ms/odsp-microservice/lib/microService/helpers/PdfSupport",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["ai","pdf"],r=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],i=["dwg","dxf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e,t){return s(r,e)||!!t&&s(i,e)};t.canRenderNative=function(e){return s(n,e)}});
define("odsp-next/actions/odc/RemoveTagAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../base/ItemCommandHelper","../../resources/ControlResourceKeys","../../base/BaseAction","../../resources/ProviderResourceKeys","../../models/item/command/PhotoItemCommandKeys","../base/ItemSelectionHelper","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTag";r._tag=t.tag;r._itemReedemer=r.resources.consume(s.resourceKey);r._itemCommandHelper=new(r.managed(o.default));r._itemSet=r.resources.consume(u.currentItemSet);r._tagProvider=r.resources.consume(f.tag);r._itemSelectionHelper=new(r.child(c.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this;return h.isFeatureEnabled(h.EnableTagsInODC)&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,l.removeTags)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t._tag.peek(),r=t.resources.consume(f.photo).getAllPhotosSettings().peek();return t._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[n],parentKey:t._itemSet.peek().key,rootItemId:r.rootId}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(a.default);t.default=p});
define("odsp-next/actions/rename/odc/RenameAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(i,t);function i(e){var n=t.call(this,e)||this;n.name="Rename";return n}i.prototype.getExecutorPath=function(){return"./RenameExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./RenameExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,s.rename)};return i})(i.default);t.default=o});
define("odsp-next/actions/restore/RestoreAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../base/ItemCommandHelper","../../resources/DataSourceResourceKeys","../../models/item/command/FileSystemItemCommandKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restoreItemsOperatorTypeResourceKey=new l.ResourceKey({name:e("module").id+".restoreItemsOperator",loader:new l.AliasResourceLoader(function(){return o.default.resolve(new Promise(function(t,n){e(["./RestoreItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var c=(function(e){n.__extends(r,e);function r(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(a.url);n._itemSelectionHelper=new(n.child(i.typeResourceKey))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(u.default));return n}r.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(n))&&this._itemCommandHelper.isCommandSupported(e,f.restoreItem)};r.prototype.onExecute=function(e){var n=this,r=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return n.resources.consumeAsync(t.restoreItemsOperatorTypeResourceKey).then(function(t){var i=new t({parentKey:r,items:e});n.trackPromise(i.start());return i.wait()})}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return r})(r.default);t.RestoreAction=c;t.default=c});
define("odsp-next/actions/restoreAll/odc/RestoreAllAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RestoreAll";n._itemCommandHelper=new(n.managed(s.default));n._currentItem=n.resources.consume(u.currentItem);return n}i.prototype.getExecutorPath=function(){return"./RestoreAllExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./RestoreAllExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&t.childCount>0&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,o.restoreAllItems)};return i})(i.default);t.default=a});
define("odsp-next/actions/rotate/RotateAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","../base/ItemCommandHelper","../base/ItemRedeemer","../../models/item/command/PhotoItemCommandKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/Rotation"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rotateItemsOperatorTypeResourceKey=new l.ResourceKey({name:e("module").id,loader:new l.AliasResourceLoader(function(){return f.default.resolve(new Promise(function(t,n){e(["./RotateItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var h=(function(e){n.__extends(r,e);function r(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(s.typeResourceKey))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(o.default));n._itemRedeemer=n.resources.consume(u.resourceKey);return n}r.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,a.rotate)};r.prototype.onExecute=function(e){var n=this,r=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return n._itemRedeemer.redeemItems(e,n).then(function(){return n.resources.consumeAsync(t.rotateItemsOperatorTypeResourceKey)}).then(function(t){var i=new t({items:e,parentKey:r,rotation:c.default.right});return n.trackPromise(i.start())})}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return r})(r.default);t.RotateAction=h;t.default=h});
define("@ms/odsp-shared/lib/base/Rotation",["require","exports","tslib","@ms/utilities-image/lib/Rotation","@ms/utilities-image/lib/Rotation"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/utilities-image/lib/Rotation",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"})(n=t.Rotation||(t.Rotation={}));t.default=n});
define("odsp-next/actions/odc/SaveSortOrderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../sort/SortAction","../../dataSources/item/odc/SortFieldMap","../../dataSources/item/odc/SortDirectionMap","../../dataSources/url/QueryType","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SaveSort";n._item=n.resources.consume(o.currentItem);n._currentItemSet=n.resources.consume(o.currentItemSet);return n}t.prototype.onExecute=function(e,t){var n=u.default.getSortedColumn(this._currentItemSet().schema);if(!n)return i.default.wrapError({resultType:s.ResultTypeEnum.Failure});var r=n.isAscending,o=a.default[n.internalName||n.key].toString(),l=null===r?f.default.defaultValue.toString():r?f.default.ascending.toString():f.default.descending.toString();return this.resources.consume(c.resourceKey).saveSortOrder({sortOrder:o,sortDirection:l,item:this._item()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return!(e&&e.vault&&e.vault.isLocked)&&(t===l.default.Files||t===l.default.Photos)};return t})(r.default);t.default=h});
define("odsp-next/actions/SetFocusAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetFocus";n._selector=t.selector;n._shouldClick=t.shouldClick;return n}t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);if(n){n.focus();this._shouldClick&&s.default.clickElement(n)}return i.default.wrap({resultType:o.ResultTypeEnum.Success})};return t})(r.default);t.default=u});
define("odsp-next/actions/shareByLink/odc/ShareByLinkAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../base/templates/ExecutorAction","../../../dataSources/url/QueryType","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(s,t);function s(e){var n=t.call(this,e)||this;n.sharingMethod=e&&e.sharingMethod?e.sharingMethod:null;n._alreadyRedeemed=e&&e.alreadyRedeemed?e.alreadyRedeemed:null;n.name="ShareByLink";n._urlDataSource=n.resources.consume(i.url);n._itemCommandHelper=new(n.managed(a.default));return n}s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,n=t>1&&e.queryType===o.default.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return(this._itemCommandHelper.isCommandSupported(e,u.share)||e.vault)&&!n&&!r&&!i&&this._allItemsSupportShare()};s.prototype.getExecutorPath=function(){return"./ShareByLinkExecutor"};s.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./ShareByLinkExecutor"],t,n)}))}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};s.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}};s.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r){var i=r();if(!i)return!0;if(!this._itemCommandHelper.isCommandSupported(i,u.share)&&(!i.vault||i.vault.isLocked))return!1}}return!0};return s})(s.default);t.default=f});
define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="ShowKeymap";r._executorLoader=new(r.managed(s.default))({path:"./ShowKeyboardMapExecutor",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["./ShowKeyboardMapExecutor"],t,n)}))},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r})(r.default);t.default=o});
define("odsp-next/actions/showOperations/ShowOperationsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../../providers/operation/OperationProvider","../../models/operation/OperationState"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._operationProvider=n.resources.consume(o.resourceKey);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==u.default.expired,isToggled:this._operationProvider.isLocked()}};return t})(i.default);t.ShowOperationsHandler=a;var f=s.create({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./ShowOperationsExecutor"],t,n)}))}}},handlerType:a});t.default=f});
define("odsp-next/actions/showPermissions/ShowPermissionsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","ODCOneDrive_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._itemSelectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});n._itemCommandHelper=n.resources.consume(u.resourceKey);n.engagementSource=t.engagementSource;return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this._itemCommandHelper.isCommandSupported(e,a.share);return{isAvailable:!!e&&t}};return t})(i.default);t.ShowPermissionsHandler=f;var l=s.create({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./ShowPermissionsExecutor"],t,n)}))}}},handlerType:f});t.default=l});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","ODCOneDrive_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:!0}};return t})(i.default);t.ShowSuggestedFilesHandler=o;var u=s.create({name:"ShowSuggestedFiles",source:{moduleDefinition:{path:"./ShowSuggestedFilesExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./ShowSuggestedFilesExecutor"],t,n)}))}}},handlerType:o});t.default=u});
define("odsp-next/actions/ShowPropertiesAction",["require","exports","tslib","../base/BaseAction","../controls/detailsPane/IsDetailsPaneExpanded","../controls/filtersPane/IsFiltersPaneExpanded","@ms/odsp-utilities/lib/async/Promise","./base/ItemSelectionHelper","../resources/PagesResourceKeys","../resources/ControlResourceKeys","../resources/LoggingResourceKeys","../providers/engagement/Engagement","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/events/EventGroup","../dataSources/url/QueryType","../utilities/logging/EventQos"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowProperties";var o=n.isInfoPaneExpanded,h=void 0===o?r.resources.consume(i.resourceKey):o,p=n.isSharingSectionExpanded,d=void 0===p?r.resources.consume(f.isSharingSectionExpanded.optional):p,v=n.isInfoPaneAvailable,m=void 0===v?r.resources.consume(a.base.infoPane.isInfoPaneAvailable.optional):v,g=n.isFiltersPaneExpanded,y=void 0===g?r.resources.consume(s.resourceKey):g,b=n.isColumnCustomizationPaneExpanded,w=void 0===b?r.resources.consume(a.base.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):b,E=n.rumOneHelper,S=void 0===E?r.resources.consume(l.rumOneHelper.optional):E,x=n.itemSelectionHelperType,T=void 0===x?r.resources.consume(u.typeResourceKey):x,N=n.engagement,C=void 0===N?r.resources.consume(c.resourceKey):N,k=t.useToggleBehavior,L=void 0!==k&&k,A=t.isSharingSectionExpanded,O=void 0!==A&&A,M=t.allowMultiSelect,_=void 0!==M&&M;r._isInfoPaneExpanded=h;r._isSharingSectionExpanded=d;r._isInfoPaneAvailable=m||r.observables.create(!0);r._isFiltersPaneExpanded=y;r._isColumnCustomizationPaneExpanded=w;r._rumOneHelper=S;r._useToggleBehavior=L;r._allowMultiSelect=_;r._shouldExpandSharingSection=O;r._itemSelectionHelper=new(r.scope.attached(T))({allowMultiSelect:r._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});r._engagement=C;return r}t.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);var t=!this._useToggleBehavior||!this._isInfoPaneExpanded.peek();t&&v.init("LaunchInfoPane");this._engagement.logData({name:"DetailsPane.Click."+(t?"Open":"Close"),isIntentional:!0});this._isInfoPaneExpanded(t);p.default.raise(document.body,"resize",void 0,!0);return o.default.wrap({resultType:h.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._isInfoPaneAvailable();if(this._useToggleBehavior&&this._isInfoPaneExpanded())return!0;if(!e)return!1;var t=this._itemSelectionHelper.firstItem;if(!t())return!1;var n=[t];this._allowMultiSelect&&(n=this._itemSelectionHelper.selection());for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s){var o=s();if(o&&(o.error||o.isPlaceholder&&o.queryType!==d.default.Search))return!1}}return!0};t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};return t})(r.default);t.ShowPropertiesAction=m;t.default=m});
define("odsp-next/controls/detailsPane/IsDetailsPaneExpanded",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","./DetailsPaneId"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".isDetailsPaneExpanded",factory:{dependencies:{detailsPaneId:i.resourceKey,observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/controls/detailsPane/DetailsPaneId",["require","exports","@ms/odsp-utilities/lib/resources/Resources","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".detailsPaneId",factory:{dependencies:{},create:function(){return{instance:r.getId("DetailsPane-")}}}})});
define("odsp-next/controls/filtersPane/IsFiltersPaneExpanded",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".isFiltersPaneExpanded",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/utilities/logging/EventQos",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};function i(e){return r[e]}function s(e,t){r[e]=t}t.init=function(e){var t=i(e);if(t){t.end({resultType:n.ResultTypeEnum.Failure});t=void 0}if(!t){var r={name:e};s(e,t=new n.Qos(r))}return t};t.logSuccess=function(e){o(e,n.ResultTypeEnum.Success)};t.logUnexpectedFailure=function(e){o(e,n.ResultTypeEnum.Failure)};t.logExpectedFailure=function(e){o(e,n.ResultTypeEnum.ExpectedFailure)};function o(e,t){var n=i(e);if(n){n.end({resultType:t});s(e,void 0)}}});
define("odsp-next/actions/ShowSelectionAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","../dataSources/url/PageType","../controls/list/react/SelectionManager","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowSelection";r._urlDataSource=r.resources.consume(o.url);r._isSelectionModal=r.resources.consume(a.isSelectionModalResourceKey);r._itemSelectionHelper=new(r.child(f.typeResourceKey))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){return(this._itemSelectionHelper.selection().length>0||this._isSelectionModal())&&this._urlDataSource.getPageType()!==u.default.TextFileEditor};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();this._isSelectionModal(!1);return i.default.resolve({resultType:s.ResultTypeEnum.Success})};return t})(r.default);t.default=l});
define("odsp-next/controls/list/react/SelectionManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/interfaces","office-ui-fabric-react/lib/utilities/selection/Selection","../../../models/store/ItemsStore","../../../resources/UtilityResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,o=r.observables;r._selectionModel=n.itemSetSelectionModel;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r._itemsStore=n.itemsStore;var u=r.selection=new s.Selection({selectionMode:1===r._selectionModel.mode?i.SelectionMode.single:i.SelectionMode.multiple,onSelectionChanged:r._onSelectionChange.bind(r),getKey:r.getKey.bind(r),canSelectItem:r._canSelectItem.bind(r)});r._isModal=o.create(!!u.isModal&&u.isModal());o.compute(r._computeUpdateItems);o.backgroundCompute(r._computeUpdateReactSelection);r.isModal=o.compute({read:function(){return r._isModal()},write:function(e){return u&&u.setModal(e)},pure:!0});return r}t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem(""+e.key))||""+t};t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,r=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1);n.setAllSelected(!1);for(var i=0,s=r;i<s.length;i++){var o=s[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})};t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var r=0,i=e.selection();r<i.length;r++){var s=i[r];if(!t.isKeySelected(e.getItemKey(s))){n=!0;break}}return n};t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;e._isModal(!!n.isModal&&n.isModal());if(e._shouldUpdateSelection()){if(n.mode===i.SelectionMode.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var r=[],s=0,o=n.getSelection();s<o.length;s++){var u=o[s],a=e.getKey(u);r.push(a)}t.setSelectedKeys(r)}var f=e._clientSideExtensionHelper;f&&f.raiseListChangeEvent(n.getSelection())}})};t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var r=0,i=t.content().items;r<i.length;r++){var s=i[r],o=this.observables.peekUnwrap(s);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var r=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||r&&r.isStub)&&e.selection.setItems(n,!1)})};t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})};return t})(r.default);t.SelectionManager=l;t.selectionManagerResourceKey=new f.ResourceKey({name:e("module").id+".selectionManager",factory:new f.ResolvedResourceFactory(l,n.__assign(n.__assign({},r.default.dependencies),{itemSetSelectionModel:a.itemsSelection,clientSideExtensionHelper:u.clientSideExtensionHelper.optional,itemsStore:o.resourceKey}))});t.getKeyResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}});t.selectionModeResourceKey=new f.ResourceKey({name:e("module").id+".selectionMode",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?i.SelectionMode.multiple:i.SelectionMode.single}}}});t.isSelectionModalResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.isModal}}}});t.resourceKey=new f.ResourceKey({name:e("module").id,factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.selection}}}});t.hasSelectionResourceKey=new f.ResourceKey({name:e("module").id+".hasSelection",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection,isSelectionModal:t.isSelectionModalResourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,r=e.isSelectionModal;return{instance:t.pureCompute(function(){return r()||n.selectedCount()>0}),disposable:t}}}})});
define("office-ui-fabric-react/lib/utilities/selection/interfaces",["require","exports","@uifabric/utilities"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CHANGE=n.SELECTION_CHANGE;t.SelectionDirection=n.SelectionDirection;t.SelectionMode=n.SelectionMode});
define("office-ui-fabric-react/lib/utilities/selection/Selection",["require","exports","@uifabric/utilities"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Selection=n.Selection});
define("odsp-next/actions/toggleListLayout/odc/ToggleListLayoutAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","../../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../ToggleListLayoutHelper","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil","../../../models/itemsScope/ItemsScopeFeature.key","../../../models/item/VirtualItemType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ToggleListLayout";n._layoutType=o.getValidLayout(t.layoutType);n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter;n._currentItem=n.resources.consume(u.currentItem);n._viewParams=n.resources.consume(u.viewParams);n._actionMap=n.resources.consume(u.actionMap);n._urlDataSource=n.resources.consume(l.url);n._helper=new(n.managed(f.default));return n}t.prototype.onIsAvailable=function(){var e=this.resources.consume(h.isItemsScopeEnabledInAllPhotosPivotResourceKey),t=this._currentItem(),n=t&&t.queryType,r=t.key!==this._urlDataSource.getRootItemKey(s.default.SharedWithMe)&&n!==s.default.DocsInCommon;e||(r=r&&n!==s.default.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),u=t.virtualItemType!==p.default.Album;this._layoutType===o.SingleAlbum&&(u=n===s.default.Files);e&&n===s.default.AllMyPhotos&&(u="allmyphotos"===i.qt&&!i.tagFilter&&!i.locationFilter&&!i.onThisDay);"allmyphotos"===i.qt&&(u=this._layoutType!==o.Details&&this._layoutType!==o.CompactDetails);return r&&u};t.prototype.onExecute=function(e,t){var n,i=this;if(this._shouldClearContextualFilter){var s=c.extend({},this._viewParams.peek());delete s.ft;n=new(this.managed(this._actionMap.NavigationAction))({url:"#"+a.serializeQuery(s)}).execute(e)}else n=r.default.wrap();return n.then(function(){return i._helper.changeLayout(i._layoutType)},function(){return i._helper.changeLayout(i._layoutType)})};t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()};return t})(i.default);t.default=d});
define("odsp-next/controls/list/layouts/LayoutType",["require","exports","../../../utilities/features/Features","../../../utilities/loader/ComponentLoader"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Albums="ms-albums-list";t.AllPhotos=n.isFeatureEnabled(n.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list";t.CustomGridList="ms-grid-customlist";t.CustomList="ms-details-customlist";t.Details="ms-details-list";t.CompactDetails="ms-compact-details-list";t.Grid=n.isFeatureEnabled(n.UseTilesList)?"od-tiles-list":"ms-grid-list";t.SingleAlbum="ms-single-album-list";t.TagGrid="od-tag-grid";t.TagsList="od-tags-list";t.DocumentCardsGrid="od-doccard-grid";t.SharedGrid="od-shared-grid-list";t.SitesGrid="od-sites-grid-list";t.Path={"ms-albums-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../AlbumsList"],t,n)})}),"od-tiles-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../TilesList"],t,n)})}),"ms-all-photos-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../AllPhotosList"],t,n)})}),"ms-grid-customlist":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../CustomGridList"],t,n)})}),"ms-details-customlist":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../CustomList"],t,n)})}),"ms-details-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../DetailsList"],t,n)})}),"ms-compact-details-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../CompactDetailsList"],t,n)})}),"ms-grid-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../GridList"],t,n)})}),"ms-single-album-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../SingleAlbumList"],t,n)})}),"od-tag-grid":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../TagGrid"],t,n)})}),"od-tags-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../TagsList"],t,n)})}),"od-doccard-grid":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../DocumentCardsGridList"],t,n)})}),"od-shared-grid-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../SharedGridList"],t,n)})}),"od-sites-grid-list":r.withLoaderCache(function(){return new Promise(function(t,n){e(["../SitesGridList"],t,n)})})};t.getValidLayout=function(e,n){var r=n&&n.isCustomList,i=n&&n.isPlaceholder;switch(e){case t.Albums:return t.Albums;case t.AllPhotos:return t.AllPhotos;case t.CustomGridList:return i?e:r?t.CustomGridList:t.Grid;case t.CustomList:case t.Details:return i?e:r?t.CustomList:t.Details;case t.CompactDetails:return t.CompactDetails;case"ms-grid-list":case"od-tiles-list":case t.Grid:return i?e:r?t.CustomGridList:t.Grid;case t.SingleAlbum:return t.SingleAlbum;case t.TagGrid:return t.TagGrid;case t.TagsList:return t.TagsList;case t.DocumentCardsGrid:return t.DocumentCardsGrid;case t.SharedGrid:return t.SharedGrid;case t.SitesGrid:return t.SitesGrid;default:return r?t.CustomList:t.Details}}});
define("odsp-next/actions/toggleListLayout/ToggleListLayoutHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/list/layouts/LayoutType","../../resources/PagesResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageLayoutType=n.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new a.default);return r}t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");t.backgroundCompute(function(){var t=e._pageLayoutType(),r=s.Path[t];e._debouncer.debounce(r?r().then(function(e){return e.tagName}):u.default.wrap("")).then(function(e){n(e)})});return n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageLayoutType:o.files.layoutType});return t})(r.default);t.LayoutTypeResolver=l;t.layoutTypeResolverKey=new f.ResourceKey({name:e("module").id+".layoutTypeResolver",factory:new f.ResolvedResourceFactory(l)});t.resolvedLayoutTypeResourceKey=new f.ResourceKey({name:e("module").id+".resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:t.layoutTypeResolverKey},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.pageLayoutType=n.resources.consume(o.files.layoutType);return n}t.prototype.changeLayout=function(e){var t=this;return(0,s.Path[e])().then(function(n){t.pageLayoutType(n.tagName);return u.default.resolve({resultType:i.ResultTypeEnum.Success,extraData:{layout:e}})})};return t})(r.default);t.default=c});
define("odsp-next/actions/viewOriginal/ViewOriginalAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/BaseAction","../base/ItemCommandHelper","../base/ItemSelectionHelper","../NavigationAction","../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ViewOriginal";n._itemCommandHelper=new(n.managed(s.default));n._selectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});n._url=n.observables.pureCompute(function(){var e=n._selectionHelper.firstItem(),t=e&&e.photo&&e.photo.originalUrl;return t&&t.replace(/#/g,"%23")});n._navigationAction=new(n.managed(u.default))({url:n._url,target:"_blank"});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,a.viewOriginal)};t.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):r.default.reject({})};return t})(i.default);t.default=f});
define("odsp-next/actions/odc/UploadAction",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../models/item/ItemType","../base/ItemRedeemer","../UploadAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.logStartEnd=!0;n.name="Upload."+r.UploadProcessorType[n.uploadProcessorType];n._itemRedeemer=n.resources.consume(s.resourceKey);return n}t.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var t=this.item();return e.prototype.onIsAvailable.call(this)&&t.type===i.default.Folder};t.prototype.onExecute=function(t,n){var r=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return e.prototype.onExecute.call(r,t,n)})};t.prototype._isPlatformSupported=function(){var e=!1,t=this.platform.isIPad&&this.platform.browserMajor<6;if(this.platform.isWinAppWipEnabled)return!1;if(!t)switch(this.uploadProcessorType){case r.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case r.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e};return t})(o.default);t.default=u});
define("odsp-next/actions/UploadAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","../resources/ControlResourceKeys","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/operator/UploadOperator.key","../providers/engagement/Engagement","@ms/odsp-shared/lib/base/ActionInputType","./base/ItemCommandHelper","../models/item/command/WebItemCommandKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../utilities/killSwitch/KillSwitch","./UploadedItemResourceKey","../dataSources/floodgate/spo/FloodgateHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Upload";n.platform=n.resources.consume(v.platformDetection);n.uploadProcessorType=t.uploadProcessorType;n._onDemandInput=!m.default.isActivated("D3F3420F-5034-4DFC-AC04-D8B19BA8DB85","07/08/2018","Revert back to old file input method for the upload actions");if(n._onDemandInput){n._resetInputElement();n.addDisposable({dispose:function(){if(n._inputElement){document.body.removeChild(n._inputElement);n._inputElement=void 0}}})}else n.inputType=n.createObservable(n._getInputType(n.uploadProcessorType));n.itemCommandHelper=n.resources.consume(p.resourceKey);n.skipInvalidation=!1;n._currentItemSet=n.resources.consume(o.currentItemSet.optional);n._createUploadObserver=t.createUploadObserver;return n}t.prototype.onExecute=function(e,t){this.resources.consume(c.resourceKey).logData({name:"Upload.TopMenu.Click",isIntentional:!0});if(!this._onDemandInput){var n=e.target;return this._uploadFiles(n)}var r=new i.default;window.sessionStorage.getItem("_isRunningTABTest")||this._clickHiddenInput(r);return r.getPromise()};t.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this.itemCommandHelper.isCommandSupported(t,d.upload))return!1;switch(this.uploadProcessorType){case u.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case u.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===f.default.Files};t.prototype._resetInputElement=function(){var e=this;this._inputElement&&document.body.removeChild(this._inputElement);var t=document.createElement("input");this._inputElement=t;t.style.display="none";t.type="file";var n="commandFileInput";if(this.uploadProcessorType===u.UploadProcessorType.Folder){n="commandFolderInput";t.webkitdirectory=!0}t.className=n;t.multiple=!0;t.onchange=function(n){e._uploadFiles(t).done(function(){e._resetInputElement()})};document.body.appendChild(t)};t.prototype._clickHiddenInput=function(e){var t=this,n=this._inputElement;n.onchange=function(r){t._uploadFiles(n).then(function(t){e.complete(t)},function(t){e.error(t)}).then(function(){t._resetInputElement()})};n.click()};t.prototype._uploadFiles=function(e){var t=this,n=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);if(n){var r=this._createUploadObserver&&this._createUploadObserver();return this.resources.consumeAsync(l.asyncTypeResourceKey).then(function(e){var i=new e({files:n,parentItem:t.item.peek(),wasDragAndDropped:!1,type:t.uploadProcessorType,itemSet:t._currentItemSet&&t._currentItemSet.peek(),skipInvalidation:t.skipInvalidation,isTemplate:t.isTemplate,onItemUploaded:function(e){r&&r.onItemUploaded(e);t.resources.consume(g.resourceKey)(e)}});i.start();return i.wait()}).then(function(){r&&r.onUploadCompleted();y.npsActionForSPO(t.resources,"uploadAction");return{resultType:a.ResultTypeEnum.Success}},function(e){r&&r.onUploadCompleted();return s.default.reject(e)})}return s.default.wrap({resultType:a.ResultTypeEnum.ExpectedFailure})};t.prototype._getInputType=function(e){switch(e){case u.UploadProcessorType.Html5file:return h.default.htmlFileUpload;case u.UploadProcessorType.Folder:return h.default.folderUpload;default:return h.default.none}};return t})(r.default);t.default=b});
define("odsp-next/providers/operator/UploadOperator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.asyncTypeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./UploadOperator"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("@ms/odsp-shared/lib/base/ActionInputType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(n||(n={}));t.default=n});
define("odsp-next/actions/UploadedItemResourceKey",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".UploadedItem",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})});
define("odsp-next/dataSources/floodgate/spo/FloodgateHelper",["require","exports","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/interfaces/WebTemplateType","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.npsActionForSPO=function(e,t){if(e.isExposed(n.floodgate)){var o=e.consume(r.pageContext.optional);if(o&&o.isSPO){if(Number(o.webTemplate)===i.default.mySite)return}try{e.consume(n.floodgate).recordUserAction("SPListAction",t);t&&s.Engagement.logData({name:"FloodgateForSPO."+t})}catch(e){s.Engagement.logData({name:"FloodgateForSPO.error"+t,extraData:{error:e}})}}}});
define("odsp-next/resources/SPOResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageContext=new n.ResourceKey("pageContext");t.listContext=new n.ResourceKey("listContext");t.listItems=new n.ResourceKey("listItems");t.inplaceEditorUrl=new n.ResourceKey("inplaceEditorUrl");t.inplaceEditorClosing=new n.ResourceKey("inplaceEditorClosing");t.appViewChangeInProgress=new n.ResourceKey("appViewChangeInProgress");t.appViewErrorMessage=new n.ResourceKey("appViewChangeInProgress");t.itemsPerGroup=new n.ResourceKey("itemsPerGroup");t.loggingContext=new n.ResourceKey("loggingContext");t.loggingContextBuckets=new n.ResourceKey("loggingContextBuckets");t.contentTypes=new n.ResourceKey("provider.contentTypes");t.onePageContext=new n.ResourceKey("onePageContext");t.sharingContextInformation=new n.ResourceKey("sharingContextInformation");t.searchBehavior=new n.ResourceKey("searchBehavior");t.newDocumentTemplates=new n.ResourceKey("newDocumentTemplates")});
define("odsp-next/actions/odc/UpdateCaptionAction",["require","exports","tslib","../UpdateCaptionAction","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._itemCommandHelper=new(t.managed(i.default));return t}t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,s.editCaption)&&!(t.vault&&t.vault.root&&t.vault.isLocked)};return t})(r.default);t.default=o});
define("odsp-next/actions/UpdateCaptionAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/item/ItemProvider"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdateCaption";n.caption=t.caption;return n}t.prototype.onExecute=function(e,t){return this.resources.consume(s.resourceKey).updateItemProperty({item:this.item(),propertyName:"caption",propertyValue:this.caption(),overrideLock:!0,qosPostfix:"caption"}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t})(r.default);t.default=o});
define("odsp-next/actions/odc/SurveyAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../base/BaseAction","../base/ItemSelectionHelper","../../utilities/icons/Icon","../NavigationAction","../base/ItemCommandHelper","../../resources/ODCResourceKeys","../../controls/sharing/shareSurvey/ShareSurvey","../../dataSources/url/odc/UrlDataSource","../../controls/sharing/shareSurvey/ShareSurvey.resx","../../models/item/command/OfficeItemCommandKeys","../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Survey";r._actionType=t.actionType;r._navigation=r.resources.consume(o.navigation);r._dialogProvider=r.resources.consume(g.resourceKey);r._itemCommandHelper=new(r.managed(c.default));r._urlDataSource=r.resources.consume(h.urlDataSource);r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._getCommandKey();return this._itemSelectionHelper.filterItems(function(n){return e._itemCommandHelper.isCommandSupported(n,t)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,o,u,a,f,c,h;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];if(1===this._actionType)return[2,this.showShareDialog(t)];o=this._navigation;u=this._urlDataSource.getAuthKeyParamValue();a=this._urlDataSource.getTicketParamValue();f=o.viewParams.qt;c=3===this._actionType?3:2;h=i.format("/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel",d.default.viewerId,t.id,f||"",c);u?h+="&authKey="+u:a&&(h+="&ticket="+a);return[2,new(this.managed(l.default))({url:h,target:"_blank"}).execute(e)]}})})};t.prototype.showShareDialog=function(e){var t=i.format(v.default.title,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:p.default.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:v.default.done,execute:function(){return r.default.resolve(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new f.default("Cancel")}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype._getCommandKey=function(){switch(this._actionType){case 1:return m.publishSurvey;case 2:return m.viewSurvey;case 3:return m.editSurvey}};return t})(u.default);t.default=y});
define("odsp-next/controls/sharing/shareSurvey/ShareSurvey",["require","exports","./ShareSurvey.html","./ShareSurveyViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-share-survey",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/sharing/shareSurvey/ShareSurvey.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ShareSurvey"><div class="od-sharesurvey-preview"><img data-bind="attr:{src:previewSrc}"></div><div class="od-sharesurvey-details">\x3c!--ko if:isLoading--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:loadingText}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<span class="od-sharesurvey-instructions" data-bind="text:instructionsText"></span>\x3c!--ko if:!sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click:onCreateClicked"><span class="od-Button-label" data-bind="text:createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:sharingLink()--\x3e<input type="text" class="od-sharesurvey-textbox" readonly data-bind="attr:{value:sharingLink().url},selectOnFocus:{isPermanent:true}"><br><button class="od-Button" data-bind="click:onRemoveClicked"><span class="od-Button-label" data-bind="text:removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if:hasError()--\x3e<span class="od-sharesurvey-error" data-bind="text:errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="ms-clearfix"></div></div>'});
define("odsp-next/controls/sharing/shareSurvey/ShareSurveyViewModel",["require","exports","tslib","knockout","../../../providers/sharing/SharingProvider","../../../bindings/focus/SelectOnFocusBinding","./ShareSurvey.resx","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=a.default.tagName;n._item=t.item;n.previewSrc=t.previewSrc;n.isLoading=r.observable(!0);n.sharingLink=r.observable(null);n.hasError=r.observable(!1);n.instructionsText=o.default.note;n.createText=o.default.create;n.removeText=o.default.remove;n.loadingText=o.default.loading;n.errorText=o.default.error;n._sharingProvider=n.resources.consume(i.resourceKey);n._getSharingInfo();n.addBindingHandlers({selectOnFocus:s.default});return n}t.prototype.onCreateClicked=function(){var e=this;this.isLoading(!0);this._sharingProvider.manageSharingLinks([this._item],{type:7,role:3,create:!0}).done(function(){e._getSharingInfo()},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype.onRemoveClicked=function(){var e=this;this.isLoading(!0);var t={id:this.sharingLink().id,type:7,role:5,create:!1};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e.isLoading(!1);e.sharingLink(null)},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype._getSharingInfo=function(){var e=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(t){e.isLoading(!1);if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];7===i.type&&e.sharingLink(i)}})};return t})(u.default);t.default=f});
define("odsp-next/providers/sharing/SharingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../item/ItemProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./ShareItemHelper","./SharingData"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new l.default({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t,n){var r=this;return this._shareItemHelper.share(e,t,n).then(function(e){r._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].parent&&e[0].parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{sharingDataSource:s.sharing,sharingDataDataSource:s.sharingData.optional,navigation:a.navigation,externallySharedItemProvider:o.externallySharedItem.optional,itemProvider:u.resourceKey.optional,shareItemHelper:f.resourceKey});return t})(r.default);t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});
define("odsp-next/providers/sharing/ShareItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../item/ItemProvider","../operation/OperationProvider","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../controls/sharing/shareByEmail/Sharing.resx","../../resources/SPOResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._itemProvider=n.itemProvider;r._operationProvider=n.operationProvider;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._sharingContextInformation=n.sharingContextInformation;return r}t.prototype.share=function(e,t,n){if(this._sharingContextInformation||n)return this._dataSource.share(e,t);var r=this._getShareOperation(t),i=this._dataSource.share(e,t);r.state(c.default.started);return i.then(this._onSuccess(t,r),this._onError(r))};t.prototype._getShareOperation=function(e){var t=this,n=this.observables,r=this._operationProvider.register({name:e.items[0].name,type:l.default.shareItem,payloads:{shareItem:{items:e.items}},iconName:e.items[0].iconName,actions:{hipCheck:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getHipCheckUrl(),frameId:"_blank"});r.state(c.default.expired);return s.default.wrap()}},verifyAccount:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getVerifyAccountUrl(),frameId:"_blank"});r.state(c.default.expired);return s.default.wrap()}}}});r.progress.maximum(1);r.progress.current(0);return r};t.prototype._onSuccess=function(e,t){var n=this;return function(r){e.items[0].parent&&n._itemProvider&&n._itemProvider.invalidateItem(e.items[0].parent.key);t.progress.current(1);r.statusCode>=0?t.state(c.default.completed):t.state(c.default.failed);var i=t.payloads.peek();i.shareItem.result=r.statusCode;t.payloads(i);return r}};t.prototype._onError=function(e){var t=this;return function(n){var r=e.payloads.peek();r.shareItem.result=n.statusCode||n.code;e.payloads(r);var i,o=n.code;if(3006===o&&t._urlDataSource.getHipCheckUrl()){e.actions.peek().hipCheck.isAvailable(!0);i=n&&n.message}else if(3009!==o&&3033!==o||!t._urlDataSource.getVerifyAccountUrl())3007!==o&&3034!==o&&3036!==o&&3037!==o&&1007!==o&&3035!==o||(i=n&&n.message);else{e.actions.peek().verifyAccount.isAvailable(!0);i=p.default.VerifyAccount}i&&e.error(new f.default({message:i}));e.state(c.default.failed);return s.default.wrapError(n)}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{sharingDataSource:o.sharing,itemProvider:u.resourceKey.optional,operationProvider:a.resourceKey,navigation:h.navigation,urlDataSource:o.url,sharingContextInformation:d.sharingContextInformation.optional});return t})(r.default);t.default=v;t.resourceKey=i.createResolvedResourceKey(e("module").id,v)});
define("odsp-next/providers/sharing/SharingData",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(n.default.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){n.default.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})();t.default=r});
define("odsp-next/controls/loadingSpinner/LoadingSpinner",["require","exports","./LoadingSpinner.html","./LoadingSpinnerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-loadingSpinner",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/loadingSpinner/LoadingSpinner.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>'});
define("odsp-next/controls/loadingSpinner/LoadingSpinnerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/imageLoader/ImageLoaderBinding","./LoadingSpinner.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=o.default.LoadingText;n.addBindingHandlers({imageLoader:s.default});n.isVisible=r.observable(!0);n.isImageLoaded=r.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(i.default);t.default=u});
define("odsp-next/bindings/imageLoader/ImageLoaderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/images/ImageLoader","../../utilities/images/logging/ImageLoad.event","../../utilities/images/ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/PromiseDebouncer"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new a.default;r._imageLoader=r.resources.consume(i.resourceKey);var s=r.valueAccessor(),o=s.src,u=s.image,f=s.error,l=s.isLoaded,c=s.isError,h=s.actualSize,p=s.scenarioName;r._src=r.wrapObservable(o);r._image=r.wrapObservable(u);r._error=r.wrapObservable(f);r._scenarioName=p;var d=n.outputExtenders,v=void 0===d?{deferred:!0}:d;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();l&&l(!!e);if(h){var t=void 0;if(e){t={width:e.width,height:e.height}}h(t)}u&&u(e)}).extend(v);r.createBackgroundComputed(function(){var e=r._error();f&&f(e);c&&c(!!e)}).extend(v);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(e=new s.default({name:this._scenarioName,loadType:o.default.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:u.ResultTypeEnum.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure})})};return t})(r.default);t.default=f});
define("odsp-next/utilities/images/ImageLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/auth/DomainAuthenticator","@ms/odsp-utilities/lib/async/Semaphore","./logging/ImageLoad.event","./ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","./ThumbnailCache","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new u.default(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,u={url:n,width:0,height:0},a=this._thumbnailCache,f=function(){return o.default.authenticate(n).then(function(){return t._waitForImageLoad(i,n,s)}).then(function(e){a.record(u);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return a.isLoaded(u)?f():this._semaphore.enqueue(f)};t.prototype._waitForImageLoad=function(e,t,n){var r,s,o,u=this.async,c=this.events,p=function(){o&&u.clearTimeout(o);c.off(e)},d=new i.default(function(){p();e.setAttribute("src","")}),v=t&&t.indexOf("&encodeFailures=1")>=0;c.onAll(e,{load:function(){p();if(v&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;s&&s.end({resultType:n?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure,resultCode:""+t,error:"Encoded failure"});d.error(new h.ApiError({code:""+t,isExpected:n,message:"Server returned encoded failure "+t}))}else{s&&s.end({resultType:l.ResultTypeEnum.Success});d.complete(r)}},error:function(){p();s&&s.end({resultType:l.ResultTypeEnum.Failure});d.error(new Error("Image '"+t+"' failed to load"))}});o=u.setTimeout(function(){d.cancel()},3e4);n&&(s=new a.default({name:n,loadType:f.default.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(d.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new i.default(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{thumbnailCache:c.resourceKey});return t})(r.default);t.default=p;t.resourceKey=s.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/utilities/images/logging/ImageLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../ImageLoadType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImageLoadType=i.ImageLoadType;t.ResultTypeEnum=s.ResultTypeEnum;t.ImageLoad=n.createPairedEvent({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:i.ImageLoadType,type:6}},r.Qos);t.default=t.ImageLoad});
define("odsp-next/utilities/images/ImageLoadType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(n=t.ImageLoadType||(t.ImageLoadType={}));t.default=n});
define("odsp-next/utilities/images/ThumbnailCache",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=a(e),r=a(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=u(this.getCoveragePercent(e,n)),a=o(e),f=o(t),l=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=l[a]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:f,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[f]=p;l[a]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=o(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=o(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=o(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var a=i.buckets;i.lastAccessed=s.peek();var f=u(t),l=u(n),c=-1/0,h=!1;for(var p in a){var d=Number(p);if(d<=f&&d>=l&&a[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&a[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();f(this._recordsByThumbnailKey,e);f(this._bucketsByImageKey,e)};return t})(r.default);t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s);function o(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function u(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function a(e){return e.width*e.height}function f(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}});
define("odsp-next/actions/odc/AddToSharedListAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../../models/item/command/SocialItemCommandKeys","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddToSharedList";r._itemReedemer=r.resources.consume(s.resourceKey);r._itemCommandHelper=new(r.managed(o.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,f.addToShared)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this,!0).then(function(){t.resources.consume(a.resourceKey).invalidateItem(e.key,{triggerFetch:!0});return{resultType:i.ResultTypeEnum.Success}})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(u.default);t.default=c});
define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RemoveFromSharedList";n._itemCommandHelper=new(n.managed(o.default));n._currentItem=n.resources.consume(u.currentItem);return n}i.prototype.getExecutorPath=function(){return"./RemoveFromSharedListExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./RemoveFromSharedListExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,s.removeFromShared)};return i})(i.default);t.default=a});
define("odsp-next/actions/addToBundle/odc/AddToBundleAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../dataSources/url/odc/UrlDataSource"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToBundleAction";return n}i.prototype.getExecutorPath=function(){return"./AddToBundleExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./AddToBundleExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&e.isBundle&&e.ownerId===s.default.viewerId};return i})(i.default);t.default=o});
define("odsp-next/actions/odc/RemoveFromBundleAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../../providers/operator/UpdateBundleOperator","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromBundleAction";r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.parent&&e.parent.isBundle)&&e.parent.ownerId===s.default.viewerId};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this.resources.consumeAsync(u.typeResourceKey).then(function(n){var r=new n({items:e.map(function(e){return e.id}),bundleAction:1,item:e[0].parent});t.trackPromise(r.start());return r.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(o.default);t.default=f});
define("odsp-next/providers/operator/UpdateBundleOperator",["require","exports","tslib","./BaseOperator","../../providers/item/ItemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._itemProvider=n.itemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.updateBundle;n.name=r.name;n.iconName=r.iconName;n.payloads.updateBundle={item:r,parent:r.parent};return n};t.prototype.onStart=function(e){var t=[new r.Task(this._context.item.key,this._context.item)];e.update(t);return this._itemProvider.updateBundle(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemProvider:i.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/operator/BaseOperator",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/task/TaskObserver","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../operation/OperationProvider","../../models/operation/OperationState","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationBatch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.TaskObserver=s.default;t.OperationType=c.default;var p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._actionsByName={};var i=n.operationProvider,o=void 0===i?r.resources.consume(a.resourceKey):i;r._operationProvider=o;r._operationBatch=new h.default;r._operationsByKey={};r._completionSignal=new u.default;r._completionSignal.getPromise().done(function(){r.dispose()},function(){r.dispose()});r._observer=r.addDisposable(new s.default(r._onTaskChanges.bind(r)));r._throttleExecuteAllActions=r.async.debounce(r._executeAllActions);r.registerActions({cancel:r.onCancel});r.addDisposable(r._operationProvider.groups.subscribe(r._onOperationProviderGroupsChanged,r,"arrayChange"));return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._groupOperation=null;this._throttleExecuteAllActions=null};t.prototype.start=function(){var e=this;return this.onStart(this._observer).then(function(){e._completeIfNoGroupCreated()},function(t){e._completeIfNoGroupCreated();return o.default.wrapError(t)})};t.prototype.wait=function(){return this._completionSignal.getPromise()};t.prototype.onStart=function(e){return o.default.wrap()};t.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return o.default.wrap()};t.prototype.registerActions=function(e){for(var t in e){var n=e[t];if(n){n._BaseOperator_actionName=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new u.default}}else delete this._actionsByName[t]}};t.prototype.getOperationDetails=function(e){var t;t=1===e.status?f.default.completed:2===e.status?f.default.failed:3===e.status?f.default.canceled:f.default.started;return{type:c.default.multiple,name:"",iconName:null,error:e.error&&new l.default({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};t.prototype.onOperationFinished=function(e){};t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];n.queue.push(t);this._throttleExecuteAllActions();return n.signal.getPromise()};t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;t.signal=new u.default;if(t.queue.length){var r=t.queue.splice(0,t.queue.length);t.callback(r,this._observer).done(d(n),v(n))}}};t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this._updateOperationForTask(r)}};t.prototype._updateOperationForTask=function(e){var t,n=e.current,r=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var s=0,o=r.actions;s<o.length;s++){var u=o[s],a=u._BaseOperator_actionName,f=this._actionsByName[a];f&&f.action===u&&(t[a]=!0)}if(!i){var l={};for(var a in this._actionsByName)l[a]={isAvailable:this.createObservable(a in t),execute:this._getActionExecutor(a,n)};var c={batch:this._operationBatch,type:r.type,name:r.name,iconName:r.iconName,payloads:r.payloads,progress:r.progress,visibility:r.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(c)}if(i.name!==r.name){i.name=r.name;i.payloads(r.payloads)}i.progress.minimum(r.progress.minimum);i.progress.maximum(r.progress.maximum);i.progress.current(r.progress.current);i.type(r.type);i.error(r.error);i.state(r.state);for(var a in this._actionsByName)i.actions.peek()[a].isAvailable(a in t)};t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}};t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===f.default.completed||t===f.default.canceled||t===f.default.failed||t===f.default.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t.onOperationFinished(e)})})};t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.value;if(i.batch===this._operationBatch)if("added"===r.status){if(!this._groupOperation){this._groupOperation=i;this._createGroupOperationSubscription(i)}}else"deleted"!==r.status||r.moved||this._completionSignal.complete()}};t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{operationProvider:a.resourceKey});return t})(r.default);t.default=p;function d(e){return function(){return e.complete()}}function v(e){return function(t){return e.error(t)}}});
define("odsp-next/models/task/TaskObserver",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(e,t){return{update:function(n,r){void 0===r&&(r=!1);e.update(n.map(function(e){return t(e)}),r)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var n,r,i;n={};for(var s in this._tasksByKey)n[s]=this._tasksByKey[s];i=[];for(var o=0,u=e;o<u.length;o++){var a=u[o],f=n[a.key],l=a.compare(f);l&&i.push(l);delete n[a.key];this._tasksByKey[a.key]=a}if(t)for(var s in n){r=n[s];delete this._tasksByKey[s];i.push({previous:r,current:null})}this.onChanges(i)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e})();t.default=n});
define("odsp-next/actions/reportAbuse/odc/ReportAbuseAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../models/item/command/SocialItemCommandKeys","../../base/templates/ExecutorAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="ReportAbuse";return n}s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};s.prototype.getExecutorPath=function(){return"./ReportAbuseExecutor"};s.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./ReportAbuseExecutor"],t,n)}))}};s.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,i.reportAbuse)};return s})(s.default);t.default=o});
define("odsp-next/actions/odc/RemoveMountPointAction",["require","exports","tslib","../../base/BaseAction","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/textContainer/TextContainer","../../resources/DataSourceResourceKeys","../../utilities/icons/Icon","../../providers/dialog/DialogProvider","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveMountPoint";r._urlDataSource=r.resources.consume(f.url);r._dialogProvider=r.resources.consume(c.resourceKey);r._itemProvider=r.resources.consume(h.resourceKey);r._navigation=r.resources.consume(v.navigation);r._itemCommandHelper=new(r.managed(p.default));r._itemSelectionHelper=new(r.child(m.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,d.removeAsMountPoint)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek(),f=this._itemProvider,c=this._navigation,h=this._dialogProvider;return this._itemSelectionHelper.resolveFirst().then(function(e){if(!e)return{resultType:o.ResultTypeEnum.ExpectedFailure};var t=e.parent,p=u.format(i.default.RemoveMountPointDetails2,e.name);return h.requestDialog({title:i.default.RemoveMountPointTitle,component:{name:a.default.tagName,params:{text:p}},actions:[{name:i.default.RemoveMountPoint,execute:function(){return s.default.resolve(2)},isAvailable:n.observables.create(!0),icon:new l.default("Cancel"),isDefault:!0}]}).wait().then(function(){n._itemSelectionHelper.clearSelection();return f.removeMountPoint({parentKey:r.key,item:e}).then(function(){var e=t?n._urlDataSource.getDefaultClickUrl(t):"";c.navigateTo(e);return{resultType:o.ResultTypeEnum.Success}})})})};return t})(r.default);t.default=g});
define("odsp-next/actions/requestReview/odc/RequestReviewAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/SocialItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RequestReview";n._itemCommandHelper=new(n.managed(s.default));return n}i.prototype.getExecutorPath=function(){return"./RequestReviewExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./RequestReviewExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,o.requestReview)};return i})(i.default);t.default=u});
define("odsp-next/actions/odc/ViewInFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../base/ItemRedeemer","../../models/item/ItemType","../../dataSources/url/PageType","../../dataSources/url/QueryType","../../dataSources/url/SearchTypeChecker","../../resources/ODCResourceKeys","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ViewInFolderAction";r._navigation=r.resources.consume(s.navigation);r._urlDataSource=r.resources.consume(c.urlDataSource);r._itemReedemer=r.resources.consume(o.resourceKey);r._itemSelectionHelper=new(r.child(d.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=this.resources.consume(c.urlDataSource),n=e&&e.parentKey&&l.isSearchType(e.queryType),r=t.isCurrentQuery(f.default.Photos);return!!e&&(n||r&&e.type===u.default.Media)&&e.ownerId===h.default.viewerId};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this).then(function(){t._navigation.navigateTo({url:t._urlDataSource.getItemUrl(e.parentKey,{page:a.default.Files})});return r.default.resolve({resultType:i.ResultTypeEnum.Success})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t})(p.default);t.default=v});
define("odsp-next/actions/RemoveFromAlbumAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/album/AlbumProvider.key","./base/ItemCommandHelper","../models/item/command/PhotoItemCommandKeys","./base/ItemSelectionHelper","../resources/DataSourceResourceKeys","../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromAlbum";r._itemCommandHelper=new(r.managed(o.default));r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return!!e.isAlbum&&!!t&&this._itemCommandHelper.isCommandSupported(t,u.removeFromAlbum)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();var t={album:r,items:e};return n.resources.consumeAsync(s.resourceKey).then(function(e){return e.removeFromAlbum(t)}).then(function(){n._refreshItemsScopeRemovedItems(e);return{resultType:i.ResultTypeEnum.Success}},function(e){n._refreshItemsScopeCurrentItemSet();return{resultType:i.ResultTypeEnum.Failure}})})};t.prototype._refreshItemsScopeRemovedItems=function(e){this.resources.consume(l.isItemsScopeEnabledInAllAlbumsPivotResourceKey)&&this.resources.consumeAsync(f.itemInvalidator).then(function(t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.id&&t.invalidateItems(i.key)}})};t.prototype._refreshItemsScopeCurrentItemSet=function(){this.resources.consume(l.isItemsScopeEnabledInAllAlbumsPivotResourceKey)&&this.resources.consumeAsync(f.itemInvalidator).then(function(e){e.invalidateCurrentItemSet()})};return t})(r.default);t.default=c});
define("odsp-next/providers/album/AlbumProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Promise","../../dataSources/base/odc/Config"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item;n._itemSelectionHelper=new(n.child(s.typeResourceKey))({overrideItem:r,allowMultiSelect:!1,canFallback:!0});n._itemCommandHelper=new(n.managed(o.default));n.state=n.createPureComputed(n._computeState);return n}t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!l.Config.hcid&&e.virtualItemType===a.default.Album&&this._itemCommandHelper.isCommandSupported(e,u.addPhotosToAlbum)}};return t})(r.default);t.AddPhotosToAlbumHandler=c;var h=i.create({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return f.default.resolve(new Promise(function(t,n){e(["./AddPhotosToAlbumExecutor"],t,n)}))}}},handlerType:c});t.default=h});
define("odsp-next/actions/createAlbum/CreateAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/VirtualItemType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!0});n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===u.default.AlbumRoot}};return t})(i.default);t.CreateAlbumHandler=a;var f=s.create({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./CreateAlbumExecutor"],t,n)}))}}},handlerType:a});t.default=f});
define("odsp-next/actions/SelectAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../base/BaseAction","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAction";var i=n.itemSelectionHelperType,o=void 0===i?r.resources.consume(u.typeResourceKey):i,a=n.actionMap,f=void 0===a?r.resources.consume(s.actionMap):a;r._item=t.item;r._selectItems=t.selectItems;r._itemSelectionHelper=new o({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});t.showProperties&&(r._showPropertiesAction=new(r.managed(f.ShowPropertiesAction))({}));return r}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,r=this;return n.__generator(this,function(n){switch(n.label){case 0:if(this._selectItems){t=this._selectItems.map(function(e){return r.observables.peekUnwrap(e)});this._itemSelectionHelper.selectItems(t)}else this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]);return this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:n.sent();n.label=2;case 2:return[2,{resultType:i.ResultTypeEnum.Success}]}})})};return t})(o.default);t.default=a});
define("odsp-next/actions/SelectAllAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../base/BaseAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAll";r._selectionModel=r.resources.consume(s.itemsSelection);return r}t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};t.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return r.default.resolve({resultType:i.ResultTypeEnum.Success})};return t})(o.default);t.default=u});
define("odsp-next/actions/FilterSearchAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/SearchTypeChecker","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearch";n._filter=t.filter;n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(u.viewParams);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(s.default))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&i.isSearchType(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=i.isSearchType(this._urlDataSource.getQueryType())&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==a.SearchFilterType.all);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);this.resources.consumeAsync(o.search).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t})(r.default);t.default=f});
define("odsp-next/actions/RemoveTagFromItemAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../models/item/VirtualItemType","./base/ItemSelectionHelper","../resources/ControlResourceKeys","../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTagFromItem";r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});r._viewParams=r.resources.consume(f.viewParams);return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return e.virtualItemType===u.default.Tag&&!!t&&!!e.tags&&e.tags.length>0};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem(),u=r.tags,a=this.resources.consume(o.tag),f=this.resources.consume(o.photo).getAllPhotosSettings().peek();return this._itemSelectionHelper.resolveSelection().then(function(e){var t,o=e[0],c=o&&o.tags;if(c&&u)for(var h=0,p=c;h<p.length;h++){var d=p[h];if(d.tag===u[0].tag){t=d;break}}n._itemSelectionHelper.clearSelection();if(!t)return i.default.resolve({resultType:s.ResultTypeEnum.Failure});var v=!1,m=n._viewParams.peek();n.resources.consume(l.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===m.tagFilter&&(v=!0);return a.updateTags({items:e,tagsToAdd:null,tagsToDelete:[t],parentKey:r.key,rootItemId:f.rootId,skipInvalidate:v}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})};return t})(r.default);t.default=c});
define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/VirtualItemType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(i,t);function i(e){var n=t.call(this,e)||this;n.name="SetAlbumCoverPhoto";n._currentItem=n.resources.consume(s.currentItem);n._itemCommandHelper=new(n.managed(o.default));return n}i.prototype.getExecutorPath=function(){return"./SetAlbumCoverPhotoExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./SetAlbumCoverPhotoExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}};i.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};i.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===a.default.Album&&this._itemCommandHelper.isCommandSupported(e,u.deleteItem)&&!!t&&!(!t.photo&&!t.video)};return i})(i.default);t.default=f});
define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader","../../../providers/item/ItemProvider","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","../../../resources/ODCResourceKeys","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/logging/events/Action.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="SetPhotosRoot";r._rootId=n.rootId;r._photoProvider=r.resources.consume(u.photo);r._itemProvider=r.resources.consume(o.resourceKey);r._viewParams=r.resources.consume(a.viewParams);r._urlDataSource=r.resources.consume(f.urlDataSource);r._executorLoader=new(r.managed(s.default))({path:"./SetPhotosRootExecutor",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["./SetPhotosRootExecutor"],t,n)}))},getExecutorParams:function(){return{photoProvider:r._photoProvider,itemProvider:r._itemProvider,urlDataSource:r._urlDataSource,rootId:r._rootId}}});return r}r.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;if("ROOT"===this._rootId)e="root"===t;else if("SAMSUNGFOLDER"===this._rootId){e="samsungGallery"===this._photoProvider.getAllPhotosSettings()().folderName}else if("ALLPHOTOSFOLDER"===this._rootId){e="photos"===this._photoProvider.getAllPhotosSettings()().folderName}return e};r.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case 0:case 9:return!0;default:return!1}};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};r.prototype.onCreateQosEvent=function(e){return new h.Action({name:this.name,pageType:this._urlDataSource&&l.default[this._urlDataSource.getPageType()]||"",queryType:this._urlDataSource&&c.default[this._urlDataSource.getQueryType()]||"",logStartEnd:this.logStartEnd,extraData:{filter:this._rootId}})};return r})(r.default);t.default=p});
define("odsp-next/actions/FilterSearchByDateAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/SearchTypeChecker","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearchByDateAction";n._filter=t.filter;n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(u.viewParams);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(s.default))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&i.isSearchType(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&i.isSearchType(this._urlDataSource.getQueryType())&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==a.SearchFilterDateType.anyDate);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);this.resources.consumeAsync(o.search).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t})(r.default);t.default=f});
define("odsp-next/actions/launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(t){n.__extends(u,t);function u(e){var n=t.call(this,e)||this;n._isMove=e.isMove;n.name="LaunchMoveCopyPanel";n._currentItem=n.resources.consume(a.currentItem);n._urlDataSource=n.resources.consume(o.urlDataSource);n._moveCopyDataSource=n.resources.consume(f.copy);n._capabilities=n._moveCopyDataSource.getCapabilities();return n}u.prototype.getExecutorPath=function(){return"../LaunchMoveCopyPanelExecutor"};u.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["../LaunchMoveCopyPanelExecutor"],t,n)}))}};u.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};u.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}};u.prototype.onIsAvailable=function(){var e=this;if(!this._capabilities.supportsMoveCopy)return!1;var t=this._currentItem();if(this.selectionHelper.selection().length>1&&t.queryType===s.default.SharedWithMe&&t.isRootFolder)return!1;if(!this._isMove&&this._urlDataSource.getAuthKeyParamValue())return!1;var n=this._isMove?l.moveFrom:l.copyFrom;return this._urlDataSource.getPageType()!==i.default.TextFileEditor&&this.selectionHelper.filterItems(function(t){return e.itemCommandHelper.isCommandSupported(t,n)})};return u})(u.default);t.default=c});
define("odsp-next/actions/odc/AutoExecuteAction",["require","exports","tslib","../../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ODCResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../dataSources/url/AutoActionType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../controls/sharing/share/odc/Share.key","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r.name="AutoExecute";r._focusItem=t.focusItem;r._actionMap=r.resources.consume(u.actionMap);r._navigation=r.resources.consume(l.navigation);r._urlDataSource=r.resources.consume(o.urlDataSource);r._viewParams=r.resources.consume(u.viewParams);r._originalViewParams=n.__assign({},r._viewParams.peek());r._actionType=r.createPureComputed(r._computeAutoActionType,{deferEvaluation:!0});r._createAction=r.createPureComputed(r._computeCreateAction,{deferEvaluation:!0});r._action=r.createPureComputed(r._computeAction,{deferEvaluation:!0});return r}t.prototype.onExecute=function(e,t){var n,r=this._actionType.peek(),o=this._action.peek(),u=this.item.peek(),a=this._viewParams.peek();n=o&&o.isAvailable.peek()?o.execute(e):i.default.wrap({resultType:s.ResultTypeEnum.ExpectedFailure});r!==f.default.locate&&this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(u,{viewParams:a}));return n};t.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),n=this._focusItem(),r=!t.isPlaceholder,i=!n||!n().isPlaceholder;return!!e&&i&&r};t.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)};t.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case f.default.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case f.default.download:e=function(){return new(t.managed(t._actionMap.DownloadAction))({})};break;case f.default.share:case f.default.sharing:if(h.isFeatureEnabled(h.ODCRequestAccess)){var n=this._originalViewParams,r=n.rc,i=n.isEdit,s=n.isDirect,o="1"===i,u="1"===s,l=r?[r]:void 0;e=function(){return new(t.managed(t._actionMap.ShowShareMultiItemAction))({focusItems:t.resources.consume(c.shareResourceKey),isEdit:o,isSecureShare:u,defaultRecipients:l})}}else e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case f.default.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case f.default.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Text,autoInvokedItem:!0})};break;case f.default.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Word,autoInvokedItem:!0})};break;case f.default.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Excel,autoInvokedItem:!0})};break;case f.default.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.ExcelSurvey,autoInvokedItem:!0})};break;case f.default.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.PowerPoint,autoInvokedItem:!0})};break;case f.default.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.OneNote,autoInvokedItem:!0})};break;case f.default.openInExcel:case f.default.openInWord:case f.default.openInPowerPoint:case f.default.openInOneNote:case f.default.openInVisio:case f.default.openInProject:case f.default.openInPublisher:case f.default.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case f.default.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case f.default.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case f.default.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case f.default.editBrowser:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case f.default.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case f.default.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case f.default.locate:}return e};t.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose();e=null;var t=this._createAction();t&&(e=t());return e};return t})(r.default);t.default=p});
define("odsp-next/controls/sharing/share/odc/Share.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","knockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./Share"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey;t.shareResourceKey=new n.ResourceKey({name:"share",factory:new n.ConstantResourceFactory(r.observable())});t.manageAccessShareResourceKey=new n.ResourceKey({name:"manageAccessShare",factory:new n.ConstantResourceFactory(r.observable())});t.manageAccessAddPeopleResourceKey=new n.ResourceKey({name:"manageAccessAddPeople",factory:new n.ConstantResourceFactory(r.observable())});t.copyResourceKey=new n.ResourceKey({name:"copy",factory:new n.ConstantResourceFactory(r.observable([]))});t.sharingContextInformation=new n.ResourceKey("sharingContextInformation")});
define("odsp-next/actions/toggleSelectionMode/ToggleSelectionModeAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../controls/list/react/SelectionManager","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleSelectionModeAction";n._platformDetection=n.resources.consume(u.platformDetection);n._isSelectionModal=n.resources.consume(a.isSelectionModalResourceKey);n._selectionHelper=new(n.child(i.typeResourceKey))({});n._isOneDriveXboxApp=f.isOneDriveXboxApp();return n}t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()};t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();this._isSelectionModal(!t);return s.default.wrap({resultType:o.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._isSelectionModal()};return t})(r.default);t.default=l});
define("odsp-next/actions/redeemCode/odc/RedeemCodeAction",["require","exports","tslib","../../../base/BaseAction","../../base/ExecutorLoader","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="RedeemCode";r._executorLoader=new(r.managed(i.default))({path:"./RedeemCodeExecutor",getModule:function(){return s.default.resolve(new Promise(function(t,n){e(["./RedeemCodeExecutor"],t,n)}))},getExecutorParams:function(){return{redeemSuccess:n.redeemSuccess,redeemCode:n.redeemCode,actionName:r.name}}});return r}r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};r.prototype.onIsAvailable=function(){return!0};return r})(r.default);t.default=o});
define("odsp-next/actions/save/odc/SaveAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../SaveAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.getExecutorPath=function(){return"../SaveExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["../SaveExecutor"],t,n)}))}};return i})(i.default);t.default=s});
define("odsp-next/actions/save/SaveAction",["require","exports","tslib","../../base/BaseAction","../base/ExecutorLoader","../base/ItemSelectionHelper","../../resources/ControlResourceKeys","../../providers/item/ItemContentProvider"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Save";n._itemContentsProvider=n.resources.consume(u.resourceKey);var r=n.resources.consume(o.currentItem);n._selectionHelper=new(n.child(s.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});n._loader=new(n.managed(i.default))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:n._selectionHelper,currentItem:r.peek()}}});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&(!!t.memoryContent()&&(!t.hasConflict()&&(!t.hasPendingSave()&&t.hasChanges())))};t.prototype.onExecute=function(e){return this._loader.execute(e)};return t})(r.default);t.SaveAction=a;t.default=a});
define("odsp-next/providers/item/ItemContentProvider",["require","exports","../../models/item/ItemContent","@ms/odsp-utilities/lib/disposable/Disposable","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._itemContents={}}e.prototype.getItemContent=function(e){var t=e.key,i=this._itemContents,s=i[t];if(!s){s=new n.default;r.hook(s,function(){delete i[t]});i[t]=s}return s};e.prototype.dispose=function(){this._itemContents={}};return e})();t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s,{})});
define("odsp-next/models/item/ItemContent",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.memoryContent=r.observable(null);n.serverContent=r.observable(null);n.outDated=r.observable(!1);n.isEditable=r.observable(!1);n.hasConflict=n.createPureComputed(n._computeHasConflict);n.hasPendingSave=n.createPureComputed(n._computeHasPendingSave);n.hasChanges=n.createPureComputed(n._computeHasChanges);n._lastSaved=r.observable(null);n._pendingSave=r.observable(null);return n}t.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)};t.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)};t.prototype.saveSucceded=function(){if(this.hasPendingSave.peek()){this.updateETag=!0;this._lastSaved(this._pendingSave.peek());this._pendingSave(null)}};t.prototype._computeHasPendingSave=function(){return!!this._pendingSave()};t.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();if(null===t){this._lastSaved(e.text);return!1}return e.text!==t};t.prototype._computeHasConflict=function(){return!!this.serverContent()};return t})(i.default);t.default=s});
define("odsp-next/actions/redeem/odc/RedeemAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../base/ItemRedeemer","../../../dataSources/url/PageType","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemSelectionHelper","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Redeem";n._itemProvider=n.resources.consume(u.resourceKey);n._urlDataSource=n.resources.consume(l.url);n._itemReedemer=n.resources.consume(s.resourceKey);n._selectionHelper=new(n.child(f.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});return n}t.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===o.default.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})};t.prototype.onExecute=function(e){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){for(var n=0,i=e;n<i.length;n++){var s=i[n];t._itemProvider.invalidateItem(s.key,{triggerFetch:!0})}return r.default.wrap({resultType:a.ResultTypeEnum.Success})})})};return t})(i.default);t.default=c});
define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","../../../models/itemSet/ItemSetMonitor","../../base/templates/ExecutorAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.name="SwitchPhotoFolderLayoutType";n._itemSetMonitor=n.resources.consume(s.resourceKey);return n}o.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!i.default.getKeyParams(e.key).ft};o.prototype.getExecutorPath=function(){return"./SwitchPhotoFolderLayoutTypeExecutor"};o.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./SwitchPhotoFolderLayoutTypeExecutor"],t,n)}))}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};o.prototype.getExecutorParameters=function(){return{actionName:this.name}};return o})(o.default);t.default=u});
define("odsp-next/models/itemSet/ItemSetMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=n.itemSet;r.itemSet=s;r.item=r.createPureComputed(r._computeItem);r.item.equalityComparer=i.objectStrictEquality;r.isEmpty=r.createPureComputed(r._computeIsEmpty);r.hasItems=r.createPureComputed(r._computeHasItems);r.hasName=r.createPureComputed(r._computeHasName);r.hasParent=r.createPureComputed(r._computeHasParent);r.name=r.createPureComputed(r._computeName);r.isPlaceholder=r.createPureComputed(r._computeIsPlaceholder);return r}t.prototype._computeItem=function(){return this.itemSet().item()};t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0};t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t};t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)};t.prototype._computeHasParent=function(){return!!this.item().parent};t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name};t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemSet:s.currentItemSet});return t})(r.default);t.ItemSetMonitor=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../../dataSources/url/QueryType","../../../models/item/ItemType","../../../dataSources/url/odc/UrlDataSource","../../../dataSources/url/PageType","../../base/templates/ExecutorAction","../../../resources/ODCResourceKeys","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemParentHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(t){n.__extends(f,t);function f(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="CreateAlbumFromFolder";n._identity=n.resources.consume(i.identity);n._urlDataSource=n.resources.consume(l.urlDataSource);n._itemParentHelper=n.resources.consume(h.resourceKey);return n}f.prototype.isValidItem=function(e,t,n){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"));return n!==a.default.TextFileEditor&&t&&t.type!==c.IdentityType.anonymous&&e.ownerId===u.default.viewerId&&!r&&e.type===o.default.Folder&&e.queryType===s.default.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum&&!i};f.prototype.getExecutorPath=function(){return"./CreateAlbumFromFolderExecutor"};f.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./CreateAlbumFromFolderExecutor"],t,n)}))}};f.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};f.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};f.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),n=this._urlDataSource.getPageType();return this.isValidItem(e,t,n)};return f})(f.default);t.default=p});
define("odsp-next/actions/odc/VersionHistoryAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","../NavigationAction","../base/ItemCommandHelper","../../utilities/features/Features","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../../resources/DataSourceResourceKeys","../showVersionHistoryAction/ShowReactVersionHistoryAction","../base/ItemSelectionHelper","../../models/item/command/OfficeItemCommandKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="VersionHistory";r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(p.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!v.isOneDriveWinApp()&&(this._itemCommandHelper.isCommandSupported(e,d.viewVersionHistory)||!!e&&(e.type===s.default.File||e.type===s.default.Media)&&!e.dateDeletedTime&&a.isFeatureEnabled(a.VersionAllFiles))};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,s,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})];if(this._itemCommandHelper.isCommandSupported(t,d.viewVersionHistory)){s=this.resources.consume(c.url);u=s.getVersionHistoryUrl(f.default.viewerId,t.id);return[2,new(this.managed(o.default))({url:u,target:"_blank"}).execute(e)]}return[2,(new(this.managed(h.default))).execute(e)]}})})};return t})(l.default);t.default=m});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../odb/ActionHelper","@ms/odsp-datasources/lib/Permissions","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/ItemParentHelper","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../base/ItemCommandHelper","../../models/item/command/MetadataItemCommandKeys","ODCOneDrive_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._urlDataSource=n.resources.consume(l.url);n._itemParentHelper=n.resources.consume(f.resourceKey);n._itemCommandHelper=n.resources.consume(h.resourceKey);n._itemSelectionHelper=new(n.child(a.typeResourceKey))({allowMultiSelect:!1,canFallback:!1});return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list,r=!s.default.isFolder(e,!0)&&o.PermissionMask.hasItemPermission(e,o.PermissionMask.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==c.default.TextFileEditor&&!!n&&!n.isExternal&&(n.enableVersions||n.isModerated)&&this._itemCommandHelper.isCommandSupported(e,p.versionHistory)&&3!==e.itemStatus&&4!==e.itemStatus&&r}};return t})(i.default);t.ShowReactVersionHistoryHandler=d;var v=u.create({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./ShowReactVersionHistoryExecutor"],t,n)}))}}},handlerType:d});t.default=v});
define("odsp-next/actions/odb/ActionHelper",["require","exports","./Actions.resx","../../controls/commands/Commands.resx","../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","../../controls/textContainer/TextContainer","../../utilities/features/Features","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=new RegExp("^Templates$","i"),d=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===o.default.Folder||e.type===o.default.OneNote):e&&e.type===o.default.Folder};e.isCheckedOut=function(e){return f.isCheckedOut(e)};e.isCheckedOutByUser=function(e,t){return f.isCheckedOutByUser(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:n.default.FileCheckedoutOrLockedWarningTitle,component:{name:l.default.tagName,params:{text:n.default.FileCheckedoutOrLockedWarning}},actions:[{name:r.default.cancelActionText,execute:function(){return a.default.wrap(2)},icon:new i.default("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!(e.isPendingApproval(t,n)||!h.Killswitch.isActivated("20638368-710f-41c5-b78b-464db07fb707","04/27/2020","No publishing banner for page templates")&&e.isPageTemplate(t))&&(!(c.isFeatureEnabled(c.WexSitePagesScheduling)&&t.properties&&t.properties._ScheduledVersion&&t.properties.owshiddenversion===t.properties._ScheduledVersion)&&(u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return p.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&u.PermissionMask.hasItemPermission(t,u.PermissionMask.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.default=d});
define("@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckOutUserProperty="CheckedOutUserId";function n(e){return!!e.properties[t.CheckOutUserProperty]}t.isCheckedOut=n;function r(e,n){var r=Number(n);return!isNaN(r)&&Number(e.properties[t.CheckOutUserProperty])===r}t.isCheckedOutByUser=r;t.isCheckedOutByOther=function(e,t){return n(e)&&!r(e,t)}});
define("odsp-next/models/item/command/MetadataItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkout=new n.default("checkout");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.viewItem=new n.default("viewItem");t.versionHistory=new n.default("versionHistory");t.exportList=new n.default("exportList")});
define("odsp-next/actions/odc/RearrangeAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/ODCResourceKeys","../NavigationAction","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Rearrange";n._platformDetection=n.resources.consume(u.platformDetection);n._odcUrlDataSource=n.resources.consume(s.urlDataSource);n._item=n.resources.consume(i.currentItem);n._itemCommandHelper=new(n.managed(a.default));n._navigationAction=new(n.managed(o.default))({url:n.createPureComputed(function(){var e=n._item();return n._odcUrlDataSource.getArrangeViewUrl(e.uploadOwnerId,e.id)})});return n}t.prototype.onIsAvailable=function(){var e=this._item();return!this._platformDetection.isMobile&&!!e.folder&&(e.folder.photoCount>1||e.folder.documentCount>1)&&this._itemCommandHelper.isCommandSupported(e,f.rearrange)};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};return t})(r.default);t.default=l});
define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="ApplyOfficeLens";n._item=n.resources.consume(s.currentItem);return n}i.prototype.getExecutorPath=function(){return"./ApplyOfficeLensExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./ApplyOfficeLensExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,o.applyOfficeLens)};return i})(i.default);t.default=u});
define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../base/ItemSelectionHelper","../../base/ExecutorLoader","../../../base/BaseAction","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(t){n.__extends(u,t);function u(n){void 0===n&&(n={});var u=t.call(this,n)||this;u.name="RemoveOfficeLens";u._selectionHelper=new(u.child(s.typeResourceKey))({overrideItem:n.item,allowMultiSelect:!1,canFallback:!1});u._itemCommandHelper=new(u.managed(a.default));u._item=u.resources.consume(i.currentItem);u._loader=new(u.managed(o.default))({path:"./RemoveOfficeLensExecutor",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["./RemoveOfficeLensExecutor"],t,n)}))},getExecutorParams:function(){return{actionName:u.name,selectionHelper:u._selectionHelper,item:u._item.peek()}}});return u}u.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,f.removeOfficeLens)};u.prototype.onExecute=function(e){return this._loader.execute(e)};return u})(u.default);t.default=l});
define("odsp-next/actions/base/OverrideAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/base/ActionInputType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._primary=new(r.managed(t.primary))(t.actionParams);var i=n.__assign(n.__assign({},t.actionParams),{primaryActionName:r._primary.name});r._secondary=new(r.managed(t.secondary))(i);r.name=r._primary.name;r.isAvailable=r._primary.isAvailable;r.isExecuting=r.createPureComputed(r._computeIsExecuting);r.isToggled=r.createPureComputed(r._computeIsToggled);r.inputType=r.createPureComputed(r._computeInputType);return r}t.create=function(e,r){return(function(t){n.__extends(i,t);function i(n){return t.call(this,{primary:e,secondary:r,actionParams:n})||this}return i})(t)};t.prototype.execute=function(e){return this._getAction().execute(e)};t.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary};t.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()};t.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()};t.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():i.default.none};return t})(r.default);t.default=s});
define("odsp-next/actions/printPdf/odc/PrintPdfAction",["require","exports","tslib","../../base/templates/ExecutorAction","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/features/Features","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/logging/events/UsageType","../../../resources/ProviderResourceKeys","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(t){n.__extends(r,t);function r(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="PrintPdf";n._urlDataSource=n.resources.consume(o.urlDataSource);n._instrumentationProvider=n.resources.consume(p.instrumentation);n._platform=n.resources.consume(i.platformDetection);n._navigation=n.resources.consume(s.navigation);n._supportsIframePrint=n._platform.isChrome||n._platform.isSafari;n._isOneDriveXboxApp=d.isOneDriveXboxApp();return n}r.prototype.getExecutorPath=function(){return"./PrintPdfExecutor"};r.prototype.getModuleFactory=function(){return function(){return u.default.resolve(new Promise(function(t,n){e(["./PrintPdfExecutor"],t,n)}))}};r.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};r.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}};r.prototype.onExecute=function(e){var n=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=n._urlDataSource.getPrintPdfUrl(e);c.default.logData({name:l.UsageName[l.UsageName.PrintPdfNative],location:l.LocationName[l.LocationName.OneUp],usageType:h.UsageType[h.UsageType.Click],currentPage:n._instrumentationProvider.currentPageName(),previousPage:n._instrumentationProvider.previousPageName()});n._navigation.navigateTo({url:t,frameId:"_blank"});return u.default.wrap({resultType:a.ResultTypeEnum.Success})}):t.prototype.onExecute.call(this,e)};r.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&!this._isOneDriveXboxApp&&f.isFeatureEnabled(f.UseWebPdfViewer)};return r})(r.default);t.default=v});
define("odsp-next/utilities/logging/odc/UsageNames",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly";e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual";e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly";e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual";e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly";e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual";e[e.OfficeTrial=7]="OfficeTrial";e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree";e[e.OfficeSolo=9]="OfficeSolo";e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore";e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore";e[e.ChangeCurrency=12]="ChangeCurrency";e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions";e[e.FeatureCardStorage=14]="FeatureCardStorage";e[e.FeatureCardProductivity=15]="FeatureCardProductivity";e[e.FeatureCardSecurity=16]="FeatureCardSecurity";e[e.FeatureCardSharing=17]="FeatureCardSharing";e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps";e[e.LaunchFeatureCard=19]="LaunchFeatureCard";e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures";e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle";e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider";e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider";e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider";e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider";e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown";e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick";e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace";e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly";e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly";e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption";e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption";e[e.PrintPdfNative=33]="PrintPdfNative";e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown";e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked";e[e.SharedViaFacebook=36]="SharedViaFacebook";e[e.SharedViaTwitter=37]="SharedViaTwitter";e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn";e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo";e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog";e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog";e[e.InterruptO365Clicked=42]="InterruptO365Clicked";e[e.InterruptOD50Clicked=43]="InterruptOD50Clicked";e[e.DownloadOfficeApps=44]="DownloadOfficeApps";e[e.QuotaUsageClick=45]="QuotaUsageClick";e[e.GetAdditionalStorageClick=46]="GetAdditionalStorageClick";e[e.UnipuxExperimentPurchaseClick=47]="UnipuxExperimentPurchaseClick"})(t.UsageName||(t.UsageName={}));(function(e){e[e.OfficePlansSection=1]="OfficePlansSection";e[e.StoragePlansSection=2]="StoragePlansSection";e[e.UpgradePage=3]="UpgradePage";e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar";e[e.EmbedPane=5]="EmbedPane";e[e.OneUp=6]="OneUp";e[e.SharingDialog=7]="SharingDialog"})(t.LocationName||(t.LocationName={}))});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="SaveAutoAlbum";n._isHidden=e.isHidden||!1;return n}i.prototype.getExecutorPath=function(){return"./SaveAutoAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./SaveAutoAlbumExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return s.isFeatureEnabled(s.EnableEvokeAlignments)&&e&&e.virtualItemType===o.default.Album&&(u.isAutoAlbum(e)||s.isFeatureEnabled(s.EvokeDev))};return i})(i.default);t.default=a});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="DiscardAutoAlbum";return n}i.prototype.getExecutorPath=function(){return"./DiscardAutoAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./DiscardAutoAlbumExecutor"],t,n)}))}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return s.isFeatureEnabled(s.EnableEvokeAlignments)&&e&&e.virtualItemType===o.default.Album&&u.isAutoAlbum(e)};return i})(i.default);t.default=a});
define("odsp-next/actions/saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction",["require","exports","tslib","../../../base/BaseAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ImplicitSaveAutoAlbum";n._action=t.action;n._saveAutoAlbumAction=t.saveAutoAlbumAction;return n}t.prototype.onExecute=function(e,t){var n=this;return this._action.execute(e).then(function(t){n._saveAutoAlbumAction.isAvailable()&&n._saveAutoAlbumAction.execute(e);return t})};t.prototype.onIsAvailable=function(){return this._action.isAvailable()};return t})(r.default);t.default=i});
define("odsp-next/actions/vault/odc/VaultAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../base/templates/ExecutorAction","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../../models/item/ItemParentHelper","../../../dataSources/vault/IVaultDataSource","../../../dataSources/vault/odc/VaultLogHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","../VaultActionType","./VaultHelper","../../base/ItemSelectionHelper","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(t){n.__extends(u,t);function u(e){var n=t.call(this,e)||this;n._itemParentHelper=n.resources.consume(f.resourceKey);n._itemSelectionHelper=new(n.child(v.typeResourceKey))({allowMultiSelect:!0,overrideItem:e.item});n._urlDataSource=n.resources.consume(s.url);n._viewParams=n.resources.consume(i.viewParams);n._vaultActionType=e.actionType;n._isGlobal=e.isGlobal;n._goPremiumSource=e.goPremiumSource;n._shouldShowFRE=!1!==e.shouldShowFRE;n._vaultHelper=new(n.managed(d.default))({});n._isVaultUnlocked=n.observables.createCallback(a.forSingleValue(!1));n._vaultFreState=n.observables.createCallback(a.forSingleValue(l.VaultFreState.NotCreated));n._isVaultDisabled=n.observables.createCallback(a.forSingleValue(!1));n.resources.isDefined(s.vault)&&n.resources.consumeAsync(s.vault).then(function(e){e.vaultStateSubscribe(n._isVaultUnlocked);e.vaultFreSubscribe(n._vaultFreState);e.vaultDisabledSubscribe(n._isVaultDisabled)});n._isOneDriveWinApp=y.isOneDriveWinApp();return n}u.prototype.getExecutorPath=function(){return"./VaultExecutor"};u.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./VaultExecutor"],t,n)}))}};u.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};u.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault")),n=window.localStorage&&!!window.localStorage.getItem("enableWinAppPersonalVault")||!1;if(this._isVaultDisabled())return!1;if(this._vaultActionType===p.default.ShowFiles){var r=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(r.key);return!(this._urlDataSource.getQueryType(i)!==g.default.RecycleBin||this._vaultFreState()!==l.VaultFreState.FreShown||this._isOneDriveWinApp&&!n)&&!this._isVaultUnlocked()}if(this._vaultActionType===p.default.Unlock)return!!(t&&t.vault&&t.vault.isLocked);if(this._vaultActionType===p.default.Lock){var s=this._isGlobal&&this._isVaultUnlocked(),o=e&&e.vault&&e.vault.root&&!e.vault.isLocked;return!(!s&&!o)}return t&&!t.error||this._isVaultUnlocked()};u.prototype.getExecutorParameters=function(){return{actionType:this._vaultActionType,isPickerPage:this._isPickerPage,goPremiumSource:this._goPremiumSource}};u.prototype.onExecute=function(e,n){var i=this._urlDataSource.getPageType(this._viewParams.peek()),s=this._urlDataSource.getQueryType(this._viewParams.peek());this._isPickerPage=i===m.default.FilePicker||i===m.default.FolderPicker;var u=window.localStorage&&!!window.localStorage.getItem("enableWinAppPersonalVault")||!1;o.Engagement.logData({name:"Vault."+c.getVaultActionName(this._vaultActionType),extraData:{location:c.getPageName(i,s)}});if(this._vaultActionType===p.default.Unlock&&(!this._isOneDriveWinApp||u)&&!this._isPickerPage){var a=this._vaultFreState.peek();if(this._shouldShowFRE&&(a===l.VaultFreState.BubbleShown||a===l.VaultFreState.Created)){this._vaultActionType=p.default.FreDialog;return t.prototype.onExecute.call(this,e,n)}var f=this._vaultActionType.toString();return this._vaultHelper.unlockPopup().then(function(e){return e?r.default.resolve({name:f,resultType:h.ResultTypeEnum.Success}):r.default.reject({name:f,resultType:h.ResultTypeEnum.Failure})})}return t.prototype.onExecute.call(this,e,n)};return u})(u.default);t.default=b});
define("odsp-next/dataSources/vault/IVaultDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotCreated=-1]="NotCreated";e[e.Created=0]="Created";e[e.BubbleShown=1]="BubbleShown";e[e.FreShown=2]="FreShown"})(t.VaultFreState||(t.VaultFreState={}));t.STORAGE_KEY_VAULT_PREFIX="oneDriveVault";t.STORAGE_KEY_VAULT_CANARY="canary";t.VAULT_FREE_FILE_LIMIT=3});
define("odsp-next/dataSources/vault/odc/VaultLogHelper",["require","exports","../../url/PageType","../../url/QueryType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["","Lock","Unlock","Manage","FreDialog","Unlock","Reset","Debug","FilesRemaining"];t.VAULT_GOPREMIUM_SOURCE_ICONCOMMAND="PVault-IconUpsell";t.VAULT_GOPREMIUM_SOURCE_QUOTABANNERLEARNMORE="PVault-QuotaBannerLearnMore";t.VAULT_GOPREMIUM_SOURCE_QUOTABANNER="PVault-QuotaBannerGoPremium";t.VAULT_GOPREMIUM_SOURCE_QUOTAERROR="PVault-QuotaErrorLearnMore";t.getVaultActionName=function(e){return i[e]};t.getPageName=function(e,t){var i;switch(e){case n.default.Files:i="Files";break;case n.default.Restore:i="Restore";break;case n.default.RansomwareDetection:i="RansomwareDetection";break;case n.default.ManageVault:i="ManageVault";break;default:i=""}return t?i+"-"+r.default[t]:""+i}});
define("odsp-next/actions/vault/odc/VaultHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/icons/Icon","../../../providers/dialog/DialogProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Signal","../../../controls/htmlContainer/HTMLContainer","./VaultAction.resx","../../../dataSources/vault/odc/VaultDataSource.key","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._identityDataSource=n.resources.consume(u.identity);n._isOneDriveWinApp=d.isOneDriveWinApp();return n}t.prototype.unlockPopup=function(){this._unlockSignal=new l.default;this._showPopupNotice();if(this._isOneDriveWinApp){this.events.on(window,"StrongAuthTokenFromWinApp",this._onReceivedTokenFromWinApp);this._showLoginPopupForWinApp()}else{this.events.on(window,"message",this._onReceivedMessage);this._createLoginPopup()}return this._unlockSignal.getPromise()};t.prototype._onReceivedMessage=function(e){var t=this;if(this._loginPopup&&e.origin===window.location.origin&&e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}if(n&&n.isVault){this.async.clearInterval(this._popupInterval);this._popupInterval=0;var r=new f.Qos({name:"VaultHelper.FinalizeUnlock"});if(n.success){n.canary&&(FilesConfig.canary=n.canary);n.navCanary&&(FilesConfig.navCanary=n.navCanary);this.resources.consumeAsync(p.resourceKey).then(function(e){e.unlockVault().then(function(){r.end({resultType:f.ResultTypeEnum.Success});t._popupNoticeDialog.complete();t._unlockSignal.complete(n.success);t._loginPopup.close();t._loginPopup=null}).catch(function(){r.end({resultType:f.ResultTypeEnum.Failure,resultCode:"UnlockSessionMismatch",error:n.error&&n.error.message||"Unknown"});t._showUnlockError()})})}else{r.end({resultType:f.ResultTypeEnum.Failure,resultCode:"UnlockFailure",error:n.error&&n.error.message||"Unknown"});this._showUnlockError()}}}};t.prototype._showUnlockPopBlockError=function(){this._popupNoticeDialogText(h.default.popupNoticeText+'<p class="ms-fontColor-error">'+h.default.popupBlockedFailureText+"</p>");i.Engagement.logData({name:"Vault.VerificationNeeded.Blocked"});this._loginPopup=null};t.prototype._showUnlockError=function(){this._popupNoticeDialogText(h.default.popupNoticeText+'<p class="ms-fontColor-error">'+h.default.popupNoticeFailureText+"</p>");i.Engagement.logData({name:"Vault.Unlock.Failed"});this._unlockSignal.complete(!1);if(this._loginPopup){this._loginPopup.close();this._loginPopup=null}};t.prototype._createLoginPopup=function(){var e=this._identityDataSource.getAuthUrl("msa_strong_auth:"),t=window.screenX,n=window.screenY,r=window.outerWidth,i=window.outerHeight,s=t+Math.max(r-500,0)/2,o=n+Math.max(i-500,0)/2;this._loginPopup=window.open(e,"vaultPopup","width=500,height=500,top="+o+",left="+s+",status=no,resizeable=yes,toolbar=no,menubar=no,scrollbars=yes");this._monitorLoginPopup()};t.prototype._monitorLoginPopup=function(){var e=this;this._popupInterval||(this._popupInterval=this.async.setInterval(function(){if(e._loginPopup)if(e._loginPopup.closed){e.async.clearInterval(e._popupInterval);e._popupInterval=0}else try{e._loginPopup.postMessage("updating reference of parent to support navigations in auth popup",window.location.origin)}catch(t){t&&"TypeError"===t.name&&e._showUnlockPopBlockError()}else{e.async.clearInterval(e._popupInterval);e._popupInterval=0}},500))};t.prototype._showPopupNotice=function(){var e=this;if(!this._popupNoticeDialog||1!==this._popupNoticeDialog.state.peek()){var t=this.resources.consume(o.resourceKey),n=h.default.popupNoticeTitle;this._popupNoticeDialogText=this.observables.create(h.default.popupNoticeText);this._popupNoticeDialog=t.requestDialog({title:n,isSoftDismissable:!1,component:{name:c.default.tagName,params:{html:this._popupNoticeDialogText}},actions:[{name:h.default.popupNoticeLinkText,execute:function(){return e.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new s.default("CheckMark"),isDefault:!0}]});this._logVaultEvent("Vault.VerificationNeeded.Shown");this._popupNoticeDialog.wait().catch(function(){if(e._loginPopup&&3===e._popupNoticeDialog.state.peek()){e._logVaultEvent("Vault.VerificationNeeded.Dismiss");e._unlockSignal.cancel();e._loginPopup.close();e._loginPopup=null}});this._popupNoticeDialog.wait().then(function(){e._loginPopup&&2===e._popupNoticeDialog.state.peek()&&e._logVaultEvent("Vault.VerificationNeeded.Succeeded")})}};t.prototype.onDialogExecute=function(){this._logVaultEvent("Vault.VerificationNeeded.ShowPopup");if(this._loginPopup&&!this._loginPopup.closed)try{this._loginPopup.focus()}catch(e){}else this._isOneDriveWinApp?this._showLoginPopupForWinApp():this._createLoginPopup();return a.default.resolve(1)};t.prototype._logVaultEvent=function(e){i.Engagement.logData({name:e})};t.prototype._showLoginPopupForWinApp=function(){this._identityDataSource.getSessionToken(void 0,!0)};t.prototype._onReceivedTokenFromWinApp=function(e){var t=this,n=new f.Qos({name:"VaultHelper.PWA.FinalizeUnlock"});if(e.detail.error||!e.detail.token){n.end({resultType:f.ResultTypeEnum.Failure,resultCode:"UnlockFailure",error:e.detail.error||"Unknown"});this._showUnlockError()}else this.resources.consumeAsync(p.resourceKey).then(function(r){r.unlockVault(!1,e.detail.token).then(function(){n.end({resultType:f.ResultTypeEnum.Success});t._popupNoticeDialog.complete();t._unlockSignal.complete(!0)}).catch(function(){n.end({resultType:f.ResultTypeEnum.Failure,resultCode:"UnlockSessionMismatch",error:e.detail.error||"Unknown"});t._showUnlockError()})})};return t})(r.default);t.default=v});
define("odsp-next/controls/htmlContainer/HTMLContainer",["require","exports","./HTMLContainer.html","./HTMLContainerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-html-container",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/htmlContainer/HTMLContainer.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="HTMLContainer" data-bind="html:html"></div>'});
define("odsp-next/controls/htmlContainer/HTMLContainerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.html=t.html;return n}return t})(r.default);t.default=i});
define("odsp-next/actions/showShareMultiItem/ShowShareMultiItemAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/DataSourceResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../../dataSources/url/QueryType","../base/ItemRedeemer"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemRedeemer=n.resources.consume(c.resourceKey);n._isEdit=t.isEdit;n._isSecureShare=t.isSecureShare;n._defaultRecipients=t.defaultRecipients;n._itemsBeingShared=t.focusItems;n._selectionHelper=new(n.child(o.typeResourceKey))({overrideItem:null,allowMultiSelect:!0,canFallback:!0});n._urlDataSource=n.resources.consume(i.url);n._itemCommandHelper=n.resources.consume(a.resourceKey);n.name="ShowShareMultiItemAction";return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._selectionHelper.selection().length,n=t>1&&e.queryType===l.default.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,f.share)&&!n&&!r&&!i};t.prototype.onExecute=function(e,t){var n=this;this._itemsBeingShared.peek()&&this._itemsBeingShared(void 0);var i=this._selectionHelper.selection().map(function(e){return e.peek()});return this._itemRedeemer.redeemItems(i,this).then(function(){n._itemsBeingShared({items:i,defaultRecipients:n._defaultRecipients,isEdit:n._isEdit,isSecureShare:n._isSecureShare});return u.default.wrap({resultType:r.ResultTypeEnum.Success})},function(e){return u.default.reject(e)})};return t})(s.default);t.default=h});
define("odsp-next/actions/DeferredAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/ActionInputType","../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=this,r=t.load,o=t.actionParams,a=(n=e.call(this,o)||this).resources.consume(u.bundleLoader.optional);n.isQosLogged=!1;n.name=("Deferred"+t.modulePath).replace(/Action|\.|\//g,"");n._action=n.createObservable();var f=new s.default;(a?a.waitForPLT().then(r):i.default.resolve(r())).done(function(e){return f.complete(e)},function(e){return f.error(e)});n._getActionPromise=n.trackPromise(f.getPromise().then(function(e){return new(n.managed(e))(o)}));n._getActionPromise.done(function(e){return n._action(e)});n.inputType=n.createPureComputed(n._computeInputType);return n}t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()};t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()};t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})};t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():o.default.none};return t})(r.default);t.create=function(e,t){var r;function i(){return r||(r=t())}return(function(t){n.__extends(r,t);function r(n){return t.call(this,{load:i,modulePath:e,actionParams:n})||this}return r})(a)}});
define("odsp-next/dataSources/itemCommand/odc/ItemCommandDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/command/ItemCommand","../../item/odc/SkyApiCommands","../../../models/item/command/CoreItemCommandKeys","../../../models/item/command/SocialItemCommandKeys","../../../models/item/command/PhotoItemCommandKeys","../../../models/item/command/CustomizationItemCommandKeys","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/command/OfficeItemCommandKeys","../../../models/item/command/WebItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){var t={};for(var n in e){var r=e[n];if(r instanceof Array)for(var i=0,s=r;i<s.length;i++){t[s[i].id]=n}else t[r.id]=n}return t})(((p={})[s.abdicatePermissions]=u.removeFromShared,p[s.addCoverPhoto]=f.addAsCoverPhoto,p[s.applyOfficeLens]=a.applyOfficeLens,p[s.addTag]=a.removeTags,p[s.addToAlbum]=[a.addToAlbum,a.editTags],p[s.addToSharedList]=u.addToShared,p[s.changeExpiration]=l.changeExpiration,p[s.comment]=u.comment,p[s.copy]=l.copyFrom,p[s.createExcel]=c.createExcel,p[s.createExcelSurvey]=c.createSurvey,p[s.createFolder]=l.createFolder,p[s.createMountPoint]=u.addAsMountPoint,p[s.createOneNote]=c.createOneNote,p[s.createPowerPoint]=c.createPowerPoint,p[s.createWord]=c.createWord,p[s.defaultClick]=o.defaultClick,p[s.deleteCommand]=l.deleteItem,p[s.download]=h.download,p[s.editSurvey]=c.editSurvey,p[s.embed]=u.embed,p[s.emptyRecycleBin]=l.deleteAllItems,p[s.modifyCaption]=a.editCaption,p[s.move]=l.moveFrom,p[s.openInOffice]=c.openInClient,p[s.openInTextEditor]=l.openInTextEditor,p[s.openPdfInBrowser]=l.openPdfInBrowser,p[s.playAudio]=a.play,p[s.rearrange]=f.rearrange,p[s.removeCoverPhoto]=f.removeAsCoverPhoto,p[s.removeFromAlbum]=a.removeFromAlbum,p[s.removeFromRecent]=f.removeFromRecent,p[s.removeMountPoint]=u.removeAsMountPoint,p[s.rename]=l.rename,p[s.removeOfficeLens]=a.removeOfficeLens,p[s.reportAbuse]=u.reportAbuse,p[s.requestReview]=u.requestReview,p[s.restore]=l.restoreItem,p[s.restoreAll]=l.restoreAllItems,p[s.rotate]=a.rotate,p[s.share]=[u.share,a.addPhotosToAlbum],p[s.shareSurvey]=c.publishSurvey,p[s.upload]=[h.upload,l.createText],p[s.viewInBrowser]=c.openOnline,p[s.viewOriginal]=a.viewOriginal,p[s.viewSurvey]=c.viewSurvey,p[s.viewVersions]=c.viewVersionHistory,p));var m={1:1,2:2,3:3,4:4,7:7,6:6,10:10,11:11,15:15,50:50},g={1:1,2:2,3:3,4:4,5:5,6:6,7:7},y={1:1,2:2},b=((d={})[s.openInTextEditor]=!0,d[s.openPdfInBrowser]=!0,d),w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCommand=function(e,t){var n,r=this._getCommandName(t);if(r){var s=this._getActionId(e,r);if(s)switch(t){case o.defaultClick:n=this._createDefaultClickCommand(s);break;case c.openInClient:n=this._createOpenInClientCommand(s);break;case c.createWord:case c.createExcel:case c.createPowerPoint:case c.createOneNote:n=this._createCreateDocumentCommand(s);break;default:n=new i.default}else this._isGeneralSupportedCommand(r)&&(n=new i.default)}return n};t.prototype._getActionId=function(e,t){var n;e&&e.properties&&e.properties.commandsSupported&&(n=e.properties.commandsSupported[t]);return n};t.prototype._isGeneralSupportedCommand=function(e){return b[e]};t.prototype._getCommandName=function(e){return(function(e){return v[e.id]})(e)};t.prototype._createDefaultClickCommand=function(e){var t=m[e]||0;return new i.default({behavior:t})};t.prototype._createOpenInClientCommand=function(e){var t=g[e]||0;return new i.default({behavior:t})};t.prototype._createCreateDocumentCommand=function(e){var t=y[e]||0;return new i.default({behavior:t})};return t})(r.default);t.default=w});
define("odsp-next/models/item/command/ItemCommand",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t};t.default=n});
define("odsp-next/dataSources/processFilters/odc/ProcessFiltersDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/vroom/VroomDataRequestor"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;(function(e){e[e.OfficeLens=0]="OfficeLens"})(s||(s={}));var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.applyOfficeLens=function(e){var t=this.resources.consume(i.resourceKey),n={name:s[s.OfficeLens]};return t.send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses",requestType:"POST",postData:JSON.stringify(n)})};t.prototype.removeOfficeLens=function(e){return this.resources.consume(i.resourceKey).send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses/"+s[s.OfficeLens],requestType:"DELETE"})};return t})(r.default);t.default=o});
define("odsp-next/providers/processFilters/ProcessFiltersProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../item/ItemProvider","../../models/task/Task"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._processFiltersDataSource=n.resources.consume(s.processFilters);n._itemProvider=n.resources.consume(o.resourceKey);return n}t.prototype.applyOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.applyOfficeLens.bind(this))};t.prototype.removeOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.removeOfficeLens.bind(this))};t.prototype._updateOfficeLens=function(e,t,n){var i=this,s=[new u.default(e.item.key,e.item)];t.update(s);return n(e).then(function(){i._itemProvider.invalidateItem(e.parentKey);i._itemProvider.invalidateItem(e.item.key,{triggerFetch:!0});s=s.map(function(e){return e.succeed()});t.update(s)},function(e){s=s.map(function(t){return t.fail(e)});t.update(s);return r.default.wrapError(e)})};return t})(i.default);t.default=a});
define("odsp-next/providers/winApp/xbox/DirectionalNavigation",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function t(){}t.init=function(){new Promise(function(t,n){e(["directional-navigation"],t,n)})};return t})();t.default=n});
define("odsp-next/utilities/experiment/ExperimentHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../features/Features","@ms/odsp-utilities/lib/logging/events/Experiment.event","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(u.navigation);n._userInfoProvider=n.resources.consume(a.userInfo);return n}t.prototype.isExperimentManualTest=function(e){return!!this._navigation.viewParams["EXPExperimentTest_e"+e]};t.prototype.isInapplicableEnvironment=function(){var e="edog"===(window._spPageContextInfo&&window._spPageContextInfo.env);return!(!window.$Config||!window.$Config.isINT)||e};t.prototype.startEXPExperimentBehindFeature=function(e,t){var n=this,o=t.experimentId,u=t.experimentName,a=t.variationMap,f=t.getVariationFunction;if(i.isFeatureEnabled(e)){if(this.isExperimentManualTest(o)){var l=this._navigation.viewParams["EXPExperimentTest_e"+o],c=Number(l);return isNaN(c)||!a[c]?r.default.wrap(0):r.default.wrap(c)}return this.getExperimentVariation(o,f).then(function(t){t&&!n.isInapplicableEnvironment()&&s.default.logData({name:e.ODC?String(e.ODC):String(e.ODB),isInRamp:!0,experiment:u,variant:a[t]&&a[t].name});return t})}return r.default.wrap(0)};t.prototype.getExperimentVariation=function(e,t){var n=this;return this._userInfoProvider.getEXPExperimentVariation(e).then(function(s){if(s)return r.default.wrap(s);var o=n.resources.consume(f.identity.optional).getIdentity().id,u=t(o);new l.Qos({name:"ExpHelper.Assignment."+e}).end({resultType:l.ResultTypeEnum.Success,resultCode:"Variation."+u});return i.isFeatureEnabled(i.ExpFactCleanup)?n._userInfoProvider.setEXPExperimentVariation(e,u,p).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)}):n._userInfoProvider.setEXPExperimentVariation(e,u).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)})})};return t})(o.default);t.default=h;(function(e){e[e.Iconography=219512403]="Iconography";e[e.ReaectShell=631936892]="ReaectShell";e[e.QuotaUxRevision=1]="QuotaUxRevision";e[e.QuotaUxRevisionAA=2]="QuotaUxRevisionAA";e[e.QuotaUxRevision2=3]="QuotaUxRevision2";e[e.QuotaUxRevisionAA2=4]="QuotaUxRevisionAA2";e[e.Unknown1=313862562]="Unknown1";e[e.Unknown2=758340426]="Unknown2";e[e.Unknown3=860081470]="Unknown3";e[e.Unknown4=860647394]="Unknown4";e[e.Unknown5=911653430]="Unknown5";e[e.Unknown6=973349173]="Unknown6"})(c=t.ExperimentId||(t.ExperimentId={}));var p=[c.Iconography,c.ReaectShell]});
define("odsp-next/utilities/educationAndUpsells/EducationAndUpsells",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../providers/inAppMessaging/InAppMessagingProvider.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey("EducationAndUpsells");var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.url);var r=n.resources.consume(s.navigation);n._newUserOverride=r.viewParams.forceNewUser;return n}t.prototype.getExistingUserTypeOfPremiumUpsell=function(e,t,n){var r=this;void 0===n&&(n=!1);return this._checkIsRootAndValid(e,t)?this.getIsNewUser(e,t).then(function(e){return e?u.default.wrap():r.resources.consumeAsync(a.resourceKey).then(function(e){return e.getPremiumUpsellType()})}):u.default.wrap()};t.prototype.getAreNoFilesAdded=function(e){if(this._newUserOverride)return!0;for(var t=0,n=0,r=0,i=e.content().items;r<i.length;r++){var s=i[r];if(void 0===s)return!1;if(s().folder){t++;if(s().childCount>0)return!1}else n++;if(t>2||n>1)return!1}return!0};t.prototype.getIsNewUser=function(e,t){return this._checkIsRootAndValid(e,t)?this.resources.consumeAsync(a.resourceKey).then(function(e){return e.isAnyMessageActive(206)}):u.default.wrap(!1)};t.prototype._checkIsRootAndValid=function(e,t){return e.key===this._urlDataSource.getRootItemKey()&&!t.isPlaceholder&&!t.isExpired};return t})(r.default);t.default=f});
define("odsp-next/providers/inAppMessaging/InAppMessagingProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InAppMessagingProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/teachingBubble/odc/TeachingBubbleDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMaxDisplayBubbleCount=function(){return 1};return t})(r.default);t.default=i});
define("odsp-next/dataSources/recycleBin/odc/RecycleBinDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","../../../models/item/ItemType","../../../models/item/OneDriveItem","../../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(i.url);return n}t.prototype.getRecycleBinItem=function(e){var t=this._urlDataSource.getRootItemKey(a.default.RecycleBin),n=new u.default(t);s.default(n,{key:t,queryType:a.default.RecycleBin,properties:{commandsSupported:{defc:"1"}},type:o.default.Folder,isRootFolder:!0});return n};return t})(r.default);t.default=f});
define("odsp-next/providers/recycleBin/RecycleBinProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(r.recycleBin);return n}t.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)};return t})(i.default);t.default=s});
define("odsp-next/providers/dragAndDropRobot/DragAndDropRobotProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../controls/dragAndDrop/dragAndDropHint/DragAndDropHint","../../controls/overlayContent/NeedsOverlayContent.key"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null};t.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)};t.prototype._getDragAndDropHintComponent=function(e,t){this._needsOverlayContent.needsOverlayContent(!0);return{name:i.default.tagName,params:{isRobotVisible:t(),isGridView:e()}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{needsOverlayContent:s.resourceKey});return t})(r.default);t.DragAndDropRobotProvider=o;t.default=o});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint",["require","exports","./DragAndDropHint.html","./DragAndDropHintViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-drag-and-drop-hint",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showDropHint()--\x3e<div class="od-DragAndDropHint" data-bind="css:{\'od-DragAndDropHint--grid\':isGridView,\'ms-slideLeftIn40\':isAnimationClassApplicable()&&isGridView,\'ms-slideUpIn20\':isAnimationClassApplicable()&&!isGridView,\'is-animating\':isReady()&&(isAnimationApplicable&&!isAnimationClassApplicable())}"><div class="od-DragAndDropHint-box" data-bind="css:{\'od-DragAndDropHint-box--grid\':isGridView,\'od-DragAndDropHint-box--robot\':isRobotVisible}">\x3c!--ko if:isGridView--\x3e<div class="od-DragAndDropHint-fileContainer"><img class="od-DragAndDropHint-file" data-bind="attr:{src:fileImageUrl}"></div>\x3c!--/ko--\x3e<div class="od-DragAndDropHint-text" data-bind="text:dropSuggestionText,css:{\'od-DragAndDropHint-text--grid\':isGridView}"></div></div>\x3c!--ko if:isRobotVisible--\x3e<div class="od-DragAndDropHint-robot" data-bind="style:{\'background-image\':robotImageUrl},css:{\'od-DragAndDropHint-robot--grid\':isGridView,\'od-DragAndDropHint-robotAnimation\':isReady()&&isAnimationApplicable}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHintViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../DragAndDrop.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../../utilities/dragAndDropRobot/DragAndDropAnimationHelper.key","../../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../../controls/firstRunExperience/FirstRunExperienceStatus","../../../utilities/browser/WebViewDetector","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(h.actionMap);n._isItemSetRendered=n.resources.consume(h.isItemSetRendered);n._platformDetection=n.resources.consume(o.platformDetection);n._bundleLoader=n.resources.consume(p.bundleLoader);var r=n.resources.consume(u.resourceKey),a=new(n.managed(n._actionMap.UploadAction))({uploadProcessorType:i.UploadProcessorType.Html5file});n._isUploadAvailable=a.isAvailable;n._firstRunExperienceStatus=n.resources.consume(f.resourceKey);n._isOneDriveXboxApp=c.isOneDriveXboxApp();n.isGridView=t.isGridView;n.showDropHint=n.createPureComputed(n._computeShowDropHint);n.dropSuggestionText=n.isRobotVisible?s.default.DragAndDropHintEmptyRobotText:s.default.DragAndDropHintText;n.fileImageUrl=window.require.toUrl("odsp-media/images/odrobot/dragfilegrid.svg");n.isAnimationApplicable=!1;n.isAnimationClassApplicable=n.createObservable(!1);n.isReady=n.createObservable(!1);n.isRobotVisible=t.isRobotVisible;if(n.isRobotVisible){n.createBackgroundComputed(n._computeShowRobotAnimation);n.robotImageUrl=n.createPureComputed(n._computeRobotImageUrl)}else n.isReady(!0);n.createBackgroundComputed(function(){n.showDropHint()&&n.isRobotVisible&&r.logData({name:"DragAndDropRobot.Show",extraData:{isGridView:n.isGridView}})});return n}t.prototype._computeShowRobotAnimation=function(){var e=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded();this.resources.consumeAsync(a.resourceKey).then(function(t){if(e._isBundleLoaded)if(!t.getInitialized()&&e.isRobotVisible&&e._firstRunExperienceStatus()!==l.FirstRunExperienceStatus.visible){t.setIsInitialized(!0);t.setIntializeTime();e.isAnimationApplicable=!0;e._setAnimationTimer();e.isReady(!0)}else if(t.getInitialized()){e.isAnimationApplicable=!0;e.isReady(!0);e._setAnimationTimer()}})};t.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&!this._isOneDriveXboxApp&&this._isItemSetRendered()&&this.isReady()};t.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};t.prototype._computeRobotImageUrl=function(){if(this.isReady()){return"url('"+window.require.toUrl("odsp-media/images/odrobot/"+(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg"))+"')"}return""};return t})(r.default);t.default=d});
define("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".dragAndDropAnimationHelper",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DragAndDropAnimationHelper"],t,n)}).then(function(e){return e.resourceKey})})});t.default=t.resourceKey});
define("odsp-next/dataSources/winApp/wip/odc/WIPDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._isWinAppWipEnabled=t.platformDetection.isWinAppWipEnabled}e.prototype.isWIPEnabled=function(){return this._isWinAppWipEnabled};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{platformDetection:r.platformDetection})});
define("odsp-next/controls/list/columns/ListColumns",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.columnMenuHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".columnMenuHelperType",loader:new r.AliasResourceLoader(function(){return n.default.resolve(new Promise(function(t,n){e(["../../columnsHeader/ColumnMenuHelper"],t,n)})).then(function(e){return e.typeResourceKey.local})})});t.addColumnCommandHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".addColumnCommandHelperType",loader:new r.AliasResourceLoader(function(){return n.default.resolve(new Promise(function(t,n){e(["../../columnsHeader/AddColumnCommandHelper"],t,n)})).then(function(e){return e.typeResourceKey.local})})})});
define("odsp-next/dataSources/pushChannel/odc/PushChannelDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./PushChannelDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/pushChannel/PushChannelProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./PushChannelProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/rootItems/odc/RootItems.key",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../item/ItemTaskObserver","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../item/ItemTaskObserver","../../../models/store/ItemsStore",".././RootItemsTypeFilter.key","../../../controls/leftPane/LeftPane.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={itemTaskObserverType:f.resourceKey,itemsStore:l.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,rootItemsTypeFilter:c.resourceKey.optional,urlDataSource:a.url};t.resourceKey=new i.ResourceKey({name:e("module").id+".rootItems",factory:{dependencies:p,create:function(e){var t=e.itemsStore,r=e.rootItemsTypeFilter,i=e.urlDataSource,a=new e.observablesFactoryType,f=new e.itemTaskObserverType,l=i.getKey(n.__assign(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.Files))),i.saveItemTypeFilter(r))),c=i.getKey(n.__assign(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.Recent))),i.saveItemTypeFilter(r))),p=i.getKey(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.AllMyPhotos))));f.update([new s.Task(l).succeed({item:{key:l,name:s.Graft.backup(h.default.Files),displayName:s.Graft.backup(h.default.Files),type:s.Graft.backup(o.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new s.Task(c).succeed({item:{key:c,name:s.Graft.backup(h.default.Recent),displayName:s.Graft.backup(h.default.Recent),type:s.Graft.backup(o.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new s.Task(p).succeed({item:{key:p,name:s.Graft.backup(h.default.Photos),displayName:s.Graft.backup(h.default.Photos),type:s.Graft.backup(o.default.Folder),displayType:s.Graft.backup(u.default.AllMyPhotos),properties:{commandsSupported:{defc:"1"}}}})]);f.flush();return{instance:a.create({files:t.getItem(l),recent:t.getItem(c),photos:t.getItem(p)}),disposable:a}}}})});
define("odsp-next/dataSources/rootItems/RootItemsTypeFilter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemAutoRefreshDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/itemAutoRefresh/ItemAutoRefreshProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemAutoRefreshProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/inAppMessaging/odc/InAppMessagingDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InAppMessagingDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/mruRecent/odc/MruRecentDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./MruRecentDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemActivityFeedHelper"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedSharingHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemActivityFeedSharingHelper"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemActivityFeed/odc/ItemCommentsDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCommentsDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/checkUserAccess/CheckUserAccessDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./CheckUserAccessDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/winApp/communication/odc/WinAppCommunicatorDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppCommunicatorDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/winApp/keyboardHelper/WinAppKeyboardHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppKeyboardHelper"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/quota/WinAppQuotaProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppQuotaProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/profilechangehandler/ProfileChangeHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ProfileChangeHandler"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/resources/FloodgateResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.floodgateAppId=new n.ResourceKey("floodgate.appId")});
define("odsp-next/dataSources/infoPane/InfoPaneManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/dataSources/infoPane/odc/InfoPaneManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:""+e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InfoPaneManager"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/dataSources/item/odc/ItemMuteNotificationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../../resources/ProviderResourceKeys","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){this._subscriptionsProvider=t.subscriptionsProvider;this._urlDataSource=t.urlDataSource}e.prototype.getNotificationState=function(e,t){var n=this;this._subscription=void 0;return this._subscriptionsProvider.getSubscriptions(e,t).then(function(e){for(var t=!0,r=n._urlDataSource.getOwnerId(void 0,{}).toLowerCase(),i=0,s=e;i<s.length;i++){var o=s[i],u=o.createdBy&&o.createdBy.user;if(u&&u.id&&u.id.toLowerCase()===r){n._subscription=o;t=!o.muted}}return t},function(e){})};e.prototype.updateNotificationState=function(e,t,n){var r={subscription:this._subscription,item:t,isOn:!e,apiNamePrefix:n};return this._subscriptionsProvider.updateSubscription(r).then(function(){return{}},function(e){})};e.dependencies=n.__assign(n.__assign({},r.default.dependencies),{subscriptionsProvider:s.subscriptions,urlDataSource:o.url});return e})();t.default=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u,n.__assign(n.__assign({},r.default.dependencies),{subscriptionsProvider:s.subscriptions,urlDataSource:o.url}))});
define("odsp-next/utilities/dom/DomLoad",["require","exports","@ms/odsp-utilities/lib/async/Async","../killSwitch/KillSwitch","@uifabric/utilities/lib/EventGroup"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.default.isActivated("AF0DA10B-7983-4CD8-A61D-340EDD4388AD","04/16/2019","disableWaitForDOMContentLoaded"),o=r.default.isActivated("065324A7-7C6C-437D-9225-F22878BB872D","01/16/2020","disableWaitForDocumentBody");t.waitForDomLoad=function(e){var t=this;if(s||!o&&document.body||"interactive"===document.readyState||"complete"===document.readyState){e(!1);return Promise.resolve(!1)}return new Promise(function(r,s){var u=function(){try{e(!0);r(!0)}catch(e){s(e)}};if(o){var a=new i.EventGroup(t);a.on(document,"DOMContentLoaded",function(){a.off(document,"DOMContentLoaded");u()})}else var f=new n.default,l=f.setInterval(function(){if(document.body){f.clearInterval(l);u()}},5)})}});
define("odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./FirstRunExperienceDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/firstRunExperience/FirstRunExperienceDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/utilities/logging/odc/RUMOneHelperFull",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger","../RUMOneHelper","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-shared/lib/utilities/logging/events/ListViewStartRender.event","@ms/odsp-shared/lib/utilities/logging/events/ListViewRendered.event","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/rumone/PageTransitionType","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-utilities/lib/performance/PerformanceMarker","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="OnePage.LoadRequireJS.Start",y="OnePage.LoadRequireJS.End",b=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.logListViewStart=function(e){if((u.ListViewStartRender.isTypeOf(e)||f.Action.isTypeOf(e)&&e.data&&"Open"===e.data.name&&e.data.folder)&&r.rumone){r._reset();r.mark("ListViewUpdate.Start");r.rumone.addExpectedControl(r.scenarioPrefix+"ListView")}};r.logListViewEnd=function(e){a.ListViewRendered.isTypeOf(e)&&r.rumone.expectingControl(r.scenarioPrefix+"ListView")&&r.logRUMOneForListView(d.default.now())};o.Manager.addLogHandler(r.logListViewStart);o.Manager.addLogHandler(r.logListViewEnd);r.rumone=i.default.getRUMOneLogger();return r}t.prototype.logRUMOneForListView=function(e){var t=this.rumone,r=this._breakdownData;if(t&&t.isRunning()&&!this.listViewLogged){t.addExpectedControl(this.scenarioPrefix+"ListView");var i=c.default[this.urlDataSource.getPageType(this._viewParams)]+"-"+(h.default[this.urlDataSource.getQueryType(this._viewParams)]||"Default");t.writeScenarioId(this.scenarioPrefix+this.listInfo+"."+i);var s=this._getPageTransitionTypeForListView();t.writePageTransitionType(s);var o=this._getRequiredQuietnessDurationInMilliseconds();t.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(e,t){return(function(e,t){return l.default.fullPageLoad,e})(e,t.PageTransitionType)},options:n.__assign({useMutationObserver:!1,trackNetworkRequests:!1},o)}}});t.collectW3CPerfTimings();s===l.default.fullPageLoad&&t.collectW3cResourceTimings();void 0!==window.g_duration&&void 0!==window.g_iisLatency&&t.writeServerSideLatency(window.g_duration,window.g_iisLatency);this._logColdHit(t);var u=void 0,a=Number(t.getPerformanceDataPropertyValue("W3cNavigationStart")),f=this._getTimingNormalizer(a);e=f(e);var v=f(t.readTempData("appDataFetchStart")),g=f(t.readTempData("appDataFetchEnd")),y=g-v,b=this._CollectBreakDown(),w=!!document.getElementById("requireJsString");t.addEUPLBreakdown("inlineRequireJS",{data:w,needFlatten:!0});t.addEUPLBreakdown("isItemsView",{data:!1,needFlatten:!0});if(s===l.default.fullPageLoad){var E=f(t.getMarkerTime(d.AppStartMarkerName)),S=f(t.getMarkerTime("EUPL.AppBoot.NewStart"));t.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0});u=f(a);var x=d.default.summary,T=e-E-(x.dataFetch||0);m.extend(b,{w3cResponseEnd:r(d.default.getResponseEnd()-a),appStart:r(x.appStart),newAppStart:r(x.appStart-E+S),newAppStartTime:r(S),dataFetch:r(x.dataFetch),render:r(T),prefetchStart:r(x.prefetchStart),deferredListDataRender:r(x.deferredListDataRender),preRender:r(x.preRender),postRender:r(x.postRender)})}else if(s===l.default.none){u=f(t.getMarkerTime("ListViewUpdate.Start"));m.extend(b,{dataFetch:r(y),render:r(e-u-(y||0)),preRender:r(v-u),postRender:r(e-g)})}t.mark("glass");this._logServiceWorkerMetrics(t);var N=f(t.getMarkerTime("AppBoot.DOMContentLoaded"));if(!isNaN(N)){var C=f(t.getMarkerTime("AppBoot.Start"));t.addEUPLBreakdown("timeWaitForBody",{data:N-C,needFlatten:!0})}t.writeEUPLBreakdown(JSON.stringify(b));var k=new p.default(this.scenarioPrefix+"ListView",u,e,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable);t.writeControlPerformanceData(k);this.listViewLogged=!0}};t.prototype._reset=function(e){(e||this.rumone).resetLogger();[d.OnePageNavigationStartMarkerName,g,y].forEach(function(e){return v.clearMarks([e])});this.listViewLogged=!1};t.dependencies=n.__assign({},s.RUMOneHelper.dependencies);return t})(s.RUMOneHelper);t.RUMOneHelperFull=b;t.default=b;t.resourceKey=r.createResolvedResourceKey(e("module").id,b)});
define("@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger",["require","exports","tslib","../../async/Async","./PageTransitionType","../events/RUMOneDataUpload.event","../../browser/PlatformDetection","../../performance/PerformanceMarker","../../killswitch/Killswitch","./TTI","./APITracker","../../uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p;(function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"})(h||(h={}));(function(e){e[e.own=0]="own";e[e.cors=1]="cors"})(p=t.APICallHostType||(t.APICallHostType={}));var d=function(e,t,n,r,i,s,o){this.url=e;this.duration=t;this.correlationId=n;this.status=r;this.startTime=i;this.endTime=s;this.name=o;this.clientDurationInMilliseconds=new Date(s).getTime()-new Date(i).getTime();this.origin=e&&new c.default(e).getHost()};t.APICallPerformanceData=d;var v=["EUPL","ScenarioId"],m=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,g=function(e,t,n,r,i,s,o){this.controlId=e;this.startTime=t;this.endTime=n;this.renderTimeCalculator=r;this.renderTimeRequiredDataChecker=i;this.ignoreForEUPL=void 0===s||s;this.needFlatten=void 0!==o&&o};t.ControlPerformanceData=g;function y(e){return null==e}var b={checkInterval:100,error_timeout:3e4,max_markers:200},w=(function(){function e(e,t,n){void 0===n&&(n=b);this._keyMetrics=v.slice(0);this.async=new r.default(this);this.dataStartTime=Date.now();this._rumoneData={};this.dataState=h.Incomplete;this.controls=[];this.apis=[];this._apiBuffer={};this._loggingFunctions=[];this.euplBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.tempData={};this._settings={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this._name=e;this.registerLoggingFunc(t);this._config=n;this.setPerfDataTimer();this._platformDetection=new o.default;this._hookUnloadEvent();this._apiTracker=new l.RUMOneAPITracker}e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__");void 0===r&&(r=b);var i=n||function(e,t){s.RUMOneDataUpload.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var o=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=o);e.Loggers[t]=o}catch(e){}return e.Loggers[t]};e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);n<0&&this._loggingFunctions.push(e);return function(){n>=0&&t._loggingFunctions.splice(n,1)}};Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){if(this._TTIMeasurementEnabled()){this.addExpectedKeyMetric("TTI");this.addExpectedKeyMetric("FCI")}return this._keyMetrics},enumerable:!0,configurable:!0});e.prototype.getPerformanceData=function(){return this._rumoneData};e.prototype.startAPIMeasurement=function(e){var t=this,r=e&&e.ignore||function(e){return!1},i=function(e){var n=e.id,r=e.request,i=e.type,s=new d;s.startTime=(new Date).toISOString();s.startTimeRelative=t.now();1===i&&(s.url="string"==typeof r?r:r.url);t._apiBuffer[n]=s};this._apiTracker.instrument({fetch:{onRequest:i,onResponse:function(e){var i=e.response,s=e.id,o=t._apiBuffer[s];if(o&&!r(o.url)){var u=void 0;try{u=i.headers.get("SPClientServiceRequestDuration")}catch(e){}var a=void 0;try{a=i.headers.get("SPRequestGuid")}catch(e){}o=n.__assign(n.__assign({},o),n.__assign(n.__assign({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-o.startTimeRelative,status:i.status},u?{duration:Number(u)}:{}),a?{correlationId:a}:{}));t.apis.push(o)}}},xhr:{onRequest:i,onResponse:function(e){var i=e.request,s=e.id,o=t._apiBuffer[s],u=i.responseURL||i.requestUrl;if(o&&!r(u)){var a;a=i.getResponseHeader("SPClientServiceRequestDuration");var f;f=i.getResponseHeader("SPRequestGuid");o=n.__assign(n.__assign({},o),n.__assign(n.__assign(n.__assign({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-o.startTimeRelative,status:i.status},a?{duration:Number(a)}:{}),f?{correlationId:f}:{}),{url:u}));t.apis.push(o)}}}});return function(){t._apiTracker.undoInstrument()}};e.prototype.resetLogger=function(){this._emergencyUpload();this._apiBuffer={};this.dataStartTime=(new Date).getTime();this.dataState=h.Incomplete;this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._settings={};this._keyMetrics=v.slice(0);this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.serverMetrics={};this.clearResourceTimings();u.clearMarks(this._getOwnMakers().map(function(e){return e.name}));e._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this._ttiPromise=void 0;this._fciPromise=void 0;this.logMessageInConsole("Reset performance Logger Done")};e.prototype.setSettings=function(e){this._settings=n.__assign(n.__assign({},this._settings),e)};e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})};e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};e.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&m.test(e)){this._rumoneData[e]=t;return!0}console.error("key "+e+" does not confrim to the Regex "+m);return!1};e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0};e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};e.prototype.writeServerUrl=function(e){this._rumoneData.ServerUrl=""};e.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}};e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};e.prototype.readAPICallPerformanceData=function(){return this.apis};e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==i.default.fullPageLoad&&e!==i.default.none&&e!==i.default.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}};e.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),r=0;r<t.length;r++){var i=null;try{i=t[r].contentWindow.performance}catch(e){}i&&i.getEntriesByType&&e.concat(i.getEntriesByType("resource"))}var s={SharePoint:function(e){return a.Killswitch.isActivated("7FED230C-E6D5-45CE-95AA-52F21A8C16C9","11/21/2019")?/\.sharepoint\.com|\.spoppe\.com/i.test(e.name):0===e.name.search(window.location.protocol+"//"+window.location.host)},CDN:function(e){if(a.Killswitch.isActivated("7FED230C-E6D5-45CE-95AA-52F21A8C16C9","11/21/2019"))return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name);var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(n))},ThirdParty:function(e){return!s.SharePoint(e)&&!s.CDN(e)}},o={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},u=Object.keys(s);for(r=0;r<u.length;r++){var f=u[r],l=this.categorizeResourceRequests(e,{from:s[f],requestType:null});this._logRUMOneData(f+"RequestCountTotal",l.length);for(var c=Object.keys(o),h=0;h<c.length;h++){var p=c[h];this._logRUMOneData(f+"RequestCount"+p,this.categorizeResourceRequests(l,{from:null,requestType:o[p]}).length)}if(l.length>0){this._logRUMOneData(f+"RequestDownloadTime",Math.round(l.reduce(function(e,t){return e+t.duration},0)/l.length));var d=JSON.stringify(l.map(function(e){return n.__assign(n.__assign({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0},"workerStart"in e?{workerStart:Math.round(e.workerStart)}:{}),{fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart)})}));this._logRUMOneData(f+"RequestNames",d)}}this.isW3cResourceTimingCollected=!0}};e.prototype.saveTempData=function(e,t){this.tempData[e]=t};e.prototype.readTempData=function(e){return this.tempData[e]};e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)};e.prototype.isRunning=function(){return!(this.dataState===h.Uploaded||this.dataState===h.TimeOut||this.dataState===h.Skipped)};e.prototype.writeEUPLBreakdown=function(e,t){if(e)try{var n=JSON.parse(e);for(var r in n)n.hasOwnProperty(r)&&this.addEUPLBreakdown(r,n[r],t)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};e.prototype.addEUPLBreakdown=function(e,t,n){if(e&&!y(t)){if(y(this.euplBreakDown[e])||n){var r=this._isBreakdownValue(t)?t.data:t;this.euplBreakDown[e]=r}this._isBreakdownValue(t)&&t.needFlatten&&(!this.isCollected(e)||n)&&this._logRUMOneData(e,t.data)}};e.prototype.readEUPLBreakdown=function(e){return e?this.euplBreakDown[e]:this.euplBreakDown};e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}};e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var i=r[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t};e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!y(e[n])&&(y(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])};e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t);u.mark(t)};e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};e.prototype.registerErrorHandler=function(e){};e.prototype.getMarkerTime=function(e){return u.getMarkerTime(e)};e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)};Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!0,configurable:!0});e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported=f.TTIIsSupported();if(this._TTIPolyfillEnabled()&&!this._ttiPromise){this._ttiPromise=f.measureTTI(this._settings.TTISettings.TTIPolyfillSettings.options);this._ttiPromise.then(function(t){var n=t;if(y(n))n=NaN;else{var r=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;r&&(n=r(Math.round(t),e._rumoneData))}e._rumoneData.TTI=n})}if(this._TTIPolyfillEnabled()&&!this._fciPromise){this._fciPromise=f.measureFCI();this._fciPromise.then(function(t){var n=t;if(y(n))n=NaN;else{var r=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;r&&(n=r(Math.round(t),e._rumoneData))}e._rumoneData.FCI=n})}};e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return""+Array(32-t.length+1).join("0")+t};e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(u.MARKER_PREFIX.length)+".mark"+n++;t[i]=Math.round(r.startTime)}});this.writeEUPLBreakdown(JSON.stringify(t))};e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return u.getAllMarks().filter(function(e){return-1===r.indexOf(e.name)})};e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0});e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n=this._name+" "+e+" : "+JSON.stringify(t);console.log(n)}};e.prototype.isCollected=function(e){return!y(this.getPerformanceDataPropertyValue(e))};e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};e.prototype.clearPerfDataTimer=function(){if(!y(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n};e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter(function(e){return"first-paint"===e.name});r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=e)};e.prototype.collectSupplementaryData=function(){this._setFCP();this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl(null);this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._collectPageServerData();this._setAppInfo();this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown)};e.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState()}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};e.prototype._updateState=function(){switch(this.dataState){case h.Incomplete:this.processControlRenderTime();this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI();0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=h.ReadyToUpload);break;case h.ReadyToUpload:this._uploadPerfData({emergency:!1})}};e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==h.ReadyToUpload){var e=Date.now();if(!(this.dataState===h.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t);this.dataState=h.TimeOut;this._uploadPerfData({emergency:!1})}}};e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){y(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e};e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})};e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData){this.dataState=h.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(n||this.dataState===h.ReadyToUpload||this.dataState===h.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",r)});this.dataState=h.Uploaded;if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",r);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{if(!this.isRunning()){this._unhookUnloadEvent();this._apiTracker.undoInstrument()}}};e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)};e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()};e.prototype.getReadableDataState=function(e){for(var t in h)if(e===Number(h[t]))return t;return"NaN"};e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId);this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime)}var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}};e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(this,n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(this,n.data))}};e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t};e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};e.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&"undefined"!=typeof performance&&void 0!==performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})};e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=0;n<this.apis.length;n++){var r=this.apis[n];if(r){e++;t+=r.duration;r.origin||(r.origin=new c.default(r.url).getHost());r.hostType=new c.default(window.location.href).getHost()===r.origin?p.own:p.cors}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(this.apis)};e.prototype.setReferrer=function(){this._rumoneData.Referrer=""};e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=i}}};e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};e.rumOneLogger=void 0;e.Loggers={};e._markers={};return e})();t.RUMOneLogger=w;t.default=w});
define("@ms/odsp-utilities/lib/logging/rumone/PageTransitionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"})(n||(n={}));t.default=n});
define("@ms/odsp-utilities/lib/logging/events/RUMOneDataUpload.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/RUMOneDataUpload.event","@ms/telemetry-manager/lib/events/RUMOneDataUpload.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.RUMOneDataUpload});
define("@ms/telemetry-manager/lib/events/RUMOneDataUpload.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RUMOneDataUpload=n.createSingleEvent({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"})});
define("@ms/odsp-utilities/lib/logging/rumone/TTI",["require","exports","tslib","../../performance/Performance"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.measureTTI=function(t){return n.__awaiter(this,void 0,void 0,function(){var i;return n.__generator(this,function(s){switch(s.label){case 0:i=n.__assign({minValue:r.now(),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},t);return[4,new Promise(function(t,n){e(["@ms/tti-polyfill/lib/index"],t,n)})];case 1:return[2,s.sent().getFirstConsistentlyInteractive(i)]}})})};t.measureFCI=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t={measurementStartTime:r.now(),requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return[4,new Promise(function(t,n){e(["@ms/rumone-fci/lib/index"],t,n)})];case 1:return[2,n.sent().getFirstCPUIdle(t)]}})})};t.TTIIsSupported=function(){return"PerformanceLongTaskTiming"in window}});
define("@ms/odsp-utilities/lib/performance/Performance",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.now=function(){return window.performance&&performance.now?Math.round(performance.now()):Date.now()};t.mark=function(e){window.performance&&performance.mark&&performance.mark(e)}});
define("@ms/odsp-utilities/lib/logging/rumone/APITracker",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.global="undefined"==typeof window?self:window;(function(e){e[e.xhr=0]="xhr";e[e.fetch=1]="fetch"})(t.APICallType||(t.APICallType={}));var n=(function(){function e(){this._requestIdGenerator=(e=0,function(){return(e++).toString()});var e}e.prototype.instrument=function(e){var n=this;if(!t.global.__RUMOneAPITrackerInstrumented){t.global.__RUMOneAPITrackerInstrumented=!0;var r=e.fetch,i=e.xhr;if("XMLHttpRequest"in t.global&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send;this._originalXhrOpen=XMLHttpRequest.prototype.open;var s=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.requestUrl=e[1];return s._originalXhrOpen.apply(this,e)};XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=s._requestIdGenerator();i.onRequest({request:this,id:r,type:0});this.addEventListener("readystatechange",function(){4===e.readyState&&i.onResponse({request:e,id:r,type:0})});return s._originalXhrSend.apply(this,t)}}if("fetch"in t.global&&void 0!==t.global.fetch){this._originalFetch=t.global.fetch.bind(t.global);t.global.fetch=function(e,t){return new Promise(function(i,s){var o=n._requestIdGenerator();r.onRequest({request:e,id:o,type:1});n._originalFetch(e,t).then(function(e){r.onResponse({response:e,id:o,type:1});i(e)},function(e){s(e)})})}}}};e.prototype.undoInstrument=function(){t.global.__RUMOneAPITrackerInstrumented=!1;this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen);this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend);this._originalFetch&&(t.global.fetch=this._originalFetch)};return e})();t.RUMOneAPITracker=n});
define("odsp-next/utilities/logging/RUMOneHelper",["require","exports","tslib","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/resources/Resources","../../resources/LoggingResourceKeys","../../resources/DataSourceResourceKeys","../../utilities/killSwitch/KillSwitch","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData","@ms/odsp-utilities/lib/logging/rumone/PageTransitionType","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-utilities/lib/object/ObjectUtil","../../utilities/features/PLTFeatures","./RUMOneHelperLite","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../pwa/serviceWorker/ServiceWorkerTelemetryClient","../../pwa/serviceWorker/ServiceWorkerClientInit","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.listViewLogged=!1;var i=n.navigation,s=n.rumOneScenarioPrefix,o=n.urlDataSource,a=n.pageContext;r.scenarioPrefix=s;r.urlDataSource=o;r.navigation=i;r._pageContext=a;r._viewParams=i.viewParams;r.listInfo="SPList"===r.scenarioPrefix?m.isDocumentLibrary(r._pageContext&&r._pageContext.listBaseTemplate||"")?".DocumentLibrary":".CustomList":"";u.default.isActivated("3EC66222-0552-4D97-9DE9-6EF4948E62CF","05/06/2020","PeformanceObserver for FID")||r._collectFid();return r}t.prototype.getControlRenderTime=function(e){var t=this.rumone.readControlPerformanceData().filter(function(t){return t.controlId===e})[0];return t&&t.renderTime||NaN};t.prototype.logRUMOneForItemsScopeListView=function(e,t){var r=this.rumone,i=this._breakdownData;if(r&&r.isRunning()&&!this.listViewLogged){r.addExpectedControl(this.scenarioPrefix+"ListView");r.writePageTransitionType(this._getPageTransitionTypeForListView(),!0);var s=this._getRequiredQuietnessDurationInMilliseconds();r.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(e,t){return(function(e,t){if(t===c.default.fullPageLoad)return e;if(t===c.default.onePageAppNavigation){return e-r.getMarkerTime(h.OnePageNavigationStartMarkerName)}return e})(e,t.PageTransitionType)},options:n.__assign({useMutationObserver:!1,trackNetworkRequests:!1},s)}}});var o=a.default[this.urlDataSource.getPageType(this._viewParams)]+"-"+(f.default[this.urlDataSource.getQueryType(this._viewParams)]||"Default");r.writeScenarioId(this.scenarioPrefix+this.listInfo+"."+o,!0);var u=r.getPerformanceDataPropertyValue("PageTransitionType");u===c.default.fullPageLoad&&r.collectW3cResourceTimings();void 0!==window.g_duration&&void 0!==window.g_iisLatency&&r.writeServerSideLatency(window.g_duration,window.g_iisLatency);if(window._spPageContextInfo){r.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);r.collectSPClientFlights(window._spPageContextInfo)}this._logColdHit(r);var d=void 0,v=r.getMarkerTime(h.AppStartMarkerName),m=r.getMarkerTime("EUPL.SPOAppBoot.NewStart"),g=r.readEUPLBreakdown("itemsView.dataFetch"),y=Number(r.getPerformanceDataPropertyValue("W3cNavigationStart")),b=t.itemsScopeInitTime,w=void 0===b?NaN:b,E=this._CollectBreakDown(),S=!!document.getElementById("requireJsString");r.addEUPLBreakdown("inlineRequireJS",{data:S,needFlatten:!0});r.addEUPLBreakdown("isItemsView",{data:!0,needFlatten:!0});if(u===c.default.fullPageLoad){r.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0});if("SPList"===this.scenarioPrefix){r.addExpectedControl({controlId:"SuiteNav",ignoreForEUPL:!0});r.addExpectedControl({controlId:"TopLevelCommandBar",ignoreForEUPL:!0});r.addExpectedControl({controlId:"ReactLeftNav",ignoreForEUPL:!0})}this.scenarioPrefix;d=h.HighResolutionTimingSupported?0:y;var x=r.getMarkerTime("EUPL.StoreInitialization.Start"),T=r.getMarkerTime("EUPL.StoreInitialization.End"),N=h.default.summary;p.extend(E,{w3cResponseEnd:i(h.default.getResponseEnd()-y),appStart:i(N.appStart),newAppStart:i(N.appStart-v+m),newAppStartTime:i(m),dataFetch:i(g),render:i(e-v-(g||0)),itemsViewRender:i(e-w),preItemsViewRender:i(w-v),storeInitialization:i(T-x),prefetchStart:i(N.prefetchStart),deferredListDataRender:i(N.deferredListDataRender)})}else if(u===c.default.onePageAppNavigation){r.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0});d=r.getMarkerTime(h.OnePageNavigationStartMarkerName);var C=r.getMarkerTime("OnePage.Prefetch.Start"),k=r.getMarkerTime("OnePage.Prefetch.End"),L=r.getMarkerTime("AppStart"),A=r.getMarkerTime("OnePage.LoadRequireJS.Start"),O=r.getMarkerTime("OnePage.LoadRequireJS.End"),M=r.getMarkerTime("SPOAppBoot.Start"),_=r.getMarkerTime("EUPL.OnePage.requireConfig.Start");A?p.extend(E,{appStart:i(L-d),dataFetch:i(k-C),render:i(e-M),requireJSLoad:i(O-A),requireConfigCost:i(L-_)}):p.extend(E,{dataFetch:i(g),render:i(e-d-(g||0))})}r.mark("glass");this._logServiceWorkerMetrics(r);var D=r.getMarkerTime("SPOAppBoot.DOMContentLoaded");if(!isNaN(D)){M=r.getMarkerTime("SPOAppBoot.Start");r.addEUPLBreakdown("timeWaitForBody",{data:D-M,needFlatten:!0})}r.writeEUPLBreakdown(JSON.stringify(E));var P=new l.default(this.scenarioPrefix+"ListView",d,e,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable);r.writeControlPerformanceData(P);this.listViewLogged=!0}};t.prototype.logRUMOneForDeferredControl=function(e,t){d.isFeatureEnabled(d.UnifiedSuiteNavBootstrapperLoadingFlow)&&"SuiteNav"===e&&this._logSuiteNavBreakdownData();var n=this._getPageTransitionTypeForListView(),r=h.HighResolutionTimingSupported?0:Number(this.rumone.getPerformanceDataPropertyValue("W3cNavigationStart"));if(n===c.default.fullPageLoad){var i=new l.default(e,r,t,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable,!0,!0);this.rumone.isRunning()&&this.rumone.writeControlPerformanceData(i)}};t.prototype.dispose=function(){this.rumone.resetLogger();delete this.rumone};t.prototype._logColdHit=function(e){var t=window._spModuleLink;if("undefined"!=typeof Storage&&t){var n=window.localStorage.getItem("spListBuildNumber"),r=t.buildNumber;n&&e.addEUPLBreakdown("isColdHit",{data:n!==r,needFlatten:!0});localStorage.setItem("spListBuildNumber",r)}};t.prototype._logServiceWorkerMetrics=function(e){e.addEUPLBreakdown("pageServedFromCache",{data:!!window.__pageFromServiceWorker,needFlatten:!0});var t=b.getServiceWorkerState(),n=t.state,r=t.serviceWorkerScriptLocation;e.addEUPLBreakdown("serviceWorkerState",{data:n,needFlatten:!0});e.addEUPLBreakdown("serviceWorkerScriptLocation",{data:r,needFlatten:!0});if("1"===sessionStorage.getItem(w.SERVICEWORKER_SHOULDREFRESH_FLAG)){sessionStorage.removeItem(w.SERVICEWORKER_SHOULDREFRESH_FLAG);e.addEUPLBreakdown("reloadByServiceWorker",{data:!0,needFlatten:!0})}var i=b.getNavigationTiming();if(i){e.addEUPLBreakdown("navigation.fetchStart",{data:i.fetchStart,needFlatten:!1});e.addEUPLBreakdown("navigation.requestStart",{data:i.requestStart,needFlatten:!1});e.addEUPLBreakdown("navigation.workerStart",{data:i.workerStart,needFlatten:!1})}};t.prototype._getRequiredQuietnessDurationInMilliseconds=function(){var e=new E.default(location.href),t=e.getQueryParameter("ttithreshold")?Number(e.getQueryParameter("ttithreshold")):1e3;return{requiredMainThreadQuietnessDurationInMilliseconds:t,requiredNetworkQuietnessDurationInMilliseconds:t}};t.prototype._logSuiteNavBreakdownData=function(){var e=this.rumone.getMarkerTime("Bootstrapper.SuiteNav.InitialRendered");this.rumone.addEUPLBreakdown("SuiteNavInitialRendered",this._breakdownData(e))};t.prototype._collectFid=function(){var e=this;if("hidden"!==document.visibilityState&&"PerformanceObserver"in window)try{var t=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r],o=Math.round(s.processingStart-s.startTime);e.rumone.addEUPLBreakdown("FID",{data:o,needFlatten:!0});t.disconnect();break}});t.observe({type:"first-input",buffered:!0})}catch(e){}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:o.urlLite,navigation:y.navigation,rumOneScenarioPrefix:s.rumOneScenarioPrefix,pageContext:g.pageContext.optional});return t})(v.default);t.RUMOneHelper=S;t.default=S;t.resourceKey=i.createResolvedResourceKey(e("module").id,S)});
define("@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData",["require","exports","./RUMOneLogger"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.ControlPerformanceData});
define("odsp-next/utilities/logging/RUMOneHelperLite",["require","exports","tslib","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger","@ms/odsp-utilities/lib/logging/rumone/PageTransitionType","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SORT_ACTION="Sort";t.FILTER_ACTION="Filter";var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this)||this;r.rumone=i.default.getRUMOneLogger();window.getRumOneForTAB=function(){return r.rumone};return r}t.prototype.mark=function(e){this.rumone.mark(e)};t.prototype.markOnce=function(e){this.rumone.getMarkerTime(e)||this.mark(e)};t.prototype.checkRenderTimeRequiredDataAvailable=function(e,t){return!(!e||!t)&&(t.startTime>=0&&t.endTime>t.startTime)};t.prototype.computeRenderTime=function(e,t){return e&&t?t.endTime-t.startTime:0};t.prototype.isDocumentLibrary=function(){return!1};t.prototype.logPropertiesPaneLaunch=function(){};t.prototype.logPropertiesPaneUpdate=function(){};t.prototype.logPropertiesPaneModifyProperty=function(){};t.prototype.logPropertiesPaneEnd=function(){};t.prototype.getControlRenderTime=function(e){return NaN};t.prototype.logOnePageNavigationStart=function(){};t.prototype.logFilterSort=function(e){};t.prototype.logLaunchFilterPaneStart=function(){};t.prototype.logLaunchFilterPaneEnd=function(){};t.prototype.logRUMOneForListView=function(e){};t.prototype.logRUMOneForItemsScopeListView=function(e,t){};t.prototype.logRUMOneForDeferredControl=function(e,t){};t.prototype.logPowerAppFormLoadStart=function(e){};t.prototype.logPowerAppFormUserClick=function(){};t.prototype.logPowerAppFormLoadEnd=function(){};t.prototype.logPowerAppFormDataLoadEnd=function(){};t.prototype.logPowerAppFormLoadScenarioEnd=function(){};t.prototype.logPowerAppFormClickScenarioEnd=function(){};t.prototype.dispose=function(){this.rumone.resetLogger();delete this.rumone};t.prototype._getTimingNormalizer=function(e){return function(t){t=Math.round(t);if(o.HighResolutionTimingSupported)return t>=e?t-e:t;if(t<e)throw new Error("timing "+t+" should not be smaller than navigationStart "+e);return t}};t.prototype._CollectBreakDown=function(e){var t=window.__themeState__.perf,r=navigator.userAgent,i={loadStyleDuration:{data:t?t.duration:NaN,needFlatten:!0},loadStyleCount:{data:t?t.count:NaN,needFlatten:!0},isCloudAppSecurity:r.indexOf("CAS_CAAC")};e=n.__assign(n.__assign({},e),i);window.tabperf=e;return e};t.prototype._getPageTransitionTypeForListView=function(){return this.rumone.getMarkerTime(o.OnePageNavigationStartMarkerName)?s.default.onePageAppNavigation:void 0!==this.rumone.getPerformanceDataPropertyValue("PageTransitionType")?this.rumone.getPerformanceDataPropertyValue("PageTransitionType"):this.rumone.getMarkerTime("ListViewUpdate.Start")?s.default.none:s.default.fullPageLoad};t.prototype._breakdownData=function(e){return{data:e,needFlatten:!0}};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=u});
define("odsp-next/pwa/serviceWorker/ServiceWorkerTelemetryClient",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event","./PostMessageHandler","./ISTSServiceWorker"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={};t.init=function(){r.registerServiceWorkerPostMessageListener(o)};function o(e){if(e&&e.isQos)for(var t=0,r=e.qosEvents;t<r.length;t++){var o=r[t],u=o.qos,a=o.id,f=o.type;if(f===i.QosEventType.start){var l=new n.Qos(u);s[a]=l}if(f===i.QosEventType.end){if(!(l=s[a])){var c="there is no paired service worker qos start event for this end event: "+JSON.stringify(u);console.log(c);throw new Error(c)}l.end(u)}}}t.getServiceWorkerState=function(){var e="unknown",t="unknown";try{if("serviceWorker"in navigator)if(navigator.serviceWorker.controller){e=navigator.serviceWorker.controller.state;t=navigator.serviceWorker.controller.scriptURL}else e="unavailable";else e="unsupported"}catch(e){console.log(e)}return{state:e,serviceWorkerScriptLocation:t}};t.getNavigationTiming=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:Math.round(t.workerStart),fetchStart:Math.round(t.fetchStart),requestStart:Math.round(t.requestStart)}}}});
define("odsp-next/pwa/serviceWorker/PostMessageHandler",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){var e=new Set;if("serviceWorker"in navigator&&navigator.serviceWorker.controller){var t=(function(){var e=new MessageChannel;return function(){return e}})()();t.port1.onmessage=function(t){if(!t.data.error){var n=t.data;if(n.isServiceWorkerPostMessageData)for(var r=0,i=Array.from(e);r<i.length;r++){(0,i[r])(n.data)}}};navigator.serviceWorker.controller.postMessage({openServiceWorkerChannel:!0},[t.port2])}return function(t){e.add(t);return function(){e.delete(t)}}})();t.registerServiceWorkerPostMessageListener=function(e){return n(e)}});
define("odsp-next/pwa/serviceWorker/ISTSServiceWorker",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.start=1]="start";e[e.end=2]="end"})(t.QosEventType||(t.QosEventType={}))});
define("odsp-next/pwa/serviceWorker/ServiceWorkerClientInit",["require","exports","./PostMessageHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SERVICEWORKER_SHOULDREFRESH_FLAG="serviceWorkerShouldRefesh";t.initServiceWorkerClient=function(){n.registerServiceWorkerPostMessageListener(function(e){if(e.shouldRefesh){window.sessionStorage.setItem(t.SERVICEWORKER_SHOULDREFRESH_FLAG,"1");location.reload(!0)}})}});
define("@ms/odsp-shared/lib/utilities/logging/events/ListViewStartRender.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListViewStartRender=n.createSingleEvent({eventName:"ListViewStartRender,",shortEventName:"ListViewStartRender",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{});t.default=t.ListViewStartRender});
define("@ms/odsp-shared/lib/utilities/logging/events/ListViewRendered.event",["require","exports","@ms/odsp-utilities/lib/logging/SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListViewRendered=n.createSingleEvent({eventName:"ListViewRendered,",shortEventName:"ListViewRendered",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{});t.default=t.ListViewRendered});
define("odsp-next/dataSources/url/odc/UrlDataSourceLite",["require","exports","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/resources/Resources","../QueryType","./UrlRouting","./UrlHelpers"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){this._navigation=t.navigation}e.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);return s.getCurrentItemKey(e)};e.prototype.getKey=function(e){return s.getKey(e)};e.prototype.getKeyParams=function(e){return s.getKeyParams(e)};e.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return s.getQueryType(e)};e.prototype.getPageType=function(e){void 0===e&&(e=this._navigation.viewParams);return s.getPageType(e)};e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t=null;if(e.parId||e.parQt||e.parCid){(t={}).id=e.id;t.qt=e.qt;t.cid=e.cid;t.internalPath=e.internalPath;delete t.u}return t&&s.getKey(t)||null};e.prototype.getRootItemKey=function(e){void 0===e&&(e=i.default.Files);return s.getRootItemKey(e)};e.prototype.getDefaultRootItemId=function(){return"root"};e.prototype.getApiBaseUrl=function(){return o.getVroomBaseUrl()};e.prototype.getNavLinkClickUrl=function(e){return""};e.dependencies={navigation:n.navigation,resources:r.resourceScopeKey};return e})();t.UrlDataSourceLite=u;t.resourceKey=r.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/dataSources/searchBox/SearchBoxDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("searchBoxDataSource")});
define("odsp-next/dataSources/searchBox/odc/ODCSearchBoxDataSource",["require","exports","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/resources/Resources","../../../dataSources/search/odc/BingSuggestionsAppId","../../../dataSources/url/PageType","../../../dataSources/url/SearchTypeChecker","../../../providers/engagement/Engagement","../../../providers/suiteNav/SuiteNavProvider.key","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../url/odc/UrlDataSource","../SearchBoxConfig.key","./GetSuggestionClickUpdater"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(e,t){this._deps=t}e.prototype.getSuiteNavProviderKey=function(){return a.resourceKey};e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()};e.prototype.getProviderConfigUpdaters=function(){return[p.default(this._deps)]};e.prototype.onSubmitSearchCallback=function(e,t){this._deps.instrumentationProvider.logStartSearchOnSubmit();this._deps.engagement.logData({name:"Upscope.Search.Click",isIntentional:!0});this._deps.searchDataSource.upscopeSearch(e)};e.prototype.getSearchInstrumenterProps=function(){return{bingConsumerApiContext:{appId:i.default,viewerId:c.default.viewerId,fromPhotos:this._deps.urlDataSource.getPageType()===s.default.Photos}}};e.prototype.isSearchResultsPage=function(){return o.isSearchType(this._deps.urlDataSource.getQueryType(this._deps.navigation.viewParams))};e.dependencies={searchBoxConfig:h.resourceKey,instrumentationProvider:l.instrumentation,engagement:u.resourceKey,searchDataSource:f.search,urlDataSource:f.url,navigation:n.navigation};return e})();t.default=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d)});
define("odsp-next/dataSources/search/odc/BingSuggestionsAppId",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="D41D8CD98F00B204E9800998ECF8427E0C818072"});
define("odsp-next/providers/suiteNav/SuiteNavProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./SuiteNavProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/searchBox/odc/GetSuggestionClickUpdater",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){return{id:"suggestionClickUpdater",groupUpdaters:i(e)}};function i(e){return[{groupId:"file",createUpdater:s(e)},{groupId:"history",createUpdater:s(e)},{groupId:"tag",createUpdater:s(e)}]}function s(e){return function(){return{component:function(t){return function(i){return r.createElement(t,n.__assign(n.__assign({},i),{onClick:function(t){i.onClick&&i.onClick(t);if("OfficeDocument"!==i.fileType){t.preventDefault();t.stopPropagation();if(i.url){var n=i.url.indexOf("?")>0?i.url.substring(i.url.indexOf("?")+1):void 0,r=n?"#"+n:i.url;e.navigation.navigateTo({url:r})}}}}))}}}}}});
define("odsp-next/dataSources/searchBox/odc/ODCSearchBoxConfig",["require","exports","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/resources/Resources","../../../controls/search/Search.resx","../../../dataSources/url/PageType","../../../resources/DataSourceResourceKeys","../../../utilities/browser/WebViewDetector","../../../utilities/features/PLTFeatures","../../base/odc/Config","../common/GetSearchText","./CreateSearchInstrumenter"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(){function e(e,t){this._navigation=t.navigation;this._urlDataSource=t.urlDataSource;this._identityDataSource=t.identityDataSource;this._filesConfig=t.filesConfig;this.getSearchText=this.getSearchText.bind(this);this.getTokenProviders=this.getTokenProviders.bind(this)}e.prototype.isEnabled=function(){var e=a.isOneDriveWinApp(),t=this._identityDataSource.getIdentity().type===n.IdentityType.anonymous,r=f.isFeatureEnabled(f.OdcSuiteNavSearchBox);return!e&&!t&&r};e.prototype.getPlaceholderText=function(){return this._urlDataSource.getPageType()===o.default.Photos?s.default.SearchOneDrivePhotosPlaceholder:s.default.SearchOneDrivePlaceholder};e.prototype.getSearchText=function(){return c.default(this._navigation)};e.prototype.getTokenProviders=function(){return{}};e.prototype.getScenarioName=function(){return"onedriveconsumer"};e.prototype.getInstrumenter=function(){!this._searchInstrumenter&&this.isEnabled()&&(this._searchInstrumenter=h.default(this,this._filesConfig));return this._searchInstrumenter};e.prototype.isScopeControlEnabled=function(){return!1};e.dependencies={navigation:r.navigation,urlDataSource:u.url,identityDataSource:u.identity,filesConfig:l.filesResourceKey};return e})();t.default=p;t.resourceKey=i.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/dataSources/searchBox/common/GetSearchText",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){return e.viewParams.q||""}});
define("odsp-next/dataSources/searchBox/odc/CreateSearchInstrumenter",["require","exports","@msfast/search-instrumentation/lib/createInstrumenter"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var i={id:e.getScenarioName(),version:"1",userRing:r(t.env)};return n.default({perf:{mark:function(){return 0},measure:function(){return 0},now:function(){return 0},getEntriesByName:function(){return[]}},hostAppInfo:i})};function r(e){switch(e){case"soak2":return"test";case"df":return"inner";case"prod":default:return"generalAudience"}}});
var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)};define("@msfast/search-instrumentation/lib/createInstrumenter",["require","exports","@msfast/search-dispatcher/lib/createDispatcher","@msfast/search-prefetch/lib/generateGuid"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["markAppBoot","markHeaderBoot","markSbInteractive","markSbReady","markZeroQueryReady","markSearchLayoutMount","markSearchLayoutRenderStart"],s={markAppBoot:[],markHeaderBoot:["markAppBoot"],markSbInteractive:["markHeaderBoot"],markSbReady:["markSbInteractive"],markZeroQueryReady:["markSbReady"],SbQuerySubmitted:["markSbReady"],SerpRouteChange:[],SerpFetchStart:["SbQuerySubmitted"],SerpAnswerFetchDone:["SerpFetchStart"],SerpFetchDone:["SerpFetchStart"],SerpAnswersRenderDone:["markAppBoot","SbQuerySubmitted","SerpRouteChange","SerpFetchStart","SerpAnswerFetchDone"],SerpDataReady:["SerpFetchStart","SerpFetchDone"],SerpRenderDone:["markAppBoot","SbQuerySubmitted","markSearchLayoutMount","markSearchLayoutRenderStart","SerpPrefetchStart","SerpPrefetchDone","SerpConfigStart","SerpConfigDone","SerpRouteChange","SerpFetchStart","SerpDataReady","SerpFetchDone","SerpFullPageLoad","SerpInPlaceNavigation"],markSearchLayoutMount:["SbQuerySubmitted"],markSearchLayoutRenderStart:["SbQuerySubmitted","markSearchLayoutMount"],SerpPrefetchStart:[],SerpPrefetchDone:["SerpPrefetchStart"],SerpConfigStart:[],SerpConfigDone:["SerpConfigStart"],SerpFullPageLoad:[],SerpInPlaceNavigation:[]};t.default=function(e){var t,o,u,a,f=e,l={},c=i.reduce(function(e,t,n){e[t]=function(){if(!l[t]){l[t]=!0;f.perf.mark(t)}if(n)try{f.perf.measure(i[n-1]+"-"+t,i[n-1],t)}catch(e){}};return e},{}),h={};return __assign(__assign(__assign({},n.default()),c),{conversationManager:(u=function(){var e={},t=!1,n=function(t){var n=r.default();e[t]=n;return n};return{conversationId:r.default(),creationTime:Date.now(),getSubmittedState:function(){return t},submit:function(){t=!0},createLogicalSearchId:n,getLogicalSearchId:function(t){return e[t]||n(t)}}},a=function(){t&&t.getSubmittedState()&&(o=t);var e=u();t=e;return e},{startConversation:a,getActiveConversation:function(){return!t||t.getSubmittedState()?a():t},getLastSubmittedConversation:function(){if(t&&t.getSubmittedState())return t;if(!o){var e=u();e.submit();o=e}return o}}),props:f,setProps:function(e){this.props=f=__assign(__assign({},this.props),e);this.dispatch(e);return f},mark:function(e){var t=[];f.perf.mark(e);for(var n=0,r=s[e];n<r.length;n++){var i=r[n];try{var o=i+"-"+e;f.perf.measure(o,i,e);var u=f.perf.getEntriesByName(o).pop();u&&u.startTime>(h[e]||0)&&t.push(u)}catch(e){}}if(t.length>0){var a=Math.max.apply(Math,t.map(function(e){return e.startTime}));h[e]=a}return t}})}});
define("@msfast/search-dispatcher/lib/createDispatcher",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){var e=[];return{register:function(t){return""+(e.push(t)-1)},unregister:function(t){e[parseInt(t,10)]=0},dispatch:function(t){e.forEach(function(e){return e&&e(t)})}}}});
define("@msfast/search-prefetch/lib/generateGuid",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}});
define("odsp-next/dataSources/item/ItemCacheToKOStoreDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemCacheToKOStoreDataSource")});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCacheToKOStoreDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/itemsScope/odc/DefaultClickActionControlHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DefaultClickActionControlHandler"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemInvalidator/odc/ItemInvalidator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemInvalidator"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/itemsScope/ItemsScopeControlHandlerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClickHandler=new n.ResourceKey("itemsScopeControlHandler.defaultClickHandler");t.userHoverCard=new n.ResourceKey("itemsScopeControlHandler.userHoverCard");t.locationHoverCard=new n.ResourceKey("itemsScopeControlHandler.locationHoverCard");t.itemHoverCard=new n.ResourceKey("itemsScopeControlHandler.itemHoverCard");t.itemSetColumns=new n.ResourceKey("itemsScopeControlHandler.itemSetColumns");t.tilesLayout=new n.ResourceKey("itemsScopeControlHandler.tilesLayout");t.detailsLayout=new n.ResourceKey("itemsScopeControlHandler.detailsLayout");t.missingMetadataField=new n.ResourceKey("itemsScopeControlHandler.missingMetadataField");t.sharedFieldClickAction=new n.ResourceKey("itemsScopeControlHandler.sharedFieldClickAction");t.itemExecuteFlowAction=new n.ResourceKey("itemsScopeControlHandler.itemExecuteFlowAction");t.itemEditPropsAction=new n.ResourceKey("itemsScopeControlHandler.itemEditPropsAction");t.syncAction=new n.ResourceKey("itemsScopeControlHandler.syncAction");t.switchLayoutAction=new n.ResourceKey("itemsScopeControlHandler.switchLayoutAction");t.createListItemAction=new n.ResourceKey("itemsScopeControlHandler.createListItemAction");t.hoverCardCommands=new n.ResourceKey("itemsScopeControlHandler.hoverCardCommands");t.moveCopyAction=new n.ResourceKey("itemsScopeControlHandler.moveCopyAction");t.uploadItemsAction=new n.ResourceKey("itemsScopeControlHandler.uploadItemsAction");t.downloadItemsAction=new n.ResourceKey(e("module").id+".downloadItemsAction");t.contextMenuControlHandler=new n.ResourceKey("itemsScopeControlHandler.contextMenuControlHandler");t.itemEngagement=new n.ResourceKey("itemsScopeControlHandler.itemEngagement");t.itemSetQuickEditListControlHandler=new n.ResourceKey("itemsScopeControlHandler.itemSetQuickEditListControlHandler");t.emptyFolderControlHandler=new n.ResourceKey("itemsScopeControlHandler.emptyFolderControlHandler");t.itemsBreadcrumbBetaControlHandler=new n.ResourceKey("itemsScopeControlHandler.itemsBreadcrumbBeta")});
define("odsp-next/controls/itemsScope/od/ItemsScopeControlHandlerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetColumns=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return r.default.resolve(new Promise(function(t,n){e(["./ItemSetColumnsControlHandler"],t,n)})).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemCache/ItemCacheConfiguration.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemCacheConfiguration")});
define("odsp-next/models/itemCache/od/ItemCacheConfiguration.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCacheConfiguration"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/ItemsScopeAddon.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("ItemsScopeAddon")});
define("odsp-next/models/itemsScope/od/ItemsScopeAddon.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeAddon"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/ItemsScopeKeyConverter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemsScopeKeyConverter")});
define("odsp-next/models/itemsScope/od/ItemsScopeKeyConverter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeKeyConverter"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/FabricIconsDeferred",["require","exports","../utilities/icons/fabric/index"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.initializeIcons(window.require.toUrl("odsp-media/fonts/"),{disableWarnings:!0})});
define("odsp-next/utilities/icons/fabric/index",["require","exports","./odsp-next-icons","./odsp-next-icons-0","./odsp-next-icons-1","./odsp-next-icons-2","./odsp-next-icons-3","./odsp-next-icons-4","./odsp-next-icons-5","./odsp-next-icons-6","./odsp-next-icons-7","./odsp-next-icons-8","./odsp-next-icons-9","./odsp-next-icons-10","./odsp-next-icons-11","./odsp-next-icons-12","./odsp-next-icons-13","./odsp-next-icons-14","./odsp-next-icons-15","./odsp-next-icons-16","./odsp-next-icons-17","./odsp-next-icons-18","./odsp-next-icons-19","./iconAliases"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/assets/icons/");[n.initializeIcons,r.initializeIcons,i.initializeIcons,s.initializeIcons,o.initializeIcons,u.initializeIcons,a.initializeIcons,f.initializeIcons,l.initializeIcons,c.initializeIcons,h.initializeIcons,p.initializeIcons,d.initializeIcons,v.initializeIcons,m.initializeIcons,g.initializeIcons,y.initializeIcons,b.initializeIcons,w.initializeIcons,E.initializeIcons,S.initializeIcons].forEach(function(n){return n(e,t)});x.registerIconAliases()}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-0",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"odsp-next-icons-0-26e222d3.woff') format('woff')"},icons:{PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",OneNoteEduLogoInverse:"",CaretLeftSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:"",CaretRightSolid8:"",OfficeStoreLogo:"",OfficeAssistantLogo:"",DynamicSMBLogo:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DoubleChevronDown:"",FollowUser:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",MyMoviesTV:"",RecurringTask:"",AwayStatus:"",ReplyAll:"",GoogleDriveLogo:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",ReportLibrary:"",HardDrive:"",Unsubscribe:"",CalendarMirrored:"",SwayLogoInverse:"",OutOfOffice:"",SkipBack10:"",SkipForward30:"",Trophy:"",ReopenPages:"",ReturnToSession:"",EmojiTabSymbols:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-1",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"odsp-next-icons-1-0089e24b.woff') format('woff')"},icons:{AdminOLogoInverse32:"",AADLogo:"",Uneditable:"",Hide:"",YammerLogo:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Hot:"",Blocked2:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",ResetDevice:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",BoxLogo:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",ForwardEvent:"",Subscribe:"",EventInfo:"",Waffle:"",DelveLogoInverse:"",DropboxLogo:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",ParatureLogo:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",RemoveEvent:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",AccountActivity:"",TextDocumentShared:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",MessageFriendRequest:"",ActivityFeed:"",Compare:"",EventDate:"",PageCheckedOut:"",ScatterChart:"",ProductCatalog:"",DeactivateOrders:"",AndroidLogo:"",Breadcrumb:"",BirthdayCake:"",FixedAssetManagement:"",TimeEntry:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-2",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"odsp-next-icons-2-a6e8ba8b.woff') format('woff')"},icons:{CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:"",AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",ScreenPreviewOn:"",CaretBottomLeftSolid8:"",FabricFolderFill:"",iOSAppStoreLogo:"",FabricSyncFolder:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricOpenFolderHorizontal:"",Hide2:"",EmptyRecycleBin:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ArrowDownRightMirrored8:"",ReceiptForward:"",ArrowUpRightMirrored8:"",GoToDashboard:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",DelveAnalytics:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-3",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"odsp-next-icons-3-5dd01185.woff') format('woff')"},icons:{ReceiptReply:"",Fax:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",ExcelDocument:"",ReceiptCheck:"",PowerPointDocument:"",PublicFolder:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:"",CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",WordDocument:"",CaretBottomRightSolid8:"",ExploreContent:"",RadioBtnOff:"",CheckList:"",Diagnostic:"",Generate:"",Total:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",FlowChart:"",Freezing:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",LightSnow:"",FunnelChart:"",Assign:"",AreaChart:"",Ribbon:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:"",HelpMirrored:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-4",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"odsp-next-icons-4-f6eb16a6.woff') format('woff')"},icons:{ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",AllAppsMirrored:"",RightDoubleQuote:"",Record2:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",OpenPaneMirrored:"",BidiRtl:"",FitWidth:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Photo:"",Fingerprint:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",Handwriting:"",AlarmClock:"",WorldClock:"",Clock:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",DockLeft:"",DockRight:"",Repair:"",Street:"",RadioBullet:"",Stopwatch:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",XboxOneConsole:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",ChevronDownMed:"",BidiLtr:"",ChevronUpMed:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-5",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"odsp-next-icons-5-2be77c12.woff') format('woff')"},icons:{PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",FlashAuto:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:"",ChevronDownSmall:"",OpenWithMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",ReminderPerson:"",OneNoteLogoInverse:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",MiracastLogoLarge:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",ToggleFilled:"",DeliveryTruck:"",JS:"",CSS:"",XboxLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:"",Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",MyNetwork:"",ExcelLogoInverse:"",WordLogoInverse:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",FacebookLogo:"",TwitterLogo:"",RemoveContent:"",AddTo:"",DOM:"",SkypeLogo:"",OfflineStorage:"",LowerBrightness:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeOldLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",WebComponents:"",OfficeLogo:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-6",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"odsp-next-icons-6-9cfcc508.woff') format('woff')"},icons:{OutlookLogoInverse:"",MSNLogo:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",Vaccination:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Wines:"",Money:"",Cocktails:"",Broom:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",FlashOff:"",Focus:"",VideoLightOff:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",AddToShoppingList:"",RadioBtnOn:"",PieDouble:"",RemoveFilter:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",EndPointSolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",XboxController:"",Devices4:"",NUIFace:"",AzureLogo:"",BingLogo:"",Design:"",PieSingle:"",Arrivals:"",SubstitutionsIn:"",Savings:"",Sell:"",StockDown:"",StockUp:"",MSNVolume:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",Tennis:"",CalendarReply:"",FolderHorizontal:"",GiftboxOpen:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:"",CortanaLogoBeckonInner:"",CortanaLogoBeckonOuter:"",UneditableSolid12:"",CortanaLogoReadyInner:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-7",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"odsp-next-icons-7-9adad209.woff') format('woff')"},icons:{VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",CortanaLogoReadyOuter:"",EditSolidMirrored12:"",EditSolid12:"",ToDoLogoTop:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",ArrangeBringForward:"",NonprofitLogo32:"",ArrangeSendBackward:"",ArrangeBringToFront:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeSendToBack:"",NavigationFlipper:"",ProtectionCenterLogo32:"",KaizalaLogo:"",TeamsLogo16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",RectangularClipping:"",MailTentativeMirrored:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",MailReminder:"",DeclineCall:"",ContactLock:"",AutoDeploySettings:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-8",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"odsp-next-icons-8-0215802d.woff') format('woff')"},icons:{TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",D365CustomerInsights:"",EditCreate:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogo16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",NugetLogo:"",TaskLogo:"",MTMLogo:"",DefectSolid:"",EventDeclined:"",CustomerAssets:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogo16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",LadybugSolid:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",WhiteBoardApp32:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",WhiteBoardApp16:"",DictionaryRemove:"",UserEvent:"",Encryption:"",LiveSite:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",UserRemove:"",QuadColumn:"",TripleColumnWide:"",StackedColumnChart2:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",GitLogo:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-9",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"odsp-next-icons-9-e3e47cbf.woff') format('woff')"},icons:{GitHubLogo:"",ApacheMavenLogo:"",NPMLogo:"",GitFork:"",SVNLogo:"",JenkinsLogo:"",VersionControlPush:"",ExternalGit:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",MailSchedule:"",PowerShell2:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",OfficeChatSolid:"",ContentSettings:"",OfficeChat:"",D365TalentLearn:"",D365TalentInsight:"",D365CoreHR:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",TagSolid:"",RectangleShapeSolid:"",DropShapeSolid:"",TriangleShapeSolid:"",ChronosLogo:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:"",OneDriveFolder16:"",CalendarSettings:"",SpecialEvent:"",DrillExpand:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillShow:"",TestPlan:"",CalendarSettingsMirrored:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-10",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"odsp-next-icons-10-42d00443.woff') format('woff')"},icons:{HardDriveUnlock:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",Leave:"",CircleShapeSolid:"",SquareShapeSolid:"",PasteAsCode:"",HardDriveLock:"",PasteAsText:"",LinuxLogo32:"",AccountManagement:"",ReportWarning:"",PlaySolid:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",CriticalErrorSolid:"",VisualStudioIDELogo32:"",ApacheIvyLogo32:"",BitbucketLogo32:"",GradleLogo32:"",MicrosoftStaffhubLogo:"",TestImpactSolid:"",TestAutoSolid:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",DelveLogoFill:"",Build:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",ProcessMetaTask:"",DelveLogo:"",SharepointLogo:"",SkypeForBusinessLogoFill:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Clicked:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-11",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"odsp-next-icons-11-e70edcb9.woff') format('woff')"},icons:{PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",LocaleLanguage:"",ViewListTree:"",ShopServer:"",CommentNext:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentPrevious:"",Repo:"",ViewListGroup:"",ViewDashboard:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",ScreenTime:"",MobileReport:"",MixerLogo:"",ScaleVolume:"",CaloriesAdd:"",HardDriveGroup:"",ToggleLeft:"",ToggleRight:"",FullView:"",FocusView:"",CircleShape:"",SquareShape:"",TriangleShape:"",DropShape:"",FastMode:"",CheckboxIndeterminateCombo:"",ProgressRingDots:"",GroupList:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",SaveAll:"",LinkedInLogo:"",Decimals:"",FilterAscending:"",FilterDescending:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",IOT:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",Server:"",RegistryEditor:"",PowerShell:"",BucketColorFill:"",Taskboard:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-12",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"odsp-next-icons-12-991480cf.woff') format('woff')"},icons:{SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",OneNoteLogo:"",OutlookLogo:"",PowerPointLogo:"",PublisherLogo:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",RepoSolid:"",FolderQuery:"",FolderList:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",BankSolid:"",ReviewResponseSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",FeedbackRequestSolid:"",OfflineStorageSolid:"",AsteriskSolid:"",DiamondSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:"",FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",FileTypeSolution:"",DateTime12:"",WordLogoInverse16:"",WordLogo16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",ExcelLogoInverse16:"",ExcelLogo16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OutlookLogoInverse16:"",OutlookLogo16:"",PublisherLogoInverse16:"",PublisherLogo16:"",VisioLogoInverse16:"",VisioLogo16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",VSTSAltLogo2:"",QuickNoteSolid:"",VSTSAltLogo1:"",AzureServiceEndpoint:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-13",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"odsp-next-icons-13-c52fc77b.woff') format('woff')"},icons:{ChevronRightEnd6:"",EgnyteLogo:"",GoogleDriveLogoLeftGreen:"",GoogleDriveLogoBottomBlue:"",GoogleDriveLogoRightYellow:"",ContextMenu:"",AzureAPIManagement:"",VSTSLogo:"",Trophy2Solid:"",CrownSolid:"",BugSolid:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",FilePDB:"",PY:"",UnknownMirroredSolid:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:"",BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",CircleAddition:"",TestUserSolid:"",CoffeeScript:"",FullWidth:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",WorkItemBug:"",MarkDownLanguage:"",WorkItem:"",FileSymlink:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",AutoFillTemplate:"",GripperDotsVertical:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-14",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"odsp-next-icons-14-c605048c.woff') format('woff')"},icons:{NewFolder:"",Library:"",PostUpdate:"",Airplane:"",Tablet:"",QuickNote:"",MapPin:"",Video:"",Phone:"",Shop:"",Stop:"",Link:"",Brightness:"",InternetSharing:"",ReceiptProcessing:"",InboxActive:"",RingerActive:"",FlowTemplate:"",TextDocumentSettings:"",PowerAppsTemplate:"",TemporaryAccessPass:"",ChoiceColumn:"",CtrlButton:"",DensityDefault:"",DensityComfy:"",ODLink:"",ODLink12:"",TableColumn:"",CalculatedTable:"",ColumnSigma:"",ColumnQuestion:"",ColumnQuestionMirrored:"",ColumnFunction:"",AllApps:"",Zoom:"",ZoomOut:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",SwitchUser:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",Checkbox:"",GroupRemove:"",Remove:"",Microphone:"",Camera:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Refresh:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",Favicon:"",RealEstate:"",SecurityTest:"",CompareUneven:"",D365ProjectOperations:"",FileSystem:"",SQLAnalyticsPool:"",StorageAcount:"",BlobStorage:"",DatabaseView:"",Column:"",ContentFeed:"",AzureDataExplorer:"",TextDocumentEdit:"",VideoOff2:"",FastForwardPointFiveX:"",FastForwardOneX:"",FastForwardOneFiveX:"",FastForwardTwoX:"",FastForwardFourX:"",FastForwardEightX:"",SortLinesAscending:"",HomeDropdown:"",DeviceBug:"",Reset:"",HexaditeInvestigationCancel:"",HexaditeInvestigationSemiAuto:"",DriverOff:"",FileOff:"",ServiceOff:"",URLBlock:"",BugSync:"",BugBlock:"",DeviceRun:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-15",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('"+e+"odsp-next-icons-15-02ff845c.woff') format('woff')"},icons:{DeviceOff:"",ProcessingCancel:"",ProcessingRun:"",ProcessingPause:"",CalculatorDelta:"",InputAddress:"",ViewInAR:"",ImageInAR:"",CubeShapeSolid:"",ShapeSolid:"",RewindPointFiveX:"",RewindOneX:"",RewindOneFiveX:"",RewindTwoX:"",Sleet:"",FreezingRain:"",MostyClearNight:"",PartlyClearNight:"",IntermittentCloudsNight:"",HazyNight:"",PartlySunnyShowersNight:"",MostyCloudyTStormsNight:"",PartlySunnyTStormsNight:"",MostyCloudyFlurriesNight:"",Sharepoint2013LogoInverse:"",OutlookSpacesBucket:"",CaretSolidAlt:"",PowerVirtualAgentsLogo:"",FluidLogo:"",FormProcessing:"",CategoryClassification:"",PhishingCampaign:"",PhishingHook:"",Ice:"",OfficeCatchUp:"",PartlySunnyFlurriesDay:"",PartlySunnyTStormsDay:"",RewindFourX:"",RewindEightX:"",LockShare:"",LightningBoltSolid:"",Gather:"",AssignPolicy:"",CalculatorGroup:"",MobileAngled:"",CopyEdit:"",EntityExtraction:"",MostySunnyDay:"",PartlySunnyDay:"",IntermittentCloudsDay:"",HazyDay:"",Showers:"",MostyCloudyShowersDay:"",PartlySunnyShowersDay:"",MostyCloudyTStormsDay:"",MostyCloudyFlurriesDay:"",SIPMove:"",EraseTool:"",GripperTool:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",ZoomIn:"",Next:"",Previous:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",CortanaLogoOuter:"",CortanaLogoInner:"",ProvisioningPackage:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Italic:"",Underline:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-16",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('"+e+"odsp-next-icons-16-eaccda2f.woff') format('woff')"},icons:{Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Unfavorite:"",CaretSolid:"",DisableUpdates:"",FolderFill:"",Import:"",Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",Permissions:"",CaretHollow:"",MapDirections:"",Touch:"",Paste:"",WindowsLogo:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",IncomingCall:"",Crop:"",Memo:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",UpdateRestore:"",ContactInfo:"",HexaditeInvestigation:"",PhotoCollection:"",OpenWith:"",Admin:"",SDCard:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Tab:"",Album:"",PowerButton:"",Ferry:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-17",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('"+e+"odsp-next-icons-17-69c9a4df.woff') format('woff')"},icons:{Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Highlight:"",PhotoError:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",PinSolid12:"",PinSolidOff12:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",EntitlementPolicy:"",UserWarning:"",StickyNotesOutlineAppIcon:"",StickyNotesSolidAppIcon:"",Webcam2Off:"",eDiscovery:"",CalendarYear:"",IgnoreConversation:"",Project2019Document:"",CommonDataServiceCDS:"",ComplianceAudit:"",DependencyRemove:"",DependencyAdd:"",UnpublishContent:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:"",PageLink:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",Forum:"",SentimentAnalysis:"",TextRecognition:"",KeyPhraseExtraction:"",AddSpaceAfter:"",TextAlignTop:"",TextAlignMiddle:"",TextAlignBottom:"",TextParagraphOption:"",TextRotation:"",TextRotateHorizontal:"",TextRotate90Degrees:"",TextRotate270Degrees:"",AutoFitContents:"",AutoFitWindow:"",FixedColumnWidth:"",RepeatHeaderRows:"",TableHeaderRow:"",TableTotalRow:"",TableBrandedRow:"",TableFirstColumn:"",TableLastColumn:"",TableBrandedColumn:"",AddSpaceBefore:"",IndentFirstLine:"",WebEnvironment:"",AltText:"",NumberedListMirrored:"",IncreaseIndent:"",IncreaseIndentMirrored:"",DecreaseIndent:"",DecreaseIndentMirrored:"",IncreaseIndentHanging:"",IncreaseIndentHangingMirrored:"",ArchiveUndo:"",LeaveUser:"",FabricFolderUpload:"",RedEye12:"",MapPin12:"",Insights:"",TaskList:"",MachineLearning:"",HealthRefresh:"",FontSize2:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-18",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-18"',src:"url('"+e+"odsp-next-icons-18-08e2c48a.woff') format('woff')"},icons:{SharedDatabase:"",FormatPainter:"",TagGroup:"",MailAttached:"",AddIn:"",LinkedDatabase:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",Spelling:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",Variable2:"",PollResults:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",Rerun:"",EventToDoLogo:"",VisuallyImpaired:"",ContactHeart:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",OneDriveFileVault:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",PythonLogoBlue:"",PythonLogoYellow:"",RustLanguageLogo:"",RubyGemsLogo:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",Header:"",Footer:"",MailOptions:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",FabricTextHighlight:"",IncreaseIndentArrowMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",DecreaseIndentTextMirrored:"",RemoveLinkX:"",RemoveLinkChain:"",NumberedListNumberMirrored:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-19",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-19"',src:"url('"+e+"odsp-next-icons-19-14c40fc8.woff') format('woff')"},icons:{Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:"",CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",AmazonWebServicesLogo:"",Childof:"",XamarinLogo:"",ReactLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",StreamDiscover:"",FabricTextHighlightComposite:"",LearningTools:"",Dataflows:"",ShowGrid:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",GenericScanFilled:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",DockerLogo:"",JavaLogo:"",KeubernetesLogo:"",SwiftLogo:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/iconAliases",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.registerIconAliases=function(){n.registerIconAlias("trash","delete");n.registerIconAlias("onedrive","onedrivelogo");n.registerIconAlias("alertsolid12","eventdatemissed12");n.registerIconAlias("sixpointstar","6pointstar");n.registerIconAlias("twelvepointstar","12pointstar");n.registerIconAlias("toggleon","toggleleft");n.registerIconAlias("toggleoff","toggleright");n.registerIconAlias("edgelogo","edgeoldlogo");n.registerIconAlias("powerappscds","commondataservicecds");n.registerIconAlias("d365talenthrcore","d365corehr");n.registerIconAlias("crmcustomerinsightsapp","insights")};t.default=t.registerIconAliases});
define("odsp-next/utilities/TestHooks",["require","exports","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.__loadTests=function(){return n.loadModuleExport({path:"odsp-next-test/functional/remote/execution/Initialization",require:window.require,getExport:function(e){return e.initialize}}).then(function(e){return e()})}});
define("odsp-next/controls/leftNav/LeftNav",["require","exports","./LeftNav.html","./LeftNavViewModel","../../bindings/component/ControlBinding","ODCOneDrive_css","./leftNavSublink/LeftNavSublink"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/leftNav/LeftNav.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav">\x3c!--ko if:leftNavExpander--\x3e<div class="LeftNav-hamburger" data-bind="component:leftNavExpander"></div>\x3c!--/ko--\x3e<div class="LeftNav-linkArea">\x3c!--ko foreach:linkGroups--\x3e\x3c!--ko if:links&&links().length>0--\x3e<div class="LeftNav-linkGroupContainer" data-bind="css:{\'LeftNav-linkGroupContainer--winApp\':!!$component.isODWinAppLeftNav}"><div class="LeftNav-linkGroup" role="group" data-bind="automation:automationId,css:{\'is-expanded\':isExpanded},selection:{data:links,mode:\'single\',direction:\'vertical\',properties:{focused:\'isFocused\',href:\'url\'}},attr:{tabindex:$component.isLeftNavVisible()?0:-1,\'aria-label\':$component.getLinkGroupAriaLabel($data)}">\x3c!--ko if:!$data.hideGroupHeader--\x3e<div class="LeftNav-linkGroupHeader" data-bind="attr:{title:text},css:{\'LeftNav-linkGroupHeader--hasPlus\':$data.plusIconProperties&&$data.plusIconProperties(),\'LeftNav-linkGroupHeader--hasSubText\':$data.subText,\'LeftNav-linkGroupHeader--hasIcon\':$data.icon,\'ms-fontSize-14\':$component.isFluentFlight,\'ms-font-s\':!$component.isFluentFlight,\'ms-fontWeight-semibold\':$component.isFluentFlight,\'ms-fontWeight-regular\':!$component.isFluentFlight},teachingBubble:{isVisible:$component.isLeftNavVisible,campaign:$data.teachingBubble},click:$component.onClick.bind($component)">\x3c!--ko if:$data.icon--\x3e<span class="od-LeftNav-linkGroupHeaderIcon" data-bind="component:{name:$component.siteIconTagName,params:$data.icon}"></span>\x3c!--/ko--\x3e<span class="od-LeftNav-linkGroupHeaderTitle LeftNav-fadient" data-bind="text:$data.text"></span>\x3c!--ko if:$data.subText--\x3e<span class="od-LeftNav-linkGroupHeaderSubText" data-bind="text:$data.subText"></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko control:$data.notificationSublinkSpecification--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:!$data.hideGroupHeader&&$data.plusIconProperties&&$data.plusIconProperties()--\x3e<a class="LeftNav-linkGroup-plusWrapper" role="button" href="javascript:;" data-bind="css:{\'LeftNav-basicLink\':$data.plusIconProperties().displayLinkWithText,\'LeftNav-linkGroup-addTeamsiteLink\':$data.plusIconProperties().displayLinkWithText},attr:{\'aria-label\':$data.plusIconProperties().text,title:$data.plusIconProperties().displayLinkWithText?\'\':$data.plusIconProperties().text,tabindex:$component.isLeftNavVisible()?0:-1},click:function(context,event){$component.onClick($data.plusIconProperties(),event)}">\x3c!--ko if:$data.plusIconProperties().displayLinkWithText--\x3e<span data-bind="text:$data.plusIconProperties().text"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:$data.plusIconProperties().displayLinkWithText--\x3e<i class="LeftNav-linkGroup-plus ms-Icon ms-Icon--Add" data-bind="icon:true"></i>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/leftNav/LeftNavViewModel",["require","exports","tslib","knockout","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../bindings/selection/SelectionBinding","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/string/StringHelper","./LeftNav.resx","../../utilities/features/Features","../../bindings/keyboard/KeyboardBinding","../siteIcon/SiteIcon","../../bindings/component/ControlBinding","./leftNavSublink/LeftNavSublink.key","../fluentStyling/FluentStyling.key","../../bindings/teachingBubble/TeachingBubbleBinding","../../providers/teachingBubble/TeachingBubbleProvider","../../controls/leftNavExpander/LeftNavExpander","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.pageType=r.resources.consume(w.currentPage);r.siteIconTagName=p.default.tagName;r.addBindingHandlers({teachingBubble:g.default,selection:o.default,keyboard:h.default,control:d.default});r._engagement=n.engagement;var i=r.observables,s=t.linkGroups,u=void 0===s?i.createArray():s,a=t.isLeftNavVisible,f=void 0===a?i.create(!0):a,l=t.overrideResponsiveBehavior,v=void 0!==l&&l;r.overrideResponsiveBehavior=v;r.linkGroups=u;r._teachingBubbleProvider=n.teachingBubbleProvider;r.isLeftNavVisible=f;r.isFluentFlight=n.useFluentStyling;r.responsiveUI=n.responsiveUI;r.isODWinAppLeftNav=c.isFeatureEnabled(c.UseLeftNavInODApp);r.leftNavExpander=i.pureCompute(r._computeLeftNavExpander);r._initializeSubSections();return r}t.prototype.toggleExpanded=function(e){var t=e.engagementName;if(t){t=t.replace(/\s/g,"");e.isExpanded()?t+="Collapse":t+="Expand";this._engagement.logData({name:t+".LeftNav.Click",isIntentional:!0})}e.isExpanded(!e.isExpanded());e.keepOpen=r.observable(!0);return!1};t.prototype.onClick=function(e,t){e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:n.__assign(n.__assign({},e.engagementExtraData||{}),{action:a.capitalizeFirstLetter(t.type)})});var r=this._teachingBubbleProvider;if(e.teachingBubble&&r){var i=r.currentBubble.peek();if(i&&i.campaign&&e.teachingBubble.campaignGuid===i.campaign.campaignGuid){r.clearCurrentBubble();r.markBubbleAsDismissed(e.teachingBubble)}}if(e.action){e.action.execute(t);return!1}return!0};t.prototype.getLinkGroupAriaLabel=function(e){var t=e.groupingName,n=void 0===t?"":t,r=e.text,i=void 0===r?"":r;switch(n){case"SitesGrouping":return f.format(l.default.ariaLabelForLeftNavTeamSiteHeader,this.unwrapObservable(i));case"UserNameGrouping":return f.format(l.default.ariaLabelForLeftNavUserNameLinkGroupHeader,this.unwrapObservable(i));default:return f.format(l.default.ariaLabelForLeftNavLinkGroupHeader,this.unwrapObservable(i))}};t.prototype._computeLeftNavExpander=function(){if((this.overrideResponsiveBehavior?this.responsiveUI.compareSize(this.responsiveUI.formFactorSize(),"Large")<0:this.responsiveUI.isHamburgerVisible())&&c.isFeatureEnabled(c.OneDriveLeftNavHamburger))return{name:b.default.tagName,params:{isInLeftNav:!0}}};t.prototype._processGroups=function(e){for(var t=0;t<this.linkGroups().length;t++){var n=this.linkGroups()[t];n.notificationSublinkSpecification=d.toSpecification(v.default,{isLeftNavVisible:this.isLeftNavVisible,linkGroup:n});t>0&&!n.keepOpen&&n.isExpanded(e)}};t.prototype._initializeSubSections=function(){var e=this;this.createComputed(function(){switch(e.responsiveUI.formFactorSize()){case"Small":case"Medium":case"Large":e._processGroups(!1);return!1;default:e._processGroups(!0);return!0}})};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{teachingBubbleProvider:y.resourceKey.optional,responsiveUI:i.resourceKey,engagement:u.resourceKey,useFluentStyling:m.resourceKey});return t})(s.default);t.default=E});
define("@ms/odsp-shared/lib/utilities/logging/LoggingHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ClickName="Click";t.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}});
define("odsp-next/controls/siteIcon/SiteIcon",["require","exports","./SiteIcon.html","./SiteIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","ODCOneDrive_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-site-icon",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-site-icon",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/siteIcon/SiteIcon.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="od-SiteIcon" data-bind="css:{\'od-SiteIcon--hasIcon\':!!icon,\'od-SiteIcon--hasAcronym\':!!acronym,\'od-SiteIcon--hasImage\':isImageLoaded},class:\'od-SiteIcon--\'+mode,style:{\'background-color\':color}">\x3c!--ko if:!!icon()--\x3e<span class="od-SiteIcon-icon" data-bind="component:{name:iconGlyphTagName,params:iconGlyphParams}"></span>\x3c!--/ko--\x3e\x3c!--ko if:!!acronym()--\x3e<span class="od-SiteIcon-acronym" aria-hidden="true" data-bind="style:acronymStyle,text:acronym"></span>\x3c!--/ko--\x3e\x3c!--ko if:!!iconUrl()--\x3e<span class="od-SiteIcon-image" data-bind="component:{name:imageTileTagName,params:imageTileParams}"></span>\x3c!--/ko--\x3e</span>'});
define("odsp-next/controls/siteIcon/SiteIconViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/tile/ImageTile","../icon/glyph/IconGlyph","@ms/odsp-shared/lib/models/image/Alignments"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageTileTagName=i.default.tagName;r.iconGlyphTagName=s.default.tagName;var u=t.acronym,a=t.color,f=t.icon,l=t.iconUrl,c=t.size,h=void 0===c?{width:28,height:28}:c,p=t.mode,d=void 0===p?"site":p;r._size=r.wrapObservable(h);r.iconUrl=r.wrapObservable(l);r.icon=r.wrapObservable(f);r.acronym=r.wrapObservable(u);r.color=r.wrapObservable(a);r.mode=d;r.acronymStyle=r.createPureComputed(r._computeAcronymStyle);r.isImageLoaded=r.createObservable(!1);r.imageTileParams={image:r.createPureComputed(r._computeImage),isLoaded:r.isImageLoaded,desiredSize:r._size,alignment:o.AlignmentType.fitExpand};r.iconGlyphParams={icon:r.icon};return r}t.prototype._computeImage=function(){return{url:this.unwrapObservable(this.iconUrl),width:0,height:0}};t.prototype._computeAcronymStyle=function(){var e=.4*this._size().height,t=.72*e;return{height:Math.ceil(e)+"px","font-size":Math.ceil(t)+"px","line-height":Math.ceil(e)+"px"}};return t})(r.default);t.default=u});
define("odsp-next/controls/image/tile/ImageTile",["require","exports","./ImageTile.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageTileViewModel","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-image-tile",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/image/tile/ImageTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>"});
define("odsp-next/controls/image/tile/ImageTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","../../../bindings/imageLoader/ImageLoaderBinding","../../../bindings/imageRecycler/ImageRecyclerBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-shared/lib/models/image/Alignments","../../../utilities/images/ThumbnailCache","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({imageLoader:s.default,imageRecycler:o.default});var u=t.image,a=t.rotation,f=void 0===a?i.default.none:a,p=t.desiredSize,d=t.scale,v=void 0===d?1:d,m=t.isLoaded,g=void 0===m?r.createObservable(!1):m,y=t.position,b=t.loadedImage,w=t.error,E=t.loadImageScenarioName,S=n.thumbnailCache,x=void 0===S?r.resources.consume(c.resourceKey):S,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T;r._image=r.wrapObservable(u);r._rotation=r.wrapObservable(f);r._scale=r.wrapObservable(v);r._desiredSize=r.wrapObservable(p);r._alignment=l.createAlignment(t.alignment);r._thumbnailCache=x;r._loadedImage=r.wrapObservable(b);r._error=r.wrapObservable(w);r.isRotating=r._getIsRotating();r.alignmentName=r.createPureComputed(r._computeAlignmentName);r.actualSize=r.createPureComputed(r._computeActualSize);r.actualSize.equalityComparer=h.deepCompare;r.isLoaded=r.createPureComputed(r._computeIsLoaded);r._imageUrl=r.createPureComputed(r._computeImageUrl);r._finalSize=r.createPureComputed(r._computeFinalSize);r._finalSize.equalityComparer=h.deepCompare;r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=h.deepCompare;r.imageElementStyle=r.createPureComputed(r._computeImageElementStyle);r.imageElementStyle.equalityComparer=h.deepCompare;r.imageBackgroundStyle=r.createPureComputed(r._computeImageBackgroundStyle);r.imageBackgroundStyle.equalityComparer=h.deepCompare;r.createBackgroundComputed(r._computeRecordImage);r.imageLoaderParams={src:r._imageUrl,image:r._loadedImage,error:r._error,scenarioName:E};y&&r.createBackgroundComputed(function(){return y(r._position())}).extend(N);g&&r.createBackgroundComputed(function(){return g(r.isLoaded())}).extend(N);return r}t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&u.format(e.url,e.width,e.height)||""};t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var r=this.actualSize(),i=window.devicePixelRatio||1;e=r&&{width:r.width*n/i,height:r.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e};t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=this._alignment.getTransform(n,i),o=s.translate.x/i.width,u=s.translate.y/i.height,f=s.scale*n.width/i.width,l=void 0;if(r){var c=void 0;if(r%2==1){var h={width:n.height,height:n.width};c=this._alignment.getTransform(h,i).multiply(s.invert())}else c=a.default.IDENTITY;l="rotate("+90*r+"deg) scale("+c.scale.toFixed(6)+")"}else l="";e={left:(100*o).toFixed(2)+"%",top:(100*u).toFixed(2)+"%",width:(100*f).toFixed(2)+"%","-webkit-transform":l,"-ms-transform":l,transform:l}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?e.width.toFixed(2)+"px":"","max-height":e?e.height.toFixed(2)+"px":"","background-image":'url("'+t+'")'}};t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),r=this.createPureComputed(function(){var r=t._rotation();e&&t.async.clearTimeout(e);e=t.async.setTimeout(function(){return n(r)},300);return n()});return this.createPureComputed(function(){return t._rotation()!==r()})};t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};t.prototype._computeIsLoaded=function(){return!!this._loadedImage()};t.prototype._computeActualSize=function(){var e,t=this._loadedImage();if(t){e={width:t.width,height:t.height}}return e};t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=void 0;s=r%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(s,i),u=o.translate.x,a=o.translate.y,l=o.scale*s.width,c=o.scale*s.height;e=new f.default(u,a,l,c)}return e};t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return t})(r.default);t.default=p});
define("odsp-next/bindings/imageRecycler/ImageRecyclerBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../imageLoader/ImageLoaderBinding","../../utilities/images/ImageRecycler","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this,u=r.resources.consume(s.resourceKey),a=r.valueAccessor(),f=u.checkOutImage(),l=r.bindingContext,c=a.attr,h=void 0===c?{}:c,p=a.style,d=a.css,v=a.class;o.applyBindingsToNode(f,{attr:n.__assign({alt:""},h)},l);p&&o.applyBindingsToNode(f,{style:p},l);d&&o.applyBindingsToNode(f,{css:d},l);v&&o.applyBindingsToNode(f,{class:v},l);new(r.managed(i.default))({element:f,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return a.imageLoader},bindingContext:l});o.virtualElements.setDomNodeChildren(r.element,[f]);r.addDisposable({dispose:function(){if(f){o.cleanNode(f);u.checkInImage(f).done()}}});r.controlsDescendantBindings=!0;return r}t.supportsVirtualElements=!0;return t})(r.default);t.default=u});
define("odsp-next/utilities/images/ImageRecycler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EMPTY_IMAGE="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var o=(function(e){n.__extends(r,e);function r(t,n){var r=e.call(this,t,n)||this,i=r._images=[];r.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4);return r}r.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};r.prototype.checkInImage=function(e){var n=this,r=new i.default,s=this.async;s.setTimeout(function(){e.setAttribute("src",t.EMPTY_IMAGE);e.removeAttribute("style");e.removeAttribute("class");s.setTimeout(function(){e.removeAttribute("src");n._images.push(e);r.complete()},1e3)},0);return r.getPromise()};return r})(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("@ms/odsp-utilities/lib/math/Transform",["require","exports","./Point","./Rectangle"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){void 0===e&&(e=new n.default);void 0===t&&(t=1);this.translate=e;this.scale=t}e.areEqual=function(e,t,r){void 0===r&&(r=1e-6);return n.default.areEqual(e.translate,t.translate,r)&&Math.abs(Math.log(e.scale/t.scale))<r};e.zoom=function(t,n,r){return new e(t.subtract(n).scale(r-1),r)};e.centerWithinBounds=function(t,i,s){return new e(new r.default(n.default.ORIGIN,t).getCenter().subtract(n.default.getCenter([i,s])))};e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)};e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)};e.IDENTITY=new e;return e})();t.default=i});
define("@ms/odsp-shared/lib/models/image/Alignments",["require","exports","tslib","@ms/utilities-image/lib/Alignments"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-image/lib/Alignments",["require","exports","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Point"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitExpand=3]="fitExpand";e[e.fitExpandHeight=4]="fitExpandHeight";e[e.fitExpandWidth=5]="fitExpandWidth";e[e.fitWidth=6]="fitWidth";e[e.fitHeight=7]="fitHeight";e[e.top=8]="top"})(i=t.AlignmentType||(t.AlignmentType={}));var s=function(e,t){this.name=e;this.getTransform=t};function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new s(e.map(function(e){return e.name}).join("-"),function(t,r){for(var i=n.default.IDENTITY,s=0,o=e;s<o.length;s++){var u=o[s],a={width:t.width*i.scale,height:t.height*i.scale};i=u.getTransform(a,r).multiply(i)}return i})}t.center=new s(i[i.center],function(e,t){var i=new r.default((t.width-e.width)/2,(t.height-e.height)/2);return new n.default(i)});t.top=new s(i[i.top],function(e,t){var i=new r.default((t.width-e.width)/2,0);return new n.default(i)});t.fitWidth=new s(i[i.fitWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fitHeight=new s(i[i.fitHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fit=new s(i[i.fit],function(e,n){return(e.width/e.height>n.width/n.height?t.fitWidth:t.fitHeight).getTransform(e,n)});t.fitExpandWidth=new s(i[i.fitExpandWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,i)});t.fitExpandHeight=new s(i[i.fitExpandHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,i)});t.fitExpand=new s(i[i.fitExpand],function(e,n){return(e.width/e.height>n.width/n.height?t.fitExpandWidth:t.fitExpandHeight).getTransform(e,n)});t.cover=new s(i[i.cover],function(e,n){return(e.width/e.height>n.width/n.height?t.fitHeight:t.fitWidth).getTransform(e,n)});t.fitCenter=o(t.fit,t.center);t.fitExpandCenter=o(t.fitExpand,t.center);t.coverCenter=o(t.cover,t.center);function u(e){var n,r;if("string"==typeof e)n=i[e];else{if((function(e){return"object"==typeof e})(e))return e;n=e}switch(n){case i.top:r=t.top;break;case i.fitHeight:r=t.fitHeight;break;case i.fitWidth:r=t.fitWidth;break;case i.fit:r=t.fitCenter;break;case i.fitExpand:r=t.fitExpandCenter;break;case i.center:r=t.center;break;default:r=t.coverCenter}return r}t.getAlignment=u;t.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return o.apply(void 0,t.map(u))}});
define("odsp-next/controls/icon/glyph/IconGlyph",["require","exports","./IconGlyph.html","./IconGlyphViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-icon-glyph",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/icon/glyph/IconGlyph.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<i class=\"od-IconGlyph\" data-bind=\"class:iconClasses,attr:{'data-icon-name':icon},css:{'od-IconGlyph--badged':badge,'od-IconGlyph--visible':icon},with:badge\"><i class=\"od-IconGlyph-badge\" data-bind=\"class:$component.badgeClasses,attr:{'data-icon-name':$component.badge}\"></i></i>"});
define("odsp-next/controls/icon/glyph/IconGlyphViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.icon=i.isObservable(t.icon)?t.icon:i.observable(t.icon);n.badge=i.isObservable(t.badge)?t.badge:i.observable(t.badge);n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""});n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""});return n}return t})(r.default);t.default=s});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./LeftNavSublink"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/bindings/teachingBubble/TeachingBubbleBinding",["require","exports","tslib","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=n.resources.consume(r.teachingBubble.optional);if(!i)return n;n.teachingBubbleProvider=i;n._value=n.valueAccessor();n._firstRunExperienceStatus=n.resources.consume(s.resourceKey);n.createBackgroundComputed(n._computeAddTeachingBubble);return n}t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign),n=this.wrapObservable(e.isVisible);if(this._firstRunExperienceStatus()===o.FirstRunExperienceStatus.notVisible&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.peek()&&this.teachingBubbleProvider.currentBubble.peek().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,isVisible:n,element:this.element})}}};return t})(i.default);t.default=u});
define("odsp-next/controls/leftNavExpander/LeftNavExpander",["require","exports","./LeftNavExpander.html","./LeftNavExpanderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCOneDrive_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-left-nav-expander",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/leftNavExpander/LeftNavExpander.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-LeftNavExpander-commandBar" data-bind="control:commandBarSpecification"></div>'});
define("odsp-next/controls/leftNavExpander/LeftNavExpanderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./commandSets/LeftNavExpanderCommandSet","../commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../resources/PagesResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({control:o.default});var r=t.isInLeftNav,a=void 0!==r&&r;n.commandBarSpecification=o.toSpecification(s.resourceKey,{commandSet:new(n.managed(i.default))({isInLeftNav:a,isLeftNavExpanded:n.resources.consume(u.base.leftNav.isLeftNavUserExpanded)})});return n}return t})(r.default);t.default=a});
define("odsp-next/controls/leftNavExpander/commandSets/LeftNavExpanderCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../actions/ToggleIsLeftNavUserExpandedAction","../../../utilities/icons/Icon","../../commands/Commands.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.isInLeftNav?"leftNavToggleLeftNavCommand":"commandBarToggleLeftNavCommand";n.commands.push(new(n.managed(i.CommandViewModel))({action:new(n.managed(s.default))({isInLeftNav:t.isInLeftNav}),icon:new o.default("GlobalNavButton"),text:u.default.ToggleLeftNavCommandTooltip,tooltip:u.default.ToggleLeftNavCommandTooltip,automationId:r,accessibleLabel:u.default.ToggleLeftNavCommandAriaLabel,ariaExpanded:t.isLeftNavExpanded,ariaHasPopup:!0,isToggleable:!0,renderLabel:0,hasIconOnly:!0}));return n}return t})(r.default);t.default=a});
define("odsp-next/controls/commands/BaseCommandSet",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Command","./Commands.resx","../../utilities/browser/ResponsiveUI","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.responsiveUI=n.resources.consume(o.resourceKey);n.commands=n.observables.createArray();t.disableOverflowHost||(n.overflowHostCommand=new(n.managed(i.CommandViewModel))({text:s.default.OverflowCommandLabel,tooltip:s.default.OverflowCommandTooltip,accessibleLabel:s.default.OverflowCommandTooltip,renderLabel:0,requiredChildren:1,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:new u.default("More"),hasIconOnly:!0,children:n.observables.createArray(),location:3}));return n}return t})(r.default);t.BaseCommandSet=a;t.default=a});
define("odsp-next/controls/commands/Command",["require","exports","./CommandViewModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandViewModel=n.default;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,n.default)});
define("odsp-next/controls/commands/CommandViewModel",["require","exports","tslib","./CommandState","@ms/odsp-shared/lib/base/ViewModel","../../bindings/beakAdorner/BeakAdornerBinding","../../bindings/dismiss/DismissBinding","../../bindings/element/ElementBinding","../../bindings/longHover/LongHoverBinding","../../bindings/measure/MeasureBinding","../../bindings/tooltip/TooltipBinding","../../bindings/raiseEventOnChange/RaiseEventOnChangeBinding","../../bindings/teachingBubble/TeachingBubbleBinding","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/math/Point","../../bindings/fileInput/FileInputBinding","@ms/odsp-shared/lib/base/ActionInputType","../../utilities/logging/LoggingContextHelper","../../bindings/component/ControlBinding","../../utilities/browser/ResponsiveUI","../../base/ColorVariation","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=0;var k=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var i=e.call(this,(function(e){e.id=e.id||""+C++;return e})(t),n)||this;i.ActionInputType=b.default;i._defaultMenuOffset=new g.default(0,s.default.size/2+4);i.addBindingHandlers({dismiss:o.default,raiseEventOnChange:c.default,measure:f.default,longHover:a.default,element:u.default,teachingBubble:h.default,fileInput:y.default,tooltip:l.default,control:E.default});var p=i,d=p.observables,m=p.resources,w=n.engagement,T=void 0===w?m&&m.consume(v.resourceKey.optional):w,N=n.responsiveUI,k=void 0===N?m&&m.consume(S.resourceKey.optional):N;i._isOpenRequested=i.createObservable(!1);i.isActive=i.createObservable(!1);i.isToggled=i.createObservable(!1);i.focused=i.createObservable(!1);i.menuFocus=i.createObservable(!1);i.fileInputElement=i.createObservable();var L=t.text,A=void 0===L?"":L,O=t.automateExperimentText,M=t.subtext,_=void 0===M?"":M,D=t.classSuffix,P=void 0===D?i.createObservable():D,H=t.collapsedText,B=void 0===H?i.createObservable():H,j=t.location,F=void 0===j?11:j,I=t.renderLabel,q=void 0===I?1:I,R=t.isCurrentView,U=void 0===R?null:R,z=t.hasIconOnly,W=void 0!==z&&z,X=t.positionIconRight,V=void 0!==X&&X,$=t.icon,J=t.iconUrl,K=t.appIconName,Q=t.ariaControls,G=t.ariaExpanded,Y=t.ariaHasPopup,Z=t.keys,ee=void 0===Z?[]:Z,te=t.isToggleable,ne=void 0!==te&&te,re=t.isHidden,ie=void 0===re?i.createObservable():re,se=t.isDisabled,oe=t.isInvisibleWhenDisabled,ue=void 0!==oe&&oe,ae=t.tooltip,fe=void 0===ae?null:ae,le=t.accessibleLabel,ce=void 0===le?"":le,he=t.prependTextToAccessibleLabel,pe=void 0===he||he,de=t.sectionAccessibleLabel,ve=void 0===de?"":de,me=t.role,ge=void 0===me?"":me,ye=t.teachingBubble,be=t.iconBadge,we=t.isPermanent,Ee=void 0!==we&&we,Se=t.state,xe=void 0===Se?i.createObservable(r.default.initialized):Se,Te=t.requiredChildren,Ne=void 0===Te?0:Te,Ce=t.collapseSingleChildCommands,ke=void 0===Ce||Ce,Le=t.hasLineBreakBefore,Ae=void 0!==Le&&Le,Oe=t.hasLineBreakAfter,Me=void 0!==Oe&&Oe,_e=t.action,De=t.callback,Pe=t.onCoachmarkOpen,He=t.menuAlignment,Be=void 0===He?i.createObservable(0):He,je=t.menuOffset,Fe=void 0===je?i.createObservable(i._defaultMenuOffset):je,Ie=t.isMenuBeakVisible,qe=void 0===Ie?i.createObservable(!0):Ie,Re=t.payload,Ue=t.enableRecoverFocusBinding,ze=void 0!==Ue&&Ue,We=t.engagementName,Xe=t.source,Ve=t.experiment,$e=t.isLastPivot,Je=void 0!==$e&&$e,Ke=t.hasAnimation,Qe=void 0!==Ke&&Ke,Ge=t.hidesMenuChevron,Ye=void 0!==Ge&&Ge,Ze=t.children,et=void 0===Ze?i.observables.createArray():Ze,tt=t.isStrong,nt=void 0===tt?i.createObservable(!1):tt,rt=t.hasDeferredChildren,it=void 0!==rt&&rt,st=t.hasDynamicText,ot=void 0!==st&&st,ut=t.reportClickingTime,at=t.beakColor,ft=void 0===at?x.default.white:at,lt=t.isContentType,ct=t.overrideTabIndex;i.text=i.wrapObservable(A);i.automateExperimentText=i.wrapObservable(O);i.subtext=i.wrapObservable(_);i.commandClass=i.wrapObservable(P);i.collapsedText=B;0;i.isLabelVisible=2===q?k.showLabels:d.create(1===q);i.isToggleable=ne;i.location=F;i.isPermanent=i.wrapObservable(Ee);i.requiredChildren=Ne;i.collapseSingleChildCommands=ke;i.hasLineBreakAfter=i.wrapObservable(Me);i.hasLineBreakBefore=i.wrapObservable(Ae);i.action=_e;i.ariaControls=Q;i.ariaExpanded=G;i.ariaHasPopup=Y;i.callback=De;i.onCoachmarkOpen=Pe;i.hidesMenuChevron=Ye;i.isStrong=nt;i.isClipped=i.createObservable(!1);i.hasDynamicText=ot;i._reportClickingTime=ut;i.beakColor=ft;i.isContentType=lt;i._engagement=T;i.action&&i.action.inputType?i.inputType=i.createPureComputed(i._computeInputType):i.inputType=i.createObservable(b.default.none);i._initializeIcons($,J,be,K);i.tooltip=i.wrapObservable(fe);i.accessibleLabel=i.wrapObservable(ce);i.prependTextToAccessibleLabel=pe;i.sectionAccessibleLabel=i.wrapObservable(ve);i.role=ge||(ne?"menuitemcheckbox":"menuitem");ye&&(i.teachingBubble=i.wrapObservable(ye));se&&(i.isDisabled=se);i.isInvisibleWhenDisabled=ue;i._isHidden=i.wrapObservable(ie);i.bounds=i.createObservable();i.measurementReady=function(e){i.onMeasurementReady(e)};i.payload=Re;i.enableRecoverFocusBinding=ze;i.keys=ee;i.children=et instanceof Array?i.observables.createArray(et):et;i.addDisposable(i.children.map({mappingWithDisposeCallback:function(e){e.parentCommand=i;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));i.visibleChildren=i.addDisposable(i.children.filter(function(e){return e.isVisible()}));i.hasDeferredChildren=it;i.isToggled=i.createComputed(i._computeIsToggled);i.hasAnimation=Qe;i.isVisible=i.createComputed(i._computeIsVisible);i.state=i.wrapObservable(xe);i.isCurrentView=U;i.isLastPivot=Je;i.isCollapsed=i.createComputed(function(){return i.collapseSingleChildCommands&&1===i.visibleChildren().length});i.menuAlignment=i.wrapObservable(Be);i.menuOffset=i.wrapObservable(Fe);i.isMenuBeakVisible=i.wrapObservable(qe);i.targetCommand=i.createComputed(function(){if(i.isCollapsed()){return i.visibleChildren()[0]}return i});i.label=i.createComputed(i._computeLabel);i.computedAccessibleLabel=i.createPureComputed(function(){return i._computeAccessibleLabel()});i.hasIconOnly=i.wrapObservable(W);i.positionIconRight=V;i.isOpen=i.createComputed({read:function(){return i._isOpenRequested()&&(i.visibleChildren().length>0||!(!i.payload||!i.payload.control()))},write:function(e){i._isOpenRequested(e)},pure:!0});i.subscribe(i.isOpen,function(e){e||i.children().forEach(function(e){e.children().length>0&&e.isOpen(!1)})});var ht=i.addDisposable(i.visibleChildren.filter(function(e){return e.isOpen()})),pt=i.createComputed(function(){return ht().length>0});i.subscribe(pt,function(e){e||i.async.setImmediate(function(){document.activeElement&&document.activeElement!==document.body||i.focused(!0)})});i.tabindex=i.createObservable(0);i.createComputed(function(){if(!i.isOpen()&&i.focused()){i.tabindex(0);i.isActive(!0)}else i.isActive()||i.tabindex(ct?0:-1)});i.isDisabled||(i.isDisabled=i.createComputed(function(){return i.targetCommand()!==i?i.targetCommand().isDisabled():i.requiredChildren>0?i.visibleChildren().length<i.requiredChildren:!(i.visibleChildren().length||i.action&&(i.action.isAvailable()||i.isToggleable&&i.action.isToggled())||i.callback)}));i.layoutChanged=i.createObservable();i.createComputed(function(){i.isLabelVisible();i.text();i.layoutChanged.notifySubscribers()});i.engagementName=We;i.source=i.wrapObservable(Xe);i.experiment=Ve;return i}t.prototype.getKey=function(){return this.id};t.prototype.hasVisibleChildren=function(){return this.visibleChildren().length>0};t.prototype.hasVisibleOrDeferredChildren=function(){return this.hasVisibleChildren()||this.hasDeferredChildren};t.prototype.onMeasurementReady=function(e){this.bounds(e)};t.prototype.onClick=function(e,t){var i,s=this,o=t&&t.type||"unknown",u=["CommandView",m.capitalizeFirstLetter(o)],a=!1;this._reportClickingTime&&this._reportClickingTime();if((0===this.location||this.isVisible.peek())&&!this.isDisabled.peek()){var f=this.isCollapsed.peek()?this.visibleChildren.peek()[0]:this,l=f.visibleChildren.peek().length&&(f.icon||f.text),c=f.action&&f.action.isAvailable.peek(),h=e.engagementName,p=e.source;if(h){u=[h,m.ClickName];p&&p.peek()&&(u[0]+=p.peek());i=u.join(".")}else if(l){var v=f.icon&&f.icon.peek(),g=v?v.toString():!N.Killswitch.isActivated("C96CA678-2237-40BA-8164-CAE7088502E3","12/6/2019","Use engagement name for command tag name when iconname is not available")&&f.visibleChildren.peek()[0]&&f.visibleChildren.peek()[0].engagementName?f.visibleChildren.peek()[0].engagementName:"Unknown";u.splice(1,0,"Parent"+m.capitalizeFirstLetter(g));i=u.join(".")}else if(c){u.splice(1,0,m.capitalizeFirstLetter(f.action.name));i=u.join(".")}f.payload&&f.payload.control.peek()&&f.isOpen.peek()&&f.isOpen(!1);if(i){var y=this._engagement,b={name:i,isIntentional:!0,experiment:e.experiment,extraData:n.__assign({action:m.capitalizeFirstLetter(o)},w.LoggingContextHelper.getLoggingContextData(this.resources))};y?y.logData(b):d.Engagement.logData(b)}if(l){f.closeSiblingCommands();f.parentCommand?f.isOpen(!0):f.isOpen(!f.isOpen.peek());f.isOpen.peek()&&f.focused(!0);f.callback&&f.callback();a=!0}else if(c){if(!e.isDisabled||!e.isDisabled.peek()){if(f.fileInputElement.peek()&&f.action.isAvailable.peek()){f.fileInputElement.peek().click()}else{this.state(r.default.executed);f.action.execute(t).done(function(){s.state(r.default.initialized)},function(e){s.state(r.default.failed)})}"MoveCopy"===f.action.name&&e.isDisabled(!0)}a=!0}else if(f.callback){f.callback();a=!0}}a&&t&&t.stopPropagation();return!a};t.prototype.onDismiss=function(){var e=this.visibleChildren.peek();(this.payload&&this.payload.control.peek()||e&&e.length)&&this.isOpen(!1)};t.prototype.onInputChange=function(e){var t=this.targetCommand();if(t&&t.action){t.action.execute(e);this.closeParentCommands()}};t.prototype.openMenu=function(){var e=this.visibleChildren();if(e&&e.length){this.isOpen(!0);return!0}return!1};t.prototype.getIcon=function(e){var t=e;this.icon&&this.icon()&&(t+=" "+this.icon().getClass());return t};t.prototype.getChevron=function(){var e=p.default.isRightToLeft?"ChevronLeft":"ChevronRight";return T.getIconClassName(e)};t.prototype.getChevronDown=function(e){return T.getIconClassName("ChevronDown")};t.prototype.closeParentCommands=function(){for(var e=this.parentCommand;e;){e.isOpen(!1);e=e.parentCommand}};t.prototype.closeSiblingCommands=function(){var e=this;this.parentCommand&&this.parentCommand.children().forEach(function(t){t!==e&&t.isOpen(!1)})};t.prototype._initializeIcons=function(e,t,n,r){var i=this,s=this.createPureComputed(function(){return i.isCollapsed()?i.targetCommand().icon():void 0}),o=this.createPureComputed(function(){return i.isCollapsed()?i.targetCommand().iconUrl():void 0}),u=this.wrapObservable(e);this.icon=this.createPureComputed(function(){if(i.isCollapsed()){var e=s();if(e)return e;if(o())return}return u()});var a=this.wrapObservable(t);this.iconUrl=this.createPureComputed(function(){if(i.isCollapsed()){if(s())return;return o()||a()}return a()});var f=this.wrapObservable(n);this.iconBadge=this.createPureComputed(function(){return i.isCollapsed()&&i.targetCommand().iconBadge()||f()});this.appIconName=r};t.prototype._computeIsToggled=function(){return this.isCurrentView?this.isCurrentView():!!this.action&&this.action.isToggled()};t.prototype._computeIsVisible=function(){return 0!==this.location&&(!this._isHidden()&&(this.requiredChildren>0?this.visibleChildren().length>=this.requiredChildren:!this.action||(this.isPermanent()||this.action.isAvailable()||this.isToggleable&&this.action.isToggled())))};t.prototype._computeLabel=function(){return this.isCollapsed()?this.targetCommand().collapsedText()||this.targetCommand().text():this.text()};t.prototype._computeAccessibleLabel=function(){var e,t=this.accessibleLabel(),n=this.sectionAccessibleLabel()||"",r=this.label(),i=t;e=i&&r&&i!==r&&this.prependTextToAccessibleLabel?r+". "+i:i||r||"";return n&&e?n+". "+e:e||n};t.prototype._computeInputType=function(){return this.action&&this.action.inputType&&this.action.inputType()||b.default.none};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{engagement:v.resourceKey,responsiveUI:S.resourceKey.optional});return t})(i.default);t.default=k});
define("odsp-next/controls/commands/CommandState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.initialized=0]="initialized";e[e.executed=1]="executed";e[e.failed=2]="failed"})(n||(n={}));t.default=n});
define("odsp-next/bindings/longHover/LongHoverBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||400;n.events.on(n.element,"mouseenter",n._onMouseEnter);n.events.on(n.element,"mouseleave",n._onMouseLeave);return n}t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}};t.prototype._onMouseEnter=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onHoverTimer,this._delay)};t.prototype._onMouseLeave=function(e){this._clearTimer()};t.prototype._onHoverTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(r.default);t.default=i});
define("odsp-next/bindings/tooltip/TooltipBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../controls/tooltip/Tooltip"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor();n.createComputed(function(){n.unwrapObservable(r.isTooltipDisabled);n._removeTooltip()});n.events.onAll(n.element,{mouseenter:n._insertTooltip,mouseleave:n._removeTooltip,focusin:n._insertTooltip,focusout:n._removeTooltip,click:n._removeTooltip});n.addDisposable({dispose:function(){n._removeTooltip()}});return n}t.prototype._insertTooltip=function(e){var t=this;if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))){this._removeTooltip();var n=this.valueAccessor();if(n&&n.content&&!this.peekUnwrapObservable(n.isTooltipDisabled)&&this.peekUnwrapObservable(n.content)){var i=o=this._createTooltip(n);r.tasks.schedule(function(){o===i&&t.element.appendChild(o)})}}};t.prototype._createTooltip=function(e){var t=document.createElement("span"),n={content:this.peekUnwrapObservable(e.content),targetElement:this.element},i={component:{name:s.default.tagName,params:n}};r.applyBindingsToNode(t,i);return t};t.prototype._removeTooltip=function(e){if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))&&o){r.removeNode(o);o=null}};return t})(i.default);t.default=u});
define("odsp-next/controls/tooltip/Tooltip",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.createComponent("ms-react-tooltip","./TooltipContainer",function(){return n.default.resolve(new Promise(function(t,n){e(["./TooltipContainer"],t,n)}))},{calloutProps:{gapSpace:0}});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);t.default=s});
define("odsp-next/controls/reactHost/ReactHost",["require","exports","tslib","./ReactHost.html","./ReactHostViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createComponent=function(e,t,s,o){return{tagName:e,template:r.default,viewModel:{createViewModel:function(e,r){return new(e.resources.injected(i.default))(n.__assign(n.__assign({},"string"==typeof t?{component:t,getComponentModule:s}:{component:t}),{error:e.reactRenderError,props:n.__assign(n.__assign({},o||{}),e)}),r)}},synchronous:!0}}});
define("odsp-next/controls/reactHost/ReactHost.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div data-bind="react:reactBindingParams"></div>'});
define("odsp-next/controls/reactHost/ReactHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/react/ReactBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t)||this,o=n.__assign(n.__assign({},t.props||{}),{hostViewModel:s});s.addBindingHandlers({react:i.default});s.reactBindingParams=n.__assign({props:o,error:t.error},(function(e){return"string"==typeof e.component})(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component});return s}return t})(r.default);t.default=s});
define("odsp-next/bindings/react/ReactBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","react","react-dom","@ms/odsp-utilities/lib/performance/PerformanceCollection","knockout","../../utilities/array/ArrayHelper","@ms/items-view/lib/private/utilities/objects","@ms/odsp-utilities/lib/async/PromiseDebouncer","../../controls/base/react/WithResources","../../controls/errorBoundary/ErrorBoundary","@ms/odsp-utilities/lib/logging/ErrorHelper","@uifabric/utilities/lib/dom/findElementRecursive"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=new((function(){function e(){this._promises={}}e.prototype.load=function(e){var t=e.path,n=e.getModule,r=window.require.toUrl(t+"_unmapped"),u=this._promises,a=u[r];a||(a=u[r]=i.default.as("undefined"==typeof __webpack_public_path__&&this._loadSync(t,window.require)||o.loadModule({path:t,getModule:n}))).done(void 0,function(e){delete u[r]});var f=new s.default;a.done(function(e){return f.complete(e)},function(e){return f.error(e)});return f.getPromise()};e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var r=t(e);if(r)if("object"==typeof r){if(Object.keys(r).length>0){var i=o.getDefaultExport(r);i&&(n=i)}}else n=r}return n};return e})()),b=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onRootRef=function(e){r._root=e};r._renderPortal=function(e,t){r.setState(function(i){var s=i.portals,o=c.findMatch(s,function(e){return e.owner===t});return o?n.__assign(n.__assign({},i),{portals:n.__spreadArrays(s.slice(0,o.index),[n.__assign(n.__assign({},o.value),{portal:e})],s.slice(o.index+1))}):n.__assign(n.__assign({},i),{portals:n.__spreadArrays(s,[{owner:t,portal:e,key:""+ ++r._lastId}])})})};r._unmountPortal=function(e){r.setState(function(t){var r=t.portals,i=c.findMatch(r,function(t){return t.owner===e});return i?n.__assign(n.__assign({},t),{portals:n.__spreadArrays(r.slice(0,i.index),r.slice(i.index+1))}):t})};r.state={portals:[]};r._lastId=0;r._context={render:r._renderPortal,unmount:r._unmountPortal};return r}t.prototype.render=function(){var e=this.props,t=(e.bindingContext,e.applyBindings),r=n.__rest(e,["bindingContext","applyBindings"]);return t?u.createElement(u.Fragment,null,u.createElement("div",n.__assign({key:"root",ref:this._onRootRef,role:"presentation","data-is-ko-react-root":"true"},r)),this.state.portals.map(function(e,t){return u.createElement(u.Fragment,{key:e.key||""+t},e.portal)})):null};t.prototype.componentDidMount=function(){var e=this.props.applyBindings;if(this._root&&e){var t=e(this._root,this.props.bindingContext.extend({$react:this._context}));t&&(this._disposable=t)}};t.prototype.componentWillUnmount=function(){this._disposable&&this._disposable.dispose();this._root&&l.cleanNode(this._root)};return t})(u.PureComponent);t.KnockoutChildren=b;var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r,s=n.observables;n._value=s.pureCompute(function(){return s.unwrap(n.valueAccessor())});if(n._value.peek().useDOMContext){var o=g.findElementRecursive(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(r=l.contextFor(o))}else r=n.bindingContext;n._context=r&&r.$react;n._transcludedTemplateNodes=Array.prototype.slice.call(l.virtualElements.childNodes(n.element));l.virtualElements.emptyNode(n.element);n._renderDependencies=n.createObservable();n._componentProps=s.pureCompute(function(){return s.unwrap(n._value().props)});n._componentProps.equalityComparer=h.areShallowEqual;n._rootProps=s.pureCompute(function(){return s.unwrap(n._value().rootProps)});n._rootProps.equalityComparer=h.areShallowEqual;var u=n.scope.attach(new p.default);n.createComputed(function(){var e,t=n._value();if((function(e){return!!e.componentType})(t)){var r=n.observables.unwrap(t.componentType);n._componentNameForLogging=r.displayName||"";f.default.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=i.default.wrap(r)}else{t.getModule||console.error("ReactBinding instantiated with componentPath "+t.componentPath+" but missing getModule");n._componentNameForLogging=t.componentPath;f.default.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=y.load({path:t.componentPath,getModule:t.getModule})}n.trackPromise(u.debounce(i.default.all({componentType:e}).then(function(e){f.default.mark("EUPL.ReactBinding.Loaded."+n._componentNameForLogging);var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n)}:function(){a.unmountComponentAtNode(n.element)}});n._renderDependencies(e)})))});n.createComputed(n._computeRenderComponent);return n}t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var r=t.componentType,i=this._componentProps(),s=this._rootProps(),o=this._transcludedTemplateNodes;f.default.mark("EUPL.ReactBinding.AsyncRender."+this._componentNameForLogging);try{this.observables.ignore(function(){var t=o.length>0?function(e,t){l.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,f=u.createElement(d.ResourcesContextProvider,{resources:e.resources},u.createElement(v.ErrorBoundary,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},u.createElement(r,n.__assign({},i),u.createElement(b,n.__assign({bindingContext:e.bindingContext,applyBindings:t},s||{})))));e._context?e._context.render(a.createPortal(f,e.element),e):a.render(f,e.element)})}catch(e){m.default.logError(e)}}};return t})(r.default);t.default=w});
define("@ms/items-view/lib/private/utilities/objects",["require","exports","tslib","@ms/utilities-objects/lib/areShallowEqual","@ms/utilities-objects/lib/assign"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.areShallowEqual=r.areShallowEqual;t.assign=i.assign;t.mapObject=function(e,t,n){var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=e[i],o=n?n(i,s):i;"string"==typeof o&&(r[o]=t(s,o))}return r};t.pickObject=function(e,t){var r=t instanceof Array?s(t,function(){return!0}):t,i=void 0;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o))if(o in r);else{i||(i=n.__assign({},e));delete i[o]}return i||e};function s(e,t,n){for(var r={},i=0,s=e;i<s.length;i++){var o=s[i];r[n?n(o):o]=t(o)}return r}t.makeObject=s});
define("@ms/utilities-objects/lib/areShallowEqual",["require","exports","./is"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.areShallowEqual=function(e,t,i){void 0===i&&(i=n.is);return!r(e,t,{comparer:i})};function r(e,t,r){var i;void 0===r&&(r={});var s=r.comparer,o=void 0===s?n.is:s,u=r.debug,a=void 0!==u&&u;if(n.is(e,t))return!1;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!a||{previous:e,next:t};var f=Object.keys(e),l=Object.keys(t);if(f.length!==l.length)return!a||{__keys:{previous:f,next:l}};for(var c=0,h=f;c<h.length;c++){var p=h[c];if(!(p in t)||!o(e[p],t[p],p))return!a||((i={})[p]={previous:e[p],next:t[p]},i)}return!1}t.areShallowDifferent=r});
define("@ms/utilities-objects/lib/is",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}});
define("odsp-next/controls/base/react/WithResources",["require","exports","tslib","react","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/scope/Scope"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.createContext(void 0);function u(e){return r.createElement(o.Provider,{value:e.resources},e.children)}t.ResourcesContextProvider=u;function a(){var e=r.useContext(o);if(!e)throw new Error("No ResourceScope available in the current React context. Use ResourcesContextProvider to inject a ResourceScope.");return e}t.useResourceScope=a;t.withResources=function(){return function(e){var t=e;return function(e){var i=a();return r.createElement(t,n.__assign({},e,{resources:i}))}}};var f=e("module").id;t.withChildResources=function(e,t){void 0===t&&(t={owner:f});return function(o){var f=o;return function(o){var l=a(),c=r.useRef(),h=c.current||(c.current=new s.default),p=r.useRef(),d=p.current||(function(){var n=new i.ResourceScope(l,t),r=e(n,o);r&&h.attach(r);return p.current=n})();r.useLayoutEffect(function(){return function(){h.dispose()}},[h]);return u({resources:d,children:r.createElement(f,n.__assign({},o))})}}}});
define("odsp-next/controls/errorBoundary/ErrorBoundary",["require","exports","tslib","react","@ms/telemetry-manager/lib/events/ResultTypeEnum","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:r.createElement(r.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e,t){var n=this.props.onError;s.default.logError(e,{"react.componentStack":t.componentStack,"react.component":this.props.componentName},{eventName:"ReactRenderError",resultCode:"",resultType:i.ResultTypeEnum.Failure});n&&n(e)};return t})(r.PureComponent);t.ErrorBoundary=o});
define("odsp-next/bindings/raiseEventOnChange/RaiseEventOnChangeBinding",["require","exports","knockout","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.init=function(e,t){var i=n.utils.unwrapObservable(t()),s=i.eventName||"dataChange",o=i.eventArgs,u=n.isObservable(i.data)?i.data:n.observable(),a=i.bubbleEvent||!1;u.subscribe(function(){r.default.raise(e,s,o,a)})};return e})();t.default=i});
define("odsp-next/bindings/fileInput/FileInputBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._insertNewElement();n.controlsDescendantBindings=!0;return n}t.prototype.dispose=function(){if(this._previousElement){r.cleanNode(this._previousElement);delete this._previousElement}e.prototype.dispose.call(this)};t.prototype._insertNewElement=function(){var e=this.valueAccessor(),t=this._createInputElement(e.isFolderUpload);this._applyBindings(t,e);r.virtualElements.setDomNodeChildren(this.element,[t]);this._previousElement=t};t.prototype._createInputElement=function(e){var t=document.createElement("input");t.type="file";t.tabIndex=-1;if(e){t.webkitdirectory=!0;t.directory=!0}else t.multiple=!0;return t};t.prototype._applyBindings=function(e,t){var n=this;r.applyBindingsToNode(e,{class:t.class,css:t.css,style:t.style,event:{change:function(e,r){t.onInputChange.call(e,r);n._insertNewElement()}}},this.bindingContext)};t.supportsVirtualElements=!0;return t})(i.default);t.default=s});
define("odsp-next/utilities/logging/LoggingContextHelper",["require","exports","tslib","knockout","../../resources/SPOResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(){}e.Search="Search";return e})();t.LoggingContextBuckets=o;var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBuckets=function(){return t.getBuckets(this.resources)};t.getBuckets=function(e){return e&&e.isExposed(i.loggingContextBuckets)?e.consume(i.loggingContextBuckets):r.observable([])};t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)};t.getLoggingContextData=function(e){var n=null;e&&e.isExposed(i.loggingContext)&&(n=e.consume(i.loggingContext));return n?n.get(t.getBuckets(e).peek()):{}};t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)};t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(i.loggingContextBuckets)&&(n=e.consume(i.loggingContextBuckets).peek());t.forEach(function(e){n.indexOf(e)<0&&n.push(e)});e.isExposed(i.loggingContextBuckets)||e.expose(i.loggingContextBuckets,r.observable(n))}};return t})(s.default);t.LoggingContextHelper=u});
define("odsp-next/controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../resources/PagesResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.isInLeftNav,i=void 0!==r&&r;n.name=i?"LeftNavToggleIsLeftNavUserExpanded":"CommandBarToggleIsLeftNavUserExpanded";n._isLeftNavUserExpanded=n.resources.consume(o.base.leftNav.isLeftNavUserExpanded);n._toggleIsLeftNavUserExpanded=n.resources.consume(o.base.leftNav.toggleIsLeftNavUserExpanded);return n}t.prototype.onExecute=function(e){this._toggleIsLeftNavUserExpanded();return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return this._isLeftNavUserExpanded()};return t})(r.default);t.default=u});
define("odsp-next/controls/commandBar/CommandBar.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./CommandBar"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink",["require","exports","./LeftNavSublink.html","./templates/Link.html","./templates/IndentedLink.html","./templates/Load.html","./templates/Text.html","./templates/WarningText.html","./templates/GroupLink.html","./templates/More.html","./templates/NotificationLink.html","./templates/BasicLink.html","./templates/Component.html","./LeftNavSublinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./templates/LeftNavTemplates","../../../bindings/component/ControlBinding","ODCOneDrive_css","../../loadingSpinner/LoadingSpinner","../../siteIcon/SiteIcon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=m.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav-sublink",name:e("module").id,template:n.default,viewModelType:p.default});d.registerTemplate(v.LINK_TEMPLATE,r.default);d.registerTemplate(v.INDENTED_TEMPLATE,i.default);d.registerTemplate(v.LOAD_TEMPLATE,s.default);d.registerTemplate(v.TEXT_TEMPLATE,o.default);d.registerTemplate(v.WARNING_TEXT_TEMPLATE,u.default);d.registerTemplate(v.GROUPLINK_TEMPLATE,a.default);d.registerTemplate(v.MORE_TEMPLATE,f.default);d.registerTemplate(v.NOTIFICATION_TEMPLATE,l.default);d.registerTemplate(v.BASIC_LINK_TEMPLATE,c.default);d.registerTemplate(v.COMPONENT_TEMPLATE,h.default);t.default=t.resourceKey});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-subLinksClip"><div class="LeftNav-subLinks" data-bind="attr:{role:sublinkRole},style:{marginTop:0},template:{name:renderMode,foreach:leftNavRenderedItems,as:\'linkItem\'}"></div></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Link.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:!$data.isHidden||!$data.isHidden()--\x3e<a role="menuitem" class="LeftNav-subLink ms-font-m" data-bind="attr:{href:$data.url,target:$data.openInNewTab&&$data.openInNewTab()?\'_blank\':null,tabindex:isFocused()?0:-1,\'aria-current\':isActive()?\'page\':undefined,\'aria-label\':$data.altText},teachingBubble:{isVisible:$component.isLeftNavVisible,campaign:$data.teachingBubble},hasFocus:isFocused,automation:$data.automationId,css:{\'LeftNav-is-active\':isActive,\'LeftNav-is-focused\':isFocused},click:$parent.onClick.bind($parent),automationType:\'Link\'">\x3c!--ko if:$data.icon--\x3e<i class="LeftNav-sublinks-icon ms-Icon" data-bind="class:$data.icon.getClass()">\x3c!--ko if:$data.iconOverlayImageUrl--\x3e<img onerror="this.style.display = \'none\';" data-bind="attr:{src:$data.iconOverlayImageUrl}">\x3c!--/ko--\x3e</i>\x3c!--/ko--\x3e<span class="LeftNav-fadient"><span class="LeftNav-linkText" data-bind="text:$data.text,attr:{id:$data.domId?$data.domId:\'\',title:$data.text}"></span></span></a>\x3c!--/ko--\x3e'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/IndentedLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<a role=\"menuitem\" class=\"LeftNav-subLink LeftNav-subLinkIndent\" data-bind=\"attr:{href:url,target:$data.openInNewTab&&$data.openInNewTab()?'_blank':null,tabindex:isFocused()?0:-1,'aria-current':isActive()?'page':undefined,'aria-label':$data.altText},hasFocus:isFocused,automation:$data.automationId,css:{'LeftNav-is-active':isActive,'LeftNav-is-focused':isFocused},click:$component.onClick.bind($component),automationType:'Link'\"><span><span class=\"LeftNav-linkText\" data-bind=\"text:$data.text\"></span></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Load.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-loadingTemplate">\x3c!--ko component:{name:$component.loadingSpinnerTagName,params:{loadingText:text}}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Text.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-subLinksAsText" data-bind="html:$data.text"></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/WarningText.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-subLinkWarningText" data-bind="html:$data.text,css:{\'LeftNav-subLinkWarningText--winApp\':!!$component.isLeftNavForWinApp}"></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/GroupLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<a role="menuitem" tabindex="-1" class="od-siteItem-SitePin LeftNav-groupLink ms-fontWeight-regular" data-bind="attr:{href:$data.url,target:$data.openInNewTab&&$data.openInNewTab()?\'_blank\':null,\'aria-current\':isActive()?\'page\':undefined,title:$data.text},hasFocus:isFocused,css:{\'LeftNav-is-active\':isActive,\'LeftNav-is-focused\':$data.isFocused,\'ms-font-s\':!$component.isFluentFlight,\'ms-fontSize-14\':$component.isFluentFlight},click:$component.onClick.bind($component),automationType:\'Link\'"><span class="od-leftNav-groupLink-container"><span class="LeftNav-fadient"><span class="LeftNav-linkText"><span class="od-LeftNav-sublink-siteIcon" data-bind="component:{name:\'ms-site-icon\',params:{iconUrl:$data.iconOverlayImageUrl,icon:$data.icon,acronym:$data.acronym,color:$data.color}}"></span><span data-bind="text:$data.text"></span></span></span>\x3c!--ko if:$data.allowPinning&&$component.isPinningSiteEnabled--\x3e<span class="od-LeftNav-sublink-sitePin" data-bind="control:$component.getSitePinControl($data)"></span>\x3c!--/ko--\x3e</span></a>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/More.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-subLinksAsText"><a href="#" data-bind="click:$parent.toggleMore.bind($parent),attr:{tabindex:isFocused()?0:-1,\'aria-selected\':isActive},text:$data.text,title:$data.text"></a></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/NotificationLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<a class=\"LeftNav-notificationLink\" data-bind=\"attr:{href:$data.url,target:$data.openInNewTab&&$data.openInNewTab()?'_blank':null,tabindex:$component.isLeftNavVisible()?0:-1,'aria-label':$data.altText},visible:!$data.show||$data.show(),click:$component.onClick.bind($component),automation:$data.automationId,automationType:'Link',css:{'LeftNav-notificationLink--winApp':!!$component.isLeftNavForWinApp}\"><span class=\"LeftNav-linkText\" data-bind=\"text:$data.text\"></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/BasicLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<a class=\"LeftNav-basicLink\" role=\"menuitem\" data-bind=\"attr:{href:url,target:$data.openInNewTab&&$data.openInNewTab()?'_blank':'',tabindex:$data.isFocused()?0:-1,'aria-current':isActive()?'page':undefined},css:{'LeftNav-is-active':isActive,'LeftNav-is-focused':isFocused},hasFocus:isFocused,automation:$data.automationId,click:$component.onClick.bind($component)\"><span data-bind=\"text:text\"></span><span class=\"LeftNav-bubbleAnchor\" data-bind=\"teachingBubble:{isVisible:$component.isLeftNavVisible,campaign:$data.teachingBubble}\"></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Component.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="LeftNav-subLinksAsComponent" data-bind="component:$data.component"></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","../LeftNav.resx","./templates/LeftNavTemplates","../../../bindings/teachingBubble/TeachingBubbleBinding","../../../models/teachingBubble/TeachingBubbleCampaigns","../../loadingSpinner/LoadingSpinner","../../../providers/teachingBubble/TeachingBubbleProvider","../../fluentStyling/FluentStyling.key","../../../utilities/features/Features","../../../bindings/component/ControlBinding","../../sitePin/odb/SitePin.key","../../../resources/LoggingResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.loadingSpinnerTagName=l.default.tagName;r.addBindingHandlers({teachingBubble:a.default,control:d.default});var i=t.linkGroup,s=t.isLeftNavVisible,o=void 0===s?r.createObservable(!0):s,u=t.isSublinkMenu,f=void 0===u||u;r._engagement=n.engagement;r._teachingBubbleProvider=n.teachingBubbleProvider;r._rumOneHelper=n.rumOneHelper;r.leftNavItems=i;r.isLeftNavVisible=o;r.isFluentFlight=n.useFluentStyling;r.isLeftNavForWinApp=p.isFeatureEnabled(p.UseLeftNavInODApp);r._linksTruncatedWithMore=r.createObservable(!1);void 0!==r.leftNavItems.hideLinksAfterFoldAfter&&r._linksTruncatedWithMore(!0);r.leftNavRenderedItems=r.createPureComputed(r._computeLeftNavRenderedItems);r.shouldMoreBeRendered=r.createPureComputed(function(){return r._linksTruncatedWithMore()&&!!r.leftNavItems.hideLinksAfterFoldAfter&&r.leftNavItems.hideLinksAfterFoldAfter()<r.leftNavItems.links().length});r.sublinkRole=f?"menu":void 0;r.isPinningSiteEnabled=r.createObservable(p.isFeatureEnabled(p.ODBLeftNavPins));r.addDisposable(r.leftNavItems.links.filter(function(e){return!!e.action&&e.action.isAvailable()}));return r}t.prototype.onClick=function(e,t){this._rumOneHelper&&this._rumOneHelper.logOnePageNavigationStart();e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:n.__assign(n.__assign({},e.engagementExtraData||{}),{action:s.capitalizeFirstLetter(t.type)})});var r=this._teachingBubbleProvider,i=r&&r.currentBubble.peek();if(i){var o=i.campaign,u=e.teachingBubble,a=u&&u.campaignGuid===o.campaignGuid,l=this._isLinkSharedLibrary(e)&&o.campaignGuid===f.ODB_SHARED_LIBRARIES.campaignGuid;if(o&&(l||a)){r.clearCurrentBubble();r.markBubbleAsSeen(o)}}e.isFocused(!1);if(e.action){e.action.isAvailable.peek()&&e.action.execute(t);return!1}return!0};t.prototype.toggleMore=function(){this._linksTruncatedWithMore(!1)};t.prototype.renderMode=function(e){var t=e.renderAs;switch(void 0===t?0:t){case 1:return u.TEXT_TEMPLATE;case 2:return u.WARNING_TEXT_TEMPLATE;case 3:return u.LOAD_TEMPLATE;case 4:return u.GROUPLINK_TEMPLATE;case 5:return u.MORE_TEMPLATE;case 6:return u.NOTIFICATION_TEMPLATE;case 7:return u.INDENTED_TEMPLATE;case 8:return u.BASIC_LINK_TEMPLATE;case 9:return u.BUTTON_TEMPLATE;case 10:return u.COMPONENT_TEMPLATE;default:case 0:return u.LINK_TEMPLATE}};t.prototype.getSitePinControl=function(e){return d.toSpecification(v.resourceKey,{engagementName:"LeftNav",onPinClick:this.onPinClick.bind(this),siteItemReference:e.siteItemReference,pinOrder:e.pinOrder&&e.pinOrder(),keysToInvalidate:e.keysToInvalidateOnPinning})};t.prototype.onPinClick=function(e,t){if(this.leftNavItems&&this.leftNavItems.links){var n=this.leftNavItems.links.peek(),r=!1;e&&n.forEach(function(n){if(n&&n.siteItemReference&&n.siteItemReference.SiteId===e.SiteId&&n.pinOrder){r=!0;n.pinOrder(t)}});r&&this.leftNavItems.links(n)}};t.prototype._isLinkSharedLibrary=function(e){return!(!e.engagementName||["SuggestedSite","MoreSites","Sites.CreateGroup"].indexOf(e.engagementName)<0)};t.prototype._computeLeftNavRenderedItems=function(){var e=this.leftNavItems.hideLinksAfterFoldAfter,t=this._sortLeftNavItems(this.leftNavItems.links());this._addExtraEngagementInfo(t);if(this._linksTruncatedWithMore()&&void 0!==e&&e()<t.length){var n=t.slice(0,this.leftNavItems.hideLinksAfterFoldAfter());n.push({text:o.default.moreLabel,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:5});return n}return t};t.prototype._addExtraEngagementInfo=function(e){e&&e.length>0&&e.forEach(function(e,t){e.engagementExtraData=n.__assign(n.__assign({},e.engagementExtraData),{position:t,isPinned:!(!e.pinOrder||!e.pinOrder.peek()),TargetSiteId:e&&e.siteItemReference&&e.siteItemReference.SiteId,TargetWebId:e&&e.siteItemReference&&e.siteItemReference.WebId})})};t.prototype._sortLeftNavItems=function(e){return e&&e.length>0?e.sort(function(e,t){return t.pinOrder&&t.pinOrder.peek()||e.pinOrder&&e.pinOrder.peek()?e.pinOrder&&e.pinOrder.peek()?t.pinOrder&&t.pinOrder.peek()?t.pinOrder.peek()-e.pinOrder.peek():-1:1:t.weight||e.weight?e.weight?t.weight?t.weight-e.weight:-1:1:0}):e};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{teachingBubbleProvider:c.resourceKey.optional,engagement:i.resourceKey,useFluentStyling:h.resourceKey,rumOneHelper:m.rumOneHelper.optional});return t})(r.default);t.default=g});
define("odsp-next/controls/leftNav/leftNavSublink/templates/LeftNavTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LINK_TEMPLATE="ms-left-nav-link";t.BUTTON_TEMPLATE="ms-left-nav-button";t.LOAD_TEMPLATE="ms-left-nav-load";t.TEXT_TEMPLATE="ms-left-nav-text";t.WARNING_TEXT_TEMPLATE="ms-left-nav-warning-text";t.GROUPLINK_TEMPLATE="ms-left-nav-groupLink";t.MORE_TEMPLATE="ms-left-nav-more";t.NOTIFICATION_TEMPLATE="ms-left-nav-notificationLink";t.INDENTED_TEMPLATE="ms-left-nav-indentedlink";t.BASIC_LINK_TEMPLATE="ms-left-nav-basicLink";t.COMPONENT_TEMPLATE="ms-left-nav-component"});
define("odsp-next/controls/sitePin/odb/SitePin.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./SitePin"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define('ODCOneDrive_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".LanguagePicker select{width:100%}"},{"rawString":".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"},{"rawString":".od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-ItemNameEditor-input--error{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"!important}"},{"rawString":".InfoPane-sharing{margin-top:8px}.SharingSection-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:8px 0;font-size:12px}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:170px;padding:0}.SharingSection-addPeople{font-size:17px;font-weight:300;min-height:50px;margin-top:10px}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .SharingSection-addPeople-icon{margin-right:10px}[dir=rtl] .SharingSection-addPeople-icon{margin-left:10px}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.SharingSection-linksBox a{display:inline-block;margin-top:5px}.SharingSection-link,.od-PermissionsPanel-link{padding-top:8px}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:12px}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionsPanel-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionPile-accessibleLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-PermissionsPanel-stopSharing{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:15px;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}.od-PermissionsPanel-entity{padding:8px 0;font-size:12px}.od-PermissionsPanel-entity .od-Persona{white-space:nowrap}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:17px;font-weight:300;min-height:50px;padding-bottom:10px}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:10px}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:10px}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:5px}.od-PermissionsPanel-link{padding-top:8px}.od-PermissionsPanel-container{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:21px;font-weight:100}.isFluent .od-PermissionsPanel-head{font-size:20px;font-weight:600;margin-bottom:15px}.od-PermissionsPanel-fileName{font-size:14px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:25px}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:40px}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:40px}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:3px;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:'';display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:'\\E76B'}.od-PermissionsPanel-titleBar{padding-top:15px;padding-bottom:10px;border-bottom:solid 1px "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:40px}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:40px}.od-PermissionsPanel-content{padding-top:15px;width:300px;height:calc(100% - 110px)}[dir=ltr] .od-PermissionsPanel-content{padding-left:40px}[dir=rtl] .od-PermissionsPanel-content{padding-right:40px}.od-PermissionsPanel-linksBox{padding-bottom:10px}.od-SharingSection-PermissionsPile{width:320px;padding:16px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-sizing:border-box;margin-bottom:16px}.isFluent .od-SharingSection-PermissionsPile{padding:16px 24px}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:10px;cursor:default}.isFluent .od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:0}.od-SharingSection-PermissionsPile-personas{margin-bottom:4px}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:32px;height:32px;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:4px}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:4px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:1px solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:15px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-HasAceessControl{text-align:center;padding:6px 0;width:128px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Pointer{cursor:auto}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";height:100%;border-radius:50%;position:relative;font-size:17px}.od-SharingSection-PermissionsPile-numberText{font-size:10px;font-weight:600;padding-top:16px;text-align:center;pointer-events:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SharingSection-PermissionsPile-personaBorder .ms-Icon{font-size:16px}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:100%;pointer-events:none;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:4px;transform:translateX(-50%);color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";font-size:12px;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:10px;font-weight:600;top:50%;transform:translate(-50%,-50%);color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:4px;padding:2px}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";vertical-align:top;padding:3px}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-ShowPermissions-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";box-shadow:inset 0 1px 0 0 "},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";box-shadow:inset 0 1px 0 0 "},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":";margin:2px -8px}"},{"rawString":".od-SuggestedFiles-titleBar{padding-bottom:8px}.od-SuggestedFiles-head{font-size:20px;font-weight:600}.od-SuggestedFiles-description{padding:4px 0 12px;font-size:14px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}"},{"rawString":".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"},{"rawString":"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}"},{"rawString":".od-DragAndDropHint-box{font-size:14px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"},{"rawString":".c_ic_hide{display:none}.c_clr{clear:both}.NotificationBase .t_sela,.NotificationBase.t_cbr{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.NotificationBase button,.NotificationBase input[type=button]{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";cursor:pointer;display:inline-block;height:30px;min-width:80px;outline:0;padding:4px 20px 6px 20px}.NotificationBase textarea{padding:4px 8px;border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.NotificationBase input{border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.NotificationBase.UI_Dialog_ZoomTest{visibility:hidden}.NotificationBase.UI_Dialog_BG{height:100%;width:100%}.NotificationBase.ModalDialog{height:380px;width:860px;margin:auto}.NotificationBase.ModalDialog.UI_Dialog_BG{background-color:rgba(255,255,255,.5)!important;top:0;height:100%;width:100%}.NotificationBase.ModalDialog .OuterContainer{background-color:transparent}.NotificationBase.ModalDialog .InnerContainer{box-shadow:0 0 5px 0 "},{"theme":"blackTranslucent40","defaultValue":"rgba(0,0,0,.4)"},{"rawString":";background-color:#fff;left:0!important;right:0!important;position:absolute!important;margin:auto!important}#sidebar{top:50px!important;z-index:298}#sidebar h1{font-size:17px;font-weight:300}#sidebar a.ContactTile,#sidebar a.FavoritesItem{overflow:visible}"},{"rawString":".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"},{"rawString":".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"},{"rawString":".od-SiteIcon{position:absolute;top:0;left:0;bottom:0;right:0;display:block;overflow:hidden;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SiteIcon--person{border-radius:50%}.isFluent .od-SiteIcon{border-radius:2px}.od-SiteIcon-icon{position:absolute;top:0;left:0;right:0;bottom:0}.od-SiteIcon-icon .od-IconGlyph.ms-Icon{position:absolute;margin:auto;top:0;left:0;bottom:0;right:0;width:100%}.od-SiteIcon-acronym{position:absolute;top:0;left:0;bottom:0;right:0;height:18px;margin:auto;text-align:center;white-space:nowrap;font-weight:100;font-size:13px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SiteIcon-image{position:absolute;top:0;left:0;right:0;bottom:0;visibility:hidden}.od-SiteIcon--site .od-SiteIcon-image:after{content:\"\";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.od-SiteIcon--hasImage .od-SiteIcon-image{visibility:inherit}"},{"rawString":".od-LeftNavExpander-commandBar{position:relative}.od-LeftNavExpander-commandBar:after{content:\"\";display:block;width:0;position:absolute;top:0;bottom:0;margin-top:6px;margin-bottom:6px}[dir=ltr] .od-LeftNavExpander-commandBar:after{right:8px}[dir=rtl] .od-LeftNavExpander-commandBar:after{left:8px}[dir=ltr] .od-LeftNavExpander-commandBar .CommandBarItem:last-child{margin-right:0}[dir=rtl] .od-LeftNavExpander-commandBar .CommandBarItem:last-child{margin-left:0}.od-LeftNavExpander-commandBar .CommandBar-sideArea{display:none}.lg .od-LeftNavExpander-commandBar .ms-CommandBar,.md .od-LeftNavExpander-commandBar .ms-CommandBar,.sm .od-LeftNavExpander-commandBar .ms-CommandBar{padding:0}.od-LeftNavExpander-commandBar .ms-CommandBar .ms-Button--commandBar{padding:0 12px}"},{"rawString":".LeftNav-expandButton.ms-Icon{position:absolute;height:40px;text-align:center;transform:rotate(0);transform-origin:50% 50%;line-height:32px;height:32px}[dir=ltr] .LeftNav-expandButton.ms-Icon{left:17px}[dir=rtl] .LeftNav-expandButton.ms-Icon{right:17px}.isFluent .LeftNav-expandButton.ms-Icon{line-height:36px;height:36px}.lg .LeftNav-expandButton.ms-Icon,.md .LeftNav-expandButton.ms-Icon,.sm .LeftNav-expandButton.ms-Icon{height:40px;line-height:40px}.LeftNav-expandButton.is-link.ms-Icon{cursor:default}.LeftNav-linkGroup.is-expanded .LeftNav-expandButton{transform:rotate(-180deg)}.LeftNav-hamburger .ms-CommandBar{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .LeftNav-hamburger .ms-CommandBar{border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.LeftNav-hamburger .ms-Button--commandBar,.LeftNav-hamburger .ms-CommandBar{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.LeftNav-hamburger .ms-Button--commandBar:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.LeftNav-hamburger .ms-Button--commandBar:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.isFluent .LeftNav-hamburger .ms-Button--commandBar,.isFluent .LeftNav-hamburger .ms-CommandBar{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .LeftNav-hamburger .ms-Button--commandBar:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.isFluent .LeftNav-hamburger .ms-Button--commandBar:active{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.isFluent .LeftNav-hamburger .ms-Button--commandBar:focus{box-shadow:none}.xlg .LeftNav-linkArea,.xxlg .LeftNav-linkArea,.xxxlg .LeftNav-linkArea,.xxxxlg .LeftNav-linkArea{padding-top:4px}:not(.od-fluentCustomizationDisabled).isFluent.xlg .LeftNav-linkArea{padding-top:8px}:not(.od-fluentCustomizationDisabled).isFluent.xxlg .LeftNav-linkArea{padding-top:8px}:not(.od-fluentCustomizationDisabled).isFluent.xxxlg .LeftNav-linkArea{padding-top:8px}:not(.od-fluentCustomizationDisabled).isFluent.xxxxlg .LeftNav-linkArea{padding-top:8px}.LeftNav-linkGroupContainer{position:relative;padding:8px 0 0 0}.LeftNav-linkGroupContainer--winApp{top:0!important;padding:0!important}.LeftNav-linkGroupContainer .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-linkGroupContainer .LeftNav-linkGroup-addTeamsiteLink{top:0;width:208px}.isFluent .LeftNav-linkGroupContainer .LeftNav-linkGroup-addTeamsiteLink{width:228px}.LeftNav-linkGroupContainer:first-child{padding:24px 0 0 0}.isFluent .LeftNav-linkGroupContainer:first-child{padding:0}.LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:24px}.isFluent .LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:8px}.xlg .suiteNav-search-styling .LeftNav-linkArea,.xxlg .suiteNav-search-styling .LeftNav-linkArea,.xxxlg .suiteNav-search-styling .LeftNav-linkArea,.xxxxlg .suiteNav-search-styling .LeftNav-linkArea{padding-top:0}:not(.od-fluentCustomizationDisabled).isFluent.xlg .suiteNav-search-styling .LeftNav-linkArea{padding-top:0}:not(.od-fluentCustomizationDisabled).isFluent.xxlg .suiteNav-search-styling .LeftNav-linkArea{padding-top:0}:not(.od-fluentCustomizationDisabled).isFluent.xxxlg .suiteNav-search-styling .LeftNav-linkArea{padding-top:0}:not(.od-fluentCustomizationDisabled).isFluent.xxxxlg .suiteNav-search-styling .LeftNav-linkArea{padding-top:0}.suiteNav-search-styling .LeftNav-linkGroupContainer:first-child{padding:0}.suiteNav-search-styling .LeftNav-linkGroupContainer:first-child .LeftNav-linkGroupHeader{font-size:14px;height:40px;line-height:40px}.isFluent .suiteNav-search-styling .LeftNav-linkGroupContainer:first-child .LeftNav-linkGroupHeader{height:44px;line-height:44px}.LeftNav-subLinksClip{overflow:hidden}.LeftNav-subLinks{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.LeftNav-subLinks:focus{outline:0}a.LeftNav-link{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}a.LeftNav-subLink{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.isFluent .LeftNav-linkText{position:relative;top:-1px}.isFluent .LeftNav-linkText:hover{text-decoration:none}.LeftNav-linkGroupHeader,a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{margin:0;display:block;padding:0 16px 0 16px;border:none;background:0 0;text-decoration:none;white-space:nowrap;overflow:hidden;position:relative;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html[dir=rtl] .LeftNav-linkGroupHeader,html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{padding:0 16px 0 16px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{height:32px;line-height:32px}.isFluent a.LeftNav-groupLink,.isFluent a.LeftNav-link,.isFluent a.LeftNav-subLink{height:36px;line-height:36px}.lg a.LeftNav-groupLink,.lg a.LeftNav-link,.lg a.LeftNav-subLink,.md a.LeftNav-groupLink,.md a.LeftNav-link,.md a.LeftNav-subLink,.sm a.LeftNav-groupLink,.sm a.LeftNav-link,.sm a.LeftNav-subLink{height:40px;line-height:40px}[dir=ltr] .LeftNav-linkGroupHeader--hasIcon{padding-left:56px}[dir=rtl] .LeftNav-linkGroupHeader--hasIcon{padding-right:56px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:32px;text-overflow:ellipsis;overflow:hidden}.isFluent .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:36px}.lg .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:40px}.LeftNav-linkGroupHeader--hasSubText{padding-top:4px;padding-bottom:8px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px;font-size:14px}.lg .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderSubText{line-height:15px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{display:block;position:absolute;width:32px;height:32px}[dir=ltr] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-left:-40px}[dir=rtl] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-right:-40px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderSubText{display:block;font-size:12px;text-overflow:ellipsis;overflow:hidden}.od-focus--enabled a.LeftNav-groupLink.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-link.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-subLink.LeftNav-is-focused:after{content:'';box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;width:100%;position:absolute;height:100%;left:0;top:0}.od-focus--enabled .LeftNav-linkGroupHeader:focus{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}a.LeftNav-groupLink:hover,a.LeftNav-link:hover,a.LeftNav-subLink:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.LeftNav-linkGroupHeader{cursor:default;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";outline:0}.isFluent .LeftNav-linkGroupHeader{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir=ltr] .LeftNav-linkGroupHeader--hasPlus{margin-right:20px}[dir=rtl] .LeftNav-linkGroupHeader--hasPlus{margin-left:20px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{cursor:pointer}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}a.LeftNav-groupLink:hover:not(.LeftNav-is-active),a.LeftNav-link:hover:not(.LeftNav-is-active),a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.isFluent a.LeftNav-groupLink:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-link:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}@media screen and (-ms-high-contrast:active){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":" inset}}@media screen and (-ms-high-contrast:black-on-white){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{"theme":"black","defaultValue":"#000000"},{"rawString":" inset}}a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText{transform:scale(.95);display:inline-block}a.LeftNav-groupLink.LeftNav-is-active:hover,a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active:hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #37006e}}a.LeftNav-groupLink.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active{font-weight:400;color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";padding-left:14px}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:2px solid "},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:2px solid "},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.isFluent a.LeftNav-groupLink.LeftNav-is-active,.isFluent a.LeftNav-link.LeftNav-is-active,.isFluent a.LeftNav-subLink.LeftNav-is-active{font-weight:600;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";padding-left:16px}html[dir=ltr] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-left:0 solid transparent}html[dir=rtl] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-right:0 solid transparent}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #37006e}}a.LeftNav-subLink{font-weight:100;font-size:17px;text-overflow:ellipsis}.isFluent a.LeftNav-subLink{font-weight:400;font-size:14px}[dir=ltr] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-left:56px}[dir=rtl] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-right:56px}.LeftNav-loadingTemplate,.LeftNav-subLinksAsText{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding:8px 16px 8px 16px}html[dir=rtl] .LeftNav-loadingTemplate,html[dir=rtl] .LeftNav-subLinksAsText{padding:8px 16px 8px 16px}.lg .LeftNav-loadingTemplate,.lg .LeftNav-subLinksAsText,.md .LeftNav-loadingTemplate,.md .LeftNav-subLinksAsText,.sm .LeftNav-loadingTemplate,.sm .LeftNav-subLinksAsText{font-size:14px}.xlg .LeftNav-loadingTemplate,.xlg .LeftNav-subLinksAsText,.xxlg .LeftNav-loadingTemplate,.xxlg .LeftNav-subLinksAsText,.xxxlg .LeftNav-loadingTemplate,.xxxlg .LeftNav-subLinksAsText,.xxxxlg .LeftNav-loadingTemplate,.xxxxlg .LeftNav-subLinksAsText{font-size:12px}a.LeftNav-link.is-defaultCursor:hover{cursor:default}.LeftNav-link .ms-Icon--ChevronDown:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.LeftNav-linkGroup-plusWrapper{cursor:pointer;margin:auto;position:absolute;top:0;width:30px;height:32px;font-size:14px;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}[dir=ltr] .LeftNav-linkGroup-plusWrapper{right:8px}[dir=rtl] .LeftNav-linkGroup-plusWrapper{left:8px}.isFluent .LeftNav-linkGroup-plusWrapper{height:36px;width:36px;background:0 0}.LeftNav-linkGroup-plusWrapper:hover{background:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.isFluent .LeftNav-linkGroup-plusWrapper:hover{background:0 0}.LeftNav-linkGroup-plusWrapper:active{transform:scale(.95)}.LeftNav-linkGroup-plus{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";width:14px;height:14px;margin:auto;position:absolute;top:0;bottom:0;right:0;left:0}.isFluent .LeftNav-linkGroup-plus:hover{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.LeftNav-sublinks-icon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .LeftNav-sublinks-icon{margin-right:10px}[dir=rtl] .LeftNav-sublinks-icon{margin-left:10px}.isFluent .LeftNav-sublinks-icon{font-size:16px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";vertical-align:top}[dir=ltr] .isFluent .LeftNav-sublinks-icon{margin-right:16px}[dir=rtl] .isFluent .LeftNav-sublinks-icon{margin-left:16px}.LeftNav-sublinks-portrait.has-iconOverlayImage{background-color:transparent}.LeftNav-sublinks-portrait{overflow:hidden;width:28px;height:28px;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";vertical-align:top;font-size:28px;margin-top:2px;position:relative;display:inline-block}[dir=ltr] .LeftNav-sublinks-portrait{margin-right:8px}[dir=rtl] .LeftNav-sublinks-portrait{margin-left:8px}.lg .LeftNav-sublinks-portrait,.md .LeftNav-sublinks-portrait,.sm .LeftNav-sublinks-portrait{height:28px;width:28px;margin-top:6px}.LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:24px;display:inline-block;margin-top:7px;vertical-align:top;width:39px}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-6px}.lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,.md .LeftNav-sublinks-portrait.ms-Icon--Group:before,.sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:28px;margin-top:8px;vertical-align:top;width:46px}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-7px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-7px}.LeftNav-sublinks-portrait img{max-width:28px;max-height:28px;position:absolute;top:0}[dir=ltr] .LeftNav-sublinks-portrait img{left:0}[dir=rtl] .LeftNav-sublinks-portrait img{right:0}.lg .LeftNav-sublinks-portrait img,.md .LeftNav-sublinks-portrait img,.sm .LeftNav-sublinks-portrait img{width:28px;height:28px}.od-LeftNav-sublink-siteIcon{position:relative;display:inline-block;margin-top:2px;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-LeftNav-sublink-siteIcon{margin-right:4px}[dir=rtl] .od-LeftNav-sublink-siteIcon{margin-left:4px}.isFluent .od-LeftNav-sublink-siteIcon{width:24px;height:24px;margin-top:6px}.lg .od-LeftNav-sublink-siteIcon,.md .od-LeftNav-sublink-siteIcon,.sm .od-LeftNav-sublink-siteIcon{margin-top:4px;width:28px;height:28px}.od-Browser--edge .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:36px}.isFluent .od-Browser--edge .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:40px}.lg.od-Browser--edge .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:42px}.lg.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:43px}.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:32px}.isFluent .od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:40px}.isFluent .LeftNav-notifications{border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.LeftNav-notificationLink,.LeftNav-subLinkWarningText{position:relative;display:block;margin:0;padding:8px 20px;height:auto;text-decoration:none;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";font-size:12px;font-weight:400;line-height:14px}.isFluent .LeftNav-notificationLink,.isFluent .LeftNav-subLinkWarningText{font-size:14px;padding:8px 16px}.LeftNav-notificationLink.LeftNav-is-active,.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}@media screen and (-ms-high-contrast:active){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":" inset}}@media screen and (-ms-high-contrast:black-on-white){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{"theme":"black","defaultValue":"#000000"},{"rawString":" inset}}.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:"},{"theme":"alertBackground","defaultValue":"#deecf9"},{"rawString":"}.LeftNav-Button{display:block;height:auto;padding:4px 2px 6px;margin:8px 20px;width:calc(100% - 40px)}.LeftNav-Button.od-Button+.od-Button{margin:4px 20px}.LeftNav-notificationLink{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";font-weight:400}.LeftNav-notificationLink--winApp{display:none!important}.isFluent .LeftNav-notificationLink{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";font-size:12px}.LeftNav-subLinkWarningText{color:"},{"theme":"red","defaultValue":"#e81123"},{"rawString":";font-weight:700}.LeftNav-subLinkWarningText--winApp{display:none!important}.LeftNav-basicLink{display:block;margin:0;padding:8px 16px;position:relative;height:auto;color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";font-size:12px}.isFluent .LeftNav-basicLink{font-size:14px}html[dir=ltr] .isFluent .LeftNav-basicLink{padding-left:48px}html[dir=rtl] .isFluent .LeftNav-basicLink{padding-right:48px}.LeftNav-bubbleAnchor{position:absolute;top:0;bottom:0}[dir=ltr] .LeftNav-bubbleAnchor{right:0}[dir=rtl] .LeftNav-bubbleAnchor{left:0}.LeftNav-teamifyBanner{box-sizing:border-box;padding:20px}[dir=ltr] .LeftNav-linkGroup-addTeamsiteLink{right:0}[dir=rtl] .LeftNav-linkGroup-addTeamsiteLink{left:0}.od-leftNav-groupLink-container{display:flex}.od-leftNav-groupLink-container .LeftNav-fadient{flex-grow:10;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}html[dir=ltr] .od-LeftNav-sublink-sitePin{padding-left:10px}html[dir=rtl] .od-LeftNav-sublink-sitePin{padding-right:10px}"}]);});