define("odsp-next/bundles/OneDriveDeferred",["require","exports","../controls/FabricIconsDeferred"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("odsp-next/actions/restore/RestoreItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/item/ItemType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={1e3:!0,1012:!0},a=1,f=2,l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._fileSystemProvider=n.fileSystemProvider;r._context=t;r.registerActions({overwrite:r._onOverwrite,rename:r._onRename});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),i=t.input;n.name=i.name;n.iconName=i.iconName;n.type=r.OperationType.restoreItems;n.payloads={restoreItems:{item:i}};2===t.status&&t.error&&t.error.code in u&&i.type!==s.default.Folder&&n.actions.push(this._onOverwrite,this._onRename);return n};t.prototype.onStart=function(e){var t=this._context.items.map(function(e){return new r.Task(e.key,e)});e.update(t);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,retainAcls:this._context.retainAcls,items:t.map(function(e){return e.input})},e)};t.prototype._onRename=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:f},t)};t.prototype._onOverwrite=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:a},t)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{fileSystemProvider:i.resourceKey});return t})(r.default);t.default=l;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/dataSources/itemAnalytics/store/FileHoverCardStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","@ms/shared-react-item-hover-card/lib/index","../../../resources/SPOResourceKeys","../../base/odb/DataRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemAnalyticsDataSource:r.analytics,pageContext:s.pageContext,dataRequestorType:o.typeResourceKey},create:function(e){var t=new i.FileHoverCardStore({item:void 0},e);return{instance:t,disposable:t}}}})});
define("@ms/shared-react-item-hover-card/lib/index",["require","exports","tslib","./FileHoverCard","./itemsScopeFileHoverCard/HoverZone","./IFileHoverCardStore","./FileHoverCardStore","./AnalyticsActionBar/AnalyticsActionBar","./AnalyticsStats/AnalyticsStats","./AnalyticsActivityList/AnalyticsActivityList","./AnalyticsKeyPoints/AnalyticsKeyPointsEditor","./AnalyticsKeyPoints/AnalyticsKeyPoints","./FileHoverCardHelper","./AnalyticsKeyPoints/AnalyticsKeyPointsFeedback"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t)});
define("@ms/shared-react-item-hover-card/lib/FileHoverCard",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/HoverCard","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Styling","./IFileHoverCardStore","./AnalyticsActivityList/AnalyticsActivityList","./AnalyticsActionBar/AnalyticsActionBar","./AnalyticsStats/AnalyticsStats","./AnalyticsLifeCycle/AnalyticsLifeCycle","./AnalyticsKeyPoints/AnalyticsKeyPoints","./FileHoverCardHelper","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/string/StringHelper","./UserNameHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./ErrorBoundary","./RecommendedActions/RecommendedActions","./HoverCardLoggerHelper","./FileHoverCard.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";C=C.FileHoverCard_module_7;Object.defineProperty(t,"__esModule",{value:!0});t.CARD_DISMISS_DELAY=300;var k=(function(e){n.__extends(k,e);function k(t,n){var i=e.call(this,t,n)||this;i._hoverCardRenderQos=void 0;i._setHightAndAnalyticsResult=function(e){i.setState({itemAnalyticsResult:i._store.getItemAnalytics(e)})};i._onCardOpen=function(){T.default("FileHoverCard.CompactCardOpen",i.props.item);i._cardOpenTimeStamp=Date.now();i._compactCardElement||(i._hoverCardRenderQos=new E.Qos({name:"FileHoverCard.HoverCardRenderQos"}))};i._onCardClose=function(){i._expandedCardElement?T.default("FileHoverCard.Expanded.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):T.default("FileHoverCard.Compact.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp});i.props.item.appMap===w.wordType&&(i.state.itemAnalyticsResult&&i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)?T.default("FileHoverCard.KeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):T.default("FileHoverCard.NoKeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}))};i._getCardHeight=function(){var e=i._store.getItemAnalytics(i.props.item);if(e&&e.status===l.AnalyticsResultStatus.succeed&&e.data){if(i._shouldShowActivities(e))return 340;if(i._isKeyPointsAvailable(e.data))return 340;if(i._isLifecycleAvailable(e.data)&&e.data.lifeCycleStatus)return 70*e.data.lifeCycleStatus.length;if(e.data.isTrending)return 70}return 1};i._renderExpandedCard=function(){var e=i.state.itemAnalyticsResult;return!!e&&(i._isKeyPointsAvailable(e.data)||i._shouldShowActivities(e)||i._isLifecycleAvailable(e.data)||i._isRecommendedActionsAvailable(e))};i._hoverCardQosEnd=function(e){if(i._hoverCardRenderQos){e?i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Failure,extraData:e}):i.state.itemAnalyticsResult.status===l.AnalyticsResultStatus.succeed?i._compactCardElement||i._expandedCardElement?i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Success}):i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Failure}):i._hoverCardRenderQos.end({resultType:E.ResultTypeEnum.Success});i._hoverCardRenderQos=void 0}};i._onRenderCompactContent=function(){var e,t=i.props,n=t.itemTitle,s=t.actionBarItems,u=t.isViewCountClickable,a=t.onRenderFileTypeIcon,f=p.getFileHoverCardStrings(),l=i.state.itemAnalyticsResult,c=r.createElement("div",{className:o.css(C.fileHoverCardCompactCardTitle,(e={},e[C.titleNotExpanded]=!i._expandedCardElement,e)),id:"ms-FileHoverCard-title","aria-label":y.format(N.default.hoverCardTitle,n)},n),d=r.createElement("div",{className:C.fileHoverCardCompactCardTitleRegion},r.createElement("div",{className:C.fileHoverCardCompactCardFileIcon},a&&a()),c);return r.createElement("div",{ref:i._onCompactCardRef,className:o.css(C.fileHoverCardCompactCard,{isFluent:!0}),"aria-labelledby":"ms-FileHoverCard-title ms-FileHoverCard-compactCard--latestActivity"},d,r.createElement(h.AnalyticsActionBar,{analyticsStats:{itemAnalytics:l&&l.data,onClick:i._onView,onLikeClick:i._onLikeClick,pageUrl:i.props.pageUrl,disableViewerCount:u,status:l&&l.status,isNotSupported:!1},items:s||[],showActionBar:s&&s.length>0,isLink:u,farItems:[{key:"details",title:f.details,name:f.details,ariaLabel:f.details,onClick:i._onDetails}]}))};i._onRenderExpandedContent=function(){var e=i.state.itemAnalyticsResult,t=i.state.itemAnalyticsResult,n=t.data,s=t.skipToken,u=i._isKeyPointsAvailable(n),a=i._shouldShowActivities(e),f=i._isRecommendedActionsAvailable(e);return r.createElement("div",{className:o.css(C.fileHoverCardExpandedCard,{isFluent:!0}),ref:i._onExpandedCardRef},!!(n&&n.lifeCycleStatus&&i._isLifecycleAvailable(n))&&n.lifeCycleStatus.slice(0,2).map(function(e){return i._getAnalyticsLifeCycle(e)}),(u||a||f)&&r.createElement("div",{className:C.fileHoverCardExpandedCardScrollableSection},u&&n&&n.keyPointsData&&r.createElement(v.AnalyticsKeyPoints,{item:i.props.item,keyPointsData:n.keyPointsData,onKeyPointsClick:i.props.onKeyPointsClick,onSendFeedbackClick:i.props.onSendFeedbackClick}),f&&e.actions&&r.createElement(x.RecommendedActions,{ref:i._onRecommendedActionsRef,item:i.props.item,actions:e.actions,loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail,pageUrl:i.props.pageUrl,onShareWith:i.props.onShareWith,onDismiss:i._onDismiss,onRenderShareWithPeople:i.props.onRenderShareWithPeople}),a&&n&&r.createElement("div",{className:C.fileHoverCardActivitiesSection},r.createElement(c.AnalyticsActivityList,{itemAnalytics:n,moreActivities:!!s,onLoadMoreActivities:function(){return i._store.fetchItemAnalytics(i.props.item,s)},loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail}))))};i._onDismiss=function(e,t){var n=i.props,r=n.item,s=n.itemTitle,o=n.uniqueId;i._store.dismissRecommendedAction(r,s,e,o,t)};i._shouldShowActivities=function(e){var t=e&&e.data&&e.data.activities,n=i.props,r=n.isViewCountClickable,s=n.loginUserEmail,o=n.userEmail;return Boolean(r&&t&&(t.length>1||1===t.length&&!b.isCurrentLoginUser(t[0].actor.user.email,s,o)))};i._onCompactCardRef=function(e){if(e){i._compactCardElement=e;i._store.fetchItemAnalytics(i.props.item)}};i._onExpandedCardRef=function(e){if(e){i._expandedCardElement=e;T.default("FileHoverCard.ExpandedCardOpen",i.props.item,{time:Date.now()-i._cardOpenTimeStamp})}};i._onRecommendedActionsRef=function(e){if(e){var t=i.state.itemAnalyticsResult.actions;T.default("FileHoverCard.RecommendedActions.Render",i.props.item,{activityType:t&&t.recommendedActions&&t.recommendedActions.length>0?"HighActivities":"LowActivities"})}};i._onView=function(e){g.Engagement.logData({name:"FileHoverCard.ViewCountClick"});i.props.onView(e,i.props);e.stopPropagation();e.preventDefault()};i._onLikeClick=function(){g.Engagement.logData({name:"FileHoverCard.LikeClick"})};i._onDetails=function(e){if(e){g.Engagement.logData({name:"FileHoverCard.SeeDetailsClick"});i.props.onDetails(e,i.props);e.stopPropagation();e.preventDefault()}};i._cleanCachedItem=function(){i._store.cleanCachedItem(i.props.item)};i._updateExpandedHeight=function(){var e=i._compactCardElement.clientHeight+i._expandedCardElement.clientHeight,t=i.state.itemAnalyticsResult&&(i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)||i._shouldShowActivities(i.state.itemAnalyticsResult));e<346&&t&&i.state.expandedCardHeight!==346-i._compactCardElement.clientHeight?i.setState({expandedCardHeight:346-i._compactCardElement.clientHeight}):(e>346&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight||e<346&&!t&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight)&&i.setState({expandedCardHeight:i._expandedCardElement.clientHeight})};i._store=n.fileHoverCardStore;i._cardOpenTimeStamp=0;i.state={itemAnalyticsResult:i._store.getItemAnalytics(i.props.item),expandedCardHeight:i._getCardHeight(),compactCardHeight:131};return i}k.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this._setHightAndAnalyticsResult(e.item)};k.prototype.componentDidUpdate=function(){this._expandedCardElement&&this._expandedCardElement.clientHeight&&this._updateExpandedHeight();this._compactCardElement&&0!==this._compactCardElement.clientHeight&&this.state.compactCardHeight!==this._compactCardElement.clientHeight&&this.setState({compactCardHeight:this._compactCardElement.clientHeight});this.state.itemAnalyticsResult&&this._hoverCardQosEnd()};k.prototype.componentDidMount=function(){var e=this,t=this.props.item,n=this._store;this._storeListener=n.addListener(function(){e._setHightAndAnalyticsResult(t)},t)};k.prototype.componentWillUnmount=function(){this._store.removeListener(this._storeListener,this.props.item);this._store.cleanCachedItem(this.props.item)};k.prototype.render=function(){var e=this.props,t=e.responsiveMode,i=e.cardDismissDelay,o=e.directionalHint,a=e.gapSpace,l=e.target,c=e.children,h=this.state,p=h.expandedCardHeight,d=h.compactCardHeight,v={expandedCardScroll:C.fileHoverCardExpandedCardHostScroll},m=n.__assign({root:{boxShadow:f.getTheme().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},v),g={onRenderCompactCard:this._onRenderCompactContent,onRenderExpandedCard:this._renderExpandedCard()?this._onRenderExpandedContent:void 0,compactCardHeight:d,expandedCardHeight:p,directionalHint:o,directionalHintFixed:!1,gapSpace:a,styles:m};return t&&t>u.ResponsiveMode.medium?r.createElement(S.ErrorBoundary,{qosEvent:this._hoverCardQosEnd},r.createElement(s.HoverCard,{expandingCardProps:g,expandedCardOpenDelay:500,cardDismissDelay:i,target:l,onCardVisible:this._onCardOpen,onCardHide:this._onCardClose,trapFocus:!0})):r.createElement("div",null," ",c," ")};k.prototype._isKeyPointsAvailable=function(e){var t=e&&e.keyPointsData,n=Boolean(t&&t.keyPoints&&t.keyPoints.length>0),r=Boolean(t&&t.readTime&&t.readTime.minutes);return n||r};k.prototype._isLifecycleAvailable=function(e){var t=e&&e.lifeCycleStatus;return!!(t&&t.length>0)};k.prototype._isRecommendedActionsAvailable=function(e){return Boolean(e&&e.actions)&&m.isRecommendedActionsSupported(this.props.item.appMap,this.props.item.extension)};k.prototype._getAnalyticsLifeCycle=function(e){return r.createElement(d.AnalyticsLifeCycle,{key:e.createdRelativeTime,lifeCycleStatus:e,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onViewPolicyTip:this.props.onViewPolicyTip,onAddMetadataNow:this.props.onAddMetadataNow,onCheckIn:this.props.onCheckIn,onDiscardCheckOut:this.props.onDiscardCheckOut,cleanCachedItem:this._cleanCachedItem})};k.contextTypes={fileHoverCardStore:i.object.isRequired};k.defaultProps={directionalHint:a.DirectionalHint.rightTopEdge,cardDismissDelay:t.CARD_DISMISS_DELAY,gapSpace:0};return k=n.__decorate([u.withResponsiveMode],k)})(o.BaseComponent);t.FileHoverCard=k});
define("@ms/shared-react-item-hover-card/lib/IFileHoverCardStore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(t.AnalyticsResultStatus||(t.AnalyticsResultStatus={}))});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivityList/AnalyticsActivityList",["require","exports","tslib","react","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Spinner","../AnalyticsActivity/AnalyticsActivity","../AnalyticsStats/AnalyticsStats","../AnalyticsStats/AnalyticsStats","ODCDeferred_css","../Utilities/ItemAnalyticsCommunicationManager","@ms/odsp-datasources/lib/AcronymAndColor","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";f=f.AnalyticsActivityList_module_2;Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return r.createElement(s.Spinner,{size:s.SpinnerSize.large})};return t})(r.Component),d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&r.createElement("div",{className:f.analyticsActivityListActivity},r.createElement(o.AnalyticsActivity,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?r.createElement(p,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,s=void 0===n||n,o=this.state.itemAnalyticsData,f=a.getFileHoverCardStrings();o&&o.incompleteData&&o.incompleteData.wasThrottled&&(e=f.throttledMessage);if(o){l.setListAsFinishedLoading();return r.createElement("div",null,s&&r.createElement(u.AnalyticsStats,{itemAnalytics:o,inComplete:!!e}),this.state.items&&r.createElement(i.List,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}}))}return r.createElement(p,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new c.AcronymAndColorDataSource(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:r=n.sent();i=r.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});n.label=2;case 2:return[3,4];case 3:s=n.sent();h.default.logError(s);l.pageError(s);return[3,4];case 4:return[2]}})})};return t})(r.Component);t.AnalyticsActivityList=d});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivity/AnalyticsActivity",["require","exports","react","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/components/Persona/index","@ms/odsp-utilities/lib/string/StringHelper","../AnalyticsStats/AnalyticsStats","../FileHoverCard.resx","../UserNameHelper","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.AnalyticsActivity_module_8;Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActivity=function(e){var t=e.activity,l=e.loginUserEmail,c=e.userEmail,h=o.getFileHoverCardStrings(),p="";"Access"===t.activityType?p=h.accessActivity:"Modified"===t.activityType&&(p=h.modifiedActivity);var d=t&&t.actor&&t.actor.user,v=a.isCurrentLoginUser(d&&d.email,l,c)?h.loginUserYou:d&&d.displayName||d&&d.email||u.default.guest,m=n.createElement("div",{className:f.analyticsActivityUserName},v),g=n.createElement("div",{className:f.analyticsActivityUserAction},p),y=h.activityTemplate&&s.formatToArray(h.activityTemplate,m,g),b=i.PersonaSize.size24;return n.createElement(r.ActivityItem,{activityPersonas:[{imageUrl:d.image,imageAlt:v,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:b}],activityDescription:n.createElement("div",{dir:"auto",className:f.analyticsActivity},y),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})}});
define("@ms/shared-react-item-hover-card/lib/AnalyticsStats/AnalyticsStats",["require","exports","react","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","../IFileHoverCardStore","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Styling","../FileHoverCard.resx","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Tooltip","@ms/odsp-graph/lib/services/itemAnalytics/LikeCommentHelper","ODCDeferred_css","@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBarLikeLink","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";h=h.AnalyticsStats_module_2;Object.defineProperty(t,"__esModule",{value:!0});var v=new Date("0001-01-01T00:00:00-08:00");t.AnalyticsStats=function(e){var t,d=e.itemAnalytics,b=e.onClick,w=e.onLikeClick,E=e.pageUrl,S=e.isLink,x=e.status,T=e.isCompact,N=e.disableViewerCount,C=void 0===N||N,k=e.ODBOptOutViewerList,L=void 0!==k&&k,A=e.itemKey,O=y();if(x===s.AnalyticsResultStatus.failed){var M=u.getTheme();t=O.apiError&&g("ErrorBadge",O.apiError,{color:M.palette.redDark})}if(t)return null;if(!d||!d.viewCount||!d.viewerCount)return n.createElement(i.ActivityItem,{className:h.analyticsStats,isCompact:!0});var _=d.viewCount,D=d.viewerCount,P=d.activities,H=d.commentCount,B=d.likeCount,j=d.incompleteData&&d.incompleteData.missingDataBeforeDateTime&&new Date(d.incompleteData.missingDataBeforeDateTime).getTime()!==v.getTime(),F=d.incompleteData&&d.incompleteData.wasThrottled,I=j?a.default.inCompleteMessage:F?a.default.throttledStateMessage:"",q=C?L?a.default.odbTeachingMessage:"":a.default.spoTeachingMessage,R=I||q,U=_>1?O.views:O.view,z=D>1?O.viewers:O.viewer,W=H&&H>1?O.comments:O.comment,X=B&&B>1?O.likes:O.like,V=H?""+f.format(W,H):"",$=B?""+f.format(X,B):"",J=c.isLikePanelEnabled()?w:void 0,K=c.isCommentLinkEnabled()?E:void 0,Q=$&&m($,J),G=V&&m(V,void 0,K);return T?S?n.createElement("div",{className:h.analyticsStatsContainer},n.createElement(r.Link,{className:h.analyticsStatsLink,onClick:b},n.createElement(i.ActivityItem,{activityPersonas:P&&0!==P.length?P.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:n.createElement("div",{className:h.analyticsStatsLabel},_&&n.createElement("div",{className:h.analyticsStatsCount},_+" "+U)),isCompact:!0})),$&&A?n.createElement(p.SocialBarLikeLink,{likeLabel:$,itemKey:A}):Q,G):n.createElement("div",{className:h.analyticsStatsContainer},m(_+" "+U,void 0),m(D+" "+z,void 0),R&&n.createElement(l.TooltipHost,{content:R,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsTeachingMessage,iconName:"Info","aria-describedby":R})),Q,G):n.createElement("div",{className:h.analyticsStatsViews},D+" "+z,n.createElement("span",{className:h.analyticsStatsViewsDivider}),_+" "+U,I&&n.createElement(l.TooltipHost,{content:I,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsInfo,iconName:"Info","aria-describedby":I})))};t.AnalyticsStats.defaultProps={isLink:!1};function m(e,t,s){var o=n.createElement(i.ActivityItem,{activityDescription:n.createElement("div",{className:d.css(h.analyticsStatsLabel,h.analyticsStatsCount)},e),isCompact:!0});return t||s?n.createElement(r.Link,{className:h.analyticsStatsLink,href:s+"#comments",target:"_blank",onClick:t},o):n.createElement("div",{className:h.analyticsStatsNoLink},o)}function g(e,t,r){return n.createElement(n.Fragment,null,n.createElement(o.Icon,{iconName:e,className:h.fileHoverCardErrorIcon,styles:{root:u.mergeStyles([{paddingRight:"8px",position:"relative"},r])}}),t)}t.getMessageSection=g;function y(){return{details:a.default.seeDetails,viewer:a.default.viewer,viewers:a.default.viewers,view:a.default.view,views:a.default.views,comment:a.default.pageComment,comments:a.default.pageComments,like:a.default.pageLike,likes:a.default.pageLikes,apiError:a.default.apiError,suggestion:a.default.suggestion,unsupportMessage:a.default.unsupportMessage,accessActivity:a.default.accessActivity,modifiedActivity:a.default.modifiedActivity,activityTemplate:a.default.activityTemplate,inCompleteDataMessage:a.default.inCompleteDataMessage,throttledMessage:a.default.throttledMessage,trendingItem:a.default.trendingItem,loginUserYou:a.default.you}}t.getFileHoverCardStrings=y});
define("@ms/odsp-graph/lib/services/itemAnalytics/LikeCommentHelper",["require","exports","@ms/odsp-utilities/lib/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1305},i={ODB:1306};t.isCommentLinkEnabled=function(){return n.default.isFeatureEnabled(r)};t.isLikePanelEnabled=function(){return n.default.isFeatureEnabled(i)}});
define("@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBarLikeLink",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","../../withAction/WithAction","../../actions/analyticsClick/ShowSocialBarAction","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a){"use strict";a=a.SocialBar_2;Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,f=r.createElement(s.ActivityItem,{activityDescription:t,isCompact:!0});return r.createElement(o.WithAction,{action:r.createElement(u.ShowSocialBarAction,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,s=t?function(){n().catch(function(){})}:void 0;return r.createElement(i.Link,{disabled:!1,className:a.analyticsStatsLink,onClick:s},f)})};return t})(r.Component);t.SocialBarLikeLink=f});
define("@ms/items-view/lib/private/components/actions/analyticsClick/ShowSocialBarAction",["require","exports","tslib","react","../../decorators/selectors","../../withAction/WithAction","../../action/Action","../../../utilities/components/Async","../../../models/telemetry/getItemEngagement","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../fileHoverCard/hoverCardStats/SocialBarPanel"],t,n)})];case 1:return[2,t.sent().default]}})})});t.ShowSocialBarAction=f.createItemCacheComponent(function(e,t){var i=t.itemKey,u=s.renderComponentOnExecute(function(e){return r.createElement(l,n.__assign({},e,{itemKey:i}))},{scope:"global"});return r.createElement(o.Action,n.__assign({onExecute:u},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"SocialBar",isIntentional:!0}})))});t.CurrentShowSocialBarAction=i.withOnlyCurrentItem()(t.ShowSocialBarAction)});
define("@ms/shared-react-item-hover-card/lib/UserNameHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCurrentLoginUser=function(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}});
define("@ms/shared-react-item-hover-card/lib/Utilities/ItemAnalyticsCommunicationManager",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1,i=!1;t.setListAsFinishedLoading=function(){if(!i){i=!0;s()}};function s(){if(!r&&i){r=!0;new n.default({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:n.ResultTypeEnum.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}}}t.pageFinishedLoading=s;t.pageError=function(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}});
define("@ms/odsp-datasources/lib/AcronymAndColor",["require","exports","tslib","./dataSources/siteHeader/AcronymAndColorDataSource"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActionBar/AnalyticsActionBar",["require","exports","tslib","react","@uifabric/experiments/lib/CommandBar","../AnalyticsStats/AnalyticsStats","office-ui-fabric-react/lib/Shimmer","ODCDeferred_css","../IFileHoverCardStore","@ms/items-view/lib/private/components/actionCommandBar/ActionCommandBar"],function(e,t,n,r,i,s,o,u,a,f){"use strict";u=u.AnalyticsActionBar_module_4;Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActionBar=function(e){var t=e.items,l=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==a.AnalyticsResultStatus.unsupport&&c.status!==a.AnalyticsResultStatus.failed),m=e.itemKey?r.createElement(f.ActionCommandBar,{className:u.analyticsActionBar,commands:t,farCommands:l}):r.createElement(i.CommandBar,{className:u.analyticsActionBar,items:t,farItems:l});return r.createElement("div",null,r.createElement("div",{className:u.analyticsActionBarStats},r.createElement(o.Shimmer,{width:"35%",isDataLoaded:v,shimmerElements:[{type:o.ShimmerElementType.line,height:8}]},r.createElement(s.AnalyticsStats,n.__assign({isLink:h,isCompact:!0},c)))),d&&(l.length>0||t.length>0)&&m)}});
define("@uifabric/experiments/lib/CommandBar",["require","exports","tslib","office-ui-fabric-react/lib/CommandBar"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/items-view/lib/private/components/actionCommandBar/ActionCommandBar",["require","exports","tslib","react","@uifabric/experiments/lib/CommandBar","../commandSet/CommandSet","../../utilities/arrays","../keyboard/KeyboardShortcut","../commands/Commands.resx","@uifabric/utilities/lib/componentAs/composeComponentAs"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=[];t.ActionCommandBar=s.connectToCommandSets(function(e){return{main:e.commands,overflow:e.overflowCommands,far:e.farCommands,shortcut:e.shortcutCommands}},function(e,t){var n=t.items,r=void 0===n?l:n,i=t.overflowItems,s=void 0===i?l:i,u=t.farItems,f=void 0===u?l:u,c=t.shortcutItems,h=void 0===c?l:c;return{items:o.concat(r,e.main),overflowItems:o.concat(s,e.overflow),farItems:o.concat(f,e.far),shortcutItems:o.concat(h,e.shortcut),ariaLabel:a.default.CommandBarAriaLabel}})(function(e){var t=e.items,s=void 0===t?l:t,o=e.farItems,c=void 0===o?l:o,h=e.overflowItems,p=void 0===h?l:h,d=e.shortcutItems,v=void 0===d?l:d,m=e.commandBarAs,g=m?f.composeComponentAs(m,i.CommandBar):i.CommandBar,y=(function(e){return e.filter(function(e){return e&&(!!e.shortcutProps||!!e.keytipProps)})})(n.__spreadArrays(s,c,p,v));return r.createElement(r.Fragment,null,r.createElement(g,n.__assign({overflowButtonProps:{ariaLabel:a.default.OverflowCommandTooltip,title:a.default.OverflowCommandTooltip}},e)),y&&y.length>0&&y.map(function(e){var t=e.shortcutProps||e.keytipProps;return t&&t.keySequences.length>0&&e.onClick?r.createElement(u.KeyboardShortcut,{key:e.key,keySequences:t.keySequences,description:t.content,onExecute:e.onClick}):null}))});t.ActionCommandBar.displayName="ActionCommandBar"});
define("@ms/shared-react-item-hover-card/lib/AnalyticsLifeCycle/AnalyticsLifeCycle",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","@uifabric/experiments/lib/components/signals/Signals","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-graph/lib/services/itemAnalytics/IItemAnalytics","../UserNameHelper","../FileHoverCard.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.AnalyticsLifeCycle_module_8;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckInClick=function(e){n.props.onCheckIn(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};n._onDiscardCheckOutClick=function(e){n.props.onDiscardCheckOut(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};return n}t.prototype.render=function(){var e,t,n,c,h,p,d=this.props,v=d.lifeCycleStatus,m=d.loginUserEmail,g=d.userEmail,y=void 0;switch(v.status){case u.AnalyticsLifeCycleStatus.MalwareDetected:e=f.default.malwareDetected;t="https://go.microsoft.com/fwlink/?linkid=862871";h=f.default.learnMore;y=r.createElement(s.MalwareDetectedSignal,null);break;case u.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut:var b=v.userCheckedOutThis;if(b&&b.email&&a.isCurrentLoginUser(b.email,m,g)){e=f.default.youHaveThisCheckedOut;n=this.props.onCheckIn&&this._onCheckInClick;c=this.props.onDiscardCheckOut&&this._onDiscardCheckOutClick;h=f.default.checkIn;p=f.default.discardCheckOut;y=r.createElement(s.YouCheckedOutSignal,null)}else{e=o.format(f.default.someoneElseHasThisFileCheckedOut,b&&b.displayName);y=r.createElement(s.SomeoneCheckedOutSignal,null)}break;case u.AnalyticsLifeCycleStatus.DLPBlocked:e=f.default.DLPBlocked;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.BlockedSignal,null);break;case u.AnalyticsLifeCycleStatus.MissingMetaData:e=f.default.missingMetaData;n=this.props.onAddMetadataNow;h=f.default.addMetaData;y=r.createElement(s.MissingMetadataSignal,null);break;case u.AnalyticsLifeCycleStatus.DLPWarning:e=f.default.DLPWarning;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.WarningSignal,null);break;case u.AnalyticsLifeCycleStatus.NeedsRepublishing:e=f.default.needsRepublishing;n=this.props.onPublishNow;h=f.default.publishNow;y=r.createElement(s.NeedsRepublishingSignal,null);break;case u.AnalyticsLifeCycleStatus.AwaitingApproval:e=f.default.awaitingApproval;y=r.createElement(s.AwaitingApprovalSignal,null);break;case u.AnalyticsLifeCycleStatus.Trending:e=f.default.trendingItem;y=r.createElement(s.TrendingSignal,null);break;case u.AnalyticsLifeCycleStatus.New:var w=v.creator;e=w&&w.email&&a.isCurrentLoginUser(w.email,m,g)?o.format(f.default.youCreated,v.createdRelativeTime):o.format(f.default.otherCreated,v.createdRelativeTime,w&&w.displayName);y=r.createElement("div",{className:l.fileHoverCardLifeCycleNewSignal},r.createElement(s.NewSignal,null))}return y&&r.createElement("div",{className:l.fileHoverCardLifeCycle},y,r.createElement("div",{className:l.fileHoverCardLifeCycleMessage},r.createElement("div",{className:l.fileHoverCardLifeCycleTitle},e),(n||t)&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,href:t,target:t&&"_blank",onClick:n},h),c&&" or ",c&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,onClick:c},p)))};return t})(r.Component);t.AnalyticsLifeCycle=c});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPoints",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","../FileHoverCard.resx","@ms/odsp-utilities/lib/string/StringHelper","../itemsScopeFileHoverCard/EngagementContext","ODCDeferred_css","../FileHoverCardHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";d=d.AnalyticsKeyPoints_module_6;Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click");n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=c.default.insideLookTooltipMessage,n=this.props.keyPointsData;return r.createElement("div",{className:d.fileHoverCardInsideLook,style:v.isCollapsedSectionsEnabled()?{borderTop:0,paddingTop:0}:{}},!v.isCollapsedSectionsEnabled()&&r.createElement("div",{className:d.fileHoverCardInsideLookTitle},r.createElement("div",null,!v.isCollapsedSectionsEnabled()&&c.default.insideLook,r.createElement(u.TooltipHost,{content:t,directionalHint:l.DirectionalHint.bottomCenter},r.createElement(o.Icon,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&r.createElement(l.ContextualMenu,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:i.getRTL()?l.DirectionalHint.bottomLeftEdge:l.DirectionalHint.bottomRightEdge,items:[{key:"sendFeedback",name:c.default.SendUsFeedback,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:c.default.EditKeyPoints,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&r.createElement("div",{className:d.fileHoverCardReadTimeContainer,style:v.isCollapsedSectionsEnabled()?{justifyContent:"space-between"}:{}},r.createElement("div",{className:d.fileHoverCardReadTime},r.createElement(o.Icon,{className:d.fileHoverCardReadTimeIcon,iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),v.isCollapsedSectionsEnabled()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?r.createElement(s.Button,{className:d.fileHoverCardKeyPointsButton,onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):r.createElement("div",{className:d.fileHoverCardKeyPointsNonButton},this._keyPointsContent(n))))};t.prototype._keyPointsContent=function(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:d.fileHoverCardKeyPointsAction},c.default.keyPointsTitle),r.createElement(a.List,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:d.fileHoverCardKeyPointsContent}))};t.prototype._onRenderCell=function(e){return e&&r.createElement("div",{className:d.fileHoverCardKeyPointsCell},r.createElement("div",{className:d.fileHoverCardKeyPointsBullet}),r.createElement("div",{dir:"auto",className:d.fileHoverCardKeyPointsText},e.text))};t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&r.createElement(f.IconButton,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:c.default.MoreOptions,style:{marginTop:"2px"}})};t.prototype._timeToReadMessage=function(e){if(0===e)return c.default.timeToReadInZero;if(e>60){var t=h.getLocalizedCountValue(c.default.timeToReadInHours,c.default.timeToReadInHoursIntervals,Math.floor(e/60));return t&&h.format(t,Math.floor(e/60))}return h.format(c.default.timeToReadInMinutes,e)};return t})(r.Component);t.AnalyticsKeyPoints=m;m.contextType=p.EngagementContext});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/EngagementContext",["require","exports","react","./FileHoverCardEngagement"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EngagementContext=n.createContext(new r.FileHoverCardEngagement)});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/FileHoverCardEngagement",["require","exports","tslib","@ms/telemetry-manager/lib/events/Engagement.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this._engagementData={};this._engagement=e||r.Engagement}Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!0,configurable:!0});e.prototype.logData=function(e,t){this._engagement.logData(n.__assign(n.__assign({name:e},this._engagementData),{extraData:n.__assign(n.__assign({},this._engagementData.extraData),t)}))};return e})();t.FileHoverCardEngagement=i});
define("@ms/shared-react-item-hover-card/lib/ErrorBoundary",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.prototype.componentDidCatch=function(e,t){this.props.qosEvent({error:e,errorInfo:JSON.stringify(t)});this.setState({hasError:!0})};t.prototype.render=function(){return this.state.hasError?null:r.createElement(r.Fragment,null,this.props.children)};return t})(r.Component);t.ErrorBoundary=i});
define("@ms/shared-react-item-hover-card/lib/RecommendedActions/RecommendedActions",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/uri/Uri","./LowActivity","ODCDeferred_css","../FileHoverCard.resx","../FileHoverCardHelper","../itemsScopeFileHoverCard/EngagementContext"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";p=p.RecommendedActions_module_4;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._recommendedAction=function(e,t){var c=f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(e.activityTimestamp)),h="",v="",m="";switch(e.recommendationEventType){case"Mentioned":h="Accounts";m=l.formatToArray(d.default.MentionMessage,n._userNameJSX(e.actorDisplayName));v=d.default.Reply;break;case"Edited":h="Edit";m=d.default.EditMessage;v=d.default.OpenToRead;var g=e.importantActorsAndActivities[0],y=g&&g.activityTimestamp;c=y&&f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(y));var b=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});m=1===b.length?l.formatToArray(d.default.OnePersonEditMessage,n._userNameJSX(b[0])):2===b.length?l.formatToArray(d.default.TwoPersonEditMessage,n._userNameJSX(b[0]),n._userNameJSX(b[1])):l.formatToArray(d.default.EditMessage,n._userNameJSX(b[0]),n._userNameJSX(b[1]),e.recentEditorCount-2);break;case"Commented":h="Chat";m=l.formatToArray(d.default.CommentMessage,n._userNameJSX(e.actorDisplayName));v=d.default.View}return r.createElement("div",{key:t},r.createElement("div",{className:p.fileHoverCardRecommendedAction},r.createElement(u.ActivityItem,{activityIcon:r.createElement(i.Icon,{iconName:h,className:p.fileHoverCardRecommendedIcon}),activityDescription:r.createElement("div",{className:p.fileHoverCardRecommendedMessage},m),timeStamp:c}),r.createElement(a.TooltipHost,{content:d.default.Dismiss,directionalHint:a.DirectionalHint.topCenter},r.createElement(s.IconButton,{className:p.fileHoverCardCancelIcon,iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),r.createElement(o.Link,{className:p.fileHoverCardRecommendedLink,href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions."+e.recommendationEventType,{})}},v))};n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new c.default(n.props.pageUrl);t.setQueryParameter("nav",e);t.setQueryParameter("commentId",e);return t.toString()}return n.props.pageUrl};n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})};n.state={recommendedActions:n.props.actions.recommendedActions};return n}t.prototype.render=function(){var e=this.state.recommendedActions,t=v.isLowActivityTidbitEnabled()&&this.props.actions.shareWith&&this.props.actions.shareWith.length>=2;return(e&&e.length>0||t)&&r.createElement("div",{ref:this._recommendedActionRef,className:p.fileHoverCardRecommendedSection,style:v.isCollapsedSectionsEnabled()?{borderTop:0}:{}},!v.isCollapsedSectionsEnabled()&&r.createElement("div",{className:p.fileHoverCardRecommendedTitle},d.default.RecommendedActionTitle),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):r.createElement(h.LowActivity,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return r.createElement("span",{className:p.fileHoverCardUserName},e)};t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId});this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t})(r.Component);t.RecommendedActions=g;g.contextType=m.EngagementContext});
define("@ms/shared-react-item-hover-card/lib/RecommendedActions/LowActivity",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Link","@ms/odsp-utilities/lib/string/StringHelper","../UserNameHelper","../FileHoverCard.resx","ODCDeferred_css","../HoverCardLoggerHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";l=l.RecommendedActions_module_4;Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);c.default("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,a=t.shareWith,c=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return a&&a.length>=2&&r.createElement(r.Fragment,null,r.createElement("div",{className:l.fileHoverCardShareWith},u.formatToArray(f.default.ShareWithMessage,this._userNameJSX(a[0].displayName),this._userNameJSX(a[1].displayName))),this.props.onRenderShareWithPeople?r.createElement("div",{className:l.fileHoverCardShareWithLink},this.props.onRenderShareWithPeople(c)):r.createElement(o.Link,{className:l.fileHoverCardShareWithLink,onClick:this._handleClickShare},f.default.ShareWithThem),n&&n.map(function(t,n){return n<2&&r.createElement(s.ActivityItem,{key:n,activityIcon:r.createElement(i.Icon,{iconName:"Edit",className:l.fileHoverCardRecommendedIcon}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=a.isCurrentLoginUser(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?f.default.you:e.actor.user.displayName;return r.createElement("div",{className:l.fileHoverCardActivity},u.formatToArray(f.default.LowActivities,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return r.createElement("div",{key:e,className:l.fileHoverCardUserName},e)};return t})(r.Component);t.LowActivity=h});
define("@ms/shared-react-item-hover-card/lib/HoverCardLoggerHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){t?r.Engagement.logData({name:e,isIntentional:!0,extraData:n.__assign({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},i)}):r.Engagement.logData(n.__assign({name:e},i))}});
define("@ms/shared-react-item-hover-card/lib/FileHoverCardStore",["require","exports","tslib","./IFileHoverCardStore","@ms/odsp-utilities/lib/async/PromiseDeduplicator","@ms/odsp-utilities/lib/async/Promise","./Utilities/ItemAnalyticsCommunicationManager","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-datasources/lib/dataSources/base/DataRequestor","@ms/odsp-datasources/lib/providers/fileHoverCard/FeedbackProvider"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=0,c=(function(){function e(e,t){this._dictListener={};this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._dictItemAnalytics={};this._promiseDeduplicator=new i.default;t.pageContext&&(this._feedbackProvider=new f.FeedbackProvider({},{pageContext:t.pageContext,dataRequestorType:(function(e){n.__extends(r,e);function r(n){return e.call(this,n,{pageContext:t.pageContext})||this}return r})(a.DataRequestor)}));setInterval(this._cleanCache.bind(this),18e5)}e.prototype.addListener=function(e,t){var n=""+ ++l;this._dictListener[t.itemId]||(this._dictListener[t.itemId]={});this._dictListener[t.itemId][n]=e;return{key:n}};e.prototype.fetchItemAnalytics=function(e,t){var i=this;this._clearErrorResponse();if(!this._dictItemAnalytics[e.itemId]||!this._dictItemAnalytics[e.itemId].data)if(u.Killswitch.isActivated("30ddf998-5836-4a46-b116-41e73697fc75","6/6/2019","Switch to single query API to get item analytics"))this._promiseDeduplicator.deduplicate(e.itemId,function(){return s.default.all({allTimeItemAnalytics:i._itemAnalyticsDataSource.getItemAnalytics(e,{skipToken:t}),analyticsSections:i._itemAnalyticsDataSource.getAnalyticsSections(e)}).then(function(t){var s=t.allTimeItemAnalytics,o=t.analyticsSections,u=n.__assign(n.__assign({},o),s),a={status:r.AnalyticsResultStatus.succeed,data:u,skipToken:s&&s.skipToken,actions:void 0};i._dictItemAnalytics[e.itemId]=a;i._emitChange(e)},function(t){var n,s=t&&t.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)n=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===t)return;n=r.AnalyticsResultStatus.failed}i._dictItemAnalytics[e.itemId]={status:n,data:void 0,actions:void 0};t.error&&o.pageError(t.error);i._emitChange(e)})});else{this._dictItemAnalytics[e.itemId]={status:r.AnalyticsResultStatus.failed,data:void 0,actions:void 0};this._getAllAnalyticsData(e)}};e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]};e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]};e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)};e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)};e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){var t=e.incompleteData&&e.incompleteData.missingDataBeforeDateTime;return n.__assign({activity:{},incompleteData:{missingDataBeforeDateTime:t&&new Date(t),wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},startDateTime:e.startDateTime&&new Date(e.startDateTime)},e)})};e.prototype.cleanCachedItem=function(e){this._dictItemAnalytics[e.itemId]&&delete this._dictItemAnalytics[e.itemId]};e.prototype.updateItemKeyPoints=function(e,t){var n=this;return this._itemAnalyticsDataSource.updateItemKeyPoints(e,t).then(function(t){var r=n._dictItemAnalytics[e.itemId];if(r&&r.data&&r.data.keyPointsData&&r.data.keyPointsData.keyPoints){var i=t.filter(function(e){return"Deleted"!==e.state});r.data.keyPointsData.keyPoints=i}n._emitChange(e)},function(){n._dictItemAnalytics[e.itemId]&&(n._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.failed);n._emitChange(e)})};e.prototype.dismissRecommendedAction=function(e,t,n,r,i){this._feedbackProvider.dismissRecommendedAction(e,t,n,r,i)};e.prototype._getItemAnalyticsByInterval=function(e,t){var n=new Date;n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));var r=new Date,i=new Date;r.setDate(r.getDate()-90);i.setHours(r.getHours()-1440);return this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,r,n,t)};e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===r.AnalyticsResultStatus.failed&&delete this._dictItemAnalytics[e]};e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];for(var n in t)t&&t[n]()};e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==r.AnalyticsResultStatus.unsupport&&delete this._dictItemAnalytics[e]};e.prototype._getAllAnalyticsData=function(e){var t=this;this._promiseDeduplicator.deduplicate(e.itemId,function(){return t._itemAnalyticsDataSource.getItemAnalyticsSections(e)}).then(function(n){t._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.succeed;t._dictItemAnalytics[e.itemId].data=n;t._emitChange(e)},function(n){var i,s=n&&n.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)i=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===n)return;i=r.AnalyticsResultStatus.failed}t._dictItemAnalytics[e.itemId].status=i;t._dictItemAnalytics[e.itemId].data=void 0;s&&s.error&&o.pageError(s.error);t._emitChange(e)})};return e})();t.FileHoverCardStore=c});
define("@ms/odsp-utilities/lib/async/PromiseDeduplicator",["require","exports","./Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._pendingPromises={}}e.prototype.deduplicate=function(e,t){var r=this;if(!this._pendingPromises[e]){var i=t();this._pendingPromises[e]=i;return i.then(function(t){delete r._pendingPromises[e];return t},function(t){delete r._pendingPromises[e];return n.default.reject(t)})}return this._pendingPromises[e]};return e})();t.default=r});
define("@ms/odsp-datasources/lib/providers/fileHoverCard/FeedbackProvider",["require","exports","@ms/odsp-utilities/lib/uri/Uri","../../utilities/url/ItemUrlHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext;this._dataRequestor=new t.dataRequestorType({qosName:"FileHoverCardFeedback"});this._itemUrlHelper=new r.ItemUrlHelper({},{pageContext:this._pageContext})}e.prototype.dismissRecommendedAction=function(e,t,r,i,s){var o=this._itemUrlHelper.getUrlParts({path:e.path}),u=o.webRelativeItemUrl.replace("/"+t,""),a={ListId:this._pageContext.listId,ListItemUniqueId:i,Operation:"RecommendationActedOn",AffectedResourceUrl:o.fullItemUrl,ItemType:"File",json:JSON.stringify({FileName:t,Scenario:"RecommendedActions",SourceRelativeUrl:u,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(s+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:r,Canvas:"Web",Workload:"SharePoint",WebId:this._pageContext.webId,SiteId:this._pageContext.siteId,SiteUrl:this._pageContext.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:t,SourceFileExtension:e.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:r,ActionType:"Dismiss"})},f=new n.default(this._pageContext.webAbsoluteUrl+"/_api/web/ActivityLogger/FeedbackDirect");this._dataRequestor.getData({url:f.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(a),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})};return e})();t.FeedbackProvider=i});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsEditor",["require","exports","tslib","react","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Spinner","../IFileHoverCardStore","./AnalyticsKeyPointsFeedback","../HoverCardLoggerHelper","office-ui-fabric-react/lib/FocusZone","../FileHoverCard.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";m=m.AnalyticsKeyPointsEditor_module_1;Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._getKeyPoints=function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item);return e&&e.data&&e.data.keyPointsData&&e.data.keyPointsData.keyPoints||[]};i._onRenderCell=function(e,t){return e&&void 0!==t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorCell,"data-is-focusable":!0,role:"listitem"},r.createElement(o.ActivityItem,{activityDescriptionText:e.text}),r.createElement(u.IconButton,{iconProps:{iconName:"Delete"},className:m.fileHoverCardKeyPointsEditorDeleteIcon,checked:!1,disabled:!1,onClick:function(){return i._onDeleteKeyPoint(t)},ariaLabel:v.default.Delete}))};i._onAddKeyPointClick=function(){i.setState(n.__assign(n.__assign({},i.state),{showInputBox:!0}));p.default("FileHoverCard.KeyPoints.Add",i.props.item)};i._isInputValid=function(){var e=i.state.inputValue.length;return e>0&&e<100};i._onInputChange=function(e,t){i.setState(n.__assign(n.__assign({},i.state),{inputValue:t||""}))};i._getErrorMessage=function(e){return e.length>100?v.default.KeyPointsInvalidMessage:i.state.status===c.AnalyticsResultStatus.failed?v.default.RequestFailureWarning:void 0};i._onSaveClick=function(){var e=i.state.keyPoints,t=JSON.parse(JSON.stringify(e));t.unshift({text:i.state.inputValue,isUserEdited:!0});i.setState(n.__assign(n.__assign({},i.state),{isSaving:!0}));i._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Save",i.props.item)};i._onCancelClick=function(){i.setState(n.__assign(n.__assign({},i.state),{showInputBox:!1,status:c.AnalyticsResultStatus.succeed}));p.default("FileHoverCard.KeyPoints.Cancel",i.props.item)};i._addListener=function(){var e=i.props.fileHoverCardStore;i._storeListener=e.addListener(function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item).status;i.setState(function(t){return n.__assign(n.__assign({},i.state),{showInputBox:(!t.isSaving||e!==c.AnalyticsResultStatus.succeed)&&t.showInputBox,isSaving:!1,keyPoints:i._getKeyPoints(),inputValue:"",status:e})})},i.props.item);e.fetchItemAnalytics(i.props.item)};i._onFeedbackClick=function(){i.setState({showFeedback:!0});i.props.onFeedbackClick();p.default("FileHoverCard.KeyPoints.SendFeedback",i.props.item)};i.state={inputValue:"",isSaving:!1,showInputBox:!1,keyPoints:i._getKeyPoints(),showFeedback:i.props.showFeedbackPanel,status:c.AnalyticsResultStatus.succeed};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState(n.__assign(n.__assign({},this.state),{keyPoints:this._getKeyPoints()}))};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){if(this.props.item.itemId!==e.item.itemId){this._removeListener();this._addListener()}};t.prototype.componentWillUnmount=function(){this._removeListener()};t.prototype.render=function(){var e=this.state,t=e.showInputBox,n=e.keyPoints,o=e.isSaving,u=n&&JSON.parse(JSON.stringify(n));return this.state.showFeedback?r.createElement(h.AnalyticsKeyPointsFeedback,{keyPoints:n,item:this.props.item}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditor},r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onAddKeyPointClick},v.default.keyPointsAdd),t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorInputSection},r.createElement(i.TextField,{multiline:!0,rows:4,value:this.state.inputValue,placeholder:v.default.keyPointInputPlaceholder,onGetErrorMessage:this._getErrorMessage,onChange:this._onInputChange}),o?r.createElement(l.Spinner,{className:m.fileHoverCardKeyPointsEditorSpinner,size:l.SpinnerSize.medium}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditorButtons},r.createElement(s.DefaultButton,{primary:!0,disabled:!this._isInputValid(),text:v.default.buttonSave,onClick:this._onSaveClick}),r.createElement(s.DefaultButton,{className:m.fileHoverCardKeyPointsEditorButtonCancel,text:v.default.buttonCancel,onClick:this._onCancelClick}))),r.createElement(d.FocusZone,{direction:d.FocusZoneDirection.vertical,isCircularNavigation:!0,"aria-label":v.default.KeyPointsListScreenReader,role:"list"},r.createElement(f.List,{items:u,onRenderCell:this._onRenderCell})),r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onFeedbackClick},v.default.SendFeedback))};t.prototype._onDeleteKeyPoint=function(e){var t=this.state.keyPoints;t[e].state="Deleted";this._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Delete",this.props.item,{keyPointId:e&&t[e].keyPointId});t.splice(e,1);this.setState(n.__assign(n.__assign({},this.state),{inputValue:""}))};t.prototype._updateKeyPoints=function(e){this.props.fileHoverCardStore.updateItemKeyPoints(this.props.item,e)};t.prototype._removeListener=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};return t})(r.Component);t.AnalyticsKeyPointsEditor=g});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsFeedback",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../HoverCardLoggerHelper","office-ui-fabric-react/lib/FocusZone","ODCDeferred_css","../FileHoverCard.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";h=h.AnalyticsKeyPointsFeedback_module_9;Object.defineProperty(t,"__esModule",{value:!0});var d;(function(e){e[e.YES=0]="YES";e[e.NO=1]="NO";e[e.NONE=2]="NONE"})(d=t.FeedbackAnswer||(t.FeedbackAnswer={}));var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClickKeyPointsYes=function(){n.setState({keyPointsAnswer:d.YES});l.default("FileHoverCard.KeyPoints.ClickYes",n.props.item)};n._onClickKeyPointsNo=function(){n.setState({keyPointsAnswer:d.NO});l.default("FileHoverCard.KeyPoints.ClickNo",n.props.item)};n._onARTClickYES=function(){n.setState({ARTAnswer:d.YES});l.default("FileHoverCard.TimeToRead.ClickYes",n.props.item)};n._onARTClickNO=function(){n.setState({ARTAnswer:d.NO});l.default("FileHoverCard.TimeToRead.ClickNo",n.props.item)};n._onClickARTSubmit=function(){n.setState({ARTSubmitted:!0});l.default("FileHoverCard.TimeToRead.Submit",n.props.item,n._extraData);n._extraData={}};n._onClickKeyPointsSubmit=function(){n.setState({keyPointsSubmitted:!0});l.default("FileHoverCard.KeyPoints.Submit",n.props.item,n._extraData);n._extraData={}};n.state={ARTAnswer:d.NONE,keyPointsAnswer:d.NONE,ARTSubmitted:!1,keyPointsSubmitted:!1,showARTReasons:!1,showKeyPointsReasons:!1};n._extraData={};return n}t.prototype.render=function(){return r.createElement("div",null,r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.AverageReadingTime,r.createElement(s.TooltipHost,{hostClassName:h.fileHoverCardFeedbackTooltip,content:p.default.TooltipMessage,directionalHint:s.DirectionalHint.bottomCenter},r.createElement(i.Icon,{iconName:"Info",ariaLabel:p.default.TooltipMessage,role:"tooltip",tabIndex:0}))),this.state.ARTSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._timeToReadFeedback(this.state.ARTAnswer)),this.state.ARTAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:h.fileHoverCardFeedbackSubmit,text:p.default.Submit,onClick:this._onClickARTSubmit})),r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.keyPointsTitle),this.state.keyPointsSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._keyPointsFeedback(this.state.keyPointsAnswer)),this.state.keyPointsAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:"ms-FileHoverCard-Feedback--Submit",text:p.default.Submit,onClick:this._onClickKeyPointsSubmit})))};t.prototype._timeToReadFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeART,onChange:function(e,n){t._extraData.LikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTCorrect,onChange:function(e,n){t._extraData.CorrectTimeToRead=n}}));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeART,onChange:function(e,n){t._extraData.NotLikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTIncorrect,onChange:function(e,n){return t.setState({showARTReasons:!!n})}}),this.state.showARTReasons&&r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement(u.Checkbox,{label:p.default.TooLong,onChange:function(e,n){t._extraData.TooLong=n}}),r.createElement(u.Checkbox,{label:p.default.TooShort,onChange:function(e,n){t._extraData.TooShort=n}})));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickYES,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickNO,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._keyPointsFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeKeyPoints,onChange:function(e,n){t._extraData.LikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.CorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.YES));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeKeyPoints,onChange:function(e,n){t._extraData.NotLikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.NotAnalyzeKeyPoints,onChange:function(e,n){t._extraData.NotAnalyzeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.IncorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.NO));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsYes,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsNo,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._subCheckbox=function(e){var t=this;return r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement("div",null,e===d.YES?p.default.SelectCorrectKeyPoints:p.default.SelectIncorrectKeyPoints),this.props.keyPoints&&this.props.keyPoints.map(function(n,i){return r.createElement(u.Checkbox,{key:i,label:n.text,onChange:function(n,r){return t._logKeyPointId(r,i,e===d.YES?"CorrectKeyPointId":"InCorrectKeyPointId")}})}))};t.prototype._feedbackMessage=function(e){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement("div",null,p.default.Thanks),r.createElement("div",null,f.format(p.default.FeedbackReason,e===d.YES?p.default.Yes:p.default.No)))};Object.defineProperty(t.prototype,"_feedbackSubmitted",{get:function(){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement(i.Icon,{iconName:"Accept"}),p.default.FeedbackSubmitted)},enumerable:!0,configurable:!0});t.prototype._logKeyPointId=function(e,t,n){e&&l.default("FileHoverCard.KeyPoints."+n,this.props.item,{keyPointId:this.props.keyPoints[t].keyPointId})};return t})(r.Component);t.AnalyticsKeyPointsFeedback=v});
define("odsp-next/dataSources/base/odb/DataRequestor",["require","exports","@ms/odsp-datasources/lib/dataSources/base/DataRequestor","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataRequestor=n.default;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.default,{pageContext:r.pageContext});t.default=n.default});
define("odsp-next/controls/fileHoverCard/react/FileHoverCard",["require","exports","tslib","react","prop-types","knockout","@ms/shared-react-item-hover-card/lib/index","../../list/react/detailsList/fields/FileTypeIconRenderer","../../../dataSources/itemAnalytics/store/FileHoverCardStore","../../../resources/ControlResourceKeys","../../sharing/share/commands/ShareCommandBuilder","@ms/odsp-datasources/lib/Url","../../../resources/SPOResourceKeys","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../list/react/detailsList/fields/NameFieldHeroCommandRenderer","./FileHoverCardHelper","@ms/odsp-utilities/lib/modules/ModuleHelper","../../../models/scope/Scope","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(t){n.__extends(S,t);function S(n){var i=t.call(this,n)||this;i.onFileIconRender=function(){return r.createElement("div",{className:"ms-FileHoverCard-compactCard--fileIcon"},u.renderFileTypeIcon({item:i.props.item,size:32,resources:i.resources,isDisabled:!1}))};i.getAccessToken=function(){return b.getGraphAccessToken(i.state.graphDataSource,i.props.item)};i.onKeyPoints=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.OpenEditPanel"});i._showKeyPointsAction(e,!1)};i.onSendFeedbackClick=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.SendFeedback"});i._showKeyPointsAction(e,!0)};i.onView=function(e){new(i.resources.injected(i.actionMap.ShowItemAnalyticsAction))({item:s.observable(i.props.item)}).execute(e)};i.onShare=function(e){i._engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});i._selectItem(e);var t=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey});i.props.onClickShare?i.props.onClickShare(e):t.execute(e)};i.onDetails=function(e,t){i._openInfoPane(e)};i.onFileCheckin=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.FileCheckIn"});i._selectItem(e);(new(i.resources.injected(i.actionMap.CheckInAction))).execute(e)};i.onDiscardCheckOut=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.DiscardCheckOut"});i._selectItem(e);(new(i.resources.injected(i.actionMap.UndoCheckOutAction))).execute(e)};i.onViewPolicyTip=function(t){i._engagement.logData({name:"FileHoverCard.LifeCycle.ViewPolicyTip"});i._selectItem(t);new Promise(function(t,n){e(["../../../actions/PolicyTipAction"],t,n)}).then(w.getDefaultExport).then(function(e){new(i.resources.injected(e))({item:s.observable(i.props.item)}).execute(t)})};i.onAddMetadataNow=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.AddMetadata"});i._selectItem(e);new(i.resources.injected(i.actionMap.EditItemAction))({item:s.observable(i.props.item)}).execute(e)};i._onShareWithDefaultPeople=function(e,t){i._selectItem(e);var n=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,defaultRecipients:t});i.props.onClickShare?i.props.onClickShare(e):n.execute(e)};i.resources=n.resources;i.state={fileHoverCardStore:i.resources.consume(a.resourceKey.optional),graphDataSource:i.resources.consume(d.graph.optional),target:i.props.target};i.actionMap=i.resources.consume(f.actionMap);i._pageContext=i.resources.consume(h.pageContext);i._platform=i.resources.consume(m.platformDetection);i._engagement=i.resources.consume(g.resourceKey);i._itemSetSelectionModel=i.resources.consume(f.itemsSelection);i._scope=new E.default;return i}S.prototype.componentDidMount=function(){var e=this,t=this.resources.consumeAsync(a.resourceKey),n=this.resources.consumeAsync(d.graph);this._scope.trackPromise(t);this._scope.trackPromise(n);t.then(function(t){e.setState({fileHoverCardStore:t})});n.then(function(t){e.setState({graphDataSource:t})});if(this.props.getUpdatedTarget){var r=this.props.getUpdatedTarget();this.setState({target:r})}};S.prototype.componentWillUnmount=function(){this._scope.dispose()};S.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource;if(!this.props.item)return null;var s=this.props.item,u=s.appMap,a=s.dateModified,f=s.extension,l=s.graph,h=s.itemId,d=s.isPlaceholder,m=s.lifeCycleStatus,g=s.name,w=s.openUrl,E=s.properties,S=s.queryType,x=s.id;if(d)return null;var T=E&&E.modifiedByUser,N=b.getGraphItemUrl(i,this.props.item),C=T&&T.email,k=T&&T.title,L=T&&C?{displayName:k||"",id:h||"",email:C,image:c.getUserPhotoUrl({userLoginName:C})}:void 0,A=m&&m.isMalwareDetected?void 0:[{key:"share",iconProps:{iconName:"share"},title:v.default.Share,onClick:this.onShare}],O=this._platform.isMobile,M={itemTitle:g||"",item:{itemId:h,graph:l,extension:f,queryType:p.default[S||0],graphItemUrl:N,getAccessToken:this.getAccessToken,appMap:u,path:x},target:this.state.target,currentUserActivity:{activityDateTime:a||"",activityType:"Modified",actor:{user:L}},onDetails:this.canShowActions()?this.onDetails:void 0,onKeyPointsClick:this.onKeyPoints,onView:this.onView,onCheckIn:this.onFileCheckin,onDiscardCheckOut:this.onDiscardCheckOut,onViewPolicyTip:this.onViewPolicyTip,onAddMetadataNow:this.onAddMetadataNow,isViewCountClickable:!0,actionBarItems:this.canShowActions()?A:void 0,loginUserEmail:this._pageContext.userLoginName,userEmail:this._pageContext.userEmail,pageUrl:w,gapSpace:this.props.gapData?12+this.props.gapData.inlineCommandCount*y.COMMAND_BUTTON_WIDTH:0,onSendFeedbackClick:this.onSendFeedbackClick,onShareWith:this._onShareWithDefaultPeople,uniqueId:E&&E.uniqueId,onRenderFileTypeIcon:this.onFileIconRender,onRenderShareWithPeople:this.props.onRenderShareWithPeople};return t&&i&&!O?r.createElement(o.FileHoverCard,n.__assign({},M)):this.props.children?this.props.children:null};S.prototype.getChildContext=function(){return{fileHoverCardStore:this.state.fileHoverCardStore}};S.prototype._selectItem=function(e){new(this.resources.injected(this.actionMap.SelectAction))({item:s.observable(this.props.item),showProperties:!1}).execute(e)};S.prototype._showKeyPointsAction=function(e,t){new(this.resources.injected(this.actionMap.ShowKeyPointsAction))({item:s.observable(this.props.item),showFeedbackPanel:t}).execute(e)};S.prototype._openInfoPane=function(e){var t=s.observable(this.props.item);new(this.resources.injected(this.actionMap.SelectAction))({item:t,selectItems:[t],showProperties:!0}).execute(e)};S.prototype.canShowActions=function(){var e=this.props.item,t=s.observable(e);return!e.isPlaceholder&&this._itemSetSelectionModel.canSelectItem(t)};S.childContextTypes={fileHoverCardStore:i.object.isRequired};return S})(r.Component);t.default=S});
define("odsp-next/controls/list/react/detailsList/fields/FileTypeIconRenderer",["require","exports","react","knockout","../../../../../utilities/icons/IconHelper","@ms/odsp-utilities/lib/icons/IconSelector","../../../../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/modules/ModuleHelper","../../../../../utilities/icons/OfficeFileNameHelper","../../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer","../../../../../utilities/accessibility/AriaHelper","@ms/odsp-utilities/lib/resources/Resources","../../../../../utilities/complianceTag/ComplianceTagUtilities","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m;(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(v||(v={}));(function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"})(m||(m={}));function g(t){var p=t.item,g=t.resources,y=t.size;if(!p)return null;var b=p.properties,w=4===p.state.upload.status?s.genericFile:(function(e){return e.type===o.default.Folder?s.getIconNameFromItem({extension:e.extension,isDocSet:e.isDocSet,listItem:e,sharingType:e.sharingType,type:e.type}):e.iconName})(p),E=p.extension,S=g.consume(l.resourceKey.optional),x=p.vault&&p.vault.root?(function(e,t,n){var r=t.vault.isLocked?v.vaultClosed:v.vaultOpen;return i.getIconUrl(e,r,n)})(g,p,y):p.iconUrl||t.preferAppIcon&&(function(e,t){var n=e.appMap;if((!e.extension||".pdf"!==e.extension.toLowerCase())&&n){var r=f.getAppName(n),i=t>=48?48:16;if(r){return window.require.toUrl("odsp-media/images/"+"appsFluent".toLowerCase()+"/"+r.toLowerCase()+"_"+i+"x1.svg")}}return})(p,y)||(function(e,t){return e&&e.getFileTypeIconUrl(t,!0)})(S,E)||i.getIconUrl(g,w,y),T=(function(e,t){return e&&e.getFileTypeName(t,!0)})(S,E)||h.getIconFieldAriaLabelForItem(p),N=(function(e){var t=m.none,n=e.policyTip;if(n){var r=1==(1&n);2==(2&n)?t=m.block:r&&(t=m.notify)}else e.isViolation?t=m.block:e.properties.CheckedOutUserId?t=m.checkOut:4===e.state.upload.status?t=m.notify:d.complianceRecordIconValue(e)&&(t=m.record);return t})(p),C=p.overlayUrl;C||N===m.none||(C=window.require.toUrl("odsp-media/images/overlays/"+N.toLowerCase()));var k=b.isDisabled||t.isDisabled,L=h.getTooltipText(p),A=!!(1&p.policyTip);return n.createElement(c.FileTypeIconRenderer,{iconName:w,width:y,iconUrl:x,iconTitle:"",overlayUrl:C,isDisabled:k,tooltipText:L,ariaLabel:T,isClickable:A,onClick:function(t){(function(t,n,i){if(1&t.policyTip){u.Engagement.logData({name:"PolicyTip.LaunchFromListView"});new Promise(function(t,n){e(["../../../../../actions/PolicyTipAction"],t,n)}).then(a.getDefaultExport).then(function(e){new(n.injected(e))({item:r.observable(t)}).execute(i)})}})(p,g,t)}})}t.renderFileTypeIcon=g;t.fileTypeIconRenderer=function(e){var t=e.item,n=e.column,r=e.isDisabled,i=e.resources;return g({item:t,size:n.minWidth||n.width,resources:i,isDisabled:r})};t.resourceKey=new p.ResourceKey({name:e("module").id,factory:new p.ConstantResourceFactory(t.fileTypeIconRenderer)})});
define("@ms/odsp-datasources/lib/Url",["require","exports","tslib","./utilities/url/ApiUrlHelper","./utilities/url/ItemUrlHelper","./utilities/url/UserPhotoUrlHelper","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);t.SimpleUri=o.SimpleUri;t.UriFormat=o.UriFormat});
define("@ms/odsp-datasources/lib/utilities/url/UserPhotoUrlHelper",["require","exports","@ms/odsp-utilities/lib/alternativeUrls/SPAlternativeUrls","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e.Small="S";e.Medium="M";e.Large="L"})(i=t.UserPhotoSize||(t.UserPhotoSize={}));t.getUserPhotoUrl=function(e){var t=e.webUrl||"",s=e.size||i.Small;if(r.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN"))return t+"/_layouts/15/userphoto.aspx?accountname="+e.userLoginName+"&size="+s;var o=void 0;switch(e.size){case i.Large:o=3;break;case i.Medium:o=2;break;default:o=1}return n.getUserPhotoUrl(e.userLoginName,o)}});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldHeroCommandRenderer",["require","exports","react","./DotDotDotRenderer","./ShareHeroCommandRenderer","../../../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMMAND_BUTTON_WIDTH=36;t.createHeroCommandsSectionFilesList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionRecentList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionList=function(e){var t=e.resources.consume(s.disableDotDotDotHeroCommand.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},!t&&r.dotDotDotRenderer(e))}});
define("odsp-next/controls/list/react/detailsList/fields/DotDotDotRenderer",["require","exports","react","../../../../../providers/engagement/Engagement","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer","../../../../../resources/ProviderResourceKeys","../../../../tooltip/TooltipHost","@ms/odsp-utilities/lib/resources/Resources","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dotDotDotRenderer=function(e){var t=e.item,a=e.isDisabled,f=e.resources;return n.createElement(u.TooltipHost,{content:i.default.showDetailsAriaLabel,resources:f},n.createElement(s.DotDotDotRenderer,{isDisabled:t.properties.isDisabled||a,ariaLabel:i.default.showDetailsAriaLabel,onClick:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("contextmenu",!0,!0,e);e.currentTarget.dispatchEvent(t);var n=f.consume(o.instrumentation.optional);f.consume(r.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0,currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA"});e.preventDefault();e.stopPropagation()}}))};t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.ConstantResourceFactory(t.dotDotDotRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DotDotDotRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-dot",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"MoreVertical"}))}});
define("odsp-next/controls/tooltip/TooltipHost",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/components/Tooltip/TooltipHost.types","./async/Tooltip","office-ui-fabric-react/lib/components/Tooltip/Tooltip.types"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onTooltipMouseEnter=function(e){if(void 0!==n.props.overflowMode){var t=n._getTargetElement();if(t&&!i.hasOverflow(t))return}n._toggleTooltip(!0)};n._onTooltipMouseLeave=function(e){n._toggleTooltip(!1)};n._onTooltipCallOutDismiss=function(){n._toggleTooltip(!1)};n.state={isTooltipVisible:!1};return n}t.prototype.render=function(){var e=this.props,t=e.calloutProps,s=e.children,u=e.content,a=e.delay,f=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,h=e.id,p=e.overflowMode,d=e.setAriaDescribedBy,v=void 0===d||d,m=e.tooltipProps,g=e.resources,y=this.state.isTooltipVisible,b=h||i.getId("tooltip");return r.createElement("div",n.__assign({className:i.css("ms-TooltipHost",c),style:p?{display:"inline"}:{display:"inline-block"},ref:this._resolveRef("_tooltipHost")},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._onTooltipMouseLeave},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,"aria-describedby":v&&y&&u?b:void 0}),s,y&&r.createElement(o.AsyncTooltip,n.__assign({id:b,delay:a,content:u,targetElement:this._getTargetElement(),directionalHint:f,directionalHintForRTL:l,calloutProps:i.assign(t,{onDismiss:this._onTooltipCallOutDismiss}),resources:g},i.getNativeProps(this.props,i.divProperties),m)))};t.prototype._getTargetElement=function(){var e=this.props.overflowMode;if(void 0!==e)switch(e){case s.TooltipOverflowMode.Parent:return this._tooltipHost.parentElement;case s.TooltipOverflowMode.Self:return this._tooltipHost}return this._tooltipHost};t.prototype._toggleTooltip=function(e){var t=this;this.setState({isTooltipVisible:e},function(){return t.props.onTooltipToggle&&t.props.onTooltipToggle(t.state.isTooltipVisible)})};t.defaultProps={delay:u.TooltipDelay.medium};return t})(i.BaseComponent);t.TooltipHost=a});
define("odsp-next/controls/tooltip/async/Tooltip",["require","exports","tslib","react","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AsyncTooltip=function(t){var a,f={load:function(t){return s.loadModuleExport({path:"office-ui-fabric-react/lib/Tooltip",getModule:function(){return i.default.resolve(new Promise(function(t,n){e(["office-ui-fabric-react/lib/Tooltip"],t,n)}))},getExport:function(e){return e.Tooltip}})},parse:void 0},l=t.resources;l&&(a=l.consume(u.bundleLoader.optional));var c={modulePath:"office-ui-fabric-react/lib/Tooltip",moduleLoader:f,customWaiter:a&&a.waitForPLT(),props:n.__assign({},t)};return r.createElement(o.ReactDeferredComponent,n.__assign({},c))}});
define("odsp-next/controls/list/react/detailsList/fields/ShareHeroCommandRenderer",["require","exports","react","knockout","../../../../../dataSources/url/QueryType","../../../../../utilities/features/Features","../../../../../utilities/browser/WebViewDetector","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/ShareHeroCommandRenderer","../../../../../resources/ControlResourceKeys","../../../../../controls/sharing/share/commands/ShareCommandKeys","../../../../../providers/engagement/Engagement","../../../../../resources/ProviderResourceKeys","../../../../tooltip/TooltipHost","../../../../../models/item/command/SocialItemCommandKeys","../../../../../actions/base/ItemCommandHelper","@ms/odsp-utilities/lib/resources/Resources","../../../../../controls/sharing/share/odc/Share.key","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=s.isFeatureEnabled(s.ShareV3),w=s.isFeatureEnabled(s.UseNewShareDialog)&&(!o.isOneDriveWinApp()||s.isFeatureEnabled(s.UseNewShareDialogForWinApp));t.shareHeroCommandRenderer=function(e){var t,s=e.item,o=e.itemSet,m=e.resources,E=e.isDisabled,S=s.mruState;t=!!y.Killswitch.isActivated("20603D17-F132-41AF-9391-969F8AD8CC5D","11/20/2019","Disables ShareHeroCommand in non-ItemsScope MRU; activate this KS to restore the command")&&(!S||S.canBeShared);var x=m.consume(v.resourceKey).isCommandSupported(s,d.share),T=o.context&&o.context.queryType===i.default.Files,N=s.parent&&s.parent.id||s.properties&&s.properties.listId,C=T||!(!N||!s.properties.path&&!s.key||!s.properties.ID&&!s.properties.uniqueId),k=s.lifeCycleStatus&&s.lifeCycleStatus.isMalwareDetected,L=x&&C&&t&&!(E||s.properties.isDisabled||k);return L?n.createElement(p.TooltipHost,{content:u.default.shareCommandOnHoverAriaLabel,resources:m},n.createElement(a.ShareHeroCommandRenderer,{isDisabled:!L,ariaLabel:u.default.shareCommandOnHoverAriaLabel,onClick:function(e){if(L){var t,n=m.consume(f.actionMap),i=new(m.injected(n.SelectAction))({item:r.observable(s),showProperties:!1});t=b?new(m.injected(n.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,overrideItem:s}):w&&!y.Killswitch.isActivated("7e18d766-4890-4cef-9c61-dd49d9eb28d7","06/04/2019","new hero share")?new(m.injected(n.ShowShareMultiItemAction))({focusItems:m.consume(g.shareResourceKey)}):new(m.injected(n.ShareByLinkAction))({sharingMethod:2});i.execute(e).then(function(){return t.execute(e)});var o=m.consume(c.resourceKey),u=m.consume(h.instrumentation.optional);o.logData({name:"ShareHeroCommand.Click",isIntentional:!0,currentPage:u&&u.currentPageName()||"NA",previousPage:u&&u.previousPageName()||"NA"})}}})):null};t.resourceKey=new m.ResourceKey({name:e("module").id,factory:new m.ConstantResourceFactory(t.shareHeroCommandRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/ShareHeroCommandRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareHeroCommandRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-shareHeroCommand",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"Share"}))}});
define("odsp-next/controls/list/react/detailsList/fields/ActivityRenderer",["require","exports","react","@ms/odsp-utilities/lib/resources/Resources","@uifabric/utilities/lib/css","../../../../itemActivityField/ItemActivityField","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.baseActivityRenderer=function(e){var t=e.item,r=e.isDisabled,o=void 0!==r&&r,u=t?s.getViewableItemActivity(t):void 0;return n.createElement("div",{className:i.css("od-FieldRenderer-text",{"od-FieldRenderer--disabled":t&&t.properties&&t.properties.isDisabled||o})},u?n.createElement(s.ItemActivityField,{activity:u}):null)};t.activityRenderer=t.baseActivityRenderer;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.activityRenderer)})});
define("odsp-next/controls/itemActivityField/ItemActivityField",["require","exports","react","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivities","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivity","@ms/shared-react-item-activity/lib/components/ItemActivities.resx"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivityField=function(e){return n.createElement(i.default,{activity:e.activity,isCompact:!0,hideDate:e.hideDate})};t.getViewableItemActivity=function(e){var t=e.activity;if(t){var n,r=(n=t.type,u[n]);return r?new r({activity:t,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!!e.folder,name:e.displayName,graphItemUrl:""},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}};var u=((o={})[0]=r.EditItemActivity,o[1]=r.MoveItemActivity,o[2]=r.CommentItemActivity,o[3]=r.CommentResponseItemActivity,o[4]=r.MentionItemActivity,o[5]=r.VersionItemActivity,o[6]=r.RestoreItemActivity,o[9]=r.RenameItemActivity,o[10]=r.DeleteItemActivity,o[11]=r.CreateItemActivity,o[12]=r.ShareItemActivity,o)});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivities",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivities",["require","exports","tslib","./ItemCommentReplies/ItemActivityCommentComponent","./ItemActivityMenu","react","@ms/odsp-utilities/lib/alternativeUrls/SPAlternativeUrls","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Link","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Utilities","../../ItemActivities.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function d(e){return e?1:3}var v=(function(){function e(e){var t=this;this._onRenderUser=function(e,n){var r=e.user;return t._getUserLabel(r,{stringOnly:!1,isAccusative:e.isAccusative})};this.activity=e.activity;this.currentUserEmail=e.currentUserEmail;this.containingItem=e.containingItem;this.isSingleLevel=e.isSingleLevel;this.canOpenItem=e.canOpenItem;this.onItemClick=e.onItemClick;this.strings=e.strings;this.onRenderUser=e.onRenderUser;this.currentListTitle=e.currentListTitle;this.currentRootTitle=e.currentRootTitle;this.defaultItemTitle=e.defaultItemTitle;this.commentListItem=e.commentListItem;this.isReadonly=e.isReadonly;this.canDeleteActivity=e.canDeleteActivity;this.activityMenuFunctions=e.activityMenuFunctions;this.isNewCommentExperienceEnabled=e.isNewCommentExperienceEnabled;this.isAtMentionEnabled=!!e.isAtMentionEnabled;this.environment=e.environment;this.getpersonaIconUrl=e.getpersonaIconUrl;this.displayLargeText=e.displayLargeText;this.isListItem=e.isSingleLevel&&"sharePointList"===e.environment}e.prototype.getKey=function(){return this.activity.id};e.prototype.getTitle=function(e){void 0===e&&(e={});return this.getDescription(e)};e.prototype.getDescription=function(e){void 0===e&&(e={});return[]};e.prototype.getIconName=function(){return"ActivityFeed"};e.prototype.getPersonaIconUrl=function(){};e.prototype.getDate=function(){return this.activity.time};e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime};e.prototype.getActivityTypeString=function(){return""};e.prototype.getResponse=function(){};e.prototype.getContextualMenu=function(e){};e.prototype.getenvironment=function(){return this.environment};e.prototype.getCommentAuthorName=function(){};e.prototype.getcommentAuthorEmail=function(){};e.prototype.getCommentThreadId=function(){};e.prototype._getFilteredActors=function(e){for(var t,n,r=e.actors,i=void 0===r?this.activity.actors||[]:r,s=e.isCompact,o=[],u=0,a=i;u<a.length;u++){var f=a[u];f&&f.self?t=f:o.push(f)}t&&(o=[t].concat(o));var l=d(s);o.length>l&&(n=o.slice(l,o.length));return{youUser:t,additionalUsers:n,sortedUsers:o.length?o:[void 0]}};e.prototype._getAdditionalUsersTooltip=function(e,t){var n=t.stringOnly,r=t.isCompact,i=t.hideDate,o=t.isAccusative,u=void 0!==o&&o,l=r&&i?u?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):u?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),c=a.formatToArray(l,e.length);if(n)return c;var h={onRenderContent:function(){var t=e.map(function(e){return s.createElement("li",null,e.displayName)});return s.createElement("ul",{className:"od-ItemActivity-otherActors"},t)}};return s.createElement(f.TooltipHost,{tooltipProps:h},c)};e.prototype.getRenderedUsers=function(e,t){var n=this,r=t.stringOnly,i=t.isAccusative,s=t.isActor;return e&&0!==e.length?e.map(function(e,t){return n.renderUser(e,{stringOnly:r,isAccusative:i,isActor:s},t)||""}):[this.renderUser(void 0)]};e.prototype.renderUser=function(e,t,n){void 0===n&&(n=0);var r=this.onRenderUser,i=void 0===r?this._onRenderUser:r,o=t.stringOnly,u=t.isAccusative,a=t.isActor,f=this._getUserLabel(e,{stringOnly:!0,isAccusative:u});if(!e||o)return f;var l=(a?"_actor":"_")+n;return s.createElement("span",{key:e.email+l,"aria-label":f},i({user:e,isAccusative:u},this._onRenderUser))};e.prototype.renderMainItemLink=function(e,t,n){return this.isSingleLevel?e:a.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:n}))};e.prototype.renderItemLink=function(e){var t=this,n=e.item,r=e.itemLabel,i=e.stringOnly,o=e.keyPrefix,u=void 0===o?"":o,a=r;a||(a=n&&n.isRoot?this._getRootFolderName():void 0);a||(a=n&&n.name?n.name:this._getDefaultItemName());if(a){if(i)return a;var f=void 0;if("string"==typeof a){f=a;var c=void 0,p=void 0;if(-1!==a.indexOf(".")){var d=a.split(".");c=d.slice(0,-1).join();p=d.slice(-1).join()}else{c=a;p=""}c.length>40&&(a=c.slice(0,37).concat("...").concat(p))}var v=a;if(this.canOpenItem&&this.canOpenItem(n)){var m=void 0;m=f?s.createElement("span",{className:"od-ItemActivity-item-textContent}",title:f}," ",a," "):s.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",a," ");return s.createElement(l.Link,{key:u+"_"+v+"_link",className:h.css("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(n,t.getActivityTypeString())},href:"javascript:void(0)"},m)}return f?s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText",title:f},a):s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText"},a)}};e.prototype._getRootFolderName=function(){return this.currentRootTitle};e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0};e.prototype._getUserLabel=function(e,t){var n,r=t.stringOnly,i=t.isAccusative;n=e&&e.self?i?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase;return r?n:s.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};return e})();t.BaseItemActivity=v;var m=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.editThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f=this.renderMainItemLink(o,this.strings.editArbitraryFile,i),l=this._getFilteredActors({isCompact:r}),c=l.youUser,h=l.sortedUsers,p=l.additionalUsers,v=d(r);if(h.length>v){var m=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return a.formatToArray.apply(a,n.__spreadArrays([m,f],this.getRenderedUsers(h.slice(0,v),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(p,{stringOnly:i,isCompact:r,hideDate:s})]))}var g=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListForm:this.strings.othersEditedListForm;u=a.getLocalizedCountValue(g,r?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,h.length);return a.formatToArray.apply(a,n.__spreadArrays([u,f],this.getRenderedUsers(h,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Edit"};t.prototype.getActivityTypeString=function(){return"edit"};return t})(v);t.EditItemActivity=m;var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,i),o=this._getFilteredActors({isCompact:r}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:i,isActor:!0});if(!r&&this.activity.action&&this.activity.action.move){var l=this.activity.action.move;if(l.from&&l.to){var c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder;return a.formatToArray(t,s,f,c,h)}if(l.from){c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder;return a.formatToArray(t,s,f,c)}if(l.to){h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedToFolder:this.strings.otherMovedToFolder;return a.formatToArray(t,s,f,void 0,h)}}t=r?!this.isNewCommentExperienceEnabled&&u?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youMoved:this.strings.otherMoved;return a.formatToArray(t,s,f)};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"move"};return t})(v);t.MoveItemActivity=g;var y=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.commentedOnThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f,l=this.renderMainItemLink(o,this.strings.commentedOnArbitraryFile,i),c=this._getFilteredActors({isCompact:r}),h=c.youUser,p=c.sortedUsers,v=c.additionalUsers,m=d(r),g=this._isOnFileComment();if(g&&p.length<=1){var y=void 0;if(r)u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var b=this._getCommentMessage(i);if(this.isSingleLevel&&b){y=b;u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile}else{y=l;u=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile}}f=a.formatToArray.apply(a,n.__spreadArrays([u,y],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}else if(p.length>m){var w=r?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&h?g?this.strings.youCommentedCountFormOnItem:this.strings.youCommentedCountForm:g?this.strings.othersCommentedCountFormOnItem:this.strings.othersCommentedCountForm;f=a.formatToArray.apply(a,n.__spreadArrays([w,l],this.getRenderedUsers(p.slice(0,m),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(v,{stringOnly:i,isCompact:r,hideDate:s})]))}else{var E=r?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&h?g?this.strings.youCommentedListFormOnItem:this.strings.youCommentedListForm:g?this.strings.othersCommentedListFormOnItem:this.strings.othersCommentedListForm;u=a.getLocalizedCountValue(E,r?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,p.length);f=a.formatToArray.apply(a,n.__spreadArrays([u,l],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}return f};t.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var e=this._getCommentDetail();return this.commentListItem&&e?void 0:"Chat"}return this.commentListItem?void 0:"Chat"};t.prototype.getPersonaIconUrl=function(){var e=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var t=this.commentListItem&&e&&e.author.email,n=u.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=s&accountname="+t:o.getUserPhotoUrl(t);return t&&n||void 0}var r=this.commentListItem&&e&&e.author.id;return r&&this.getpersonaIconUrl(r)||void 0};t.prototype.getActivityTypeString=function(){return"comment"};t.prototype.getContextualMenu=function(e){var t=this,n=[],r=this.activityMenuFunctions&&this.activityMenuFunctions.delete,o=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&r&&this.commentListItem&&o&&!this.isReadonly){var u={key:"od-itemActivity.deleteComment"+o,name:p.default.activityMenuOptionDelete,dialogTitle:p.default.deleteCommentDialogTitle,dialogOnConfirm:function(){return r(t.commentListItem.activityItemWrapper,t.currentUserEmail,{commentItem:t.commentListItem,commentId:o})}};n.push(u)}if(n.length)return s.createElement(i.default,{itemActivityMenuItems:n,activityId:this.activity.id,isVisible:e,environment:this.environment})};t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),n=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(n||!this.isReadonly))return s.createElement(r.default,{key:this.containingItem.graphItemUrl+"_"+t.id,parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})};t.prototype.getCommentAuthorName=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.displayName};t.prototype.getcommentAuthorEmail=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.email};t.prototype.getCommentThreadId=function(){return this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId};t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text)return e?t.text:!0===this.isNewCommentExperienceEnabled&&this.displayLargeText&&!this.isAtMentionEnabled?s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent"},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:t.text})):s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text}})};t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail};t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)};return t})(v);t.CommentItemActivity=y;var b=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.activity.action.commentResponse,u=this._getFilteredActors({isCompact:r}),f=u.youUser,l=u.sortedUsers,c=u.additionalUsers,h=d(r),p=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:i});if(o&&o.commentAuthor){var v=o.commentAuthor.self,m=this.renderUser(o.commentAuthor,{stringOnly:i,isAccusative:!0}),g=void 0;if(l.length>h){g=v?r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var y=n.__spreadArrays([m],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]);r||y.unshift(p);return a.formatToArray.apply(a,n.__spreadArrays([g],y))}var b=void 0;b=v?r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm;g=a.getLocalizedCountValue(b,r?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);y=n.__spreadArrays([m],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}));r||y.unshift(p);return a.formatToArray.apply(a,n.__spreadArrays([g],y))}g=void 0;if(l.length>h){g=r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm;return a.formatToArray.apply(a,n.__spreadArrays([g,p],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]))}b=r?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;g=a.getLocalizedCountValue(b,r?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);return a.formatToArray.apply(a,n.__spreadArrays([g,p],this.getRenderedUsers(l,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Reply"};t.prototype.getActivityTypeString=function(){return"commentResponse"};return t})(v);t.CommentResponseItemActivity=b;var w=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,r=void 0===e?{}:e,i=r.isCompact,s=r.stringOnly,o=r.hideDate,u=this.renderMainItemLink(this.strings.mentionedThisFile,this.strings.mentionArbitraryFile,s),f=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:i}),l=this.getRenderedUsers(f.sortedUsers,{stringOnly:s}),c=f.youUser,h=f.additionalUsers,p=this._getFilteredActors({isCompact:i}),v=p.youUser,m=p.sortedUsers,g=d(i);if(l.length>g){var y;y=c?i?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:i?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm;return a.formatToArray.apply(a,n.__spreadArrays([y,u],this.getRenderedUsers(m,{stringOnly:s,isActor:!0}),l.slice(0,g),[this._getAdditionalUsersTooltip(h,{stringOnly:s,isCompact:i,hideDate:o})]))}var b=void 0;b=c?i?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:i?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm;t=a.getLocalizedCountValue(b,i?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,l.length);return a.formatToArray.apply(a,n.__spreadArrays([t,u],this.getRenderedUsers(m,{stringOnly:s,isActor:!0}),l.slice(0,g)))};t.prototype.getIconName=function(){return"Accounts"};t.prototype.getActivityTypeString=function(){return"mention"};return t})(v);t.MentionItemActivity=w;var E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var i=this._getFilteredActors({isCompact:n}),s=i.youUser,o=this.renderUser(i.sortedUsers[0],{stringOnly:r,isActor:!0}),u=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&s?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,f=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,r),l=this.activity.action.version.newVersion;return a.formatToArray(u,f,o,l)}return[]};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"version"};return t})(v);t.VersionItemActivity=E;var S=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=(t.isCompact,t.stringOnly),r=this.strings.restoreThisFile;this.isListItem&&(r=this.strings.thisItem);var i=this.renderMainItemLink(r,this.strings.restoreArbitraryFile,n),s=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return a.formatToArray(s,i)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(v);t.RestoreItemActivity=S;var x=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this._getFilteredActors({isCompact:r}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:i,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var f=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:i,keyPrefix:"old"}),l=this.renderItemLink({item:this.activity.item,stringOnly:i});t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile;return a.formatToArray(t,u,f,l)}var c=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,i);t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFile:this.strings.otherRenamedFile;return a.formatToArray(t,u,c)};t.prototype.getIconName=function(){return"Rename"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(v);t.RenameItemActivity=x;var T=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.deleteThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.deleteArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return a.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&u?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:l;return c?a.formatToArray(l,s,f,c):a.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Trash"};t.prototype.getActivityTypeString=function(){return"delete"};return t})(v);t.DeleteItemActivity=T;var N=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.createThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.createArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),u=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return a.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&u?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:l;return c?a.formatToArray(l,s,f,c):a.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Add"};t.prototype.getActivityTypeString=function(){return"create"};return t})(v);t.CreateItemActivity=N;var C=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,r=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.shareThisFile;this.isListItem&&(o=this.strings.thisItem);var u,f=this.renderMainItemLink(o,this.strings.shareArbitraryFile,i),l=this._getFilteredActors({isCompact:r}),c=l.youUser,h=this.renderUser(l.sortedUsers[0],{stringOnly:i,isActor:!0}),p=this.activity.action.share.recipients;if(p&&p.length>0){var v=this._getFilteredActors({actors:p,isCompact:r}),m=v.sortedUsers,g=v.youUser,y=v.additionalUsers,b=d(r);if(m.length>b){var w;w=g?r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm;return a.formatToArray.apply(a,n.__spreadArrays([w,f,h],this.getRenderedUsers(m.slice(0,b),{stringOnly:i,isAccusative:!0}),[this._getAdditionalUsersTooltip(y,{stringOnly:i,isCompact:r,hideDate:s,isAccusative:!0})]))}var E=void 0;E=g?r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var S=a.getLocalizedCountValue(E,r?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,m.length);return a.formatToArray.apply(a,n.__spreadArrays([S,f,h],this.getRenderedUsers(m,{stringOnly:i,isAccusative:!0})))}u=r?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedShort:this.strings.otherSharedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youShared:this.strings.otherShared;return a.formatToArray(u,f,h)};t.prototype.getIconName=function(){return"Share"};t.prototype.getActivityTypeString=function(){return"share"};return t})(v);t.ShareItemActivity=C;var k=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,l=this.activity.action&&this.activity.action.pointInTimeRestore,h=l&&l.restoreToDateTime;return a.formatToArray(f,u,i,c.getRelativeDateTimeStringPast(h))};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"};return t})(v);t.PointInTimeRestoreActivity=k;var L=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,u=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,l=this.activity.action&&this.activity.action.restoreVersion,c=l&&l.fromVersion;return a.formatToArray(f,u,i,c)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restoreVesion"};return t})(v);t.RestoreVersionActivity=L});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemCommentReplies/ItemActivityCommentComponent",["require","exports","tslib","react","prop-types","@ms/odsp-utilities/lib/alternativeUrls/SPAlternativeUrls","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Link","../../../AddCommentTextField/AddCommentTextField","../../../ItemActivities.resx","./ItemCommentReply","office-ui-fabric-react/lib/Utilities","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._onFocus=function(){i._focusZone&&i._focusZone.focus()};i._onRenderCell=function(e,t){var n=i.props.onRenderUser,s=i.state,o=s.currentReplies,u=s.numberOfRepliesDisplayed,a=o.comments.length||0,f=u<=a&&a-u||0,l=new g({reply:e,onRenderUser:n});if(e&&t>=f)return r.createElement(d.default,{key:l.getKey(),reply:l,additionalClass:"od-ItemActivityList-commentReply"})};i._onSend=function(e,t,n){var r=i.props,s=r.parentComment,o=r.commentListItem,u=r.currentUserEmail;i._store&&i._store.addItemCommentReply({itemWrapper:o,currentUserEmail:u},s.id,e).then(function(e){i._store.fetchItemCommentReplies({itemWrapper:o,currentUserEmail:u,startIndex:0},s.id);t&&t()},function(e){var t=e&&e.message&&e.message.value;n&&n(t)})};i._onShowMore=function(){var e=i.props,t=e.onShowMore,n=e.parentComment,r=e.commentListItem,s=e.currentUserEmail,o=i.state.currentReplies,u=i.state.numberOfRepliesDisplayed;if(u<o.comments.length){i.setState({numberOfRepliesDisplayed:10*Math.floor(u/10)+10});o.nextLink&&i._store.fetchItemCommentReplies({itemWrapper:r,currentUserEmail:s},n.id)}t&&t()};i._store=n.itemCommentsStore;i._engagementSource=n.engagementSource||"";var s=t.parentComment,o=t.commentListItem,u=t.currentUserEmail;i._environment=t.environment;var a=i._store.getItemCommentReplies({itemWrapper:o,currentUserEmail:u},s.id),f=a&&a.comments&&a.comments.length,l=f?2:0;i.state={numberOfRepliesDisplayed:l,currentReplies:a,hasMore:l<f};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)};t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0};t.prototype.render=function(){var e=this.props,t=e.isReadonly,n=e.parentComment,i=this.state.currentReplies.comments||[],s=i.map(function(e){try{return e.action.comment.commentDetail}catch(e){}}),o="sharePointList"===this._environment,u="consumer"===this._environment;return r.createElement("div",{"data-is-focusable":!u&&!o,key:"activityResponse_"+n.id,onFocus:this._onFocus,"aria-label":p.default.activityCommentRepliesList,"aria-hidden":u||o},r.createElement(a.FocusZone,{componentRef:this._resolveRef("_focusZone"),className:v.css("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":u||o}),direction:a.FocusZoneDirection.vertical,isCircularNavigation:!1,handleTabKey:a.FocusZoneTabbableElements.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===f.getRTLSafeKeyCode(f.KeyCodes.right)}},this._getShowMoreLink(),i&&i.length>0&&r.createElement(l.List,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:s,onRenderCell:this._onRenderCell}),!t&&!u&&!o&&r.createElement(h.default,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:n&&n.id,placeholderText:p.default.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))};t.prototype._addListener=function(){var e=this,t=this.props,n=t.parentComment,r=t.commentListItem,i=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:r,currentUserEmail:i},n.id),s=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:s>2?e.state.numberOfRepliesDisplayed:s,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:r.activityItemWrapper,currentUserEmail:i},n.id)};t.prototype._getShowMoreLink=function(){this.props.parentComment;var e,t=this.state,n=t.currentReplies;if(t.numberOfRepliesDisplayed<(null===(e=n.comments)||void 0===e?void 0:e.length)||n.nextLink)return r.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},r.createElement(c.Link,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},p.default.commentRepliesGetMore))};t.contextTypes={itemCommentsStore:i.any,engagementSource:i.any};return t})(f.BaseComponent);t.default=m;var g=(function(){function e(e){var t=this;this._renderUser=function(e,n){var r=e.user;r||(r=t._getReplyAuthor());return t._renderUserLabel(r,{stringOnly:!1})};this._commentReply=e.reply;this._onRenderUser=e.onRenderUser}e.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id};e.prototype.getPersonaImgUrl=function(){var e=this._commentReply.author;return o.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=S&accountname="+e.email:s.getUserPhotoUrl(e.email)};e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime};e.prototype.getDate=function(){return this._commentReply.createdDate};e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,n=this._commentReply.text,i=this._getReplyAuthor(),s=this.renderUser(i,{stringOnly:t}),o=t?n:r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:n}});return i.self?u.formatToArray(p.default.youReplied,o):u.formatToArray(p.default.otherReplied,o,s)};e.prototype.renderUser=function(e,t){var n=t.stringOnly,i=this._renderUserLabel(e,{stringOnly:!0});return!e||n?i:r.createElement("span",{"aria-label":i},this._onRenderUser({user:e},this._renderUser))};e.prototype._renderUserLabel=function(e,t){var n,i=t.stringOnly;n=e&&e.self?p.default.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:p.default.someoneUpperCase;return i?n:r.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};e.prototype._getReplyAuthor=function(){return this._commentReply.author};return e})();t.ItemCommentReplyModel=g});
define("@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","./AddCommentTextField.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._textField=r.createRef();n.COMMENT_TEXT_MAX_LENGTH=2e3;n.charLimitExceededMessage="Maximum character limit exceeded";n._onSend=function(){var e=n.props,t=e.onSend,r=e.engagementSource,i=e.engagementExtraData,s=n.state.text;if(s&&t){n.setState({sending:!0,errorMessage:"",successMessage:""});t(s,function(){n._onClearTextField();n.setState({successMessage:f.default.CommentAdded})},function(e){n.setState({sending:!1,errorMessage:e})});var o=r?r+".":"AddCommentTextField.";l.Engagement.logData({name:o+"Send.Click",isIntentional:!0,extraData:i})}};n._onClearTextField=function(){n.setState(n._getResetState(),function(){n._textField&&n._textField.current&&n._textField.current.focus()})};n._onTextFieldChange=function(e,t){!t||t.length<=n.COMMENT_TEXT_MAX_LENGTH?n.setState({text:t||"",errorMessage:"",enableSendButton:!(!t||!t.trim())}):n.setState({text:n.state.text,errorMessage:n.charLimitExceededMessage,enableSendButton:!1})};n._onKeyDown=function(e){e.which===i.KeyCodes.enter&&n.state.enableSendButton&&n._onSend()};n.state=n._getResetState();return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId===this.props.commentItemId&&e.disabled===this.props.disabled||this.setState(n.__assign(n.__assign({},this._getResetState()),{errorMessage:"",successMessage:""}))};t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._textField.current&&this._textField.current.focus()};t.prototype.render=function(){var e=this.props,t=e.overrideStyleName,s=(e.engagementSource,e.commentItemId,e.enableNewCommentingExperience);return r.createElement("div",{className:i.css({"od-addCommentTextField":!s},{"od-addNewCommentTextField":s},t)},r.createElement(o.TextField,n.__assign({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:i.css({"od-addCommentTextField-screenReaderOnly":!s},{"od-addNewCommentTextField-screenReaderOnly":s}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage))};t.prototype._getTextFieldProps=function(){var e=this,t=this.props,n=t.placeholderText,r=t.disabled,s=t.enableNewCommentingExperience,o=this.state,u=o.sending,a=o.text,f=o.errorMessage;return{className:i.css({"od-addCommentTextField-input":!s},{"od-addNewCommentTextField-input":s},{"od-addNewCommentTextField-disabled":s&&r}),placeholder:n,onChange:this._onTextFieldChange,value:a||"",disabled:r||u,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:f,autoAdjustHeight:s&&a.length>0,multiline:s&&a.length>0,rows:1,resizable:!1,onRenderSuffix:function(t){return e._onRenderSuffix()},ariaLabel:n}};t.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&r.createElement(r.Fragment,null,this._getSendButton()):r.createElement(r.Fragment,null,this._getCancelButton(),this._getSendButton())};t.prototype._getCancelButton=function(){this.props.enableNewCommentingExperience;return r.createElement(a.TooltipHost,{content:f.default.cancelLabel,styles:{root:{display:"inline-block"}},directionalHint:a.DirectionalHint.bottomAutoEdge},r.createElement(u.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:f.default.cancelLabel,onClick:this._onClearTextField}))};t.prototype._getSendButton=function(){var e=this.props,t=e.sendButtonTitle,n=e.enableNewCommentingExperience;return this.state.sending?r.createElement("div",{className:i.css({"od-addCommentTextField-spinner":!n},{"od-addNewCommentTextField-spinner":n})},r.createElement(s.Spinner,{size:s.SpinnerSize.small})):r.createElement(a.TooltipHost,{content:f.default.sendLabel||t,styles:{root:{display:"inline-block"}},directionalHint:a.DirectionalHint.bottomAutoEdge},r.createElement(u.IconButton,{className:i.css({"od-addCommentTextField-sendButton":!n},{"od-addNewCommentTextField-sendButton":n}),iconProps:{iconName:"Send"},ariaLabel:f.default.sendLabel||t,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton}))};t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:""}};return t})(i.BaseComponent);t.default=c});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemCommentReplies/ItemCommentReply",["require","exports","tslib","react","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem","office-ui-fabric-react/lib/FocusZone","@ms/odsp-utilities/lib/dateTime/DateTime","ODCDeferred_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())};t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null};t._onRenderHiddenTimeStamp=function(e,t){return null};return t}t.prototype.render=function(){var e=this.props,t=e.reply,n=e.hideDate,o=e.additionalClass,u=void 0===o?"":o;return r.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},r.createElement(i.ActivityItem,{key:t.getKey(),className:"od-ItemActivity-item "+u,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:n?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))};t.prototype._onRenderDate=function(){var e=this.props.reply;return(o.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||o.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]};return t})(r.Component);t.default=u});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivityMenu",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../ItemActivities.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={root:{display:"inline-block",verticalAlign:"top"}},h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismissDialog=function(){r.setState({hideDialog:!0})};r.state={dialogTitle:"",onDialogConfirm:void 0,hideDialog:!0,holdMenuButton:!1};return r}t.prototype.render=function(){var e=this,t=this.state,n=t.dialogTitle,f=t.onDialogConfirm,h=t.hideDialog,p=t.holdMenuButton,d=this.props,v=d.isVisible,m=d.environment,g=this._getMenuItems(),y="sharePointList"===m,b="consumer"===m;if(g)return r.createElement(r.Fragment,null,r.createElement(s.TooltipHost,{content:l.default.activityMenuAriaLabel,styles:c},r.createElement(i.IconButton,{className:a.css("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":(b||y)&&!(v||p)}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},ariaLabel:l.default.activityMenuAriaLabel,menuProps:{directionalHint:u.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:g,styles:{root:y?"spo-ItemActivity-menuItems":"od-ItemActivity-menuItems"}},onMenuClick:function(){e.setState({holdMenuButton:!0})},onAfterMenuDismiss:function(){e.setState({holdMenuButton:!1})}})),r.createElement(o.Dialog,{hidden:h,onDismiss:this._onDismissDialog,dialogContentProps:{type:o.DialogType.normal,title:n}},r.createElement(o.DialogFooter,null,r.createElement(i.DefaultButton,{className:a.css({"od-itemActivityMenu-dialogButton-default":b||y}),disabled:!1,onClick:function(){f();e._onDismissDialog()},text:l.default.activityMenuDialogConfirm}),r.createElement(i.DefaultButton,{className:a.css({"od-itemActivityMenu-dialogButton-primary":b||y}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:l.default.activityMenuDialogCancel}))))};t.prototype._getMenuItems=function(){var e=this,t=this.props,n=t.itemActivityMenuItems,r=t.activityId;return n.map(function(t){return{key:t.key,name:t.name,onClick:function(n,i){var s=t.dialogOnConfirm;t.dialogTitle&&s?e.setState({dialogTitle:t.dialogTitle,onDialogConfirm:s,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(n,i);f.Engagement.logData({name:"ActivityItemMenu."+t.name+".Click",isIntentional:!0,extraData:{activityId:r}})}}})};return t})(r.Component);t.default=h});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivity",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity",["require","exports","tslib","react","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.styles","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.classNames","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Utilities","@ms/odsp-datasources/lib/providers/theming/FluentFeatures","office-ui-fabric-react/lib/Persona","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;i.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;i.multipleSpacesRegex=/\s+/gi;i._onRenderIcon=function(){var e=i.props.activity.getIconName();return r.createElement(u.Icon,{iconName:e})};i._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},i.props.activity.getTitle({isCompact:i.props.isCompact,hideDate:i.props.hideDate}))};i._onRenderActivityTimeStamp=function(e,t){if(i.props.isCompact){var n=s.getStyles(void 0,void 0),u=o.getClassNames(n,e.className,e.activityPersonas,e.isCompact);return r.createElement("div",{className:c.css(u.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null};i._onRenderHiddenTimeStamp=function(e,t){return null};i._onRenderActivityDescription=i._onRenderActivityDescription.bind(i);i._onRenderIcon=i._onRenderIcon.bind(i);i.state={isMouseOver:!1,hasFocus:!1,isFirstLoad:!0};i._focusedActivity=null;return i}t.prototype.componentDidMount=function(){this.props.isFocusedOnFirstLoad&&this._focusedActivity&&this._focusedActivity.focus()};t.prototype.componentDidUpdate=function(){this.props.isFocusedOnFirstLoad&&this._focusedActivity&&this._focusedActivity.focus()};t.prototype.render=function(){var e=this,t=this.props,n=t.activity,s=t.isCompact,o=t.hideDate,u=t.isInGrid,l=t.isNewCommentExperienceEnabled,p=this.state,d=p.isFirstLoad,v=p.isMouseOver,m=p.hasFocus,g=n.getIconName(),y=h.isFluentActiveOD||h.EnableFluentTheme?{root:{color:f.getTheme().palette.neutralDark},activityTypeIcon:{color:f.getTheme().palette.themePrimary,height:"16px",marginTop:"8px"}}:void 0,b=n.getResponse(),w=n.getContextualMenu(!l||v||m);return r.createElement(a.FocusZone,{className:"od-ItemActivity-item-focusZone",direction:a.FocusZoneDirection.horizontal,handleTabKey:a.FocusZoneTabbableElements.all,"data-is-focusable":!0,"aria-label":this._getAriaLabel(),role:u?"row":void 0,onMouseOver:l?function(){e._onMouseOver()}:void 0,onMouseLeave:l?function(){e._onMouseOut()}:void 0,onFocusNotification:l?function(){e._onFocus()}:void 0,onBlur:function(){e._onBlur()},allowFocusRoot:!0,ref:function(t){return e._focusedActivity=d?t:null}},r.createElement("div",{role:u?"gridcell":void 0,key:"activity_"+n.getKey(),className:c.css({"od-ItemActivityList-activity-withCommentResponse":!!b},"od-ItemActivityList-activity")},r.createElement(i.ActivityItem,{key:n.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:g&&this._onRenderIcon||void 0,activityPersonas:this._getPersonaProperties(),timeStamp:this._onRenderDate(),onRenderTimeStamp:o?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:s,styles:y})),w,b)};t.prototype._onRenderDate=function(){var e=this.props.activity;return(l.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||l.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.activity.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._onMouseOver=function(){this.setState({isMouseOver:!0})};t.prototype._onMouseOut=function(){this.setState({isMouseOver:!1})};t.prototype._onFocus=function(){this.setState({hasFocus:!0})};t.prototype._onBlur=function(){this.setState({hasFocus:!1});this.setState({isFirstLoad:!1})};t.prototype._getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype._getPersonaProperties=function(){var e=this.props,t=e.activity,n=e.isNewCommentExperienceEnabled,i=t.getCommentAuthorName(),s=t.getcommentAuthorEmail(),o=i||s,u=this._getInitial(o),a=t.getPersonaIconUrl(),f={imageUrl:a},l={imageInitials:u,initialsColor:p.getPersonaInitialsColor({text:o}),onRenderInitials:function(){return r.createElement("div",{className:"od-ItemActivity-persona"},u,r.createElement("img",{className:"od-ItemActivity-personaIcon",src:a}))}};return n?[l]:[f]};return t})(r.Component);t.default=d});
define("odsp-next/controls/list/react/detailsList/fields/ClientSideCustomRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clientSideCustomRenderer=function(e){var t=e.item,n=e.column,s=t.properties[n.key],u=i.getAriaLabel(n,s),a=n.clientSideColumnAdapter;if(a&&a.fieldCustomizerLoaded&&a.renderCell)try{var f=a.listViewAdapter;if(f){var l={values:t.properties},c=f.createRowAdapter(l);if(c)return r.createElement(o,{ariaLabel:u,title:s,columnAdapter:a,rowAdapter:c});console.log("Could not create row adapter for column: "+n.internalName)}}catch(e){console.log("Error in using clientSideCustomRenderer, error: "+e)}return r.createElement("div",{title:s,"aria-label":u},s)};var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement("div",{ref:function(t){return e._div=t}})};t.prototype.componentDidMount=function(){var e=document.createElement("DIV");this._div.appendChild(e);this.forceUpdate()};t.prototype.componentWillUnmount=function(){this._cellAdapter&&this._cellAdapter.dispose()};t.prototype.componentDidUpdate=function(e){this._cellAdapter=this.props.columnAdapter.renderCell(this.props.rowAdapter,this._div)};return t})(r.Component);t.resourceKey=new s.ResourceKey({name:e("module").id,factory:new s.ConstantResourceFactory(t.clientSideCustomRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/FileActivityRenderer",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-list-utilities/lib/Renderers/BaseText","./BaseText","../ReactDetailsList.resx","../../../../../utilities/features/Features","./UserRenderer","@ms/odsp-utilities/lib/resources/Resources","../../../../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=u.isFeatureEnabled(u.PeopleCardsOnLoki),h=u.isFeatureEnabled(u.PeopleCardsReactComponent);t.fileActivityRenderer=function(e){var t=e.item,u=e.column,f=e.isDisabled,p=e.resources,d=t.properties.editorName,v=d&&d.length?d[0]:void 0,m=s.getCellText(t,u),g=v?s.getAriaLabel(u,v.title):"",y=p.consume(l.resourceKey);if(!v)return n.createElement(i.BaseText,{text:m,isDisabled:t.properties.isDisabled||f,ariaLabel:g});a.loadPeopleCardComponent(p);var b=a.generatePeopleCardState([v],p),w="od-FieldRender od-FieldRender-nofill ms-fontWeight-semibold od-FieldRender-userActivity";(c||h)&&(w+=" od-FieldRender-person");y&&(w+=" od-FieldRender-userFluent");var E=a.getUserComponent({resources:p,user:v,ariaLabel:g,cellClassName:w,state:b}),S=r.formatToArray(o.default.fileActivityContent,E,t.dateModified);return n.createElement("div",{className:"od-FieldRender-activity"},S)};t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ConstantResourceFactory(t.fileActivityRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/NameAndPathRenderer",["require","exports","react","@ms/odsp-list-utilities/lib/Renderers/PathRenderer","@ms/odsp-utilities/lib/resources/Resources","./NameFieldAddOnHelper","./NameRenderer","../../../../../dataSources/url/odb/ItemUrlHelper","../../../../../providers/engagement/Engagement","../../../../../utilities/browser/WebViewDetector","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathRenderer=function(e){var t=e.item,i=e.resources,l=i.consume(a.resourceKey),c=i.consume(u.resourceKey).getItemUrlParts(t.key),h={displayPathSegments:t.displayPath&&t.displayPath.segments||[t.displayName],parentLink:t.parentLink,target:"_blank",onClick:function(e){l.logData({name:"MruRecent.FileLocation.Click",isIntentional:!0})}};!f.isOneDriveWinApp()||c.isCrossDomain||c.isCrossList||(h.target="_self");var p=o.signaledNameRendererWithHovercard(e,{inlineCommandCount:0}),d=r.PathRenderer(h),v=n.createElement(n.Fragment,null,n.createElement("div",null,p),n.createElement("div",null,d));return s.nameFieldBuildAddOn({fieldRenderer:v,fieldRendererProps:e,addHeroCommands:!0})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.nameAndPathRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/PathRenderer",["require","exports","@ms/items-view/lib/private/components/fields/path/PathField"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PathRenderer=n.PathField;t.createDisplayPathElement=n.createDisplayPathElement;t.getDisplayPathElements=n.getDisplayPathElements;t.createDisplayPathSeparator=n.createDisplayPathSeparator});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldAddOnHelper",["require","exports","tslib","react","./NameFieldMetadataRenderer","./NameFieldHeroCommandRenderer","../../../../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var a=((u={})[o.default.Files]=s.createHeroCommandsSectionFilesList,u[o.default.Recent]=s.createHeroCommandsSectionRecentList,u.default=s.createHeroCommandsSectionList,u);t.COMMAND_BUTTON_WIDTH=36;t.nameFieldBuildAddOn=function(e){var t=e.fieldRenderer,s=e.addHeroCommands,o=e.addMetadata,u=e.fieldRendererProps,a=e.optionalRendererClass,l=void 0===a?"":a,c=e.teachingBubble,h=u.item;if(!s&&!o)return t;var p=s&&f(h.queryType,u)||void 0,d=o&&r.createElement(i.nameFieldMetadataRenderer,n.__assign({},e.fieldRendererProps))||void 0,v=o?"od-FieldRenderer-nameFieldReponsive":"",m=d?[t,d]:[t];return r.createElement("div",{className:"od-FieldRenderer-Renderer-withCommandAndMetata "+v},r.createElement("div",{className:"od-FieldRenderer-Renderer-withMetadata "+l},c?c(h,u.resources,m):m),p,d)};function f(e,t){return(a[e]||a.default)(t)}t.getHeroCommands=f;t.getHeroCommandsLength=function(e,t){var n=f(e,t),i=n&&n.props&&n.props.children;return r.Children.count(i)}});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldMetadataRenderer",["require","exports","react","office-ui-fabric-react/lib/Icon","../../../../../models/item/SharingType","@ms/odsp-utilities/lib/resources/Resources","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameFieldMetadataRenderer=function(e){var t=e.item;return n.createElement("div",{className:"od-FieldRenderer-NameField-resopnsive-additionalInfo"},n.createElement("span",{className:"od-FieldRenderer-NameField-additionalInfo-modDate"},t.dateModified),n.createElement("span",{className:"od-FieldRenderer-NameField-additionalInfo-sharedStatus"},(function(e){var t=!1,s=e.properties&&e.properties.PrincipalCount;if(s)t=Number(s)>0;else{var o=e&&e.sharingType;t=o===i.default.Shared||o===i.default.Public||o===i.default.PublicUnlisted}return t?n.createElement(r.Icon,{iconName:"People"}):void 0})(t)))};t.resourceKey=new s.ResourceKey({name:e("module").id,factory:new s.ConstantResourceFactory(t.nameFieldMetadataRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/NameRenderer",["require","exports","tslib","react","../../../../../resources/DataSourceResourceKeys","./BaseText","@ms/odsp-list-utilities/lib/Renderers/NameRenderer","@ms/odsp-utilities/lib/async/Promise","../../../../../utilities/features/Features","../ReactDetailsList.resx","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","../../../../../models/item/LifeCycleStatus","@uifabric/experiments/lib/components/signals/Signals","@ms/odsp-utilities/lib/resources/Resources","../../../../../dataSources/url/QueryType","./NameFieldAddOnHelper","../../../../../utilities/delayLoading/DelayLoadingHelper","office-ui-fabric-react/lib/common/DirectionalHint","../../../../../providers/bundleLoader/PageLoadMonitor","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=a.isFeatureEnabled(a.EnableResponsiveFilesListView);t.baseNameRenderer=function(e,t){var n=e.item,i=e.column,u=e.itemSet,a=e.onItemInvoked,f=e.resources,l=e.isDisabled,c="LinkIssueIDNoMenu"===i.internalName&&"IssueID"===i.realFieldName&&n.properties?n.properties.ID:(n?n[i.key]||n.properties[i.key]:null)||"",h=T({item:n,resources:f,itemSet:u}),p=a&&function(e){a(n,null,e)};return r.createElement(o.NameRenderer,{linkUrl:h,linkText:c,onClick:p,isDisabled:n.properties.isDisabled||l,disableTooltip:t,ariaLabel:s.getAriaLabel(i,c)})};var E=(function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.render=function(){var e=this.props.item,n=t.baseNameRenderer(this.props,!1);if(e.lifeCycleStatus){var i=h.getStatusToDisplay(e.lifeCycleStatus),s=(function(e){switch(e){case 4:return r.createElement(p.ATPSignal,{ariaLabel:f.default.lifeCycleSignalMalwareDetected});case 3:return r.createElement(p.TrendingSignal,{ariaLabel:f.default.lifeCycleSignalTrending});case 2:return r.createElement(p.NewSignal,{ariaLabel:f.default.lifeCycleSignalNew,title:f.default.lifeCycleSignalNewTooltip});case 1:return r.createElement(p.ExternalSignal,{ariaLabel:f.default.lifeCycleSignalExternal,title:f.default.externalItemTitle});default:return null}})(i),o=2===i;n=r.createElement(p.SignalField,{className:"od-FieldRenderer-NameRenderer-SignalField",before:o&&s,after:!o&&s},n)}return n};return i})(r.PureComponent);t.SignaledNameRenderer=E;t.signaledNameRendererWithHovercard=function(e,i){return i.addHeroCommands?t.nameRendererWithAddOns(e):r.createElement(E,n.__assign({},e))};t.nameRendererWithAddOns=function(e){var t=e.item,i=e.column,s=r.createElement(E,n.__assign({},e)),o=w&&t.queryType===v.default.Files;return s=m.nameFieldBuildAddOn({fieldRenderer:s,fieldRendererProps:e,addHeroCommands:i.hasListItemMenu,addMetadata:o,teachingBubble:t&&t.vault&&t.vault.root&&S})};t.nameRenderer=function(e){return t.signaledNameRendererWithHovercard(e,{addHeroCommands:!0})};function S(e,t,n){return r.createElement(x,{vaultItem:e,resources:t},n)}t.onVaultTeachingBubbleRender=S;var x=(function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.render=function(){var t=this,i=this.props,s=i.resources,o=i.vaultItem,a=i.children,f={vaultItem:o,target:this._target,resources:s,directionalHint:y.DirectionalHint.bottomLeftEdge,getUpdatedTarget:function(){return t._target}},h={load:function(t){return l.loadModuleExport({path:"../../../../vaultTeachingBubble/react/odc/VaultTeachingBubble",getModule:function(){return u.default.resolve(new Promise(function(t,n){e(["../../../../vaultTeachingBubble/react/odc/VaultTeachingBubble"],t,n)}))},getExport:function(e){return e.default}})},parse:void 0},p=s.consume(b.resourceKey),d={modulePath:"../../../../vaultTeachingBubble/react/odc/VaultTeachingBubble",moduleLoader:h,customWaiter:g.waitForPageLoadWithTimeout(p,1,1500),props:f};return r.createElement("div",{className:"od-VaultContainer"},r.createElement("div",{className:"od-VaultSection",ref:function(e){return t._target=e}},a,r.createElement(c.ReactDeferredComponent,n.__assign({},d))))};return i})(r.PureComponent);t.VaultTeachingBubbleSection=x;function T(e){var t=e.resources,n=e.item,r=e.itemSet,s=t.consume(i.url);return s.isRecycleBin(n.queryType)?"":s.getDefaultClickUrl(n,{preferCurrentView:!0,itemSet:r})}t.getLinkUrl=T;t.resourceKey=new d.ResourceKey({name:e("module").id,factory:new d.ConstantResourceFactory(t.nameRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/NameRenderer",["require","exports","@ms/items-view/lib/private/components/fields/name/NameField","ODCDeferred_css"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NameRenderer=n.NameField});
define("odsp-next/controls/list/react/detailsList/fields/SharedRenderer",["require","exports","tslib","react","@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer","../../../../../models/item/SharingType","./FieldsRender.resx","../../../../../resources/ControlResourceKeys","../../../../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedRenderer=function(e){var t,f=e.item,l=e.resources,c=l.consume(u.actionMap),h=l.consume(a.resourceKey).getItem(f.key),p=f&&f.sharingType,d=p===s.default.Shared||p===s.default.Public||p===s.default.PublicUnlisted;t={sharingString:d?o.default.SharingHintShared_Short:o.default.SharedFieldPrivate_Short,iconName:d?"People":void 0,imageAlt:o.default.SharedWithSomeIcon,onClick:function(e){new(l.injected(c.ShowPermissionsAction))({item:h}).execute(e.nativeEvent)}};return r.createElement(i.SharedWithRenderer,n.__assign({},t))};t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ConstantResourceFactory(t.sharedRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedWithRenderer=function(e){var t=e.sharingString,s=e.iconName,o=e.imageAlt,u=e.onClick,a=e.ariaLabel,f=void 0===a?"":a,l=u?"od-FieldRenderer-sharedWith ":"";return r.createElement("div",{className:"od-FieldRender ms-noWrap ms-displayInlineBlock","data-is-focusable":"true",title:t,onClick:u,role:u?"button":"","aria-label":f},(function(e,t){if(e)return r.createElement("span",null,r.createElement(i.Icon,n.__assign({iconName:e},{alt:t})),r.createElement("span",null,""));return r.createElement("span",null)})(s,o),r.createElement("span",{className:l},t))}});
define("odsp-next/providers/operator/CreateItemOperator",["require","exports","tslib","./UploadOperator","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../resources/DataSourceResourceKeys","../../models/operation/OperationType","../../models/item/ItemType","../../utilities/mime/MimeHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/item/ItemTaskObserver","../../dataSources/item/ItemTaskObserver","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){var r=this,s=new Blob(["\ufeff"],{type:a.TEXT_MIME_TYPE});s.name=t.fileName;r=e.call(this,{files:[s],parentItem:t.parentItem,behavior:0,type:i.UploadProcessorType.Html5file,skipInvalidation:!1,wasDragAndDropped:!1},n)||this;var o=n.itemTaskObserverType,u=n.urlDataSource,f=n.navigation;r._itemTaskObserver=new o;r._urlDataSource=u;r._navigation=f;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=o.default.createItem;return n};t.prototype.onItemUploaded=function(e){this._itemTaskObserver.update([new l.Task(e.key).succeed({item:{key:e.key,type:l.Graft.backup(u.default.File),extension:l.Graft.backup(".txt"),textEditorMimeType:l.Graft.backup(a.TEXT_MIME_TYPE)}})]);this._itemTaskObserver.flush();e=this.peekUnwrapObservable(this._itemTaskObserver.getItem({key:e.key}));var t=this._urlDataSource.getDefaultClickUrl(e,{viewParams:this._navigation.viewParams,preserveAction:!1});this._navigation.navigateTo({url:t,ignoreHistory:!0})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:s.url,itemTaskObserverType:c.resourceKey,navigation:f.navigation});return t})(r.default);t.default=p;t.typeResourceKey=h.createResolvedTypeResourceKey(e("module").id,p)});
define("odsp-next/providers/searchBox/SearchBoxProvider",["require","exports","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/scope/Scope","@msfast/search-plugin-scoping-control-api/lib/ScopingControlAPI","../../dataSources/searchBox/SearchBoxConfig.key","../../dataSources/searchBox/SearchBoxDataSource.key","../../providers/engagement/Engagement","../../utilities/features/PLTFeatures"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(){function e(e,t){this._resources=t.resources;this._engagement=t.engagement;this._dataSource=t.searchBoxDataSource;this._config=t.searchBoxConfig;this._scope=new s.default;this._getViewParams=function(){throw new Error("Search box not configured")};this._isLastPageSearch=!1;this._searchInstrumenter=this._config.getInstrumenter()}e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new r.Qos({name:"SuiteNavSearchBox.Configure"});this._resources.consumeAsync(this._dataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var i=e.Search;l.isFeatureEnabled(l.O365ShellModuleJSClient)||i.SetSearchText(t._config.getSearchText());i.SetPlaceholderText(t._config.getPlaceholderText());i.SetTokenProviders(t._dataSource.getTokenProviders());var s=i.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),o=i.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),u=i.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(s,i.RemoveOnSubmitSearch);t._trackHandler(o,i.RemoveOnSearchBoxActivated);t._trackHandler(u,i.RemoveOnSearchBoxDeactivated);t._dataSource.getProviderConfigUpdaters&&i.SetProviderConfigUpdaters(t._dataSource.getProviderConfigUpdaters());(l.isFeatureEnabled(l.O365ShellModuleJSClient)||l.isFeatureEnabled(l.OdcSuiteNavSearchBox))&&i.SetSearchBoxSettings({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()});t._shouldUpdateSearchInstrumenterInCallback()&&t._updateSearchInstrumenter();n.end({resultType:r.ResultTypeEnum.Success})})}).catch(function(e){n.end({resultType:r.ResultTypeEnum.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:r.ResultTypeEnum.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})});this._getViewParams=e;this._shouldUpdateSearchInstrumenterInCallback()||this._updateSearchInstrumenter()}};e.prototype.updateSearchBoxConfiguration=function(e){n.Killswitch.isActivated("B963F6C2-0BE4-49D8-ABB1-5AEE6739FF7B","2020/06/24","Get isSearchPage from searchDataSource")?this._resetSearchBoxText(e):this._resetSearchBoxText(this._dataSource.isSearchResultsPage());this._updateSearchInstrumenter()};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._shouldUpdateSearchInstrumenterInCallback=function(){return!n.Killswitch.isActivated("9929db8a-ff53-4f80-983e-43724c24f6f1","2020/04/20","Call searchbox APIs after suiteNav has been loaded")};e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._dataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})};e.prototype._resetSearchBoxText=function(e){var t=this,r=l.isFeatureEnabled(l.O365ShellModuleJSClient);this._config.isEnabled()&&(n.Killswitch.isActivated("9e683945-fe46-46d2-aaf3-34cf77ea2c84","07/07/2020","Use simpler API")?this._resources.consumeAsync(this._dataSource.getSuiteNavProviderKey()).then(function(i){i.getO365Shell().then(function(i){i.OnHasMember("Search",function(){(!r||e||t._isLastPageSearch)&&i.Search.SetSearchText(t._config.getSearchText());i.Search.SetPlaceholderText(t._config.getPlaceholderText());n.Killswitch.isActivated("D0E2BE9E-ABF5-40AF-ABAB-A92D15AB3826","2020/07/01","Update local variable inside promise.")||(t._isLastPageSearch=e)})})}):this._runInShellSearch(function(i){(!r||e||t._isLastPageSearch)&&i.SetSearchText(t._config.getSearchText());i.SetPlaceholderText(t._config.getPlaceholderText());n.Killswitch.isActivated("D0E2BE9E-ABF5-40AF-ABAB-A92D15AB3826","2020/07/01","Update local variable inside promise.")||(t._isLastPageSearch=e)}));n.Killswitch.isActivated("D0E2BE9E-ABF5-40AF-ABAB-A92D15AB3826","2020/07/01","Update local variable inside promise.")&&(this._isLastPageSearch=e)};e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})};e.prototype._onSubmitSearchCallback=function(e,t){this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0});this._dataSource.onSubmitSearchCallback(e,this._getViewParams);this._endQos("Click")};e.prototype._onSearchBoxActivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusIn"});this._startQos()};e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut"});this._endQos("FocusOut")};e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:r.ResultTypeEnum.Failure});this._currentQosEvent=new r.Qos({name:"SuiteNavSearchBox.Usage"})};e.prototype._endQos=function(e){if(this._currentQosEvent){this._currentQosEvent.end({resultType:r.ResultTypeEnum.Success,resultCode:e});this._currentQosEvent=void 0}};e.prototype._updateSearchInstrumenter=function(){n.Killswitch.isActivated("5B47A4CC-DAE4-4990-A43E-B6E83E3DCBE6","2020/05/06","Always set instrumenter props to trigger updater.")||this._triggerSearchBoxReconfiguration();if(this._config.isScopeControlEnabled()&&this._isScopeControlSupported()){o.configureScopingControl(this._getScopingControlConfig(),this._searchInstrumenter);this._updateSelectedScope(this._dataSource.getScope())}else n.Killswitch.isActivated("5B47A4CC-DAE4-4990-A43E-B6E83E3DCBE6","2020/05/06","Always set instrumenter props to trigger updater.")&&l.isFeatureEnabled(l.ODBSubstrateSearchQueryV2)&&l.isFeatureEnabled(l.CSIOdbScopedSearch)&&this._triggerSearchBoxReconfiguration();this._setSearchInstrumenterProps()};e.prototype._isScopeControlSupported=function(){return!!this._dataSource.getAvailableScopes&&!!this._dataSource.getScope};e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._dataSource.getAvailableScopes(),activeScopeId:this._dataSource.getScope().id,onChange:function(t,r){e._updateSelectedScope(r);e._triggerSearchBoxReconfiguration();(n.Killswitch.isActivated("2720F7F6-45F8-4D71-891E-CB9E19A01C71","2020/06/24","Submit search on scope change only when user already in SERP.")?!!t:!!t&&e._dataSource.isSearchResultsPage())&&e._onSubmitSearchCallback(t);n.Killswitch.isActivated("0319344C-B887-4113-A755-9E1453956D68","2020/07/02","Set focus back to search box after scope change.")||e._setFocusSearchBox()}}};e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._dataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox(function(){return!0})})})};e.prototype._setSearchInstrumenterProps=function(){this._dataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._dataSource.getSearchInstrumenterProps())};e.prototype._updateSelectedScope=function(e){this._dataSource.updateSelectedScope&&this._dataSource.updateSelectedScope(e)};e.prototype._triggerSearchBoxReconfiguration=function(){var e,t;n.Killswitch.isActivated("5ccf6622-1ce3-4840-b24c-a62cbd4d49a0","07/07/2020","Use new API for reconfiguration")?null===(e=this._searchInstrumenter)||void 0===e||e.setProps({hostAppInfo:null===(t=this._searchInstrumenter)||void 0===t?void 0:t.props.hostAppInfo}):this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})};e.dependencies={resources:i.resourceScopeKey,engagement:f.resourceKey,searchBoxDataSource:a.resourceKey,searchBoxConfig:u.resourceKey};return e})();t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});
define("@msfast/search-plugin-scoping-control-api/lib/ScopingControlAPI",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){var e,t,n;r||(r=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t));return r};t.configureScopingControl=function(e,t){var s;t&&(r=t);null===(s=i())||void 0===s||s.setProps({scopingControl:n.__assign({},e)})};t.setActiveScopeId=function(e){var r,s=i(),o=null===(r=t.getScopes())||void 0===r?void 0:r.map(function(e){return e.id});if(o&&-1===o.indexOf(e))return!1;null==s||s.setProps({scopingControl:n.__assign(n.__assign({},s.props.scopingControl),{activeScopeId:e})});return!0};t.getActiveScopeId=function(){var e;return null===(e=t.getConfiguration())||void 0===e?void 0:e.activeScopeId};t.getScopes=function(){var e;return null===(e=t.getConfiguration())||void 0===e?void 0:e.scopes};t.getConfiguration=function(){var e;return null===(e=i())||void 0===e?void 0:e.props.scopingControl};t.subscribeToChange=function(e){var t=i();return null==t?void 0:t.register(function(t){(null==t?void 0:t.scopingControl)&&e(t.scopingControl)})};t.releaseSubscription=function(e){var t;e&&(null===(t=i())||void 0===t||t.unregister(e))}});
define("odsp-next/dataSources/item/odc/RecentDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/QueryType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.default[o.default.Recent].toLowerCase(),f=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(o.default.Recent),r=t.getRootItemTitle(n),i=new(t.resources.consume(u.resourceKey));i.update([new u.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:o.default.Recent,displayType:o.default.Recent,name:r,displayName:r}})]);i.flush();return t}t.prototype.getRootItemTitle=function(e){return r.default.Recent};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=a,r):e.prototype._getItemKeyExtension.call(this,t,n)};return t})(i.default);t.default=f});
define("odsp-next/dataSources/item/odc/SearchDataSource",["require","exports","tslib","../../../controls/search/Search.resx","./SkyApiItemDataSource","../../../models/item/ItemType","@ms/odsp-utilities/lib/string/StringHelper","../../../dataSources/url/QueryType","../../url/PageType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.default[u.default.Search].toLowerCase(),c=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._keyUniqueIndex=0;var n=t._urlDataSource.getRootItemKey(u.default.Search),r=t.getRootItemTitle(n),i=new(t.resources.consume(f.resourceKey));i.update([new f.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:u.default.Search,displayType:u.default.Search,name:r,displayName:r}})]);i.flush();return t}t.prototype.getItem=function(t){return e.prototype.getItem.call(this,t).then(function(e){e.totalChildren=e.children?e.children.length:0;return e})};t.prototype._getParentItemId=function(){return"root"};t.prototype.getRootItemTitle=function(e){var t=this._urlDataSource.getKeyParams(e);if(t.sp)return r.default.SearchItemsPassThruLargestTitle;var n=t.q||"",i=this._urlDataSource.getPageType()===a.default.Photos?r.default.SearchPhotosTitle:r.default.SearchItemsTitle;return n&&o.format(i,n)||""};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=""+l+this._keyUniqueIndex++,r):e.prototype._getItemKeyExtension.call(this,t,n)};return t})(i.default);t.default=c});
define("odsp-next/dataSources/item/odc/SharedDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/QueryType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.default[o.default.SharedWithMe].toLowerCase(),f=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(o.default.SharedWithMe),r=t.getRootItemTitle(n),i=new(t.resources.consume(u.resourceKey));i.update([new u.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:o.default.SharedWithMe,displayType:o.default.SharedWithMe,name:r,displayName:r}})]);i.flush();return t}t.prototype.getRootItemTitle=function(e){return r.default.Shared};t.prototype._getItemKeyExtension=function(t,r){var i,s;return t.isSharerFolder||this._isSharerRootId(t.id)?n.__assign(n.__assign({},e.prototype._getItemKeyExtension.call(this,t,r)),((i={}).qt="sharedby",i)):((s={}).u=a,s)};t.prototype._isSharerRootId=function(e){return!e||e===this._getRootFileId()||0===e.indexOf("-")};return t})(i.default);t.default=f});
define("odsp-next/dataSources/mruRecent/odc/MruRecentDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","../../base/vroom/VroomDataRequestor","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor;this._urlDataSource=t.urlDataSource}e.prototype.removeRecentItem=function(e){var t=e.items[0].mruState.mruId,n=e.items[0],r=n.id,i=n.name,s=n.extension,o=""+this._urlDataSource.getApiBaseUrl().replace("v1.0","v2.1")+("/drive/recent/"+t),u={remoteItem:{id:r,name:i+s,webDavUrl:"https://onedrive.live.com"}};return this._vroomDataRequestor.send({apiName:"Recent",path:o,requestType:"DELETE",apiVersion:"v2.1",useAuthorizationHeaders:!0,postData:JSON.stringify(u)})};e.prototype.changePinStatus=function(e){return r.default.reject("Not implemented")};e.prototype.recordDocumentView=function(e,t){return r.default.reject("Not implemented")};e.prototype.getTokenForMru=function(){return r.default.reject("Not implemented")};e.dependencies=n.__assign(n.__assign({},i.default.dependencies),{vroomDataRequestor:o.resourceKey,urlDataSource:s.url});return e})();t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a,n.__assign(n.__assign({},i.default.dependencies),{vroomDataRequestor:o.resourceKey,urlDataSource:s.url}))});
define("odsp-next/dataSources/search/odc/SearchDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/path/Path","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/string/StringHelper","./BingSuggestionsAppId","../ISearchDataSource","../SearchShared.resx","../../item/ItemDataSource.resx","../../url/odc/UrlDataSource","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../models/item/ItemHelper","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=["3gp","aac","m4a","mp3","wav","wma"],k=window.$Config&&window.$Config.mkt,L=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var i=e.call(this,t,n)||this,s=n.identityDataSource.getIdentity().type,a=s===r.IdentityType.msa;i._capabilities={supportsResultsWheeling:a,minimumQueryLength:0,maxQueryRate:100,showNoResults:!1,showOnlyResults:!0,supportsSearchFiltering:!0};i._navigation=n.navigation;i._urlDataSource=n.urlDataSource;i._regenerateCvid();i._paddedCid=d.rightPad(b.default.viewerId,32);if(s===r.IdentityType.anonymous)i._requirePromise=u.default.wrap();else{var f="https://www.bing.com/as/init?"+o.serializeQuery({pt:"onedrive",clientid:i._paddedCid});i._requirePromise=new u.default(function(e,t){return window.require([f],e,t)})}return i}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getItems=function(e,t){var n=this;void 0===e&&(e="");var r=new c.Qos({name:"Odc.Search.QF.SearchDataSource.getItems"});return this._requirePromise.then(function(){return new u.default(function(r){var i=null;t&&t.type===x.default.Folder&&t.queryType===E.default.Files&&(i=t.id);AutoSuggest.getSuggestions(e,v.default,n._cvid,!0,null,i,n._paddedCid,function(e){var t=null;e&&(t=JSON.parse(e));r(t)},k)})}).then(function(t){r.end({resultType:c.ResultTypeEnum.Success});var i=new c.Qos({name:"Odc.Search.QF.SearchDataSource.ResponseToRender"}),s=[];if(t&&t.suggestionGroups){var o=t.pingUrlBase||t.instrumentation&&t.instrumentation.pingUrlBase;t.suggestionGroups.forEach(function(e){var t=e.suggestionContainers||e.searchSuggestions;if(t){var r=[];t.forEach(function(t){if(t.suggestion){var i=t.content&&t.content[0].documents[0];(n._urlDataSource.getPageType()!==w.default.Photos||i&&"Photo"===i.type||i&&"Video"===i.type||"Tag"===t.suggestion.type||"History"===t.suggestion.type)&&r.push(n._getSuggestionFromContainer(o,t))}else{var s=t.result&&t.result[0];if(n._urlDataSource.getPageType()!==w.default.Photos||s&&"Photo"===s.type||s&&"Video"===s.type||"PersonalSearchTags"===e.name||"SearchHistory"===e.name){var u=n._getSuggestionFromContainer(o,t,e.name);u&&r.push(u)}}});s.push({results:r})}})}return{query:e,containers:s,responseToRenderEvent:i}}).then(null,function(t){if(t&&t instanceof Error&&"Canceled"===t.name){r.end({resultType:c.ResultTypeEnum.ExpectedFailure});return{query:e,containers:[]}}r.end({resultType:c.ResultTypeEnum.Failure,resultCode:t.status});return u.default.wrapError(y.default.DefaultTitle)})};t.prototype.upscopeSearch=function(e){var t=this._urlDataSource.getSearchQueryUrl(e,this._cvid);this._regenerateCvid();t&&this._navigation.navigateTo(t)};t.prototype.searchResultClicked=function(e){this._regenerateCvid()};t.prototype._getSuggestionFromContainer=function(e,t,n){void 0===n&&(n="");var r=t.suggestion,i=r&&r.name||t.displayText,s=i.replace(/\ue000/g,"").replace(/\ue001/g,""),o=i;o=(o=(o=a.default.encodeText(o)).replace(/\ue000/g,'<span class="od-SearchResults-result-highlight">')).replace(/\ue001/g,"</span>");var u=m.SearchFilterType.all;this._urlDataSource.isCurrentQuery(E.default.Photos)&&(u=m.SearchFilterType.photos);var f=this._urlDataSource.getSearchQueryUrl(s,void 0,u),l="",c=r&&r.urlPingSuffix||t.urlPingSuffix;e&&c&&(l=e+c);var h={title:o,titleText:s,titleAriaLabel:s,url:f,instrumentationUrl:l,type:1};return r&&"Tag"===r.type||"PersonalSearchTags"===n?this._makeTagSuggestion(s,t,h):r&&"History"===r.type||"SearchHistory"===n?this._makeHistorySuggestion(s,t,h):(r&&"Document"===r.type&&t.content&&t.content.length||"PersonalSearchDocuments"===n)&&t.result&&t.result.length?this._makeDocumentSuggestion(s,t,h):null};t.prototype._makeHistorySuggestion=function(e,t,n){n.type=4;n.glyph=new N.default("Clock");n.titleAriaLabel=d.format(g.default.HistoryAriaLabel,e);return n};t.prototype._makeTagSuggestion=function(e,t,n){var r=t.suggestion&&t.suggestion.query.substr(1)||t.query.substr(1);n.type=3;n.glyph=new N.default("Tag");n.titleAriaLabel=d.format(g.default.TagAriaLabel,r);n.url=this._urlDataSource.getTagUrl({localizedTag:r,source:"UserDefined",tag:r,type:"keyword"});return n};t.prototype._makeDocumentSuggestion=function(e,t,n){var r=t.content&&t.content[0]&&t.content[0].documents[0]||t.result[0],i=r.rawResourceId,s=h.getFileExtension(e,!0);n.key=this._urlDataSource.getKey({id:i});if(this._openItemExternally(s)){n.key=null;n.url=b.default.getResourceRedirectUrl(i)}if("Folder"===r.type){n.iconName="folder";n.titleAriaLabel=d.format(g.default.ODCFolderAriaLabel,e)}else{n.iconName=l.getIconNameFromExtension(h.getFileExtension(e));n.titleAriaLabel=d.format(g.default.ODCFileAriaLabel,e)}r.parentFolder&&r.parentFolder.name&&(n.parentFolder=r.parentFolder.name);return n};t.prototype._regenerateCvid=function(){this._cvid=f.default.generate()};t.prototype._openItemExternally=function(e){return S.isOfficeDoc(e)||this._isXboxMusicAudio(e)};t.prototype._isXboxMusicAudio=function(e){return-1!==C.indexOf(e)};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{identityDataSource:T.identity,navigation:s.navigation,urlDataSource:T.url});return t})(i.default);t.default=L;t.resourceKey=p.createResolvedResourceKey(e("module").id,L)});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper",["require","exports","tslib","../../../url/odc/UrlDataSource","../../../item/ItemTaskObserver","../../../itemActivityFeed/helper/BaseItemActivityFeedHelper","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../../../../resources/DataSourceResourceKeys","../../../../resources/ControlResourceKeys","../../../../utilities/browser/WebViewDetector","../../../../actions/OpenInDesktopAction","../../../base/vroom/ItemResultProcessor","../../../url/QueryType","../../../../utilities/features/Features","@ms/odsp-datasources/lib/Permissions","../../../../actions/base/ItemSelectionHelper","../../../../models/item/ItemType","../../../../controls/itemActivityFeed/ItemActivityFeed.resx","../../../base/graph/GraphDataRequestor","@ms/odsp-graph/lib/services/people/PeopleService","@ms/odsp-datasources/lib/dataSources/peoplePicker/graph/PeoplePickerDataSource","@ms/odsp-datasources/lib/providers/peoplePicker/odc/PeoplePickerProvider","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._actionMap=n.actionMap;r._itemTaskObserver=new n.itemTaskObserver;r._isOneDriveWinApp=l.isOneDriveWinApp();r._urlDataSource=n.urlDataSource;r._baseHelper=new s.default({itemTaskObserver:r._itemTaskObserver});r._identityDataSource=n.identityDataSource;r._checkUserAccessDataSource=n.checkUserAccessDataSource;r._itemSelectionHelper=new(r.child(m.typeResourceKey))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.init=function(e){this._resources=e;this._setAtMentionEnable();this._isAtMentionEnabled&&this._initPeoplePicker()};t.prototype.getPeoplePickerProvider=function(){return this._peoplePickerProvider};t.prototype.getActivityItemUrl=function(e){var t=this._getActivityItemUrl(e);return this._appendDeeplinkQueryParams(t,e)||t};t.prototype.getGraphItemUrl=function(e,t){if(t){var n=t.getItemUrl(e,{useDirectEndpoint:!0});return this.isCommentsInActivityFeedEnabled()?n:n.substring(0,n.indexOf("/drives/"))+"/drive/root"}};t.prototype.updateItem=function(e,t){this._baseHelper.updateItem(e,t)};t.prototype.getAccessToken=function(e,t){return this._baseHelper.getAccessToken(e,t)};t.prototype.isNonOfficeFileCommentsAvailable=function(e){return this.isCommentsInActivityFeedEnabled()&&this._isCommentsSupportedOnItem(e)};t.prototype.renderUser=function(e,t){return t?t(e):null};t.prototype.getAPIEnvironment=function(e){return"consumer"};t.prototype.getCurrentRootTitle=function(e){return e&&e.isRootFolder&&e.name||void 0};t.prototype.getDefaultItemTitle=function(e){};t.prototype.navigateToItem=function(e,t,r,i){var s=this;if(r){var o=t.driveItem;o.webUrl||(o=n.__assign(n.__assign({},o),{webUrl:r}));if(t.isFolder&&o.webUrl){i&&i("folder");this.navigateToFolder(o.webUrl)}else{var u=this._tryAndFetchOneDriveItem(o);if(u){i&&i(u.folder?"folder":u.extension||"file");r&&(u.openUrl=r);this.navigateToOneDriveItem(u)}else this._convertToOneDriveItem(e,o).then(function(e){i&&i(e.folder?"folder":e.extension||"file");r&&(e.openUrl=r);s.navigateToOneDriveItem(e)})}}};t.prototype.isGuestUser=function(){return!this._identityDataSource||this._identityDataSource.getIdentity().type===v.IdentityType.anonymous};t.prototype.isAccessTokenRequired=function(){return!1};t.prototype.getCommentListItem=function(e,t){if(this.isNonOfficeFileCommentsAvailable(e))return{item:e,activityItemWrapper:t,parentListId:e.key}};t.prototype.getCommentItemWrapper=function(e,t){var n=this.getGraphItemUrl(e,t),r=this.getAccessToken(e,t);return this.getCommentListItem(e,{name:e.displayName,graphItemUrl:n,accessToken:r})};t.prototype.getCurrentUserEmail=function(){return this._identityDataSource.getIdentity().email};t.prototype.isCommentOnItemDisabled=function(e){return!!(e&&e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)};t.prototype.isItemNotificationActive=function(e){if(!e)return!1;var t=this._urlDataSource.getOwnerId(void 0,{}).toLowerCase()===this._urlDataSource.getOwnerId(e.key).toLowerCase(),n=this._itemSelectionHelper.currentItem(),r=this._urlDataSource.getKeyParams(n.key),i=this._urlDataSource.getQueryType(r);return!this.isGuestUser()&&t&&!e.isPlaceholder&&e.type!==g.default.Folder&&!this._urlDataSource.isRecycleBin(i)&&d.isFeatureEnabled(d.EnableNewCommentExperience)&&d.isFeatureEnabled(d.EnableNotificationSubscriptions)};t.prototype.isCommentsInActivityFeedEnabled=function(){return d.isFeatureEnabled(d.EnableNewCommentExperience)};t.prototype.isActivityContextMenuAvailable=function(e){return this.isCommentsInActivityFeedEnabled()&&void 0!==e.type&&e.type!==g.default.Folder};t.prototype.isCommentsOnly=function(e,t){return!(!e.folder||e.isRootFolder)||this.isNonOfficeFileCommentsAvailable(e)&&t};t.prototype.getDeepLinkCommentThreadId=function(){if(this._isCommentDeepLinkingEnabled())return this._urlDataSource.getCommentIdParamValue()};t.prototype.isReadOnly=function(e){var t=this.isNonOfficeFileCommentsAvailable(e),n=this.isCommentOnItemDisabled(e);return!(t&&this.checkHasCommentingPermission(e))||n};t.prototype.checkHasDeletePermission=function(e){return this.checkHasCommentingPermission(e)};t.prototype.isSingleLevel=function(e){return!e.isRootFolder};t.prototype.getPersonaIconUrl=function(){return function(e){return r.UrlDataSource.getProfileImage(e)}};t.prototype.activityHeaderToDisplay=function(e){if(e.type===g.default.Folder)return e.isRootFolder?y.default.itemActivityFeedViewAll:y.default.itemActivityFeedCommentsOnly};t.prototype.userCanManageCommentsSettings=function(e){return!(this.isGuestUser()||0!==e.sharingRole||void 0!==e.dateDeleted||e.vault&&e.vault.root)};t.prototype.getActivityApiHeaders=function(e){return d.isFeatureEnabled(d.EnableNewCommentExperience)?e.isRootFolder?"Get-Self,Force-VaultItems-Filter":"Get-Self":"Get-Self,Force-VaultItems-Filter"};t.prototype.checkHasCommentingPermission=function(e){return!this.isGuestUser()&&(0===e.sharingRole||2===e.sharingRole)};t.prototype.getSPListItemActivities=function(e,t){};t.prototype.isAtMentionEnabled=function(e){return this._isAtMentionEnabled&&!this._baseHelper.isOfficeItem(e)};t.prototype.isPublicEmailAddressMentionSupported=function(e){return this.isAtMentionEnabled(e)};t.prototype.checkUserAccess=function(e,t,n,r,i){var s=t?t.getItemUrl(e,{useDirectEndpoint:!0,apiVersion:"v2.1"}):"",o=[{email:n}];if(this._checkUserAccessDataSource&&n)return this._checkUserAccessDataSource.checkUserAccess(s,o).then(function(e){if(r){var t=e.filter(function(e){var t,r,i;return n.toLowerCase()===(null===(i=null===(r=null===(t=e)||void 0===t?void 0:t.recipient)||void 0===r?void 0:r.email)||void 0===i?void 0:i.toLowerCase())});t&&t.length>0&&r(t[0].canWrite)}})};t.prototype._isCommentDeepLinkingEnabled=function(){return d.isFeatureEnabled(d.EnableCommentDeepLinking)};t.prototype._appendDeeplinkQueryParams=function(e,t){var n=e&&new x.default(e),r=t&&t.navigationId;if(n&&r){n.setQueryParameter("nav",r);this._isCommentDeepLinkingEnabled()&&n.setQueryParameter("commentId",r)}return n&&n.toString()||e};t.prototype._getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e.isFolder?this._urlDataSource.getCurrentSiteUrl()+"#id="+t.id:t&&void 0!==e.relativePath?this._urlDataSource.getCurrentPageBaseUrl()+e.relativePath:void 0};t.prototype.navigateToOneDriveItem=function(e){var t=this.createObservable(e);if(this._isOneDriveWinApp){new(this._managed(this._actionMap.OpenInDesktopAction))({openRelation:2,item:t,actionType:c.DesktopActionType.OpenItemActivityItem}).execute(void 0)}else if(e&&e.openUrl)this.navigateToUrlDirectly(e.openUrl);else{new(this.managed(this._actionMap.ExternalNavigateAction))({item:t}).execute(void 0)}};t.prototype.navigateToFolder=function(e){this.navigateToUrlDirectly(e)};t.prototype.navigateToUrlDirectly=function(e){new(this.managed(this._actionMap.NavigationAction))({url:e,forceNavigation:!0,target:"_blank"}).execute(void 0)};t.prototype._convertToOneDriveItem=function(e,t){var n=this;return this.resources.consumeAsync(h.resourceKey).then(function(r){var i=r.processItem({itemFromServer:t,requestKey:e.key,observer:n._itemTaskObserver}).key;n._itemTaskObserver.flush();var s=n._itemTaskObserver.getItem({key:i});s&&(s.queryType=p.default.DetailsPane);return s})};t.prototype._tryAndFetchOneDriveItem=function(e){var t,n=e.root?"root":e.id,r=this._urlDataSource.getKey(((t={}).id=n,t)),i=this._itemTaskObserver.getItem({key:r});i&&(i.queryType=p.default.DetailsPane);return i};t.prototype._managed=function(e){this._resources&&(e=this._resources.injected(e));return this.scope.attached(e)};t.prototype._isCommentsSupportedOnItem=function(e){return e&&e.graph&&!e.isRootFolder};t.prototype._initPeoplePicker=function(){var e=new w.default({},{dataRequestor:this._resources.consume(b.resourceKey)});this._peoplePickerDataSource=new E.PeoplePickerDataSource(e,!0);this._peoplePickerProvider=new S.PeoplePickerProvider(this._peoplePickerDataSource)};t.prototype._setAtMentionEnable=function(){this._isAtMentionEnabled=d.isFeatureEnabled(d.EnableItemFeedAtMention)&&d.isFeatureEnabled(d.EnableNewCommentExperience)&&!this.isGuestUser()};t.dependencies=n.__assign(n.__assign({},u.default.dependencies),{actionMap:f.actionMap,itemTaskObserver:i.resourceKey,urlDataSource:a.url,identityDataSource:a.identity,checkUserAccessDataSource:a.checkUserAccessDataSource.optional});return t})(u.default);t.default=T;t.resourceKey=o.createResolvedResourceKey(e("module").id,T)});
define("odsp-next/dataSources/itemActivityFeed/helper/BaseItemActivityFeedHelper",["require","exports","tslib","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../item/ItemTaskObserver"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._itemTaskObserver=e.itemTaskObserver}e.prototype.updateItem=function(e,t){this._itemTaskObserver.update([new i.Task(e.key).succeed({item:n.__assign({key:e.key},t)})],!1);this._itemTaskObserver.flush()};e.prototype.getAccessToken=function(e,t){if(t)return t.getAccessToken(e)};e.prototype.isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&r.OfficeIconFileTypeMap[t]&&".pdf"!==e.extension};return e})();t.default=s});
define("odsp-next/dataSources/base/graph/GraphDataRequestor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../providers/graphToken/GraphTokenProvider","../../../dataSources/graphUrl/GraphUrlDataSource","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:r.resourceKey,urlDataSource:i.resourceKey});t.default=s.DataRequestor});
define("odsp-next/providers/graphToken/GraphTokenProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{identityDataSource:s.identity});return t})(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/dataSources/graphUrl/GraphUrlDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return!r.isFeatureEnabled(r.UseNewShareDialog)||i.isOneDriveWinApp()&&!r.isFeatureEnabled(r.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta"};return e})();t.GraphUrlDataSource=s;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(s)})});
define("@ms/odsp-graph/lib/services/people/PeopleService",["require","exports","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getContacts=function(e){var t="/me/contacts?$select=displayName,emailAddresses&$top=50";e&&e.length>0&&(t+='&$search="'+n.default.encodeURIComponent(e)+'"');return this._dataRequestor.send({path:t,apiName:"GetContacts",requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})};e.prototype.getPeople=function(e){var t="/me/people?$select=displayName,emailAddresses&$top=20";e&&e.length>0&&(t+='&$search="'+n.default.encodeURIComponent(e)+'"');return this._dataRequestor.send({path:t,apiName:"GetTopCollaborators",requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e&&e.value},function(e){})};e.prototype.searchPeople=function(e){var t="/me/people?$select=displayName,emailAddresses&$top=20";e&&e.length>0&&(t+='&$search="'+n.default.encodeURIComponent(e)+'"');return this._dataRequestor.send({path:t,apiName:"SearchPeople",requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e&&e.value},function(e){})};return e})();t.default=r});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/graph/PeoplePickerDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/EmailAddressParser","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._service=e;this._supportsPeople=t||!1}e.prototype.getCapabilities=function(){return{supportsMruCaching:!1}};e.prototype.search=function(e,t){if(this._supportsPeople)try{return this._service.searchPeople(e).then(function(n){var i=[],s=r.default.isValidEmailSyntax(e,!1);!1!==t.resolveEmailIfNoResults&&0===i.length&&s&&i.push({email:e,name:e,userId:e,isResolved:!0});if(n&&n.length>0)for(var o=0,u=n;o<u.length;o++){var a=u[o],f=a.emailAddresses[0]?a.emailAddresses[0].address:"",l="";if(f)try{(l=btoa(a.id)).indexOf(f)>-1&&(l=l.substring(0,l.indexOf(f)))}catch(e){l=""}i.push({email:f,name:a.displayName,userId:l,isResolved:!0})}return i})}catch(e){}var n=!i.Killswitch.isActivated("e517cfbc-99a8-4e79-b3f8-7b7b38b93fab","04/07/2019","Picker enhancements for multiple emails in a contact");return this._service.getContacts(e).then(function(i){var s=r.default.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===i.length&&s)return[{email:e,name:e,userId:e,isResolved:!0}];var o=e.toLowerCase(),u=i.map(function(e){var t="",r="",i=e.emailAddresses;if(i&&i.length>0)for(var u=0,a=i;u<a.length;u++){var f=a[u];if(f&&f.address&&f.address.length>0){r||(r=f.address);if(n&&s&&0===f.address.toLowerCase().indexOf(o)){t=f.address;break}}}if(n){return{userId:s&&t||e.displayName,name:e.displayName,email:s?t:r,isResolved:!0}}return{userId:e.displayName,name:e.displayName,email:r,isResolved:!0}});return n?u.filter(function(e){return e.email&&e.email.length>0}):u})};e.prototype.resolve=function(e,t){var r,i=this,s=function(){if(r){r.cancel();r=void 0}};return new n.default(function(o,u){var a=function(e){s();o(e)};r=n.default.timeout(2e3).then(function(){a(i._getPersonFromQuery(e))});i.search(e,t).then(function(t){0===t.length?a(i._getPersonFromQuery(e)):a(t[0])},function(t){a(i._getPersonFromQuery(e))})},s)};e.prototype.getPersonaDetails=function(e){return null};e.prototype.subscribePresence=function(e,t){return{dispose:function(){}}};e.prototype.getPickerEntityInformation=function(e){return null};e.prototype._getPersonFromQuery=function(e){var t=new r.default(e),n={};if(t.getEmail()){n.name=t.getName()||"";n.image="";n.sharingInfo={type:0};n.isResolved=!0}else n.name=n.name||e;n.email=t.getEmail()||e;return n};return e})();t.PeoplePickerDataSource=s});
define("@ms/odsp-datasources/lib/providers/peoplePicker/odc/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return null},i=(function(){function e(e){this.getPersonaDetails=r;this.subscribePresence=r;this.getPickerEntityInformation=r;this.addToMruCache=r;this._dataSource=e;this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var r,i=this,s={cached:null,promise:null};s.promise=new n.default(function(n,s){r=i._dataSource.search(e,t).then(function(e){e&&n(e)},function(e){s(e)})},function(){r&&r.cancel()});return s};e.prototype.resolve=function(e,t){return this._dataSource.resolve(e,t).then(function(e){return e})};return e})();t.PeoplePickerProvider=i});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedSharingHelper",["require","exports","tslib","react","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared-sharing/lib/Share","@ms/odsp-shared-sharing/lib/store/odc/SharingStore","@ms/odsp-graph/lib/services/sharing/SharingService","../../../base/graph/GraphDataRequestor","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./ItemActivityFeedSharingWrapper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onCompleteGrantAccessCallback=function(e){r._statusCallback&&(e?r._statusCallback("share_grantAccessCompleted"):r._statusCallback())};return r}t.prototype.init=function(e,t){this._resources=e;this._item=t;this._platformDetection=this._resources.consume(l.platformDetection);var n=new a.default({},{dataRequestor:this._resources.consume(f.resourceKey)});this._store=new u.default({itemName:this._item.displayName,sharingService:n,itemId:this._item.id,itemUrl:this._item.openUrl,defaultRecipients:[],accessChecked:!0,mode:o.Mode.atMention},void 0);this._store.fetchSharingInformation(!0)};t.prototype.setDismissCallback=function(e){this._dismissCallback=e};t.prototype.setResizeCallback=function(e){this._resizeCallback=e};t.prototype.setStatusCallback=function(e){this._statusCallback=e};t.prototype.setGrantees=function(e){this._recipients=this._prepareRecipientPeopleFromGrantees(e)};t.prototype.renderGrantAccess=function(){return r.createElement(c.default,{mentionProps:this._getMentionProps(),dismissCallback:this._dismissCallback,statusCallback:this._statusCallback,resizeCallback:this._resizeCallback,sharingStore:this._store,platformDetection:this._platformDetection,shareClickTime:Date.now()})};t.prototype._getMentionProps=function(){return{clientId:o.ClientId.odc,scenarioId:"Item Feed Grant Access",currentSettings:{allowEditing:!0,audience:o.SharingAudience.anyone,expiration:new Date,hasPassword:!1,password:"",isEdit:!0,sharingLinkKind:1,specificPeople:[],updatePassword:!1},sharingInformation:this._store.getSharingInformation(),recipients:this._recipients,onComplete:this._onCompleteGrantAccessCallback}};t.prototype._prepareRecipientPeopleFromGrantees=function(e){for(var t,n,r,i,s,o=[],u=0;u<e.length;u++){var a={name:(null===(t=e[u].user)||void 0===t?void 0:t.displayName)||(null===(n=e[u].user)||void 0===n?void 0:n.email),email:null===(r=e[u].user)||void 0===r?void 0:r.email,userId:(null===(i=e[u].user)||void 0===i?void 0:i.id)||(null===(s=e[u].user)||void 0===s?void 0:s.email),isResolved:!0};o.push(a)}return o};return t})(s.default);t.default=h;t.resourceKey=i.createResolvedResourceKey(e("module").id,h)});
define("@ms/odsp-shared-sharing/lib/store/odc/SharingStore",["require","exports","tslib","@ms/odsp-datasources/lib/Sharing","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-graph/lib/models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event","../../components/Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/EngagementHelper","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/string/EmailAddressParser","../../utilities/ClientIdHelper","../../interfaces/IPersonEx","@ms/odsp-utilities/lib/dateTime/DateTime"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={ODC:"ODCSecureSharing"},m=function(){return null};var g=(function(){function e(e,t){var n=this;this._listeners=null;this.addPeople=m;this.getCompanyName=m;this.getOutlookAvailability=m;this.fetchSuiteNavInformation=m;this.navigateToOwa=m;this.fetchGroupsMemberCount=m;this.getGroupsMemberCount=m;this.fetchPolicyTipInformation=m;this.getPolicyTipInformation=m;this.updatePolicy=m;this.checkPermissions=m;this.getPermissionsMap=m;this.isValidatingDefaultRecipients=function(){return n._isValidatingDefaultRecipients};this.getAddPeopleResult=m;this.hasAccessRequestBeenCreated=m;this.fetchMemberCount=m;this.getMembersCounts=m;if(!e.itemId&&!e.itemUrl&&!e.multiShareIds)throw new Error("An itemId, itemUrl, or multiShareIds must be passed to the Sharing store");this._listeners=new Array;this._shareLink=null;this._grantAccessResult=null;this._itemUrl=e.itemUrl;this._multiShareIds=e.multiShareIds;this._itemId=this._multiShareIds?this._multiShareIds[0]:e.itemId;this._itemName=this._multiShareIds?a.format(u.default.sharingBundleName,this._multiShareIds.length):e.itemName;this._sharingService=e.sharingService;this._sharingInformation=null;this._isPremium=null;this._isBundleShare=this._multiShareIds&&this._multiShareIds.length>1;this._engagementHelper=new f.EngagementHelper(e.telemetryManager);this._navId=e.navId;this._family={userId:"",name:"",email:""};this._familyMembers=[];this._clientId=e.clientId;this._isEdit=null===e.isEdit||void 0===e.isEdit||e.isEdit;this._audience=null!==e.audience&&void 0!==e.audience?e.audience:r.SharingAudience.anyone;this._isBundleShare&&(this._bundleName=a.format(u.default.sharingBundleNameWithDate,d.getFileSafeShortDate(new Date)));l.default.isFeatureEnabled({ODC:"AtMentionODCKillSwitch"})||(t?this._tryResolveDefaultRecipients(e.defaultRecipients,t.peoplePickerProvider):this._tryResolveDefaultRecipients(e.defaultRecipients,void 0))}e.prototype.isConsumer=function(){return!0};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype._emitChange=function(){this._listeners.forEach(function(e){return e()})};e.prototype.addListener=function(e){this._listeners.push(e);this._emitChange()};e.prototype.shouldInterruptCopyLink=function(e){var t=this;if(this._isPremium&&!this._multiShareIds){return this._sharingInformation.hasPermissionsInformation?new Promise(function(n,r){n(t._doesMatchingLinkExist(e))}):new Promise(function(n,r){t._sharingService.getPermissions(t._itemId).then(function(r){t._permissions=r;var i=t._parsePermissions(r),s=i.principals,o=i.sharingLinks;t._sharingInformation.sharingPrincipals=s;t._sharingInformation.sharingLinks=o;n(t._doesMatchingLinkExist(e))})})}return new Promise(function(e,t){e(!1)})};e.prototype._doesMatchingLinkExist=function(e){var t=this._sharingInformation.sharingLinks,n=!1;t.forEach(function(t){t.isEdit!==e||t.application||(n=t.hasPassword)});return n};e.prototype.getInitialLinkSettings=function(e){var t,n=r.SharingAudience.anyone,i=!0,s=null;if(null==e)t=5;else{null!==e.isEdit&&void 0!==e.isEdit&&(i=e.isEdit);null!==e.expiration&&void 0!==e.expiration&&(s=e.expiration);if(e.audience===r.SharingAudience.specificPeople){t=1;n=r.SharingAudience.specificPeople}else{if(null!==e.audience&&void 0!==e.audience&&e.audience!==r.SharingAudience.anyone)throw new Error("ODC does not support other SharingAudience settings.");t=i?5:4;n=r.SharingAudience.anyone}}return{allowEditing:!0,audience:n,expiration:s,isEdit:i,sharingRole:i?2:1,sharingLinkKind:t,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""}};e.prototype.getSharingInformation=function(){return this._sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return!1};e.prototype.fetchSharingInformation=function(e){var t=this,i=this._itemId?this._sharingService.getItemInfo(this._itemId):this._sharingService.getItemInfoFromItemUrl(this._itemUrl),a=this._sharingService.getCurrentUserId(),f=this._sharingService.isUserPremium(),c=l.default.isFeatureEnabled({ODC:"FamilySharing"})&&h.supportsFamily(this._clientId),p=c?this._sharingService.getFamily():new Promise(function(e){e()}),d=c?this._sharingService.getFamilyMembers():new Promise(function(e){e()}),v=new o.default;Promise.all([this._toTuple(i),this._toTuple(a),this._toTuple(f),this._toTuple(p),this._toTuple(d)]).then(function(i){var a=i[0],f=i[1],l=i[2],h=i[3],p=i[4];if(t._isError(a)||t._isError(f)||t._isError(l)){if(t._isError(a)){var d=a.error;t._sharingInformation=n.__assign(n.__assign({},t._sharingInformation),{error:s.getResultCodeFromError(d),errorCategory:5,debugErrorMessage:JSON.stringify(a),errorMessage:d.message||u.default.getSharingInformationError});v.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Item Error: "+t._sharingInformation.error,extraData:{error:d}});t._emitChange();return}if(t._isError(f)){d=f.error;t._sharingInformation=n.__assign(n.__assign({},t._sharingInformation),{error:s.getResultCodeFromError(d),errorCategory:6,debugErrorMessage:JSON.stringify(f),errorMessage:d.message||u.default.getSharingInformationError});v.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Me Error: "+t._sharingInformation.error,extraData:{error:d}});t._emitChange();return}if(t._isError(l)){d=l.error;t._sharingInformation=n.__assign(n.__assign({},t._sharingInformation),{error:s.getResultCodeFromError(d),errorCategory:7,debugErrorMessage:JSON.stringify(l),errorMessage:d.message||u.default.getSharingInformationError});v.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Drive Error: "+t._sharingInformation.error,extraData:{error:d}});t._emitChange();return}}else{v.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Success});var m=a.value;t._currentUserId=f.value;t._itemId=m.id;t._isPremium=l.value;var g=t._getOwnerPrincipal(m),y=void 0;y=e?t._sharingService.getPermissions(t._itemId):new Promise(function(e,t){e([])});if(c&&!t._isError(h)&&!t._isError(p)){var b=t._parseFamilyInfo(h.value.id,p.value.value),w=b.family,E=b.familyMembers;t._family=w;t._familyMembers=E}var S=5,x=r.SharingAudience.anyone;if(t._audience===r.SharingAudience.specificPeople){S=1;x=r.SharingAudience.specificPeople}else t._isEdit||(S=4);y.then(function(n){t._permissions=n;var r,i,s=t._parsePermissions(n),o=s.principals,u=s.sharingLinks;o=[g].concat(o);t._sharingInformation={anonymousLinkExpirationRestrictionDays:-1,blockPeoplePickerAndSharing:!1,canAddExternalPrincipal:!0,canAddInternalPrincipal:!0,canManagePermissions:!0,canRequestAccessForGrantAccess:!0,defaultShareLinkToExistingAccess:!1,defaultSharingLink:{allowsAnonymousAccess:!0,audience:x,expiration:null,isActive:!0,isEdit:t._isEdit,principals:[],shareId:null,sharingLinkKind:S,url:null,createdViaCopyLinkCommand:null,invitees:[],isReview:!1,updatePassword:!1,password:null,hasPassword:!1,blockDownload:!1,passwordLastModifiedBy:null},hasInheritedLinks:!1,isShared:!0,item:{name:t._itemName,hasDlpPolicy:!1,childCount:0},fileExtension:"",sharingLinks:u,sharingPrincipals:o,peoplePickerSettings:{},userDisplayName:"",error:null,errorCategory:null,errorMessage:null,debugErrorMessage:null,requiresAccessApproval:!1,userRole:g.id===t._currentUserId?3:null,defaultShareLinkPermission:t._isEdit?2:1,defaultLinkKind:null,sharingAbilities:(r={enabled:!0,disabledReason:null},i={canGetEditLink:r,canGetReviewLink:r,canGetReadLink:r,canHaveExternalUsers:r,canManageEditLink:r,canManageReviewLink:r,canManageReadLink:r,linkExpiration:{defaultExpirationInDays:-1,enabled:!0,disabledReason:null},canRequestAccessForGrantAccess:r,canAddInternalPrincipal:r,canAddExternalPrincipal:r,supportsReviewPermission:r,supportsRestrictedView:r,canAddNewExternalPrincipals:r},{anonymousLinkAbilities:i,organizationLinkAbilities:i,peopleSharingLinkAbilities:i,directSharingAbilities:i}),directLink:null,hasPermissionsInformation:t._sharingInformation&&t._sharingInformation.hasPermissionsInformation||e,isGraphAvailable:!0,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0,peoplePickerError:void 0};t._emitChange()},function(e){t._sharingInformation=n.__assign(n.__assign({},t._sharingInformation),{error:s.getResultCodeFromError(e),errorCategory:4,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||u.default.getSharingInformationError});t._emitChange()})}})};e.prototype.shareLink=function(e){var t=e.settings,n=e.recipients,r=e.emailMessage,i=e.copyLinkCommand;n&&0!==n.length?this._shareViaInvite(t,n,r):i?this._createSharingLink(t,{useOldPassword:!0}):this._createSharingLink(t)};e.prototype._parseFamilyInfo=function(e,t){var n=t.map(function(e){return{userId:e.id,name:e.firstName+" "+e.lastName,email:e.userPrincipalName,isResolved:!0,familySharingTargetType:p.FamilySharingTargetType.FamilyMember}}),r=t[0].firstName;t.forEach(function(e,t){0!==t&&(r+=", "+e.firstName)});return{family:{userId:e,name:u.default.familyGroupName,email:r,isExternal:!1,isResolved:!0,entityType:2,familySharingTargetType:p.FamilySharingTargetType.Family},familyMembers:n}};e.prototype._getOwnerPrincipal=function(e){var t,n;if(e.shared&&e.shared.owner&&e.shared.owner.user){t=e.shared.owner.user.id;n=e.shared.owner.user.displayName}return{id:t||"",isExternal:!1,loginName:"",primaryText:n||"",secondaryText:"",role:3,type:i.default.user,imageUrl:"",email:""}};e.prototype._parsePermissions=function(e){for(var t=[],n=[],s=[],o=0,u=e;o<u.length;o++){var a=u[o];if(a.grantedTo&&a.grantedTo.user&&a.grantedTo.user.id){if(-1===s.indexOf(a.grantedTo.user.id)){var f=a.invitation&&a.invitation.email||a.grantedTo.user.displayName,l={id:a.grantedTo.user.id,isExternal:!1,loginName:f,primaryText:a.grantedTo.user.displayName||f,secondaryText:"",role:"write"===a.roles[0]?2:1,type:i.default.user,imageUrl:"",email:f};n.push(l);s.push(l.id)}}else if(a.link){var c={allowsAnonymousAccess:!0,audience:r.SharingAudience.anyone,expiration:a.expirationDateTime,isActive:!0,isEdit:"edit"===a.link.type,principals:[],shareId:a.shareId,sharingLinkKind:"edit"===a.link.type?5:4,url:a.link.webUrl,createdViaCopyLinkCommand:!a.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:a.hasPassword,blockDownload:!1,application:a.link.application};t.push(c)}}return{principals:n,sharingLinks:t}};e.prototype._shareViaInvite=function(e,t,i){var o,a=this,f=t.map(function(e){var t={objectId:e.userId};c.default.isValidEmailSyntax(e.email,!1)&&(t.email=e.email);e.entityType&&2===e.entityType&&(t.permissionIdentityTypeInput="Group");return t}),l=e.isEdit?"write":"read",h=e.password,p=e.expiration;if(this._itemId||this.isBundleShare()){var d={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],recipients:f,message:i,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:h,expiration:p,bundleName:this._bundleName};o=this._sharingService.invite(d)}else{d={itemUrl:this._itemUrl,recipients:f,message:i,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:h,expiration:p};o=this._sharingService.inviteFromItemUrl(d)}o.then(function(t){var n=t[0],i="edit"===n.link.type?5:4;a._shareLink={allowsAnonymousAccess:!0,audience:e.requireSignIn?r.SharingAudience.specificPeople:r.SharingAudience.anyone,expiration:n.expirationDateTime,isActive:!0,isEdit:"edit"===n.link.type,principals:[],shareId:"",sharingLinkKind:i,url:n.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:n.hasPassword,blockDownload:n.preventDownload,passwordLastModifiedBy:null};a._grantAccessResult=!0;a._emitChange()},function(e){var t=s.getResultCodeFromError(e);if(["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"].indexOf(t)>-1)a._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message);else{a._sharingInformation=n.__assign(n.__assign({},a._sharingInformation),{error:t,errorCategory:8,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||u.default.getSharingInformationError});e.response&&e.response.error&&e.response.error.fixItUrl&&(a._sharingInformation.fixItUrl=e.response.error.fixItUrl)}a._grantAccessResult=!1;a._emitChange()})};e.prototype._createSharingLink=function(e,t){var i,o=this,a=e.isEdit?"edit":"view",f=e.preventDownload,l=t&&t.useOldPassword?null:e.password,c=e.expiration;if(this._itemId||this.isBundleShare()){var h={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],type:a,scope:"anonymous",preventDownload:f,password:l,expiration:c,bundleName:this._bundleName};i=this._sharingService.createLink(h)}else{h={itemUrl:this._itemUrl,type:a,scope:"anonymous",preventDownload:f,password:l,expiration:c};i=this._sharingService.createLinkFromItemUrl(h)}i.then(function(e){var t="edit"===e.link.type?5:4;o._shareLink={allowsAnonymousAccess:!0,audience:r.SharingAudience.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:"",sharingLinkKind:t,url:e.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:e.preventDownload,passwordLastModifiedBy:null};o._grantAccessResult=!0;o._emitChange()},function(e){o._sharingInformation=n.__assign(n.__assign({},o._sharingInformation),{error:s.getResultCodeFromError(e),errorCategory:2,errorMessage:e.message||u.default.getSharingInformationError});o._grantAccessResult=!1;o._emitChange()})};e.prototype.getCurrentUserId=function(){return this._currentUserId};e.prototype.unshareLink=function(e,t){for(var n,r=this,i=0,s=this._permissions;i<s.length;i++){var o=s[i];o.shareId===t&&(n=o)}var u=n.inheritedFrom?n.inheritedFrom.id:this._itemId;(u?this._sharingService.unshareLink(u,n.id):this._sharingService.unshareLinkFromItemUrl(this._itemUrl,n.id)).then(function(){r.fetchSharingInformation(!0)})};e.prototype.getSharingLinkCreated=function(){return this._shareLink};e.prototype.updatePermissions=function(e,t){for(var n=this,r=[],i=0,s=this._permissions;i<s.length;i++){var o=s[i];o.grantedTo&&o.grantedTo.user&&o.grantedTo.user.id===e.id&&r.push(o)}for(var u=0,a=r;u<a.length;u++){var f=a[u],l=f.inheritedFrom?f.inheritedFrom.id:this._itemId;switch(t){case 0:this.unshareLink(5,f.shareId);break;case 2:(l?this._sharingService.updatePermissions(l,f.id,"write"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,f.id,"write")).then(function(e){n.fetchSharingInformation(!0)});break;default:(l?this._sharingService.updatePermissions(l,f.id,"read"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,f.id,"read")).then(function(e){n.fetchSharingInformation(!0)})}}};e.prototype.getDefaultRecipients=function(){return this._defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._defaultRecipients={isConsumed:!0,recipients:this._defaultRecipients.recipients}};e.prototype.grantAccess=function(e){this.shareLink({recipients:e,settings:{allowEditing:!0,isEdit:!0,audience:r.SharingAudience.anyone,specificPeople:null,expiration:null,password:null,sharingLinkKind:1,updatePassword:!1,sendInvitation:!1}})};e.prototype.getGrantAccessResult=function(){return this._grantAccessResult};e.prototype.isPeopleSharingLinksEnabled=function(){return!1};e.prototype.showManageAccess=function(){return!1};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return this._isPremium};e.prototype.isPreventDownloadAllowed=function(){return!1};e.prototype.setAddressBarLinkCapability=function(e){};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.isBundleShare=function(){return this._isBundleShare};e.prototype.getNavId=function(){return this._navId};e.prototype.getSupportedAudienceOptions=function(){return l.default.isFeatureEnabled(v)?[r.SharingAudience.anyone,r.SharingAudience.specificPeople]:[r.SharingAudience.anyone]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!0};e.prototype.showAudienceLearnMore=function(){return!1};e.prototype.resetPeoplePickerError=function(){this._sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._tryResolveDefaultRecipients=function(e,t){var n=this;if(e&&0!==e.length){this._defaultRecipients=void 0;this._isValidatingDefaultRecipients=!0;if(t)try{for(var r=[],i=[],s=0,o=e;s<o.length;s++){var u=o[s];i.push(t.resolve(u,{}).then(function(e){r.push(e)}))}Promise.all(i).then(function(){n._setDefaultRecipients(r)},function(){n._setUnresolvedDefaultRecipients(e)})}catch(t){this._setUnresolvedDefaultRecipients(e)}else this._setUnresolvedDefaultRecipients(e)}else this._isValidatingDefaultRecipients=!1};e.prototype._setDefaultRecipients=function(e){e.map(function(e){e.name=e.name||e.email});this._defaultRecipients={isConsumed:!1,recipients:e};this._isValidatingDefaultRecipients=!1;this._emitChange()};e.prototype._setUnresolvedDefaultRecipients=function(e){this._setDefaultRecipients(e.map(function(e){return{userId:e,name:e,email:e,isResolved:c.default.isValidEmailSyntax(e,!1)}}))};e.prototype.showEmailsInSuggestions=function(){return!0};e.prototype.getFamily=function(){return this._family};e.prototype.getFamilyMembers=function(){return this._familyMembers};e.prototype.getItemInformationForLogging=function(){return{itemType:void 0,extension:void 0}};e.prototype._toTuple=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};return e})();t.default=g});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedSharingWrapper",["require","exports","tslib","react","prop-types","@ms/odsp-shared-sharing/lib/components/AtMention/AtMention","office-ui-fabric-react/lib/FocusTrapZone"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.getChildContext=function(){return{resize:this.props.resizeCallback,onDismiss:this.props.dismissCallback,sharingStore:this.props.sharingStore,platformDetection:this.props.platformDetection,shareClickTime:this.props.shareClickTime}};t.prototype.render=function(){var e=this.props.mentionProps;return r.createElement(o.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement(s.AtMention,n.__assign({},e)))};t.childContextTypes={resize:i.func.isRequired,onDismiss:i.func.isRequired,sharingStore:i.object.isRequired,platformDetection:i.object.isRequired,shareClickTime:i.number};return t})(r.Component);t.default=u});
define("odsp-next/dataSources/itemActivityFeed/odc/ItemCommentsDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/dataSources/itemComments/odc/ItemCommentsDataSource","./ItemCommentsResultProcessor","../../base/vroom/VroomDataRequestor","../../graph/odc/GraphDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemCommentsDataSource=r.ItemCommentsDataSource;t.resourceKey=n.createResolvedResourceKey(e("module").id,r.ItemCommentsDataSource,{vroomDataRequestor:s.resourceKey,itemCommentsResultProcessor:i.resourceKey,graphDataSource:o.resourceKey})});
define("@ms/odsp-datasources/lib/dataSources/itemComments/odc/ItemCommentsDataSource",["require","exports","@ms/odsp-graph/lib/services/itemComments/ItemCommentsService","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._itemCommentsService=new n.ItemCommentsService(e=e,{vroomDataRequestor:t.vroomDataRequestor,itemCommentsResultProcessor:t.itemCommentsResultProcessor});this._graphDataSource=t.graphDataSource}e.prototype.getComments=function(e){var t=this.getGraphItemUrlV2dot1(e.itemWrapper);return this._itemCommentsService.getComments(t,e)};e.prototype.addComment=function(e,t,n){var r=this.getGraphItemUrlV2dot1(e);return this._itemCommentsService.addComment(r,e,t,n)};e.prototype.deleteCommentById=function(e,t){var n=this.getGraphItemUrlV2dot1(e);return this._itemCommentsService.deleteCommentById(n,e,t)};e.prototype.addReply=function(e,t,n){throw new Error("Method not implemented.")};e.prototype.getReplies=function(e,t){return r.default.resolve(void 0)};e.prototype.getIsCommentsDisabled=function(e){var t=this.getGraphItemUrlV2dot1(e);return this._itemCommentsService.getIsCommentsDisabled(t,e)};e.prototype.setCommentsDisabled=function(e,t){void 0===t&&(t=!0);var n=this.getGraphItemUrlV2dot1(e);return this._itemCommentsService.setCommentsDisabled(n,e,t)};e.prototype.deleteAllComments=function(e){throw new Error("Method not implemented.")};e.prototype.getGraphItemUrlV2dot1=function(e){return this._graphDataSource.getItemUrl(e.item,{useDirectEndpoint:!0,apiVersion:"v2.1"})};return e})();t.ItemCommentsDataSource=i});
define("@ms/odsp-graph/lib/services/itemComments/ItemCommentsService",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={folderDoesNotExist:!0,itemNotFound:!0,accessDenied:!0,unauthenticated:!0},i=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor;this._itemCommentsResultProcessor=t.itemCommentsResultProcessor}e.prototype.getComments=function(e,t){var n=this,i=this._getRequestUrl(e,t);return this._dataRequestor.send({apiName:"ItemActivityFeed.GetItemComments",path:i,accessToken:t.itemWrapper.activityItemWrapper.accessToken,expectedErrorCodes:r}).then(function(e){return n._itemCommentsResultProcessor.processResponse({item:t.itemWrapper,response:e})},function(e){return{comments:[],success:!1,isPermanentFailure:e.isExpected}})};e.prototype.addComment=function(e,t,i,s){var o=e+"/comments",u=s&&s.length>0?{content:i,mentioned:s}:{content:i};return this._dataRequestor.send({apiName:"ItemActivityFeed.AddItemComments",path:o,accessToken:t.activityItemWrapper.accessToken,requestType:"POST",useAuthorizationHeaders:!0,getErrorAsMessage:!0,postData:JSON.stringify(u),expectedErrorCodes:r}).then(function(e){return e},function(e){return n.default.reject({code:e.error.code,message:{lang:"",value:e.error.message}})})};e.prototype.deleteCommentById=function(e,t,i){var s=e+"/comments/"+i;return this._dataRequestor.send({path:s,apiName:"ItemActivityFeed.DeleteCommentById",requestType:"DELETE",accessToken:t.activityItemWrapper.accessToken,useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:r}).then(function(e){return n.default.resolve(!0)},function(e){return n.default.reject(e)})};e.prototype.getIsCommentsDisabled=function(e,t){var i=e+"?$select=id,commentMetadata";return this._dataRequestor.send({apiName:"ItemActivityFeed.GetIsCommentsDisabled",path:i,accessToken:t.activityItemWrapper.accessToken,requestType:"GET",expectedErrorCodes:r}).then(function(e){return e&&e.commentSettings&&e.commentSettings.commentingDisabled&&!!e.commentSettings.commentingDisabled.isDisabled},function(e){return n.default.reject(e)})};e.prototype.setCommentsDisabled=function(e,t,r){var i=e,s={id:t.item.itemId,commentSettings:{commentingDisabled:{isDisabled:r}}};return this._dataRequestor.send({apiName:"ItemActivityFeed.SetCommentsDisabled",path:i,accessToken:t.activityItemWrapper.accessToken,requestType:"PATCH",useAuthorizationHeaders:!0,getErrorAsMessage:!0,postData:JSON.stringify(s)}).then(function(e){return!0},function(e){return n.default.reject(e)})};e.prototype._getRequestUrl=function(e,t){var n;if(t.nextLink)n=t.nextLink;else{n=e+"/comments?";n+="$top="+(t.pageSize||25)}return n};return e})();t.ItemCommentsService=i});
define("odsp-next/dataSources/itemActivityFeed/odc/ItemCommentsResultProcessor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-graph/lib/services/itemComments/ItemCommentsResultProcessor"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.ItemCommentsResultProcessor,{})});
define("@ms/odsp-graph/lib/services/itemComments/ItemCommentsResultProcessor",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,n=e.item,r=e.response,i=r.value.map(function(e){return t._processCommentResponse(n,e)});return{nextLink:r["@odata.nextLink"],inlineCount:i.length,comments:i,success:!0}};e.prototype._processCommentResponse=function(e,t){var r=this._extractDetailFromCommentSingleLevel(t),i={comment:{commentId:t.id,commentDetail:n.__assign(n.__assign({},r),{replies:{comments:[],success:!0}})}};return{id:e.item.id+"_"+t.id,item:e.activityItemWrapper,type:2,actors:[r.author],action:i,time:new Date(t.createdDateTime),friendlyDisplayTime:t.createdDateTime}};e.prototype._extractDetailFromCommentSingleLevel=function(e){return e&&{id:e.id,author:e.createdBy.user,text:e.content,createdDate:new Date(e.createdDateTime),parentId:e.parentId,replyCount:e.replyCount,friendlyDisplayTime:e.createdDateTime}};return e})();t.ItemCommentsResultProcessor=r});
define("odsp-next/dataSources/checkUserAccess/CheckUserAccessDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/dataSources/checkUserAccess/CheckUserAccessDataSource","../base/vroom/VroomDataRequestor"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckUserAccessDataSource=r.CheckUserAccessDataSource;t.resourceKey=n.createResolvedResourceKey(e("module").id,r.CheckUserAccessDataSource,{vroomDataRequestor:i.resourceKey})});
define("@ms/odsp-datasources/lib/dataSources/checkUserAccess/CheckUserAccessDataSource",["require","exports","@ms/odsp-graph/lib/services/checkUserAccess/CheckUserAccessService"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._checkUserAccessService=new n.CheckUserAccessService({},{vroomDataRequestor:t.vroomDataRequestor})}e.prototype.checkUserAccess=function(e,t){return this._checkUserAccessService.checkUserAccess(e,t)};return e})();t.CheckUserAccessDataSource=r});
define("@ms/odsp-graph/lib/services/checkUserAccess/CheckUserAccessService",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor}e.prototype.checkUserAccess=function(e,t){var i=e+"/checkAccess",s={value:n.__spreadArrays(t)};return this._dataRequestor.send({apiName:"checkAccess",path:i,requestType:"POST",useAuthorizationHeaders:!0,getErrorAsMessage:!0,postData:JSON.stringify(s)}).then(function(e){return r.default.resolve(e.value)},function(e){return r.default.reject(e)})};return e})();t.CheckUserAccessService=i});
define("odsp-next/controls/list/TilesList",["require","exports","tslib","./TilesList.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./viewModels/TilesListViewModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-tiles-list",template:r.default,viewModel:(function(e){n.__extends(t,e);function t(t){return e.call(this,t,t.resources.resolve(s.default.dependencies))||this}return t})(s.default),synchronous:!0});t.default=o});
define("odsp-next/controls/list/TilesList.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-TilesList" data-bind="react:{componentType:tilesListComponentType,props:tilesListProps}"></div>'});
define("odsp-next/controls/list/viewModels/TilesListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/react/ReactBinding","../react/tilesList/TilesList.key","../../../resources/ControlResourceKeys","../../../utilities/browser/ResponsiveUI","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({react:i.default});var s=r.resources;s.block(f.asyncLoadBarrierKey);t.selectionModel&&t.selectionModel!==s.consume(o.itemsSelection.optional)&&s.expose(o.itemsSelection,t.selectionModel);var l=n.responsiveUI,c=void 0===l?s.consume(u.resourceKey):l;r._responsiveUI=c;r._currentItemSet=t.itemSet;r._requiredRange=t.requiredRange;r._onLayoutRenderComplete=t.onLayoutRenderComplete;r._onUpdateRequiredRange=r._onUpdateRequiredRange.bind(r);r.tilesListComponentType=a.ResourcedControl;r.tilesListProps=r.observables.pureCompute(r._computeTilesListProps);return r}t.prototype._computeTilesListProps=function(){var e=this._currentItemSet(),t=e.content(),n=this._responsiveUI.compareSize(this._responsiveUI.formFactorSize(),"Large")>0?"large":"small";return{resources:this.resources,specification:a.toSpecification(s.typeResourceKey.local,{setKey:e.item&&e.item.peek().key,itemSetContent:t,tilesListSize:n,onLayoutRenderComplete:this._onLayoutRenderComplete,onUpdateRequiredRange:this._onUpdateRequiredRange})}};t.prototype._onUpdateRequiredRange=function(e){this._requiredRange&&this._requiredRange(e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{responsiveUI:u.resourceKey});return t})(r.default);t.default=l});
define("odsp-next/controls/list/react/tilesList/TilesList.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./TilesList"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/controls/tooltip/TooltipContainer",["require","exports","office-ui-fabric-react/lib/Tooltip"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.Tooltip});
define("odsp-next/controls/columnsHeader/SortColumnCommandHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../commands/Command","./ColumnCommonUtilities","../../resources/ControlResourceKeys","../../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.column,o=t.engagementName,u=n.actionMap,a=n.rumOneHelper,f=[],l=s.getSortMenuStrings(i),c=l.ascendingString,h=l.descendingString,p=function(){a&&a.logFilterSort("Sort")},d=r.scope.attached(n.commandViewModelType);f.push(new d({text:c,isToggleable:!0,engagementName:"SortAscending"+o,reportClickingTime:p,action:new(r.child(u.SortAction))({column:i,ascending:!0})}));f.push(new d({text:h,isToggleable:!0,hasLineBreakAfter:!0,engagementName:"SortDescending"+o,reportClickingTime:p,action:new(r.child(u.SortAction))({column:i,ascending:!1})}));r.commands=f;return r}t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{actionMap:o.actionMap,rumOneHelper:u.rumOneHelper.optional,commandViewModelType:i.typeResourceKey});return t})(r.default);t.SortColumnCommandHelper=f;t.typeResourceKey=new a.ResourceKey({name:e("module").id,factory:new a.ResolvedResourceTypeFactory(f)});t.default=f});
define("odsp-next/controls/columnsHeader/ColumnCommonUtilities",["require","exports","../../bindings/beakAdorner/BeakAdornerBinding","@ms/odsp-utilities/lib/math/Point","./ColumnsHeader.resx","@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MENU_OFFSET=new r.default(0,n.default.size/2+12);t.getSortMenuStrings=function(e){return s.getSortMenuStrings(e,i.default)};t.getFieldName=function(e){return e?e.internalName||e.key:null}});
define("@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities",["require","exports","@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSortMenuStrings=function(e,t){var r="",i="";switch(e.fieldType){case n.ColumnFieldType.DateTime:case n.ColumnFieldType.FileActivity:r=t.columnMenuSortAscendingDate;i=t.columnMenuSortDescendingDate;break;case n.ColumnFieldType.Number:case n.ColumnFieldType.Currency:case n.ColumnFieldType.Counter:case n.ColumnFieldType.FileSize:case n.ColumnFieldType.Ratings:case n.ColumnFieldType.AverageRating:case n.ColumnFieldType.Likes:r=t.columnMenuSortAscendingNumber;i=t.columnMenuSortDescendingNumber;break;case n.ColumnFieldType.Text:case n.ColumnFieldType.Name:case n.ColumnFieldType.Title:case n.ColumnFieldType.Note:case n.ColumnFieldType.Taxonomy:case n.ColumnFieldType.User:r=t.columnMenuSortAscendingText;i=t.columnMenuSortDescendingText;break;case n.ColumnFieldType.Boolean:case n.ColumnFieldType.ComplianceRecordFlag:r=t.columnMenuSortAscendingBoolean;i=t.columnMenuSortDescendingBoolean;break;case n.ColumnFieldType.Lookup:if("Last_x0020_Modified"===e.internalName||"Created_x0020_Date"===e.internalName){r=t.columnMenuSortAscendingDate;i=t.columnMenuSortDescendingDate}else{r=t.columnMenuSortAscending;i=t.columnMenuSortDescending}break;case n.ColumnFieldType.Attachments:r=t.columnMenuSortAscendingAttachments;i=t.columnMenuSortDescendingAttachments;break;default:r=t.columnMenuSortAscending;i=t.columnMenuSortDescending}return{ascendingString:r,descendingString:i}}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums",["require","exports","../../../interfaces/list/ColumnFieldType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColumnFieldType=n.ColumnFieldType;(function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=280]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"})(t.ColumnWidth||(t.ColumnWidth={}));(function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.shareHeroCommand=5]="shareHeroCommand";e[e.modified=6]="modified";e[e.url=7]="url"})(t.MappedColumnType||(t.MappedColumnType={}));(function(e){e[e.none=0]="none";e[e.notify=1]="notify";e[e.block=2]="block";e[e.notifyAndBlock=3]="notifyAndBlock";e[e.blockSharing=4]="blockSharing"})(t.PolicyTipType||(t.PolicyTipType={}));(function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"})(t.ShowInFiltersPaneStatus||(t.ShowInFiltersPaneStatus={}));(function(e){e[e.fileNotFound=-2147024894]="fileNotFound";e[e.invalidView=-2147024809]="invalidView";e[e.listNotFound=-1]="listNotFound";e[e.docAlreadyExists=-2130575257]="docAlreadyExists";e[e.queryThrottled=-2147024860]="queryThrottled";e[e.newExperieceRenderingNotSupported=-2]="newExperieceRenderingNotSupported";e[e.onePageNavigationViewMismatch=-3]="onePageNavigationViewMismatch";e[e.onePageNavigationError=-4]="onePageNavigationError"})(t.ErrorType||(t.ErrorType={}))});
define("odsp-next/actions/rotate/RotateItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/item/ItemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._itemProvider=n.itemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.rotateItems;n.payloads={rotateItems:{item:r,parent:r.parent}};return n};t.prototype.onStart=function(e){var t=this._context.items.map(function(e){return new r.Task(e.key,e)});e.update(t);return this._itemProvider.rotateItems({items:t.map(function(e){return e.input}),rotation:this._context.rotation,parentKey:this._context.parentKey},e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemProvider:i.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/teachingBubble/TeachingBubbleHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r.canShowTeachingBubbles=r.observables.pureCompute(r._computeCanShowTeachingBubble).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});return r}t.prototype._computeCanShowTeachingBubble=function(){return this._firstRunExperienceStatus()===o.FirstRunExperienceStatus.notVisible};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{firstRunExperienceStatus:s.resourceKey});return t})(r.default);t.TeachingBubbleHelper=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/controls/iFrameDialog/IFrameDialog",["require","exports","./IFrameDialog.html","./IFrameDialogViewModel","../../bindings/component/ControlBinding","ODCDeferred_css","../iframeLoader/IframeLoader"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-iframe-dialog",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/iFrameDialog/IFrameDialog.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-IFrameDialog" data-bind="css:{\'od-IFrameDialog--maxHeight\':maxHeight}"><iframe frameborder="0" data-bind="attr:{src:componentUrl},event:{load:iframeOnLoad},visible:!isLoading()" style="width:100%"></iframe><label class="od-Dialog-subText" data-bind="text:loadingLabel,visible:isLoading"></label><div class="od-IFrameDialog-ProgressContainer" data-bind="visible:isLoading"><div data-bind="component:{name:progressSpinnerFlatTagName}"></div></div></div>'});
define("odsp-next/controls/iFrameDialog/IFrameDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./IFrameDialog.resx","../../providers/dialog/DialogProvider","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/locale/Locale","../../utilities/iframe/IframeHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.loadingLabel=i.default.IFrameDialogLoadingLabel;r.progressSpinnerFlatTagName=u.default.tagName;r._isIframeAvailable=!0;r._navigation=n.navigation;r._dialogProvider=n.dialogProvider;r.isLoading=o.observable(!0);r.componentUrl=t.componentUrl;r.showInDialog=t.showInDialog;r.heightOffset=t.heightOffset;r.forceSharePointScrollbar=t.forceSharePointScrollbar;r.maxHeight=t.maxHeight;r.addDisposable({dispose:function(){l.disposeIframe(r._iframeElement,function(){r._isIframeAvailable=!1})}});return r}t.prototype.iframeOnLoad=function(e,t){var n=this;if(this._isIframeAvailable){this._iframeElement=t.target;var r=this._iframeElement;r&&r.contentWindow&&this.async.setTimeout(function(){n.showInDialog&&n._setupIframeElementFunctions(r);n.isLoading(!1);if(!n.maxHeight){r.style.height=document.body.clientHeight*n.heightOffset+"px";n._modifyFramedPageHeight(r)}if(n.forceSharePointScrollbar){var e=r.contentWindow.document.getElementById("s4-workspace");if(e){f.default.isRightToLeft?e.style.paddingLeft="10px":e.style.paddingRight="10px";e.style.boxSizing="border-box"}}},10)}};t.prototype._modifyFramedPageHeight=function(e){var t=e.contentWindow.document.getElementById("s4-workspace");t&&(t.style.height=e.style.height)};t.prototype._setupIframeElementFunctions=function(e){var t=this,n=function(e){t._navigation.navigateTo(e)};e.cancelPopUp=function(){t._dialogProvider.currentDialog().dismiss()};e.commitPopup=function(e){"string"==typeof e&&"{"!==e[0]?n(e):t._dialogProvider.currentDialog().complete()};e.navigateParent=n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{dialogProvider:s.resourceKey,navigation:a.navigation});return t})(r.default);t.default=c});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost",["require","exports","./LegacyDetailsPaneHost.html","./LegacyDetailsPaneHostViewModel","../../../bindings/component/ControlBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-legacy-details-pane-host",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:useNewDetailsPane--\x3e<div data-bind="react:{componentType:detailsPaneComponentType,props:detailsPaneProps}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:useNewDetailsPane--\x3e\x3c!--ko control:{specification:knockoutSpecification,placeholder:knockoutPlaceholder}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../detailsPane/DetailsPaneWrapper","../../../bindings/react/ReactBinding","../../../utilities/features/Features","../../infoPane/InfoPane.key","../../progressSpinnerFlat/ProgressSpinnerFlat","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.useNewDetailsPane=u.isFeatureEnabled(u.EnableNewDetailsPane);if(r.useNewDetailsPane){r.addBindingHandlers({react:o.default});r.detailsPaneComponentType=i.ResourcedControl;r.detailsPaneProps=r.observables.pureCompute(function(){return{resources:r.resources,specification:i.toSpecification(s.typeResourceKey.local,{})}})}else{r.addBindingHandlers({control:l.default});r.knockoutSpecification=l.toSpecification(a.resourceKey,{showSections:t.showSections});r.knockoutPlaceholder=l.toSpecification(f.resourceKey,{})}return r}t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=c});
define("odsp-next/controls/detailsPane/DetailsPaneWrapper",["require","exports","tslib","react","prop-types","../../resources/ProviderResourceKeys","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch","react","office-ui-fabric-react/lib/common/DirectionalHint","../itemsScope/ItemScopeTeachingBubbleCoachmarkContainer","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../models/teachingBubble/TeachingBubbleCampaigns","../../providers/coachmark/CoachmarkProvider","./DetailsPaneId","./KnockoutDetailsPaneHost","../../dataSources/infoPane/InfoPaneManager.key","office-ui-fabric-react/lib/Utilities","../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._getCoachmark=function(){if(i._allowCoachmark){var e=i._getTeachingBubbleCampaign();return i.state.showCoachmark&&i._root&&i._root.current?r.createElement(h.ItemScopeTeachingBubbleCoachmarkContainer,{target:i._root.current,teachingBubbleCampaign:e,directionalHint:c.DirectionalHint.leftCenter,onDismiss:i._onDismissTeachingBubble,onTeachingBubbleSeen:i._onTeachingBubbleSeen}):void 0}};i._onDismissTeachingBubble=function(){var e=i._coachmarkProvider;e&&e.hideCampaign();var t=i._getTeachingBubbleCampaign();i._teachingBubbleProvider&&i._teachingBubbleProvider.markBubbleAsDismissed(t);v.Engagement.logData({name:"DocSetPropertiesCoachmark.Closed"})};i._onTeachingBubbleSeen=function(){var e=i._getTeachingBubbleCampaign();i._teachingBubbleProvider&&i._teachingBubbleProvider.markBubbleAsSeen(e);v.Engagement.logData({name:"DocSetPropertiesCoachmark.Rendered"})};var s=i.context.dependencies.resources;i._root=l.createRef();i._scope=new p.default;i._coachmarkProvider=s.consume(g.resourceKey.optional);i._observables=i._scope.attach(new(s.consume(d.observablesFactoryTypeResourceKey))({owner:i}));var o=m.DOCSET_PROPERTIES_PANE.killSwitchGuid;i._allowCoachmark=a.isFeatureEnabled(m.DOCSET_PROPERTIES_PANE.flag)&&(!o||!f.default.isActivated(o));i.state={allSectionGroups:void 0,showCoachmark:!1};return i}t.prototype.componentDidMount=function(){var e=this;this._addStoreListener(this.props);this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentDidUpdate=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.detailsPane,n=e.resources,i=this.state.allSectionGroups,s=n.consume(y.resourceKey),o=a.isFeatureEnabled(a.EnableNewDetailsPane)&&!n.consume(S.resourceKey);return i?r.createElement(r.Fragment,null,r.createElement("div",{className:E.css("od-DetailsPaneWrapper",{isFluent:o}),ref:this._root},r.createElement(t,{allSectionGroups:i,id:s,resources:n})),this._getCoachmark()):null};t.prototype._getTeachingBubbleCampaign=function(){return m.DOCSET_PROPERTIES_PANE};t.prototype._addStoreListener=function(e){var t=this;this.context.dependencies.resources.consumeAsync(w.typeResourceKey).then(function(e){var n=t._scope.attach(new e({}));t.setState({allSectionGroups:n.getSectionGroups()})})};t.prototype._computeShowCoachmark=function(){var e=this;if(this._allowCoachmark){var t=this._coachmarkProvider;if(t){var n=this._observables.unwrap(t.getCurrentTeachingBubble());if(!n)return;if(n){var r=this._observables.unwrap(n.isVisible||!1),i=n.campaign();if(!i||i.campaignGuid!==this._getTeachingBubbleCampaign().campaignGuid){this.state.showCoachmark&&this.setState({showCoachmark:!1});return}var o=this.context.dependencies.resources;this._teachingBubbleProvider||(this._teachingBubbleProvider=o.consume(s.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(i,!1).then(function(t){var n=!!(t&&r&&e._root&&e._root.current);e.state.showCoachmark!==n&&e.setState({showCoachmark:n})})}}}};t.contextTypes={dependencies:i.object.isRequired};return t})(r.Component);t.default=x;t.typeResourceKey=o.createResolvedComponentTypeResourceKey(e("module").id,x,{resources:u.resourceScopeKey.local,detailsPane:b.resourceKey})});
define("odsp-next/controls/itemsScope/ItemScopeTeachingBubbleCoachmarkContainer",["require","exports","tslib","react","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Coachmark","../../models/teachingBubble/TeachingBubble.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../models/flow/FlowHelpers"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){a.Engagement.logData({name:t._getEngagementNamePrefix()+".Close",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()};t._onTeachingBubbleSeen=function(){a.Engagement.logData({name:t._getEngagementNamePrefix()+".Rendered",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()};t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid};t._getEngagementNamePrefix=function(){return t.props.teachingBubbleCampaign.isCoachmark?"Coachmark":"TeachingBubble"};return t}t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,a=t.onAnimationOpenStart,l=t.directionalHint;e=n.automateExperimentBodyCopy&&f.isAutomateExperimentOn()?n.automateExperimentBodyCopy:n.bodyCopy;return n.isCoachmark?r.createElement(o.Coachmark,{target:this.props.target,positioningContainerProps:{directionalHint:l||s.DirectionalHint.bottomCenter},styles:n.styles,onAnimationOpenStart:a,persistentBeak:n.persistentBeak,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},r.createElement(i.TeachingBubbleContent,{headline:n.title,illustrationImage:n.illustrationImage,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:u.default.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!n.disableCondensedHeadline},e)):r.createElement(i.TeachingBubble,{target:this.props.target,headline:n.title,hasCloseIcon:!0,closeButtonAriaLabel:u.default.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!0,calloutProps:{onLayerMounted:this._onTeachingBubbleSeen}},e)};return t})(r.PureComponent);t.ItemScopeTeachingBubbleCoachmarkContainer=l});
define("odsp-next/providers/coachmark/CoachmarkProvider",["require","exports","tslib","../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disabledCampaign={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:r.Off,isCoachmark:!0};var h=(function(e){n.__extends(r,e);function r(n,r){void 0===n&&(n={});var i=e.call(this,n,r)||this;i._dataStore=new o.default("CoachmarkProvider",u.default.session);i._currentCampaign=i.createObservable(t.disabledCampaign);i._isVisible=i.createObservable(!1);i._navigation=r.navigation;i._firstRunExperienceStatus=r.firstRunExperienceStatus;i._currentTeachingBubble=i.createObservable({campaign:i._currentCampaign,isVisible:i._isVisible});i._navigation.viewParams.resetAllBubbles&&i._dataStore.remove("CoachmarkTearDropSeen");return i}Object.defineProperty(r.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!0,configurable:!0});r.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(t.disabledCampaign)};r.prototype.setCampaign=function(e){var n=this;if(e){if(this._firstRunExperienceStatus()!==c.FirstRunExperienceStatus.visible){var r=e.name+"CoachmarkTearDropSeen";if(!this._dataStore.getValue("CoachmarkTearDropSeen")){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.resources.consume(f.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(e,!1).then(function(t){if(t){n._currentCampaign(e);n._isVisible(!0);n._dataStore.setValue(r,!0)}})}}}else{this._currentCampaign(t.disabledCampaign);this._isVisible(!1)}};r.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};r.dependencies=n.__assign(n.__assign({},i.default.dependencies),{navigation:a.navigation,firstRunExperienceStatus:l.resourceKey});return r})(i.default);t.default=h;t.resourceKey=s.createResolvedResourceKey(e("module").id,h)});
define("odsp-next/controls/detailsPane/KnockoutDetailsPaneHost",["require","exports","tslib","react","../base/react/WithKnockoutComputed","./DetailsPane","./DetailsPaneId","@ms/odsp-utilities/lib/resources/Resources","../../actions/base/ItemSelectionHelper","@ms/utilities-disposables/lib/Scope"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new u.ResourceKey({name:e("module").id,factory:{dependencies:{detailsPaneId:o.resourceKey,itemSelectionHelperType:a.typeResourceKey},create:function(e){var t=e.detailsPaneId,o=e.itemSelectionHelperType;return{instance:function(e){var u=r.useRef(),a=u.current||(u.current=new f.Scope);r.useEffect(function(){return function(){a.dispose()}},[]);var l=r.useRef(),c=l.current||(l.current=a.attach(new o({allowMultiSelect:!0,canFallback:!0}))),h=i.useObservableValue(c.selection);return r.createElement(s.default,n.__assign({},e,{id:t,items:h}))}}}}})});
define("odsp-next/controls/detailsPane/DetailsPane",["require","exports","tslib","react","react-dom","office-ui-fabric-react/lib/ScrollablePane","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","./pane/primary/PrimaryPane","./pane/secondary/SecondaryPane","office-ui-fabric-react/lib/Utilities","../../utilities/logging/EventQos","../../providers/engagement/Engagement","./DetailsPane.resx","@ms/odsp-utilities/lib/scope/Scope","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onPrimaryHeaderHeightChange=function(e){r.setState({primaryHeaderHeight:e})};r._onSecondaryHeaderHeightChange=function(e){r.setState({secondaryHeaderHeight:e})};r._onPaneHeightChange=function(){r._scrollablePane&&r._scrollablePane.forceLayoutUpdate()};r._onSecondaryPaneHeaderClick=function(){if(r._detailsPaneElement&&r._primaryPaneElement&&r._secondaryPaneElement){var e=r._detailsPaneElement.getBoundingClientRect().top;if(r._secondaryPaneElement.getBoundingClientRect().top-e<r._detailsPaneElement.clientHeight/2){r._primaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!1})}else{var t=r._scrollablePane.getScrollPosition();r._secondaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!0,scrollPosition:t});r._engagement.logData({name:"DetailsPane.ExpandSecondaryPane",isIntentional:!0})}}};r._scope=new p.default;r._observables=r._scope.attach(new o.default({owner:r}));r.state={availableSectionGroups:r._observables.ignore(function(){return r._computeSectionGroups(t)}),isSecondaryPaneExpanded:!1,detailsPaneHeight:void 0,primaryHeaderHeight:void 0,secondaryHeaderHeight:void 0,scrollPosition:0};r._engagement=r.props.resources.consume(c.resourceKey);return r}t.prototype.componentDidMount=function(){this._addStoreListener(this.props);if(this._detailsPaneElement){l.logSuccess("LaunchInfoPane");this._updateDetailsPaneHeight();this._events.on(window,"resize",this._updateDetailsPaneHeight);var e=f.getFirstFocusable(this._detailsPaneElement,this._primaryPaneElement,!1);e&&e.focus()}else l.logUnexpectedFailure("LaunchInfoPane")};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this.setState({availableSectionGroups:this._observables.ignore(function(){return t._computeSectionGroups(e)})})};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.allSectionGroups!==this.props.allSectionGroups||e.resources!==this.props.resources||t.availableSectionGroups!==this.state.availableSectionGroups||t.isSecondaryPaneExpanded!==this.state.isSecondaryPaneExpanded||t.detailsPaneHeight!==this.state.detailsPaneHeight||t.primaryHeaderHeight!==this.state.primaryHeaderHeight||t.secondaryHeaderHeight!==this.state.secondaryHeaderHeight};t.prototype.UNSAFE_componentWillUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._removeCurrentStoreListener()};t.prototype.componentDidUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._addStoreListener(this.props);if(this._primaryPaneElement&&1===e.items.length&&1===this.props.items.length&&e.items[0].peek().key!==this.props.items[0].peek().key){this._primaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!1,scrollPosition:0})}};t.prototype.componentWillUnmount=function(){this._removeCurrentStoreListener();this._detailsPaneElement&&this._events.off(window,"resize",this._updateDetailsPaneHeight);this._scope.dispose()};t.prototype.render=function(){var e=this,t=this.props,n=t.id,o=t.items,l=t.resources,c=this.state,p=c.availableSectionGroups,d=c.isSecondaryPaneExpanded,v=c.detailsPaneHeight,m=c.primaryHeaderHeight,g=c.secondaryHeaderHeight,y=c.scrollPosition;if(p&&p[0]){var b=0===p[0].sections.length;return r.createElement("div",{ref:function(t){e._detailsPaneElement=t},"data-automationid":"ms-info-pane",id:n,role:"region",className:f.css("od-DetailsPane",{"od-DetailsPane--secondaryPaneDisabled":!p[1]||!p[1].sections.length}),"aria-label":h.default.detailsPaneAriaLabel},r.createElement(s.ScrollablePane,{componentRef:function(t){e._scrollablePane=t},initialScrollPosition:d?-1:y,className:"od-DetailsPane-scrollablePane"},r.createElement(u.default,{ref:function(t){e._primaryPaneElement=i.findDOMNode(t)},items:o,sectionGroup:p[0],onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onPrimaryHeaderHeightChange,isCollapsed:d||b,minHeight:v&&v-(g||0)+1,resources:l}),p[1]?r.createElement(a.default,{ref:function(t){e._secondaryPaneElement=i.findDOMNode(t)},items:o,sectionGroup:p[1],onHeaderClick:this._onSecondaryPaneHeaderClick,isHeaderClickDisabled:b,onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onSecondaryHeaderHeightChange,minHeight:v&&void 0!==m&&v-m,resources:l}):null))}return null};t.prototype._updateDetailsPaneHeight=function(){this.setState({detailsPaneHeight:this._detailsPaneElement.clientHeight})};t.prototype._removeCurrentStoreListener=function(){this._sectionGroupsSubscription.dispose()};t.prototype._addStoreListener=function(e){var t=this,n=this._observables.pureCompute(function(){return t._computeSectionGroups(e)});this._sectionGroupsSubscription=this._observables.subscribe(n,function(e){t.setState({availableSectionGroups:e})})};t.prototype._computeSectionGroups=function(e){return e.allSectionGroups.map(function(t){return{sections:t.sections.filter(function(t){return t.isAvailable(e.items.filter(function(e){return!!e}).map(function(e){return e.peek()}))})}})};return t})(f.BaseComponent);t.default=d});
define("odsp-next/controls/detailsPane/pane/primary/PrimaryPane",["require","exports","tslib","react","@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer","../../../../utilities/icons/IconHelper","../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","../../parentHeightWatcher/ParentHeightWatcher","office-ui-fabric-react/lib/Sticky","../../DetailsPane.resx","../../DetailsPaneSectionList","../../globalSettings/GlobalSettingsMenu","../../../../utilities/features/Features","../../../../utilities/accessibility/AriaHelper","../../IsDetailsPaneExpanded","office-ui-fabric-react/lib/Button","../../../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/events/EventGroup","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onClose=function(){r._isDetailsPaneExpanded(!1);b.default.raise(document.body,"resize",void 0,!0)};r._resources=t.resources;r._isDetailsPaneExpanded=r._resources.consume(m.resourceKey);r.state={isCommentDisabledOnFile:!0};r._enableComments=d.isFeatureEnabled(d.EnableCommentsInActivityFeed);return r}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.isCollapsed!==this.props.isCollapsed||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.isCollapsed,i=t.minHeight,s=t.onHeightChange;return r.createElement("div",{className:a.css("od-DetailsPane-PrimaryPane-wrapper",{"od-DetailsPane-PrimaryPane--isCollapsed":n}),style:{minHeight:!n&&i||this._headerDiv&&this._headerDiv.clientHeight}},r.createElement("div",{className:"od-DetailsPane-PrimaryPane"},r.createElement("div",{ref:function(t){e._headerDiv=t}},r.createElement(l.Sticky,null,this._renderSectionsHeader())),r.createElement("div",{className:"od-DetailsPane-PrimaryPane-body"},r.createElement(f.default,{onHeightChange:s},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e,t=this.props.items;if(1===t.length){var n=t[0].peek();e=n.displayName||n.name||""}else e=u.format(c.default.multipleItemsSelected,t.length);var i=this._renderPaneIcon();return r.createElement("div",{className:"od-DetailsPane-PrimaryPane-header",tabIndex:-1,"data-is-focusable":!1},r.createElement("div",{className:"od-DetailsPane-PrimaryPane-header-icon"},i),r.createElement("h1",{className:"od-DetailsPane-PrimaryPane-header-title"},e),this._enableComments&&r.createElement(p.default,{items:t,resources:this._resources}),!y.default.isActivated("C51863D4-8130-46D5-9B23-74A21AA9C1E2","06/02/2020","show close button in details pane")&&r.createElement(g.IconButton,{className:"od-DetailsPane-PrimaryPane-header-close",iconProps:{iconName:"Cancel"},"aria-label":c.default.detailsPaneCloseButtonAriaLabel,title:c.default.detailsPaneCloseButtonAriaLabel,onClick:this._onClose}))};t.prototype._renderPaneIcon=function(){var e,t,n,u,a=this.props,f=a.items,l=a.resources;if(1===f.length){var c=f[0].peek();e=c.iconName||"genericfile";var h=c.extension,p=l.consume(o.resourceKey.optional);t=c.iconUrl||(function(e,t){return e&&e.getFileTypeIconUrl(t,!0)})(p,h)||s.getIconUrl(l,e,32);n=(function(e,t){return e&&e.getFileTypeName(t,!0)})(p,h);u=v.getTooltipText(c)}else{e="genericfile";t=s.getIconUrl(l,e,32)}return r.createElement(i.FileTypeIconRenderer,{iconName:e,width:32,iconUrl:t,iconTitle:n,isDisabled:!1,tooltipText:u,ariaLabel:n,isClickable:!1,onClick:this._fileIconOnClick})};t.prototype._fileIconOnClick=function(e){};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,i=e.resources;return r.createElement(h.default,{items:t,sections:n.sections,resources:i})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t})(a.BaseComponent);t.default=w});
define("odsp-next/controls/detailsPane/parentHeightWatcher/ParentHeightWatcher",["require","exports","tslib","react","@ms/odsp-utilities/lib/events/EventGroup","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new i.default(window),o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.shouldComponentUpdate=function(e,t){return e.children!==this.props.children};t.prototype.componentDidMount=function(){var e=this;this._iframeElement&&s.on(this._iframeElement.contentWindow,"resize",function(){e.props.onHeightChange()})};t.prototype.componentWillUnmount=function(){this._iframeElement&&s.off(this._iframeElement.contentWindow,"resize")};t.prototype.render=function(){var e=this;return r.createElement("div",{className:"od-ParentHeightWatcher"},r.createElement("iframe",{ref:function(t){e._iframeElement=t},className:"od-ParentHeightWatcher-iframe"}),this.props.children)};return t})(r.Component);t.default=o});
define("odsp-next/controls/detailsPane/DetailsPaneSectionList",["require","exports","tslib","react","./section/itemActivityFeed/ItemActivityFeedSection","./section/itemActivityFeed/LegacyItemActivityFeedSection","./section/itemExtractedText/ItemExtractedTextSection","./section/caption/CaptionSection","./section/itemInformation/ItemInformationSection","./section/information/InformationSection","./section/tags/TagsSection","./section/location/LocationSection","./section/itemPreview/ItemPreviewSection","./section/itemProperties/ItemPropertiesSection","./section/itemShortcut/ItemShortcutSection","./section/itemPolicy/ItemPolicySection","./section/itemSharing/ItemSharingSection","./section/itemStatus/ItemStatusSection","./section/imageTags/ImageTagsSection","./section/malwareDetected/MalwareDetectedSection","../../controls/infoPane/sections/itemPublishWarning/ItemPublishingWarningComponent"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.sections.map(function(t){return e._renderSection(t)});return r.createElement("div",null,t)};t.prototype._renderSection=function(e){var t=this.props,n=t.items,E=t.resources,S=t.shouldHideSectionHeaders,x=n[0];return 19===e.type?r.createElement(w.default,{key:e.type,item:x.peek(),resources:E}):9===e.type?r.createElement(i.default,{key:e.type,item:x.peek(),resources:E}):10===e.type?r.createElement(s.default,{key:e.type,item:x,resources:E}):12===e.type?r.createElement(a.default,{key:e.type,item:x,resources:E}):15===e.type?r.createElement(h.default,{key:e.type,item:x,resources:E}):18===e.type?r.createElement(p.default,{isScheduling:!0,key:e.type,item:x,resources:E}):7===e.type?r.createElement(p.default,{key:e.type,item:void 0,resources:E}):14===e.type?r.createElement(d.default,{key:e.type,item:x,resources:E}):3===e.type?r.createElement(v.default,{key:e.type,item:x,resources:E}):8===e.type?r.createElement(m.default,{key:e.type,item:x,resources:E}):16===e.type?r.createElement(g.default,{key:e.type,items:n.map(function(e){return e.peek()})}):17===e.type?r.createElement(b.default,{key:e.type}):6===e.type?r.createElement(o.default,{key:e.type,item:x,resources:E}):1===e.type?r.createElement(u.default,{key:e.type,item:x,resources:E}):11===e.type?r.createElement(f.default,{key:e.type,item:x,resources:E,isHeaderHidden:S}):5===e.type?r.createElement(l.default,{key:e.type,item:x,resources:E}):4===e.type?r.createElement(c.default,{key:e.type,item:x,resources:E}):20===e.type?r.createElement(y.ImageTagsSection,{key:e.type,item:x.peek(),resources:E}):null};return t})(r.Component);t.default=E});
define("odsp-next/controls/detailsPane/section/itemActivityFeed/ItemActivityFeedSection",["require","exports","tslib","react","../../../itemActivityFeed/OldItemActivityFeed","../../../itemActivityFeed/ItemActivityFeed","../../../../utilities/features/Features","ODCDeferred_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return o.isFeatureEnabled(o.ActivityFeedRefactoring)?r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},r.createElement(s.default,{item:t,resources:n}))):r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},r.createElement(i.default,{item:t,resources:n})))};return t})(r.Component);t.default=u});
define("odsp-next/controls/itemActivityFeed/OldItemActivityFeed",["require","exports","tslib","react","prop-types","./ItemActivityFeed.resx","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed","./OldItemActivityFeedViewOption","../../models/itemsScope/ItemsScopeFeature.key","../../resources/DataSourceResourceKeys","../../providers/itemActivities/GroupedItemActivityFeedStore","../../providers/engagement/Engagement","../../providers/itemActivities/ItemCommentsStore","../../providers/item/ItemProvider","@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardAdapter","../../utilities/features/Features","../../models/itemActivity/ItemActivityFeedHelper","../../utilities/item/ListItemTypeConverter","@ms/odsp-datasources/lib/Permissions","../../models/item/ItemParentHelper","../itemMuteNotification/ItemMuteNotification","../../models/item/ItemType","../base/react/ResolvedComponentType","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=S.getResolvedComponentType(w.resourceKey.local.bypass),T=(function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s._canOpenItem=function(e){return!!s._getItemUrl(e)};s._onItemClick=function(e,t){var n=s.props.item,r=s._getItemUrl(e);s._itemActivityFeedHelper.navigateToItem(n,e,r,function(e){s._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})};s._onItemCommentsSettingChanged=function(e){var t=s.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var r=n.__assign(n.__assign({},t.comments&&t.comments.settings),{isCommentDisabled:e}),i=s._resources.consume(p.resourceKey);i.invalidateItem(t.key);i.invalidateItem(t.parentKey);s._itemActivityFeedHelper.updateItem(t,{comments:n.__assign(n.__assign({},t.comments),{settings:r})});var o=t&&t.properties&&t.properties.ID;s._isItemsScopeEnabled()&&s._resources.consumeAsync(f.itemInvalidator).then(function(e){e.refreshItemsInCurrentItemSet([o])})}};s._canDeleteActivity=function(e){var t=s.props.item;switch(e){case 2:return s._isCommentsAvailable(t)&&y.PermissionMask.hasItemPermission(t,y.PermissionMask.editListItems);default:return!1}};s._onRenderUser=function(e,t){var n=t&&t(e),i=s._itemActivityDataSource.getPageContextForRenderUser();return i?r.createElement(d.LivePersonaCardAdapter,{key:e.user.id||e.user.email,personaType:"User",email:e.user.email,pageContext:i},n):n};s._deleteCommentActivity=function(e,t,n){var r=n.commentItem,i=n.commentId;e&&r&&i&&s._itemCommentsStore.deleteCommentById(r,i,t)};s._resources=t.resources;s._itemActivityFeedStore=s._resources.consume(l.resourceKey);var o=s._resources.consume(f.identity);s._itemCommentsStore=s._resources.consume(h.resourceKey);s._currentUserEmail=o.getIdentity().loginName;s._itemActivityDataSource=s._resources.consume(f.itemActivityFeed);s._itemActivityFeedHelper=new(s._resources.injected(m.default));s._engagement=s._resources.consume(c.resourceKey);s._isItemsScopeEnabled=s._resources.consume(a.isItemsScopeEnabledResourceKey.lazy);s._itemParentHelper=s._resources.consume(b.resourceKey);s.state={graphDataSource:s._resources.consume(f.graph.optional),commentsOnly:!1};return s}t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore}};t.prototype.componentDidMount=function(){this.state.graphDataSource||this._loadGraphDataSource()};t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,r=this.props.item;return n&&r&&n.key!==r.key&&0===n.revision||this._isCommentSettingsChanged(n,r)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly};t.prototype.render=function(){var e=this,t=this.props.item,n=this.state.commentsOnly,i=t.displayName||"",a=this._itemActivityFeedHelper.getGraphItemUrl(t,this.state.graphDataSource),f=this._itemActivityFeedHelper.getAccessToken(t,this.state.graphDataSource),l=!v.isOneDrive&&t.list&&t.list.isDocumentLibrary&&t.name||void 0;if(a&&f){var c={name:i,graphItemUrl:a,accessToken:f},h=this._isCommentsAvailable(t),p=this._getCommentListItem(t,c)||void 0,d=h&&n,m=!(h&&(y.PermissionMask.hasItemPermission(t,y.PermissionMask.editListItems)||y.PermissionMask.hasItemPermission(t,y.PermissionMask.reviewListItems)))||this._isCommentDisabled(t);this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0});return r.createElement("div",{className:"od-ItemActivityFeedWrapper"},r.createElement("div",{className:"od-ItemActivityFeed-header-old"},r.createElement("div",{className:"od-ItemActivityFeed-title"},s.default.itemActivityFeedSectionTitle),this._isItemNotificationActive()&&r.createElement(x,{item:t}),r.createElement(u.OldItemActivityFeedViewOption,{isCommentsOnlyView:n,item:t,onSelectMenuOption:function(t){e.setState({commentsOnly:t})}})),r.createElement(o.default,{currentUserEmail:this._currentUserEmail,containingItem:c,isSingleLevel:!t.folder,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,currentListTitle:l,commentListItem:p,isReadonly:m,commentsOnly:d,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged}))}return r.createElement("div",null)};t.prototype._isItemNotificationActive=function(){var e=this.props.item,t=v.isFeatureEnabled(v.EnableCommentsInActivityFeed)&&v.isFeatureEnabled(v.EnablePerItemMuteNotification);return e.type!==E.default.Folder&&t};t.prototype._getCommentListItem=function(e,t){if(this._isCommentsAvailable(e)){var n=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"),r=n&&n.peek()&&n.peek().list&&n.peek().list.id;if(r)return{item:g.convertToISPListItem(e),activityItemWrapper:t,parentListId:r}}};t.prototype._isCommentsAvailable=function(e){return m.isNonOfficeFileCommentsAvailable(e,v.isFeatureEnabled(v.EnableCommentsInActivityFeed))};t.prototype._isCommentDisabled=function(e){return e&&e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled};t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)};t.prototype._getItemUrl=function(e){return this._itemActivityDataSource.getActivityItemUrl(e)};t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(f.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype._getActionMenuFunctions=function(){var e;return(e={})[2]={delete:this._deleteCommentActivity},e};t.childContextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired};return t})(r.Component);t.default=T});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed",["require","exports","tslib","react","prop-types","./IItemCommentsStore","./ItemActivityList/ItemActivityList","../AddCommentTextField/AddCommentTextField","../AddCommentTextField/AddMentionableCommentTextField","./ItemActivity/ItemActivities","./ItemActivityGroupByDateHelper","./ItemActivityFeed.resx","@ms/shared-react-item-activity/lib/components/ItemActivities.resx","./DisplayLargeText","@ms/odsp-utilities/lib/list/SharingType","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={isPlaceholder:!1,activities:[],success:!0},m=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._onRenderMissingActivity=function(e,t){var n=i.state,r=n.isEndOfActivities,s=n.showComments,o=n.deeplinkCommentThreadId,u=i.props,a=u.commentsOnly,f=u.containingItem,l=u.currentUserEmail,c=u.environment,h=u.activityApiHeaders,p=u.getListActivities,d=u.commentListItem;r||a||i._store.fetchItemActivities({item:f,startIndex:e,currentUserEmail:l,qosPrefix:"ItemActivityFeed",environment:c,isScrollEvent:t,activityApiHeaders:h,getListActivities:p});s&&i._itemCommentsStore.fetchItemComments({itemWrapper:d,currentUserEmail:l});i.setState({deeplinkCommentThreadId:t?void 0:o})};i._onFetchCommentsError=function(e){var t=i.props.onFetchCommentsError;t&&t(e);i.setState({showAllCommentActivities:!0,itemCommentsQueried:!0})};i._displayLargeText=function(e){return r.createElement(p.default,{charLimit:e.charLimit,seeMoreText:e.seeMoreText,seeLessText:e.seeLessText,text:e.text})};i._store=n.itemActivityFeedStore;i._itemCommentsStore=n.itemCommentsStore;i._engagementSource=n.engagementSource||"ActivityFeed";var s="sharePointList"===t.environment,o=!!t.commentListItem,u=!!t.commentsOnly?v:i._store.getItemActivities({item:i.props.containingItem,currentUserEmail:t.currentUserEmail}),a=o&&i._itemCommentsStore.getItemComments({itemWrapper:t.commentListItem,currentUserEmail:t.currentUserEmail,startIndex:0,onError:i._onFetchCommentsError,isReplyDisabled:s})||void 0;i.state={activities:u,itemComments:a,isEndOfActivities:!1,itemCommentsQueried:a&&!a.isPlaceHolder,showAllCommentActivities:!o,showComments:o,feedUpdatedMessage:"",isSPCustomListFeed:s,deeplinkCommentThreadId:t.deeplinkCommentThreadId};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){var t="sharePointList"===e.environment,n=!!e.commentListItem,r=!!e.commentsOnly?v:this._store.getItemActivities({item:this.props.containingItem,currentUserEmail:e.currentUserEmail}),i=n&&this._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,startIndex:0,onError:this._onFetchCommentsError,isReplyDisabled:t})||void 0;this.setState({activities:r,showComments:n,itemComments:i,showAllCommentActivities:!n,itemCommentsQueried:i&&!i.isPlaceHolder,isEndOfActivities:!1,feedUpdatedMessage:"",isSPCustomListFeed:t});this._removeCurrentListeners();this._addListeners(e)}e.containingItem!==this.props.containingItem&&this._refreshActivityFeed(e);e.commentsOnly!==this.props.commentsOnly&&this.setState({isEndOfActivities:!1})};t.prototype.componentDidMount=function(){this._addListeners(this.props)};t.prototype.componentWillUnmount=function(){this._removeCurrentListeners()};t.prototype.render=function(){var e=this.state,t=e.activities,n=e.itemComments,i=e.showComments,s=e.itemCommentsQueried,u=e.deeplinkCommentThreadId,a=this.props,f=a.isReadonly,l=a.commentsOnly,h=a.isNewCommentExperienceEnabled,p=this._getViewableItemActivitiesAndGroups(t,n),d=p.activities,v=p.dateGroups;if((t.isPlaceholder||t.nextRequestToken||n&&n.nextLink)&&(!l||!this._noCommentActivities())){var m=v.length;d.push(void 0);0===m?v.push({key:"",name:"",startIndex:0,count:1}):m>0&&(v[v.length-1].count+=1)}var g=this._renderNoActivitiesNote(),y=this._renderError(),b=d.slice(0,d.length);return r.createElement("div",{className:"od-ItemActivityFeed"},r.createElement("div",{"aria-live":"assertive",role:"status","aria-atomic":"true",className:"od-ItemActivityFeed-screenReaderOnly"},this.state.feedUpdatedMessage),this._renderAddCommentField(),r.createElement("div",{"aria-label":c.default.activityListAriaLabel},g,r.createElement(o.default,{activities:b,groups:v,onRenderMissingActivity:this._onRenderMissingActivity,enableShimmer:!0,isDataReady:!i||!!s,isReadonly:f,isNewCommentExperienceEnabled:h,deeplinkCommentThreadId:u}),y))};t.prototype._renderError=function(){var e=this.state,t=e.activities,n=e.itemComments,i=!!this.props.commentsOnly;if(i||t.success){if(i&&n&&n.missingComments){s=n.comments.length>0?c.default.fetchMoreCommentsError:c.default.fetchCommentsError;return r.createElement("div",{className:"od-ItemActivityFeed-error"},s)}return null}var s=t.activities.length>0?c.default.fetchMoreError:c.default.fetchError;return r.createElement("div",{className:"od-ItemActivityFeed-error"},s)};t.prototype._renderNoActivitiesNote=function(){var e=this.state,t=e.activities,n=e.showComments,i=e.itemComments,s=this.props.commentsOnly;return!t.success||t.isPlaceholder||0!==t.activities.length||t.nextRequestToken||n&&!this._noCommentActivities()||s?s&&this._noCommentActivities()&&i&&!i.missingComments?r.createElement("div",{className:"od-ItemActivityFeed-noActivities"},c.default.noCommentActivities):null:r.createElement("div",{className:"od-ItemActivityFeed-noActivities"},c.default.noActivities)};t.prototype._noCommentActivities=function(){var e=this.state,t=e.itemComments;return e.showComments&&(!t||t&&t.comments&&t.comments.length<1)};t.prototype._renderAddCommentField=function(){var e=this,t=this.props,n=t.commentListItem,i=t.isReadonly,s=t.environment,o=t.onGrantAccess,f=t.onCheckUserAccess,l=t.commentTextBoxPlaceholder,h=t.isPublicEmailAddressMentionSupported,p=t.focusCommentInputOnMount,v=t.refreshCurrentItemCallback,m="consumer"===s,g="sharePointList"===s;if((!i||m||g)&&n){var y=function(t,r,i,s){e._itemCommentsStore.addComment(n,t,s).then(function(t){e._refreshActivityFeed(e.props);r&&r();v&&v()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},b=n&&n.item,w=b.isRootFolder?"driveRoot":b.folder?"folder":b.extension||"file",E=void 0!==b.sharingType?d.default[b.sharingType]:void 0;return this.props.isAtMentionEnabled?r.createElement(a.default,{commentItemId:n.item&&n.item.id,isPublicEmailAddressSupported:h,placeholderText:l,peoplePickerProvider:this.context.peoplePickerProvider,onSend:y,onGrantAccess:o,onCheckUserAccess:f,disabled:i,focusOnMount:p}):r.createElement(u.default,{commentItemId:n.item&&n.item.id,placeholderText:i?l:c.default.addCommentPlaceHolder,sendButtonTitle:"",onSend:y,engagementSource:this._engagementSource+".AddComment",engagementExtraData:{itemType:w,sharingType:E},disabled:i,focusOnMount:p,enableNewCommentingExperience:m||g})}};t.prototype._refreshActivityFeed=function(e){e.commentsOnly||this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:"ItemActivityFeed",environment:e.environment,activityApiHeaders:e.activityApiHeaders,getListActivities:e.getListActivities});var t=!!e.commentListItem;t&&this._itemCommentsStore.fetchItemComments({itemWrapper:e.commentListItem,startIndex:0,currentUserEmail:e.currentUserEmail});this.setState({itemCommentsQueried:!1,showComments:t,isEndOfActivities:!1,deeplinkCommentThreadId:void 0});this._removeCurrentListeners();this._addListeners(e)};t.prototype._getViewableItemActivitiesAndGroups=function(e,t){var n,r=this.props.commentsOnly,i=[],s=[],o=function(){if(0===s.length)return 0;var e=s[s.length-1];return e.startIndex+e.count};if(e)for(var u=this.canAppendCommentsAfterOldestActivity(!!r,e,t),a=0,c=this._prepareActivitiesList(e.activities,t,u);a<c.length;a++){var h=c[a];if(h){var p=void 0;(!r||h instanceof f.CommentItemActivity||2===h.type)&&(p=this._getViewableItemActivity(h));if(p){i.push(p);var d=l.getActivityGroupByDate(h),v=l.RelativeDateGroupStrings[d]||d;if(v!==n){s.push({key:"activityDateGroup-"+s.length,name:v,count:1,startIndex:o()});n=v}else s[s.length-1].count+=1}}}return{activities:i,dateGroups:s}};t.prototype.canAppendCommentsAfterOldestActivity=function(e,t,n){return!!((e||t&&t.success&&!t.isPlaceholder&&!t.nextRequestToken)&&n&&n.comments)};t.prototype._prepareActivitiesList=function(e,t,n){var r;if(this.props.commentsOnly)return(null===(r=t)||void 0===r?void 0:r.comments)||[];if(!(t&&t.comments&&t.comments.length>0))return e;var i=e.length>0?e[e.length-1].time:new Date,s=t.comments,o=new Set;return e.concat(s).filter(function(e){if(e.time<i&&!n)return!1;if(e instanceof f.CommentItemActivity||2===e.type){if(o.has(e.action.comment.commentId))return!1;o.add(e.action.comment.commentId);return!0}return!0}).sort(function(e,t){return e.time>t.time?-1:e.time<t.time?1:0})};t.prototype._getViewableItemActivity=function(e){var t=this.props,r=t.currentUserEmail,i=t.containingItem,s=t.canOpenItem,o=t.onItemClick,u=t.isSingleLevel,a=t.onRenderUser,l=t.currentListTitle,c=t.currentRootTitle,p=t.defaultItemTitle,d=t.commentListItem,v=t.commentsOnly,m=t.isReadonly,g=t.canDeleteActivity,y=t.activityMenuFunctions,b=t.isNewCommentExperienceEnabled,w=t.isAtMentionEnabled,E=t.environment,S=t.getpersonaIconUrl,x=this.state,T=x.showComments,N=x.itemComments,C=x.isSPCustomListFeed,k={currentUserEmail:r,containingItem:i,canOpenItem:s,onItemClick:o,isSingleLevel:u,activity:e,strings:h.default,onRenderUser:a,currentListTitle:l,currentRootTitle:c,defaultItemTitle:p,commentListItem:d,isReadonly:m,canDeleteActivity:g,activityMenuFunctions:y&&y[e.type],isNewCommentExperienceEnabled:b,isAtMentionEnabled:w,environment:E,getpersonaIconUrl:S,displayLargeText:this._displayLargeText,isListItem:C};if(!v||2===e.type)switch(e.type){case 0:return new f.EditItemActivity(k);case 1:return new f.MoveItemActivity(k);case 2:var L=void 0;if(T&&N){var A=this._getPopulatedCommentActivity(e);if(A&&A.isDeleted)return;L=n.__assign(n.__assign({},k),{activity:this._getPopulatedCommentActivity(e)})}return new f.CommentItemActivity(L||k);case 3:return new f.CommentResponseItemActivity(k);case 4:return new f.MentionItemActivity(k);case 5:return new f.VersionItemActivity(k);case 6:return new f.RestoreItemActivity(k);case 9:return new f.RenameItemActivity(k);case 10:return new f.DeleteItemActivity(k);case 11:return new f.CreateItemActivity(k);case 12:return new f.ShareItemActivity(k);default:return}};t.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store.addListener(function(){var n=t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail}),r="sharePointList"===e.environment;t.setState({activities:n,isEndOfActivities:r||n.success&&!n.isPlaceholder&&!n.nextRequestToken})},{item:e.containingItem,currentUserEmail:e.currentUserEmail,environment:e.environment,activityApiHeaders:e.activityApiHeaders,getListActivities:e.getListActivities})};t.prototype._addCommentsStoreListener=function(e){var t=this,n=e.currentUserEmail,r=e.commentsOnly,i=e.commentListItem;this._commentsStoreListener=this._itemCommentsStore.addListener(function(n){var i=t._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,onError:t._onFetchCommentsError,isReplyDisabled:t.state.isSPCustomListFeed});t.setState({itemComments:i,itemCommentsQueried:!!i.comments,showAllCommentActivities:!i.isPlaceHolder&&i.missingComments,isEndOfActivities:r&&i.success&&!i.isPlaceHolder&&!i.nextLink});n&&t._announceCommentUpdate(n)},{commentItemWrapper:i,currentUserEmail:n})};t.prototype._addCommentSettingsListener=function(e){var t=this,n=e.onCommentSettingsChanged,r=e.currentUserEmail,i=e.commentListItem;this._commentSettingsListener=this._itemCommentsStore.addCommentSettingsListener(function(){var e=t._itemCommentsStore.getIsCommentsDisabled(i,r);if("boolean"==typeof e&&n){n(e);t._announceCommentUpdate(e?s.ItemCommentsChange.CommentsDisabled:s.ItemCommentsChange.CommentsEnabled)}},{commentItemWrapper:i,currentUserEmail:r})};t.prototype._addListeners=function(e){this._addStoreListener(e);if(e.commentListItem){this._addCommentsStoreListener(e);this._addCommentSettingsListener(e)}};t.prototype._removeCurrentListeners=function(){this._storeListener&&this._store.removeListener(this._storeListener);if(this._commentsStoreListener){this._itemCommentsStore.removeListener(this._commentsStoreListener);this._commentsStoreListener=void 0}if(this._commentSettingsListener){this._itemCommentsStore.removeCommentSettingsListener(this._commentSettingsListener);this._commentSettingsListener=void 0}};t.prototype._getPopulatedCommentActivity=function(e){var t=e.action&&e.action.comment;if(t&&t.commentId){var r=this._getCommentById(t.commentId);if(r){return n.__assign(n.__assign({},r),{time:e.time,friendlyDisplayTime:e.friendlyDisplayTime})}if(this.state.itemCommentsQueried&&!this.state.showAllCommentActivities)return n.__assign(n.__assign({},e),{isDeleted:!0})}return e};t.prototype._getCommentById=function(e){var t=this.state.itemComments,n=t&&t.comments;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=s.action&&s.action.comment&&s.action.comment.commentDetail;if(o&&o.id===e)return s}};t.prototype._announceCommentUpdate=function(e){var t="";e===s.ItemCommentsChange.DeletedAll?t=c.default.deletedAllComments:e===s.ItemCommentsChange.DeletedSingle?t=c.default.deletedSingleComment:e===s.ItemCommentsChange.CommentsEnabled?t=c.default.commentsEnabled:e===s.ItemCommentsChange.CommentsDisabled&&(t=c.default.commentsDisabled);this.setState({feedUpdatedMessage:t})};t.contextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired,peoplePickerProvider:i.object,engagementSource:i.string};return t})(r.Component);t.default=m});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/IItemCommentsStore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.DeletedSingle=0]="DeletedSingle";e[e.DeletedAll=1]="DeletedAll";e[e.CommentsEnabled=2]="CommentsEnabled";e[e.CommentsDisabled=3]="CommentsDisabled"})(t.ItemCommentsChange||(t.ItemCommentsChange={}))});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityList/ItemActivityList",["require","exports","tslib","react","@ms/odsp-utilities/lib/logging/events/Engagement.event","../ItemActivity/ItemActivity","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/components/GroupedList/index","office-ui-fabric-react/lib/Shimmer","../ItemActivity/MissingItemActivityWrapper","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderCell=function(e,n,i){var o=t.props,a=o.onRenderMissingActivity,f=o.enableShimmer,h=o.isDataReady,p=o.isNewCommentExperienceEnabled,d=o.deeplinkCommentThreadId;if(n){if(!h&&f)return r.createElement("div",{className:"od-ItemActivityList-activity"},r.createElement(l.Shimmer,{shimmerElements:[{type:1,height:48}]}));var v=n.getCommentThreadId(),m=v&&v===d;return r.createElement(s.default,{key:n.getKey(),activity:n,isInGrid:!0,isNewCommentExperienceEnabled:p,isFocusedOnFirstLoad:m})}if(a)return r.createElement(c.default,{activityIndex:i,onGetMoreActivities:t._onRequestMissingItemActivity},r.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},r.createElement(u.Spinner,{size:u.SpinnerSize.large})))};t._onRenderHeader=function(e){var t=e.group;return r.createElement("h2",{className:"od-ItemActivityList-grouplistTitle"},t.name)};t._onRequestMissingItemActivity=function(e,n){var r=t.props.onRenderMissingActivity;n&&i.Engagement.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0});r&&r(e,n)};return t}t.prototype.render=function(){var e=this.props,t=e.activities,n=e.groups;return r.createElement(a.FocusZone,{direction:a.FocusZoneDirection.vertical,isCircularNavigation:!1,isInnerZoneKeystroke:function(e){return e.which===o.getRTLSafeKeyCode(o.KeyCodes.right)}},r.createElement(f.GroupedList,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:n,onShouldVirtualize:function(){return!1}}))};return t})(r.Component);t.default=h});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/async/Async"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new s.default,u=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onScrollEvent=function(e){var n=t.props,r=n.onGetMoreActivities,i=n.activityIndex;o.setTimeout(function(){t._isCurrentElementInView()&&r(i,!0)},100)};return t}t.prototype.componentDidMount=function(){var e=this.props,t=e.onGetMoreActivities,n=e.activityIndex;this._containingScrollablePane=this._findContainingScrollablePane();this._isCurrentElementInView()&&t(n);this._containingScrollablePane&&this._events.on(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.componentWillUnmount=function(){this._containingScrollablePane&&this._events.off(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.render=function(){var e=this;return r.createElement("div",{ref:function(t){return e._missingActivityElement=t}},r.Children.only(this.props.children))};t.prototype._findContainingScrollablePane=function(){return i.findScrollableParent(this._missingActivityElement)};t.prototype._isCurrentElementInView=function(){if(this._missingActivityElement&&this._containingScrollablePane){var e=this._missingActivityElement.getBoundingClientRect(),t=this._containingScrollablePane.getBoundingClientRect(),n=e.top,r=e.bottom,i=t.top,s=t.bottom;return n<=s&&n>=i||r>=i&&r<=s}return!1};return t})(i.BaseComponent);t.default=u});
define("@ms/odsp-shared-react/lib/components/AddCommentTextField/AddCommentTextField",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/odsp-shared-react/lib/components/AddCommentTextField/AddMentionableCommentTextField",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddMentionableCommentTextField","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddMentionableCommentTextField"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddMentionableCommentTextField",["require","exports","tslib","../../utilities/Utilities","react","react-dom","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","./AddCommentTextField.resx","@ms/shared-react-at-mention/lib/AtMention/AtMentionControl","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClearTextField=function(){n.setState({commentText:"",sending:!1});n._inputElement&&n._inputElement.focus()};n._onKeyDown=function(e){e.which===o.KeyCodes.enter&&n.state.enableSendButton&&n._onCommentPost()};n._handleAtMention=n._handleAtMention.bind(n);n._onCommentPost=n._onCommentPost.bind(n);n._updateText=n._updateText.bind(n);n._onKeyDown=n._onKeyDown.bind(n);n._convertPasteToPlainText=n._convertPasteToPlainText.bind(n);n._allowTags(["a"]);n.state=n._getResetState();n._peoplePickerProvider=n.props.peoplePickerProvider;n._allMentionees=[];n._noAccessMentionees=[];return n}t.getDerivedStateFromProps=function(e,t){return e.disabled?{enableSendButton:!1,sending:!1,errorMessage:"",commentText:"",successMessage:""}:t};t.prototype.render=function(){var e=this,t=this.props.disabled;return i.createElement("div",{className:o.css({"od-addNewCommentTextField-mentionableTextBox-outer":!t},{"od-addNewCommentTextField-mentionableTextBox-outer-disabled":t})},i.createElement("div",{className:o.css({"od-addNewCommentTextField-mentionableTextBox":!t},{"od-addNewCommentTextField-mentionableTextBox-disabled":t}),contentEditable:!0,placeholder:this.props.placeholderText,onBlur:function(){return e._updateText()},onKeyUp:function(t){return e._updateText(t)},onPaste:this._convertPasteToPlainText,ref:function(t){return e._inputElement=t},role:"textbox",onKeyDown:function(t){return e._onKeyDown(t)},tabIndex:t?-1:0}),this._renderButtons())};t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3};t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._inputElement&&this._inputElement.focus()};t.prototype.componentWillUnmount=function(){this._inputElement&&(this._inputElement=void 0)};t.prototype.componentDidUpdate=function(){""===this.state.commentText&&this._inputElement&&(this._inputElement.innerHTML="")};t.prototype._renderButtons=function(){return this.state.commentText.length>0&&i.createElement("div",{className:"od-mentionableTextBox-buttons"},this._renderSendButton())};t.prototype._renderSendButton=function(){return this.state.sending?i.createElement("div",{className:"od-addNewCommentTextField-spinner"},i.createElement(u.Spinner,{size:u.SpinnerSize.small})):i.createElement(f.TooltipHost,{content:l.default.sendLabel,styles:{root:{display:"inline-block"}},directionalHint:f.DirectionalHint.bottomAutoEdge},i.createElement(a.IconButton,{className:"od-addNewCommentTextField-sendButton",iconProps:{iconName:"Send"},ariaLabel:l.default.sendLabel,onClick:this._onCommentPost,disabled:!this.commentInputValid()}))};t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")};t.prototype._cleanupMentionedAttributes=function(){if(this._inputElement)for(var e=this._inputElement.querySelectorAll("a[email-id]"),t=0;t<e.length;t++){var n=e[t];n.removeAttribute("access-type");n.removeAttribute("contenteditable")}};t.prototype._removeDuplicateIdentities=function(e){for(var t={},n=[],r=0;r<e.length;r++)if(e[r]&&e[r].user&&e[r].user.email&&!t[e[r].user.email]){t[e[r].user.email]=!0;n.push(e[r])}return n};t.prototype._updateMentionedData=function(){if(this._inputElement){for(var e=[],t=[],n=this._inputElement.querySelectorAll("a[email-id]"),r=0;r<n.length;r++){var i=n[r],s=i.getAttribute("email-id"),o=i.textContent.substr(1),u=i.getAttribute("access-type");e.push({user:{displayName:o,email:s.trim().toLowerCase()}});"0"===u&&t.push({user:{displayName:o,email:s.trim().toLowerCase()}})}this._allMentionees=this._removeDuplicateIdentities(e);this._noAccessMentionees=this._removeDuplicateIdentities(t)}};t.prototype._sendComment=function(){var e=this,t=this.props.onSend;if(this.state.commentText&&t){this.setState({sending:!0,errorMessage:"",successMessage:""});this._cleanupMentionedAttributes();t(this._textContent(),function(){e._onClearTextField();e._allMentionees=[];e._noAccessMentionees=[]},function(t){e.setState({sending:!1,errorMessage:t})},this._allMentionees)}};t.prototype._onCommentPost=function(){var e=this,t=this.props.onGrantAccess,n=this.state.commentText;this._updateMentionedData();if(n&&t&&this._noAccessMentionees&&this._noAccessMentionees.length>0){t(this._noAccessMentionees,function(t){"share_grantAccessCompleted"===t&&e._sendComment()},function(e){})}else this._sendComment()};t.prototype._removeAllTags=function(e){return this._regexWithException?e.replace(this._regexWithException,""):e.replace(/<(?:.|\n)*?>/gm,"")};t.prototype._allowTags=function(e){for(var t=e[0],n=1;n<e.length;n++)t+="|"+e[n];this._regexWithException=new RegExp("<(?!/?("+t+")(?=>|\\s.*>))/?.*?>","gm")};t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")};t.prototype._textLength=function(){if(!this._inputElement||0===this.state.commentText.length)return 0;if(this._textLengthCache&&this._lastHTML===this._inputElement.innerHTML)return this._textLengthCache;this._lastHTML=this._inputElement.innerHTML;return this._textLengthCache=this._textContent().length};t.prototype._textContent=function(){var e=this._inputElement?this._inputElement.innerHTML:"";e=this._replaceDivsWithNewLines(e);e=this._limitConsecutiveNewlines(e);e=this._trimSurroundingWhitespace(e);e=this._removeAllTags(e);this._regexWithException||(e=r.default.htmlDecodeFromString(e));return e};t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")};t.prototype._updateText=function(e){this._inputElement&&this.setState({commentText:this._inputElement.innerHTML,enableSendButton:this.commentInputValid()});this._handleAtMention()};t.prototype._handleAtMention=function(){if(this._inputElement&&!this._atMention&&this._peoplePickerProvider&&this.props.onCheckUserAccess){var e=document.createElement("div"),t=i.createElement(c.default,{allowEmailAddresses:this.props.isPublicEmailAddressSupported,editorElement:this._inputElement,peoplePickerProvider:this._peoplePickerProvider,onCheckUserAccess:this.props.onCheckUserAccess});this._atMention=s.render(t,e)}};t.prototype._getResetState=function(){return{enableSendButton:!1,sending:!1,errorMessage:"",commentText:""}};t.prototype._convertPasteToPlainText=function(e){if(!r.default.isIE11()){e.preventDefault();var t="";e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text"));document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)}};return t})(i.Component);t.default=h});
define("@ms/shared-react-item-activity/lib/utilities/Utilities",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.htmlDecodeFromString=function(e){var t=e,n=(new DOMParser).parseFromString(t,"text/html");return t=n&&n.body&&n.body.innerText?n.body.innerText:t};e.isIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode};return e})();t.default=n});
define("@ms/shared-react-at-mention/lib/AtMention/AtMentionControl",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Persona","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/async/Promise","./AtMention.resx","./MentionPeoplePicker","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.MentionPeoplePicker_module_7;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._handleResolveSuggestions=n._handleResolveSuggestions.bind(n);n._handleMention=n._handleMention.bind(n);n._handleFilterChanged=n._handleFilterChanged.bind(n);n._onPersonaSelected=n._onPersonaSelected.bind(n);n._getTextFromItem=n._getTextFromItem.bind(n);n._onGetMoreResults=n._onGetMoreResults.bind(n);n._onRenderSuggestionItem=n._onRenderSuggestionItem.bind(n);n._handleKeydown=n._handleKeydown.bind(n);n._isGraphAPISupported=!0;n._dataProvider=n.props.peoplePickerProvider;n._newMentionNode=document.createElement("a");n._relevantUsers=[];n.state={mentionQuery:""};return n}t._shortenDisplayName=function(e){var n=e.innerText;if(t.BRACKET_REGEX.test(n))n=n.replace(t.BRACKET_REGEX,"");else if(t.LAST_NAME_SECTION_REGEX.test(n))n=n.replace(t.LAST_NAME_SECTION_REGEX,"");else{n="";e.remove?e.remove():e.parentElement.removeChild(e);e=void 0}n&&(e.innerText=n.trim());return e};t._isMentionAnchor=function(e){return!(!e||"A"!==e.nodeName||!e.getAttribute("email-id"))};t.prototype.render=function(){var e=this.state.mentionQuery===t.RELEVANT_USER_QUERY&&this._relevantUsers.length<1,n={className:l.mentionSuggestions,loadingText:a.default.loadingText,suggestionsHeaderText:e?a.default.moreCharactersText:a.default.suggestionsHeaderText,noResultsFoundText:a.default.noResultsFoundText,suggestionsAvailableAlertText:a.default.suggestionsAvailableAlertText,suggestionsContainerAriaLabel:a.default.suggestionsContainerAriaLabel};return r.createElement(f.default,{onResolveSuggestions:this._handleResolveSuggestions,onRenderSuggestionsItem:this._onRenderSuggestionItem,getTextFromItem:this._getTextFromItem,pickerSuggestionsProps:n,className:"ms-PeoplePicker",componentRef:this._resolveRef("_picker"),resolveDelay:300,mentionQuery:this.state.mentionQuery,calloutTarget:this.props.editorElement,onItemSelected:this._onPersonaSelected,onGetMoreResults:this._onGetMoreResults})};t.prototype.shouldComponentUpdate=function(e,t){return this.state.lastInvalidMention!==t.lastInvalidMention||this._lastResolvedQuery!==t.mentionQuery};t.prototype.componentDidMount=function(){var e=this;this.props.editorElement.addEventListener("keydown",this._handleKeydown);this.props.editorElement.addEventListener("keyup",this._handleMention);this._dataProvider.search("",this._getPeoplePickerQueryParams(this._isGraphAPISupported)).promise.then(function(t){if(!e._peoplePickerSearchPromise){e._relevantUsers=t;e._handleMention()}}).catch(function(e){})};t.prototype.componentWillUnmount=function(){this.props.editorElement.removeEventListener("keydown",this._handleKeydown);this.props.editorElement.removeEventListener("keyup",this._handleMention)};t.prototype.getMentionData=function(){var e,n="",r="",i=-1,s=-1,o=this._caretRange;if(o&&"#text"===o.endContainer.nodeName){i=(r=(e=o.endContainer).textContent).substring(0,o.endOffset).lastIndexOf("@");this.props.allowEmailAddresses&&(s=r.substring(0,o.endOffset).lastIndexOf("@",i-1));(0===i||i>0&&this._isTerminatingCharacter(r[i-1]))&&""===(n=r.substring(i+1,o.endOffset).trim())&&(n=t.RELEVANT_USER_QUERY);if(""===n&&this.props.allowEmailAddresses&&(0===s||s>0&&this._isTerminatingCharacter(r[s-1]))){n=r.substring(s+1,o.endOffset).trim();i=s}n.length>=320&&(n="")}return{currentNode:e,lastAtIndex:i,mentionQuery:n,nodeText:r}};t.prototype._getPeoplePickerQueryParams=function(e){return{allowEmailAddresses:this.props.allowEmailAddresses,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:o.default.user,useGraph:e}};t.prototype._handleMention=function(e){var t=this,n=this.getMentionData(),r=n.currentNode,s=n.mentionQuery;s===this.state.mentionQuery||e&&e.which===i.KeyCodes.escape||this.setState({currentNode:r,mentionQuery:s});setTimeout(function(){t._normalizeContent()},0)};t.prototype._transformMentionQuery=function(e){var t=this._caretRange;if(t&&e.userId&&e.name){var n=this.getMentionData(),r=n.currentNode,i=n.lastAtIndex,s=n.mentionQuery,o=n.nodeText,u=e.email,a=e.name;if(s.length>0&&r&&this._selection){var f=e?"":o[t.endOffset-1];if(!this._isTerminatingCharacter(f))return;var l=this._newMentionNode.cloneNode(!0);l.setAttribute("email-id",u);l.setAttribute("contenteditable","false");l.appendChild(document.createTextNode("@".concat(a)));var c=document.createTextNode(f),h=document.createRange();h.setStart(r,i);h.setEnd(r,t.endOffset);h.deleteContents();h.insertNode(c);h.insertNode(l);this.props.editorElement.focus();this._selection.collapse(c,1);this.setState({mentionQuery:""});this._normalizeContent();this._verifyUserAccess(u,l)}}};t.prototype._verifyUserAccess=function(e,t){var n=this.props.onCheckUserAccess;if(n){n(e,function(e){e?t.setAttribute("access-type","1"):t.setAttribute("access-type","0")})}};t.prototype._handleFilterChanged=function(e,t){return e.filter(function(e){return 0===e.name.indexOf(t)||0===e.email.split("@")[0].indexOf(t)})};t.prototype._onPersonaSelected=function(e){this._transformMentionQuery(e);return e};t.prototype._getTextFromItem=function(e){return e.primaryText};t.prototype._handleKeydown=function(e){var t=this.state.mentionQuery;switch(e.which){case i.KeyCodes.escape:if(t){e.preventDefault();e.stopPropagation();this.setState({mentionQuery:""})}break;case i.KeyCodes.backspace:if(this._selection&&this._processBackSpace()){e.preventDefault();e.stopPropagation()}break;case i.KeyCodes.left:this._skipZeroWidthSpace(1);break;case i.KeyCodes.right:case i.KeyCodes.del:this._skipZeroWidthSpace(0);break;case i.KeyCodes.tab:case i.KeyCodes.enter:case i.KeyCodes.up:case i.KeyCodes.down:if(t.length>0){e.preventDefault();e.stopPropagation();this._picker.handleKeyDown(e)}break;default:return}};t.prototype._processBackSpace=function(){var e=this._selection.anchorNode,n=this._selection.anchorOffset;if(this._selection.isCollapsed){this._skipZeroWidthSpace(1);var r=void 0;r="#text"===e.nodeName&&0===n?e.previousSibling:e.hasChildNodes()&&n>0?e.childNodes[n-1]:e;if(t._isMentionAnchor(r)){(r=t._shortenDisplayName(r))?this.setState({lastInvalidMention:r}):this.setState({lastInvalidMention:void 0});return r}}else;};t.prototype._skipZeroWidthSpace=function(e){this._selection&&this._selection.isCollapsed&&""===this._selection.anchorNode.nodeValue&&this._selection.anchorOffset===e&&this._selection.collapse(this._selection.anchorNode,1-e)};t.prototype._normalizeContent=function(){this.props.editorElement.normalize();var e=this._selection?this._selection.anchorNode:void 0;e&&"#text"!==e.nodeName&&e.hasChildNodes()&&!1===e.lastChild.isContentEditable&&e.appendChild(document.createTextNode(""))};Object.defineProperty(t.prototype,"_selection",{get:function(){var e=document.getSelection(),t=this.props.editorElement;return e&&e.focusNode&&(t.contains(e.focusNode)||t.contains(e.focusNode.parentNode))?e:void 0},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_caretRange",{get:function(){var e=this._selection;if(e&&e.isCollapsed&&e.rangeCount>0){return e.getRangeAt(0)}},enumerable:!0,configurable:!0});t.prototype._isTerminatingCharacter=function(e){return/\s/.test(e)};t.prototype._handleResolveSuggestions=function(e){var n,r=this;if(this._peoplePickerSearchPromise){this._peoplePickerSearchPromise.cancel();this._peoplePickerSearchPromise=void 0}if(e){if(this.state.mentionQuery===t.RELEVANT_USER_QUERY){this._lastResolvedQuery=t.RELEVANT_USER_QUERY;n=this._relevantUsers}else if(e.length<1){this._lastResolvedQuery=this.state.mentionQuery;n=this._handleFilterChanged(this._relevantUsers,e)}}else{this._lastResolvedQuery="";n=[]}if(n)return new u.default(function(e){r._async.setTimeout(function(){0===n.length&&r.state.mentionQuery.length;e(n)},0)});var i=this._dataProvider.search(e.trim(),this._getPeoplePickerQueryParams(this._isGraphAPISupported));return i?this._resolvePeoplePickerSearch(i).then(function(t){r._lastResolvedQuery=e;t.length;return t}):this._handleFilterChanged?this._handleFilterChanged([],e):[]};t.prototype._onGetMoreResults=function(e,t){var n=this;if(e.length<1)return[];var r=this._dataProvider.search(e.trim(),this._getPeoplePickerQueryParams(this._isGraphAPISupported));return this._resolvePeoplePickerSearch(r).then(function(t){n._lastResolvedQuery=e;return t})};t.prototype._resolvePeoplePickerSearch=function(e){var t=this,n=e.cached||[];this._peoplePickerSearchPromise=e.promise;return this._peoplePickerSearchPromise.then(function(e){t._peoplePickerSearchPromise=void 0;return e?n.concat(e):[]}).catch(function(e){return u.default.reject(e)})};t.prototype._onRenderSuggestionItem=function(e){return r.createElement("div",{className:"ms-PeoplePicker-personaContent"},r.createElement(s.Persona,{text:e.name||"",secondaryText:e.email||"",tertiaryText:"",presence:s.PersonaPresence.none,size:s.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona",imageUrl:e.image}))};t.BRACKET_REGEX=/\s\(([^)]*)\)[^(]*$/g;t.LAST_NAME_SECTION_REGEX=/\s[^\s]*$/g;t.RELEVANT_USER_QUERY="@@";return t})(i.BaseComponent);t.default=c});
define("@ms/shared-react-at-mention/lib/AtMention/MentionPeoplePicker",["require","exports","tslib","react","office-ui-fabric-react/lib/Pickers","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Utilities","./AtMentionInput"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.input.current=new u.default(n.props.calloutTarget);return n}t.getDerivedStateFromProps=function(){return{moreSuggestionsAvailable:!0}};t.prototype.render=function(){return r.createElement("div",{ref:this.root},this.renderSuggestions(),this.props.children)};t.prototype.componentDidMount=function(){this._updateActiveDescendants()};t.prototype.componentDidUpdate=function(e){if(this.props.mentionQuery!==e.mentionQuery){this.input.current.value=this.props.mentionQuery;this.updateValue(this.props.mentionQuery)}this._updateActiveDescendants()};t.prototype.handleKeyDown=function(e){if(this.state.suggestionsVisible){var t=e.keyCode,n=e.shiftKey;switch(t){case o.KeyCodes.tab:case o.KeyCodes.enter:if(this.suggestionElement.current&&this.suggestionElement.current.hasSuggestedActionSelected())this.suggestionElement.current.executeSelectedAction();else if(!n&&this.suggestionStore.hasSelectedSuggestion()){this.addItem(this.suggestionStore.currentSuggestion&&this.suggestionStore.currentSuggestion.item);this.updateValue("")}break;case o.KeyCodes.up:case o.KeyCodes.down:this.onKeyDown(e)}}};t.prototype.renderSuggestions=function(){return this.state.suggestionsVisible&&this.input&&this.input.current&&r.createElement(s.Callout,{isBeakVisible:!1,gapSpace:5,target:this.input.current.inputElement,onDismiss:this.dismissSuggestions,calloutWidth:this.props.calloutTarget.clientWidth,directionalHint:s.DirectionalHint.bottomLeftEdge,directionalHintForRTL:s.DirectionalHint.bottomRightEdge},r.createElement(i.Suggestions,n.__assign({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel},this.props.pickerSuggestionsProps)))};t.prototype._updateActiveDescendants=function(){var e=this.state.suggestionsVisible,t=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",n=e?this._ariaMap.suggestionList:"",r=this.getActiveDescendant();this.input.current.setAriaLabels([{attr:"activedescendant",label:r},{attr:"control",label:n+" "+t||void 0},{attr:"owns",label:"suggestion-list"},{attr:"expanded",label:e},{attr:"haspopup",label:e}])};return t})(i.BasePicker);t.default=a});
define("@ms/shared-react-at-mention/lib/AtMention/AtMentionInput",["require","exports","ODCDeferred_css"],function(e,t,n){"use strict";n=n.MentionPeoplePicker_module_7;Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._inputElement=e;this._inputElement.classList.add(n.mentionField)}Object.defineProperty(e.prototype,"current",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cursorLocation",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isValueSelected",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionStart",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._inputElement},enumerable:!0,configurable:!0});e.prototype.focus=function(){this._inputElement&&this._inputElement.focus()};e.prototype.clear=function(e){this._inputElement&&e&&(this._inputElement.innerHTML="");this.value=""};e.prototype.setAriaLabels=function(e){var t=this;e.forEach(function(e){void 0===e.label?t._inputElement.removeAttribute("aria-"+e.attr):t._inputElement.setAttribute("aria-"+e.attr,e.label.toString())})};return e})();t.default=r});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityGroupByDateHelper",["require","exports","@ms/odsp-utilities/lib/locale/Locale","./ItemActivityFeed.resx"],function(e,t,n,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});var s;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.older="Older"})(s=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.RelativeDateGroupStrings=((i={})[s.today]=r.default.today,i[s.yesterday]=r.default.yesterday,i[s.thisWeek]=r.default.thisWeek,i[s.lastWeek]=r.default.lastWeek,i[s.twoWeeksAgo]=r.default.twoWeeksAgo,i[s.threeWeeksAgo]=r.default.threeWeeksAgo,i[s.thisMonth]=r.default.thisMonth,i[s.lastMonth]=r.default.lastMonth,i);t.getActivityGroupByDate=function(e){var t=e.time,r=new Date;return t?(function(e,t){return o(t,e)})(t,r)?s.today:(function(e,t){return o(new Date(t.getTime()-864e5),e)})(t,r)?s.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(t,r)?s.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(t,r)?s.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(t,r)?s.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(t,r)?s.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(t,r)?s.thisMonth:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(t,r)?s.lastMonth:(function(e,t){return t.getFullYear()===e.getFullYear()})(t,r)?t.toLocaleString(n.default.language,{month:"long"}):(function(e,t){return t.getFullYear()>e.getFullYear()})(t,r)?t.toLocaleString(n.default.language,{month:"long",year:"numeric"}):s.older:s.older};function o(e,t){return e.toDateString()===t.toDateString()}});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/DisplayLargeText",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={charLimit:t.charLimit?t.charLimit:140,expanded:!1};return n}t.prototype.getSeeMoreContent=function(){var e,t=this,n=this.state,s=n.charLimit,o=n.expanded,u=this.props,a=u.text,f=u.seeMoreText,l=u.seeLessText;e=a.length<=s?a:o?a+" ":a.substr(0,s)+"... ";return r.createElement("span",null,e,a.length>s&&r.createElement("span",{className:"od-ItemActivity-SeeMoreText",onClick:this.toggleExpanded.bind(this),onKeyDown:function(e){e.which!==i.KeyCodes.select&&e.which!==i.KeyCodes.enter&&e.which!==i.KeyCodes.space||t.toggleExpanded()},role:"button","data-is-focusable":"true","aria-expanded":o},o?l:f))};t.prototype.toggleExpanded=function(){var e=this.state.expanded;this.setState({expanded:!e})};t.prototype.render=function(){return r.createElement("div",null,this.getSeeMoreContent())};return t})(r.Component);t.default=s});
define("odsp-next/controls/itemActivityFeed/OldItemActivityFeedViewOption",["require","exports","tslib","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Button","../../models/itemActivity/ItemActivityFeedHelper","office-ui-fabric-react/lib/common/DirectionalHint","./ItemActivityFeed.resx","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.item;return r.createElement(r.Fragment,null,this._isMenuVisible()?r.createElement(s.DefaultButton,{className:"od-ItemActivityFeed-viewOption-old",text:i.format(a.default.itemActivityFeedViewOption,this._getCurrentViewOption()),menuProps:this._getViewMenuProps(e),ariaLabel:i.format(a.default.itemActivityFeedViewOptionAriaLabel,this._getCurrentViewOption())}):void 0)};t.prototype._isCommentsAvailable=function(e){var t=this.props.isCommentsInActivityFeedEnabled,n=void 0!==t&&t;return f.isFeatureEnabled(f.ActivityFeedRefactoring)?this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e):o.isNonOfficeFileCommentsAvailable(e,n)};t.prototype._getViewMenuProps=function(e){return{directionalHint:u.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"}}};t.prototype._getMenuItems=function(){var e=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:a.default.itemActivityFeedViewAll,onClick:function(t,n){e&&e(!1)}},{key:"activityFeed.commentOnly",name:a.default.itemActivityFeedCommentsOnly,onClick:function(t,n){e&&e(!0)}}]};t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)&&!this.props.isCommentDisabledInItemSetting};t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?a.default.itemActivityFeedCommentsOnly:a.default.itemActivityFeedViewAll};return t})(r.Component);t.OldItemActivityFeedViewOption=l});
define("odsp-next/models/itemActivity/ItemActivityFeedHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../models/item/ItemType","../../dataSources/base/vroom/ItemResultProcessor","../../dataSources/item/ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(i.actionMap);n._itemTaskObserver=new(n.resources.consume(f.resourceKey));n._urlDataSource=n.resources.consume(s.url);return n}t.prototype.navigateToItem=function(e,t,r,i){var s=this;if(r){var o=t.driveItem;o.webUrl||(o=n.__assign(n.__assign({},o),{webUrl:r}));if(t.isFolder){i&&i("folder");this.navigateToFolder(o.webUrl)}else this._convertToOneDriveItem(e,o).then(function(e){i&&i(e.folder?"folder":e.extension||"file");s.navigateToOneDriveItem(e)})}};t.prototype.navigateToOneDriveItem=function(e){var t=this.createObservable(e);new(this.managed(this._actionMap.DefaultClickAction))({item:t}).execute(void 0)};t.prototype.navigateToFolder=function(e){new(this.managed(this._actionMap.NavigationAction))({url:e,forceNavigation:!0,target:"_blank"}).execute(void 0)};t.prototype.getGraphItemUrl=function(e,t){if(t)return e.id===this._urlDataSource.getDefaultRootItemId()?t.getDriveUrl(e,{useDirectEndpoint:!0}):t.getItemUrl(e,{useDirectEndpoint:!0})};t.prototype.getAccessToken=function(e,t){if(t)return t.getAccessToken(e)};t.prototype.updateItem=function(e,t){this._itemTaskObserver.update([new f.Task(e.key).succeed({item:n.__assign({key:e.key},t)})],!1);this._itemTaskObserver.flush()};t.prototype._convertToOneDriveItem=function(e,t){var n=this;return this.resources.consumeAsync(a.resourceKey).then(function(r){var i=r.processItem({itemFromServer:t,requestKey:e.key,observer:n._itemTaskObserver}).key;n._itemTaskObserver.flush();return n._itemTaskObserver.getItem({key:i})})};return t})(r.default);t.default=l;t.isNonOfficeFileCommentsAvailable=function(e,t){return t&&!(function(e){var t=e.extension&&e.extension.replace(/^\./,"");e.appMap=t&&o.OfficeIconFileTypeMap[t];return e.appMap&&".pdf"!==e.extension})(e)&&(e.type===u.default.File||e.type===u.default.Media||e.type===u.default.Unknown||e.type===u.default.Shortcut)}});
define("odsp-next/providers/itemActivities/GroupedItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/GroupedItemActivityFeedStore","./ItemActivityFeedStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemActivityFeedStore:i.resourceKey})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/GroupedItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/ItemType"],function(e,t,n,r){"use strict";var i,s,o;Object.defineProperty(t,"__esModule",{value:!0});var u={sharePoint:(i={},i[0]=30,i[3]=30,i),consumer:(s={},s[0]=30,s[3]=30,s),sharePointList:(o={},o[0]=720,o[2]=30,o)},a={"SharePoint App":!0,"System Account":!0},f=(function(){function e(e,t){this._baseStore=t.itemActivityFeedStore;this._dictItemActivities={}}e.prototype.addListener=function(e,t){var n=this,r=this._getItemActivitiesDictionaryKey(t);this._dictItemActivities[r]=this._transformItemActivities(t,this._baseStore.getItemActivities(t));return this._baseStore.addListener(function(){n._dictItemActivities[r]=n._transformItemActivities(t,n._baseStore.getItemActivities(t));e()},t)};e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)};e.prototype.removeListener=function(e){this._baseStore.removeListener(e)};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._areNewActivitiesFetched=function(e,t){var n=this._getItemActivitiesDictionaryKey(e);return!this._dictItemActivities[n]||this._dictItemActivities[n].activities.length!==t.length};e.prototype._transformItemActivities=function(e,t){var n=[];if(t.activities.length>0)for(var r={},i=0;i<t.activities.length;i++){var s=t.activities[i];if(!this._shouldHideActivity(s,e.currentUserEmail)){var o=t.activities[i-1],u=this._getCacheItemKeyAndGroupingRange(s,e.environment),a=u.cacheItemKey,f=u.groupingRange,l=s.actors[0];o&&this._isMergableMoveActivity(o,s)?this._handleMergableMoveActivity(o,s,n):a&&l?this._handleGroupableActivity(r,a,f,s,n):n.push(s)}}!this._areNewActivitiesFetched(e,n)&&t.nextRequestToken&&this.fetchItemActivities(e);return{isPlaceholder:t.isPlaceholder,activities:n,nextRequestToken:t.nextRequestToken,success:t.success}};e.prototype._handleMergableMoveActivity=function(e,t,n){n[n.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}};e.prototype._handleGroupableActivity=function(e,t,n,r,i){var s=r.actors[0],o=this._getActorKey(s),u=e[t],a=u&&this._shouldResetGroupingItem(u,r,n);if(!u||a){var f={};f[o]=s;e[t]={activity:r,lastActivityTime:r.time,actors:f,groupedIndex:i.length};i.push(r)}else if(!u.actors[o]){u.actors[o]=s;if(1===u.activity.actors.length){var l=u.activity,c={id:l.id,type:l.type,actors:[l.actors[0]],item:l.item,parentItem:l.parentItem,time:l.time,action:l.action,friendlyDisplayTime:l.friendlyDisplayTime};u.activity=c;i[u.groupedIndex]=c}u.activity.actors.push(s)}};e.prototype._shouldResetGroupingItem=function(e,t,n){return e.lastActivityTime.getTime()-6e4*n>t.time.getTime()};e.prototype._getCacheItemKeyAndGroupingRange=function(e,t){var n=t&&u[t]&&u[t][e.type]||0;if(n){var r=void 0;e.item.driveItem&&e.item.driveItem.id?r=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(r=e.type.toString()+"_"+e.item.graphItemUrl);var i=e.action.commentResponse;r&&i&&i.commentAuthor&&(r+="_"+i.commentAuthor.email);return{cacheItemKey:r,groupingRange:n}}return{}};e.prototype._shouldHideActivity=function(e,t){var i=!1,s=e.item&&e.item.name&&e.item.name.toLowerCase();if(s){var o=s.lastIndexOf(".");if(-1!==o){var u=s.substring(o+1);r.default.File;n.getItemTypeFromExtension(u)===r.default.OneNote&&(i=!0)}}return i||this._isSystemAccount(e)||5===e.type||!e.item};e.prototype._isSystemAccount=function(e){var t=e.actors.length>0&&e.actors[0];return t&&a[t.displayName]};e.prototype._isMergableMoveActivity=function(e,t){return 1===e.type&&1===t.type&&!!e.action.move.from&&!e.action.move.to&&!t.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name};e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName};return e})();t.default=f});
define("odsp-next/providers/itemActivities/ItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeedStore","../../dataSources/itemActivities/index"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemActivitiesService:i.itemActivitiesServiceKey})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/async/PromiseDeduplicator"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService;this._lastListenerId=-1;this._dictListener={};this._dictItemActivities={};this._promiseDeduplicator=new i.default}e.prototype.addListener=function(e,t){var n=this._getItemActivitiesDictionaryKey(t);this._lastListenerId++;this._dictListener[n]||(this._dictListener[n]={});this._dictListener[n][this._lastListenerId]=e;return{key:this._lastListenerId,itemKey:n}};e.prototype.fetchItemActivities=function(e){var t=this,r=this._getItemActivitiesDictionaryKey(e),i=this._dictItemActivities[r];if(!i||0===e.startIndex){var s=0;i&&0===i.startIndex&&(s=i.noOfUnsuccessfulRequests);i={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:s,startIndex:0}}var o=i.activities,u="sharePointList"===e.environment;if(o.nextRequestToken||e.item.graphItemUrl){var a=(o.nextRequestToken||e.item.graphItemUrl)+"_"+(e.startIndex||0),f={};"consumer"===e.environment&&(f.Prefer=e.activityApiHeaders?e.activityApiHeaders:"Get-Self,Force-VaultItems-Filter");this._promiseDeduplicator.deduplicate(a,function(){var s,a={item:e.item,nextRequestToken:o.nextRequestToken,qosPrefix:e.qosPrefix,headers:f};if(u){if(!e.getListActivities){console.log("Unable to fetch changes for list!");return}s=e.getListActivities()}else s=t._itemActivitiesService.getItemActivities(a);return s.then(function(n){if(n&&n.success||i.noOfUnsuccessfulRequests+1>=2){t._dictItemActivities[r]={activities:t._mergeItemActivities(o,n,e.isScrollEvent),noOfUnsuccessfulRequests:0,startIndex:e.startIndex};t._emitChange(e)}else{t._dictItemActivities[r]={activities:o,noOfUnsuccessfulRequests:i.noOfUnsuccessfulRequests+1,startIndex:i.startIndex};t.fetchItemActivities(e)}},function(e){return n.default.reject(e)})})}};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}};e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]};e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictListener[t];if(n)for(var r=0,i=Object.getOwnPropertyNames(n);r<i.length;r++){(0,n[i[r]])()}};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._mergeItemActivities=function(e,t,n){this._logActivitiesTelemetry(t.activities,n);var r=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:r,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}};e.prototype._logActivitiesTelemetry=function(e,t){r.Engagement.logData({name:"ActivityFeed.activitiesFetched",isIntentional:!0,extraData:{isScrollEvent:!!t,noOfActivities:e.length}})};return e})();t.default=s});
define("odsp-next/providers/itemActivities/ItemCommentsStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemCommentsStore","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemCommentsDataSource:i.itemCommentDataSource.optional})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemCommentsStore",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","./IItemCommentsStore","@ms/odsp-utilities/lib/async/PromiseDeduplicator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){this._itemCommentsDataSource=t.itemCommentsDataSource;this._lastListenerId=-1;this._lastRepliesListenerId=-1;this._dictListener={};this._dictRepliesListener={};this._dictItemComments={};this._dictItemCommentReplies={};this._dictItemCommentIsDiabled={};this._dictItemCommentSettingsListener={};this._promiseDeduplicator=new s.default}e.prototype.addListener=function(e,t){this._lastListenerId++;var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictListener[i]||(this._dictListener[i]={});this._dictListener[i][this._lastListenerId]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:this._lastListenerId,itemKey:i}};e.prototype.removeListener=function(e){this._dictListener[e.itemKey]&&this._dictListener[e.itemKey][e.key]?delete this._dictListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchItemComments=function(e){var t=this,i={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},s=this._getItemActivitiesDictionaryKey(i),o=this._dictItemComments[s];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=this._dictItemComments[s]&&this._dictItemComments[s].noOfUnsuccessfulRequests||0,f=(u.nextLink||e.itemWrapper.item.id)+"_"+a;this._promiseDeduplicator.deduplicate(f,function(){var f={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail};return t._itemCommentsDataSource.getComments(f).then(function(r){if(r&&r.success||o.noOfUnsuccessfulRequests>3){var f=t._updatedComments(u,r);t._dictItemComments[s]={itemComments:f,noOfUnsuccessfulRequests:0};for(var l=0,c=f.comments;l<c.length;l++){var h=c[l],p=h.action&&h.action.comment&&h.action.comment.commentDetail,d=t._getItemCommentRepliesDictionaryKey(i,p.id);t._dictItemCommentReplies[d]={itemComments:p.replies,noOfUnsuccessfulRequests:0}}t._emitChange(i)}else if(r&&r.isPermanentFailure||a>=3){t._dictItemComments[s]={itemComments:n.__assign(n.__assign({},u),{missingComments:!0}),noOfUnsuccessfulRequests:a+1};e.onError&&e.onError();t._emitChange(i)}else{t._dictItemComments[s]={itemComments:u,noOfUnsuccessfulRequests:a+1};t.fetchItemComments(e)}},function(t){e.onError&&e.onError();return r.default.reject(t)})})}};e.prototype.addRepliesListener=function(e,t,n){this._lastRepliesListenerId++;var r=this._getItemCommentRepliesDictionaryKey(t,n);this._dictRepliesListener[r]||(this._dictRepliesListener[r]={});this._dictRepliesListener[r][this._lastRepliesListenerId]=e;return{key:this._lastRepliesListenerId,itemKey:r}};e.prototype.removeRepliesListener=function(e){this._dictRepliesListener[e.itemKey]&&this._dictRepliesListener[e.itemKey][e.key]?delete this._dictRepliesListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.getItemComments=function(e){var t={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},r=this._getItemActivitiesDictionaryKey(t),i=this._dictItemComments[r];if(i)return i.noOfUnsuccessfulRequests>3?n.__assign(n.__assign({},i.itemComments),{missingComments:!0}):i.itemComments;this.fetchItemComments(n.__assign(n.__assign({},e),{startIndex:i?e.startIndex:0}));return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addComment=function(e,t,n){return this._itemCommentsDataSource.addComment(e,t,n)};e.prototype.addItemCommentReply=function(e,t,n){return this._itemCommentsDataSource.addReply(e.itemWrapper,t,n)};e.prototype.getItemCommentReplies=function(e,t){var r={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemCommentRepliesDictionaryKey(r,t),s=this._dictItemCommentReplies[i];if(s)return s.itemComments;this.fetchItemCommentReplies(n.__assign(n.__assign({},e),{startIndex:0}),t);return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addCommentSettingsListener=function(e,t){var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictItemCommentSettingsListener[i]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:1,itemKey:i}};e.prototype.removeCommentSettingsListener=function(e){this._dictItemCommentSettingsListener[e.itemKey]&&this._dictItemCommentSettingsListener[e.itemKey][e.key]?delete this._dictItemCommentSettingsListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchIsCommentsDisabled=function(e){return this._itemCommentsDataSource.getIsCommentsDisabled(e)};e.prototype.getIsCommentsDisabled=function(e,t){var n={item:e.activityItemWrapper,currentUserEmail:t},r=this._getItemActivitiesDictionaryKey(n);return this._dictItemCommentIsDiabled[r]};e.prototype.setCommentsDisabled=function(e,t,n){var r=this;return this._itemCommentsDataSource.setCommentsDisabled(e,t).then(function(i){var s={item:e.activityItemWrapper,currentUserEmail:n},o=r._getItemActivitiesDictionaryKey(s);r._dictItemCommentIsDiabled[o]=t;r._emitCommentsSettingChange(s);return i})};e.prototype.deleteCommentById=function(e,t,s){var o=this;return this._itemCommentsDataSource.deleteCommentById(e,t).then(function(){var u={item:e.activityItemWrapper,currentUserEmail:s},a=o._getItemActivitiesDictionaryKey(u),f=o._dictItemComments[a],l=f&&f.itemComments&&f.itemComments.comments;if(l){var c=l.filter(function(e){return(e&&e.action&&e.action.comment&&e.action.comment.commentId)!==t});o._dictItemComments[a]=n.__assign(n.__assign({},f),{itemComments:n.__assign(n.__assign({},f.itemComments),{comments:c})});o._emitChange(u,i.ItemCommentsChange.DeletedSingle)}return r.default.resolve(!0)},function(e){return r.default.reject(e)})};e.prototype.deleteAllComments=function(e,t){var n=this;return this._itemCommentsDataSource.deleteAllComments(e).then(function(){var s={item:e.activityItemWrapper,currentUserEmail:t},o=n._getItemActivitiesDictionaryKey(s);n._dictItemComments[o]=void 0;n._emitChange(s,i.ItemCommentsChange.DeletedAll);return r.default.resolve(!0)},function(e){return r.default.reject(e)})};e.prototype.fetchItemCommentReplies=function(e,t){var n=this,i={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},s=this._getItemCommentRepliesDictionaryKey(i,t),o=this._dictItemCommentReplies[s];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=(u.nextLink||e.itemWrapper.item.id)+"_"+o.noOfUnsuccessfulRequests;this._promiseDeduplicator.deduplicate(a,function(){var a={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail};return n._itemCommentsDataSource.getReplies(a,t).then(function(r){var a=n._dictItemCommentReplies[s]&&n._dictItemCommentReplies[s].noOfUnsuccessfulRequests||0;if(r&&r.success||a>3){n._dictItemCommentReplies[s]={itemComments:n._updatedCommentWithReplies(u,r),noOfUnsuccessfulRequests:a};n._emitChangeForReplies(i,t)}else{n._dictItemComments[s]={itemComments:u,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1};n.fetchItemCommentReplies(e,t)}},function(e){return r.default.reject(e)})})}};e.prototype._emitChange=function(e,t){var n=this._getItemActivitiesDictionaryKey(e),r=this._dictListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])(t)}};e.prototype._emitChangeForReplies=function(e,t){var n=this._getItemCommentRepliesDictionaryKey(e,t),r=this._dictRepliesListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])()}};e.prototype._emitCommentsSettingChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictItemCommentSettingsListener[t];n&&n()};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._getItemCommentRepliesDictionaryKey=function(e,t){var n=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&t&&(n+="_"+e.currentUserEmail+"_"+t);return n};e.prototype._updatedComments=function(e,t){return{comments:(e&&e.comments||[]).concat(t.comments),nextLink:t.nextLink,success:!0}};e.prototype._updatedCommentWithReplies=function(e,t){var n=e&&e.comments||[];return{comments:t.comments.concat(n),nextLink:t.nextLink,success:!0}};return e})();t.default=o});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardAdapter",["require","exports","tslib","react","@msfast/lpc-bootstrapper/dist/odsp/livepersonacardbootstrapper","@ms/odsp-datasources/lib/Loki","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/events/Engagement.event","./LivePersonaCardDataUpdate","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback);return{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks}};i.state={isReady:!1};t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})});return i}t.prototype.render=function(){var e=this;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var i=n.__assign(n.__assign(n.__assign({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:n.__assign({personaInfo:{identifiers:{Smtp:this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.email:void 0),PersonaType:this.props.personaType,LocationId:this.props.locationId},displayName:this.props.displayName,personaCoinColor:o.getPersonaInitialsColor({text:this.props.displayName})},behavior:n.__assign(n.__assign({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&f.Engagement.logData(e.props.loggingData);e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return r.createElement(t.LivePersonaCardHoverTargetV2,n.__assign({},i),this.props.children)}if(t.LivePersonaCardHoverTarget){i=n.__assign(n.__assign(n.__assign(n.__assign({upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&f.Engagement.logData(e.props.loggingData);e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}});return r.createElement(t.LivePersonaCardHoverTarget,n.__assign({},i),this.props.children)}return r.createElement("div",{className:"sp-livePersonaCardAdapter-root"},this.props.children)};t.ensureInitializeLPC=function(e){var n=e.pageContext;if(!n.isSPO)return Promise.reject("LPC is not supported on-prem.");if(n.isExternalGuestUser||n.isAnonymousGuestUser)return Promise.reject("LPC is not enabled for guest users.");if(!a.default.isFeatureEnabled({ODB:809,ODC:null,Fallback:!1}))return Promise.reject("The global LPC flight is off for this configuration.");if(!Boolean(Number(n.farmSettings.ExternalService_islivepersonacardenabled)))return Promise.reject("LPC is disabled in this environment via SpoServiceConfig.");if(window.LPC&&window.LPC.getRenderer){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();return Promise.resolve()}var r=new s.Loki(e.pageContext),o="Prod";if(e.pageContext){s.isBlackforestEnvironment(e.pageContext)&&(o="Blackforest");s.isGccModerateEnvironment(e.pageContext)&&(o="GccModerate")}var u=r.getAadAuthTokenGetter(),f={culture:e.pageContext.currentUICultureName,region:r.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:u,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:o,isConsumer:!1,dataUpdateBroadcaster:{setGroupMembersUpdateListener:l.setLpcGroupMembersDataUpdateListener}};return i.initializeLivePersonaCardAsync(f).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();e.onSuccess&&e.onSuccess()}).catch(function(t){0;e.onFailure&&e.onFailure(t)})};t.LivePersonaCardHoverTarget=void 0;t.LivePersonaCardHoverTargetV2=void 0;t._logResult=function(e,t,n){0};return t})(u.BaseComponent);t.LivePersonaCardAdapter=c});
define("@msfast/lpc-bootstrapper/dist/odsp/livepersonacardbootstrapper",[],function(){return(function(e){function t(t){for(var n,i,s=t[0],o=t[1],u=0,f=[];u<s.length;u++)i=s[u],r[i]&&f.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(a&&a(t);f.length;)f.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=s);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=(function(e){return i.p+""+({1:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{1:"719a99c981d8afec1ebf"}[e]+".js"})(e),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous"),o=function(t){u.onerror=u.onload=null,clearTimeout(a);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+i+": "+s+")");o.type=i,o.request=s,n[1](o)}r[e]=void 0}};var a=setTimeout(function(){o({type:"timeout",target:u})},12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://lpcres.delve.office.com/lpc/versionless/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var a=o;return i(i.s=0)})([function(e,t,n){"use strict";n.r(t);var r,i=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},s=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},o=(function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return i(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return i(this,void 0,void 0,function(){var t,n,r;return s(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,4]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),r=void 0,"Blackforest"!==this.bootstrapperConfig.complianceEnvironment?[3,3]:[4,this.getCollectorUrlGermanyAsync()];case 2:r=i.sent(),i.label=3;case 3:(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20190419.4.0"),i.label=4;case 4:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlGermanyAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWT_COLLECTOR_URL_GERMANY]}})})},e.prototype.noOp=function(){},e})(),u=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i};function a(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}var f="LokiAuthToken";function l(e,t){return new Promise(function(n,r){e?(a(f,e),n(e)):t(function(e,t){e?(a(f,e),n(e)):r(new u("GetAuthTokenError","Auth token is undefined",t))},function(e,t){r(new u("GetAuthTokenError",e,t))})})}function c(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":window.decodeURIComponent(t[1].replace(/\+/g," "))}var h="LivePersonaCardVersionOverride",p="MidgardBranch",d=0;function v(e,t){return(function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})})(this,void 0,void 0,function(){var n,r;return(function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}})(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,m(e,t)];case 1:return n=i.sent(),[3,8];case 2:return(r=i.sent()).statusCode&&401===r.statusCode?[4,l(void 0,t.getAuthToken)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return d<2?(d++,[4,v(e,t)]):[3,6];case 5:return n=i.sent(),[3,7];case 6:throw r.numberOfRetries=d,r;case 7:return[3,8];case 8:return[2,n]}})})}function m(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest,s=(function(e){var t=c("LivePersonaCardCultureOverride")||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?"https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}".replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):"Blackforest"===e.complianceEnvironment?"https://loki.delve.office.de/api/v1/configuration/{0}/{1}".replace("{0}",e.clientType).replace("{1}",t):"GccModerate"===e.complianceEnvironment?"https://loki.delve-gcc.office.com/api/v1/configuration/{0}/{1}".replace("{0}",e.clientType).replace("{1}",t):"https://loki.delve.office.com/api/v1/configuration/{0}/{1}".replace("{0}",e.clientType).replace("{1}",t)})(t);i.open("GET",s,!0),i.setRequestHeader("authToken",e),i.setRequestHeader("Accept","application/json");var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});i.setRequestHeader("X-RootCorrelationId",o),i.setRequestHeader("X-CorrelationId",o),i.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),i.setRequestHeader("X-ClientType",t.clientType);var a=c("MidgardVersion")||c(h);a&&i.setRequestHeader(h,a);var f=c(p);f&&i.setRequestHeader(p,f),i.addEventListener("load",function(){if(200===i.status)try{var e=JSON.parse(i.response);e.RootCorrelationId=o,e.LokiVersion=i.getResponseHeader("x-serverversion")||"",n(e)}catch(e){r(new u("GetLokiConfigError","Failed to parse initialization config.",o))}else r(new u("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+i.status,o,i.status))}),i.addEventListener("error",function(){r(new u("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",o))}),i.addEventListener("timeout",function(){r(new u("GetLokiConfigError","Loki config request timed out after 60000 ms.",o))}),i.timeout=6e4,i.send()})}var g=0;function y(e){return(function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})})(this,void 0,void 0,function(){var t;return(function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}})(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,6]),[4,b(e)];case 1:return n.sent(),[3,6];case 2:return t=n.sent(),g<2?(g++,[4,y(e)]):[3,4];case 3:return n.sent(),[3,5];case 4:throw t.numberOfRetries=g,t;case 5:return[3,6];case 6:return[2]}})})}function b(e){return new Promise(function(t,n){var r=document.createElement("script");r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",function(){t()}),r.addEventListener("error",function(){n(new u("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(r)})}function w(e,t){return new Promise(function(n,r){setTimeout(function(){try{window.LPC||r(new u("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||r(new u("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));var i=(function(e,t){return{refreshAuthToken:E(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}})(e,t);window.LPC.start(i),n()}catch(e){r(new u("StartLivePersonaCardError",e.name+" "+e.message))}},0)})}function E(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}var S;function x(e,t){return(function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})})(this,void 0,void 0,function(){var n;return(function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}})(this,function(r){switch(r.label){case 0:return[4,(0,new Promise(function(e){return window.setTimeout(e,0)}))];case 1:r.sent();try{if(!window.OfficeFeed)throw new u("StartOfficeFeedError","window.OfficeFeed is undefined.");if(!window.OfficeFeedStrings||!window.OfficeFeedStrings.strings)throw new u("StartOfficeFeedError","window.OfficeFeedStrings is undefined.");return n=(function(e,t){return{accountUpn:e.Upn,getLokiToken:T(t),options:t.options,hostAppActions:t.hostAppActions,strings:window.OfficeFeedStrings.strings}})(e,t),[2,window.OfficeFeed.start(n)]}catch(e){throw new u("StartOfficeFeedError",e.name+" "+e.message)}return[2]}})})}function T(e){return function(t){return new Promise(function(t,n){e.getAuthToken(function(e,n){t(e)},function(e,t){n("Error getting auth token: "+e+" (authRequestCorrelationId: "+t+")")})})}}!(function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"})(S||(S={}));var N=(function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{window.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{window.performance.mark(e+"-end"),window.performance.measure(e,e+"-start",e+"-end");var t=window.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=window.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e})();function C(e){return void 0===e||"string"!=typeof e||""===e||null===e}function k(e){return void 0===e||"function"!=typeof e}var L=["msit","df","ppe"],A=["Prod","Blackforest","GccModerate"];function O(e){var t="";if(e){var n=[];C(e.culture)&&n.push("culture"),C(e.clientType)&&n.push("clientType"),C(e.clientContextType)&&n.push("clientContextType"),C(e.clientCorrelationId)&&n.push("clientCorrelationId"),k(e.logMessage)&&n.push("logMessage"),k(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===L.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+L.join(", ")+" for pre-production environments. "),-1===A.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+A.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new u("ValidateBootstrapperConfigError",t)}n.d(t,"initializeLivePersonaCardAsync",function(){return F}),n.d(t,"initializeOfficeFeedAsync",function(){return q}),n.d(t,"fetchLokiConfigAsync",function(){return R});var M,_,D=function(){return(D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},H=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return(function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}})([s,u])}}},B=!1,j="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257";function F(e){return P(this,void 0,void 0,function(){var t,n,r=this;return H(this,function(i){return!B&&M||(t=new N,n=o.getOrCreate(e),B=!1,(M=new Promise(function(i,s){return P(r,void 0,void 0,function(){var r,o,u,a,f;return H(this,function(c){switch(c.label){case 0:return c.trys.push([0,9,,10]),O(e),t.startCustomTiming(S.getAuthToken),[4,l(e.authToken,e.getAuthToken)];case 1:return r=c.sent(),t.endCustomTiming(S.getAuthToken),t.measureFromStart(S.getAuthTokenFromStart),t.startCustomTiming(S.getLokiConfig),[4,v(r,e)];case 2:return o=c.sent(),t.endCustomTiming(S.getLokiConfig),t.measureFromStart(S.getLokiConfigFromStart),t.startCustomTiming(S.getLpcBundles),e.scriptsInsertedByHostPromise?[4,e.scriptsInsertedByHostPromise]:[3,4];case 3:return c.sent(),[3,6];case 4:return[4,(h=o,d=h.Resources.livepersonacardstrings,p="OwaPeopleHub"===h.Workload?h.Resources.livepersonacard_global:h.Resources.livepersonacard_full,Promise.all([y(d),y(p)]))];case 5:c.sent(),c.label=6;case 6:return t.endCustomTiming(S.getLpcBundles),t.measureFromStart(S.getLpcBundlesFromStart),t.startCustomTiming(S.startLpc),[4,w(o,e)];case 7:return c.sent(),t.endCustomTiming(S.startLpc),t.measureFromStart(S.startLpcFromStart),[4,n.updateContextWithLokiDataAsync(o,j).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 8:return c.sent(),(u=U(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,u.isConsumer=e.isConsumer,n.logEventAsync({name:"initializeLivePersonaCard_success",properties:u},j),i(),[3,10];case 9:return a=c.sent(),f=U(t.getAllTimings()),n.logEventAsync({name:"initializeLivePersonaCard_failure",properties:D({},z(a),f,{isConsumer:e.isConsumer})},j),s("Failed to initialize Live Persona Card: "+a.name+" "+a.message),[3,10];case 10:return[2]}var h,p,d})})})).catch(function(){setTimeout(function(){B=!0},3e5)})),[2,M]})})}var I=!1;function q(e){return P(this,void 0,void 0,function(){var t,n,r=this;return H(this,function(i){return!I&&_||(t=new N,n=o.getOrCreate(e),I=!1,(_=new Promise(function(i,s){return P(r,void 0,void 0,function(){var r,o,u,a,f,c;return H(this,function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),O(e),[4,l(e.authToken,e.getAuthToken)];case 1:return r=h.sent(),t.measureFromStart(S.getAuthTokenFromStart),[4,v(r,e)];case 2:return o=h.sent(),t.measureFromStart(S.getLokiConfigFromStart),[4,(p=o,d=p.Resources.officefeedstrings,m=p.Resources.officefeed_feed,Promise.all([y(d),y(m)]))];case 3:return h.sent(),t.measureFromStart(S.getOfficeFeedBundles),[4,x(o,e)];case 4:return u=h.sent(),[4,n.updateContextWithLokiDataAsync(o,j).catch(function(){console.log("Office Feed ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return h.sent(),(a=U(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,n.logEventAsync({name:"initializeOfficeFeed_success",properties:a},j),i(u),[3,7];case 6:return f=h.sent(),c=U(t.getAllTimings()),n.logEventAsync({name:"initializeOfficeFeed_failure",properties:D({},z(f),c)},j),s("Failed to initialize Office Feed: "+f.name),[3,7];case 7:return[2]}var p,d,m})})})).catch(function(){setTimeout(function(){I=!0},3e5)})),[2,_]})})}function R(e){return P(this,void 0,void 0,function(){return H(this,function(t){switch(t.label){case 0:return[4,l(e.authToken,e.getAuthToken)];case 1:return[2,v(t.sent(),e)]}})})}function U(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function z(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}}])});
define("@ms/odsp-datasources/lib/Loki",["require","exports","tslib","./dataSources/loki/Loki"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-datasources/lib/dataSources/loki/Loki",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/oAuthToken/OAuthTokenProvider","../base/DataSource","../oAuthToken/OAuthTokenDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;n._oAuthTokenProvider=new i.default(null,{oAuthTokenDataSource:new o.default(t)});return n}t.prototype.getRegion=function(){var e=new r.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n){e.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});return""}var i=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[i]}catch(t){e.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:t});return""}};t.prototype.getAuthTokenGetter=function(e){void 0===e&&(e="");return this.getAadAuthTokenGetter()};t.prototype.getAadAuthTokenGetter=function(){var e=this,t=this._pageContext.CorrelationId,n="https://loki.delve.office.com/";a(this._pageContext)&&(n="https://loki.delve.office.de/");return function(r,i){e._oAuthTokenProvider.getInstrumentedToken(n).then(function(e){return r(e.tokenInfo.token,e.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};i(JSON.stringify(n),t)})}};t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"};return t})(s.default);t.Loki=u;function a(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_")}t.isBlackforestEnvironment=a;t.isGccModerateEnvironment=function(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")};t.default=u});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardDataUpdate",["require","exports","@o365groups/gmc-bootstrapper/lib/types"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;t.setLpcGroupMembersDataUpdateListener=function(e){r=e};t.lpcUpdateGroupMembersData=function(e){if(r){var t=void 0,i=void 0;e&&e.Type===n.GroupIdentityType.ExternalDirectoryObjectId?i=e.Value:e&&e.Type===n.GroupIdentityType.SmtpAddress&&(t=e.Value);r({Smtp:t,AadObjectId:i,PersonaType:"Group",OlsPersonaId:""})}}});
define("@o365groups/gmc-bootstrapper/lib/types",["require","exports","tslib","@o365groups/gmc-types"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@o365groups/gmc-types",["./gmc-types/lib/index"],function(e){return e});
define("@o365groups/gmc-types/lib/index",["require","exports","tslib","./common/entities/GroupIdentityTypes"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@o365groups/gmc-types/lib/common/entities/GroupIdentityTypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.SmtpAddress=0]="SmtpAddress";e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"})(t.GroupIdentityType||(t.GroupIdentityType={}))});
define("odsp-next/controls/itemMuteNotification/ItemMuteNotification",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../resources/DataSourceResourceKeys","./ItemMuteNotification.resx","../../utilities/features/Features","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Tooltip","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=f.isFeatureEnabled(f.EnableNewCommentExperience);t.notificationStateMaterials={on:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"Ringer",tooltips:a.default.tooltipsOn,isAriaChecked:!0,ariaLabel:a.default.ariaLabelOn},off:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:h?"RingerRemove":"RingerOff",tooltips:a.default.tooltipsOff,isAriaChecked:!1,ariaLabel:a.default.ariaLabelOff},loading:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:a.default.tooltipsLoading,ariaLabel:a.default.ariaLabelLoading},error:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:a.default.tooltipsError,ariaLabel:a.default.ariaLabelError}};var p=(function(e){n.__extends(u,e);function u(t,n){var r=e.call(this,t,n)||this;r._toggleNotifications=function(){if(3!==r.state.notificationState&&2!==r.state.notificationState){r.setState(function(e){return{notificationState:0===e.notificationState?1:0}});var e=r.state.notificationState,t=0===e||1!==e&&void 0;r._updateNotificationState(t)}};r._loadNotificationState=function(e){r._itemMuteNotificationDataSource.getNotificationState(e,"getNotification").then(function(e){void 0!==e?r.setState(function(){return{notificationState:e?0:1}}):r.setState({notificationState:3})})};r._updateNotificationState=function(e){void 0!==e&&r._itemMuteNotificationDataSource.updateNotificationState(e,r.props.item,"updateNotification")};r._scope=new s.default;r._itemMuteNotificationDataSource=r.props.itemMuteNotificationDataSource||r._scope.attach(r.context.dependencies.itemMuteNotificationDataSource);r.state={notificationState:2};return r}u.prototype.render=function(){var e;switch(this.state.notificationState){case 0:e=t.notificationStateMaterials.on;break;case 1:e=t.notificationStateMaterials.off;break;case 2:e=t.notificationStateMaterials.loading;break;case 3:e=t.notificationStateMaterials.error}return r.createElement(c.TooltipHost,{content:e.tooltips,id:l.getId("bellIconTooltipHost"),styles:{root:{display:"inline-block"}},directionalHint:c.DirectionalHint.bottomAutoEdge},r.createElement(i.IconButton,{className:e.bellButtonClassName,onClick:this._toggleNotifications,iconProps:{iconName:e.bellButtonIconName},role:"switch","aria-checked":e.isAriaChecked,"aria-label":e.ariaLabel}))};u.prototype.componentDidMount=function(){this._loadNotificationState(this.props.item)};u.prototype.componentWillUnmount=function(){this._scope.dispose()};u.prototype.UNSAFE_componentWillUpdate=function(e){e.item!==this.props.item&&this._loadNotificationState(e.item)};u.contextTypes=o.RESOLVED_COMPONENT_CONTEXT_TYPES;return u})(r.PureComponent);t.ItemMuteNotification=p;t.resourceKey=o.createResolvedComponentTypeResourceKey(e("module").id,p,{itemMuteNotificationDataSource:u.itemMuteNotificationDataSource})});
define("odsp-next/controls/base/react/ResolvedComponentType",["require","exports","tslib","react","@ms/odsp-shared-react/lib/utilities/resources/Resources","./WithResources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getResolvedComponentType=function(e){var t=(function(t){n.__extends(s,t);function s(){return null!==t&&t.apply(this,arguments)||this}s.prototype.render=function(){var t=this.props,s=t.resources,o=n.__rest(t,["resources"]);return r.createElement(i.ResourcedControl,{specification:i.toSpecification(e,o),resources:s})};return s})(r.PureComponent);return s.withResources()(t)}});
define("odsp-next/controls/itemActivityFeed/ItemActivityFeed",["require","exports","tslib","react","prop-types","./ItemActivityFeed.resx","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed","./ItemActivityFeedViewOption","./OldItemActivityFeedViewOption","../../models/itemsScope/ItemsScopeFeature.key","../../resources/DataSourceResourceKeys","../../providers/itemActivities/GroupedItemActivityFeedStore","../../providers/engagement/Engagement","../../providers/itemActivities/ItemCommentsStore","../../providers/item/ItemProvider","../itemMuteNotification/ItemMuteNotification","../base/react/ResolvedComponentType","../../utilities/features/Features","../../models/item/SharingType","office-ui-fabric-react/lib/Dialog","../../controls/sharing/shareByEmail/Sharing.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=m.getResolvedComponentType(v.resourceKey.local.bypass),S=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t,r)||this;i._canOpenItem=function(e){return!!i._getItemUrl(e)};i._onItemClick=function(e,t){var n=i.props.item,r=i._getItemUrl(e);i._itemActivityFeedHelper.navigateToItem(n,e,r,function(e){i._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})};i._onItemCommentsSettingChanged=function(e){var t=i.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var r=n.__assign(n.__assign({},t.comments&&t.comments.settings),{isCommentDisabled:e}),s=i._resources.consume(d.resourceKey);s.invalidateItem(t.key);s.invalidateItem(t.parentKey);i._itemActivityFeedHelper.updateItem(t,{comments:n.__assign(n.__assign({},t.comments),{settings:r})});var o=t&&t.properties&&t.properties.ID;i._isItemsScopeEnabled()&&i._resources.consumeAsync(l.itemInvalidator).then(function(e){e.refreshItemsInCurrentItemSet([o])})}};i._refreshCurrentItem=function(){var e=i.props.item,t=e&&e.properties&&e.properties.ID;t&&i._isItemsScopeEnabled()&&i._resources.consumeAsync(l.itemInvalidator).then(function(e){e.refreshItemsInCurrentItemSet([t])})};i._canDeleteActivity=function(e){var t=i.props.item;switch(e){case 2:return i._isCommentsAvailable(t)&&i._itemActivityFeedHelper.checkHasDeletePermission(t);default:return!1}};i._onRenderUser=function(e,t){return i._itemActivityFeedHelper.renderUser(e,t)};i._deleteCommentActivity=function(e,t,n){var r=n.commentItem,s=n.commentId,o=i.props.item,u=o.isRootFolder?"driveRoot":o.folder?"folder":o.extension||"file",a=void 0!==o.sharingType?y.default[o.sharingType]:void 0;if(e&&r&&s){i._itemCommentsStore.deleteCommentById(r,s,t).then(function(){"sharePointList"===i._itemActivityFeedHelper.getAPIEnvironment(o)&&i._refreshCurrentItem()});i._engagement.logData({name:"ActivityFeed.DeleteComment",isIntentional:!0,extraData:{itemType:u,sharingType:a}})}};i._onCheckUserAccess=function(e,t,n){var r=i.props.item;i._itemActivityFeedHelper.checkUserAccess(r,i.state.graphDataSource,e,t,n)};i._onGrantAccess=function(e,t,n){t&&(i._grantAccessStatusCallback=t);if(e&&0===e.length)i._sharingStatusCallBack("share_grantAccessCompleted");else{i._itemActivityFeedSharingHelper.setGrantees(e);i._itemActivityFeedSharingHelper.setDismissCallback(i._onDismissSharingDialog);i._itemActivityFeedSharingHelper.setStatusCallback(i._sharingStatusCallBack);i._itemActivityFeedSharingHelper.setResizeCallback(i._onResizeSharingDialog);i.setState({showSharingDialog:!0})}};i._onDismissSharingDialog=function(){i.setState({showSharingDialog:!1});i._grantAccessStatusCallback&&i._grantAccessStatusCallback("share_dismiss");i._itemActivityFeedSharingHelper.init(i._resources,i.props.item)};i._onResizeSharingDialog=function(){};i._sharingStatusCallBack=function(e){i.setState({showSharingDialog:!1});i._grantAccessStatusCallback&&(e?i._grantAccessStatusCallback(e):i._grantAccessStatusCallback("share_error"));i._itemActivityFeedSharingHelper.init(i._resources,i.props.item)};i._getListChangesAsActivities=function(){var e=i.props.item;return i._itemActivityFeedHelper.getSPListItemActivities(e,i._itemActivityFeedHelper.getGraphItemUrl(e,i.state.graphDataSource))};i._resources=t.resources;i._itemActivityFeedStore=i._resources.consume(c.resourceKey);i._itemCommentsStore=i._resources.consume(p.resourceKey);i._itemActivityFeedHelper=i._resources.consume(l.itemActivityFeedHelper);i._engagement=i._resources.consume(h.resourceKey);i._isItemsScopeEnabled=i._resources.consume(f.isItemsScopeEnabledResourceKey.lazy);i._itemActivityFeedHelper.init(i._resources);i._itemActivityFeedHelper.isAtMentionEnabled(t.item)&&i._resources.consumeAsync(l.itemActivityFeedSharingHelper).then(function(e){i._itemActivityFeedSharingHelper=e;i._itemActivityFeedSharingHelper.init(i._resources,t.item);i._isSharingDialogEnabled=!0});var s=i._itemActivityFeedHelper.getDeepLinkCommentThreadId();i.state={graphDataSource:i._resources.consume(l.graph.optional),commentsOnly:"comments"===t.defaultViewOption||void 0!==s,showSharingDialog:!1};i._isNewCommentExperienceEnabled=g.isFeatureEnabled(g.EnableNewCommentExperience);return i}t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore,peoplePickerProvider:this._itemActivityFeedHelper.getPeoplePickerProvider(),engagementSource:"ActivityFeed"}};t.prototype.componentDidMount=function(){this.state.graphDataSource||this._loadGraphDataSource()};t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,r=this.props.item;return n&&r&&n.key!==r.key&&0===n.revision||this._isCommentSettingsChanged(n,r)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly||t.showSharingDialog!==this.state.showSharingDialog};t.prototype.render=function(){var e=this.props,t=e.item,n=e.focusCommentInputOnMount,i=this.state,s=i.commentsOnly,u=i.showSharingDialog,a="sharePointList"===this._itemActivityFeedHelper.getAPIEnvironment(t);this._isNewCommentExperienceEnabled=this._isNewCommentExperienceEnabled||a;var f=t.displayName||"",l=this._itemActivityFeedHelper.getGraphItemUrl(t,this.state.graphDataSource),c=this._itemActivityFeedHelper.getAccessToken(t,this.state.graphDataSource),h=a||l&&(!this._itemActivityFeedHelper.isAccessTokenRequired()||c),p=this._itemActivityFeedHelper.isCommentOnItemDisabled(t);if(h){var d={name:f,graphItemUrl:l,accessToken:c},v=this._itemActivityFeedHelper.getCommentListItem(t,d)||void 0,m=this._itemActivityFeedHelper.isCommentsOnly(t,s),g=this._itemActivityFeedHelper.isReadOnly(t),y=t.isRootFolder?"driveRoot":t.folder?"folder":t.extension||"file";this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0,extraData:{itemType:y||""}});return r.createElement("div",{className:"od-ItemActivityFeedWrapper"},this._isNewCommentExperienceEnabled?this._renderItemActivityFeedViewOption(s,t,p):this._renderOldItemActivityFeedViewOption(s,t,p),!0===this._isSharingDialogEnabled&&r.createElement(b.Dialog,{hidden:!u,onDismiss:this._onDismissSharingDialog,"aria-label":w.default.ShareText,dialogContentProps:{type:b.DialogType.normal,title:""}},this._itemActivityFeedSharingHelper.renderGrantAccess()),r.createElement(o.default,{currentUserEmail:this._itemActivityFeedHelper.getCurrentUserEmail(),containingItem:d,isSingleLevel:this._itemActivityFeedHelper.isSingleLevel(t),canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,currentRootTitle:this._itemActivityFeedHelper.getCurrentRootTitle(t),defaultItemTitle:this._itemActivityFeedHelper.getDefaultItemTitle(t),commentListItem:v,isReadonly:g,commentsOnly:m,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged,environment:this._itemActivityFeedHelper.getAPIEnvironment(t),isNewCommentExperienceEnabled:this._isNewCommentExperienceEnabled,getpersonaIconUrl:this._itemActivityFeedHelper.getPersonaIconUrl(),commentTextBoxPlaceholder:this._getCommentTextBoxPlaceholder(t),activityApiHeaders:this._itemActivityFeedHelper.getActivityApiHeaders(t),isAtMentionEnabled:this._itemActivityFeedHelper.isAtMentionEnabled(t),isPublicEmailAddressMentionSupported:this._itemActivityFeedHelper.isPublicEmailAddressMentionSupported(t),getListActivities:this._getListChangesAsActivities,onCheckUserAccess:this._onCheckUserAccess,focusCommentInputOnMount:n,onGrantAccess:this._onGrantAccess,deeplinkCommentThreadId:this._itemActivityFeedHelper.getDeepLinkCommentThreadId(),refreshCurrentItemCallback:a?this._refreshCurrentItem:void 0}))}return r.createElement("div",null)};t.prototype._isCommentsAvailable=function(e){return this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(e)};t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)};t.prototype._getItemUrl=function(e){return this._itemActivityFeedHelper.getActivityItemUrl(e)};t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(l.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype._getActionMenuFunctions=function(){var e;return(e={})[2]={delete:this._deleteCommentActivity},e};t.prototype._renderItemActivityFeedViewOption=function(e,t,n){var i=this,s=this._itemActivityFeedHelper.activityHeaderToDisplay(t);return r.createElement("div",{className:"od-ItemActivityFeed-header"},s&&r.createElement("h2",{className:"od-ItemActivityFeed-title"},s),r.createElement(u.ItemActivityFeedViewOption,{isCommentsOnlyView:e,item:t,onSelectMenuOption:function(e){i.state.commentsOnly!==e&&i._engagement.logData({name:"ActivityFeedViewOption.Toggle."+(e?"Comments_Only":"All_Activity"),isIntentional:!0});i.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n,extraClassName:"spListForm"===this.props.scenario?"inListForm":void 0}),this._itemActivityFeedHelper.isItemNotificationActive(t)&&r.createElement(E,{item:t}))};t.prototype._renderOldItemActivityFeedViewOption=function(e,t,n){var i=this;return r.createElement("div",{className:"od-ItemActivityFeed-header-old"},r.createElement("h2",{className:"od-ItemActivityFeed-title-old"},s.default.itemActivityFeedSectionTitle),this._itemActivityFeedHelper.isItemNotificationActive(t)&&r.createElement(E,{item:t}),r.createElement(a.OldItemActivityFeedViewOption,{isCommentsOnlyView:e,item:t,onSelectMenuOption:function(e){i.state.commentsOnly!==e&&i._engagement.logData({name:"ActivityFeedViewOption.Toggle."+(e?"Comments_Only":"All_Activity"),isIntentional:!0});i.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n}))};t.prototype._getCommentTextBoxPlaceholder=function(e){return this._itemActivityFeedHelper.isCommentOnItemDisabled(e)?s.default.commentsDisabledPlaceHolder:this._itemActivityFeedHelper.checkHasCommentingPermission(e)?this._itemActivityFeedHelper.isAtMentionEnabled(e)?s.default.addMentionCommentPlaceHolder:s.default.addCommentPlaceHolder:s.default.commentPermissionPlaceHolder};t.childContextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired,peoplePickerProvider:i.object,engagementSource:i.object.isRequired};return t})(r.Component);t.default=S});
define("odsp-next/controls/itemActivityFeed/ItemActivityFeedViewOption",["require","exports","tslib","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Utilities","../../models/itemActivity/ItemActivityFeedHelper","office-ui-fabric-react/lib/common/DirectionalHint","./ItemActivityFeed.resx","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={isActivityClicked:!n.props.isCommentsOnlyView,isCommentClicked:n.props.isCommentsOnlyView};return n}t.prototype.render=function(){var e=this.props,t=e.item,n=e.extraClassName;return r.createElement(r.Fragment,null,this._isMenuVisible()?r.createElement(s.DefaultButton,{className:o.css("od-ItemActivityFeed-viewOption",n),text:this._getCurrentViewOption(),menuProps:this._getViewMenuProps(t),ariaLabel:i.format(f.default.itemActivityFeedViewOptionAriaLabel,this._getCurrentViewOption())}):void 0)};t.prototype._isCommentsAvailable=function(e){var t=this.props.isCommentsInActivityFeedEnabled,n=void 0!==t&&t;return l.isFeatureEnabled(l.ActivityFeedRefactoring)?this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e):u.isNonOfficeFileCommentsAvailable(e,n)};t.prototype._getViewMenuProps=function(e){return{directionalHint:a.DirectionalHint.bottomLeftEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"}}};t.prototype._getMenuItems=function(){var e=this,t=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:f.default.itemActivityFeedViewAll,ariaLabel:i.format(f.default.itemActivityFeedViewAllAriaLabel,this.state.isActivityClicked?f.default.itemActivityFeedViewSelected:""),onClick:function(n,r){if(t){t(!1);e.setState({isActivityClicked:!0,isCommentClicked:!1})}},iconProps:{iconName:this.state.isActivityClicked?"CheckMark":void 0}},{key:"activityFeed.commentOnly",name:f.default.itemActivityFeedCommentsOnly,ariaLabel:i.format(f.default.itemActivityFeedCommentsOnlyAriaLabel,this.state.isCommentClicked?f.default.itemActivityFeedViewSelected:""),onClick:function(n,r){if(t){t(!0);e.setState({isActivityClicked:!1,isCommentClicked:!0})}},iconProps:{iconName:this.state.isCommentClicked?"CheckMark":void 0}}]};t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)};t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?f.default.itemActivityFeedCommentsOnly:f.default.itemActivityFeedViewAll};return t})(r.Component);t.ItemActivityFeedViewOption=c});
define("odsp-next/controls/detailsPane/section/itemActivityFeed/LegacyItemActivityFeedSection",["require","exports","tslib","react","../../../infoPane/sections/activitiesFeed/ActivitiesFeed","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeed",["require","exports","./ActivitiesFeed.html","./ActivitiesFeedViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css","../../../itemActivityTile/ItemActivityTile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-activities-feed",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-activities-feed",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeed.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--activitiesfeed" data-bind="keyboard:keyNav.keyboardOptions,css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow},selection:{data:keyNav.focusableTiles,mode:\'single\',direction:\'vertical\',focused:keyNav.focusedItem}"><div class="InfoPane-sectionHeader" id="od-ActivitiesFeed-sectionHeader" data-bind="hasFocus:keyNav.sectionHeaderFocus,toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':undefined}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText" data-bind="text:resxStrings.ActivitiesHeader"></h2></div><div class="InfoPane-sectionContent" role="tree" data-bind="foreach:{data:tileCollections}"><div class="od-ActivitiesFeed-listTitle ms-font-s ms-fontColor-neutralSecondaryAlt ms-fontWeight-semibold" data-bind="text:title"></div><div class="od-ActivitiesFeed-list" data-bind="foreach:{data:tiles}"><ms-item-activity-tile params="activity: $data"></ms-item-activity-tile></div></div><div class="InfoPane-sectionContent">\x3c!--ko if:isLoading()--\x3e<div class="od-ActivitiesFeed-loadingSpinnerFlat" data-bind="component:{name:loadingSpinnerFlatTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e\x3c!--ko if:errorMessage()--\x3e<span class="ms-fontColor-error" data-bind="text:errorMessage"></span>\x3c!--/ko--\x3e\x3c!--ko if:!errorMessage&&!hasChanges()--\x3e<span class="ms-font-s" data-bind="text:resxStrings.NoChange"></span>\x3c!--/ko--\x3e\x3c!--ko if:showForEarlierChangesMsg()--\x3e<span class="od-ActivitiesFeed-sectionForEarlierChanges ms-font-s" data-bind="bindableHtml:forEarlierChangesMsg,click:onFileVersionClick,clickBubble:false"></span>\x3c!--/ko--\x3e\x3c!--ko if:showSeeMore()--\x3e<a data-bind="click:onSeeMore,clickBubble:false,text:seeMoreText" href="#"></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../../bindings/html/BindableHtmlBinding","../../../../resources/ControlResourceKeys","../../../../models/item/ItemType","@ms/odsp-utilities/lib/dateTime/DateTime","./ActivitiesFeed.resx","./ActivitiesFeedKeyboardNav","./ActivitiesFeedHelper","../../../../providers/itemActivity/ItemActivityAggregator","@ms/odsp-utilities/lib/string/StringHelper","../../../../bindings/toggle/ToggleBinding","../../../../bindings/selection/SelectionBinding","../../../../bindings/keyboard/KeyboardBinding","../../../loadingSpinner/LoadingSpinner","../../SectionHelper","@ms/odsp-utilities/lib/modules/Modules","../../../../actions/base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(t){n.__extends(E,t);function E(e,n){void 0===n&&(n={});var r=t.call(this,e,n)||this,i=r.observables,u=r.resources;r._item=e.item;var a=r.scope.attach(new(r.resources.consume(w.typeResourceKey))({canFallback:!0,ignoreSelection:!0}));r._currentItem=a.currentItem;r.addBindingHandlers({bindableHtml:s.default,keyboard:m.default,toggle:d.default,selection:v.default});var h=u.consume(o.isSharingSectionExpanded.optional),b=r.resources.consume(o.actionMap);r._showVersionHistoryAction=new(r.child(b.ShowVersionHistoryAction));r._itemActivityResults=i.create([]);r.isLoading=i.create(!0);r.loadingSpinnerFlatTagName=g.default.tagName;r._helper=new(r.managed(c.default));r.sectionHelper=new(r.managed(y.default))({shouldStartExpanded:!h||!h.peek()});r.keyNav=new l.default;var E=r.thisWeekCollection=i.createArray([]),S=r.lastWeekCollection=i.createArray([]),x=r.earlierCollection=i.createArray([]);r.resxStrings=f.default;r.hasChanges=i.pureCompute(r._computeHasChanges);r.showForEarlierChangesMsg=i.pureCompute(r._computeShowForEarlierChangesMsg);r.forEarlierChangesMsg=p.format(f.default.ForEarlierChanges,'<a href="#">',"</a>");r._activityComponents=null;r.showSeeMore=i.create(!1);r.seeMoreText=f.default.ActivitiesFeedShowMore;r.errorMessage=r.createObservable(null);var T=i.createArray([{title:f.default.ActivitiesFeedThisWeekListText,tiles:E},{title:f.default.ActivitiesFeedLastWeekListText,tiles:S},{title:f.default.ActivitiesFeedEarlierListText,tiles:x}]);r.tileCollections=r.addDisposable(T.filter(function(e){return e.tiles().length>0}));r._itemActivityQueryParams={add:!0,deleteObject:!0,fetchLimit:100,group:!0,item:!0,latestFirst:!0,move:!0,rename:!0,restore:!0,roleAssignmentAdd:!0,roleDefinitionAdd:!0,update:!0,user:!0};i.backgroundCompute(r._updateActivities);i.backgroundCompute(r._computeUpdateActivityComponents);return r}E.prototype.onFileVersionClick=function(e,t){this._showVersionHistoryAction.execute(t).done();return!1};E.prototype.onSeeMore=function(){var e=this;this.showSeeMore(!1);this.isLoading(!0);this.async.setTimeout(function(){e._generateCollectionsToRender(e._activityComponents,!0);e.isLoading(!1)},0);return!1};E.prototype._updateActivities=function(){var e=this,t=this._item();this.isLoading(!0);this.thisWeekCollection([]);this.lastWeekCollection([]);this.earlierCollection([]);this.keyNav.focusableTiles([]);this._activityComponents=null;var n=t.type===u.default.Folder&&t===this._currentItem.peek();this._getItemActivityDataSource().then(function(r){return r.getItemActivities(t,e._itemActivityQueryParams,n)}).done(function(t){e._itemActivityResults(t);e.errorMessage(null);e.isLoading(!1)},function(t){e.errorMessage(e.resxStrings.Error);e.isLoading(!1)})};E.prototype._computeHasChanges=function(){return 0!==this._itemActivityResults().length};E.prototype._computeUpdateActivityComponents=function(){if(this.hasChanges()){this._activityComponents=h.default.process(this._itemActivityResults());this._generateCollectionsToRender(this._activityComponents,!1)}};E.prototype._computeShowForEarlierChangesMsg=function(){var e=this._item(),t=this._itemActivityResults();return(e.type===u.default.File||!!e.appMap)&&(!this.hasChanges()||1!==t[t.length-1].itemActivityChangeType)&&!this.showSeeMore()&&this._showVersionHistoryAction.isAvailable()};E.prototype._generateCollectionsToRender=function(e,t){var n=[],r=[],i=[],s=[];this.showSeeMore(!1);if(e)for(var o=0;o<e.length;o++){var u=e[o],f=this._helper.convertToTile(u,o),l=u.date;(a.isThisWeek(l)?n:a.isLastWeek(l)?r:i).push(f);s.push(f);var c=o+1;if(!t&&6===c&&e.length>c){this.showSeeMore(!0);break}}this.thisWeekCollection(n);this.lastWeekCollection(r);this.earlierCollection(i);this.keyNav.focusableTiles(s)};E.prototype._getItemActivityDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["../../../../dataSources/itemActivity/odb/ItemActivityDataSource"],t,n)})).then(b.getDefaultExport).then(function(e){return new(t.managed(e))});this._getItemActivityDataSource=function(){return n};return n};E.dependencies=n.__assign({},r.default.dependencies);return E})(r.default);t.default=E});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedKeyboardNav",["require","exports","tslib","knockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){var e=this;this.keyboardOptions=[{target:null,mappings:{Left:this.keyLeft,Right:this.keyRight,Enter:this.onEnter,Space:this.onSpace}},{target:window,mappings:{}}];this.focusableTiles=r.observableArray([]);this.focusedItem=r.observable();this.sectionHeaderFocus=r.observable(!1);this.sectionHeaderFocus.subscribe(function(t){!t&&e.focusedItem()&&e.focusedItem().focused(!1)})}e.prototype.keyRight=function(e,t){e.keyNav.trySetExpansion(!0);t.stopPropagation();return!0};e.prototype.keyLeft=function(e,t){e.keyNav.trySetExpansion(!1);t.stopPropagation();return!0};e.prototype.onEnter=function(e,t){e.keyNav.trySetExpansion();t.stopPropagation();return!0};e.prototype.onSpace=function(e,t){return e.keyNav.onEnter(e,t)};e.prototype.trySetExpansion=function(e){var t=this.focusedItem();if(t&&1===t.type){var r=t,i=r.expanded();r.expanded(void 0===e?!i:e);if(i!==e){var s=this.focusableTiles,o=s.indexOf(r)+1;if(o>0&&r.focused()){var u=r.activities;r.expanded()?s.splice.apply(s,n.__spreadArrays([o,0],u)):s.splice(o,u.length)}}}};return e})();t.default=i});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedHelper",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/dateTime/DateTime","../../../../controls/itemActivityTile/HeadlineGenerator","@ms/odsp-utilities/lib/locale/Locale"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._headlineGenerator=t.resources.consume(o.resourceKey);return t}t.prototype.convertToTile=function(e,t){var n,i=e.relativeTime?s.getRelativeDateTimeStringForLists(e.relativeTime):s.getRelativeDateTimeStringPastWithHourMinute(e.date);if(1===e.type){for(var o=e,a=this._getMainEditor(o.editors),f=new Array,l=0,c=o.activities;l<c.length;l++){var h=c[l],p={date:h.date.toLocaleTimeString(u.default.language,{hour:"numeric",minute:"2-digit"}),editor:h.editor,focused:r.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(h),type:0,navigateToOptions:h.navigateToOptions};f.push(p)}n={activities:f,date:i,editor:a,expanded:r.observable(!1),focused:r.observable(!1),headline:this._headlineGenerator.generateHeadline(o),index:t,type:1}}else if(0===e.type){var d=e;n={date:i,editor:d.editor,focused:r.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(d),index:t,type:0,navigateToOptions:d.navigateToOptions}}return n};t.prototype._getMainEditor=function(e){var t,n=this;e.some(function(e){var r=e.email===n._headlineGenerator.userLoginName;r&&(t=e);return r});!t&&e.length>0&&(t=e[0]);return t};return t})(i.default);t.default=a});
define("odsp-next/controls/itemActivityTile/HeadlineGenerator",["require","exports","../../resources/DataSourceResourceKeys","./ItemActivityTile.resx","./ItemActivityTileAdd.resx","./ItemActivityTileComment.resx","./ItemActivityTileEdit.resx","./ItemActivityTileMove.resx","./ItemActivityTileRemove.resx","./ItemActivityTileRename.resx","./ItemActivityTileRenameOrMove.resx","./ItemActivityTileRestore.resx","./ItemActivityTileShare.resx","./ItemActivityTileVersion.resx","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g='<span class="ms-fontWeight-semibold">',y='<span class="od-ItemActivityTile-ellipsisWrapper">',b="</span>",w=(function(){function e(e,t){void 0===e&&(e={});this._userLoginName=t.identityDataSource.getIdentity().loginName}Object.defineProperty(e.prototype,"userLoginName",{get:function(){return this._userLoginName},enumerable:!0,configurable:!0});e.prototype.generateHeadline=function(e){var t=null;if(1===e.type){var n=e,r=this._encodeAggregate(n);t=this._generateAggregateHeadline(r)}else if(0===e.type){var i=e,s=this._encodeActivity(i);t=this.generateActivityHeadline(s)}return t};e.prototype.generateActivityHeadline=function(e){var t=this._encodeActivity(e),n=null,i=this._getEllipsisText(e,t.latestName),s=this._getEllipsisText(e,t.previousName,!0);this._isListItem="a list item"===e.latestName;switch(t.itemActivityChangeType){case 1:n=this._generateAddHeadline(t,i,s);break;case 2:n=this._generateCommentHeadline(t,i);break;case 3:n=this._generateEditHeadline(t,i);break;case 4:n=this._generateMoveHeadline(t,i);break;case 5:n=this._generateRemoveHeadline(t,i);break;case 6:n=this._generateRenameHeadline(t,i,s);break;case 7:n=this._generateRenameOrMoveHeadline(t,i);break;case 8:n=this._generateRestoreHeadline(t,i);break;case 9:n=this._generateShareHeadline(t,i);break;case 11:n=this._generateVersionHeadline(t,i);break;default:n=r.default.DataFetchError}return n};e.prototype._encodeAggregate=function(e){for(var t=new Array,n=0;n<e.editors.length;n++){var r=this._encodePerson(e.editors[n]);t.push(r)}var i=new Array;for(n=0;n<e.activities.length;n++){var s=this._encodeActivity(e.activities[n]);i.push(s)}return{activities:i,editors:t,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type}};e.prototype._encodeActivity=function(e){var t=this._encodePerson(e.editor),n=e.sharedWith,r=new Array;if(n)for(var i=0;i<e.sharedWith.length;i++){var s=this._encodePerson(e.sharedWith[i]);r.push(s)}return{id:e.id,changeToken:d.default.encodeText(e.changeToken),editor:t,latestName:d.default.encodeText(e.latestName),latestFolder:d.default.encodeText(e.latestFolder),previousName:d.default.encodeText(e.previousName),previousFolder:d.default.encodeText(e.previousFolder),sharedWith:r,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type,navigateToOptions:e.navigateToOptions}};e.prototype._encodePerson=function(e){return{userId:d.default.encodeText(e.userId),email:d.default.encodeText(e.email),name:d.default.encodeText(e.name)}};e.prototype._generateAddHeadline=function(e,t,n){var r=i.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(r.AddListItemYou,g,b):v.format(r.AddItemYou,g,b,y,t,b):this._isListItem?v.format(r.AddListItem,g,e.editor.name,b):v.format(r.AddItem,g,e.editor.name,b,y,t,b):this._isListItem?r.AddListItemNoEditors:v.format(r.AddItemNoEditors,y,t,b)};e.prototype._generateCommentHeadline=function(e,t){var n=s.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.CommentListItemYou,g,b):v.format(n.CommentItemYou,g,b,y,t,b):this._isListItem?v.format(n.CommentListItem,g,e.editor.name,b):v.format(n.CommentItem,g,e.editor.name,b,y,t,b):this._isListItem?n.CommentListItemNoEditors:v.format(n.CommentItemNoEditors,y,t,b)};e.prototype._generateVersionHeadline=function(e,t){var n=p.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.VersionListItemYou,g,b):v.format(n.VersionItemYou,g,b,y,t,b):this._isListItem?v.format(n.VersionListItem,g,e.editor.name,b):v.format(n.VersionItem,g,e.editor.name,b,y,t,b):this._isListItem?n.VersionListItemNoEditors:v.format(n.VersionItemNoEditors,y,t,b)};e.prototype._generateEditHeadline=function(e,t){var n=o.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.ListItemEditYou,g,b):v.format(n.EditYou,g,b,y,t,b):this._isListItem?v.format(n.ListItemEdit,g,e.editor.name,b):v.format(n.Edit,g,e.editor.name,b,y,t,b):this._isListItem?n.ListItemEditNoEditors:v.format(n.EditNoEditors,y,t,b)};e.prototype._generateMoveHeadline=function(e,t){var n=u.default,r=this._getEllipsisText(e,e.latestFolder),i=this._getEllipsisText(e,e.previousFolder,!0),s=!!e.latestFolder&&!!e.previousFolder,o=!e.latestFolder&&!!e.previousFolder,a=!!e.latestFolder&&!e.previousFolder;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?s?v.format(n.MoveFromToYou,g,b,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFromYou,g,b,y,t,b,y,i,b):a?v.format(n.MoveToYou,g,b,y,t,b,y,r,b):v.format(n.MoveYou,g,b,y,t,b):s?v.format(n.MoveFromTo,g,e.editor.name,b,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFrom,g,e.editor.name,b,y,t,b,y,i,b):a?v.format(n.MoveTo,g,e.editor.name,b,y,t,b,y,r,b):v.format(n.Move,g,e.editor.name,b,y,t,b):s?v.format(n.MoveFromToNoEditors,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFromNoEditors,y,t,b,y,i,b):a?v.format(n.MoveToNoEditors,y,t,b,y,r,b):v.format(n.MoveNoEditors,y,t,b)};e.prototype._generateRemoveHeadline=function(e,t){var n=a.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.ListItemRemoveYou,g,b):v.format(n.RemoveYou,g,b,y,t,b):this._isListItem?v.format(n.ListItemRemove,g,e.editor.name,b):v.format(n.Remove,g,e.editor.name,b,y,t,b):this._isListItem?n.ListItemRemoveNoEditors:v.format(n.RemoveNoEditors,y,t,b)};e.prototype._generateRenameHeadline=function(e,t,n){var r=f.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?e.previousName?v.format(r.RenameFromToYou,g,b,y,n,b,y,t,b):v.format(r.RenameToYou,g,b,y,t,b):e.previousName?v.format(r.RenameFromTo,g,e.editor.name,b,y,n,b,y,t,b):v.format(r.RenameTo,g,e.editor.name,b,y,t,b):e.previousName?v.format(r.RenameFromToNoEditors,y,n,b,y,t,b):v.format(r.RenameToNoEditors,y,t,b)};e.prototype._generateRenameOrMoveHeadline=function(e,t){var n=l.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?v.format(n.RenameOrMoveYou,g,b,y,t,b):v.format(n.RenameOrMove,g,e.editor.name,b,y,t,b):v.format(n.RenameOrMoveNoEditors,y,t,b)};e.prototype._generateRestoreHeadline=function(e,t){var n=c.default;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?v.format(n.RestoreYou,g,b,y,t,b):v.format(n.Restore,g,e.editor.name,b,y,t,b):v.format(n.RestoreNoEditors,y,t,b)};e.prototype._generateShareHeadline=function(e,t){return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._generateYouSharedWith(e.sharedWith,t):this._generateSharedWith(e.editor,e.sharedWith,t):this._generateNoEditorSharedWith(e.editor,e.sharedWith,t)};e.prototype._generateNoEditorSharedWith=function(e,t,n){var r=h.default,i=null;switch(t.length){case 0:i=this._isListItem?r.ListItemShareNoEditors:v.format(r.ShareNoEditors,y,n,b);break;case 1:i=this._isListItem?v.format(r.ListItemShareWithNoEditorsOnePerson,t[0].name):v.format(r.ShareWithNoEditorsOnePerson,y,n,b,t[0].name);break;case 2:i=this._isListItem?v.format(r.ListItemShareWithNoEditorsTwoPersons,t[0].name,t[1].name):v.format(r.ShareWithNoEditorsTwoPersons,y,n,b,t[0].name,t[1].name);break;default:if(this._isListItem){var s=v.getLocalizedCountValue(r.ListItemShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=v.format(s,t[0].name,t[1].name,String(t.length-2))}else{s=v.getLocalizedCountValue(r.ShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=v.format(s,y,n,b,t[0].name,t[1].name,String(t.length-2))}}return i};e.prototype._generateSharedWith=function(e,t,n){var r=h.default,i=null;if(t)switch(t.length){case 0:i=this._isListItem?v.format(r.ListItemShareWithNoPersons,g,e.name,b):v.format(r.ShareWithNoPersons,g,e.name,b,y,n,b);break;case 1:i=this._isListItem?v.format(r.ListItemShareWithOnePerson,g,e.name,b,t[0].name):v.format(r.ShareWithOnePerson,g,e.name,b,y,n,b,t[0].name);break;case 2:i=this._isListItem?v.format(r.ListItemShareWithTwoPersons,g,e.name,b,t[0].name,t[1].name):v.format(r.ShareWithTwoPersons,g,e.name,b,y,n,b,t[0].name,t[1].name);break;default:if(this._isListItem){var s=v.getLocalizedCountValue(r.ListItemShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=v.format(s,g,e.name,b,t[0].name,t[1].name,String(t.length-2))}else{s=v.getLocalizedCountValue(r.ShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=v.format(s,g,e.name,b,y,n,b,t[0].name,t[1].name,String(t.length-2))}}else i=v.format(r.ShareWithNoPersons,g,e.name,b,y,n,b);return i};e.prototype._generateYouSharedWith=function(e,t){var n=h.default,r=null;if(e)switch(e.length){case 0:r=this._isListItem?v.format(n.ListItemShareWithNoPersonsYou,g,b):v.format(n.ShareWithNoPersonsYou,g,b,y,t,b);break;case 1:r=this._isListItem?v.format(n.ListItemShareWithOnePersonYou,g,b,e[0].name):v.format(n.ShareWithOnePersonYou,g,b,y,t,b,e[0].name);break;case 2:r=this._isListItem?v.format(n.ListItemShareWithTwoPersonsYou,g,b,e[0].name,e[1].name):v.format(n.ShareWithTwoPersonsYou,g,b,y,t,b,e[0].name,e[1].name);break;default:if(this._isListItem){var i=v.getLocalizedCountValue(n.ListItemShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=v.format(i,g,b,e[0].name,e[1].name,String(e.length-2))}else{i=v.getLocalizedCountValue(n.ShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=v.format(i,g,b,y,t,b,e[0].name,e[1].name,String(e.length-2))}}else r=this._isListItem?v.format(n.ListItemShareWithNoPersonsYou,g,b):v.format(n.ShareWithNoPersonsYou,g,b,y,t,b);return r};e.prototype._generateAggregateHeadline=function(e){var t=null,n=e.editors,i=o.default;if(3===e.itemActivityChangeType&&i)if(this._didYouEdit(e.editors))t=this._generateAggregateHeadlineYou(e);else switch(n.length){case 0:t=v.format(i.AggregateNoEditors);break;case 1:t=v.format(i.AggregateOneEditor,g,n[0].name,b);break;case 2:t=v.format(i.AggregateTwoEditors,g,n[0].name,b,g,n[1].name,b);break;default:var s=v.getLocalizedCountValue(i.AggregateMultipleEditors,i.AggregateMultipleEditorsIntervals,n.length-2);t=v.format(s,g,n[0].name,n[1].name,b,String(n.length-2))}else t=r.default.DataFetchError;return t};e.prototype._generateAggregateHeadlineYou=function(e){var t,n,i=this,s=o.default,u=null,a=e.editors;a.some(function(e){if(e.email===i._userLoginName){t=e;return!0}});if((n=a.indexOf(t))>-1){a.splice(n,1);a.unshift(t)}if(3===e.itemActivityChangeType&&s)switch(a.length){case 1:u=v.format(s.AggregateEditYou,g,b);break;case 2:u=v.format(s.AggregateTwoEditorsYou,g,b,g,a[1].name,b);break;default:var f=v.getLocalizedCountValue(s.AggregateMultipleEditorsYou,s.AggregateMultipleEditorsYouIntervals,a.length-2);u=v.format(f,g,a[1].name,b,String(a.length-2))}else u=r.default.DataFetchError;return u};e.prototype._getEllipsisText=function(e,t,n){return!e.navigateToOptions||n?'<span class="od-ItemActivityTile-ellipsis" title="'+t+'">'+t+"</span>":'<a class="od-ItemActivityTile-ellipsis" title="'+t+'" data-bind="event: { click: function(obj, ev) { return $data.onClick($data.tile, ev); } }">'+t+"</a>"};e.prototype._didYouEdit=function(e){var t=this;return e.some(function(e){return e.email===t._userLoginName})};e.dependencies={identityDataSource:n.identity};return e})();t.default=w;t.resourceKey=m.createResolvedResourceKey(e("module").id,w)});
define("odsp-next/providers/itemActivity/ItemActivityAggregator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.process=function(e){for(var t=new Array,n=0;n<e.length;n++)this._addActivity(e[n],t);var r=t.length;if(!(0===r)){var i=t[r-1];if(1===i.type){var s=i;s.activities.length>1?this._sort(s.activities):this._downgrade(s.activities,t)}}return t};e._addActivity=function(e,t){var n=t.length,r=0===n,i=!1,s=null;if(!r&&(i=(s=t[n-1]).itemActivityChangeType!==e.itemActivityChangeType||s.date.toDateString()!==e.date.toDateString())&&1===s.type){var o=s;o.activities.length>1?this._sort(o.activities):this._downgrade(o.activities,t)}if(3!==e.itemActivityChangeType)t.push(e);else if(r||i){var u=this._create(e);t.push(u)}else this._update(s,e)};e._downgrade=function(e,t){if(1===e.length){t.pop();t.push(e[0])}};e._sort=function(e){e.sort(function(e,t){return e.date.getTime()<t.date.getTime()?1:e.date.getTime()>t.date.getTime()?-1:e.changeToken.localeCompare(t.changeToken)})};e._create=function(e){var t=new Array;e.editor.name&&t.push(e.editor);var n=new Array;n.push(e);return{activities:n,date:e.date,relativeTime:e.relativeTime,editors:t,itemActivityChangeType:e.itemActivityChangeType,type:1}};e._update=function(e,t){e.editors.some(function(e){var n=!0;for(var r in t.editor)n=n&&t.editor[r]===e[r];return n})||e.editors.push(t.editor);e.itemActivityChangeType=t.itemActivityChangeType;e.activities.push(t)};return e})();t.default=n});
define("odsp-next/bindings/toggle/ToggleBinding",["require","exports","knockout","../keyboard/KeyboardBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.init=function(e,t,i,s,o){var u=t(),a={Enter:function(e){u(!u());return!1}},f=new r.default({element:e,bindingContext:o,allBindingsAccessor:i,valueAccessor:function(){return a}});n.applyBindingsToNode(e,f,o);n.applyBindingsToNode(e,{click:function(){return u(!u())}},o)};return e})();t.default=i});
define("odsp-next/controls/infoPane/SectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.shouldStartExpanded,i=void 0===r||r;n._shouldStartExpanded=i;n.showArrow=!1;n.isExpanded=n._getIsExpanded();return n}t.prototype._getIsExpanded=function(){var e=this,t=this.createObservable(this._shouldStartExpanded);return this.createComputed({read:function(){return!e.showArrow||t()},write:function(n){e.showArrow&&t(n)},pure:!0})};return t})(r.default);t.default=i});
define("odsp-next/controls/itemActivityTile/ItemActivityTile",["require","exports","./ItemActivityTile.html","./ItemActivityTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-item-activity-tile",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemActivityTile/ItemActivityTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ItemActivityTile-section" data-bind="css:{\'is-expanded\':expanded},scrollIntoView:{isSelected:tile.focused||expanded}"><div class="od-ItemActivityTile-sectionHeader ms-font-s" role="treeitem" data-bind="attr:{\'aria-label\':accessibleLabel,\'aria-expanded\':expanded,tabindex:tile.index===0?0:-1},css:{\'od-ItemActivityTile-sectionToggle\':isAggregate,\'od-ItemActivityTile-sectionFocused\':tile.focused},hasFocus:tile.focused,toggle:expanded">\x3c!--ko if:isAggregate--\x3e<i class="od-ItemActivityTile-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<div class="od-ItemActivityTile-entity" data-bind="component:{name:\'od-persona\',params:{person:tile.editor,showName:false,personaSize:$component.personaSize,showPresence:false}},attr:{\'aria-hidden\':true}"></div><div class="od-ItemActivityTile-details"><span data-bind="bindableHtml:tile.headline" class="od-ItemActivityTile-headline"></span><span data-bind="text:tile.date" class="od-ItemActivityTile-date ms-fontColor-neutralSecondary"></span></div></div>\x3c!--ko if:isAggregate--\x3e<div data-bind="foreach:{data:activities,as:\'activity\'}" role="group"><div class="od-ItemActivityTile-sectionContent" data-bind="css:{\'od-ItemActivityTile-sectionFocused\':activity.focused}"><ms-item-activity-tile params="activity: activity"></ms-item-activity-tile></div></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/itemActivityTile/ItemActivityTileViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","./ItemActivityTile.resx","../../bindings/scrollIntoView/ScrollIntoViewBinding","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/toggle/ToggleBinding","@ms/odsp-shared/lib/utilities/knockout/Renderers","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:s.default,scrollIntoView:u.default,toggle:f.default});n._navigation=n.resources.consume(h.navigation);n._platform=n.resources.consume(p.platformDetection);n.tile=t.activity;n._initObservables();n.accessibleLabel=n.createComputed(n._computeAccessibleLabel);n.expanded=r.observable(!1);n.isAggregate=!1;if(1===n.tile.type){n.isAggregate=!0;var i=n.tile;n.activities=i.activities}return n}t.prototype.onClick=function(e,t){if(e.navigateToOptions){this._navigation.navigateTo(e.navigateToOptions);var n={url:e.navigateToOptions.url,qosEventName:"RecentActivityItemLink",timeout:this._platform.isMobile?7e3:3e3};this._validateLink(n)}};t.prototype._validateLink=function(e){try{var t=new c.Qos({name:"NavigationLinkValidation"}),n=new XMLHttpRequest;n.open("GET",e.url,!0);e.timeout&&(n.timeout=e.timeout);n.onload=function(r){if(n.status>=200&&n.status<400){e.onComplete&&e.onComplete(n.status);t.end({resultType:c.ResultTypeEnum.Success,extraData:{source:e.qosEventName,httpCode:n.status}})}else{e.onError&&e.onError(n.status);t.end({resultCode:"LinkDoesNotExist",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName,httpCode:n.status}})}};n.ontimeout=function(n){e.onTimeout&&e.onTimeout();t.end({resultCode:"ValidationTimedOut",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName}})};n.send()}catch(n){e.onFailValidation&&e.onFailValidation();t.end({resultCode:"FailedToValidate",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName}})}};t.prototype._initObservables=function(){var e=this;if(1===this.tile.type){var t=this.tile;this.addDisposable(t.expanded.subscribe(function(t){e.expanded(t)}))}};t.prototype._computeAccessibleLabel=function(){var e,t=l.renderText(this,this.tile.headline),n=o.default;0===this.tile.index?0===this.tile.type?e=n.FirstActivityAccessibleLabel:1===this.tile.type&&(e=n.FirstAggregateAccessibleLabel):e=1===this.tile.type?n.AggregateAccessibleLabel:n.ActivityAccessibleLabel;return a.format(e,t,this.tile.date)};return t})(i.default);t.default=d});
define("odsp-next/controls/detailsPane/section/legacy/LegacySection",["require","exports","tslib","react","../../../../bindings/component/ControlBinding","../../../knockout/Knockout","@ms/odsp-utilities/lib/scope/Scope","ODCDeferred_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new o.default;n._sectionParams={item:n.props.item,isScheduled:n.props.isScheduling,isHeaderHidden:n.props.isHeaderHidden};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&(this._sectionParams={item:e.item,isScheduled:e.isScheduling})};t.prototype.shouldComponentUpdate=function(e){return e.sectionControlKey!==this.props.sectionControlKey||e.resources!==this.props.resources||e.item!==this.props.item};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.props,t=e.sectionControlKey,n=e.resources,o=i.toSpecification(t,this._sectionParams);return r.createElement("div",{className:"od-DetailsPane-LegacySection"},r.createElement(s.default,{specification:o,resources:n}))};return t})(r.Component);t.default=u});
define("odsp-next/controls/detailsPane/section/itemExtractedText/ItemExtractedTextSection",["require","exports","tslib","react","../../../infoPane/sections/extractedText/ExtractedTextSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSection",["require","exports","./ExtractedTextSection.html","./ExtractedTextSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-extracted-text-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-extracted-text-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:isSectionVisible--\x3e<div class="InfoPane-section InfoPaneSection--extractedText" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:sectionHeader"></span></div><div class="InfoPane-sectionContent">\x3c!--ko if:currentExtractedEmail--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextEmailTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedEmail"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedUrl--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextUrlTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedUrl"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedPhone--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextPhoneTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedPhone"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedText--\x3e\x3c!--ko if:currentExtractedEmail()||currentExtractedUrl()||currentExtractedPhone()--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextTextTypeName"></div>\x3c!--/ko--\x3e<p class="InfoPane-extractedText-content" data-bind="text:extractedText"></p>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/infoPane/InfoPane.resx","../../../../bindings/toggle/ToggleBinding","../../../../providers/item/ItemProvider","../../../../models/item/EntityTagType","@ms/odsp-utilities/lib/logging/ErrorHelper","../../SectionHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({toggle:s.default});r.strings=i.default;var u=r.observables;r._itemProvider=r.resources.consume(o.resourceKey);r.sectionHelper=new(r.managed(f.default));r.extractedText=u.create("");r.extractedEmail=u.create("");r.extractedPhone=u.create("");r.extractedUrl=u.create("");r.currentExtractedText=u.create("");r.currentExtractedEmail=u.create("");r.currentExtractedPhone=u.create("");r.currentExtractedUrl=u.create("");r.sectionHeader=i.default.extractedTextHeader;r._item=t.item;u.compute(r._computeItemChanged);r.isSectionVisible=u.pureCompute(r._computeSectionVisible);return r}t.prototype._computeSectionVisible=function(){return!!(this.currentExtractedEmail()||this.currentExtractedPhone()||this.currentExtractedText()||this.currentExtractedUrl())};t.prototype._computeItemChanged=function(){var e=this,t=this._item();if(t){var n=t.ocr&&t.ocr.entityTags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=u.default[s.type];if(o===u.default.email){this.currentExtractedEmail(s.content);this.extractedEmail(s.content)}else if(o===u.default.url){this.currentExtractedUrl(s.content);this.extractedUrl(s.content)}else if(o===u.default.phone){this.currentExtractedPhone(s.content);this.extractedPhone(s.content)}}this._itemProvider.getItemOcrTextContent(t).then(function(t){e.currentExtractedText(t);e.extractedText(t)},function(e){a.default.log(e)})}};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=l});
define("odsp-next/models/item/EntityTagType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.email=0]="email";e[e.url=1]="url";e[e.phone=2]="phone";e[e.text=3]="text";e[e.other=4]="other"})(n||(n={}));t.default=n});
define("odsp-next/controls/detailsPane/section/caption/CaptionSection",["require","exports","tslib","react","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/TextField","../../../infoPane/InfoPane.resx","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../../../resources/ControlResourceKeys","office-ui-fabric-react/lib/Utilities","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._resources=t.resources;r._actionMap=r._resources.consume(a.actionMap);var s=(new i.default).attach(new u.default({owner:r}));r._text=s.create("");return r}t.prototype.render=function(){var e=this,t=this._text,n=this._item=this.props.item;this._updateCaptionAction=new(this._resources.injected(this._actionMap.UpdateCaptionAction))({caption:t,item:n});this._isEditable=this._updateCaptionAction.isAvailable();var i=n()&&n().caption||"";this._text(i);var o=this._getPlaceholderAndAriaLabel(),u=o.placeholder,a=o.ariaLabel;return r.createElement(s.TextField,{key:f.getId("caption"),className:"od-Caption-textField",underlined:!0,readOnly:!this._isEditable,placeholder:this._isEditable?u:"",defaultValue:this._text(),onBlur:function(t){return e._onBlur(t)},onKeyPress:this._onKeyPress,ariaLabel:a})};t.prototype._getPlaceholderAndAriaLabel=function(){var e=this._item();return e&&e.photo?{placeholder:o.default.captionAddCaption,ariaLabel:o.default.captionAriaLabel}:{placeholder:o.default.captionAddDescription,ariaLabel:o.default.descriptionAriaLabel}};t.prototype._onBlur=function(e){var t=this._item.peek(),n=e.target.value.trim();if(this._isEditable&&n!==t.caption){this._text(n);t.caption=n;this._updateCaptionAction.execute(null)}};t.prototype._onKeyPress=function(e){if("Enter"===e.key){e.target.blur()}};return t})(r.Component);t.default=l});
define("odsp-next/controls/detailsPane/section/itemInformation/ItemInformationSection",["require","exports","tslib","react","../../../infoPane/sections/information/react/InformationSectionWrapper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(i.InformationSectionWrapper,{item:t,resources:n})};return t})(r.Component);t.default=s});
define("odsp-next/controls/infoPane/sections/information/react/InformationSectionWrapper",["require","exports","tslib","react","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/base/BaseModel","../../../../../actions/ChangeFolderTypeAction","../../../../../models/item/ItemParentHelper","../../../../../providers/fileHandler/FileHandlerProvider","../../../../../resources/DataSourceResourceKeys","./InformationSection"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new s.default;n._itemParentHelper=t.resources.consume(a.resourceKey);var r=t.resources.consume(o.observablesFactoryTypeResourceKey);n._observables=n._scope.attach(new r({owner:n}));n.state={item:t.item.peek(),resources:t.resources,isCustomList:n._computeIsCustomList(),isChangeFolderTypeActionAvailable:!1};n._changeFolderTypeAction=new(n._managed(u.default))({});return n}t.prototype.componentDidMount=function(){var e=this;this._itemStateObservableSubscriber=this._observables.subscribe(this.props.item,function(t){e._setItemState(t)})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this;if(e.item!==this.props.item){this._itemStateObservableSubscriber.dispose();this._itemStateObservableSubscriber=this._observables.subscribe(e.item,function(e){t._setItemState(e)});this.setState({item:e.item.peek()})}};t.prototype.render=function(){var e=this.state.item.extension,t=this.state.resources.consume(l.url),s={item:this.state.item,isCustomList:this.state.isCustomList,isChangeFolderTypeActionAvailable:this.state.isChangeFolderTypeActionAvailable,isRecycleBin:this.state.resources.consume(l.url).isRecycleBin(this.state.item.queryType),isAnonymousUser:this.state.resources.consume(l.identity).getIdentity().type===i.IdentityType.anonymous,fileHandlerProviderFileTypeName:this.state.resources.consume(f.resourceKey.local).getFileTypeName(e),pathCopyValue:t.getCanonicalUrl?t.getCanonicalUrl(this.state.item.key):null};return r.createElement(c.default,n.__assign({},s))};t.prototype._setItemState=function(e){this.setState({item:e,isCustomList:this._computeIsCustomList(),isChangeFolderTypeActionAvailable:this._changeFolderTypeAction.isAvailable()})};t.prototype._computeIsCustomList=function(){var e=this._observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(this.props.item(),"list"));return!!e&&!e.list.isDocumentLibrary};t.prototype._managed=function(e){this.state.resources&&(e=this.state.resources.injected(e));return this._scope.attached(e)};return t})(r.PureComponent);t.InformationSectionWrapper=h});
define("odsp-next/controls/infoPane/sections/information/react/InformationSection",["require","exports","tslib","react","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/string/TimeFormatter","../../../../../controls/infoPane/InfoPane.resx","../../../../../dataSources/url/QueryType","../../../../../dataSources/url/SearchTypeChecker","../../../../../models/item/FolderCategory","../../../../../models/item/ItemType","../../../../../models/item/ItemHelper","./entries/Basic","./entries/Iterable","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:"od-InfoPane-ReactSections"},r.createElement("div",{className:"InfoPane-section is-expanded InfoPaneSection--information"},r.createElement("div",{className:"InfoPane-sectionHeader"},r.createElement("i",{className:"InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown"}),r.createElement("h2",{className:"InfoPane-sectionHeaderText"})),r.createElement("div",{className:"InfoPane-sectionContent"},r.createElement("dl",{className:"InfoPaneSection-informationBody"},this._createMap()))))};t.prototype._createMap=function(){return this.props.allEntries.map(function(e,t){return"string"==typeof e.value?r.createElement(d.default,{key:t,title:e.title,value:e.value,copyButtonProps:e.copyButtonProps,condition:e.condition,className:e.className}):r.createElement(v.default,{key:t,title:e.title,value:e.value,copyButtonProps:e.copyButtonProps,condition:e.condition,className:e.className})})};return t})(r.PureComponent);t.InformationSectionRender=m;var g=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(m,{allEntries:this._computeAllEntries()})};t.prototype._computeAllEntries=function(){var e=this.props.isAnonymousUser?"":this._computePath(),t=[{title:a.default.informationFiletype,value:this._computeFileType()},{title:a.default.informationFolderType,value:this._computeFolderType(),condition:this._computeIsFolderTypeVisible(),className:"InfoPaneSection-information-folderType"},{title:a.default.informationVisitorViews,value:this._computeVisitorViews()},{title:a.default.informationDateTaken,value:this._computeDateTaken()},{title:a.default.informationDimensions,value:this._computeDimensions()},{title:a.default.informationDuration,value:this._computeDuration()},{title:a.default.informationBitrate,value:this._computeBitRate()},{title:a.default.informationCamera,value:this._computeCamera()},{title:a.default.informationShot,value:this._computeShot()},{title:a.default.informationTitle,value:this._computeTitle()},{title:a.default.informationAlbum,value:this._computeAlbum()},{title:a.default.informationAlbumArtist,value:this._computeAlbumArtist()},{title:a.default.informationArtist,value:this._computeArtist()},{title:a.default.informationTrack,value:this._computeTrack()},{title:a.default.informationDisc,value:this._computeDisc()},{title:a.default.informationComposers,value:this._computeComposers()},{title:a.default.informationGenre,value:this._computeGenre()},{title:a.default.informationYear,value:this._computeYear()},{title:a.default.informationCopyright,value:this._computeCopyright()},{title:a.default.informationLocations,value:this._computeLocations()},{title:a.default.informationModified,value:this._computeModified()},{title:a.default.informationDeleted,value:this._computeDeleted()},{title:a.default.informationAddedBy,value:this._computeAddedBy()},{title:a.default.informationDateCreated,value:this._computeCreated()},{title:a.default.informationDateShared,value:this._computeDateShared()},{title:a.default.informationPath,value:e,copyButtonProps:{value:this.props.pathCopyValue,tooltip:a.default.pathCopyButtonText,successTooltip:a.default.pathCopyButtonSuccessTooltip,ariaLabel:a.default.pathCopyButtonText},className:"InfoPaneSection-information-path"},{title:a.default.informationOriginalLocation,value:this._computeOriginalLocation()},{title:a.default.informationSize,value:this._computeSize()},{title:a.default.informationPanoramaResolution,value:this._computePanoramaResolution()},{title:a.default.informationPanoramaRange,value:this._computePanoramaRange()}];return this._filterEntry(t)};t.prototype._filterEntry=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];("condition"in i?i.condition:i.value&&i.value.length>0)&&t.push(i)}return t};t.prototype._computeTitle=function(){var e=this.props.item.audio;return e&&e.title};t.prototype._computeAlbum=function(){var e=this.props.item.audio;return e&&(e.album||a.default.informationUnknownAlbum)};t.prototype._computeAlbumArtist=function(){var e=this.props.item.audio;return e&&e.albumArtist};t.prototype._computeArtist=function(){var e=this.props.item.audio;return e&&(e.artist||a.default.informationUnknownArtist)};t.prototype._computeTrack=function(){var e=this.props.item.audio,t=e&&e.track,n=e&&e.trackCount;return t?n?o.format(a.default.informationTrackAndDiscFormat,t,n):""+t:""};t.prototype._computeDisc=function(){var e=this.props.item.audio,t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?o.format(a.default.informationTrackAndDiscFormat,t,n):t&&""+t};t.prototype._computeComposers=function(){var e=this.props.item.audio;return e&&e.composers};t.prototype._computeGenre=function(){var e=this.props.item.audio;return e&&e.genre};t.prototype._computeYear=function(){var e=this.props.item.audio;return e&&e.year&&""+e.year};t.prototype._computeCopyright=function(){var e=this.props.item.audio;return e&&e.copyright};t.prototype._computeFileType=function(){var e=this.props.item;if(!e.isBundle&&void 0===e.virtualItemType){var t=e.extension&&this.props.fileHandlerProviderFileTypeName;return p.getFriendlyItemType(e,this.props.isCustomList,t)}};t.prototype._computeIsFolderTypeVisible=function(){var e=this.props.item;return e.type===h.default.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this.props.isChangeFolderTypeActionAvailable};t.prototype._computeDateTaken=function(){var e=this.props.item,t=(e.photo||e.video)&&e;return t?t.dateTakenTime?i.getFullDisplayDate(t.dateTakenTime,!0):t.dateTaken:""};t.prototype._computeFolderType=function(){switch(this.props.item.category){case c.default.documents:return a.default.informationFolderTypeDocuments;case c.default.photos:return a.default.informationFolderTypePhotos;case c.default.favorites:return a.default.informationFolderTypeFavorites}return""};t.prototype._computeVisitorViews=function(){var e=this.props.item.statistics.views;return e&&""+e};t.prototype._computeDimensions=function(){var e=this.props.item,t=e.video||!e.panorama&&e.photo||{},n=t.width,r=t.height;return n&&r?o.format(a.default.informationDimensionsFormat,n,r):""};t.prototype._computeDuration=function(){var e=this.props.item.video,t=e&&e.duration;return t>0?u.formatTime(t):""};t.prototype._computeBitRate=function(){var e=this.props.item.video,t=e&&e.bitrate;if(t){var n=t>1e6?"Mega":"Kilo",r=t>1e6?1e6:1e3;return o.format(a.default["information"+n+"BitrateFormat"],Math.floor(t/r))}};t.prototype._computeCamera=function(){var e=this.props.item,t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel};t.prototype._computeShot=function(){var e=this.props.item.photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,r=t&&""+t;n&&1!==n&&(r=o.format(a.default.informationShotExposureFormat,t,n));var i=e.focalRatio?""+e.focalRatio:"";i=i&&o.format(a.default.informationShotFStopFormat,i);var s=e.focalLength?""+e.focalLength:"";return[r,i,s=s&&o.format(a.default.informationShotFocalLengthFormat,s)].join(" ").trim()}};t.prototype._computeLocations=function(){var e=this.props.item.locations;if(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i&&t.push(i)}return t}};t.prototype._computeModified=function(){var e=this.props.item,t=e.dateModified&&e.dateModified.trim().length>0;if(!this.props.isRecycleBin&&t)return e.dateModifiedTime?i.getFullDisplayDate(e.dateModifiedTime):e.dateModified};t.prototype._computeDeleted=function(){var e=this.props.item;if(this.props.isRecycleBin)return e.dateDeletedTime?i.getFullDisplayDate(e.dateDeletedTime):e.dateDeleted};t.prototype._computeAddedBy=function(){return this.props.item.creatorName};t.prototype._computeCreated=function(){var e=this.props.item;return e.dateCreatedTime?i.getFullDisplayDate(e.dateCreatedTime):e.dateCreated};t.prototype._computeDateShared=function(){var e=this.props.item;return e.dateSharedTime?i.getFullDisplayDate(e.dateSharedTime):e.dateShared};t.prototype._computePath=function(){var e=this.props.item;if(e.parent&&!this.props.isRecycleBin){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeOriginalLocation=function(){var e=this.props.item;if(this.props.isRecycleBin||l.isSearchType(e.queryType)||e.queryType===f.default.SharedWithMe)return e.location};t.prototype._computeSize=function(){var e=this.props.item;return e.size&&s.default.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._computePanoramaResolution=function(){var e=this.props.item.panorama,t=e&&e.resolution;if(t)return o.format(a.default.informationPanoramaResolutionFormat,t)};t.prototype._computePanoramaRange=function(){var e=this.props.item.panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return o.format(a.default.informationPanoramaRangeFormat,Math.round(t),Math.round(n))};return t})(r.Component);t.default=g});
define("odsp-next/controls/infoPane/sections/information/react/entries/Basic",["require","exports","tslib","react","./EntryTitle"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.title,n=e.value,s=e.copyButtonProps,o=e.className;return r.createElement(r.Fragment,null,r.createElement(i.EntryTitle,{title:t,copyButtonProps:s}),r.createElement("dd",{className:o},n))};return t})(r.PureComponent);t.InformationSectionBasicEntry=s;t.default=s});
define("odsp-next/controls/infoPane/sections/information/react/entries/EntryTitle",["require","exports","tslib","react","react","@ms/odsp-utilities/lib/async/Async","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Tooltip","../../../../../../utilities/clipboard/CopyHelper","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.value,n=e.tooltip,l=e.successTooltip,c=e.ariaLabel,h=i.useState(!1),p=h[0],d=h[1],v=i.useRef(),m=i.useRef(null),g=i.useRef(new s.default);return r.createElement(a.TooltipHost,{content:p?l:n,id:u.getId("copyButtonTooltipHost"),styles:{root:{display:"inline-block"}},directionalHint:a.DirectionalHint.bottomAutoEdge},r.createElement(o.IconButton,{componentRef:m,className:"InfoPaneSection-copyButton",onClick:function(){var e;f.copyToClipboard(t);null===(e=m.current)||void 0===e||e.focus();d(!0);v.current&&g.current.clearTimeout(v.current);v.current=g.current.setTimeout(function(){return d(!1)},3e3)},iconProps:{iconName:p?"CheckMark":"Copy"},"aria-label":c}))};t.EntryTitle=function(e){var t=e.title,i=e.copyButtonProps;return r.createElement("div",{className:"InfoPaneSection-entryTile"},r.createElement("dt",null,t),i?r.createElement(l,n.__assign({},i)):null)}});
define("odsp-next/utilities/clipboard/CopyHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToClipboard=function(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}});
define("odsp-next/controls/infoPane/sections/information/react/entries/Iterable",["require","exports","tslib","react","./EntryTitle"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.title,n=e.copyButtonProps;return r.createElement(r.Fragment,null,r.createElement(i.EntryTitle,{title:t,copyButtonProps:n}),r.createElement("dd",null,this._createMap()))};t.prototype._createMap=function(){var e=this;return this.props.value.map(function(t,n){return r.createElement("div",{key:n,className:e.props.className},t)})};return t})(r.PureComponent);t.InformationSectionIterableEntry=s;t.default=s});
define("odsp-next/controls/detailsPane/section/information/InformationSection",["require","exports","tslib","react","../../../infoPane/sections/information/InformationSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources,o=e.isHeaderHidden;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n,isHeaderHidden:o})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/information/InformationSection",["require","exports","./entries/Basic.html","./entries/Editable.html","./entries/Iterable.html","./InformationSection.html","./InformationSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.registerComponent({tagName:"ms-information-info-pane-section",template:s.default,viewModel:o.default,synchronous:!0});t.resourceKey=a.createResolvedControlDefinitionResourceKey({automationName:"ms-information-info-pane-section",name:e("module").id,template:s.default,viewModelType:o.default});u.registerTemplate("ms-information-basicentry",n.default);u.registerTemplate("ms-information-editableentry",r.default);u.registerTemplate("ms-information-iterableentry",i.default);t.default=f});
define("odsp-next/controls/infoPane/sections/information/entries/Basic.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<dt data-bind="text:title"></dt><dd data-bind="class:$data.className,text:value"></dd>'});
define("odsp-next/controls/infoPane/sections/information/entries/Editable.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<dt data-bind="text:title"></dt><dd><div data-bind="class:$data.className,text:value"></div><a href="javascript:;" data-bind="class:$data.editClassName,click:onEdit,text:editText"></a></dd>'});
define("odsp-next/controls/infoPane/sections/information/entries/Iterable.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<dt data-bind="text:title"></dt><dd data-bind="foreach:{data:value}"><div data-bind="class:$parent.className,text:$data"></div></dd>'});
define("odsp-next/controls/infoPane/sections/information/InformationSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--information" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}">\x3c!--ko if:!isHeaderHidden--\x3e<div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText" data-bind="text:informationHeader"></h2></div>\x3c!--/ko--\x3e<div class="InfoPane-sectionContent"><dl class="InfoPaneSection-informationBody" data-bind="template:{name:getEntryType,foreach:entries}"></dl></div></div>'});
define("odsp-next/controls/infoPane/sections/information/InformationSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../bindings/toggle/ToggleBinding","../../../../controls/infoPane/InfoPane.resx","../../../../actions/ChangeFolderTypeAction","../../../../models/item/ItemParentHelper","../../../../models/item/ItemType","../../../../models/item/FolderCategory","@ms/odsp-utilities/lib/string/StringHelper","../../../../dataSources/url/QueryType","../../../../dataSources/url/SearchTypeChecker","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/string/TimeFormatter","../../../../models/item/ItemHelper","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-datasources/lib/Permissions","../../../../resources/DataSourceResourceKeys","../../SectionHelper","../../../../providers/fileHandler/FileHandlerProvider","../../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function S(e){var t=e.condition,n=e.value;return t?t():n()&&n().length>0}var x=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,a=r._changeFolderTypeAction=new(r.managed(o.default))({}),f=r.resources;r._urlDataSource=f.consume(y.url);r._itemParentHelper=f.consume(u.resourceKey);r._fileHandlerProvider=f.consume(w.resourceKey.local);r._item=t.item;var l=r.observables;r._isCustomList=l.pureCompute(r._computeIsCustomList);r.strings=s.default;r.isHeaderHidden=!!t.isHeaderHidden;E.isFeatureEnabled(E.EnableNewDetailsPane)?r.informationHeader=r.strings.generalInformationHeader:r.informationHeader=r.strings.informationHeader;r.sectionHelper=new(r.managed(b.default));r.addBindingHandlers({toggle:i.default});r._audio=l.pureCompute(r._computeAudio);var c=f.consume(y.identity).getIdentity().type===g.IdentityType.anonymous?l.create():l.pureCompute(r._computePath),h=l.createArray([{title:s.default.informationFiletype,value:l.pureCompute(r._computeFileType)},{title:s.default.informationFolderType,condition:l.pureCompute(r._computeIsFolderTypeVisible),value:l.pureCompute(r._computeFolderType),className:"InfoPaneSection-information-folderType",editClassName:"InfoPaneSection-information-changeFolderType",onEdit:function(e){a.execute(e);return!1},editText:s.default.informationFolderTypeChange},{title:s.default.informationVisitorViews,value:l.pureCompute(r._computeVisitorViews)},{title:s.default.informationDateTaken,value:l.pureCompute(r._computeDateTaken)},{title:s.default.informationDimensions,value:l.pureCompute(r._computeDimensions)},{title:s.default.informationDuration,value:l.pureCompute(r._computeDuration)},{title:s.default.informationBitrate,value:l.pureCompute(r._computeBitRate)},{title:s.default.informationCamera,value:l.pureCompute(r._computeCamera)},{title:s.default.informationShot,value:l.pureCompute(r._computeShot)},{title:s.default.informationTitle,value:l.pureCompute(r._computeTitle)},{title:s.default.informationAlbum,value:l.pureCompute(r._computeAlbum)},{title:s.default.informationAlbumArtist,value:l.pureCompute(r._computeAlbumArtist)},{title:s.default.informationArtist,value:l.pureCompute(r._computeArtist)},{title:s.default.informationTrack,value:l.pureCompute(r._computeTrack)},{title:s.default.informationDisc,value:l.pureCompute(r._computeDisc)},{title:s.default.informationComposers,value:l.pureCompute(r._computeComposers)},{title:s.default.informationGenre,value:l.pureCompute(r._computeGenre)},{title:s.default.informationYear,value:l.pureCompute(r._computeYear)},{title:s.default.informationCopyright,value:l.pureCompute(r._computeCopyright)},{title:s.default.informationLocations,value:l.pureCompute(r._computeLocations)},{title:s.default.informationModified,value:l.pureCompute(r._computeModified)},{title:s.default.informationDeleted,value:l.pureCompute(r._computeDeleted)},{title:s.default.informationAddedBy,value:l.pureCompute(r._computeAddedBy)},{title:s.default.informationDateCreated,value:l.pureCompute(r._computeCreated)},{title:s.default.informationDateShared,value:l.pureCompute(r._computeDateShared)},{title:s.default.informationPath,value:c,className:"InfoPaneSection-information-path"},{title:s.default.informationOriginalLocation,value:l.pureCompute(r._computeOriginalLocation)},{title:s.default.informationSize,value:l.pureCompute(r._computeSize)},{title:s.default.informationPanoramaResolution,value:l.pureCompute(r._computePanoramaResolution)},{title:s.default.informationPanoramaRange,value:l.pureCompute(r._computePanoramaRange)}]);r.entries=r.addDisposable(h.filter(S));return r}t.prototype.getEntryType=function(e){return e.editText?"ms-information-editableentry":Array.isArray(e.value())?"ms-information-iterableentry":"ms-information-basicentry"};t.prototype._computeAudio=function(){return this._item().audio};t.prototype._computeTitle=function(){var e=this._audio();return e&&e.title};t.prototype._computeAlbum=function(){var e=this._audio();return e&&(e.album||s.default.informationUnknownAlbum)};t.prototype._computeAlbumArtist=function(){var e=this._audio();return e&&e.albumArtist};t.prototype._computeArtist=function(){var e=this._audio();return e&&(e.artist||s.default.informationUnknownArtist)};t.prototype._computeTrack=function(){var e=this._audio(),t=e&&e.track,n=e&&e.trackCount;return t?n?l.format(s.default.informationTrackAndDiscFormat,t,n):""+t:""};t.prototype._computeDisc=function(){var e=this._audio(),t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?l.format(s.default.informationTrackAndDiscFormat,t,n):t&&""+t};t.prototype._computeComposers=function(){var e=this._audio();return e&&e.composers};t.prototype._computeGenre=function(){var e=this._audio();return e&&e.genre};t.prototype._computeYear=function(){var e=this._audio();return e&&e.year&&""+e.year};t.prototype._computeCopyright=function(){var e=this._audio();return e&&e.copyright};t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType){var t=this._fileHandlerProvider,n=e.extension,r=t&&n&&t.getFileTypeName(n);return v.getFriendlyItemType(e,this._isCustomList(),r)}};t.prototype._computeIsFolderTypeVisible=function(){var e=this._item();return e.type===a.default.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this._changeFolderTypeAction.isAvailable()};t.prototype._computeDateTaken=function(){var e=this._item(),t=(e.photo||e.video)&&e;return t?t.dateTakenTime?m.getFullDisplayDate(t.dateTakenTime,!0):t.dateTaken:""};t.prototype._computeFolderType=function(){switch(this._item().category){case f.default.documents:return s.default.informationFolderTypeDocuments;case f.default.photos:return s.default.informationFolderTypePhotos;case f.default.favorites:return s.default.informationFolderTypeFavorites}return""};t.prototype._computeVisitorViews=function(){var e=this._item().statistics.views;return e&&""+e};t.prototype._computeDimensions=function(){var e=this._item(),t=e.video||!e.panorama&&e.photo||{},n=t.width,r=t.height;return n&&r?l.format(s.default.informationDimensionsFormat,n,r):""};t.prototype._computeDuration=function(){var e=this._item().video,t=e&&e.duration;return t>0?d.formatTime(t):""};t.prototype._computeBitRate=function(){var e=this._item().video,t=e&&e.bitrate;if(t){var n=t>1e6?"Mega":"Kilo",r=t>1e6?1e6:1e3;return l.format(s.default["information"+n+"BitrateFormat"],Math.floor(t/r))}};t.prototype._computeCamera=function(){var e=this._item(),t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel};t.prototype._computeShot=function(){var e=this._item().photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,r=t&&""+t;n&&1!==n&&(r=l.format(s.default.informationShotExposureFormat,t,n));var i=e.focalRatio?""+e.focalRatio:"";i=i&&l.format(s.default.informationShotFStopFormat,i);var o=e.focalLength?""+e.focalLength:"";return[r,i,o=o&&l.format(s.default.informationShotFocalLengthFormat,o)].join(" ").trim()}};t.prototype._computeLocations=function(){var e=this._item().locations;if(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i&&t.push(i)}return t}};t.prototype._computeModified=function(){var e=this._item(),t=e.dateModified&&e.dateModified.trim().length>0;if(!this._urlDataSource.isRecycleBin(e.queryType)&&t)return e.dateModifiedTime?m.getFullDisplayDate(e.dateModifiedTime):e.dateModified};t.prototype._computeDeleted=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType))return e.dateDeletedTime?m.getFullDisplayDate(e.dateDeletedTime):e.dateDeleted};t.prototype._computeAddedBy=function(){return this._item().creatorName};t.prototype._computeCreated=function(){var e=this._item();return e.dateCreatedTime?m.getFullDisplayDate(e.dateCreatedTime):e.dateCreated};t.prototype._computeDateShared=function(){var e=this._item();return e.dateSharedTime?m.getFullDisplayDate(e.dateSharedTime):e.dateShared};t.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeOriginalLocation=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType)||h.isSearchType(e.queryType)||e.queryType===c.default.SharedWithMe)return e.location};t.prototype._computeSize=function(){var e=this._item();return e.size&&p.default.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._computePanoramaResolution=function(){var e=this._item().panorama,t=e&&e.resolution;if(t)return l.format(s.default.informationPanoramaResolutionFormat,t)};t.prototype._computePanoramaRange=function(){var e=this._item().panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return l.format(s.default.informationPanoramaRangeFormat,Math.round(t),Math.round(n))};t.prototype._computeIsCustomList=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item(),"list"));return!!e&&!e.list.isDocumentLibrary};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=x});
define("odsp-next/controls/detailsPane/section/tags/TagsSection",["require","exports","tslib","react","../../../infoPane/sections/tags/TagsSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/tags/TagsSection",["require","exports","./TagsSection.html","./TagsSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css","../../../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-tags-info-pane-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-tags-info-pane-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/tags/TagsSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--tags" data-bind="visible:isSectionVisible,css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-tagSectionHeaderText" data-bind="text:sectionHeader"></h2>\x3c!--ko if:isNewDetailsPane&&showTagsEditorAction.isAvailable()&&tags().length!==0--\x3e<a class="InfoPane-tag-manageTagButton" href="#" data-bind="automation:\'manageTagLink\',text:$component.manageTagLinkLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e</div>\x3c!--ko if:isNewDetailsPane--\x3e<div class="od-TaggingSection-screenReaderOnly" aria-live="assertive" role="status" data-bind="attr:{\'aria-label\':liveUpdateAnnouncement}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isNewDetailsPane&&tags().length===0--\x3e<div class="od-TaggingSection-addTagIcon"><i class="ms-Icon ms-Icon--Tag" data-bind="icon:true"></i></div><a class="od-TaggingSection-addTagIconButton" href="#" data-bind="automation:\'addTagIconLabel\',text:$component.addTagIconLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e\x3c!--ko if:isNewDetailsPane--\x3e<div class="InfoPane-tags" data-bind="foreach:tags"><div class="InfoPane-tag"><button class="InfoPane-tagLink newTagStyling" data-bind="click:navigateAction.execute.bind(navigateAction),attr:{title:tooltip,\'aria-label\':tagLabel},css:{\'ms-font-s\':!$parent.isFluentEnabled,\'ms-font-m\':$parent.isFluentEnabled}"><div class="InfoPane-tagName" data-bind="text:name"></div></button>\x3c!--ko if:removeAction.isAvailable()&&!isDeleting()--\x3e<button class="InfoPane-removeTag newTagStyling ms-font-s" data-bind="click:removeAction.execute.bind(removeAction),attr:{\'aria-label\':deleteTagLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e\x3c!--ko if:isDeleting--\x3e<span class="InfoPane-removeTag ms-font-s" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!isNewDetailsPane--\x3e<div class="InfoPane-tags" data-bind="foreach:tags"><div class="InfoPane-tag-old"><a class="InfoPane-tagLink ms-font-m" data-bind="click:navigateAction.execute.bind(navigateAction),attr:{title:tooltip}"><div class="InfoPane-tagName" data-bind="text:name"></div></a>\x3c!--ko if:removeAction.isAvailable()&&!isDeleting()--\x3e<a href="#" class="InfoPane-removeTag ms-font-m" data-bind="click:removeAction.execute.bind(removeAction)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></a>\x3c!--/ko--\x3e\x3c!--ko if:isDeleting--\x3e<span class="InfoPane-removeTag ms-font-m" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:!isNewDetailsPane&&addAction.isAvailable--\x3e<a class="InfoPane-tag-addTag" href="#" data-bind="automation:\'addTagLink\',text:$component.addTagLinkLabel,click:addAction.execute.bind(addAction)"></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/infoPane/sections/tags/TagsSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../bindings/toggle/ToggleBinding","../../../tagEditor/TagEditor.resx","../../../../models/tag/TagSourceOptions","../../../../resources/ControlResourceKeys","../../../../providers/engagement/Engagement","./TagViewModel","../../SectionHelper","../../../loadingSpinner/LoadingSpinner","../../../../utilities/features/Features","../../../../controls/fluentStyling/FluentStyling.key","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.loadingSpinnerTagName=c.default.tagName;var o=r.resources.consume(u.actionMap);r._engagement=r.resources.consume(a.resourceKey);r.addBindingHandlers({toggle:i.default});r._item=t.item;r.sectionHelper=new(r.managed(l.default));r._initializeTags();r.isNewDetailsPane=h.isFeatureEnabled(h.EnableNewDetailsPane);r.isNewDetailsPane?r.showTagsEditorAction=new(r.managed(o.ShowTagsEditorAction)):r.addAction=new(r.managed(o.EditTagsAction));r.addTagIconLabel=s.default.addTags;r.addTagLinkLabel=s.default.editTags;r.manageTagLinkLabel=s.default.editTags;r.addTagIconLabel=s.default.addTags;r.sectionHeader=s.default.sectionHeader;r.isFluentEnabled=r.resources.consume(p.resourceKey);return r}t.prototype.launchTagEditor=function(e,t){this.showTagsEditorAction.execute(t);this._engagement.logData({name:"TagsSection.LaunchTagEditor",isIntentional:!0})};t.prototype._initializeTags=function(){var e=this,t=this.observables,n=t.createArray();t.compute(function(){n(e._item().tags||[])});var r=this.addDisposable(n.filter(function(e){var t=o.default[e.source];return t!==o.default.LocationAndEventsAPI&&t!==o.default.SystemDefined})),i=this.getTagsSet(r());this.liveUpdateAnnouncement=this.addDisposable(t.compute(function(){var t=e.getTagsSet(r()),n=e.getSetAMinusSetB(i,t),o=e.getSetAMinusSetB(t,i),u="";o.size>0&&n.size>0?u=d.format(s.default.tagsUpdateAnnouncement,e.getStringFormTagsSet(o),e.getStringFormTagsSet(n)):o.size>0?u=d.format(s.default.tagsAddedAnnouncement,e.getStringFormTagsSet(o)):n.size>0&&(u=d.format(s.default.tagsRemovedAnnouncement,e.getStringFormTagsSet(n)));i=t;return u}));this.isSectionVisible=t.pureCompute(function(){return e.isNewDetailsPane?r().length>0||e.showTagsEditorAction.isAvailable():r().length>0||e.addAction.isAvailable()});this.tags=this.addDisposable(r.map({mappingWithDisposeCallback:function(t){var n=new(e.resources.injected(f.default))({tag:t});return{mappedValue:n,dispose:function(){return n.dispose()}}}}))};t.prototype.getTagsSet=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n];t.add("#"+(i.localizedTag||i.tag))}return t};t.prototype.getSetAMinusSetB=function(e,t){for(var n=new Set(e),r=0,i=Array.from(t);r<i.length;r++){var s=i[r];n.delete(s)}return n};t.prototype.getStringFormTagsSet=function(e){for(var t="",n=0,r=Array.from(e);n<r.length;n++){t=t+" "+r[n]}t.trim();t.replace(" #",", #");return t};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=v});
define("odsp-next/controls/infoPane/sections/tags/TagViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../resources/ControlResourceKeys","../../../../resources/DataSourceResourceKeys","knockout","../../../../controls/tagEditor/TagEditor.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._tag=t.tag;n.name="#"+(n._tag.localizedTag||n._tag.tag);n.tagLabel=n.name+" "+u.default.tagAriaLabel;n.deleteTagLabel=u.default.deleteTagAriaLabel;var r=n.resources.consume(i.actionMap),a=n.resources.consume(s.url);n.removeAction=new(n.managed(r.RemoveTagAction))({tag:o.observable(n._tag)});n.navigateAction=new(n.managed(r.NavigationAction))({url:a.getTagUrl(n._tag),target:"_blank"});n.isDeleting=o.observable(!1);n.name.length>20?n.tooltip=n.name:n.tooltip=null;n.createComputed(function(){n.removeAction.isExecuting()&&n.isDeleting(!0)});return n}return t})(r.default);t.default=a});
define("odsp-next/controls/detailsPane/section/location/LocationSection",["require","exports","tslib","react","../../../infoPane/sections/location/LocationSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/location/LocationSection",["require","exports","./LocationSection.html","./LocationSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-location-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-location-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/location/LocationSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--location" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-locationSectionHeaderText" data-bind="text:sectionHeader"></h2></div><div class="InfoPane-sectionContent"><div class="InfoPane-location"><div class="InfoPane-location-area"><div data-bind="bingMap:bingMapOptions"></div><div class="InfoPane-location-text" data-bind="text:location"></div></div></div></div></div>'});
define("odsp-next/controls/infoPane/sections/location/LocationSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/infoPane/InfoPane.resx","../../../../bindings/toggle/ToggleBinding","../../../../bindings/bingMap/BingMapBinding","../../../../dataSources/bing/BingDataSource","../../SectionHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({toggle:s.default,bingMap:o.default});var f=r.observables;r._bingDataSource=new(r.managed(u.default));r.sectionHelper=new(r.managed(a.default));r.location=f.create("");r.bingMapOptions={latitude:f.create(0),longitude:f.create(0)};r.sectionHeader=i.default.locationInfoPaneHeader;r._item=t.item;f.compute(r._computeItemChanged);return r}t.prototype._computeItemChanged=function(){var e=this,t=this._item().geoLocation;if(t){var n=t.latitude,r=t.longitude;this._bingDataSource.getLocationName(n,r).then(function(t){e.location(t)});var i=this.bingMapOptions;i.latitude(n);i.longitude(r)}};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=f});
define("odsp-next/bindings/bingMap/BingMapBinding",["require","exports","knockout","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/logging/ErrorHelper","../../controls/infoPane/InfoPane.resx","office-ui-fabric-react/lib/Styling","ODCDeferred_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}e.init=function(t,i){var o=this,u=n.utils.unwrapObservable(i())||{},a=new r.default(this),f=0,l=6,c=!1,h=function(){if(!c)if(Microsoft.Maps.Location){var r=u.height||140,i=u.width||213,p={credentials:"AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa",enableSearchLogo:!1,enableClickableLogo:!1,showDashboard:!1,showScalebar:!1,showMapTypeSelector:!1,center:new Microsoft.Maps.Location(u.latitude(),u.longitude()),disableKeyboardInput:!0,zoom:10,height:r,width:i},d=document.createElement("div");d.style.height=r+"px";d.style.width=i+"px";t.appendChild(d);var v=new Microsoft.Maps.Map(d,p);e._addMapControls(t,v,u);n.computed(function(){u.latitude();u.longitude();e._updateMap.call(o,v,u)},null,{disposeWhenNodeIsRemoved:t})}else if(l>0){l--;f+=500;a.setTimeout(h,f)}else t.innerHTML=s.default.locationMapFailedLoadLocationText};window.require(["bingmapsv8"],h.bind(this));n.utils.domNodeDisposal.addDisposeCallback(t,function(){c=!0;a.dispose()})};e._addMapControls=function(t,n,r){var i=function(e){var t=n.getZoom()+e;n&&n.setView({zoom:t})},s=document.createElement("div");s.className="BingMap-controls";s.appendChild(e._getIcon("Remove",!0,function(e){i(-1);return!1}.bind(this)));s.appendChild(e._getIcon("Add",!0,function(e){i(1);return!1}.bind(this)));s.appendChild(e._getIcon("StackIndicator",!1,function(e){var t="http://www.bing.com/maps/?v=2&where1="+r.latitude()+", "+r.longitude();window.open(t,"_blank");return!1}.bind(this)));t.appendChild(s)};e._getIcon=function(e,t,n){var r=document.createElement("div");r.className="BingMap-controls-icon";r.onclick=n;var i=document.createElement("i");i.className=o.getIconClassName(e)+(t?" "+o.getIconClassName("Circle"):"");r.appendChild(i);return r};e._updateMap=function(e,t){try{var n=t.latitude(),r=t.longitude(),s=new Microsoft.Maps.Location(n,r);e.setView({center:s});e.entities.clear();var o=new Microsoft.Maps.Pushpin(s,null);e.entities.push(o)}catch(e){i.default.log(e)}};return e})();t.default=u});
define("odsp-next/dataSources/bing/BingDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/jsonp/JSONP","../../controls/infoPane/InfoPane.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={},u=(function(){function e(){}e.prototype.getLocationName=function(e,t){var u=o[e+","+t]||"";if(u)return n.default.wrap(u);var a="https://dev.virtualearth.net/REST/v1/Locations/"+e+","+t+"?entityType=adminDistrict&c="+(window.$Config&&$Config.mkt||"en-us")+"&key=AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa";return i.default.fetch(a).then(function(n){var i=n&&200===n.statusCode&&n.resourceSets,a=i&&i.length&&i[0].resources,f=a&&a.length&&a[0].address;if(f){var l=f.locality,c=f.adminDistrict,h=f.countryRegion;if(h){u=h;if(c){u=r.format(s.default.locationMapLocationTextWithoutCity,c,h);l&&(u=r.format(s.default.locationMapLocationText,l,c,h))}else l&&(u=r.format(s.default.locationMapLocationTextWithoutDistrict,l,h))}o[e+","+t]=u}return u})};return e})();t.default=u});
define("odsp-next/utilities/jsonp/JSONP",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.fetch=function(t){return new n.default(function(r,i){var s=n.default.timeout(6e4).then(function(){i("JSONP call timeout, url: "+t)}),o="OneDrive_JSONPCallback_"+e._jsonpCallbackCounter++,u=document.createElement("script");window[o]=e._evalJSONP(r,i,u,o,s);t+=(-1===t.indexOf("?")?"?":"&")+"jsonp="+o;u.src=t;document.getElementsByTagName("head")[0].appendChild(u)})};e._evalJSONP=function(e,t,n,r,i){return function(s){n.parentElement.removeChild(n);delete window[r];i.cancel();if("string"==typeof s)try{JSON.parse(s)}catch(e){t(e)}else JSON.parse(JSON.stringify(s))?e(s):t("JSONP call returned invalid or empty JSON")}};e._jsonpCallbackCounter=0;return e})();t.default=r});
define("odsp-next/controls/detailsPane/section/itemPreview/ItemPreviewSection",["require","exports","tslib","react","../../../infoPane/sections/preview/PreviewSection","../legacy/LegacySection","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement("div",{className:"od-DetailsPane-ItemPreviewSection"},r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n}))};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/preview/PreviewSection",["require","exports","./PreviewSection.html","./PreviewSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-infoPane-preview",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"od-infoPane-preview",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/preview/PreviewSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:component--\x3e<div class="InfoPaneSection--preview" data-bind="clientRect:{size:size},component:component"></div>\x3c!--ko if:enableAnalyticsActionBar--\x3e<div class="InfoPaneSection--viewCountLink" data-bind="react:{componentType:analyticsActionBarComponent,props:analyticsActionBarProps}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/sections/preview/PreviewSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../bindings/clientRect/ClientRectBinding","@ms/odsp-shared/lib/base/Rotation","../../../iFrameCtrl/IFrameCtrl","../../../image/frame/ImageFrame","../../../folderCoverTile/FolderCoverTile","../../../../controls/fileHoverCard/react/AnalyticsActionBar","../../../../controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage","../../../../bindings/react/ReactBinding","../../../../utilities/features/Features","../../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.addBindingHandlers({clientRect:i.default,react:c.default});var s=r.observables;r.size=s.create();r._thumbnailError=s.create();r._imageSize=s.pureCompute(r._computeImageSize);r._thumbnail=s.pureCompute(r._computeThumbnail);r._rotation=s.pureCompute(r._computeRotation);r._hasThumbnailError=s.pureCompute(r._computeHasThumbnailError);r._isImage=s.pureCompute(r._computeIsImage);r._isFolder=s.pureCompute(r._computeIsFolder);r._iframeUrl=s.pureCompute(r._computeIFrameUrl);r._isIFrame=s.pureCompute(r._computeIsIFrame);r._isItemMalicious=s.pureCompute(r._computeItemMalicious);r.component=s.pureCompute(r._computeComponent);r.analyticsActionBarComponent=f.default;r.analyticsActionBarProps=r.createPureComputed(r._updateAnalyticsActionBarProps);r.enableAnalyticsActionBar=r.createPureComputed(r._computeAnalyticsActionBarAvailable);r.malwareDetectedMessageComponent=l.malwareDetectedMessage;r.isMalwareDetectedMessageVisible=r.createPureComputed(r._computeIsMalwareDetectedMessageVisible);return r}t.prototype._computeAnalyticsActionBarAvailable=function(){return this._item().type!==p.default.Folder};t.prototype._updateAnalyticsActionBarProps=function(){return{item:this._item(),resources:this.resources}};t.prototype._computeComponent=function(){if(!this._isItemMalicious()){if(this._isIFrame())return{name:o.default.tagName,params:{title:"",url:this._iframeUrl,isExcludeFromScreenReader:!0}};if(this._isFolder())return{name:a.default.tagName,params:{item:this._item,imageRect:this._imageSize}};if(this._isImage())return{name:u.default.tagName,params:{image:this._thumbnail,rotation:this._rotation,desiredSize:this._imageSize,alignment:["fitWidth","top"],error:this._thumbnailError}}}};t.prototype._computeIsFolder=function(){var e=this._item();return!(!e||!e.folder)};t.prototype._computeIFrameUrl=function(){var e=this._item();return e&&e.previewIFrameUrl};t.prototype._computeIsIFrame=function(){return!!this._iframeUrl()};t.prototype._computeThumbnail=function(){var e=this._item();return e&&(e.orientedThumbnail||e).thumbnail};t.prototype._computeRotation=function(){var e=this._item(),t=e&&e.orientedThumbnail;return t?t.rotation:s.default.none};t.prototype._computeIsImage=function(){return!!this._thumbnail()&&!this._hasThumbnailError()};t.prototype._computeHasThumbnailError=function(){return this._hasThumbnailError.peek()||!!this._thumbnailError()};t.prototype._computeImageSize=function(){var e=this.size();return{width:e&&e.width||319,height:180}};t.prototype._computeItemMalicious=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._computeIsMalwareDetectedMessageVisible=function(){return!!h.isFeatureEnabled(h.EnableATPFilesListView)&&this._computeItemMalicious()};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=d});
define("odsp-next/controls/iFrameCtrl/IFrameCtrl",["require","exports","./IFrameCtrl.html","./IFrameCtrlViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-iframe",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/iFrameCtrl/IFrameCtrl.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:isVisible--\x3e<div class="IFrame">\x3c!--ko if:title--\x3e<div class="ms-IFrameCtrl-title" data-bind="text:title"></div>\x3c!--/ko--\x3e<iframe class="ms-IFrameCtrl-iFrame" data-bind="attr:{src:url,role:role,tabindex:tabindex},event:{load:iframeOnLoad}"></iframe></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/iFrameCtrl/IFrameCtrlViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.observables;n.url=r.wrap(t.url);n.title=r.wrap(t.title);var i=t.isExcludeFromScreenReader;n.tabindex=i?"-1":null;n.role=i?"presentation":null;n._isEmailAttestationPage=r.create(!1);n.isVisible=r.pureCompute(n._computeIsVisible);n.isTitleVisible=r.pureCompute(n._computeIsTitleVisible);n.iframeOnLoad=function(e,r){try{r.target.contentWindow.location.href.toLowerCase().indexOf("emailattestation.aspx")>-1&&n._isEmailAttestationPage(!0)}catch(r){}t.onload&&t.onload(r)};return n}t.prototype._computeIsVisible=function(){return!!this.url()&&!this._isEmailAttestationPage()};t.prototype._computeIsTitleVisible=function(){return!!this.title()};return t})(r.default);t.default=i});
define("odsp-next/controls/fileHoverCard/react/AnalyticsActionBar",["require","exports","tslib","react","knockout","@ms/shared-react-item-hover-card/lib/index","../../../dataSources/itemAnalytics/store/FileHoverCardStore","../../../resources/ControlResourceKeys","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../../providers/engagement/Engagement","../../sharing/share/commands/ShareCommandBuilder","./FileHoverCardHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.getAccessToken=function(){return h.getGraphAccessToken(n.state.graphDataSource,n.props.item)};n.onView=function(e){n._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ViewClick"});new(n.resources.injected(n.actionMap.ShowItemAnalyticsAction))({item:i.observable(n.props.item)}).execute(e)};n.resources=t.resources;n.state={fileHoverCardStore:n.resources.consume(o.resourceKey.optional),graphDataSource:n.resources.consume(f.graph.optional)};n.actionMap=n.resources.consume(u.actionMap);n._engagement=n.resources.consume(l.resourceKey);return n}t.prototype.componentDidMount=function(){var e=this;this.resources.consumeAsync(o.resourceKey).then(function(t){e.setState({fileHoverCardStore:t})});this.resources.consumeAsync(f.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,n=e.graphDataSource,i=h.getGraphItemUrl(n,this.props.item),s={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,queryType:a.default[this.props.item.queryType],graphItemUrl:i,getAccessToken:this.getAccessToken};return r.createElement("div",{className:"AnalyticsActionBarField"},t&&n&&h.shouldEnableFileHoverCard(this.props.item,this.resources)&&r.createElement(d,{item:s,fileHoverCardStore:t,onView:this.onView,actionBarItems:[],isViewCountClickable:!0}))};t.prototype.onShare=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ShareClick"});new(this.resources.injected(this.actionMap.SelectAction))({item:i.observable(this.props.item),showProperties:!1}).execute(e);new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:c.shareFocusItemResourceKey}).execute(e)};return t})(r.Component);t.default=p;var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={itemAnalyticsResult:n.props.fileHoverCardStore.getItemAnalytics(n.props.item)};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;if(this.props.item.itemId!==e.item.itemId){t.removeListener(this._storeListener,e.item);this._addListener()}};t.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};t.prototype.render=function(){var e=this.state.itemAnalyticsResult,t={itemAnalytics:e&&e.data,onClick:this.props.onView,isNotSupported:!1,status:e&&e.status,isCompact:!0,disableViewerCount:this.props.isViewCountClickable,isLink:this.props.isViewCountClickable},n=t&&t.itemAnalytics;return r.createElement("div",{className:"AnalyticsActionBar--item"},n?r.createElement(s.AnalyticsActionBar,{analyticsStats:t,items:this.props.actionBarItems,isLink:this.props.isViewCountClickable,showActionBar:!1,farItems:[]}):null)};t.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item);t.fetchItemAnalytics(this.props.item)};return t})(r.Component);t.AnalyticsActionBarWrap=d});
define("odsp-next/controls/detailsPane/section/itemProperties/ItemPropertiesSection",["require","exports","tslib","react","../../../infoPane/sections/properties/PropertiesSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources,o=e.isScheduling;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n,isScheduling:o})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSection",["require","exports","./PropertiesSection.html","./PropertiesSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-properties-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-properties-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--properties" data-automationid="ms-properties-section" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" id="spo-Properties-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:isScheduling--\x3e<h2 class="InfoPane-sectionHeaderText" data-bind="text:clientFormTitle"></h2>\x3c!--/ko--\x3e\x3c!--ko ifnot:isScheduling--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:clientFormTitle"></span>\x3c!--/ko--\x3e\x3c!--ko if:canEdit--\x3e<a class="spo-Properties-editLink" data-bind="click:onEditClick,clickBubble:false,text:clientFormEditLink" href="#"></a>\x3c!--/ko--\x3e</div><div class="InfoPane-sectionContent">\x3c!--ko if:isLoading--\x3e<div class="od-ClientFormFields-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:propertiesErrorMessage--\x3e<div class="spo-Properties-sectionNotification" data-bind="component:{name:sectionNotificationTagName,params:{notificationText:propertiesErrorMessage,sectionNotificationIconAriaLabel:sectionNotificationIconLabel,notificationBackgroundCss:notificationBackgroundStyle}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:clientForm--\x3e<div class="spo-Properties-clientForm" data-bind="component:clientForm"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/clientForm/DuplexClientForm","../../../../providers/clientForm/ClientFormProvider","../../../../models/item/ItemParentHelper","../../../../bindings/toggle/ToggleBinding","../../../loadingSpinner/LoadingSpinner","../../InfoPane.resx","../../notification/SectionNotification","../../../../utilities/features/Features","../../../../resources/LoggingResourceKeys","../../../../actions/splist/EditItemAction","../../../../models/item/ItemType","@ms/odsp-utilities/lib/string/StringHelper","../../SectionHelper","../../../../actions/base/ItemSelectionHelper","../../../../providers/engagement/Engagement","../../../refreshClientForm/RefreshClientForm.key","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/killswitch/Killswitch","../../../../resources/SPOResourceKeys","../../../../actions/odb/ActionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._handleRefreshClientForm=function(){r._refreshClientForm(!1);r._updateProperties(!0)};r.sectionHelper=new(r.managed(m.default));r.loadingSpinnerTagName=a.default.tagName;r.clientFormEditLink=f.default.clientFormEditLink;r.sectionNotificationTagName=l.default.tagName;r._isScheduling=t.isScheduled;var i=r,d=i.observables,v=i.resources,y=n.itemParentHelper,w=void 0===y?v.consume(o.resourceKey):y,E=n.clientFormProvider,x=void 0===E?v.consume(s.resourceKey):E,T=n.itemSelectionHelperType,N=void 0===T?v.consume(g.typeResourceKey):T,C=n.rumOneHelper,k=void 0===C?v.consume(h.rumOneHelper):C,L=n.listContext,A=void 0===L?v.consume(S.listContext):L;r._listContext=A;r._itemParentHelper=w;r._itemSelectionHelper=new(r.scope.attached(N))({allowMultiSelect:!0,canFallback:!0});r._editItemAction=new(r.managed(p.default))({item:r._itemSelectionHelper.firstItem});r._isDocLib=d.pureCompute(r._computeIsDocLib);r.clientForm=d.create();r._serverError=d.create();r.canEdit=d.pureCompute(r._computeCanEdit);r.isLoading=d.pureCompute(r._computeIsLoading);r.hasMissingMetadata=d.compute(r._computeHasMissingMetadata);r.propertiesErrorMessage=d.pureCompute(r._computePropertiesErrorMessage);r.notificationBackgroundStyle=d.compute(r._computeMessageSeverity);r.sectionNotificationIconLabel=d.compute(r._computeNotificationIconAriaLabel);r.clientFormTitle=d.pureCompute(r._computeTitle);r._useDocSetsModernView=c.isFeatureEnabled(c.DocumentSetsModernView)&&c.isFeatureEnabled(c.UseItemsScopeInTeamSites);r.addBindingHandlers({toggle:u.default});r._rumOneHeler=k;r._clientFormProvider=x;d.compute(r._updateProperties);r._refreshClientForm=r.resources.consume(b.resourceKey);r.scope.attach(r._refreshClientForm.subscribe(r._handleRefreshClientForm));r.isScheduling=d.wrap(r._isScheduling);r.sectionNotificationIconLabel=d.compute(r._computeNotificationIconAriaLabel);return r}t.prototype.onEditClick=function(e){this._editItemAction.execute(e)};Object.defineProperty(t.prototype,"_item",{get:function(){return this._itemSelectionHelper.firstItem},enumerable:!0,configurable:!0});t.prototype._computeTitle=function(){if(this._isScheduling)return f.default.Scheduling;var e=this._itemSelectionHelper.selection();return e&&e.length>1?f.default.bulkEditClientFormTitle:f.default.clientFormTitle};t.prototype._computeIsLoading=function(){return!this._serverError()&&!this.clientForm()&&!this._isQuickEditDisabled()};t.prototype._computeCanEdit=function(){return!this._serverError()&&this._editItemAction&&this._editItemAction.isAvailable()&&!this._isBulkEdit()&&!this._isScheduling};t.prototype._computeIsDocLib=function(){var e=this._item(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!t||!t.list||!!t.list.isDocumentLibrary};t.prototype._computePropertiesErrorMessage=function(){if(this._isScheduling)return"";var e=this._serverError();if(e){var t=e&&e.message&&(e.message.value||e.message);return t?v.format(f.default.propertiesNotificaiton_serverErrorWithDetails,t):f.default.propertiesNotificaiton_serverErrorNoDetails}var n=this._item();if(n&&n.type!==d.default.Folder){if(this.hasMissingMetadata()){if(this._isDocLib()){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"list"));return r&&r.list&&(119===r.list.templateType||850===r.list.templateType)?f.default.propertiesNotificaiton_missingMetadata_page:f.default.propertiesNotificaiton_missingMetadata_file}return f.default.propertiesNotificaiton_missingMetadata_item}if(this._isDocLib())return this._publishingReminderText(n)}return""};t.prototype._computeMessageSeverity=function(){return c.isFeatureEnabled(c.PagesRequiredProperties)&&this.hasMissingMetadata()&&this._isPagesLibrary?"od-SectionNotification-Error":"od-SectionNotification-Warning"};t.prototype._computeNotificationIconAriaLabel=function(){var e=this.hasMissingMetadata();return c.isFeatureEnabled(c.PagesRequiredProperties)&&e&&this._isPagesLibrary?f.default.sectionNotificationIconAriaLabelError:f.default.sectionNotificationIconAriaLabelWarning};Object.defineProperty(t.prototype,"_isPagesLibrary",{get:function(){var e=this._item(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list&&(119===t.list.templateType||850===t.list.templateType);return Boolean(n)},enumerable:!0,configurable:!0});t.prototype._computeHasMissingMetadata=function(){var e=this._item(),t=!1;if(e){var n=this.clientForm(),r=n&&n.params.clientForm;t=e.hasMissingMetadata;if(r&&r.contentType)for(var i=r.contentTypeId===e.properties.ContentTypeId,s=0,o=r.fields;s<o.length;s++){var u=o[s];if(u&&u.schema){var a=u.schema;if(a.Required&&e.properties&&!e.properties[a.Name]&&(E.Killswitch.isActivated("F6198E78-E2BF-4DEE-8C0B-57DE41B93B7A","05/20/2020","check contentType id for missing values for required fields")||i)){t=!0;break}}}}return!!t};t.prototype._publishingReminderText=function(e){if(c.isFeatureEnabled(c.WexSitePagesScheduling))return"";if(x.default.needsPublishingReminder(e,this._listContext)){var t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list&&(119===t.list.templateType||850===t.list.templateType)?f.default.page:f.default.file,r=0===x.default.getVersion(e,this._listContext).major?f.default.publish:f.default.republish,i=!!this._listContext.isModerated;if(E.Killswitch.isActivated("8273e7a4-631b-482e-8d88-1a09350cddd8","11/15/2019","Publishing banner experiment"))return"";w.Engagement.logData({name:"PropertiesBanner.PublishingReminder.Shown"});return i?v.format(f.default.propertiesNotification_submitApproval,n):v.format(f.default.propertiesNotificaiton_publishing,r,n)}return""};t.prototype._updateProperties=function(e){var t=this,n=this._isBulkEdit(),r=this._itemSelectionHelper.selection.peek(),s=this._item.peek();if(s&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.isBulkEdit===n&&!e)if(n){var o=this._clientFormProvider.getContentInfoTypes(this._lastUpdateClientFormParams),u=this._getClientFormParms(this._item,n,r),a=this._clientFormProvider.getContentInfoTypes(u);if(o.length===a.length){for(var f=!1,l=0;l<o.length;l++)if(o[l].contentType!==a[l].contentType||o[l].contentTypeId!==a[l].contentTypeId){f=!0;break}if(!f)return}}else if(s.properties&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.item&&this._lastUpdateClientFormParams.item.peek().properties&&s.properties.ID===this._lastUpdateClientFormParams.item.peek().properties.ID&&null!==this.clientForm.peek())return;n||(this._editItemAction=new(this.managed(p.default))({item:this._item}));this._rumOneHeler&&this._rumOneHeler.logPropertiesPaneUpdate();this.clientForm(void 0);this._serverError(void 0);this.async.setImmediate(function(){var n=t._item.peek(),s=t._isBulkEdit();if(n){t._lastUpdateClientFormParams=t._getClientFormParms(t._item,s,r);c.isFeatureEnabled(c.PropertiesFormConnector)?t.clientForm({name:i.getClientFormTagName(t.resources,!0),params:{item:t._item,interactiveSave:!s,isInfoPane:!0,clientFormType:1,isReadOnly:!s&&t._isQuickEditDisabled(),isScheduling:t._isScheduling,isRenderingShowHideColumnsPanelBtn:!0}}):t._clientFormProvider.getClientForm(t._lastUpdateClientFormParams,e).done(function(e){var n=s?"BulkEditForm.Render":"EditForm.Render";t.resources.consume(y.resourceKey).logData({name:n,isIntentional:!0});t.clientForm({name:i.getClientFormTagName(t.resources),params:{clientForm:e,interactiveSave:!s,isInfoPane:!0,isReadOnly:!s&&t._isQuickEditDisabled(),suppressDefaultSaveBehavior:!0,isScheduling:t._isScheduling}})},function(e){t._serverError(e)})}else t._lastUpdateClientFormParams=void 0})};t.prototype._isQuickEditDisabled=function(){for(var e=this._item&&this._item.peek(),t=!1;e;){if(e.list){t=!!e.list.disableGridEditing;break}e=e.parent}if(!t&&!this._useDocSetsModernView){t=!this._itemSelectionHelper.selection.peek().length}return!!t};t.prototype._isBulkEdit=function(){var e=this._itemSelectionHelper.selection();return e&&e.length>1};t.prototype._getClientFormParms=function(e,t,n){var r=e.peek().properties;return{clientFormType:1,item:e,contentType:r.ContentType,contentTypeId:r.ContentTypeId,isBulkEdit:t,selection:n}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemParentHelper:o.resourceKey,clientFormProvider:s.resourceKey,itemSelectionHelperType:g.typeResourceKey,rumOneHelper:h.rumOneHelper,listContext:S.listContext});return t})(r.default);t.default=T});
define("odsp-next/controls/clientForm/DuplexClientForm",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","../../providers/engagement/Engagement","../../roots/teams/TeamsUtil"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createComponent("ms-client-form-react","./ReactClientFormConnector",function(){return n.default.resolve(new Promise(function(t,n){e(["./ReactClientFormConnector"],t,n)}))});r.components.isRegistered(u.tagName)||r.components.register(u.tagName,u);var a=i.createComponent("ms-properties-form","./propertiesForm/PropertiesFormConnector",function(){return n.default.resolve(new Promise(function(t,n){e(["./propertiesForm/PropertiesFormConnector"],t,n)}))});r.components.isRegistered(a.tagName)||r.components.register(a.tagName,a);t.getClientFormTagName=function(e,t){void 0===t&&(t=!1);var n=e&&e.consume(s.resourceKey)||null;if(t){n&&n.logData({name:"ClientForm.Instantiate.PropertiesForm",extraData:{TagName:"ms-properties-form",Host:o.getExtraDataHost()}});return"ms-properties-form"}n&&n.logData({name:"ClientForm.Instantiate.ReactClientForm",extraData:{TagName:"ms-client-form-react",Host:o.getExtraDataHost()}});return"ms-client-form-react"}});
define("odsp-next/providers/clientForm/ClientFormProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../models/store/ItemsStore","../../models/item/ItemType","../../models/task/Task","@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/clientForm/spo/ClientFormDataSource","../../resources/SPOResourceKeys","../../models/clientForm/ClientFormHelper","@ms/odsp-utilities/lib/resources/Resources","../../utilities/killSwitch/KillSwitch","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._buffer=[];r._bufferSize=5;r._clientFormDataSource=n.clientFormDataSource;r._itemsStore=n.itemsStore;r._listContext=n.listContext;return r}t.prototype.getClientForm=function(e,t){var n=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var i,o=e.item.peek(),u=this._getBufferKeyFromItem(o,e.contentType),a=e.isBulkEdit?void 0:this._getClientFormFromBuffer(u);o.type!==s.default.Folder||e.contentType||(e.contentType="Folder");if(a&&!this._listContext.refreshClientForm){if(o.hasClientFormData){a.item=e.item;return r.default.wrap(a)}this._deleteClientFormFromBuffer(u)}var f=this.getContentInfoTypes(e);return this._clientFormDataSource.getClientFormSchema(e.clientFormType,f,e.isBulkEdit).then(function(t){i={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};n._generateFieldsFromSchema(i,t);if(2!==e.clientFormType)return n.updateFormValues(i)}).then(function(){n._addClientFormToBuffer(i);return r.default.wrap(i)})};t.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,i=e.selection;r<i.length;r++){var o=i[r];if(o){var u=o.peek(),a=u.properties;if(a){var f=u.type!==s.default.Folder||a.ContentType?a.ContentType:"Folder",l=a.ContentTypeId,c=f+l;if(!n[c]){t.push({contentType:f,contentTypeId:l});n[c]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};t.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};t.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};t.prototype.clearBuffer=function(){this._buffer=[]};t.prototype.updateItem=function(e){(!p.default.isActivated("E5B5EC4B-2237-4E9C-8C79-1751EEBD1D72","02/15/19","Delete the client form buffer to avoid stale client forms")||e.clientForm.isBulkEdit&&e.selection)&&(this._buffer=[]);return this._clientFormDataSource.updateItem(e)};t.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};t.prototype.updateItemMetadata=function(e,t){var n=this,i=e.items,s=e.metadata,a=e.parentItem,f=e.skipInvalidation,l=e.onComplete,h=i.length,p=0,d=[],v=function(){for(var e=[],t=s.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:n.createObservable(r),serverData:null,state:n.createObservable(0),hasException:n.createObservable(!1),errorMessage:n.createObservable(""),schema:i});t=c.convertGroup(u.default.getParent(t,s.itemGroups))}return e};return r.default.wrap((function(){i.forEach(function(e,r){t&&(d[r]=new o.default(e.key,e));var i={item:n.createObservable(e),fields:v(),contentType:null,formType:1};n._clientFormDataSource.updateItem({clientForm:i,newDocumentUpdate:!1,checkInComment:null}).then(function(){p++;if(t){d[r]=d[r].succeed();t.update(d)}if(p===h){l&&l(!0);a&&!f&&n._itemsStore.invalidateItem(a.key)}},function(e){if(t){var n=e&&e.length>0&&e[0]&&e[0].message&&e[0].message.value;d[r]=d[r].fail(new Error(n));t.update(d)}})});t&&t.update(d)})())};t.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};t.prototype.getFormRenderMode=function(e,t){return!p.default.isActivated("831B633B-83B5-459E-BF81-621C71B298F1","05/25/2020","smart disable PA on boot")&&d.isFeatureEnabled(d.CustomActionPreFetch)&&this._listContext&&!1===this._listContext.checkPowerAppState?r.default.resolve(2):this._clientFormDataSource.getFormRenderMode(e,t)};t.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};t.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};t.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};t.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};t.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};t.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:this.createObservable(!1),errorMessage:this.createObservable(""),schema:t,state:this.createObservable(0)}};t.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};t.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};t.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit&&!this._hasAppendOnlyField(e)){var t=e.item.peek();t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};t.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};t.prototype._hasAppendOnlyField=function(e){for(var t=0,n=e.fields;t<n.length;t++){if(n[t].schema.AppendOnly)return!0}return!1};t.dependencies=n.__assign(n.__assign({},a.default.dependencies),{clientFormDataSource:f.resourceKey,itemsStore:i.resourceKey,listContext:l.listContext});return t})(a.default);t.default=v;t.resourceKey=h.createResolvedResourceKey(e("module").id,v)});
define("@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=(function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")})(r);break;default:t=e.fieldValue}return t}})(n||(n={}));t.default=n});
define("odsp-next/dataSources/clientForm/spo/ClientFormDataSource",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/async/Promise","../../base/odb/DataSource","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/encoding/UriEncoding","../IClientFormDataSource","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemDataHelpers","../../item/odb/ListViewDataPrefetchHelper","@ms/odsp-datasources/lib/interfaces/ISpPageContext","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../compliance/ComplianceTagDataSource","../../url/odb/ItemUrlHelper","../../url/odb/ApiUrlHelper","../../../utilities/features/Features","../../../utilities/complianceTag/ComplianceTagUtilities","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/encoding/HtmlEncoding","./ClientFormDataSource.resx","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RootContentTypeIds={folder:"0x0120",document:"0x0101",item:"0x01"};var A=1,O=2,M=4,_=8,D=32,P=(function(e){n.__extends(s,e);function s(t,n){var r=e.call(this,n.pageContext)||this;r._clientForms=null;r._listContext=n.listContext;r._itemsDataSource=n.items;r._navigation=n.navigation;r._complianceTagDataSource=n.compliance;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;return r}s.prototype.createItem=function(e,t){var n=this,r=this._getUrlInfo(e.clientForm.item),i=r.listUrl,s=r.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=t?t+".CreateItem":"CreateItem";return this._createOrUpdateItem(u,function(){return n._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n}},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})},e,o).then(function(){return n._updateAttachmentsField(e)})};s.prototype.updateItem=function(e,t){var n=this,r=e.clientForm.isBulkEdit&&e.selection&&e.selection.length>1?e.selection:void 0;r&&r.filter(function(e){return!!e});var i=r&&r.length>0,s=t?t+".UpdateItem":"UpdateItem";return this._createOrUpdateItem(s,function(e){var t=n._getUrlInfo(e),r=t.listUrl,s=t.itemUrlParts;return i?n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.peek().properties.ID).method("ValidateUpdateListItem").toString()},function(t){var s,o;if(i){s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u];s.push(parseInt(f.peek().properties.ID,10))}if(!e.isRecursiveView){var l=(f=e.clientForm.item.peek())&&f.parent;o=l&&n._itemUrlHelper.getItemUrlParts(l.key).normalizedItemUrl}}return JSON.stringify({itemIds:s,formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o})},e,i?"BulkValidateUpdateListItems":"ValidateUpdateListItem",r).then(function(t){return n._updateAttachmentsField(e).then(function(){return t})})};s.prototype.getClientFormSchema=function(e,t,r){var s=this,o=function(){var i=s._locateClientFormWithContentTypeInfos(e,t);if(r&&i&&i.fields){var o=i.fields.filter(function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"!==t&&"attachments"!==t&&"Title"!==n&&"LinkTitle"!==n&&"LinkTitleNoMenu"!==n});return n.__assign(n.__assign({},i),{fields:o})}return i};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return i.default.wrap(o())};s.prototype.updateFormValues=function(e,t){var n=this,r=e.item.peek();if(!r||!r.properties||!r.properties.ID)return i.default.wrap();for(var s=[],a=0,f=e.fields;a<f.length;a++){var l=f[a];0===l.state.peek()&&s.push(l)}return this.dataRequestor.getData({url:(function(){var e=r.properties.ID,t=u.default.encodeRestUriStringToken(n._listContext.listUrl),i=A+O+M;i+=_;b.isFeatureEnabled(b.ClientFormImageField)&&(i+=D);var s=",cutoffVersion="+(new o.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0");return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+i+s+")?@v1='"+t+"'"})(),parseResponse:function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){try{t=JSON.parse(t.d.RenderExtendedListFormData)}catch(e){return i.default.reject(e)}return t}}return null},qosName:"GetItemDataForClientForm",method:"POST",additionalHeaders:this._getAdditionalHeaders()}).then(function(r){n._handleServerData(e,r,t,s);for(var i=0,o=s;i<o.length;i++){o[i].state(0)}},function(e){for(var t=e?e.code?e.code.split(","):e.error?e.error.code.split(","):[]:[],n=e||t.length>1?Number(t[0]):-1,r=0,o=s;r<o.length;r++){o[r].state(0)}return i.default.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};s.prototype.getFieldValueSuggestions=function(e,t,n,r){n=n||5;r=N.default.encodeText(r);var s=this._getSuggestionsViewXml(e,t,!0,n,r),o=this._getSuggestionsViewXml(e,t,!1,n,r),u=this._getAdditionalHeaders(),a=function(t){var n=JSON.parse(t);return n&&n.Row&&n.Row.length>0?n.Row.map(function(t){var n=t[e];return"string"==typeof n||n instanceof String?t[e].trim():JSON.stringify(t[e])}):[]},f=this.dataRequestor.getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByMe",additionalPostData:c.default.getAdditionalPostData({needsSchema:!1,viewXml:s}),method:"POST",additionalHeaders:u}),l=this.dataRequestor.getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByOther",additionalPostData:c.default.getAdditionalPostData({needsSchema:!1,viewXml:o}),method:"POST",additionalHeaders:u});return i.default.all([f,l]).then(function(e){for(var t={},r=[],i=0,s=e;i<s.length;i++)for(var o=0,u=s[i];o<u.length;o++){var a=u[o];if(!t[a]){r.push(a);t[a]=!0;if(r.length===n)return r}}return r})};s.prototype.getFieldFilterData=function(e,t){var n=v.serializeQuery(this._navigation.viewParams);return this._itemsDataSource.getFilterData(e,n,t)};s.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};s.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};s.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};s.prototype.getPowerAppFormId=function(){return this._powerAppFormId};s.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};s.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};s.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};s.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.dataRequestor.getData({url:t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1",parseResponse:function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},qosName:"GetPowerAppFormDesignUrl",method:"GET"})};s.prototype.fetchAllClientFormSchemas=function(e){var t,n=this;void 0===e&&(e=!1);this._clientFormsDebouncer||(this._clientFormsDebouncer=new S.default);this._clientFormsDebouncer.isExecuting()&&!e||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.dataRequestor.getData({url:this._getServerConnectionUrl().toString(),parseResponse:function(e){n._clientForms={};var t=JSON.parse(e);t.ContentTypeIdToNameMap&&(n._contentTypeIdToNameMap=t.ContentTypeIdToNameMap);t.ClientFormCustomFormatter&&(n._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter);var r=t.ClientForms;if(r){r.New&&n._processClientFormResponse(2,r.New);if(r.Edit){n._processClientFormResponse(1,r.Edit);n._processClientFormResponse(3,r.Edit)}}t.Navigation&&(n._listContext.leftNavigationData={quickLaunchNodes:t.Navigation.Nodes});void 0!==t.EnableAttachments&&(n._listContext.enableAttachments=t.EnableAttachments);t.FormRenderModes&&n._processFormRenderMode(t.FormRenderModes);(t.PowerAppFormId||t.AppId)&&(n._powerAppFormId=t.PowerAppFormId||t.AppId);t.AppRenderInfo&&(n._powerAppFormInfo=t.AppRenderInfo||{});t.AppAdditionalData&&(n._powerAppAdditionalData=t.AppAdditionalData);t.CachedFileUrlTemplate&&t.CacheAppFiles&&(n._powerAppFormCacheInfo=JSON.stringify({appFiles:t.CacheAppFiles,cachedFileUrlTemplate:t.CachedFileUrlTemplate}))},qosName:"GetClientForms",additionalPostData:(t=L.default.isActivated("6C84499D-FB49-4D49-8AA4-D01985944D20","07/07/20","do not fetch navigationNodes when getClientForms")&&!n._listContext.leftNavigationData&&b.isFeatureEnabled(b.RenderListDataAsStreamLeftNavOpt),c.default.getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:t})),method:"POST",additionalHeaders:this._getAdditionalHeaders(),noRedirect:!0})));return this._clientFormsPromise};s.prototype.getDataSourceName=function(){return"ClientFormDataSource"};s.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){var i=this._reverseLookupContentTypeIdByName(r),s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[i]:void 0;n[r]={contentType:r,contentTypeId:i,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var o=n[r],u=t[r],a=0,f=u.length;a<f;a++)o.fields.push(u[a])}};s.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return l.getListDataUrl({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};s.prototype._getUrlInfo=function(e){var t=e&&this._itemUrlHelper.getItemUrlParts(this.peekUnwrapObservable(e).key);return{listUrl:t?t.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:t}};s.prototype._createOrUpdateItem=function(e,t,n,r,s,o){var u=this,f=r.clientForm.fields,l=[],c=[],p={},d=[],v=null,m=null,g=!1;this._failedUpdateComplianceTagIdsCount=0;for(var y=0,E=f;y<E.length;y++){var S=E[y];if(S.data&&0===S.state.peek()){var x=S.data.peek();if(w.isClientFormComplianceTagField(S)&&x!==S.serverData){v=S;if(o){var T=this._getUpdateMultipleComplianceTagsPromises(x,o,S);if(T)for(var N=0,C=T;N<C.length;N++){var k=C[N];d.push(k)}}else{var A=this._getUpdateComplianceTagPromise(x,r.clientForm.item.peek(),S);A&&d.push(A)}}else if(w.isClientFormUnlockedRecordField(S)){if(!b.isFeatureEnabled(b.IPRecordVersioningClient)){p[S.schema.Name]=!0;continue}var O=w.isUnlockRecordTurnedOn(r.clientForm.item.peek().properties[w.COMPLIANCEFLAGS_NAME]);if(O===("1"===x)||o){p[S.schema.Name]=!0;continue}m=S;var M=this._getUpdateUnlockedRecordPromise(x,r.clientForm.item.peek(),S,O);M&&d.push(M)}else if(this._isClientFormFieldUpdated(r,x,S)&&"attachments"!==S.schema.FieldType.toLowerCase()){S.state(1);l.push(S);var _=S.schema.Name;if(L.default.isActivated("494522DE-9991-4929-B2BB-77B43D84B8EE","10/25/18","Use content type ID instead of name")||"ContentType"!==_)x="ContentType"===_?x.displayName:x;else{x=this._reverseLookupContentTypeIdByName(x.displayName);_="ContentTypeId";g=!0}c.push({FieldName:_,FieldValue:x,HasException:!1,ErrorMessage:null})}else p[S.schema.Name]=!0}}var D=L.default.isActivated("F09067C2-4E14-4222-8AA7-4FB89F5D72B5","10/25/18","Do not include content type twice.");2!==r.clientForm.formType||!D&&g?1===r.clientForm.formType&&r.clientForm.item&&!r.clientForm.isBulkEdit&&r.clientForm.item.peek()&&r.clientForm.item.peek().properties&&(D||!g)&&c.push({FieldName:"ContentTypeId",FieldValue:r.clientForm.item.peek().properties.ContentTypeId,HasException:!1,ErrorMessage:null}):c.push({FieldName:"ContentType",FieldValue:r.clientForm.contentType,HasException:!1,ErrorMessage:null});if(0===l.length&&0===d.length)return i.default.wrap({status:a.UpdateResultStatus.success});d.push(this._getUpdateItemPromise(e,t,n,r,s,l,c,r.clientForm.item,o));return i.default.all(d).then(function(e){for(var t={status:a.UpdateResultStatus.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}u._failedUpdateComplianceTagIdsCount>0&&t.status===a.UpdateResultStatus.success&&(t.status=a.UpdateResultStatus.partialSuccess);return t},function(e){v&&v.state(0);m&&m.state(0);for(var t=0,n=l;t<n.length;t++){var i=n[t];i.hasException(!0);i.state(0)}var s=h.getServerUrl(u._pageContext)+r.clientForm.item.peek().properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+s+'" ',"");return e})})};s.prototype._getUpdateItemPromise=function(e,t,n,r,s,o,u,l,c){return u&&0!==u.length&&o&&0!==o.length?this.dataRequestor.getData({url:t(l),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(A=u[n]).state(0)}return i.default.wrapError("The server response couldn't be processed")}for(var h=null,p={},d="",v=0,m=t.d[s].results;v<m.length;v++){var g=m[v];if(2===r.clientForm.formType&&"Id"===g.FieldName){var y=l.peek();y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;p[b]||(p[b]=[]);void 0!==g.ItemId&&p[b].indexOf(g.ItemId)<0&&p[b].push(g.ItemId);if(!h){h={};for(var w=0,E=r.clientForm.fields;w<E.length;w++){var S=E[w];h[S.schema.Name]=S}}if(h[b]){h[b].errorMessage(g.ErrorMessage);h[b].hasException(!0);var x=h[b].schema.Title;d=d?d+", "+x:x}}}var T={status:d?a.UpdateResultStatus.fail:a.UpdateResultStatus.success};if(c&&c.length&&p.null){var N=p.null;N.length<c.length?T.status=a.UpdateResultStatus.partialSuccess:T.status=a.UpdateResultStatus.fail;T.failedItemIds=N}for(var k=0,L=o;k<L.length;k++){var A=L[k];if(d){if(!p[A.schema.Name]&&r.isInteractiveSave){A.errorMessage(f.format(C.default.ErrorInOtherFields,d));A.hasException(!0)}}else{A.errorMessage("");A.hasException(!1)}A.state(0)}return T},qosName:e,additionalPostData:n(u),method:"POST",additionalHeaders:this._getAdditionalHeaders(),maxRetries:5}):i.default.wrap()};s.prototype._handleServerData=function(e,t,n,i){for(var s=t.ListData,o=t.Data.Row[0],u=e.item.peek(),a=e.isBulkEdit,f=t.SiteAssetsThumbnailMetadata||void 0,l=0,c=i.length;l<c;l++){var h=i[l],p=h.schema;if(!n||!n.hasOwnProperty(p.Name)){void 0===h.data&&(h.data=r.observable(null));void 0===h.serverData&&(h.serverData=null);if(s.hasOwnProperty(p.Name)){"boolean"===p.FieldType.toLowerCase()&&""===o[p.Name]&&"0"===s[p.Name]?h.serverData="":p.FieldType&&"thumbnail"===p.FieldType.toLowerCase()&&o[p.Name]?h.serverData=o[p.Name]:h.serverData=s[p.Name];u.hasOwnProperty(p.Name)||u.properties.hasOwnProperty(p.Name)||(u.properties[p.Name]=o[p.Name])}else if(w.isClientFormComplianceTagField(h)){h.serverData=o[w.COMPLIANCETAG_FIELD_NAME];u.hasOwnProperty(p.Name)||u.properties.hasOwnProperty(p.Name)||(u.properties[p.Name]=o[p.Name])}else u.folder&&h.schema.FieldType&&"file"===h.schema.FieldType.toLowerCase()&&h.schema.Title&&"name"===h.schema.Title.toLowerCase()&&s.Title?h.serverData=s.Title:h.serverData=null;a&&(h.serverData=null);if(h.schema.AppendOnly){h.appendOnlyData=t[h.schema.Name];h.data("")}else h.data(h.serverData);if(L.default.isActivated("1E378923-8921-4A0C-A8F3-130823AB8BEB","Fix hotfix VSO#615577")){h.hasException(!1);h.errorMessage("");h.schema=p}}}f&&(e.siteAssetsThumbnailMetadata=f);b.isFeatureEnabled(b.DocumentSetsModernView)&&b.isFeatureEnabled(b.UseItemsScopeInTeamSites)&&this._handleWelcomeFields(e,t.WelcomeFields);u.properties[w.ASSETID_FIELD_NAME]=s[w.ASSETID_FIELD_NAME];u.hasClientFormData=!0};s.prototype._handleWelcomeFields=function(e,t){var n=e.fields;if(Array.isArray(t)&&t.length>0&&n){for(var r=n.map(function(e,t){return{index:t,name:e.schema.InternalName}}),i={},s=0;s<t.length;s++){var o=t[s];o&&(i[o]=s+2)}i.FileLeafRef=0;i.DocumentSetDescription=1;r.sort(function(e,t){if(e.name===t.name)return e.index-t.index;var n=i[e.name],r=i[t.name];return void 0!==n&&void 0!==r?n-r:void 0!==n?-1:void 0!==r?1:e.index-t.index});e.fields=r.map(function(e){return n[e.index]})}};s.prototype._getAdditionalHeaders=function(){return l.getListRequestHeaders(this._listContext)};s.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=1;break;case 2:i=2;break;case 3:i=3;break;case 4:i=4;break;default:E.Verbose.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};s.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};s.prototype._getSuggestionsViewXml=function(e,t,n,r,i){var s=n?'<Eq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Eq>':'<Neq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Neq>';return'<View Scope="RecursiveAll">'+('<Query><OrderBy><FieldRef Name="ID" Ascending="false"></FieldRef></OrderBy><Where>'+(s=i?"<And>"+s+'<BeginsWith><FieldRef Name="'+e+'"/><Value Type="'+t+'">'+i+"</Value></BeginsWith></And>":"<And>"+s+'<IsNotNull><FieldRef Name="'+e+'"/></IsNotNull></And>')+"</Where></Query>")+('<ViewFields><FieldRef Name="Modified"/><FieldRef Name="Editor"/><FieldRef Name="'+e+'"/></ViewFields>')+'<RowLimit Paged="TRUE">'+r+"</RowLimit></View>"};s.prototype._getUpdateComplianceTagPromise=function(e,t,n){var r,s=n.schema;s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);return r?this._complianceTagDataSource.updateComplianceTag(t,r).then(null,function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):i.default.wrap()};s.prototype._getUpdateUnlockedRecordPromise=function(e,t,n,r){var i=this._itemUrlHelper.getItemUrlParts(t.key).serverRelativeListUrl;return"1"===e?this._complianceTagDataSource.unlockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):this._complianceTagDataSource.lockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}})};s.prototype._getUpdateMultipleComplianceTagsPromises=function(e,t,n){var r,i=this,s=n.schema,o=[];s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);if(r){for(var u=[],a=0,f=0,l=t.length;f<l;f++){var c=t[f];u.push(parseInt(c().properties.ID,10));if(++a===w.MAX_ITEM_SIZE||f===t.length-1){var h=this._itemUrlHelper.getItemUrlParts(t[0]().key).serverRelativeListUrl;o.push(this._complianceTagDataSource.updateComplianceTagInBatch(u,r,h).then(function(e){i._failedUpdateComplianceTagIdsCount+=e.length},function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}));u=[];a=0}}return o}return null};s.prototype._updateAttachmentsField=function(e){var t=this,n=e.clientForm.item.peek(),r=null;if(n&&n.properties.ID&&"0"!==n.properties.ID){for(var s=0,o=e.clientForm.fields;s<o.length;s++){var u=o[s];if("attachments"===u.schema.FieldType.toLowerCase()){r=u;break}}var a=r&&r.AttachmentOperationsManager;if(a&&a.operationsPool.length>0){a.setListItem(n);return a.executeAllOperations(a.operationsPool,!0).then(function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)},function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)})}}return i.default.wrap(null)};s.prototype.handleAttachmentsErrors=function(e,t){var n=[];e.forEach(function(e){e.result||n.push(e.errorMsg)});if(t&&n&&n.length>0){var r=n.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage(r);t.hasException(!0)}};s.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?2===r.mode&&r.clientFormCustomFormatter&&r.clientFormCustomFormatter.bodyJSONFormatter?5:r.mode:this._checkRenderModes(3)?3:0};s.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};s.prototype._ensureClientForms=function(e){if(!this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;var t=!L.default.isActivated("975DFDE1-C9F7-44A9-A628-D9DD6F9BB63D","09/05/2019","Make power app pre-loading more robust");return this.fetchAllClientFormSchemas(t).then(e)}return i.default.wrap(e())};s.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n.serverData)&&(n.schema.AppendOnly?!L.default.isActivated("E4E6F7C4-9ADB-4B1B-833D-350823F516DE","Fix hotfix VSO#617198")||!!t:!x.deepCompare(t,n.serverData))};s.prototype._locateClientForm=function(e,n,r){!n&&r&&this._contentTypeIdToNameMap&&(n=this._contentTypeIdToNameMap[r]);if(!n&&this._clientForms[e])for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){n=i;break}if(r&&0===r.lastIndexOf(t.RootContentTypeIds.folder,0)&&this._clientForms[e]&&!this._clientForms[e][n]){var s={FileLeafRef:1,Title:1,URL:1};for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){var o=this._clientForms[e][i].fields.filter(function(e){return!!s[e.Name]})[0];if(o){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:r,formType:e,fields:[o],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][n]){if("folder"===n.toLowerCase()&&!r)for(var i in this._clientForms[e])if(this._clientForms[e][i]&&!this._clientForms[e][i].contentTypeId)return this._clientForms[e][i];return null}return this._clientForms[e][n]};s.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var r=t[0],i=this._locateClientForm(e,r.contentType,r.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return n.__assign(n.__assign({},i),{fields:s})};s.dependencies={pageContext:d.pageContext,listContext:d.listContext,items:p.items,navigation:k.navigation,compliance:m.resourceKey,itemUrlHelper:g.resourceKey,apiUrlHelper:y.resourceKey};return s})(s.default);t.default=P;t.resourceKey=T.createResolvedResourceKey(e("module").id,P)});
define("odsp-next/dataSources/base/odb/DataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./DataRequestor","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(s.pageContext);r.dataRequestor=new i.default({qosName:r.getDataSourceName()},{pageContext:r._pageContext});return r}t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.updateContext=function(e){o.extend(this._pageContext,e);this.dataRequestor=new i.default({},{pageContext:this._pageContext})};return t})(r.default);t.default=u});
define("odsp-next/dataSources/clientForm/IClientFormDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(t.UpdateResultStatus||(t.UpdateResultStatus={}))});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemDataHelpers",["require","exports","./interfaces/IItemUrlHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListDataUrl=function(e){var t,u,a=e.webUrl,f=e.webId,l=e.listId,c=e.view,h=e.searchTerm,p=e.rootFolder,d=e.sortField,v=e.sortDir,m=e.filterParams,g=e.groupString,y=e.requestToken,b=e.viewId,w=e.viewPath,E=e.urlParts,S=e.isOnePageNavigation,x=[r.default.escapeUrlForCallback(a)];"/"!==a.slice(-1)&&x.push("/");E&&(u=void 0===(t=E.siteRelation)?E.isCrossSite:t);if(((s.Killswitch.isActivated("BC0D39CA-6A40-44C6-BC43-EC999DC12B95","3/7/2019","Use cross-site list call for anything not known to be same-site")?u===n.SiteRelation.crossSite:u!==n.SiteRelation.sameSite)||f)&&E.fullListUrl&&!S){x.push("_api/SP.List.GetListDataAsStream?listFullUrl='");x.push(r.default.encodeRestUriStringToken(E.fullListUrl));if(y){"?"!==y[0]&&i.Verbose.logData({name:"ListItemDataHelper.InvalidRequestToken",message:y});x.push("'&"+y.substring(1));return x.join("")}x.push("'&View=")}else{var T=E&&E.serverRelativeListUrl;T||(T=E&&E.serverRelativeItemUrl);if(T)x.push("_api/web/GetList(@listUrl)");else if(l){x.push("_api/web/lists/GetById('");x.push(l);x.push("')")}else x.push("_api/web/DefaultDocumentLibrary");if(y){x.push("/RenderListDataAsStream");x.push(y);x.push(o(T));if("string"==typeof h){x.push("&InplaceSearchQuery=");x.push(r.default.encodeURIComponent(h))}return x.join("")}x.push("/RenderListDataAsStream?");T&&x.push(o(T,!0));x.push("View=");c&&x.push(c);if(w){x.push("&ViewPath=");x.push(r.default.encodeURIComponent(w))}}b&&x.push("&ViewId="+b);if("string"==typeof h){x.push("&InplaceSearchQuery=");x.push(r.default.encodeURIComponent(h))}if(p){x.push("&RootFolder=");x.push(r.default.encodeURIComponent(p))}if("string"==typeof g){x.push("&IsGroupRender=TRUE");x.push("&DrillDown=1");x.push("&GroupString="+g)}d&&x.push("&SortField="+d);v&&x.push("&SortDir="+v);m&&x.push(m);return x.join("")};function o(e,t){var n=[];if(e){t||n.push("&");n.push("@listUrl='");n.push(r.default.encodeRestUriStringToken(e));n.push("'");t&&n.push("&")}return n.join("")}t.getListRequestHeaders=function(e,t){var n,i,o,u;if(t){n=t.needsQuickLaunch;i=t.webId;o=t.siteId}e.listUrl?u="listUrl="+r.default.encodeURIComponent(e.listUrl):e.listId&&(u="list="+e.listId);i&&(u+=",webId="+i);o&&!s.Killswitch.isActivated("ade8eb60-e615-4e1f-b530-ccfbc7d1c145","11/30/2017","Pass site id to GetListDataAsStream")&&(u+=",siteId="+o);return{"X-SP-REQUESTRESOURCES":n?"NAVIGATIONSTRUCTURE,"+u:u}};t.getListEntityTypeName=function(e,t){var n=e;t&&0===e.indexOf(t)&&(n=e.replace(t,""));"/"===n.substring(0,1)&&(n=n.substring(1));0===n.toLowerCase().indexOf("lists/")&&(n=n.substr("lists/".length)+"List");for(var r=[],i=0;i<n.length;i++){var s=n.charAt(i),o=n.charCodeAt(i);if(!(o>47&&o<58||o>64&&o<91||o>96&&o<123)){s="_x"+("0000"+o.toString(16)).slice(-4)+"_"}r.push(s)}r.length>0&&1===r[0].length&&(r[0]=r[0].toUpperCase());return"SP.Data."+r.join("")+"Item"};t.getEntityPropertyName=function(e,t){var n="_"===e[0]?"OData_"+e:e;if(t)switch(t.toLowerCase()){case"lookup":n+="Id";break;case"user":case"usermulti":n+="StringId"}return n};t.getFieldType=function(e,t,n){void 0===n&&(n="Text");if(!t)return n;for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.Name===e)return s.FieldType}return n}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemUrlHelper",["require","exports","../../../../Url"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteRelation=n.SiteRelation});
define("odsp-next/dataSources/item/odb/ListViewDataPrefetchHelper",["require","exports","../../../utilities/features/PLTFeatures","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers","../../../utilities/hash/SimpleHash"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){this.startTimeMark=(new Date).getTime();this.deferredListData=!1},o=(function(){function e(){}e.prefetchData=function(t){return e._prefetchData?e._prefetchData[t]:null};e.initPrefetchData=function(t){e._prefetchData||(e._prefetchData={});return e._prefetchData[t]=new s};e.setPrefetchData=function(t,n){e._prefetchData||(e._prefetchData={});e._prefetchData[t]=n};e.clearPrefetchData=function(t){e._prefetchData&&e._prefetchData[t]&&delete e._prefetchData[t]};e.getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=n.isFeatureEnabled(n.ListDataRenderOptionChange);e.isSpotlightFeatureEnabled=n.isFeatureEnabled(n.Spotlight);return r.getAdditionalPostData(e)};e.createHashCode=function(e,t){return"listviewdataprefetch-"+i.hashCode(decodeURIComponent(e))+"-"+i.hashCode(t)};e.shouldLogError=!0;e.prefetchSignature=void 0;return e})();t.default=o});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers",["require","exports","tslib","./interfaces/IItemTypeFilter","./interfaces/IItemUrlHelper","@ms/odsp-utilities/lib/features/Features","./ListItemPostDataHelpersBasic","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-graph/lib/utilities/media/MediaUtils"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAdditionalPostData=function(e,t){var n=e.viewXml,r=e.firstGroupOnly,s=e.expandGroups,u=e.allowMultipleValueFilterForTaxonomyFields,a=e.groupByOverride,f=e.requestDatesInUtc,l=e.groupReplace,c=e.additionalFiltersXml,h=e.mergeDefaultView,p=(function(e){"undefined"!=typeof _spPageContextInfo&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&(e.webTemplate=_spPageContextInfo.webTemplate);return o.getRenderOption(e)})(e),d=!(t&&t.urlParts&&t.urlParts.siteRelation===i.SiteRelation.crossSite),v=a||c?o.getOverrideViewXml({groupByField:a,additionalFiltersXml:n?void 0:c}):void 0;n&&c&&(n=o.getCombinedViewXml({viewXml:n,additionalFiltersXml:c}));var m={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:p>0?p:void 0,ViewXml:n||void 0,OverrideViewXml:v||void 0,AllowMultipleValueFilterForTaxonomyFields:u||void 0,AddRequiredFields:d||void 0,MergeDefaultView:h||void 0};f&&(m.DatesInUtc=!0);l&&(m.ReplaceGroup=!0);s&&(m.ExpandGroups=!0);r&&(m.FirstGroupOnly=!0);return JSON.stringify({parameters:m})};function f(e){var t=e.fieldSchema.Name,n=e.fieldSchema.Type,r=e.fieldSchema.Ascending&&"false"===e.fieldSchema.Ascending.toLowerCase(),i=r?"Lt":"Gt",s=e.groupingId,o=!u.Killswitch.isActivated("19D64239-23B2-46A0-AD49-CA9118409DE2","11/17/2019","Fix Groupby Descending");if("DateTime"===n){if(!("(null)"!==s||r&&o))return'<IsNotNull><FieldRef Name="'+t+'" /></IsNotNull>';if(e.fieldFilterByValue&&o)s=e.fieldFilterByValue;else if("(null)"!==s)try{var a=new Date(s);s=a.getUTCFullYear()+"-"+(a.getUTCMonth()+1)+"-"+a.getUTCDate()+"T00:00:00Z"}catch(e){}}else"Boolean"===n&&""===s&&(s="-1");var f="<"+i+'><FieldRef Name="'+t+'" /><Value Type="'+n+'"><![CDATA['+s+"]]></Value></"+i+">";o&&r&&("(null)"!==s||""!==e.fieldFilterByValue)&&(f='<Or><IsNull><FieldRef Name="'+t+'" /></IsNull>'+f+"</Or>");return f}t.getFilterXmlToFetchNextGroup=f;t.getViewXml=function(e){var t,r=e.sortField,i=e.itemIds,o=e.itemRefs,a=e.isAscending,l=e.pageSize,c=e.fetchNextGroup,v=e.lastGroup,m=e.recurseInFolders,g=e.typeFilter,y=void 0===g?{filters:[]}:g,b=e.fieldNames,w=void 0===b?[]:b,E=e.groupBy,S=void 0===E?[]:E,x=e.userIsAnonymous,T=void 0!==x&&x,N=e.requestMetaInfo,C=void 0!==N&&N,k=e.requestCommentFlags,L=void 0!==k&&k,A=e.fileTypeIconMap,O="",M="",_="",D="",P=!1;l||(l=1);if(c){O='<GroupBy Collapse="FALSE">'+S.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</GroupBy>";t=f(v)}else if(i&&i.length>0||o&&o.length>0){var H=[],B=[];if(i)for(var j=0,F=i;j<F.length;j++){var I=F[j];isNaN(Number(I))?H.push(I):B.push(I)}t=p([d("ID",1===B.length?"Number":"Counter",B),d("UniqueId","Guid",H),d("FileRef","Text",o&&o.map(function(e){return"<![CDATA["+e+"]]>"}))]);m&&(D='Scope="RecursiveAll"')}else{_=r?'<OrderBy><FieldRef Name="'+r+'" Ascending="'+a+'"></FieldRef></OrderBy>':"";P=!0}y.filters.length&&(t=h(y,{fileTypeIconMap:A}));t&&(M="<Where>"+t+"</Where>");return(function(e){var t=e.viewParams,r=e.query,i=e.pageSize,o=void 0===i?30:i,a=e.includeFields,f=e.fieldNames,l=void 0===f?[]:f,c=e.userIsAnonymous,h=void 0!==c&&c,p=e.requestMetaInfo,d=void 0!==p&&p,v=e.requestCommentFlags,m=void 0!==v&&v;if(a){l=n.__spreadArrays(["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize"],l);if(d){var g=["MediaServiceFastMetadata","MediaServiceOCR"];s.default.isFeatureEnabled({ODB:1208})&&g.push("MediaServiceTranscript");l=n.__spreadArrays(g,l)}m&&!u.Killswitch.isActivated("E5EBF103-91E1-4448-A794-7C8ECD2B095F","11/20/2018","Do not query for _CommentFlags in viewXml")&&(l=n.__spreadArrays(["_CommentFlags"],l));h||(l=n.__spreadArrays(["SharedWith"],l));l=n.__spreadArrays(["DocIcon","LinkFilename","Modified","Editor","FileSizeDisplay"],l)}l=(function(e){var t;if(e){t=[];var n=void 0;n={};for(var r=0,i=e;r<i.length;r++){var s=i[r];if(!n[s]){n[s]=!0;t.push(s)}}}return t})(l);var y="";l.length&&(y="<ViewFields>"+l.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</ViewFields>");return"<View "+t+"><Query>"+r+"</Query>"+y+'<RowLimit Paged="TRUE">'+o+"</RowLimit></View>"})({viewParams:D,query:_+O+M,pageSize:l,includeFields:P,fieldNames:w,userIsAnonymous:T,requestMetaInfo:C,requestCommentFlags:L})};var l='<Eq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Eq>',c='<Neq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Neq>';function h(e,t){void 0===t&&(t={});for(var i=t.fileTypeIconMap,s=[],o=[],u=[],f=[],h=[],v=[],m=[],g=i&&i.photo.extensions||[],y=i&&i.vector.extensions||[],b=g.concat(y),w=!1,E=0,S=0,x=e.filters;S<x.length;S++){var T=x[S];if("string"==typeof T){var N=T,C=!1;if("!"===N[0]){N=N.slice(1);C=!0}var k="."===N[0],L=k?N.slice(1):N;if(k){var A=N.slice(1).toLowerCase();v.push(A);var O='<Value Type="Text">${extType}</Value>'.replace("${extType}",L);C?m.push(O):h.push(O)}else switch(r.ItemTypeFilter[L]){case r.ItemTypeFilter.photo:w=!0;i&&(C?f.push(d("File_x0020_Type","String",i.photo.extensions,!0)):u.push(d("File_x0020_Type","String",i.photo.extensions,!1)));break;case r.ItemTypeFilter.video:i&&(C?f.push(d("File_x0020_Type","String",i.video.extensions,!0)):u.push(d("File_x0020_Type","String",i.video.extensions,!1)));break;case r.ItemTypeFilter.folder:E+=C?-1:1;break;case r.ItemTypeFilter.onenote:C?o.push(c):s.push(l)}}else switch(T){case r.ItemTypeFilter.photo:case r.ItemTypeFilter["!photo"]:w=!0;i&&(T<0?f.push(d("File_x0020_Type","String",i.photo.extensions,!0)):u.push(d("File_x0020_Type","String",i.photo.extensions,!1)));break;case r.ItemTypeFilter.video:case r.ItemTypeFilter["!video"]:i&&(T<0?f.push(d("File_x0020_Type","String",i.video.extensions,!0)):u.push(d("File_x0020_Type","String",i.video.extensions,!1)));break;case r.ItemTypeFilter.folder:case r.ItemTypeFilter["!folder"]:E+=T<0?-1:1;break;case r.ItemTypeFilter.onenote:case r.ItemTypeFilter["!onenote"]:T<0?o.push(c):s.push(l)}}var M;if(a.doExtFiltersHaveMediaTypesOnly({extFilters:e,allowedMediaTypes:[r.ItemTypeFilter.photo,r.ItemTypeFilter.video],fileTypeIconMap:i})){s=u;o=f;var _=b.filter(function(e){return v.indexOf(e)>=0});!w&&_&&_.length>0&&(_.length>1?s.push(d("File_x0020_Type","String",_,!1)):s.push('<In><FieldRef Name="File_x0020_Type" /><Values><Value Type="String">'+_[0]+"</Value></Values></In>"))}else{h.length>0&&s.push(d("File_x0020_Type","",h,!1));m.length>0&&o.push(d("File_x0020_Type","",m,!0))}return p([E>0?'<Or><And><Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq><Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq></And><Eq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq></Or>':"",(M=n.__spreadArrays([p(s)],o,[E<0?'<And><Neq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Neq><Neq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Neq></And>':""]),M.reduce(function(e,t){return e&&t?"<And>"+e+t+"</And>":t||e},""))])}t.getTypeFilterViewXml=h;function p(e){return e.reduce(function(e,t){return e&&t?"<Or>"+e+t+"</Or>":t||e},"")}function d(e,t,n,r){if(!n||0===n.length)return"";var i='<FieldRef Name="'+e+'" />',s=t?n.map(function(e){return'<Value Type="'+t+'">'+e+"</Value>"}):n;return 1===s.length?(r?"<Neq>":"<Eq>")+i+s[0]+(r?"</Neq>":"</Eq>"):"<In>"+i+"<Values>"+s.join("")+"</Values></In>"}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemTypeFilter",["require","exports","tslib","@ms/odsp-graph/lib/models/item/IItemTypeFilter"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpersBasic",["require","exports","@ms/odsp-utilities/lib/killswitch/Killswitch","../../../utilities/caml/CamlParsingBasic","../../../utilities/caml/CamlConstants"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=new(0,window.XMLSerializer);s=function(){return e};return e};(function(e){e[e.none=0]="none";e[e.contextInfo=1]="contextInfo";e[e.listData=2]="listData";e[e.addToOneDrive=1048576]="addToOneDrive";e[e.listSchema=4]="listSchema";e[e.menuView=8]="menuView";e[e.listContentType=16]="listContentType";e[e.fileSystemItemId=32]="fileSystemItemId";e[e.clientFormSchema=64]="clientFormSchema";e[e.quickLaunch=128]="quickLaunch";e[e.spotlight=256]="spotlight";e[e.visualization=512]="visualization";e[e.viewMetadata=1024]="viewMetadata";e[e.disableAutoHyperlink=2048]="disableAutoHyperlink";e[e.mediaInfo=4096]="mediaInfo";e[e.parentFolderInfo=8192]="parentFolderInfo";e[e.pageContextInfo=16384]="pageContextInfo";e[e.clientSideComponentManifest=32768]="clientSideComponentManifest";e[e.listAvailableContentTypes=65536]="listAvailableContentTypes";e[e.folderContentTypeOrder=131072]="folderContentTypeOrder";e[e.gridInitInfo=262144]="gridInitInfo";e[e.SPFXCustomActions=2097152]="SPFXCustomActions";e[e.customActions=4194304]="customActions"})(t.RenderOptions||(t.RenderOptions={}));t.getRenderOption=function(e){var t=e.disableAutoHyperlink,r=e.fieldNames,i=void 0===r?[]:r,s=e.needsSchema,o=e.needsContentTypes,u=e.needsListAvailableContentTypes,a=e.needsContentTypeOrder,f=e.needsGridInitInfo,l=e.needsForms,c=e.needsQuickLaunch,h=e.needsSpotlight,p=e.needsViewMetadata,d=e.needsParentInfo,v=e.needsMountPoint,m=e.requestToken,g=e.isListDataRenderOptionChangeFeatureEnabled,y=e.isSpotlightFeatureEnabled,b=e.needUpdatePageContext,w=e.webTemplate,E=e.needClientSideComponentManifest,S=e.renderCustomActions,x=e.renderSpfxCustomActions,T=0;if(s||m){if(s){T|=7;g&&(T|=4096)}else T|=2;i.indexOf("name.FileSystemItemId")>-1&&(T|=32)}o&&(T|=16);u&&(T|=65536);a&&(T|=131072);f&&(T|=262144);n.Killswitch.isActivated("A85D5D14-0370-47F2-85F7-5D1365D6BEDB","4/23/2018","include spotlight regardless the webTemplate")?y&&h&&w&&"21"!==w&&(T|=258):y&&h&&(T|=258);l?T|=64:g&&(T|=4098);c&&(T|=128);p&&(T|=1536);d&&(T|=8192);v&&(T|=1048576);b&&(T|=16384);E&&(T|=32768);t&&(T|=2048);S&&(T|=4194304);x&&(T|=2097152);return T};t.getOverrideViewXml=function(e){var t="",n=e.groupByField,r=e.disableGrouping,i=e.fetchNextGroupXml,s=e.additionalFiltersXml;r?t="<GroupBy />":n&&(t='<GroupBy Collapse="FALSE"><FieldRef Name="'+n+'"/></GroupBy>');var o="";i&&(o=i);s&&(o=o?"<And>"+o+s+"</And>":s);o&&(t+="<Where>"+o+"</Where>");return t&&"<Query>"+t+"</Query>"};t.getCombinedViewXml=function(e){var t=e.viewXml,n=e.additionalFiltersXml;if(t&&n)try{var o=r.getViewDomParts(t),u=o.where;if(!u){u=o.xmlDoc.createElement(i.CamlTags.where);o.query.appendChild(u)}u.innerHTML=u.innerHTML?"<And>"+u.innerHTML+n+"</And>":n;t=s().serializeToString(o.view)}catch(e){}return t}});
define("@ms/odsp-datasources/lib/utilities/caml/CamlParsingBasic",["require","exports","./CamlConstants","./CamlUtilities","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewDomParts=function(e){void 0===e&&(e="<View/>");var t,i,s,o,u,a,f,l,c=r.xmlToDom(e),h=c.documentElement;if(h.tagName!==n.CamlTags.view)throw new Error('View XML outer element tag name must be "View" (case-sensitive)');for(var p=0,d=h.childNodes.length;p<d;p++){(m=h.childNodes[p]).nodeType===Node.ELEMENT_NODE&&(m.tagName!==n.CamlTags.viewFields||t?m.tagName!==n.CamlTags.query||i?m.tagName!==n.CamlTags.rowLimit||s?m.tagName===n.CamlTags.newDocumentTemplates?o=m:m.tagName===n.CamlTags.aggregations?u=m:m.tagName===n.CamlTags.viewType2?a=m:m.tagName===n.CamlTags.gridLayout?f=m:m.tagName===n.CamlTags.associatedContentTypeId&&(l=m):s=m:i=m:t=m)}if(!t){t=c.createElement(n.CamlTags.viewFields);h.appendChild(t)}if(!i){i=c.createElement(n.CamlTags.query);h.appendChild(i)}u&&h.appendChild(u);var v={xmlDoc:c,view:h,query:i,viewFields:t,rowLimit:s,newDocumentTemplates:o,aggregations:u,viewType2:a,gridLayout:f,associatedContentTypeId:l};for(p=0,d=i.childNodes.length;p<d;p++){var m;(m=i.childNodes[p]).nodeType===Node.ELEMENT_NODE&&(m.tagName!==n.CamlTags.orderBy||v.orderBy?m.tagName!==n.CamlTags.groupBy||v.groupBy?m.tagName!==n.CamlTags.where||v.where||(v.where=m):v.groupBy=m:v.orderBy=m)}return v};t.parseViewFields=function(e){if(e){return Array.prototype.map.call(e.childNodes,function(e){return e.tagName===n.CamlTags.fieldRef?r.getAttr(e,n.CamlAttributes.name):void 0}).filter(function(e){return!!e})}};t.parseAggregations=function(e){if(e){var t={};t[n.CamlAttributes.name]=[];t[n.CamlAttributes.type]=[];for(var i=e.childNodes,s=0;s<i.length;s++){var o=i[s],u=r.getAttr(o,n.CamlAttributes.type);if(o.tagName===n.CamlTags.fieldRef&&u.length>0){t[n.CamlAttributes.name].push(r.getAttr(o,n.CamlAttributes.name));t[n.CamlAttributes.type].push(u)}}return t}};t.parseAggregationsToGetEffectiveAggregatesFieldsXml=function(e){if(e){for(var t="",s=e.childNodes,o=0;o<s.length;o++){var u=s[o],a=r.getAttr(u,n.CamlAttributes.type);if(u.tagName===n.CamlTags.fieldRef&&a.length>0){var f=r.getAttr(u,n.CamlAttributes.name);t+=i.format(n.CamlConstants.aggregationsField,f,a)}}return t.length?t:void 0}};t.containSmartFilters=function(e){var t=!1,n=e.where;if(n&&n.childElementCount){var r=n.querySelectorAll("[id]");r&&r.length&&(t=!0)}return t};t.parseAssociatedContentTypeId=function(e){if(e)return e.innerHTML}});
define("@ms/odsp-datasources/lib/utilities/caml/CamlConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CamlTags={view:"View",viewFields:"ViewFields",rowLimit:"RowLimit",query:"Query",columnWidth:"ColumnWidth",orderBy:"OrderBy",groupBy:"GroupBy",where:"Where",associatedContentTypeId:"AssociatedContentTypeId",and:"And",or:"Or",beginsWith:"BeginsWith",contains:"Contains",dateRangesOverlap:"DateRangesOverlap",eq:"Eq",greater:"Gt",greaterEq:"Geq",includes:"Includes",inTag:"In",isNotNull:"IsNotNull",isNull:"IsNull",less:"Lt",lessEq:"Leq",membership:"Membership",notEq:"Neq",notIncludes:"NotIncludes",fieldRef:"FieldRef",value:"Value",values:"Values",today:"Today",customFormatter:"CustomFormatter",newDocumentTemplates:"NewDocumentTemplates",aggregations:"Aggregations",viewType2:"ViewType2",gridLayout:"GridLayout"};t.CamlAttributes={name:"Name",collapse:"Collapse",ascending:"Ascending",type:"Type",includeTimeValue:"IncludeTimeValue",paged:"Paged",offset:"Offset",offsetDays:"OffsetDays",lookupId:"LookupId",id:"id",width:"width",value:"Value"};t.CamlConstants={doctype:"application/xml",fieldNameQuery:'FieldRef[Name="{0}"]',datetimeRegex:/^(\d{4}-\d{2}-\d{2})T\d{2}:\d{2}:\d{2}Z$/,datetimeNoTimeRegex:/^(\d{4}-\d{2}-\d{2})T00:00:00Z$/,dateRegex:/^\d{4}-\d{2}-\d{2}/,todayRegex:/^\[today\]([+-]\d+)?$/i,aggregationsField:'<FieldRef Name="{0}" Type="{1}"/>'};t.default=t.CamlConstants});
define("@ms/odsp-datasources/lib/utilities/caml/CamlUtilities",["require","exports","./CamlConstants"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;window.DOMParser&&(r=new DOMParser);function i(e,t){var n=e.attributes[t]||e.attributes[t.toLowerCase()];if(n&&n.value&&n.name===t)return n.value}t.getAttr=i;function s(e,t){var r=e.createElement(n.CamlTags.fieldRef);r.setAttribute(n.CamlAttributes.name,t.fieldName);"boolean"==typeof t.isAscending&&r.setAttribute(n.CamlAttributes.ascending,t.isAscending?"TRUE":"FALSE");"boolean"==typeof t.lookupId&&r.setAttribute(n.CamlAttributes.lookupId,t.lookupId?"TRUE":"FALSE");return r}t.getFieldRefDom=s;function o(e,t,n){"boolean"==typeof n?e.setAttribute(t,n?"TRUE":"FALSE"):e.removeAttribute(t)}t.updateBooleanAttr=o;t.replaceField=function(e,t,r,u){if(r&&i(r,n.CamlAttributes.name)===t.fieldName)o(r,n.CamlAttributes.ascending,t.isAscending);else{var a=s(e,t);r?u.replaceChild(a,r):u.appendChild(a)}};t.combineFilters=function(e,t){void 0===t&&(t=n.CamlTags.and);if(e&&e.length){return""+new Array(e.length).join("<"+t+">")+e[0]+e.slice(1).map(function(e){return e+"</"+t+">"}).join("")}return""};t.xmlToDom=function(e){var t;try{t=r.parseFromString(e,n.CamlConstants.doctype)}catch(e){throw new Error("Invalid XML (exception thrown)")}if(!t.documentElement)throw new Error("Invalid XML (documentElement does not exist)");if(t.querySelector("parsererror"))throw new Error("Invalid XML (parsererror found)");return t};t.isTodayString=function(e){return n.CamlConstants.todayRegex.test(e)};t.getTodayOffset=function(e){var t=e&&e.match(n.CamlConstants.todayRegex);if(t){return parseInt(t[1],10)||0}return null};t.getTodayString=function(e){var t="[Today]";e&&(t+=(e>0?"+":"")+e);return t}});
define("odsp-next/utilities/hash/SimpleHash",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hashCode=function(e){var t=0;if(!e||0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t&=t}return t}});
define("odsp-next/dataSources/compliance/ComplianceTagDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../base/odb/DataRequestor","../../resources/SPOResourceKeys","../url/odb/ApiUrlHelper","../url/odb/ItemUrlHelper","../../utilities/complianceTag/ComplianceTagUtilities","./ComplianceTagDataSource.resx","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/logging/events/Verbose.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._dataRequestor=new s.default({qosName:"ComplianceTagDataSource"},{pageContext:r._pageContext});return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this._dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.default.wrapError(l.default.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){h.Verbose.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return i.default.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this._dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.default.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:s,isTagSuperLock:t.superLock});return this._dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.default.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return f.isUnlockRecordTurnedOn(t)}return!1},function(e){return i.default.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return f.isUnlockRecordTurnedOn(t)}return!1},function(e){return i.default.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:l.default.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:l.default.NoneComplianceTagDescription,tagTooltip:l.default.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:""};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=f.getTagDescription(s),u=f.getTagTooltip(s),a={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:u,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId};t.push(a)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pageContext:o.pageContext,apiUrlHelper:u.resourceKey,itemUrlHelper:a.resourceKey});return t})(r.default);t.default=p;t.resourceKey=c.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/dataSources/url/odb/ApiUrlHelper",["require","exports","../../../resources/SPOResourceKeys","./ItemUrlHelper","@ms/odsp-datasources/lib/utilities/url/ApiUrlHelper","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.default.isActivated("335D0ECA-48E7-459E-9687-BE609CBBC94E","10/24/2018","Encode webUrl for api of $batch's additionalPostData");t.encodeWebAbsoluteUrlHelperKey=new s.ResourceKey({name:e("module").id+".encodeWebAbsoluteUrl",factory:new s.ConstantResourceFactory(!u)});t.resourceKey=s.createResolvedResourceKey(e("module").id,i.ApiUrlHelper,{itemUrlHelper:r.resourceKey,pageContext:n.pageContext,encodeWebAbsoluteUrl:t.encodeWebAbsoluteUrlHelperKey});t.default=i.ApiUrlHelper});
define("odsp-next/models/clientForm/ClientFormHelper",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertGroup=function e(t){if(t){var r=t.fieldSchema,i=t.children,s=n.__rest(t,["fieldSchema","children"]);return n.__assign({fieldSchema:r?n.__assign(n.__assign({},r),{Name:r.Name}):void 0,children:i?i.map(e):void 0},s)}}});
define("odsp-next/controls/infoPane/notification/SectionNotification",["require","exports","./SectionNotification.html","./SectionNotificationViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-section-notification",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/infoPane/notification/SectionNotification.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SectionNotification" data-bind="css:backgroundCss"><i class="od-SectionNotification-icon ms-Icon" role="img" data-bind="css:iconClass,attr:{\'aria-label\':iconAriaLabel}"></i><div class="od-SectionNotification-text"><span data-bind="text:text" role="status"></span></div></div>'});
define("odsp-next/controls/infoPane/notification/SectionNotificationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.notificationText;n.iconClass=i.getIconClassName(t.iconName||"Error");n.iconAriaLabel=t.sectionNotificationIconAriaLabel?t.sectionNotificationIconAriaLabel:"";n.backgroundCss=t.notificationBackgroundCss?t.notificationBackgroundCss:"";return n}return t})(r.default);t.default=s});
define("odsp-next/actions/splist/EditItemAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../odb/ActionHelper","../../resources/SPOResourceKeys","../../controls/clientForm/ClientFormDialog","../../resources/ControlResourceKeys","../../base/BaseAction","../../resources/DataSourceResourceKeys","../base/ItemCommandHelper","../../providers/clientForm/ClientFormProvider","../../models/item/command/MetadataItemCommandKeys","../../models/item/ItemParentHelper","../../providers/dialog/DialogProvider","../base/ItemSelectionHelper","../../utilities/features/Features","../../providers/engagement/Engagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="EditItemAction";r._isFullPageApp=!!t.isFullPageApp;r._isBulkEdit=!!t.isBulkEdit;r._dialogProvider=r.resources.consume(g.resourceKey);r._itemParentHelper=r.resources.consume(m.resourceKey);r._itemCommandHelper=r.resources.consume(p.resourceKey);r._pageContext=r.resources.consume(a.pageContext);r._actionMap=r.resources.consume(l.actionMap);r._urlDataSource=r.resources.consume(h.url);r._itemSelectionHelper=new(r.child(y.typeResourceKey))({allowMultiSelect:b.isFeatureEnabled(b.SPBulkEditItemCommand),canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._itemSelectionHelper.firstItem(),n=t&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return!(b.isFeatureEnabled(b.SPBulkEditItemCommand)&&n&&n.list&&this._isBulkEdit&&this._itemSelectionHelper.selection().length<=1)&&(!!t&&!!n&&!!n.list&&n.list.templateType!==o.default.mySiteDocumentLibrary&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,v.editItem)&&i.PermissionMask.hasItemPermission(t,i.PermissionMask.editListItems)}))};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:if(!(t=n.sent())||!t.length)return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];b.isFeatureEnabled(b.SPBulkEditItemCommand)&&this.resources.consume(w.resourceKey).logData({name:"EditItem",isIntentional:!0,extraData:{isBulkEdit:t.length>1}});i=t[0];return t.length>1?[2,this._editInFullPageClientForm(i,e,!0)]:u.default.isCheckedOutByOther(i,this._pageContext.userId)?[2,u.default.showCheckedOutByOtherDialog(this._dialogProvider)]:[2,this._editInFullPageClientForm(i,e)]}})})};t.prototype._editInFullPageClientForm=function(e,t,n){return this._actionMap||n?new(this.managed(this._actionMap.LaunchListFormAction))({type:1,item:e,selection:n?this._itemSelectionHelper.selection():void 0,url:this._urlDataSource.getEditFormUrl(e),isFullPageApp:this._isFullPageApp}).execute(t):this._editInClientFormDialog(e)};t.prototype._editInClientFormDialog=function(e){var t=this;return this.resources.consume(d.resourceKey).getClientForm({item:this.observables.create(e),clientFormType:1,contentType:e.properties.ContentType}).then(function(e){var n=t.resources.consume(g.resourceKey);return f.default.getDialog(e,n,t.resources).wait()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t})(c.default);t.default=E});
define("odsp-next/controls/clientForm/ClientFormDialog",["require","exports","knockout","@ms/odsp-utilities/lib/async/Promise","./DuplexClientForm","./ClientForm.resx","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}e.getDialog=function(e,t,u){var a=null;return t.requestDialog({title:s.default.TitleLabel,actions:[{name:s.default.SaveLabel,icon:new o.default("Save"),execute:function(){null===a&&r.default.wrap(1);return a.processAndSaveChanges().then(function(e){return e?2:1})},isAvailable:n.observable(!0),isDefault:!1,automationId:"saveClientFormDialog"},{name:s.default.CancelLabel,icon:new o.default("Cancel"),execute:function(){return r.default.wrap(3)},isAvailable:n.observable(!0),isDefault:!0,automationId:"cancelClientFormDialog"}],component:{name:i.getClientFormTagName(u),params:{clientForm:e,interactiveSave:!1,fieldsManagerAccessor:function(e){a=e}}},size:"XLarge"})};return e})();t.default=u});
define("odsp-next/controls/refreshClientForm/RefreshClientForm.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".RefreshClienForm",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/controls/detailsPane/section/itemShortcut/ItemShortcutSection",["require","exports","tslib","react","../../../infoPane/sections/shortcutInformation/ShortcutInformationSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSection",["require","exports","./ShortcutInformationSection.html","./ShortcutInformationSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-shortcutInformation-info-pane-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-shortcutInformation-info-pane-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="InfoPane-section InfoPaneSection--shortcutInformation" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:strings.informationHeader"></span></div><div class="InfoPane-sectionContent InfoPaneSection-shortcutInformation"><table><tbody>\x3c!--ko if:targetFileType()--\x3e<tr><th data-bind="text:strings.informationFiletype"></th><td data-bind="text:targetFileType"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if:targetModified()--\x3e<tr class="InfoPaneSection-information-groupPadding"><th data-bind="text:strings.informationModified"></th><td data-bind="text:targetModified"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if:targetContainerPath()&&targetContainerName()--\x3e<tr><th data-bind="text:strings.informationPath"></th><td><a class="InfoPaneSection-information-targetPath" data-bind="text:targetContainerName,click:targetPathOnClick,attr:{href:targetContainerPath}" target="_blank"></a></td></tr>\x3c!--/ko--\x3e\x3c!--ko ifnot:targetContainerPath()&&targetContainerName()--\x3e<tr><th data-bind="text:strings.informationPath"></th><td><div data-bind="foreach:{data:path}"><span class="InfoPaneSection-information-path" data-bind="text:$data"></span></div></td></tr>\x3c!--/ko--\x3e</tbody></table></div></div>'});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/infoPane/InfoPane.resx","@ms/odsp-utilities/lib/dateTime/DateTime","../../../../providers/engagement/Engagement","../../../../providers/item/ShortcutProvider","../../../../models/item/ItemHelper","../../../../resources/DataSourceResourceKeys","../../SectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.strings=i.default;r.sectionHelper=new(r.managed(l.default));var s=r.observables,a=r.resources;r.targetItem=s.create(null);r._shortcutProvider=a.consume(u.resourceKey);r._urlDataSource=a.consume(f.url);s.compute(r._computeTargetItem);r._fileType=s.pureCompute(r._computeFileType);r._modified=s.pureCompute(r._computeModified);r.targetFileType=s.pureCompute(r._computeTargetFileType);r.targetModified=s.pureCompute(r._computeTargetModified);r.targetContainerPath=s.pureCompute(r._computeTargetContainerPath);r.targetContainerName=s.pureCompute(r._computeTargetContainerName);r.path=s.pureCompute(r._computePath);r.targetPathOnClick=function(){r.resources.consume(o.resourceKey).logData({name:"TargetPath.ShortcutInformation.Click",isIntentional:!0});return!0};return r}t.prototype._computeTargetItem=function(){var e=this._item(),t=this._shortcutProvider,n=this.targetItem;n(null);t.getShortcutTargetData(e.id).then(function(e){return t.getFileByUrl(e.url)}).then(function(e){n(e)})};t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType)return a.getFriendlyItemType(e)};t.prototype._computeModified=function(){var e=this._item();if(!this._urlDataSource.isRecycleBin(e.queryType))return e.dateModifiedTime?s.getFullDisplayDate(e.dateModifiedTime):e.dateModified};t.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeTargetFileType=function(){var e=this.targetItem();return e?a.getShortcutFileType(e.Name):this._fileType()};t.prototype._computeTargetModified=function(){var e=this.targetItem();return e?s.getFullDisplayDate(e.TimeLastModified):this._modified()};t.prototype._computeTargetContainerPath=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=e.ServerUrl,r=t.lastIndexOf("/");return n+(r>0?t.slice(0,r):t)}};t.prototype._computeTargetContainerName=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=t.lastIndexOf("/"),r=t.lastIndexOf("/",n-1);return t.slice(r+1,n)}};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=c});
define("odsp-next/controls/detailsPane/section/itemPolicy/ItemPolicySection",["require","exports","tslib","react","../../../infoPane/sections/policyTip/PolicyTipSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSection",["require","exports","./PolicyTipSection.html","./PolicyTipSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-policy-tip-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-policy-tip-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-PolicyTipSection InfoPane-section is-expanded">\x3c!--ko if:!isPolicyTipPanelEnabled--\x3e<div class="InfoPane-sectionContent" data-bind="css:backgroundClass"><i class="od-PolicyTipSection-icon ms-Icon" data-bind="css:iconClass"></i><div class="od-PolicyTipSection-text"><span data-bind="text:text"></span>\x3c!--ko if:hasTip--\x3e<br><a href="javascript:" data-bind="click:onViewTipClick,text:viewTipLink"></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:isPolicyTipPanelEnabled&&policyTipInfo()--\x3e\x3c!--ko component:{name:policyTipMessageBarTagName,params:policyTipMessageBarParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:\'ms-panel-host\'}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSectionViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../../resources/DataSourceResourceKeys","../../../../utilities/features/Features","../../InfoPane.resx","../../../../providers/panel/PanelProvider","../../../../models/item/Item.resx","../../../policyTipMessageBar/PolicyTipMessageBar","../../../policyTipPanel/PolicyTipPanel","@ms/odsp-utilities/lib/modules/ModuleHelper","@ms/odsp-shared/lib/base/ViewModel","../../../../utilities/policyTip/PolicyTipHelper","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(t){n.__extends(m,t);function m(e,n){void 0===n&&(n={});var c=t.call(this,e,n)||this,h=c._item=e.item;c.viewTipLink=u.default.policyTipLaunchDialogLink;var p=c.observables,m=c.resources;m.bind(a.resourceKey);c._panelProvider=m.consume(a.resourceKey.local);c._policyTipDataSource=m.consume(s.policyTip);c.isPolicyTipPanelEnabled=o.isFeatureEnabled(o.PolicyTipPanel);c.policyTipMessageBarTagName=l.default.tagName;c.policyTipMessageBarParams={item:h.peek(),onClick:c.onViewTipClick.bind(c)};c.policyTipInfo=p.create(null);if(c.isPolicyTipPanelEnabled){var g=new r.default;p.compute(function(){var e=h();g.debounce(c.trackPromise(c._policyTipDataSource.getPolicyTip(e).then(function(e){c.policyTipInfo(e)})))})}c.backgroundClass=p.pureCompute(function(){var e=h();if(!e||!e.policyTip)return"";var t=d.isPolicyTipFlagSet(e.policyTip,2),n=d.isPolicyTipFlagSet(e.policyTip,1);return t?"od-PolicyTipSection--block":n?"od-PolicyTipSection--notify":void 0});c.iconClass=p.pureCompute(function(){var e=h();if(!e||!e.policyTip)return"";var t=d.isPolicyTipFlagSet(e.policyTip,2),n=d.isPolicyTipFlagSet(e.policyTip,1);return t?v.getIconClassName("DRM")+" ms-fontColor-redDark":n?v.getIconClassName("IncidentTriangle")+" ms-fontColor-orange":void 0});c.text=p.pureCompute(function(){var e=h();if(!e||!e.policyTip)return"";var t=d.isPolicyTipFlagSet(e.policyTip,2),n=d.isPolicyTipFlagSet(e.policyTip,1);return t?f.default.policyTipBlockText:n?f.default.policyTipNotifyText:void 0});c.hasTip=p.pureCompute(function(){return!!(1&h().policyTip)});c.subscribe(h,function(e){e.policyTip&&i.Engagement.logData({name:"PolicyTip.InfoPaneSection.Shown"})});return c}m.prototype.onViewTipClick=function(t){var n=this,r=this._item.peek();if(!this.isPolicyTipPanelEnabled){i.Engagement.logData({name:"PolicyTip.InfoPaneSection.ViewTip.Click"});new Promise(function(t,n){e(["../../../../actions/PolicyTipAction"],t,n)}).then(h.getDefaultExport).then(function(e){new(n.resources.injected(e))({item:n.observables.create(r)}).execute(t)});return!1}var s={item:r,policyTipInfo:this.policyTipInfo.peek()};this._panelProvider.requestPanel({component:{name:c.default.tagName,params:s}})};m.dependencies=n.__assign({},p.default.dependencies);return m})(p.default);t.default=m});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBar",["require","exports","./PolicyTipMessageBar.html","./PolicyTipMessageBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-policy-tip-message-bar",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBar.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasPolicyTip()--\x3e<div class="od-PolicyTipMessageBar" data-bind="css:{\'od-PolicyTipMessageBar-block\':isBlock,\'od-PolicyTipMessageBar-severeWarning\':isNotify,\'od-PolicyTipMessageBar-warning\':isInfo}"><div class="od-PolicyTipMessageBar-content"><div class="od-PolicyTipMessageBar-icon"><i class="ms-Icon" data-bind="icon:true,css:{\'ms-Icon--Blocked2\':isBlock,\'ms-Icon--Warning\':isNotify,\'ms-Icon--Info\':isInfo}"></i></div><div class="od-PolicyTipMessageBar-text"><span data-bind="text:messageBarText"></span><a role="button" class="od-Link" href="javascript:;" data-bind="text:messageBarActionText,click:messageBarAction"></a></div></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBarViewModel",["require","exports","tslib","../../utilities/policyTip/PolicyTipHelper","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.item,s=t.onClick;n.item=i;n.onClick=s;var o=i.policyTip,u=r.isPolicyTipFlagSet(o,2),a=r.isPolicyTipFlagSet(o,1);n.isBlock=u;n.isNotify=!u&&a;n.isInfo=!u&&!a;n.hasPolicyTip=n.observables.create(!!o);n.messageBarAction=n.onClick;n.messageBarActionText=r.getPolicyTipActionText();n.messageBarText=r.getPolicyTipText(o);return n}return t})(i.default);t.default=s});
define("odsp-next/controls/detailsPane/section/itemSharing/ItemSharingSection",["require","exports","tslib","react","../../../infoPane/sections/sharing/SharingSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t})(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/sharing/SharingSection",["require","exports","./SharingSection.html","./SharingSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","ODCDeferred_css","../../../persona/Persona","../../../sharing/sharingLink/SharingLink"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-sharing-info-pane-section",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-sharing-info-pane-section",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/infoPane/sections/sharing/SharingSection.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:!sharingApiErrorMessage()--\x3e<div class="od-SharingSection-PermissionsPile" role="group" data-bind="attr:{\'aria-label\':sharingSectionSummary}"><div class="InfoPane-sectionHeader"><h2 class="InfoPane-sectionHeaderText" data-bind="text:strings.sharingHasAccess"></h2></div>\x3c!--ko if:isLoading()--\x3e<div class="SharingSection-status" data-bind="text:statusText"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<div class="od-SharingSection-PermissionsPile-personas">\x3c!--ko if:isShareLinkVisible--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:addPeopleText},keyboard:{Enter:onShareClick,Space:onShareClick},click:onShareClick,attr:{\'aria-label\':addPeopleScreenReaderText}"><div class="od-SharingSection-PermissionsPile-addFriend"><i class="ms-Icon ms-Icon--AddFriend" data-bind="icon:true"></i></div></div>\x3c!--ko if:isAddPeopleInReactEnabled&&shareCalloutActive()--\x3e<div data-bind="react:{componentType:shareCalloutComponent,props:shareCalloutProps}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!privateDescription()--\x3e<div class="od-PermissionPile-accessibleLabel" data-bind="text:accessSummaryScreenReaderText"></div><ul class="od-PermissionPile-FacePile">\x3c!--ko foreach:permissionsFacepileCollection--\x3e\x3c!--ko if:linkNum--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.linksDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText,setsize:$parent.totalFacePileCount(),posinset:index+1}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':$parent.hasMultiLinks()}"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true"></i>\x3c!--ko if:linkNum>1--\x3e<div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:linkNum.toString()"></div>\x3c!--/ko--\x3e</div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:groupNum>1--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.groupsDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':groupNum>1}"><i class="ms-Icon ms-Icon--Group" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:groupNum"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:personaTile&&(!groupNum||groupNum===1&&!$parent.showPermissionsPanel())--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:personaTile.personaParams.person().name},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-PersonaTile-Persona" data-bind="component:{name:\'od-persona\',params:personaTile.personaParams}"></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:extraPersona--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.extraPersonaTooltipText},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaMore"><div class="od-SharingSection-PermissionsPile-moreNumber" data-bind="text:$parent.extraPersonaText"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&isNewHasAccessControlEnable--\x3e<ul class="od-PermissionPile-FacePile"><li class="od-Persona od-Persona--xs od-Pointer"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder"><i data-bind="icon:true" class="ms-Icon ms-Icon--Lock"></i></div></li><li class="od-Persona od-Persona--xs od-HasAceessControl od-Pointer"><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></li></ul>\x3c!--/ko--\x3e</div>\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&!isNewHasAccessControlEnable--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Lock" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:hasGuest--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Globe" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:sharedWithGuestText"></div></div>\x3c!--/ko--\x3e<div class="ms-font-s"><a href="javascript:;" class="od-Link" data-bind="click:launchPermissionsPanel"><span data-bind="text:showPermissionsPanelHintText"></span></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionViewModel",["require","exports","tslib","../../../../providers/engagement/Engagement","../../../../bindings/html/BindableHtmlBinding","../../../../resources/ControlResourceKeys","../../InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../../bindings/toggle/ToggleBinding","../../../../bindings/tooltip/TooltipBinding","@ms/odsp-shared/lib/base/ViewModel","../../../overlays/panel/PanelOverlay","../../../dialogHost/DialogHost","./SharingSectionHelper","./SharingFacePileOption","../../../../bindings/keyboard/KeyboardBinding","../../../personaTile/PersonaTile","../../../../bindings/selection/SelectionBinding","../../../../bindings/react/ReactBinding","../../../../providers/peoplePicker/PeoplePickerProvider","../../../../utilities/peoplePicker/GraphPeoplePickerHelper","../../../../providers/sharing/SharingProvider","../../../../providers/suiteNav/SuiteNavProvider","../../../../providers/policyTip/PolicyTipProvider","../../../../controls/sharing/share/react/ShareCallout","office-ui-fabric-react/lib/Callout","../../../../utilities/features/Features","@ms/odsp-shared-sharing/lib/Share","../../../../providers/sharing/react/SharingStore","../../../../providers/peoplePicker/PeoplePickerProvider","../../../../dataSources/peoplePicker/odb/PeoplePickerDataSourceWithLivePeoplePickerHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var l=e.call(this,t,n)||this;l.personaTileTagName=m.default.tagName;l.panelOverlayTagName=c.default.tagName;l.dialogHostTagName=h.default.tagName;l.addBindingHandlers({toggle:a.default,bindableHtml:i.default,keyboard:v.default,selection:g.default,tooltip:f.default,react:y.default});l._engagement=l.resources.consume(r.resourceKey);var d=l.observables;l.permissionsFacepileCollection=d.createArray();l.infoPanePersonaTileCollection=d.createArray([]);l.groupPersonaTileCollection=d.createArray([]);l.peoplePersonaTileCollection=d.createArray([]);l.isExpanded=l.resources.consume(s.isSharingSectionExpanded.optional)||d.create(!0);l.strings=o.default;l.hasFocus=t.hasFocus;l.addPeopleText=o.default.addPeople;l.addPeopleScreenReaderText=o.default.addPeopleButtonName;l.openPanelActionText=o.default.openPanel;l.advancedText=o.default.advanced;l.stopSharingText=o.default.stopSharing;l.emailText=o.default.emailEveryone;l.showPermissionsPanel=d.create(!1);l.shouldShowLinks=d.create(!1);l.hasMultiLinks=d.create(!1);l.linksDetails=d.create("");l.groupsDetails=d.create("");l.numberOfGroups=d.create(0);l.totalFacePileCount=d.create(0);l.extraPersonaTooltipText=d.create("");l.showPermissionsPanelHintText=o.default.sharingOpenPermissionsPanelHintText;l.extraPersonaText=d.create("");l.extraPersonaNumber=d.create(0);l.sharedWithGuestText=o.default.sharingGuestShared;l.permissionsPanelName=o.default.sharingPermissionsPanelName;l.isAddPeopleInReactEnabled=C.isFeatureEnabled(C.AddPeopleReact);l.shareCalloutComponent=T.default;l.shareCalloutProps=l.createPureComputed(l._computeShareCalloutComponentProps);l.shareCalloutTarget=d.create(null);l.shareCalloutActive=d.create(!1);var b=t.item;l.item=b;var w=l._sharingSectionHelper=new(l.managed(p.default))({item:b,hasFocus:t.hasFocus});l.fileName=w.fileName;l.accessSummaryScreenReaderText=d.pureCompute(l._setAccessSummary);l.sharingSectionSummary=d.pureCompute(function(){return u.format(o.default.sharingSectionSummary,l.fileName())});l.privateDescription=w.privateDescription;l.hasInheritedLink=w.hasInheritedLink;l.isShareLinkVisible=w.isShareLinkVisible;l.isLoading=w.isLoading;l.scopes=w.scopes;l.links=w.links;l.canUnshare=w.canUnshare;l.personaTileCollection=w.personaTileCollection;l.hasSettings=w.hasSettings;l.advancedUrl=w.advancedUrl;l.keyNav=w.keyNav;l.mailto=w.mailto;l.showEmailLink=w.showEmailLink;l.sharingApiErrorMessage=w.sharingApiErrorMessage;l._totalNumberOfLinks=w.totalNumberOfLinks;l.statusText=w.statusText;l.hasGuest=l.createPureComputed(l._calculateExternalUser);l.accessSummaryScreenReaderText=d.pureCompute(l._setAccessSummary);l.sharingSectionSummary=d.pureCompute(function(){return u.format(o.default.sharingSectionSummary,l.fileName())});l._actionMap=l.resources.consume(s.actionMap);l._showAction=new(l.managed(l._actionMap.ShowPermissionsAction))({item:b,engagementSource:"InfoPane"});l.isNewHasAccessControlEnable=C.isFeatureEnabled(C.EnableNewHasAccessControl);d.compute(l._computeSparateGroupAndPeoplePersona);d.compute(l._calculateExtraPersona);d.compute(l._updateLinksData);return l}t.prototype.launchPermissionsPanel=function(e,t){this._engagement.logData({name:"ViewPermission.Sharing.InfoPaneSection.Click",isIntentional:!0});this._executeShowPermissionsPanel(t)};t.prototype.closeDialog=function(){this.onLinkRemoved()};t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};t.prototype.onShareClick=function(e,t){this._engagement.logData({name:"AddPeopleFromInfoPane.Sharing.InfoPaneSection.Click",isIntentional:!0});if(this.isAddPeopleInReactEnabled){this.shareCalloutTarget(t.target);this.shareCalloutActive(!0)}else this._sharingSectionHelper.onShareClick()};t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};t.prototype.onAdvancedClick=function(){this._engagement.logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing()};t.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.moreThanOneLink=function(){return this._totalNumberOfLinks()>1};t.prototype._updateLinksData=function(){var e=this._totalNumberOfLinks();this.linksDetails(this._getLinksDetails());var t=0!==e;this.shouldShowLinks(t);var n=e>1;this.hasMultiLinks(n)};t.prototype._getLinksDetails=function(){return this._totalNumberOfLinks()>1?u.format(o.default.sharingLinkTitleMulti,this._totalNumberOfLinks()):o.default.sharingLinkTitleSingle};t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};t.prototype._computeSparateGroupAndPeoplePersona=function(){var e=this.personaTileCollection(),t=[],n=[];if(!this.showPermissionsPanel())for(var r=0,i=e;r<i.length;r++){var s=i[r];2===s.personaParams.person().entityType?t.push(s):n.push(s)}this.groupPersonaTileCollection(t.slice());this.peoplePersonaTileCollection(n);this.numberOfGroups(t.length);this.groupsDetails(this._getGroupsDetails())};t.prototype._getGroupsDetails=function(){return this.numberOfGroups()>1?u.format(o.default.sharingGroupTitleMulti,this.numberOfGroups()):o.default.sharingGroupTitleSingle};t.prototype._getAllUsers=function(e){for(var t={},n=0,r=e;n<r.length;n++){t[(f=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f,l=a[u],c=(f=this._sharingSectionHelper.convertPersonToPersonaTile(this.createObservable(l),l.userId)).personaParams.person.peek().userId;if(!t[c]){t[c]=!0;e.push(f)}}}return e};t.prototype._calculateExternalUser=function(){for(var e=0,t=this.peoplePersonaTileCollection();e<t.length;e++){if(t[e].personaParams.person().isExternal)return!0}for(var n=0,r=this.links();n<r.length;n++){var i=r[n];if(5===i.kind||4===i.kind)return!0;for(var s=0,o=i.linkInvitees;s<o.length;s++){if(o[s].isExternal)return!0}}return!1};t.prototype._calculateExtraPersona=function(){var e=(0===this._totalNumberOfLinks()?0:1)+(0===this.numberOfGroups()?0:1),t=this._getAllUsers(this.peoplePersonaTileCollection()),n=t.length,r=0;if(1+e+t.length>7){n=7-e-2;r=6}else r=e+t.length;var i=t.length-n;this.extraPersonaNumber(i);i>=99?this.extraPersonaText(o.default.sharingExtraNumberOverflow):this.extraPersonaText(u.format(o.default.sharingExtraNumberText,i));this.extraPersonaTooltipText(u.format(o.default.sharingMoreTitle,i));this.infoPanePersonaTileCollection(t.slice(0,n));this.totalFacePileCount(r);this._setFacepileContent()};t.prototype._setAccessSummary=function(){var e=this._totalNumberOfLinks()+" "+u.getLocalizedCountValue(o.default.sharinglocTextLink,o.default.sharingIntervals,this._totalNumberOfLinks());e+=" "+this.numberOfGroups()+" "+u.getLocalizedCountValue(o.default.sharinglocTextGroup,o.default.sharingIntervals,this.numberOfGroups());for(var t=0,n=this.infoPanePersonaTileCollection();t<n.length;t++){e+=" "+n[t].personaParams.person().name}this.extraPersonaNumber()&&(e+=" "+u.format(o.default.sharingAccessSummaryMore,this.extraPersonaNumber()));this.hasGuest()?e+=" "+u.format(o.default.sharingAccessSummarySharedWithGuest,this.fileName()):this.privateDescription()&&(e+=" "+o.default.sharingAccessSummaryNotShared);return e};t.prototype._setFacepileContent=function(){var e=0,t=[],n=this.infoPanePersonaTileCollection();if(this.shouldShowLinks()){var r=u.format(o.default.sharingLinksScreenRead,this.linksDetails(),this.fileName()),i=new d.default({key:e,linkNum:this._totalNumberOfLinks(),screenReadText:this.createObservable(r)});t.push(i);e++}if(this.numberOfGroups()){var s=u.format(o.default.sharingGroupsScreenRead,this.groupsDetails(),this.fileName()),a=new d.default({key:e,groupNum:this.numberOfGroups(),screenReadText:this.createObservable(s),personaTile:this.groupPersonaTileCollection()[0]});t.push(a);e++}for(var f=0,l=n;f<l.length;f++){var c=l[f],h=c.personaParams.person().name,p=u.format(o.default.sharingPersonaScreenRead,h,this.fileName()),v=new d.default({key:e,screenReadText:this.createObservable(p),personaTile:c});t.push(v);e++}if(this.extraPersonaNumber()){var m=u.format(o.default.sharingExtraPeopleScreenRead,this.extraPersonaNumber().toString()),g=new d.default({key:e,extraPersona:this.extraPersonaNumber(),screenReadText:this.createObservable(m)});t.push(g);e++}this.permissionsFacepileCollection(t)};t.prototype._computeShareComponentProps=function(){var e,t=this.resources.consume(w.resourceKey),n=this.resources.consume(E.resourceKey),r=this.resources.consume(S.resourceKey),i=this.resources.consume(x.resourceKey);e=C.isFeatureEnabled(C.LivePersonaPickerEnabled)?new A.default({},{dataSource:this.resources.consume(O.resourceKey)}):this.resources.consume(b.resourceKey);if(this.item()){var s=this.item(),o=new L.default({item:this.item.peek(),accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:k.Mode.addPeople,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:r,peoplePickerProvider:e,policyTipProvider:i,graphPeoplePickerHelper:t});return{actionMap:this._actionMap,copyLinkShortcut:!1,item:s,peoplePickerProvider:e,graphPeoplePickerHelper:t,resources:this.resources,sharingInformation:null,sharingProvider:n,policyTipProvider:i,maxHeight:void 0,maxWidth:320,defaultRecipients:[],mode:k.Mode.addPeople,sharingStore:o}}};t.prototype._computeCalloutComponentProps=function(){var e=this;return{target:this.shareCalloutTarget(),directionalHint:N.DirectionalHint.leftTopEdge,gapSpace:6,onDismiss:function(){e.shareCalloutActive(!1)}}};t.prototype._computeShareCalloutComponentProps=function(){return{shareProps:this._computeShareComponentProps(),calloutProps:this._computeCalloutComponentProps()}};t.dependencies=n.__assign({},l.default.dependencies);return t})(l.default);t.default=M});
define("odsp-next/controls/infoPane/sections/sharing/SharingFacePileOption",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.focused=n.observable(!1);this.index=e.key;this.linkNum=e.linkNum;this.groupNum=e.groupNum;this.personaTile=e.personaTile;this.extraPersona=e.extraPersona;this.screenReadText=e.screenReadText;this._disablePictureAlt()}e.prototype._disablePictureAlt=function(){this.personaTile&&(this.personaTile.personaParams.disablePictrueAlt=!0)};return e})();t.default=r});
define("odsp-next/controls/sharing/share/react/ShareCallout",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/FocusTrapZone","./Share","react"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.calloutProps,t=this.props.shareProps;return o.createElement(r.Callout,n.__assign({},e),o.createElement(i.FocusTrapZone,{isClickableOutsideFocusTrap:!0},o.createElement(s.default,n.__assign({onDismiss:e.onDismiss},t))))};return t})(o.Component);t.default=u});
define("odsp-next/dataSources/peoplePicker/odb/PeoplePickerDataSourceWithLivePeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/dataSources/peoplePicker/spo/PeoplePickerDataSource","../../url/odb/ApiUrlHelper","../../../resources/SPOResourceKeys","../../base/graph/GraphDataRequestor","../../../providers/oAuthToken/OAuthTokenProvider","../../../utilities/peoplePicker/GraphPeoplePickerHelper","../../../utilities/peoplePicker/SubstratePeoplePickerHelper","../../../utilities/peoplePicker/LivePeoplePickerHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.PeoplePickerDataSource,{apiUrlHelper:i.resourceKey,pageContext:s.pageContext,dataRequestor:o.resourceKey,oAuthTokenProvider:u.resourceKey,graphPeoplePickerHelper:a.resourceKey,substratePeoplePickerHelper:f.resourceKey,livePeoplePickerHelper:l.resourceKey})});
define("odsp-next/utilities/peoplePicker/SubstratePeoplePickerHelper",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/peoplePicker/SubstratePeoplePickerHelper","../../providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/utilities/peoplePicker/SubstratePeoplePickerHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);t.resourceKey=i.createResolvedResourceKey(e("module").id,s.SubstratePeoplePickerHelper,{oAuthTokenProvider:o.resourceKey,pageContext:r.pageContext,sharingContextInformation:r.sharingContextInformation.optional})});
define("odsp-next/utilities/peoplePicker/LivePeoplePickerHelper",["require","exports","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/peoplePicker/LivePeoplePickerHelper","../../providers/oAuthToken/OAuthTokenProvider"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,i.LivePeoplePickerHelper,{oAuthTokenProvider:s.resourceKey,pageContext:n.pageContext})});
define("@ms/odsp-datasources/lib/utilities/peoplePicker/LivePeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider}e.prototype.getUserPrincipalName=function(){return this._pageContext.userLoginName};e.prototype.getLppOptions=function(){var e=this;return{hostAppPlatform:"Web",hostAppRing:this._pageContext.env2,hostAppName:"ShareDialog",clientCorrelationId:this._pageContext.CorrelationId,clientType:"ShareDialog",refreshAuthToken:function(){return e.getLokiToken()},offline:this._pageContext.isExternalGuestUser}};e.prototype.getLokiToken=function(){if(this._oAuthTokenProvider){var e=new r.Qos({name:"PeoplePicker.GetLokiToken"});return this._oAuthTokenProvider.getToken("https://loki.delve.office.com").then(function(t){e.end({resultType:r.ResultTypeEnum.Success});return t},function(t){if(n.default.isCanceled(t)){e.end({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(t)}e.end({resultCode:"PeoplePicker.GetLokiTokenError",resultType:r.ResultTypeEnum.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}})})}};return e})();t.LivePeoplePickerHelper=i});
define("odsp-next/controls/detailsPane/section/itemStatus/ItemStatusSection",["require","exports","react","office-ui-fabric-react/lib/Icon","../../../../controls/infoPane/InfoPane.resx","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.items.length>1?i.default.externalItemsMessage:i.default.externalItemMessage;return n.createElement("div",{className:"od-DetailsPane-LegacySection"},n.createElement("div",{className:"InfoPane-section InfoPaneSection--itemStatus no-arrow"},n.createElement(r.Icon,{className:"itemStatus-icon",iconName:"Globe"}),n.createElement("div",{className:"itemStatus-message"},t)))}});
define("odsp-next/controls/detailsPane/section/imageTags/ImageTagsSection",["require","exports","tslib","react","office-ui-fabric-react/lib/Pickers","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Text","office-ui-fabric-react/lib/Stack","../../../../dataSources/itemColumn/odb/ItemColumnDataSource.key","../../DetailsPane.resx","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._defaultTags=[];i._picker=r.createRef();i._onItemSelected=function(e){return e};i._onFilterChanged=function(e,t){return[{key:e,name:e}]};i._updateColumnData=function(e){return n.__awaiter(i,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:t=this;return[4,this.props.resources.consumeAsync(a.resourceKey)];case 1:t._itemColumnDataSource=n.sent();return[4,this._itemColumnDataSource.updateItemColumns(this.props.item,{MediaServiceAutoTags:e})];case 2:n.sent();return[2]}})})};if(t.item&&t.item.properties&&t.item.properties.MediaServiceAutoTags){i._currentTagString=t.item.properties.MediaServiceAutoTags;var s=i._currentTagString.split(",");s.length>0&&(i._defaultTags=s.map(function(e){return{key:e,name:e}}))}return i}t.prototype.render=function(){var e=this;return r.createElement("div",{className:"od-DetailsPane-ImageTagsSectionMargin"},r.createElement(u.Stack,{gap:5},r.createElement(s.Label,null,f.default.imageTagsSectionHeaderText),r.createElement(i.TagPicker,{defaultSelectedItems:this._defaultTags,componentRef:this._picker,removeButtonAriaLabel:f.default.imageTagsSectionRemoveButtonAriaLabel,onResolveSuggestions:this._onFilterChanged,getTextFromItem:this._getTextFromItem,pickerSuggestionsProps:{suggestionsHeaderText:f.default.imageTagsSectionSuggestionsHeaderText,noResultsFoundText:f.default.imageTagsSectionNoTagsFoundText},itemLimit:20,onItemSelected:this._onItemSelected,inputProps:{onBlur:function(t){return n.__awaiter(e,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:if(!this._picker.current)return[3,2];e=this._picker.current.items;return(t=this._buildColumnStringFromTags(e))===this._currentTagString?[3,2]:[4,this._updateColumnData(t)];case 1:n.sent();this._currentTagString=t;n.label=2;case 2:return[2]}})})}}}),r.createElement(o.Text,{variant:"small"},f.default.imageTagsSectionDescriptionText)))};t.prototype._getTextFromItem=function(e){return e.name};t.prototype._buildColumnStringFromTags=function(e){return void 0===e||0===e.length?"":e.map(function(e){return e.name}).join(", ")};return t})(r.Component);t.ImageTagsSection=l});
define("odsp-next/dataSources/itemColumn/odb/ItemColumnDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemColumnDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/detailsPane/section/malwareDetected/MalwareDetectedSection",["require","exports","tslib","react","../../../malwareDetected/malwareDetectedMessage/MalwareDetectedMessage"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(r.Fragment,null,i.malwareDetectedMessage())};return t})(r.Component);t.default=s});
define("odsp-next/controls/infoPane/sections/itemPublishWarning/ItemPublishingWarningComponent",["require","exports","tslib","react","office-ui-fabric-react/lib/MessageBar","../../../../resources/SPOResourceKeys","../../../../actions/odb/ActionHelper","../../InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._listContext=r.props.resources.consume(s.listContext);return r}t.prototype.render=function(){return this._publishingReminderText()?r.createElement(i.MessageBar,{messageBarType:i.MessageBarType.warning,isMultiline:!0},this._publishingReminderText()):null};t.prototype._publishingReminderText=function(){var e=this.props.item;if(void 0!==e){var t=119===this._listContext.listTemplateType||850===this._listContext.listTemplateType,n=o.default.getVersion(e,this._listContext),r=t?u.default.page:u.default.file,i=0===n.major?u.default.publish:u.default.republish;return!!this._listContext.isModerated?a.format(u.default.propertiesNotification_submitApproval,r):a.format(u.default.propertiesNotificaiton_publishing,i,r)}return""};return t})(r.Component);t.default=f});
define("odsp-next/controls/detailsPane/globalSettings/GlobalSettingsMenu",["require","exports","tslib","react","../../../resources/DataSourceResourceKeys","../../../models/item/ItemParentHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Dialog","../../../models/itemActivity/ItemActivityFeedHelper","../../../providers/itemActivities/ItemCommentsStore","../../../providers/engagement/Engagement","./GlobalSettingsMenu.resx","../../../utilities/features/Features","../../../models/item/SharingType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDeleteAllConfirm=function(){var e=r.props.items,t=r.state.currentUserEmail,n=r._getSelectedItem(e),i=r._getCommentItemWrapper(n);r._itemCommentsStore.deleteAllComments(i,t).done();r._onDismissDeleteAllDialog()};r._onDismissDeleteAllDialog=function(){r.setState({hideDeleteAlldialog:!0})};r._isNewHelperEnabled=d.isFeatureEnabled(d.ActivityFeedRefactoring);r._resources=t.resources;r._isNewHelperEnabled?r._itemActivityFeedHelper=r._resources.consume(i.itemActivityFeedHelper):r._oldItemActivityFeedHelper=new(r._resources.injected(l.default));r._itemCommentsStore=r._resources.consume(c.resourceKey);r._itemParentHelper=r._resources.consume(s.resourceKey);r._isCommentsInActivityFeedEnabled=d.isFeatureEnabled(d.EnableCommentsInActivityFeed);r._engagement=r._resources.consume(h.resourceKey);r.state={graphDataSource:r._resources.consume(i.graph.optional),hideDeleteAlldialog:!0,currentUserEmail:r._itemActivityFeedHelper.getCurrentUserEmail()};return r}t.prototype.componentDidMount=function(){var e=this;this.state.graphDataSource||this._resources.consumeAsync(i.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype.render=function(){var e=this.props.items,t=this._getSelectedItem(e),n=this._getMenuItems(t);return n?r.createElement(r.Fragment,null,r.createElement(u.TooltipHost,{content:p.default.globalSettingsOptionsLabel},r.createElement(o.IconButton,{className:"od-DetailsPane-GlobalSettingsMenu",role:"button",ariaLabel:p.default.globalSettingsOptionsLabel,iconProps:{iconName:"More"},onRenderMenuIcon:function(){},menuProps:{directionalHint:a.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:n,styles:{root:"od-DetailsPane-GlobalSettingsMenuItems"}}})),r.createElement(f.Dialog,{hidden:this.state.hideDeleteAlldialog,onDismiss:this._onDismissDeleteAllDialog,dialogContentProps:{type:f.DialogType.normal,title:p.default.confirmDeleteAllComments}},r.createElement(f.DialogFooter,null,r.createElement(o.DefaultButton,{disabled:!1,onClick:this._onDeleteAllConfirm,text:p.default.deleteButtonConfirm}),r.createElement(o.DefaultButton,{disabled:!1,primary:!0,onClick:this._onDismissDeleteAllDialog,text:p.default.deleteButtonCancel})))):null};t.prototype._getMenuItems=function(e){var t=this,n=this._getIsCommentDisabledSetting(e);if(e&&this._itemActivityFeedHelper.userCanManageCommentsSettings(e)){var r={key:"detailsPaneItem.enabledDisableComments",name:n?p.default.globalSettingsEnableComments:p.default.globalSettingsDisableComments,onClick:function(r,i){var s=!n,o=t._getCommentItemWrapper(e);t._itemCommentsStore.setCommentsDisabled(o,s,t.state.currentUserEmail);var u=e.folder?"folder":e.extension||"file",a=void 0!==e.sharingType?v.default[e.sharingType]:void 0;t._engagement.logData({name:"GlobalSettingsMenu."+(n?"CommentingEnabled":"CommentingDisabled"),isIntentional:!0,extraData:{itemType:u,sharingType:a}})}},i={key:"detailsPaneItem.deleteAllComments",name:p.default.globalSettingsDeleteAllComments,onClick:function(e,n){t.setState({hideDeleteAlldialog:!1})}},s=[r];n||"consumer"===this._itemActivityFeedHelper.getAPIEnvironment()||s.push(i);return s}};t.prototype._getSelectedItem=function(e){var t=1===e.length&&e[0].peek();return this._isNewHelperEnabled?t&&this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(t)?t:void 0:t&&l.isNonOfficeFileCommentsAvailable(t,this._isCommentsInActivityFeedEnabled)?t:void 0};t.prototype._getCommentItemWrapper=function(e){var t,n;if(this._isNewHelperEnabled)return this._itemActivityFeedHelper.getCommentItemWrapper(e,this.state.graphDataSource);t=this._oldItemActivityFeedHelper.getGraphItemUrl(e,this.state.graphDataSource);n=this._oldItemActivityFeedHelper.getAccessToken(e,this.state.graphDataSource);if(t&&n){var r=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list");return{item:e,activityItemWrapper:{name:e.displayName,graphItemUrl:t,accessToken:n},parentListId:r.peek().list&&r.peek().list.id}}};t.prototype._getIsCommentDisabledSetting=function(e){return e&&e.comments&&e.comments.settings&&!!e.comments.settings.isCommentDisabled};return t})(r.Component);t.default=m});
define("odsp-next/controls/detailsPane/pane/secondary/SecondaryPane",["require","exports","tslib","react","../../parentHeightWatcher/ParentHeightWatcher","office-ui-fabric-react/lib/Sticky","../../DetailsPane.resx","../../DetailsPaneSectionList","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","ODCDeferred_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={isSecondaryPaneHeaderFocused:!1};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.onHeaderClick,i=t.setHeaderDiv,o=this.state.isSecondaryPaneHeaderFocused,u=r.createRef();return r.createElement(r.Fragment,null,r.createElement("div",{ref:i},r.createElement(s.Sticky,{stickyPosition:s.StickyPositionType.Both},this.getHeaderButton(function(){var e;null===(e=u.current)||void 0===e||e.focus({preventScroll:!0});n()},o))),this.getHeaderButton(n,!1,u,function(){e.setState({isSecondaryPaneHeaderFocused:!0})},function(){e.setState({isSecondaryPaneHeaderFocused:!1})}))};t.prototype.getHeaderButton=function(e,t,n,i,s){var u=this.props,l=u.isHeaderDisabled,c=u.isHeaderClickDisabled,h=!!n;return r.createElement("button",{ref:n,className:f.css("od-DetailsPane-SecondaryPane-header",{"od-DetailsPane-SecondaryPane-header--disabled":l,"od-DetailsPane-SecondaryPane-header--headerClickDisabled":c,"od-DetailsPane-SecondaryPane-header--nonStickyHeaderButton":h,"od-DetailsPane-SecondaryPane-header--CreateFocusIllusion":!!t}),tabIndex:c||!h?-1:void 0,onClick:c?void 0:e,"aria-hidden":!h,onFocus:i,onBlur:s},r.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-icon"},r.createElement(a.Icon,{iconName:"GripperBarHorizontal"})),r.createElement("h2",{className:"od-DetailsPane-SecondaryPane-header-text"},o.default.moreDetailsTitle))};return t})(r.Component),c=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentDidUpdate=function(e){e.sectionGroup.sections.length&&this.props.sectionGroup.sections.length||e.sectionGroup.sections.length===this.props.sectionGroup.sections.length||this._onHeaderHeightChange()};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.sectionGroup,s=t.onHeightChange,o=t.minHeight;return r.createElement("div",{className:"od-DetailsPane-SecondaryPane-wrapper",style:{minHeight:n.sections.length&&o||0}},r.createElement("div",{className:f.css("od-DetailsPane-SecondaryPane",{"od-DetailsPane-SecondaryPane--disabled":!n.sections.length})},r.createElement(l,{onHeaderClick:this.props.onHeaderClick,isHeaderDisabled:!n.sections.length,isHeaderClickDisabled:!!this.props.isHeaderClickDisabled,setHeaderDiv:function(t){e._headerDiv=t}}),r.createElement("div",{className:"od-DetailsPane-SecondaryPane-body"},r.createElement(i.default,{onHeightChange:s},this._renderSectionsBody()))))};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,i=e.resources;return r.createElement(u.default,{items:t,sections:n.sections,resources:i,shouldHideSectionHeaders:1===n.sections.length})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t})(f.BaseComponent);t.default=c});
define("odsp-next/controls/infoPane/InfoPane",["require","exports","./InfoPane.html","./InfoPaneViewModel","../../bindings/component/ControlBinding","ODCDeferred_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-info-pane",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/infoPane/InfoPane.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div aria-live="assertive"><div role="alert" class="ms-accessible" data-bind="text:screenReaderInformation"></div></div><div class="InfoPane" role="dialog" tabindex="0" data-automationid="ms-info-pane" data-bind="attr:{\'aria-label\':ariaLabel,id:id},preserveFocus,class:\'od-InfoPane--\'+sizeCss(),delayedHasFocus:isPaneFocused,scrollContainer:{},clientRect:{size:size},css:{\'InfoPane-BackgroundColor\':isEnabledInfoPaneStickyHeader}">\x3c!--ko foreach:availableSections--\x3e\x3c!--ko component:legacyComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:selectionMessage--\x3e<div class="InfoPane-selectionMessage ms-font-l" data-bind="text:selectionMessage"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/infoPane/InfoPaneViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/toggle/ToggleBinding","@ms/odsp-utilities/lib/string/StringHelper","./InfoPane.resx","../detailsPane/DetailsPaneId","../detailsPane/IsDetailsPaneExpanded","../../resources/DataSourceResourceKeys","../../bindings/clientRect/ClientRectBinding","../../utilities/browser/ResponsiveUI","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../bindings/focus/DelayedHasFocusBinding","../../bindings/focus/PreserveFocusBinding","../../utilities/features/Features","../../bindings/scrollContainer/ScrollContainerBinding","./FocusedInfoPaneSection.key","../../dataSources/url/QueryType","../../actions/base/ItemSelectionHelper","../../dataSources/infoPane/InfoPaneManager.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=n.detailsPaneId,u=n.isInfoPaneExpanded,a=n.itemSelectionHelperType,f=n.responsiveUI,c=n.sectionWithFocus,m=n.urlDataSource;r.addBindingHandlers({scrollContainer:g.default,toggle:i.default,clientRect:l.default,preserveFocus:v.default,delayedHasFocus:d.default});var y=r.observables;r._showSections=t.showSections||y.create(!0);r._responsiveUI=f;r._sectionWithFocus=c;r._isExpanded=u;r._urlDataSource=m;r.ariaLabel=o.default.infoPaneAriaLabel;r.id=s;r.screenReaderInformation=o.default.screenReaderInformation;r.isPaneFocused=y.create(!1);r._allSections=y.createArray();r._itemSelectionHelper=new(r.scope.attached(a))({allowMultiSelect:!1,canFallback:!0});r._wasEverExpanded=y.pureCompute(r._computeWasEverExpanded);(r.item=y.pureCompute(r._computeItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})).equalityComparer=p.objectStrictEquality;r.selectionMessage=y.pureCompute(r._computeSelectionMessage);r.availableSections=r._getAvailableSections();r.size=y.create();r.size.equalityComparer=h.deepCompare;r.sizeCss=y.pureCompute(r._computeSizeCss).extend({rateLimit:500});y.backgroundCompute(r._computeAllSections);r.isEnabledInfoPaneStickyHeader=y.create(!1);r.isEnabledInfoPaneStickyHeader(r._checkDriveFeed());return r}t.prototype._computeWasEverExpanded=function(){return this._wasEverExpanded.peek()||this._isExpanded()};t.prototype._computeAllSections=function(){var e=this,t=this._sectionWithFocus;this._showSections()&&this._wasEverExpanded()&&this.resources.consumeAsync(E.typeResourceKey).then(function(n){for(var r,i,s=new(e.scope.attached(n))({}),o=(r=[]).concat.apply(r,s.getSectionGroups().map(function(e){return e.sections})),u=0,a=o;u<a.length;u++){var f=a[u],l=!1;if(t&&t.peek()===f.type){l=!0;i=f}f.legacyComponent.params={item:e.item,hasFocus:l}}t&&t(void 0);e._allSections(o);e.isPaneFocused(!i)})};t.prototype._getAvailableSections=function(){var e=this;return this.addDisposable(this._allSections.filter(function(t){var n=e.item();e.isEnabledInfoPaneStickyHeader(e._checkDriveFeed());if((7===t.type||0===t.type)&&m.isFeatureEnabled(m.SPListBulkEditItemProperties)){var r=e._itemSelectionHelper.selection().map(function(t){return e.observables.unwrap(t)});r&&0!==r.length||!n||(r=[n]);return!!r&&t.isAvailable(r)}return!!n&&t.isAvailable([n])}))};t.prototype._computeItem=function(){return this._itemSelectionHelper.firstItem()};t.prototype._computeSelectionMessage=function(){var e=this._computeSelectionLength();if(e>1&&!m.isFeatureEnabled(m.SPListBulkEditItemProperties))return s.format(o.default.selectedItemsFormatString,e)};t.prototype._computeSelectionLength=function(){return this._itemSelectionHelper.selection().length};t.prototype._computeSizeCss=function(){var e=this.size(),t=this._responsiveUI,n=c.default.determineWindowSize(e&&e.width||319);this.availableSections().length<5&&t.compareSize(n,"Large")>0&&(n="Large");return c.default.determineCssClass(n)};t.prototype._checkDriveFeed=function(){var e=this.item();if(!e)return!1;var t=this._urlDataSource.getKeyParams(e.key);return m.isFeatureEnabled(m.EnableInfoPaneStickyHeader)&&!!e.isRootFolder&&this._urlDataSource.getQueryType(t)===b.default.Files};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemSelectionHelperType:w.typeResourceKey,responsiveUI:c.resourceKey,urlDataSource:f.url,sectionWithFocus:y.focusedInfoPaneSectionResourceKey,detailsPaneId:u.resourceKey,isInfoPaneExpanded:a.resourceKey});return t})(r.default);t.default=S});
define("odsp-next/dataSources/people/graph/PeopleDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../base/graph/GraphDataRequestor","@ms/odsp-graph/lib/services/people/PeopleService"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,i.default,{dataRequestor:r.resourceKey})});
define("odsp-next/controls/clipboard/ClipboardHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../dragAndDrop/Html5FileDragProcessor","../../providers/operator/UploadOperator.key","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-utilities/lib/logging/ErrorHelper","../../providers/moveCopy/MoveCopyProvider","../../models/store/ItemsStore","../../resources/DataSourceResourceKeys","../../providers/engagement/Engagement","../../models/item/ItemParentHelper","../../utilities/features/Features","../../utilities/events/EventTargetFilters","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=new m.ResourceKey({name:e("module").id+".isPasteToUploadFeatureEnabled",factory:new m.ConstantResourceFactory(d.isFeatureEnabled(d.PasteToUploadFromClipboard))}),y=new m.ResourceKey({name:e("module").id+".isMoveAndCopyFeatureEnabled",factory:new m.ConstantResourceFactory(d.isFeatureEnabled(d.MoveAndCopyWithClipboard))}),b=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.isEnabled,o=void 0===i?r.observables.create(!0):i,u=n.document,a=void 0===u?document:u;r._itemSetSelectionModel=n.itemSetSelectionModel;r._moveCopyProvider=n.moveCopyProvider;r._itemsStore=n.itemsStore;r._urlDataSource=n.urlDataSource;r._engagement=n.engagement;r._itemParentHelper=n.itemParentHelper;r._isPasteToUploadFromClipboardFeatureEnabled=n.isPasteToUploadFromClipboardFeatureEnabled;r._isMoveAndCopyWithClipboardFeatureEnabled=n.isMoveAndCopyWithClipboardFeatureEnabled;r._isEnabled=o;r._htmlDragProcessor=new s.default;if(r._isMoveAndCopyWithClipboardFeatureEnabled){r.events.on(a,"cut",r._onCut);r.events.on(a,"copy",r._onCopy)}(r._isMoveAndCopyWithClipboardFeatureEnabled||r._isPasteToUploadFromClipboardFeatureEnabled)&&r.events.on(a,"paste",r._onPaste);return r}t.prototype._onCut=function(e){this._putSelectionInClipboard(e,"move")};t.prototype._onCopy=function(e){this._putSelectionInClipboard(e,"copy")};t.prototype._onPaste=function(e){if(this._isEnabled.peek()&&!v.isInputElement(e.target)&&(this._isMoveAndCopyWithClipboardFeatureEnabled&&this._moveOrCopy(e.clipboardData)||this._isPasteToUploadFromClipboardFeatureEnabled&&this._upload(e.clipboardData))){e.stopPropagation();e.preventDefault()}};t.prototype._putSelectionInClipboard=function(e,t){var n=this;if(this._isEnabled.peek()&&!v.isInputElement(e.target)){var r=this._itemSetSelectionModel.selection.peek().map(function(e){return n.observables.peekUnwrap(e)}).filter(function(e){return!!e}).map(function(e){return e.key});if(r.length>0){this._engagement.logData({name:"Items.Clipboard.Copy",isIntentional:!0});var i={itemKeys:r,parentKey:this._itemSetSelectionModel.itemSet.peek().item.peek().key,operation:t};e.clipboardData.setData("application/x-onedrive-items",JSON.stringify(i));e.preventDefault();e.stopPropagation()}}};t.prototype._moveOrCopy=function(e){var t=(function(e){try{for(var t=e.items,n=0;n<t.length;n++){if("application/x-onedrive-items"===t[n].type){return JSON.parse(e.getData("application/x-onedrive-items"))}}}catch(e){}})(e);if(t){for(var n=this.observables.peekUnwrap(this._itemsStore.getItem(t.parentKey)),r=this._itemSetSelectionModel.itemSet.peek().item.peek(),i=[],s={},o=0,u=t.itemKeys;o<u.length;o++){var f=u[o],l=this.observables.peekUnwrap(this._itemsStore.getItem(f));if(l){i.push(l);s[l.key]=!0}}if(i.length>0&&n){if(r&&n&&r.key===n.key)return!0;if(this._itemParentHelper.getAncestorOrSelf(r,function(e){return e.key in s}))return!0;this._engagement.logData({name:("move"===t.operation?"Move":"Copy")+"Items.Clipboard.Paste",isIntentional:!0});this._moveCopyProvider.copyItems({items:i,parentKey:n.key,targetId:r.id,targetKey:r.key,cid:this._urlDataSource.getOwnerId(),group:0,isAsync:!1,isMove:"move"===t.operation}).catch(function(e){a.default.log(e)})}return!0}return!1};t.prototype._upload=function(e){var t=this,n=this._htmlDragProcessor.getDataTransfer(e,!0);if(n.files){this._engagement.logData({name:"UploadItems.Clipboard.Paste",isIntentional:!0});var r=this._itemSetSelectionModel.itemSet.peek(),i=r.item.peek();this.resources.consumeAsync(o.asyncTypeResourceKey).then(function(e){var s=new e({files:n.files,parentItem:i,itemSet:r,wasDragAndDropped:!0,behavior:2,type:u.UploadProcessorType.Html5file});t.trackPromise(s.start());return s.wait()}).catch(function(e){a.default.log(e)});return!0}return!1};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemSetSelectionModel:i.itemsSelection,moveCopyProvider:f.resourceKey,itemsStore:l.resourceKey,urlDataSource:c.url,engagement:h.resourceKey,itemParentHelper:p.resourceKey,isMoveAndCopyWithClipboardFeatureEnabled:y,isPasteToUploadFromClipboardFeatureEnabled:g});return t})(r.default);t.default=b;t.typeResourceKey=m.createResolvedTypeResourceKey(e("module").id,b)});
define("odsp-next/providers/moveCopy/MoveCopyProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../item/ItemProvider","../quota/UserStateProvider.key","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemTaskObserver","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../providers/engagement/Engagement","../operation/OperationProvider","../../models/task/Task","../operation/MoveCopyItemsAsyncOperation","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemProvider=n.itemProvider;r._itemTaskObserver=r.scope.attach(new n.itemTaskObserverType);r._moveCopyHelper=n.moveCopyItemsAsyncOperation;r._operationProvider=n.operationProvider;r._updateQuota=n.updateQuota;r._actionMap=n.actionMap;r._engagement=r.resources.consume(d.resourceKey);r._isItemsScopeEnabled=n.isItemsScopeEnabled;return r}t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};t.prototype.moveItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};t.prototype.copyItems=function(e){return this._handleMoveCopyItems(e)};t.prototype.moveItems=function(e){var t=this;return this._handleMoveCopyItems(e).then(function(n){for(var r=[],i={},s=0,o=n.items;s<o.length;s++){(f=o[s]).error||(i[f.id]=!0)}for(var u=0,a=e.items;u<a.length;u++){var f;i[(f=a[u]).id]&&r.push(new m.default(f.key).succeed({item:{key:f.key,parentKey:e.targetKey}}))}if(r.length){var l=t._itemTaskObserver;l.update(r);l.flush()}return n})};t.prototype.moveCopyOperationSuccess=function(e,t,n){for(var r=0,i=t.length;r<i;r++){var s=t[r],o=e.items[r],u=o&&o.error;if(u)this._moveCopyHelper.handleMoveCopyError(u,s);else{if(!e.items)throw new Error("No items returned from MoveCopy API");s.progress.current(1);s.state(c.default.completed)}}this._itemProvider.invalidateItem(n.parentKey);this._itemProvider.invalidateItem(n.targetKey);this._isItemsScopeEnabled()&&this.resources.consumeAsync(f.itemInvalidator).then(function(e){e.invalidateItems(n.parentKey);e.invalidateItems(n.targetKey)});n.isMove||this._updateQuota(!0);return e};t.prototype._getContext=function(e){return{parentKey:e.targetKey,ignoreListContext:!0,webId:e.webId,siteId:e.siteId}};t.prototype._handleMoveCopyItemsAsync=function(e){var t=this;return this._itemProvider.getItem(this._getContext(e)).then(function(n){var r=new h.default,i=n.item,s=e.items.map(function(n){return t._moveCopyHelper.registerOperation(n,e,i.peek(),null,r)});return t._moveCopyHelper.handleMoveCopyAsyncItems(e,s)},function(n){t._handleGetItemFailure(n,e)})};t.prototype._handleMoveCopyItems=function(e){var t=this,n=this.observables;return this._itemProvider.getItem(this._getContext(e)).then(function(i){var s=new h.default,o=i.item,u=e.items.map(function(i){var u,a={items:[i],parentKey:e.parentKey,targetId:e.targetId,targetKey:e.targetKey,cid:e.cid,group:e.group,isMove:e.isMove,nameConflict:e.nameConflict,taskId:e.taskId,deleteSource:e.deleteSource,isAsync:e.isAsync,overrideLock:e.overrideLock,ackMoveIfShared:e.ackMoveIfShared};return u=t._operationProvider.register({name:i.name,type:e.isMove?p.default.moveItems:p.default.copyItems,iconName:i.iconName,payloads:{moveItems:{item:i,destination:o.peek(),source:i.parent},copyItems:{item:i,destination:o.peek(),source:i.parent}},batch:s,actions:{rename:{isAvailable:n.create(!1),execute:function(){t._engagement.logData({name:"MoveCopyItems.Rename.Click"});a.nameConflict=2;u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return a.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u]):t._moveCopyItems(a,[u])}},overwrite:{isAvailable:n.create(!1),execute:function(){t._engagement.logData({name:"MoveCopyItems.Overwrite.Click"});a.nameConflict=1;u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return a.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u]):t._moveCopyItems(a,[u])}},cancel:{isAvailable:n.create(!1),execute:function(){u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.canceled);return r.default.wrap(null)}},moveAnyway:{isAvailable:n.create(!1),execute:function(){a.deleteSource=!0;a.isMove=!1;a.isAsync=!0;u.actions().moveAnyway.isAvailable(!1);u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u])}},moveLockedFile:{isAvailable:n.create(!1),execute:function(){a.overrideLock=!0;u.actions().moveLockedFile.isAvailable(!1);return t.moveItems(a)}},vaultFileLimit:{isAvailable:n.create(!1),execute:function(){var e=new(t.managed(t._actionMap.VaultAction))({actionType:8,item:n.create(i),goPremiumSource:"PVault-QuotaErrorLearnMore"});u.state(c.default.expired);return e.execute({})}},moveSharedFileVault:{isAvailable:n.create(!1),execute:function(){u.state(c.default.completed);a.ackMoveIfShared=!1;return t.moveItems(a)}}},progress:{minimum:0,maximum:1,current:0}})});t._moveCopyHelper.markAllOperationsAsStarted(u);return t._moveCopyItems(e,u)},function(n){return t._handleGetItemFailure(n,e)})};t.prototype._handleGetItemFailure=function(e,t){var n=this;e.code=e.code||e.errorCode;var r=new h.default;t.items.map(function(i){var s=n._moveCopyHelper.registerOperation(i,t,null,null,r),o=s.actions().unlockVault;o.execute=function(){return new(n.managed(n._actionMap.VaultAction))({actionType:2,item:n.observables.create(i)}).execute({}).then(function(){o.isAvailable(!1);s.state(c.default.canceled);return t.isAsync?n._moveCopyHelper.handleMoveCopyAsyncItems(t,[s]):n._moveCopyItems(t,[s])})};n._moveCopyHelper.handleMoveCopyError(e,s)})};t.prototype._executeMoveCopy=function(e){return this.resources.consumeAsync(f.items).then(function(t){return e.isMove?t.moveItems(e):t.copyItems(e)})};t.prototype._moveCopyItems=function(e,t){var n=this;return this._executeMoveCopy(e).then(function(r){return n.moveCopyOperationSuccess(r,t,e)},function(i){return r.default.wrapError(n._moveCopyHelper.moveCopyOperationFailure(i,t,e))})};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{itemProvider:o.resourceKey,moveCopyItemsAsyncOperation:g.resourceKey,itemTaskObserverType:l.resourceKey,operationProvider:v.resourceKey,updateQuota:u.resourceKey,isItemsScopeEnabled:y.isItemsScopeEnabledResourceKey.lazy,actionMap:a.actionMap});return t})(s.default);t.default=b;t.resourceKey=i.createResolvedResourceKey(e("module").id,b)});
define("odsp-next/providers/operation/MoveCopyItemsAsyncOperation",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../models/operation/OperationType","../../models/operation/OperationState","../../models/operation/OperationBatch","@ms/odsp-utilities/lib/string/StringHelper","../../dataSources/item/IGetWorkProgressContext","@ms/odsp-utilities/lib/async/Promise","./OperationProvider","../item/ItemProvider","../../providers/engagement/Engagement","../../models/operation/OperationError","../../controls/commands/Commands.resx","../../controls/operation/monitor/OperationMonitor.resx","../../models/item/ItemType","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../quota/UserStateProvider.key","../../dataSources/vault/IVaultDataSource","../../actions/base/ItemSelectionHelper","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ODB_NAME_COLLISION=-2130575257;t.ODB_FILE_LOCKED=-2147018894;t.ODB_KEEPSHARING_MOVE_WARNING_CODES=[-2147213271,-2147213270];var k=8,L="InsufficientSpaceAvailable",A=162,O="InsufficientVaultQuota",M=(function(r){n.__extends(M,r);function M(e,t){void 0===e&&(e={});var n=r.call(this,e,t)||this,i=n._moveCopyDataSource=t.moveCopyDataSource;n._itemProvider=t.itemProvider;n._operationProvider=t.operationProvider;n._bundleLoader=t.bundleLoader;n._updateQuota=t.updateQuota;n._actionMap=t.actionMap;n._engagement=n.resources.consume(h.resourceKey);n._pollsForProgressSinceCancel={};n._cancelPromises={};n._cachePromises={};n._isItemsScopeEnabled=t.isItemsScopeEnabled;i&&i.getCapabilities().supportsProgressCaching&&n._resumePendingProgress();return n}M.prototype.registerOperation=function(e,t,n,r,u){var a=this;u||(u=new o.default);var f={items:[e],parentKey:t.parentKey,targetId:t.targetId,targetKey:t.targetKey,cid:t.cid,group:t.group,isMove:t.isMove,keepSharing:t.keepSharing,nameConflict:t.nameConflict,taskId:t.taskId,deleteSource:t.deleteSource,isAsync:t.isAsync,ackMoveIfShared:t.ackMoveIfShared},l=this._getKey(t),c=this.observables,h=this._operationProvider.register({name:e.name,type:t.isMove?i.default.moveItems:i.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:n,source:e.parent},copyItems:{item:e,destination:n,source:e.parent,taskId:r}},batch:u,actions:{rename:{isAvailable:c.create(!1),execute:function(){f.nameConflict=2;h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},overwrite:{isAvailable:c.create(!1),execute:function(){f.nameConflict=1;h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},cancel:{isAvailable:c.create(!0),execute:function(){h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);var e=a._getKey(f),t=a._cachePromises[e]||a._cachePromises[l];return t?t.then(function(e){return a.cancelAsyncOperation(f,h,e.id)}):a.cancelAsyncOperation(f,h,r)}},moveAnyway:{isAvailable:c.create(!1),execute:function(){f.deleteSource=!0;f.isMove=!1;f.isAsync=!0;h.actions().moveAnyway.isAvailable(!1);h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},moveAnywaySchemaMismatch:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"MoveItemsAsync.MoveAnyway.Click"});f.allowSchemaMismatch=!0;h.actions().moveAnywaySchemaMismatch.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},moveAnywayVersionLimit:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"MoveItemsAsync.MoveAnywayVersionLimit.Click"});f.allowSmallerVersionLimit=!0;h.actions().moveAnywayVersionLimit.isAvailable(!1);h.actions().cancel.isAvailable(!1);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},unlockVault:{isAvailable:c.create(!1),execute:function(){return new(a.managed(a._actionMap.VaultAction))({actionType:2,item:c.create(e)}).execute({}).then(function(){h.actions().unlockVault.isAvailable(!1);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)})}},vaultFileLimit:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"Vault.PaywallError.LearnMore"});var t=new(a.managed(a._actionMap.VaultAction))({actionType:8,item:c.create(e),goPremiumSource:"PVault-QuotaErrorLearnMore"});h.state(s.default.expired);return t.execute({})}},moveSharedFileVault:{isAvailable:c.create(!1),execute:function(){h.state(s.default.completed);h.actions().moveSharedFileVault.isAvailable(!1);f.ackMoveIfShared=!1;f.deleteSource=!0;return a.handleMoveCopyAsyncItems(f,[h],r)}}},progress:{minimum:0,maximum:1,current:0}});h.state(s.default.started);return h};M.prototype.moveCopyOperationFailure=function(e,t,n){if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];this.handleMoveCopyError(e,s)}return e};M.prototype.handleMoveCopyAsyncItems=function(e,t,n){var r=this;this.markAllOperationsAsStarted(t);return(function(e,t,n){if(n){var i={id:n,progress:null,pageStats:null,targetId:null};e.taskId||(e.taskId=n);return r.pollForProgress(i,e,t)}M._activeAsyncTasks[r._getKey(e)]=null;var s=r._getKey(e);r._cachePromises[s]=(function(e){return r._moveCopyDataSource.copyItemsAsync(e)})(e);return r._cachePromises[s].then(function(n){var i=e.items.map(function(e){return e.key});r._progressCache&&r._progressCache.saveJobState(n,i,e.targetKey,e.isMove);e.taskId=n.id;r.pollForProgress(n,e,t);return n},function(n){return r.moveCopyOperationFailure(n,t,e)})})(e,t,n)};M.prototype.pollForProgress=function(e,t,n,r,i){var s=this;if(!e)return null;var o={workItemIds:[e.id],jobInfo:e.jobInfo,type:a.IGetWorkProgressTypes.itemCopy,items:t.items,lastProcessedTime:i};this._progressCache&&(o.progressCache=this._progressCache);var u=function(e){s._getItemDataSource().then(function(t){return t.getWorkProgress(e)}).then(function(i){r&&r(n,i);s._handleGetWorkProgressSuccess(i,n,t,e,u)})};if(n)for(var f=function(t){var r=n[t],i=r.payloads.peek().copyItems;if(!i.taskId&&e&&e.progress){var o=e.progress.filter(function(e){return s._hasMatchingItemIds(r,e)});o[0]?i.taskId=o[0].id:i.taskId=e.progress[0]&&e.progress[0].id}},l=0;l<n.length;l++)f(l);if(e.progress){r&&r(n,e);this._handleGetWorkProgressSuccess(e,n,t,o,u)}else{var c=this.async.setTimeout(function(){u(o)},2e3);M._activeAsyncTasks[this._getKey(t)]=c}};M.prototype.handleMoveCopyError=function(e,n){var r=e.code;n.actions().cancel.isAvailable(!1);n.payloads.peek().copyItems.taskId="";if(1e3===r){n.actions().rename.isAvailable(!0);var i=!0,o=n.payloads.peek();(o.moveItems&&o.moveItems.item||o.copyItems&&o.copyItems.item).type===m.default.Folder&&(i=!1);n.actions().overwrite.isAvailable(i);n.error(new p.default({message:i?v.default.conflictUploadErrorText:v.default.conflictUploadFolderWithRenameErrorText}))}else if(r===t.ODB_NAME_COLLISION)if(n.payloads().moveItems.item.parentKey===n.payloads().moveItems.destination.key)n.error(new p.default({message:v.default.sameLocationMoveCopyErrorText}));else{this._engagement.logData({name:"MoveCopyItems.NameConflictError"});if(n.payloads().moveItems.item.type===m.default.Folder){n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.default.conflictUploadFolderWithRenameErrorText}))}else{n.actions().overwrite.isAvailable(!0);n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.default.conflictUploadErrorText}))}}else if(-2147213282===r){this._engagement.logData({name:"MoveItemsAsync.SchemaMismatchError"});n.actions().moveAnywaySchemaMismatch.isAvailable(!0);n.error(new p.default({message:v.default.moveFileFolderSchemaMismatch}))}else if(-2147213278===r){this._engagement.logData({name:"MoveItemsAsync.VersionLimitError"});n.actions().moveAnywayVersionLimit.isAvailable(!0);n.error(new p.default({message:v.default.moveFileFolderVersionLimit}))}else if(-2147024713===r||-2147024816===r)if(n.payloads().moveItems.item.type===m.default.Folder){n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.default.conflictUploadFolderWithRenameErrorText}))}else{n.actions().overwrite.isAvailable(!0);n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.default.conflictUploadErrorText}))}else if(r===t.ODB_FILE_LOCKED)e.message&&n.error(new p.default({message:e.message}));else if(2028===r){n.actions().moveAnyway.isAvailable(!0);n.error(new p.default({message:d.default.moveItemCannotMoveOwnItemIntoMountPointError}))}else if(2029===r){n.actions().moveAnyway.isAvailable(!0);n.error(new p.default({message:d.default.moveItemCannotMoveSharedItemIntoOwnFolderError}))}else if(9001===r){n.actions().moveLockedFile.isAvailable(!0);n.error(new p.default({message:e.message}))}else if(-2130247142===r){var a=e.message;n.payloads().moveItems.item.type===m.default.Folder&&(n.payloads().moveItems.item.key===n.payloads().moveItems.destination.key?a=v.default.moveFolderToSameLocationErrorText:0===n.payloads().moveItems.destination.key.indexOf(n.payloads().moveItems.item.key)&&(a=v.default.moveFolderToOwnSubfolderErrorText));n.error(new p.default({message:a}))}else if(161===r){n.actions().unlockVault.isAvailable(!0);this._engagement.logData({name:"Vault.Upload.UnlockErrorShown"});n.error(new p.default({message:v.default.unlockRequiredMoveErrorText}))}else if(162===r){this._engagement.logData({name:"Vault.PaywallError.Shown"});n.actions().vaultFileLimit.isAvailable(!0);n.actions().vaultFileLimit.closeHostOnExecute=!0;n.error(new p.default({message:u.format(v.default.insufficientVaultQuotaErrorText,T.VAULT_FREE_FILE_LIMIT)}))}else if(9018===r){this._engagement.logData({name:"Vault.Move.RemoveSharingShown"});n.actions().moveSharedFileVault.isAvailable(!0);n.actions().moveSharedFileVault.closeHostOnExecute=!0;n.error(new p.default({message:v.default.moveSharedFileVaultErrorText}))}else{var f=v.default,l=void 0;switch(r){case 3e3:l=y.default.ItemNotFoundSubText;break;case 1007:l=f.moveFolderToSameLocationErrorText;break;case k:l=f.overQuotaCreateItemErrorText;break;case-2147213295:l=f.moveCopyIRMNotSupported;break;case-2147213288:l=f.moveCopyObjectsNotSameLevel;break;case-2147213287:l=f.moveCopyTargetIsSubfolder;break;case-2147213294:case-2147213293:l=f.moveFolderDeleteFail;break;case-2147213291:case-2147024684:case-2147213290:l=f.moveFileDeleteFail;break;case-2147213285:l=f.moveCopyPermissionsFail;break;case-2147213284:l=f.moveCopyNoScriptSourceFail;break;case-2147213283:l=f.moveCopyNoScriptTargetFail;break;case-2147213292:case-2147024809:l=f.moveCopyFatalErrorText;break;case 164:l=f.moveSpecialFoldersVaultError;this._engagement.logData({name:"Vault.Move.SpecialFolderBlocked"});break;default:l=e.message}n.error(new p.default({message:"string"==typeof l?l:void 0}))}n.state(s.default.failed)};M.prototype.markAllOperationsAsStarted=function(e){if(e)for(var t=0,n=e;t<n.length;t++){n[t].state(s.default.started)}};M.prototype._handleGetWorkProgressSuccess=function(e,n,r,i,o){var u=!1,a=!1,f=r.taskId;void 0!==this._pollsForProgressSinceCancel[f]&&(this._pollsForProgressSinceCancel[f]+=1);if(n&&e&&e.progress)for(var l=function(n){for(var r=void 0,i=n.payloads.peek(),o=0,l=e.progress;o<l.length;o++){var h=l[o];if(i.copyItems&&h.id===n.payloads.peek().copyItems.taskId&&c._hasMatchingItemIds(n,h)&&n.state.peek()!==s.default.completed&&n.state.peek()!==s.default.failed){r=h;break}}var d=function(){n.progress.current(1);n.actions().cancel&&n.actions().cancel.isAvailable(!1);n.state(s.default.completed);a=!0};if(r){var v=r.error,m=g.ITaskStatuses[r.status];if(m===g.ITaskStatuses.Cancelled||c._pollsForProgressSinceCancel[f]>=3){n.actions().cancel.isAvailable(!1);n.state(s.default.canceled);a=!0}else if(v&&t.ODB_KEEPSHARING_MOVE_WARNING_CODES.indexOf(v.code)<=-1){r.errorCode===L?v.code=k:r.errorCode===O&&(v.code=A);if(c._progressCache){n.progress.current(0);n.state()!==s.default.failed&&c.handleMoveCopyError(v,n)}else c.handleMoveCopyError(v,n)}else if(m===g.ITaskStatuses.Completed){d();v&&t.ODB_KEEPSHARING_MOVE_WARNING_CODES.indexOf(v.code)>-1&&n.error(new p.default({errorType:2,message:""}))}else{var y=n.progress.current.peek();if(r.completedBytes>y){n.progress.current(r.completedBytes);n.progress.maximum(r.totalBytes)}u=!0}c._progressCache&&c._progressCache.updateJobState(f,n,r)}else n.state()!==s.default.failed&&d()},c=this,h=0,d=n;h<d.length;h++){l(d[h])}if(a){this._itemProvider.invalidateItem(r.parentKey);this._itemProvider.invalidateItem(r.targetKey);this._isItemsScopeEnabled()&&this.resources.consumeAsync(S.itemInvalidator).then(function(e){e.invalidateItems(r.targetKey);e.invalidateItems(r.parentKey)});this._updateQuota()}if(u){var v=this.async.setTimeout(function(){o(i)},2e3);M._activeAsyncTasks[this._getKey(r)]=v}else if(this._progressCache){this._pollsForProgressSinceCancel={};this._progressCache.purgeJobState(f)}};M.prototype._hasMatchingItemIds=function(e,t){var n=e.payloads.peek().copyItems&&e.payloads.peek().copyItems.item;return!t.sourceResourceId||this._moveCopyDataSource.hasMatchingId(t.sourceResourceId,n)};M.prototype.cancelAsyncOperation=function(e,t,n){var r=this,i=n||e.taskId,o=M._activeAsyncTasks[this._getKey(e)];if(!this._cancelPromises[i]){var u={workItemIds:[i]};this._progressCache&&(u.progressCache=this._progressCache);this._cancelPromises[i]=this._getItemDataSource().then(function(e){return e.cancelWork(u)})}return this._cancelPromises[i].then(function(e){if(r._progressCache){var n=r._progressCache.getCacheData(),u=n&&n[i];if(e||!u){t.state(s.default.canceled);r._progressCache.cancelJobs(i);o&&r.async.clearTimeout(o)}else r._pollsForProgressSinceCancel[i]=0}t.actions().cancel.isAvailable(!1);r._cancelPromises[i]=void 0},function(e){r._cancelPromises[i]=void 0})};M.prototype._getKey=function(e){return e.items.map(function(e){return e.key}).join(",")+e.targetKey};M.prototype._resumePendingProgress=function(){var t=this;this._bundleLoader.queueLoad("./MoveCopyAsyncProgressCache",function(){return f.default.resolve(new Promise(function(t,n){e(["./MoveCopyAsyncProgressCache"],t,n)}))}).then(function(e){t._progressCache=new(t.managed(e))({moveCopyHelper:t});t._progressCache.resumePendingProgress()})};M.prototype._getItemDataSource=function(){return this.resources.consumeAsync(S.items)};M.dependencies=n.__assign(n.__assign({},b.default.dependencies),{moveCopyDataSource:S.copy.optional,itemProvider:c.resourceKey,operationProvider:l.resourceKey,bundleLoader:E.bundleLoader,updateQuota:x.resourceKey,actionMap:w.actionMap,itemSelectionHelperType:N.typeResourceKey,isItemsScopeEnabled:C.isItemsScopeEnabledResourceKey.lazy});M._activeAsyncTasks={};return M})(b.default);t.default=M;t.resourceKey=r.createResolvedResourceKey(e("module").id,M)});
define("odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble",["require","exports","tslib","react","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/common/DirectionalHint","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../VaultTeachingBubbleHelper","../../../../dataSources/vault/IVaultDataSource","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../../dataSources/vault/odc/VaultDataSource.key","@ms/odsp-utilities/lib/resources/ResourceScope","../../VaultTeachingBubble.resx","office-ui-fabric-react/lib/TeachingBubble","../../../../resources/ControlResourceKeys","../../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onLaterClick=function(){u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Later"});r._dismiss()};r._onDismiss=function(){u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Dismiss"});r._dismiss()};r._onGetStartedClick=function(){var e=r.props.vaultItem;u.Engagement.logData({name:"Vault.FRE.TeachingBubble.GetStarted"});r._onDismiss();var t=r._actionMap;return new(r._resources.injected(t.OpenAction))({item:r._observables.create(e),openRelation:2,itemSet:r._itemSet}).execute({}).then(function(t){if(t.resultType===o.ResultTypeEnum.Success){var n=r._odcUrlDataSource.getItemUrl(e.key);r._navigation.navigateTo({url:n})}})};var s=n.dependencies;r._resources=s&&s.resources||t.resources;r._actionMap=s&&s.actionMap||r._resources.consume(b.actionMap);r._itemSet=s&&s.itemSet||r._resources.consume(b.currentItemSet);r._navigation=s&&s.navigation||r._resources.consume(d.navigation);r._scope=new i.default;r._observables=r._scope.attach(new(r._resources.consume(p.observablesFactoryTypeResourceKey))({owner:r}));r._odcUrlDataSource=s&&s.odcUrlDataSource||r._resources.consume(w.urlDataSource);r._vaultDataSource=s&&s.vaultDataSource||r._resources.consume(v.resourceKey);r._vaultDataSource&&(r._vaultFreState=r._vaultDataSource.freState());r._isGuidedTourVisible=s&&s.isGuidedTourVisible||r._resources.consume(b.isGuidedTourVisible);r._isPremiumUpsellVisible=s&&s.isPremiumUpsellVisible||r._resources.consume(b.isPremiumUpsellVisible);r._isVaultFreVisible=s&&s.isVaultFreVisible||r._resources.consume(b.isVaultFreVisible);r.state={isVisible:!!r._calculateVisibility(r._vaultFreState()),target:r.props.target};return r}t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){var t=e._vaultFreState();e.setState({isVisible:!!e._calculateVisibility(t)})});if(this.props.getUpdatedTarget){var t=this.props.getUpdatedTarget();this.setState({target:t})}};t.prototype.render=function(){var e=this.props.directionalHint,t=void 0===e?f.DirectionalHint.rightCenter:e,n=g.default.VaultTeachingDescription,i=this.state,s=i.isVisible,o=i.target,a={text:g.default.GetStartButtonName,style:{borderRadius:"2px"},onClick:this._onGetStartedClick},l={text:g.default.LaterButtonName,style:{borderRadius:"2px"},onClick:this._onLaterClick};s&&u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Shown"});return s?r.createElement("div",{className:"od-vaultTeachingBubble"},r.createElement(y.TeachingBubble,{styles:{header:{marginBottom:"16px"},headline:{fontSize:"20px"}},primaryButtonProps:a,secondaryButtonProps:l,calloutProps:{directionalHint:t},target:o,headline:g.default.VaultTeachingTile,hasCloseIcon:!0,closeButtonAriaLabel:g.default.VaultTeachingCloseAriaLabel,onDismiss:this._onDismiss,hasCondensedHeadline:!0},n)):null};t.prototype._dismiss=function(){this._vaultDataSource.setVaultState(h.VaultFreState.BubbleShown)};t.prototype._calculateVisibility=function(e){var t=this._isVaultFreVisible(),n=!this._isGuidedTourVisible()&&!this._isPremiumUpsellVisible()&&c.isVaultInContainer()&&e===h.VaultFreState.Created&&!t;t&&e<=h.VaultFreState.Created&&this._onDismiss();return n};t.contextTypes=s.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(a.BaseComponent);t.default=E;t.typeResourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,E,{actionMap:b.actionMap,odcUrlDataSource:w.urlDataSource,resources:m.resourceScopeKey.local,vaultDataSource:v.resourceKey,isGuidedTourVisible:b.isGuidedTourVisible,isPremiumUpsellVisible:b.isPremiumUpsellVisible,isVaultFreVisible:b.isVaultFreVisible,navigation:d.navigation,itemSet:b.currentItemSet})});
define("odsp-next/controls/sharing/share/odc/Share",["require","exports","../Share.html","./ShareViewModel","../../../../bindings/component/ControlBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-share-ko",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/sharing/share/Share.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div data-bind="interactionScope:{isScope:true},react:{componentType:shareComponent,props:shareComponentProps}"></div>\x3c!--ko if:displayFeatureCards--\x3e<div data-bind="component:{name:featureCardsTagName,params:{cards:featureCardData,currentIndex:featureCardIndex,close:$component.closeFeatureCards.bind($component),includeOverlay:true}}"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/share/odc/ShareViewModel",["require","exports","tslib","../../../../resources/ControlResourceKeys","../../../../bindings/focus/FocusTrapBinding","../../../../providers/peoplePicker/PeoplePickerProvider","../../../../bindings/react/ReactBinding","../react/Share","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","@ms/odsp-shared-sharing/lib/store/odc/SharingStore","../../../../dataSources/base/graph/GraphDataRequestor","@ms/odsp-graph/lib/services/sharing/SharingService","@ms/odsp-graph/lib/services/people/PeopleService","@ms/odsp-datasources/lib/providers/peoplePicker/odc/PeoplePickerProvider","@ms/odsp-datasources/lib/dataSources/peoplePicker/graph/PeoplePickerDataSource","../../../../providers/sharing/SharingProvider","@ms/odsp-shared-sharing/lib/Share","../../../../providers/featureCards/FeatureCardsProvider","../../../featureCards/FeatureCards","../../../../providers/engagement/Engagement","@ms/odsp-utilities/lib/string/StringHelper","../../../../controls/sharing/shareByEmail/Sharing.resx","../../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._showFeatureCards=function(){r._engagement.logData({name:"ODCSharing.LearnMoreClicked",isIntentional:!0});r.displayFeatureCards(!0)};var s=t.copyLinkShortcut,a=t.items,f=t.onDismiss,l=t.onResize,c=t.hideShareDialogOverflowButton,m=t.mode,g=n.actionMap;r._itemsBeingShared=a;r._onDismiss=f;r._onResize=l;r._dependencies=n;r._copyLinkShortcut=s;r._mode=m;r._hideShareDialogOverflowButton=c;r.displayFeatureCards=r.createObservable(!1);r._featureCardsProvider=r.resources.consume(y.resourceKey);r.featureCardIndex=0;r.featureCardsTagName=b.default.tagName;r.featureCardData=r._getFeatureCardsData();r._engagement=r.resources.consume(w.resourceKey);r.addBindingHandlers({react:o.default,focusTrap:i.default});r._showPermissionsAction=new(r.child(g.ShowPermissionsAction))({item:r.createObservable(r._itemsBeingShared()[0])});r.shareComponent=u.default;r.shareComponentProps=r.createPureComputed(r._computeShareProps);r._sharingService=new h.default({},{dataRequestor:r._dependencies.dataRequestor});var E=new p.default({},{dataRequestor:r._dependencies.dataRequestor});r._peoplePickerProvider=new d.PeoplePickerProvider(new v.PeoplePickerDataSource(E,x.isFeatureEnabled(x.ShareSearchToPeopleApi)));return r}t.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1)};t.prototype._computeShareProps=function(){var e=this._itemsBeingShared();if(e&&e.items[0]){var t=e.items,n=this._dependencies;if(t&&t[0]){t[0].name=t[0].name||"";var r=e.isSecureShare?g.SharingAudience.specificPeople:g.SharingAudience.anyone,i=new l.default({itemName:t.length>1?E.format(S.default.SharingBundleTempName,t.length):t[0].name,sharingService:this._sharingService,itemId:t[0].id,multiShareIds:t.length>1?t.map(function(e){return e.id||""}):void 0,defaultRecipients:e.defaultRecipients,clientId:f.ClientId.odc,isEdit:e.isEdit,audience:r});return{actionMap:n.actionMap,copyLinkShortcut:this._copyLinkShortcut,hideShareDialogOverflowButton:this._hideShareDialogOverflowButton||!this._showPermissionsAction.isAvailable(),item:t[0],items:t,onDismiss:this._onDismiss,onResize:this._onResize,onManageAccessClicked:this._onManageAccessClicked.bind(this),peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:null,resources:n.resources,sharingProvider:null,policyTipProvider:null,mode:this._mode,sharingStore:i,clientId:f.ClientId.odc,premiumLearnMore:this._showFeatureCards,goPremium:function(){return window.open("https://onedrive.live.com/?ocid=PROD_OneDrive-Web_ExpiringLinks_Normal_GoPremium&v=upgrade&hideLeftNav=true")}}}}};t.prototype._onManageAccessClicked=function(){this._showPermissionsAction.isAvailable.peek()&&this._showPermissionsAction.execute(null);this._onDismiss()};t.prototype._getFeatureCardsData=function(){return this._featureCardsProvider.getFeatureCards()};t.dependencies=n.__assign(n.__assign({},a.default.dependencies),{peoplePickerProvider:s.resourceKey,actionMap:r.actionMap,dataRequestor:c.resourceKey,sharingProvider:m.resourceKey});return t})(a.default);t.default=T});
define("@ms/tti-polyfill/lib/index",["require","exports","./firstConsistentlyInteractiveDetector"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFirstConsistentlyInteractive=function(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new n.FirstConsistentlyInteractiveDetector(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}});
define("@ms/tti-polyfill/lib/firstConsistentlyInteractiveDetector",["require","exports","tslib","./activityTrackerUtils","./debug","./firstConsistentlyInteractiveCore"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){var t=this;void 0===e&&(e={});this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){i.log("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return{start:e.startTime,end:e.startTime+e.duration,id:t._longTaskId++}})}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){i.log("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){i.log("Attempting to reschedule FirstConsistentlyInteractive check to "+e);i.log("Previous timer activation time: "+this._timerActivationTime);if(this._timerActivationTime>e)i.log("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;i.log("Rescheduled firstConsistentlyInteractive check at "+e)}}else i.log("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){i.log("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){r.patchXMLHTTPRequest(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this));r.patchFetch(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this))}this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=r.observeResourceFetchingMutations(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){i.log("Starting JS initiated request. Request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());i.log("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._afterJSInitiatedRequestCallback=function(e){i.log("Completed JS initiated request with request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.delete(e);i.log("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._networkRequestFinishedCallback=function(e){i.log("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){i.log("Long task finished",e);var t,n=e.startTime+e.duration,r={start:e.startTime,end:n,id:this._longTaskId++},s="longTaskEnd"+r.id;t=s,window.performance&&performance.mark&&performance.mark(t);r.endMarkName=s;this._longTasks.push(r);this._rescheduleTimer(n+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){i.log("Potentially network resource fetching mutation detected",e);i.log("Pushing back FirstConsistentlyInteractive check by "+this._requiredNetworkQuietnessDurationInMilliseconds+" milliseconds.");this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._incompleteRequestStarts=function(){return n.__spreadArrays(Array.from(this._incompleteJSInitiatedRequestStartTimes.values()))};e.prototype._checkTTI=function(){i.log("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=s.computeLastKnownNetwork2Busy(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),o=performance.now();if(null!==r){i.log("Parameter values:");i.log("NavigationStart",e);i.log("lastKnownNetwork2Busy",t);i.log("Search Start",n);i.log("Min Value",r);i.log("Last busy",t);i.log("Current time",o);i.log("Long tasks",this._longTasks);i.log("Incomplete JS Request Start Times",this._incompleteRequestStarts());i.log("Network requests",this._networkRequests);var u=s.computeFirstConsistentlyInteractive(n,r,t,o,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(u&&this._firstConsistentlyInteractiveResolver){this._firstConsistentlyInteractiveResolver(u);this._disable()}i.log("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}else{i.log("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,o+1e3))}};return e})();t.FirstConsistentlyInteractiveDetector=o});
define("@ms/tti-polyfill/lib/activityTrackerUtils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.patchXMLHTTPRequest=function(e,t){var r=XMLHttpRequest.prototype.send,i=n++;XMLHttpRequest.prototype.send=function(){for(var n=this,s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];e(i.toString());this.addEventListener("readystatechange",function(){4===n.readyState&&t(i.toString())});return r.apply(this,s)}};t.patchFetch=function(e,t){var r=window.fetch;window.fetch=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return new Promise(function(s,o){var u=n++;e(u.toString());r.apply(void 0,i).then(function(e){t(u.toString());s(e)},function(e){t(e);o(e)})})}};var r=["img","script","iframe","link","audio","video","source"];function i(e,t){for(var n=0,r=e;n<r.length;n++){var s=r[n];if(t.includes(s.nodeName.toLowerCase())||i(s.children,t))return!0}return!1}t.observeResourceFetchingMutations=function(e){var t=new MutationObserver(function(t){for(var n=0,s=t;n<s.length;n++){var o=s[n];("childList"===o.type&&i(o.addedNodes,r)||"attributes"===o.type&&r.includes(o.target.tagName.toLowerCase()))&&e(o)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t}});
define("@ms/tti-polyfill/lib/debug",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n()&&console.log.apply(console,e)};function n(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}});
define("@ms/tti-polyfill/lib/firstConsistentlyInteractiveCore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.computeFirstConsistentlyInteractive=function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)};t.computeLastKnownNetwork2Busy=function(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}});
define("@ms/rumone-fci/lib/index",["require","exports","./FCI"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFirstCPUIdle=function(e){if("PerformanceLongTaskTiming"in window){return new n.FCIMeasurer(e).measureFCI()}return Promise.resolve(null)}});
define("@ms/rumone-fci/lib/FCI",["require","exports","./Log"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._longTaskId=0;this._checkFCIRunId=0;this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n;this._requiredMainThreadCPUIdleDurationInMilliseconds=t;this._resultResolver={resolve:void 0,reject:void 0};this._fciPromise=void 0;this._longTasks=[];this._processLongTaskPreQueue();this._registerLongTaskObserver()}e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t;e._resultResolver.reject=n}));this._tryScheduleNextCheck();return this._fciPromise};e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),r=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},r)};e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime,performance.now())};e.prototype._checkFCI=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0,r=performance.now();n.log("Running checkFCI:");n.log("Measurement start time",this._measurementStartTime);n.log("Current time",r);n.log("Long tasks",this._longTasks);n.log("latestLongTaskEndTime",t);if(r-t>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var i=Math.max(t,this._measurementStartTime);if(i&&e){var s=e.endMarkName;s&&performance.measure("FCI",void 0,s)}n.log("possibleFCI:",i);this._resultResolver.resolve&&this._resultResolver.resolve(i);this._dispose()}};e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId);this._longTaskObserver.disconnect();this._isDisposed=!0};e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var r=n[t];(!e||r.end>e.end)&&(e=r)}return e};e.prototype._processLongTaskPreQueue=function(){for(var e=window.__tti.o,t=0,n=window.__tti.e;t<n.length;t++){var r=n[t];if("longtask"===r.entryType){var i={start:r.startTime,end:r.startTime+r.duration,id:this._longTaskId++};this._longTasks.push(i)}}e.disconnect()};e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}});this._longTaskObserver.observe({entryTypes:["longtask"]})};e.prototype._longTaskFinishedCallback=function(e){n.log("Long task finished: ",e);var t,r=e.startTime+e.duration,i={start:e.startTime,end:r,id:this._longTaskId++},s="longTaskEnd"+i.id;t=s,window.performance&&performance.mark&&performance.mark(t);i.endMarkName=s;this._longTasks.push(i);this._tryScheduleNextCheck()};return e})();t.FCIMeasurer=r});
define("@ms/rumone-fci/lib/Log",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n()&&console.log.apply(console,e)};function n(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}});
define('ODCDeferred_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".analyticsStatsContainer_961d387d{display:-webkit-box;display:-ms-flexbox;display:flex;max-width:250px}.analyticsStats_961d387d,.analyticsStatsNoLink_961d387d,.analyticsStatsLink_961d387d{padding:8px 8px 4px 0}.isFluent .analyticsStats_961d387d,.isFluent .analyticsStatsNoLink_961d387d,.isFluent .analyticsStatsLink_961d387d{padding:0 8px 0 0}.analyticsStats_961d387d .ms-Link,.analyticsStatsNoLink_961d387d .ms-Link,.analyticsStatsLink_961d387d .ms-Link{font-size:12px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html[dir='ltr'] .analyticsStats_961d387d .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsLink_961d387d .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStats_961d387d .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsLink_961d387d .ms-ActivityItem-activityTypeIcon{padding-left:5px}.isFluent .analyticsStats_961d387d .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsLink_961d387d .ms-ActivityItem-activityTypeIcon{margin-top:0}.analyticsStats_961d387d .ms-ActivityItem-activityContent,.analyticsStatsNoLink_961d387d .ms-ActivityItem-activityContent,.analyticsStatsLink_961d387d .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:600}html[dir='ltr'] .analyticsStats_961d387d .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsLink_961d387d .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStats_961d387d .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsLink_961d387d .ms-ActivityItem-activityContent{padding-right:0}.isFluent .analyticsStats_961d387d .ms-ActivityItem-activityContent,.isFluent .analyticsStatsNoLink_961d387d .ms-ActivityItem-activityContent,.isFluent .analyticsStatsLink_961d387d .ms-ActivityItem-activityContent{font-weight:400}.analyticsStatsLink_961d387d :hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.analyticsStatsNoLink_961d387d{-ms-flex-item-align:center;align-self:center}.analyticsStatsViewsNoLink_961d387d{padding:8px 0 4px;font-weight:400;font-size:12px}.isFluent .analyticsStatsViewsNoLink_961d387d{padding:0}.analyticsStatsViews_961d387d{padding-bottom:8px}.isFluent .analyticsStatsViews_961d387d{font-size:14px;font-weight:600}.analyticsStatsViewsDivider_961d387d:before{content:' \\B7  '}.analyticsStatsViewsDividerNoDot_961d387d:before{content:'   ';padding:0px 4px}.analyticsStatsErrorMessage_961d387d{font-size:12px;font-weight:400;line-height:28px}.fileHoverCardErrorIcon_961d387d{vertical-align:bottom}.analyticsStatsTeachingMessage_961d387d,.analyticsStatsInfo_961d387d{vertical-align:sub;padding:0px 8px}.isFluent .analyticsStatsInfo_961d387d{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.analyticsStatsLabel_961d387d{display:-webkit-box;display:-ms-flexbox;display:flex}html[dir='ltr'] .analyticsStatsCount_961d387d:not(:last-child){padding-right:8px}html[dir='rtl'] .analyticsStatsCount_961d387d:not(:last-child){padding-left:8px}\n"},{"rawString":".commandLink_32ce514b{height:32px;line-height:32px}html[dir='ltr'] .commandLink_32ce514b{margin-right:15px}html[dir='rtl'] .commandLink_32ce514b{margin-left:15px}.commandLink_32ce514b i{color:"},{"theme":"primaryText","defaultValue":"#333333"},{"rawString":"}label.link_32ce514b,button.link_32ce514b{display:inline;line-height:32px;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir='ltr'] label.link_32ce514b,html[dir='ltr'] button.link_32ce514b{margin-left:-7px}html[dir='rtl'] label.link_32ce514b,html[dir='rtl'] button.link_32ce514b{margin-right:-7px}html[dir='ltr'] label.link_32ce514b,html[dir='ltr'] button.link_32ce514b{margin-right:15px}html[dir='rtl'] label.link_32ce514b,html[dir='rtl'] button.link_32ce514b{margin-left:15px}.pageUsageChartContainer_32ce514b>.ms-AnalyticsChart{margin-top:0}.root_32ce514b{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:12px}.socialBarList_32ce514b{width:288px}.socialBarPanel_32ce514b{top:50px}.socialBarPanelContent_32ce514b{overflow-x:hidden;overflow-y:auto}.spSocialPanelPivotContent_32ce514b{padding-top:15px}.socialBarPanelHeader_32ce514b{-ms-flex-negative:0;flex-shrink:0;padding:0 25px}.socialBarPanelHeader_32ce514b .socialBarPanelHeaderText_32ce514b{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:300;line-height:48px;margin:0}.socialBarPanelPersona_32ce514b{font-size:14px;padding:4px 0}.socialBarPanelPersonaDescription_32ce514b{font-size:14px;padding:8px 0}.viewsIcon_32ce514b{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}html[dir='ltr'] .viewsIcon_32ce514b{margin-right:8px}html[dir='rtl'] .viewsIcon_32ce514b{margin-left:8px}.analyticsStatsLink_32ce514b{min-width:50px;font-size:14px;padding:0 8px 0 0}.analyticsStatsLink_32ce514b .ms-Link{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.analyticsStatsLink_32ce514b .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir='ltr'] .analyticsStatsLink_32ce514b .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStatsLink_32ce514b .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_32ce514b .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:400}html[dir='ltr'] .analyticsStatsLink_32ce514b .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStatsLink_32ce514b .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_32ce514b :hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}\n"},{"rawString":".analyticsActivity_a9cbc3a9{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.analyticsActivity_a9cbc3a9 .analyticsActivityUserAction_a9cbc3a9,.analyticsActivity_a9cbc3a9 .analyticsActivityUserName_a9cbc3a9{display:inline-block;content:attr(data-analytics-activity-start)}.analyticsActivity_a9cbc3a9 .analyticsActivityUserName_a9cbc3a9{content:attr(data-analytics-activity-start);color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-weight:600}.analyticsActivity_a9cbc3a9 .analyticsActivityUserAction_a9cbc3a9{content:attr(data-analytics-activity-end);color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.ms-ActivityItem-timeStamp{height:16px}\n"},{"rawString":".analyticsActivityListActivity_daf74312{padding:8px 0}\n"},{"rawString":".analyticsActionBarStats_fd0f390e{min-height:28px}.isFluent .analyticsActionBarStats_fd0f390e{height:40px;padding:12px 4px;-webkit-box-sizing:border-box;box-sizing:border-box}.analyticsActionBar_fd0f390e{background-color:transparent;padding-left:0;padding-right:0}.isFluent .analyticsActionBar_fd0f390e{-webkit-box-sizing:border-box;box-sizing:border-box;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:35px}.isFluent .analyticsActionBar_fd0f390e .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_fd0f390e .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-right:0}[dir='rtl'] .isFluent .analyticsActionBar_fd0f390e .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-left:0}.isFluent .analyticsActionBar_fd0f390e .ms-FocusZone.ms-CommandBar{height:34px}.analyticsActionBar_fd0f390e .ms-FocusZone.ms-CommandBar{background-color:transparent;padding:0;height:36px}.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{background-color:transparent;min-width:0}[dir='ltr'] .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-left:0}[dir='rtl'] .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-right:0}.isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{min-width:0;height:32px;margin-top:1px;border-radius:2px;padding:0}.isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:4px}[dir='rtl'] .isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:4px}[dir='ltr'] .isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:20px}[dir='rtl'] .isFluent .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:20px}.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{font-size:12px;font-weight:400}.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon,.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-textContainer{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}[dir='ltr'] .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:0}[dir='rtl'] .analyticsActionBar_fd0f390e .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:0}\n"},{"rawString":".fileHoverCardLifeCycle_51de774f{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";padding:8px 0px 10px 5px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir='ltr'] .fileHoverCardLifeCycle_51de774f{margin-right:12px}[dir='rtl'] .fileHoverCardLifeCycle_51de774f{margin-left:12px}.fileHoverCardLifeCycleMessage_51de774f{font-size:12px}.fileHoverCardLifeCycleMessage_51de774f .fileHoverCardLifeCycleTitle_51de774f{white-space:pre-line;font-weight:400}.fileHoverCardLifeCycleAction_51de774f{padding-top:4px;font-weight:600}.fileHoverCardLifeCycleNewSignal_51de774f{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .fileHoverCardLifeCycleNewSignal_51de774f{padding-left:15px}[dir='rtl'] .fileHoverCardLifeCycleNewSignal_51de774f{padding-right:15px}\n"},{"rawString":".fileHoverCardInsideLook_6d82b902{padding:16px 0 14px 4px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardInsideLook_6d82b902{margin-right:12px}[dir='rtl'] .fileHoverCardInsideLook_6d82b902{margin-left:12px}.fileHoverCardInsideLook_6d82b902 .fileHoverCardInsideLookTitle_6d82b902{font-size:14px;font-weight:600;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fileHoverCardInsideLook_6d82b902 .ms-TooltipHost{padding:0 8px;font-size:12px;vertical-align:middle;color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.fileHoverCardInsideLook_6d82b902 .ms-Button--icon{height:14px}.fileHoverCardReadTimeContainer_6d82b902{padding-top:6px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex}.fileHoverCardReadTimeContainer_6d82b902 .fileHoverCardReadTime_6d82b902{display:inline-block;vertical-align:middle;font-size:12px}.fileHoverCardReadTimeContainer_6d82b902 .fileHoverCardReadTimeIcon_6d82b902{font-size:14px;vertical-align:text-top;margin-right:8px;margin-top:1px}.fileHoverCardKeyPointsButton_6d82b902{padding-top:5px;padding-bottom:5px;margin:7px -24px 0px -16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;border:none;border-radius:0;height:100%;text-align:left;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.fileHoverCardKeyPointsNonButton_6d82b902{padding-top:5px;padding-bottom:5px;margin-top:7px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px}.fileHoverCardKeyPointsContent_6d82b902{padding-top:8px}.fileHoverCardKeyPointsAction_6d82b902{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;width:100%}.fileHoverCardKeyPointsCell_6d82b902{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:100%;padding-bottom:2px}.fileHoverCardKeyPointsText_6d82b902{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fileHoverCardKeyPointsBullet_6d82b902:before{content:' \\B7  '}.fileHoverCardKeyPointsBullet_6d82b902{display:inline-block}[dir='ltr'] .fileHoverCardKeyPointsBullet_6d82b902{padding-right:8px}[dir='rtl'] .fileHoverCardKeyPointsBullet_6d82b902{padding-left:8px}\n"},{"rawString":".fileHoverCardRecommendedSection_1e36f7f3{padding:16px 0px 2px 4px;font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardRecommendedSection_1e36f7f3{margin-right:12px}[dir='rtl'] .fileHoverCardRecommendedSection_1e36f7f3{margin-left:12px}.fileHoverCardRecommendedTitle_1e36f7f3{font-weight:600;padding-bottom:16px;display:inline-block}.fileHoverCardRecommendedMessage_1e36f7f3{margin-bottom:2px}.fileHoverCardShareWith_1e36f7f3{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:inline-block;content:attr(data-analytics-activity-end);font-size:12px}.fileHoverCardShareWithLink_1e36f7f3{padding:2px 0 16px 0;font-size:12px}.fileHoverCardChevronIcon_1e36f7f3{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";vertical-align:middle;padding-left:5px}[dir='ltr'] .fileHoverCardChevronIcon_1e36f7f3{padding-left:5px}[dir='rtl'] .fileHoverCardChevronIcon_1e36f7f3{padding-right:5px}.fileHoverCardRecommendedAction_1e36f7f3{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:-3px}.fileHoverCardRecommendedAction_1e36f7f3:hover .fileHoverCardCancelIcon_1e36f7f3{opacity:1}.fileHoverCardRecommendedIcon_1e36f7f3{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";margin-right:4px}.fileHoverCardCancelIcon_1e36f7f3{opacity:0}.fileHoverCardCancelIcon_1e36f7f3 .ms-Button-icon{font-size:8px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardCancelIcon_1e36f7f3 .ms-Button-flexContainer{-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.fileHoverCardRecommendedLink_1e36f7f3{display:block;padding-bottom:14px;font-size:12px;font-weight:600}[dir='ltr'] .fileHoverCardRecommendedLink_1e36f7f3{padding-left:28px}[dir='rtl'] .fileHoverCardRecommendedLink_1e36f7f3{padding-right:28px}.fileHoverCardActivity_1e36f7f3{height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";content:attr(data-analytics-activity-end);display:inline-block}.fileHoverCardUserName_1e36f7f3{content:attr(data-analytics-activity-start);font-weight:600;display:inline-block;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}\n"},{"rawString":".fileHoverCardCompactCard_a4cda702{padding:14px 12px 0}.isFluent .fileHoverCardCompactCardTitleRegion_a4cda702{margin-bottom:2px;display:-webkit-box;display:-ms-flexbox;display:flex;min-height:40px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:2px}[dir='ltr'] .isFluent .fileHoverCardCompactCardFileIcon_a4cda702{margin-right:14px}[dir='rtl'] .isFluent .fileHoverCardCompactCardFileIcon_a4cda702{margin-left:14px}.fileHoverCardCompactCardTitle_a4cda702{font-size:17px;font-weight:300;font-weight:400;line-height:20px;overflow:hidden;text-overflow:ellipsis;word-break:break-word;max-width:200px}.fileHoverCardCompactCardTitle_a4cda702.titleNotExpanded_a4cda702{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.isFluent .fileHoverCardCompactCardTitle_a4cda702{font-size:14px;font-weight:600;padding:0;white-space:normal}.fileHoverCardCompactCardActivity_a4cda702{padding:8px 0}.fileHoverCardExpandedCard_a4cda702{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-overflow:ellipsis;word-break:break-word;max-height:526px;min-height:1px}[dir='ltr'] .fileHoverCardExpandedCard_a4cda702{padding-left:12px}[dir='rtl'] .fileHoverCardExpandedCard_a4cda702{padding-right:12px}@media screen and (max-height: 660px){.fileHoverCardExpandedCard_a4cda702{max-height:50vh}}.fileHoverCardExpandedCardScrollableSection_a4cda702{overflow-y:auto;overflow-x:hidden;padding-left:12px;margin-left:-12px}.fileHoverCardExpandedCardLoadError_a4cda702{padding:120px 45px;font-size:14px;font-weight:400;text-align:center;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardExpandedCardLoadError_a4cda702 .fileHoverCardExpandedCardSuggestion_a4cda702{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardExpandedCardHostScroll_a4cda702{overflow-y:hidden;height:calc(100% - 1px)}.fileHoverCardActivitiesSection_a4cda702{padding:16px 0px 10px 4px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .fileHoverCardActivitiesSection_a4cda702{margin-right:12px}[dir='rtl'] .fileHoverCardActivitiesSection_a4cda702{margin-left:12px}.fileCardExpandSectionContainer_a4cda702{border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin-right:12px}.fileCardExpandSectionButton_a4cda702{width:100%;border:0;border-radius:0;text-align:left;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin-left:-12px;width:320px;padding-left:12px;padding-right:25px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.collapsedFileCardTooltip_a4cda702{text-align:right;height:18px;margin-right:12px;padding-top:2px;padding-right:15px;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}\n"},{"rawString":".fileHoverCardFeedbackTitle_504892f4{font-size:14px;font-weight:600;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardFeedbackTitle_504892f4 .fileHoverCardFeedbackTooltip_504892f4{vertical-align:middle}[dir='ltr'] .fileHoverCardFeedbackTitle_504892f4 .fileHoverCardFeedbackTooltip_504892f4{padding-left:8px}[dir='rtl'] .fileHoverCardFeedbackTitle_504892f4 .fileHoverCardFeedbackTooltip_504892f4{padding-right:8px}.fileHoverCardFeedbackOption_504892f4{font-size:14px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding:12px 0 28px}[dir='ltr'] .fileHoverCardFeedbackOption_504892f4 .fileHoverCardFeedbackChoiceLink_504892f4{padding-left:20px}[dir='rtl'] .fileHoverCardFeedbackOption_504892f4 .fileHoverCardFeedbackChoiceLink_504892f4{padding-right:20px}.fileHoverCardFeedbackMessage_504892f4{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";font-size:14px;font-weight:400;padding:12px 0 20px}.fileHoverCardFeedbackCheckbox_504892f4 .ms-Checkbox{padding:8px 0}.fileHoverCardFeedbackSubmit_504892f4{margin:16px 0 28px}.fileHoverCardFeedbackSubCheckbox_504892f4{font-size:12px}[dir='ltr'] .fileHoverCardFeedbackSubCheckbox_504892f4{padding-left:25px}[dir='rtl'] .fileHoverCardFeedbackSubCheckbox_504892f4{padding-right:25px}.fileHoverCardFeedbackSubCheckbox_504892f4 .ms-Checkbox-text{font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.fileHoverCardFeedbackSubCheckbox_504892f4 .ms-Checkbox-checkbox{width:16px;height:16px}\n"},{"rawString":".fileHoverCardKeyPointsEditor_d50df830{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.fileHoverCardKeyPointsEditorInputSection_d50df830{margin:12px 0}.fileHoverCardKeyPointsEditorSpinner_d50df830{padding-top:12px}.fileHoverCardKeyPointsEditorSpinner_d50df830 .ms-Spinner-circle{margin:0}.fileHoverCardKeyPointsEditorButtons_d50df830{padding-top:12px}.fileHoverCardKeyPointsEditorButtonCancel_d50df830{margin:0 12px}.fileHoverCardKeyPointsEditorAddKeyPointLink_d50df830{font-size:12px;font-weight:600;font-family:inherit}.fileHoverCardKeyPointsEditorCell_d50df830{-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0}.fileHoverCardKeyPointsEditorCell_d50df830 .ms-ActivityItem{width:100%;margin:12px}.fileHoverCardKeyPointsEditorCell_d50df830 .ms-ActivityItem-activityText{font-size:14px}.fileHoverCardKeyPointsEditorCell_d50df830:hover .fileHoverCardKeyPointsEditorDeleteIcon_d50df830,.fileHoverCardKeyPointsEditorCell_d50df830:focus .fileHoverCardKeyPointsEditorDeleteIcon_d50df830{opacity:1}.fileHoverCardKeyPointsEditorDeleteIcon_d50df830{opacity:0}.fileHoverCardKeyPointsEditorDeleteIcon_d50df830 .ms-Button-icon{font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}\n"},{"rawString":".od-DetailsList .ms-DetailsRow.is-dropping{background:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":";outline:1px solid transparent}.od-DetailsList .ms-DetailsRow.is-dropping .ms-DetailsRow-cell .FileTypeIcon-icon{transform:scale(1.5,1.5)}.od-DetailsList-groupHeader{margin-top:15px;margin-bottom:15px;font-size:17px}html[dir=ltr] .od-DetailsList-groupHeader{margin-left:96px}html[dir=rtl] .od-DetailsList-groupHeader{margin-right:96px}.od-DetailsListHeader-AddNewField{font-size:9px;color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}html[dir=ltr] .od-DetailsListHeader-AddNewField{margin-right:6px}html[dir=rtl] .od-DetailsListHeader-AddNewField{margin-left:6px}html[dir=ltr] .od-DetailsListHeader-AddNewField{padding-left:0}html[dir=rtl] .od-DetailsListHeader-AddNewField{padding-right:0}.ms-DetailsRow-cell.od-DetailsRow-cell--FileIcon{line-height:0;overflow:visible}.ms-DetailsRow-cell.od-DetailsRow-cell--Title{cursor:pointer}.ms-DetailsRow-cell [data-is-focusable=true]{outline:transparent;vertical-align:top}.ms-DetailsRow-cell .od-FieldRender-nofill{position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .ms-DetailsRow-cell .od-FieldRender-userFluent{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FieldRenderer-text{white-space:normal;overflow:hidden;max-height:7em}.od-FieldRenderer--disabled{opacity:.4}.od-DetailsHeader-cell--FileIcon span{display:inline-flex;justify-content:center;align-items:center}.od-userWithTopCollaborator{display:flex}.od-userWithTopCollaborator .ms-topCollaPlaceHolder{min-width:13px}html[dir=ltr] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-right:7px}html[dir=rtl] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-left:7px}.ms-DetailsRow-cell .od-FieldRender-lookup{display:block;max-width:100%}.od-DetailsRow-cell--VerticallyCenter{display:flex;flex-direction:column;justify-content:center}.ms-Fabric.is-focusVisible .ms-DetailsRow-cell [data-is-focusable=true]:focus:after{position:absolute;content:'';left:0;top:0;right:0;bottom:0;border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn{width:40px;padding:0;text-align:center}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn .ms-Icon{line-height:36px}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:active{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:focus{border:1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-left:8px}[dir=rtl] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-right:8px}.ms-DetailsHeader-cell .ms-Icon.ms-Icon--GroupedList{position:relative;top:1px}.ms-DetailsHeader-cell .od-DetailsListHeader-FileTypeIcon.ms-Icon{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-DetailsList-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.od-DetailsListHeader-FileTypeIcon{font-size:16px;padding:0}.od-DetailsHeader-cell--FileIcon .ms-Icon{width:18px;text-align:center}.od-DetailsRow-needsAttention{position:relative}.od-DetailsRow-needsAttention:after{content:'';position:absolute;top:0;bottom:0}html[dir=ltr] .od-DetailsRow-needsAttention:after{left:-3px}html[dir=rtl] .od-DetailsRow-needsAttention:after{right:-3px}html[dir=ltr] .od-DetailsRow-needsAttention:after{border-left:3px solid "},{"theme":"warningHighlight","defaultValue":"#ffb900"},{"rawString":"}html[dir=rtl] .od-DetailsRow-needsAttention:after{border-right:3px solid "},{"theme":"warningHighlight","defaultValue":"#ffb900"},{"rawString":"}.ms-DetailsRow-cell .ms-Icon--People{position:relative;top:2px}.od-DetailsList .FileTypeIcon{margin:0 -2px}.od-DetailsList .ms-DetailsRow-cell .od-FieldRender-truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-DetailsList .ms-DetailsList--Compact .od-DetailsRow-cell--FileIcon .FileTypeIcon{margin:0;padding:2px 0 0 0}.od-DetailsList .ms-DetailsList--Compact .ms-DetailsRow-check{width:32px;height:32px}.od-DetailsList .ms-DetailsList--Compact .od-FieldRenderer-shareHeroCommand i,.od-DetailsList .ms-DetailsList--Compact BUTTON.od-FieldRenderer-dot i{top:10px}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField,.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField{vertical-align:top;top:-1px;min-width:0}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue]{flex:1 1 auto!important}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal]{position:absolute}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore]{position:absolute;margin:0}.od-FieldRenderer-Renderer-withCommandAndMetata{display:flex;height:100%;width:100%}.od-FieldRenderer-Renderer-withCommandAndMetata button.od-FieldRender-display--link{width:100%}.od-FieldRenderer-dotDotDotContainer,.od-FieldRenderer-heroCommandContainer{display:inline-flex;flex-shrink:0;margin-top:-11px;margin-bottom:-11px}.od-FieldRenderer-dotDotDotContainer .od-FieldRenderer-pin,.od-FieldRenderer-heroCommandContainer .od-FieldRenderer-pin{position:relative}.od-FieldRenderer-dotDotDotContainer{position:absolute;height:100%}.ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px 0 -8px auto}html[dir=rtl] .ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px auto -8px 0}.od-FieldRenderer-Renderer-withMetadata{display:flex;flex-direction:column;justify-content:center;min-width:0;flex-grow:1;overflow:hidden}.od-VaultSection{display:inline-block}.od-FieldRenderer-Renderer-withCommands{display:flex;flex-direction:column}.od-DetailsList .ms-GroupHeader-expand{font-size:12px;margin-top:-8px}button.ms-DetailsRow-check{padding:0}@keyframes ItemScope-NewRow{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:210px;opacity:1}}@keyframes ItemScope-NewRow-compact{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:160px;opacity:1}}@keyframes ItemScope-FreshRow{0%{left:-10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow{0%{left:0;opacity:1}100%{left:10px;opacity:0}}@keyframes ItemScope-FreshRow-rtl{0%{left:10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow-rtl{0%{left:0;opacity:1}100%{left:-10px;opacity:0}}.ms-DetailsRow{animation-name:none;animation-duration:1.335s;animation-timing-function:ease-out;animation-iteration-count:1}.ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow}.ms-DetailsList--Compact .ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow-compact}.od-DetailsRow-accessible{display:block;overflow:hidden;position:absolute;top:-9000px;left:-9000px;height:1px;width:1px}.ms-DetailsList .ms-List-page .ms-List-cell{min-height:0}.ms-DetailsList--Compact .ms-List-cell .od-DetailsRow--fresh,.ms-List-cell .od-DetailsRow--fresh{min-height:0;overflow-y:hidden}.od-DetailsColumn-Refreshed{position:relative}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current,.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{position:absolute;width:100%;animation-fill-mode:both;animation-duration:267ms;animation-iteration-count:1}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-timing-function:cubic-out;animation-delay:267ms}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow-rtl}.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-timing-function:cubic-in}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow-rtl}"},{"rawString":".isFluent .ms-DetailsList .ms-DetailsRow.is-selected BUTTON.od-FieldRenderer-dot:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.ms-DetailsList BUTTON.od-FieldRenderer-dot{display:block;position:relative;left:0;top:0;width:36px;height:100%;text-align:center;outline:1px solid transparent;border:none;background-color:transparent;margin:0;padding:0;color:inherit;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";opacity:0;border-radius:0;cursor:pointer}.ms-DetailsList BUTTON.od-FieldRenderer-dot:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.ms-DetailsList BUTTON.od-FieldRenderer-dot i{position:absolute;top:14px;margin:auto;opacity:0}html[dir='ltr'] .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:10px}html[dir='rtl'] .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:10px}html[dir='ltr'] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:0}html[dir='rtl'] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:0}html[dir='ltr'] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:0}html[dir='rtl'] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:0}.od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{position:relative;top:1px}html[dir='ltr'] .od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{right:0}html[dir='rtl'] .od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{left:0}.od--isMobile .ms-DetailsList BUTTON.od-FieldRenderer-dot{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-dot,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-dot,.od--isNonMobile .od-FieldRenderer-dot:focus,.od--isNonMobile .is-selected .od-FieldRenderer-dot{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-dot i,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-dot i,.od--isNonMobile .od-FieldRenderer-dot:focus i,.od--isNonMobile .is-selected .od-FieldRenderer-dot i{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--DotDotDot{padding:0;overflow:visible}\n"},{"rawString":".isFluent .ms-DetailsList .ms-DetailsRow.is-selected .od-FieldRenderer-shareHeroCommand:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.od-FieldRenderer-shareHeroCommand{display:block;width:36px;position:relative;height:100%;text-align:center;outline:none;border:none;background-color:transparent;margin:0;padding:0;color:inherit;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";opacity:0;border-radius:0;cursor:pointer}.od-FieldRenderer-shareHeroCommand:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FieldRenderer-shareHeroCommand i{position:absolute;top:14px;margin:auto;opacity:0}html[dir='ltr'] .od-FieldRenderer-shareHeroCommand i{right:10px}html[dir='rtl'] .od-FieldRenderer-shareHeroCommand i{left:10px}.od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{position:relative;top:1px}html[dir='ltr'] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{right:0}html[dir='rtl'] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{left:0}.od--isMobile .od-FieldRenderer-shareHeroCommand{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus{opacity:1}.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus i{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--ShareCommand{padding:0;overflow:visible}\n"},{"rawString":".ms-ActivityItem-personaContainer{display:inline}.ms-CommandBar.ms-AnalyticsActionBar--bar{background-color:transparent;padding-left:0;padding-right:0}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{font-size:12px;font-weight:400}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-icon,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover .ms-Button-textContainer{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}"},{"rawString":".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-addCommentTextField-sendButton{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".od-addNewCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;max-height:174px;border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";border-radius:2px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup:hover{border-color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:2px;background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup:hover{border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-addNewCommentTextField-sendButton{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{"theme":"bodyText","defaultValue":"#323130"},{"rawString":"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";cursor:pointer;font-family:inherit}.isFluent .od-ItemActivity-item-clickableLinkText{font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:190px}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400;margin-top:-5px}.od-ItemActivity-personaIcon{position:absolute;top:0px;left:0px;width:100%;height:100%;border-radius:50%}\n"},{"rawString":".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"},{"rawString":".od-itemActivityMenu-dialogButton-default{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border:1px solid "},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.spo-ItemActivity-menuItems{min-width:120px;padding:0}\n"},{"rawString":".od-FieldRenderer-NameField-resopnsive-additionalInfo{color:"},{"theme":"bodySubtext","defaultValue":"#605e5c"},{"rawString":";font-size:12px;padding:5px 0 0 0}.xxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xxxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xxxxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.od-FieldRenderer-NameField-additionalInfo-sharedStatus{padding:0 0 0 8px}html[dir=rtl] .od-FieldRenderer-NameField-additionalInfo-sharedStatus{padding:0 8px 0 0}.xlg .od-FieldRenderer-NameField-resopnsive-additionalInfo:hover{display:none}.xlg .od-FieldRenderer-NameField-additionalInfo-modDate{display:none}.xlg .od-FieldRenderer-Renderer-withMetadata .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.xlg .is-selected .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xlg .ms-DetailsRow:hover .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.od-FieldRenderer-NameField-resopnsive-additionalInfo{padding:1px 0 0 0}.lg .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i,.md .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i,.sm .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i{opacity:1;font-size:20px}.lg .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand,.md .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand,.sm .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand{display:none}.lg .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo,.md .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo,.sm .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}"},{"rawString":".tempStyle{font-size:inherit}\n"},{"rawString":".ms-DetailsRow-cell .od-FieldRenderer-sharedWith{cursor:pointer}.ms-DetailsRow-cell .od-FieldRenderer-sharedWith:hover{text-decoration:underline}\n"},{"rawString":".od-IFrameDialog{border:none;width:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight{position:absolute;height:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight iframe{height:100%}.od-IFrameDialog-ProgressContainer{width:250px;padding:15px 0}"},{"rawString":".od-ParentHeightWatcher-iframe{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:0;visibility:hidden}"},{"rawString":".od-ItemActivityList-activity-withCommentResponse{display:inline-block;margin-bottom:0;margin-right:-38px}.od-ItemActivityList-activity{width:calc(100% -32px)}.od-ItemActivityList-activity .ms-Shimmer-container{width:100%}.od-ItemActivityList-activity .od-ItemActivity-item-textContent{word-wrap:break-word}.od-ItemActivityList-activity .od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-focusZone{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;max-width:100%}.od-ItemActivity-item-focusZone:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ItemActivity-contextMenu{display:inline-block;vertical-align:top;margin-top:6px}.od-ItemActivity-contextMenu .ms-Button-icon{color:#323130}.od-ItemActivity-contextMenu-opacity{opacity:0}.od-ItemActivity-contextMenu-opacity:focus{opacity:1}.od-itemActivity-commentActivity-commentContent{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";word-wrap:break-word}.od-itemActivity-commentActivity-commentContent a,.od-itemActivity-commentActivity-commentContent a:visited,.od-itemActivity-commentActivity-commentContent a:hover,.od-itemActivity-commentActivity-commentContent a:active{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}.od-ItemActivityList-missingActivity{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-ItemActivityList-activity-commentResponse{padding:8px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin-bottom:8px}.od-ItemActivityList-commentReply{padding:8px 8px 8px 24px}[dir='rtl'] .od-ItemActivityList-commentReply{padding:8px 24px 8px 8px}.od-ItemActivityList-commentReply .ms-ActivityItem-activityContent{width:182px}.od-ItemActivityList-loadMoreReplies{text-align:center;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-ItemActivityList-grouplistTitle{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .od-ItemActivityList-grouplistTitle{font-size:12px;font-weight:600}.od-ItemActivity-menuItems{min-width:108px;padding:0}.od-ItemActivityList-activity-withHiddenReply{padding:0}\n"},{"rawString":".mentionSuggestions_60205f1b{min-width:100%}.mentionField_60205f1b a[email-id]{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}\n"},{"rawString":".od-mentionableTextBox-buttons{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField-sendButton{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-mentionableTextBox-outer{width:auto;height:auto;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding:1px;border-width:1px;border-style:solid;-webkit-box-sizing:border-box;box-sizing:border-box;border-color:initial}.od-addNewCommentTextField-mentionableTextBox-outer-disabled{width:auto;height:auto;padding:0px;border-width:1px;border-style:solid;-webkit-box-sizing:border-box;box-sizing:border-box;border-color:#979593}.od-addNewCommentTextField-mentionableTextBox-outer:focus-within{padding:0px;border-width:2px;border-style:solid;border-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":" !important;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px}.od-addNewCommentTextField-mentionableTextBox{width:auto;height:auto;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border:none;outline:none;padding:2px 0px;margin:1px 8px}.od-addNewCommentTextField-mentionableTextBox a,.od-addNewCommentTextField-mentionableTextBox a:visited,.od-addNewCommentTextField-mentionableTextBox a:hover,.od-addNewCommentTextField-mentionableTextBox a:active{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}.od-addNewCommentTextField-mentionableTextBox-disabled{width:auto;height:auto;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";pointer-events:none;border:none;outline:none;padding:5px;opacity:0.4}.od-addNewCommentTextField-mentionableTextBox[placeholder]:empty:before{content:attr(placeholder)}.od-addNewCommentTextField-mentionableTextBox-disabled[placeholder]:empty:before{content:attr(placeholder)}\n"},{"rawString":".od-ItemActivity-SeeMoreText{font-family:\"Segoe UI\",-apple-system,BlinkMacSystemFont,\"Roboto\",\"Helvetica Neue\",sans-serif;font-style:normal;font-weight:600;font-size:10px;line-height:17px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";cursor:pointer}.od-ItemActivity-SeeMoreText:hover{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":";text-decoration:underline}\n"},{"rawString":".od-ItemActivityFeed-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".sp-livePersonaCardAdapter-root{display:inline-block}\n"},{"rawString":".InfoPane-itemDetails-notificationBellODB{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}.InfoPane-itemDetails-notificationBellODB--loading{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}"},{"rawString":".od-ItemActivityFeedWrapper .sp-livePersonaCardAdapter-root{font-family:inherit;font-size:inherit}.od-ItemActivityFeedWrapper{display:flex;flex-direction:column}.od-ItemActivityFeed-header-old{display:flex;align-items:center;margin-bottom:4px}.od-ItemActivityFeed-header{display:flex;align-items:center}.od-ItemActivityFeed-header .ms-TooltipHost{margin-left:auto}.od-ItemActivityFeed-title-old{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin:0}.isFluent .od-ItemActivityFeed-title-old{font-size:14px;font-weight:600}.od-ItemActivityFeed-title{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin:0 0 5px}.isFluent .od-ItemActivityFeed-title{font-size:14px;font-weight:600}.od-ItemActivityFeed-viewOption{padding:0;align-self:flex-end;width:auto;border:none;margin-left:-4px;font-weight:600;background-color:transparent}.od-ItemActivityFeed-viewOption.inListForm{font-size:18px;height:28px;padding:0 4px;margin-left:-8px;margin-bottom:8px;margin-top:2px}.od-ItemActivityFeed-viewOption.inListForm:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-ItemActivityFeed-viewOption-old{background-color:transparent;padding:0;align-self:flex-end;margin-left:auto;width:auto}.od-ItemActivityFeed-viewOption-old .ms-Button-label{font-weight:400}.od-ItemActivityFeed-menuItems{min-width:180px;padding:0}.od-ItemActivityFeed-menuItems .ms-ContextualMenu-icon{color:#323130}"},{"rawString":".od-DetailsPane-ItemActivityFeedSection{margin:12px 0;padding:0 16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";margin:8px 0;padding:14px 16px}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{padding:14px 16px;border-radius:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-grouplistTitle{margin-bottom:8px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withResponse{margin-bottom:0}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{margin:0 -38px 0 0;width:calc(100% - 32px)}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{margin:0 0 0 -38px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities{font-size:12px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 8px}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 8px 0 0}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 16px}html[dir=rtl] .isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 16px 0 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-timeStamp{padding-top:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-missingActivity{margin-bottom:8px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityTypeIcon{font-size:16px!important;width:32px;text-align:center;margin-top:8px}.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.Files-rightPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}.Files-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse,.OneUp-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}"},{"rawString":".od-ActivitiesFeed-sectionForEarlierChanges{margin-top:15px}"},{"rawString":"[dir=ltr] .od-ItemActivityTile-section{padding-right:10px}[dir=rtl] .od-ItemActivityTile-section{padding-left:10px}html[dir=ltr] .od-ItemActivityTile-identity{float:left}html[dir=rtl] .od-ItemActivityTile-identity{float:right}[dir=ltr] .od-ItemActivityTile-identity{margin-right:5px}[dir=rtl] .od-ItemActivityTile-identity{margin-left:5px}.od-ItemActivityTile-sectionExpandButton{font-size:17px;position:absolute;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .od-ItemActivityTile-sectionExpandButton{right:0}[dir=rtl] .od-ItemActivityTile-sectionExpandButton{left:0}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionExpandButton{transform:rotate(-180deg)}.od-ItemActivityTile-section .od-ItemActivityTile-sectionContent{display:none}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionContent{display:block}.od-ItemActivityTile-sectionHeader{padding:15px 0;min-height:40px}.od-ItemActivityTile-sectionContent{font-size:12px;min-height:40px}[dir=ltr] .od-ItemActivityTile-sectionContent{padding-left:25px}[dir=rtl] .od-ItemActivityTile-sectionContent{padding-right:25px}.od-ItemActivityTile-sectionToggle{cursor:pointer}.od-ItemActivityTile-sectionFocused{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}.od-ItemActivityTile-details{display:table}.od-ItemActivityTile-date{display:block}.odItemActivityTile-headline{display:block}.od-ItemActivityTile-entity{font-size:12px}html[dir=ltr] .od-ItemActivityTile-entity{float:left}html[dir=rtl] .od-ItemActivityTile-entity{float:right}.od-ItemActivityTile-entity .od-Persona{overflow:hidden;display:inline-block}.od-ItemActivityTile-entity .od-Persona.od-Persona--lg .od-Persona-image{width:40px;height:40px;line-height:40px}.od-ItemActivityTile-entity .od-Persona-details{display:none}.od-ItemActivityTile-ellipsisWrapper{white-space:nowrap}.od-ItemActivityTile-ellipsis{white-space:nowrap;max-width:130px;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:text-bottom}.od-ItemActivityTile-ellipsis:hover{cursor:pointer}"},{"rawString":".od-DetailsPane-LegacySection .InfoPane-section{padding:12px 16px;margin:12px 0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-DetailsPane-LegacySection .InfoPane-sectionHeader{position:relative}.od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:14px;font-weight:400}.isFluent .od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:14px;font-weight:600;margin:0 0 8px}.od-DetailsPane-LegacySection .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-DetailsPane-LegacySection .InfoPaneSection--properties{width:auto}.od-DetailsPane-LegacySection .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-DetailsPane-LegacySection .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation{font-size:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section{padding:0}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"},{"rawString":".InfoPane-extractedText-content{margin-bottom:10px;display:block}.InfoPane-extractedText-label{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-DetailsPane-LegacySection .InfoPaneSection--extractedText .InfoPane-sectionHeader{border-bottom:.5px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";padding-bottom:4px}"},{"rawString":".od-Caption-textField{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding-top:7px;border:none}.od-Caption-textField:hover{border-bottom:1px solid "},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-Caption-textField .ms-TextField-wrapper{border:none}.od-Caption-textField .ms-TextField-field{font-size:12px}"},{"rawString":".InfoPaneSection-informationBody{margin:0}.InfoPaneSection-informationBody dt{margin-bottom:3px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:14px;font-weight:600}.InfoPaneSection-informationBody dd{margin:0 0 16px 0;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.InfoPaneSection-entryTile{display:flex;flex-direction:row;align-items:center}[dir=ltr] .InfoPaneSection-copyButton{margin-left:2px}[dir=rtl] .InfoPaneSection-copyButton{margin-right:2px}.InfoPaneSection-information-folderType{display:inline}.InfoPaneSection-information-changeFolderType{margin-left:10px;margin-right:10px;text-decoration:none}.InfoPaneSection-information-changeFolderType:visited{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.InfoPaneSection-information-path{display:inline;word-break:break-all}.InfoPaneSection-information-path:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.InfoPaneSection-information-path:last-child:after{content:'';display:none}html[dir=rtl] .InfoPaneSection-information-path:after{content:'\\E76B'}.od-DetailsPane-LegacySection .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-DetailsPane-LegacySection .InfoPaneSection--information .InfoPane-sectionHeader .InfoPane-sectionHeaderText{border-bottom:.5px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";padding-bottom:4px}.od-InfoPane-ReactSections .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-InfoPane-ReactSections .InfoPaneSection--information .InfoPane-sectionHeader{display:none;padding:12px 16px}"},{"rawString":".od-InfoPane-ReactSections .InfoPane-section{padding:12px 16px;margin:12px 0;width:auto;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-InfoPane-ReactSections .InfoPane-sectionHeader{position:relative}.od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:400}.isFluent .od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:600;margin:0 0 8px}.od-InfoPane-ReactSections .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-InfoPane-ReactSections .InfoPaneSection--properties{width:auto}.od-InfoPane-ReactSections .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-InfoPane-ReactSections .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation{font-size:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section{padding:0}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"},{"rawString":".InfoPane-tags{margin-top:10px}.InfoPane-tag,.InfoPane-tag-old{font-size:12px;line-height:32px;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";display:inline-block;height:32px;margin:0 8px 8px 0;white-space:nowrap}html[dir=rtl] .InfoPane-tag,html[dir=rtl] .InfoPane-tag-old{margin:0 0 8px 8px}.isFluent .InfoPane-tag,.isFluent .InfoPane-tag-old{border:0;border-radius:2px;height:28px;line-height:28px;vertical-align:top;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.InfoPane-tag{border:none;height:24px;line-height:24px}.InfoPane-tagLink{display:inline-block;overflow:hidden;cursor:pointer;height:100%}.InfoPane-tagLink.newTagStyling{border:none;background-color:inherit}.isFluent .InfoPane-tagLink{border-radius:2px;padding:4px 8px}.isFluent .InfoPane-tagLink:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.InfoPane-tagName{display:inline-block;padding:0 8px;max-width:180px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .InfoPane-tagName{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding:0}.InfoPane-removeTag{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";width:32px;text-decoration:none;display:inline-block;vertical-align:top;text-align:center}.InfoPane-removeTag.newTagStyling{border:none;background-color:inherit}.isFluent .InfoPane-removeTag{width:28px;height:28px;border-radius:2px;padding:0 8px}.isFluent .InfoPane-removeTag:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.InfoPane-removeTag .od-LoadingSpinner-loadingGif{vertical-align:text-bottom}.InfoPane-removeTag:hover,.InfoPane-tagLink:hover,.od-Focus--enabled .InfoPane-removeTag:focus,.od-Focus--enabled .InfoPane-tagLink:focus{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";cursor:pointer}.InfoPane-tag-addTag{font-size:12px;display:inline-block;text-decoration:none;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";margin-top:5px}.InfoPane-tag-manageTagButton,.od-TaggingSection-addTagIconButton{text-decoration:none;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:12px;line-height:16px;display:block}.od-DetailsPane-LegacySection .InfoPaneSection--tags .InfoPane-sectionHeader{border-bottom:.5px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";padding-bottom:4px}.InfoPane-tagSectionHeaderText{display:contents}.od-TaggingSection-addTagIcon{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";width:32px;height:32px;border-radius:50%;position:relative;font-size:16px;box-sizing:border-box;align-content:center;border:1px solid transparent;display:inline-block;padding:7px;margin:10px 0 4px 0}html[dir=ltr] .InfoPane-tag-manageTagButton{float:right}html[dir=rtl] .InfoPane-tag-manageTagButton{float:left}.od-TaggingSection-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"},{"rawString":".BingMap-controls{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";box-sizing:border-box;width:213px;padding:3px}.BingMap-controls-icon{display:inline-block;cursor:pointer}.BingMap-controls-icon .ms-Icon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:10px}[dir=ltr] .BingMap-controls-icon:first-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:first-child{margin-left:5px}.BingMap-controls-icon:last-child{display:inline-block;margin-top:2px}html[dir=ltr] .BingMap-controls-icon:last-child{float:right}html[dir=rtl] .BingMap-controls-icon:last-child{float:left}[dir=ltr] .BingMap-controls-icon:last-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:last-child{margin-left:5px}"},{"rawString":".InfoPane-location-text{margin-top:10px}.od-DetailsPane-LegacySection .InfoPaneSection--location .InfoPane-sectionHeader{border-bottom:.5px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";padding-bottom:4px}.InfoPane-locationSectionHeaderText{display:contents}"},{"rawString":".ms-IFrameCtrl-title{font-size:17px}.ms-IFrameCtrl-iFrame{width:100%;border:0;min-height:200px}"},{"rawString":".InfoPaneSection--preview{width:auto;height:180px;position:relative;margin-bottom:8px}.InfoPaneSection--preview .od-ImageStack-tile{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.InfoPaneSection--preview .ms-IFrameCtrl-iFrame{min-height:180px;height:180px}.InfoPaneSection--viewCountLink{font-size:14px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:5px 20px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:40px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--notSupported{height:0}"},{"rawString":".od-DetailsPane-ItemPreviewSection{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--preview{margin-bottom:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink{padding:4px 16px}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:auto;padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item .ms-AnalyticsStats--stats{height:auto;padding:0}"},{"rawString":".od-SectionNotification{padding:12px 6px;display:flex}.od-SectionNotification-Warning{background-color:"},{"theme":"warningBackground","defaultValue":"#FFF4CE"},{"rawString":"}.od-SectionNotification-Error{background-color:"},{"theme":"errorBackground","defaultValue":"#FDE7E9"},{"rawString":"}.od-SectionNotification-icon{padding-top:4px;font-size:14px}html[dir=ltr] .od-SectionNotification-icon{padding-right:4px}html[dir=rtl] .od-SectionNotification-icon{padding-left:4px}html[dir=ltr] .od-SectionNotification-icon{padding-left:2px}html[dir=rtl] .od-SectionNotification-icon{padding-right:2px}.od-SectionNotification-text{flex:1}"},{"rawString":".InfoPaneSection--properties{width:100%;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.spo-Properties-editLink{line-height:26px;font-size:12px;color:"},{"theme":"link","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}html[dir=ltr] .spo-Properties-editLink{float:right}html[dir=rtl] .spo-Properties-editLink{float:left}.ReactClientForm.is-bulkEdit{position:absolute;display:flex;top:64px;left:0;right:0;flex-direction:column;overflow:hidden;width:auto}.ReactClientForm.is-bulkEdit .ReactClientFormFields{overflow-y:auto;padding:0 16px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";width:auto}.InfoPane .spo-Properties-clientForm .ReactClientForm.is-bulkEdit{top:116px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .od-ClientForm.is-bulkEdit{top:64px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .ReactClientForm .ReactClientForm-editButtons{padding-bottom:43px}.spo-Properties-sectionNotification{width:100%;overflow:auto}"},{"rawString":".InfoPaneSection-shortcutInformation table{border-spacing:0;width:100%}.InfoPaneSection-shortcutInformation tr:first-child td,.InfoPaneSection-shortcutInformation tr:first-child th{padding-top:0}.InfoPaneSection-shortcutInformation td,.InfoPaneSection-shortcutInformation th{padding:8px 0;width:50%;word-break:break-all}.InfoPaneSection-shortcutInformation th{vertical-align:top;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-weight:400}html[dir=ltr] .InfoPaneSection-shortcutInformation th{text-align:left}html[dir=rtl] .InfoPaneSection-shortcutInformation th{text-align:right}"},{"rawString":".od-PolicyTipMessageBar{padding:8px;display:flex}.od-PolicyTipMessageBar-content{display:flex;flex-direction:row}.od-PolicyTipMessageBar-text{font-size:12px;font-weight:400;display:flex;flex-direction:column;overflow-x:auto}.od-PolicyTipMessageBar-icon{font-size:16px}[dir=ltr] .od-PolicyTipMessageBar-icon{padding-right:8px}[dir=rtl] .od-PolicyTipMessageBar-icon{padding-left:8px}.od-PolicyTipMessageBar-block{background-color:#fde7e9}.od-PolicyTipMessageBar-block .od-PolicyTipMessageBar-icon{color:#a80000}.od-PolicyTipMessageBar-severeWarning{background-color:#fed9cc}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-icon{color:#d83b01}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-text{color:#323130}.od-PolicyTipMessageBar-warning{background-color:#fff4ce}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-icon{color:#323130}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-text{color:#323130}"},{"rawString":"[dir=ltr] .od-PolicyTipSection.InfoPane-section{padding-left:20px}[dir=rtl] .od-PolicyTipSection.InfoPane-section{padding-right:20px}.od-PolicyTipSection .InfoPane-sectionContent{padding:8px}.od-PolicyTipSection--notify{background-color:rgba(216,59,1,.2)}.od-PolicyTipSection--block{background-color:rgba(232,17,35,.2)}.od-PolicyTipSection-icon{padding-top:2px;font-size:17px}html[dir=ltr] .od-PolicyTipSection-icon{float:left}html[dir=rtl] .od-PolicyTipSection-icon{float:right}[dir=ltr] .od-PolicyTipSection-text{margin-left:25px}[dir=rtl] .od-PolicyTipSection-text{margin-right:25px}"},{"rawString":".InfoPaneSection--itemStatus{display:flex}html[dir=ltr] .InfoPaneSection--itemStatus .itemStatus-icon{margin-right:8px}html[dir=rtl] .InfoPaneSection--itemStatus .itemStatus-icon{margin-left:8px}.InfoPaneSection--itemStatus .itemStatus-message{font-size:14px;font-weight:400}"},{"rawString":".od-DetailsPane-ImageTagsSectionMargin{margin:20px}"},{"rawString":".od-DetailsPane-PrimaryPane-wrapper{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";overflow-x:hidden}.isFluent .od-DetailsPane-PrimaryPane-wrapper{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-DetailsPane-PrimaryPane{padding-bottom:12px}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane{padding-bottom:0}.od-DetailsPane-PrimaryPane-header{padding:10px 16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px;box-shadow:0 1px 3px rgba(0,0,0,.08);background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";display:flex;position:relative}.od-DetailsPane-PrimaryPane-header-icon{display:inline-block}.od-DetailsPane-PrimaryPane-header-icon .FileTypeIcon-icon{width:20px!important;height:20px!important}.od-DetailsPane-PrimaryPane-header-title{margin:0 0 0 12px;line-height:23px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-grow:1;font-size:14px}.isFluent .od-DetailsPane-PrimaryPane-header-title{font-weight:600}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane-body{height:0;overflow:hidden}.od-DetailsPane-PrimaryPane-header-close{height:unset}"},{"rawString":".od-DetailsPane-SecondaryPane-wrapper{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";overflow-x:hidden}.od-DetailsPane-SecondaryPane{padding-bottom:12px;box-shadow:0 -1px 6px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane.od-DetailsPane-SecondaryPane--disabled{padding-bottom:0}.od-DetailsPane-SecondaryPane-header{padding:0 16px;text-align:center;height:48px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";box-shadow:0 -1px 6px rgba(0,0,0,.01);font-size:12px;border:0;width:100%;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.isFluent .od-DetailsPane-SecondaryPane-header{font-size:12px}.ms-ScrollablePane-stickyAbove .od-DetailsPane-SecondaryPane-header{box-shadow:0 -1px 3px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane-header:hover{cursor:pointer}.od-DetailsPane-SecondaryPane-header.od-DetailsPane-SecondaryPane-header--CreateFocusIllusion{outline:1px solid transparent;box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset}.od-DetailsPane-SecondaryPane-header.od-DetailsPane-SecondaryPane-header--nonStickyHeaderButton{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-DetailsPane-SecondaryPane-header--headerClickDisabled:hover{cursor:default}.od-DetailsPane-SecondaryPane-header--disabled{display:none}.od-DetailsPane-SecondaryPane-body{position:relative}.od-DetailsPane-SecondaryPane-header-icon{padding-top:3px;font-size:17px}.isFluent .od-DetailsPane-SecondaryPane-header-icon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-DetailsPane-SecondaryPane-header-text{margin:0;font-size:12px;font-weight:400}"},{"rawString":".od-DetailsPaneWrapper{position:absolute;top:0;bottom:0;left:0;right:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=ltr] .od-DetailsPaneWrapper{border-left:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html[dir=rtl] .od-DetailsPaneWrapper{border-right:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-DetailsPane{height:100%;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-DetailsPane--secondaryPaneDisabled{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.od-DetailsPane-scrollablePane{overflow-x:hidden}.od-DetailsPane-GlobalSettingsMenu{height:unset}.od-DetailsPane-GlobalSettingsMenu .ms-Button-icon{color:#323130}.od-DetailsPane-GlobalSettingsMenuItems{min-width:160px;padding:0}"},{"rawString":".InfoPane{box-sizing:border-box;outline:0;position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.InfoPane::after,.InfoPane::before{display:table;content:'';line-height:0}.InfoPane::after{clear:both}.InfoPane-BackgroundColor{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.InfoPane-sectionHeaderText{font-size:17px;font-weight:300;margin-top:0;margin-bottom:0}.isFluent .InfoPane-sectionHeaderText{font-size:14px;font-weight:600}.InfoPane-section{padding:20px 20px 22px 40px;box-sizing:border-box;display:inline-block;width:100%}html[dir=rtl] .InfoPane-section{padding:20px 40px 22px 20px}.InfoPane-section.no-arrow{padding:20px 20px 22px 16px}html[dir=rtl] .InfoPane-section.no-arrow{padding:20px 16px 22px 20px}.InfoPane-section.no-arrow .InfoPane-sectionHeader{cursor:default}.isFluent .InfoPane-section.no-arrow{padding:20px 24px 22px}.InfoPane-sectionHeader{position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;height:32px;line-height:32px;cursor:pointer}.InfoPane-sectionHeader:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .InfoPane-sectionHeader:focus{outline:0}.InfoPane-sectionExpandButton.ms-Icon{font-size:17px;position:absolute;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .InfoPane-sectionExpandButton.ms-Icon{left:-32px}[dir=rtl] .InfoPane-sectionExpandButton.ms-Icon{right:-32px}.InfoPane-section.is-expanded .InfoPane-sectionExpandButton.ms-Icon{transform:rotate(-180deg)}.InfoPane-section .InfoPane-sectionContent{display:none}.InfoPane-section.is-expanded .InfoPane-sectionContent{display:block}.InfoPane-sectionContent{margin-top:10px;font-size:12px}.InfoPane-selectionMessage{margin:0 0 20px 14px}html[dir=rtl] .InfoPane-selectionMessage{margin:0 14px 20px 0}.lg .InfoPane-selectionMessage,.xlg .InfoPane-selectionMessage,.xxlg .InfoPane-selectionMessage,.xxxlg .InfoPane-selectionMessage,.xxxxlg .InfoPane-selectionMessage{margin-top:18px;font-size:21px}.od-InfoPane-selectFile{font-size:12px;font-weight:400;margin:0 0 20px 14px}html[dir=rtl] .od-InfoPane-selectFile{margin:0 14px 20px 0}"}]);return {FileHoverCard_module_7:{fileHoverCardCompactCard:'fileHoverCardCompactCard_a4cda702',fileHoverCardCompactCardTitleRegion:'fileHoverCardCompactCardTitleRegion_a4cda702',fileHoverCardCompactCardFileIcon:'fileHoverCardCompactCardFileIcon_a4cda702',fileHoverCardCompactCardTitle:'fileHoverCardCompactCardTitle_a4cda702',titleNotExpanded:'titleNotExpanded_a4cda702',fileHoverCardCompactCardActivity:'fileHoverCardCompactCardActivity_a4cda702',fileHoverCardExpandedCard:'fileHoverCardExpandedCard_a4cda702',fileHoverCardExpandedCardScrollableSection:'fileHoverCardExpandedCardScrollableSection_a4cda702',fileHoverCardExpandedCardLoadError:'fileHoverCardExpandedCardLoadError_a4cda702',fileHoverCardExpandedCardSuggestion:'fileHoverCardExpandedCardSuggestion_a4cda702',fileHoverCardExpandedCardHostScroll:'fileHoverCardExpandedCardHostScroll_a4cda702',fileHoverCardActivitiesSection:'fileHoverCardActivitiesSection_a4cda702',fileCardExpandSectionContainer:'fileCardExpandSectionContainer_a4cda702',fileCardExpandSectionButton:'fileCardExpandSectionButton_a4cda702',collapsedFileCardTooltip:'collapsedFileCardTooltip_a4cda702'},AnalyticsActivityList_module_2:{analyticsActivityListActivity:'analyticsActivityListActivity_daf74312'},AnalyticsActivity_module_8:{analyticsActivity:'analyticsActivity_a9cbc3a9',analyticsActivityUserAction:'analyticsActivityUserAction_a9cbc3a9',analyticsActivityUserName:'analyticsActivityUserName_a9cbc3a9'},AnalyticsStats_module_2:{analyticsStatsContainer:'analyticsStatsContainer_961d387d',analyticsStats:'analyticsStats_961d387d',analyticsStatsNoLink:'analyticsStatsNoLink_961d387d',analyticsStatsLink:'analyticsStatsLink_961d387d',analyticsStatsViewsNoLink:'analyticsStatsViewsNoLink_961d387d',analyticsStatsViews:'analyticsStatsViews_961d387d',analyticsStatsViewsDivider:'analyticsStatsViewsDivider_961d387d',analyticsStatsViewsDividerNoDot:'analyticsStatsViewsDividerNoDot_961d387d',analyticsStatsErrorMessage:'analyticsStatsErrorMessage_961d387d',fileHoverCardErrorIcon:'fileHoverCardErrorIcon_961d387d',analyticsStatsTeachingMessage:'analyticsStatsTeachingMessage_961d387d',analyticsStatsInfo:'analyticsStatsInfo_961d387d',analyticsStatsLabel:'analyticsStatsLabel_961d387d',analyticsStatsCount:'analyticsStatsCount_961d387d'},SocialBar_2:{commandLink:'commandLink_32ce514b',link:'link_32ce514b',pageUsageChartContainer:'pageUsageChartContainer_32ce514b',root:'root_32ce514b',socialBarList:'socialBarList_32ce514b',socialBarPanel:'socialBarPanel_32ce514b',socialBarPanelContent:'socialBarPanelContent_32ce514b',spSocialPanelPivotContent:'spSocialPanelPivotContent_32ce514b',socialBarPanelHeader:'socialBarPanelHeader_32ce514b',socialBarPanelHeaderText:'socialBarPanelHeaderText_32ce514b',socialBarPanelPersona:'socialBarPanelPersona_32ce514b',socialBarPanelPersonaDescription:'socialBarPanelPersonaDescription_32ce514b',viewsIcon:'viewsIcon_32ce514b',analyticsStatsLink:'analyticsStatsLink_32ce514b'},AnalyticsActionBar_module_4:{analyticsActionBarStats:'analyticsActionBarStats_fd0f390e',analyticsActionBar:'analyticsActionBar_fd0f390e'},AnalyticsLifeCycle_module_8:{fileHoverCardLifeCycle:'fileHoverCardLifeCycle_51de774f',fileHoverCardLifeCycleMessage:'fileHoverCardLifeCycleMessage_51de774f',fileHoverCardLifeCycleTitle:'fileHoverCardLifeCycleTitle_51de774f',fileHoverCardLifeCycleAction:'fileHoverCardLifeCycleAction_51de774f',fileHoverCardLifeCycleNewSignal:'fileHoverCardLifeCycleNewSignal_51de774f'},AnalyticsKeyPoints_module_6:{fileHoverCardInsideLook:'fileHoverCardInsideLook_6d82b902',fileHoverCardInsideLookTitle:'fileHoverCardInsideLookTitle_6d82b902',fileHoverCardReadTimeContainer:'fileHoverCardReadTimeContainer_6d82b902',fileHoverCardReadTime:'fileHoverCardReadTime_6d82b902',fileHoverCardReadTimeIcon:'fileHoverCardReadTimeIcon_6d82b902',fileHoverCardKeyPointsButton:'fileHoverCardKeyPointsButton_6d82b902',fileHoverCardKeyPointsNonButton:'fileHoverCardKeyPointsNonButton_6d82b902',fileHoverCardKeyPointsContent:'fileHoverCardKeyPointsContent_6d82b902',fileHoverCardKeyPointsAction:'fileHoverCardKeyPointsAction_6d82b902',fileHoverCardKeyPointsCell:'fileHoverCardKeyPointsCell_6d82b902',fileHoverCardKeyPointsText:'fileHoverCardKeyPointsText_6d82b902',fileHoverCardKeyPointsBullet:'fileHoverCardKeyPointsBullet_6d82b902'},RecommendedActions_module_4:{fileHoverCardRecommendedSection:'fileHoverCardRecommendedSection_1e36f7f3',fileHoverCardRecommendedTitle:'fileHoverCardRecommendedTitle_1e36f7f3',fileHoverCardRecommendedMessage:'fileHoverCardRecommendedMessage_1e36f7f3',fileHoverCardShareWith:'fileHoverCardShareWith_1e36f7f3',fileHoverCardShareWithLink:'fileHoverCardShareWithLink_1e36f7f3',fileHoverCardChevronIcon:'fileHoverCardChevronIcon_1e36f7f3',fileHoverCardRecommendedAction:'fileHoverCardRecommendedAction_1e36f7f3',fileHoverCardCancelIcon:'fileHoverCardCancelIcon_1e36f7f3',fileHoverCardRecommendedIcon:'fileHoverCardRecommendedIcon_1e36f7f3',fileHoverCardRecommendedLink:'fileHoverCardRecommendedLink_1e36f7f3',fileHoverCardActivity:'fileHoverCardActivity_1e36f7f3',fileHoverCardUserName:'fileHoverCardUserName_1e36f7f3'},AnalyticsKeyPointsEditor_module_1:{fileHoverCardKeyPointsEditor:'fileHoverCardKeyPointsEditor_d50df830',fileHoverCardKeyPointsEditorInputSection:'fileHoverCardKeyPointsEditorInputSection_d50df830',fileHoverCardKeyPointsEditorSpinner:'fileHoverCardKeyPointsEditorSpinner_d50df830',fileHoverCardKeyPointsEditorButtons:'fileHoverCardKeyPointsEditorButtons_d50df830',fileHoverCardKeyPointsEditorButtonCancel:'fileHoverCardKeyPointsEditorButtonCancel_d50df830',fileHoverCardKeyPointsEditorAddKeyPointLink:'fileHoverCardKeyPointsEditorAddKeyPointLink_d50df830',fileHoverCardKeyPointsEditorCell:'fileHoverCardKeyPointsEditorCell_d50df830',fileHoverCardKeyPointsEditorDeleteIcon:'fileHoverCardKeyPointsEditorDeleteIcon_d50df830'},AnalyticsKeyPointsFeedback_module_9:{fileHoverCardFeedbackTitle:'fileHoverCardFeedbackTitle_504892f4',fileHoverCardFeedbackTooltip:'fileHoverCardFeedbackTooltip_504892f4',fileHoverCardFeedbackOption:'fileHoverCardFeedbackOption_504892f4',fileHoverCardFeedbackChoiceLink:'fileHoverCardFeedbackChoiceLink_504892f4',fileHoverCardFeedbackMessage:'fileHoverCardFeedbackMessage_504892f4',fileHoverCardFeedbackCheckbox:'fileHoverCardFeedbackCheckbox_504892f4',fileHoverCardFeedbackSubmit:'fileHoverCardFeedbackSubmit_504892f4',fileHoverCardFeedbackSubCheckbox:'fileHoverCardFeedbackSubCheckbox_504892f4'},MentionPeoplePicker_module_7:{mentionSuggestions:'mentionSuggestions_60205f1b',mentionField:'mentionField_60205f1b'}}});