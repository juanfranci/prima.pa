var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_notifications_start"),(window.suiteux_shell_webpackJsonp_main=window.suiteux_shell_webpackJsonp_main||[]).push([["notifications"],{285:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n(27),o=n(10),s=n(3),r=n(1),c=n(17),l=n(181),d=n(0),p=n(26),f=n(44),u=n(54),b=n(9),m=n(16),h=n(5),g=n(31),S=n(153),y=function(e){function t(t){return e.call(this,t)||this}return Object(d.__extends)(t,e),t.prototype.getUnseenItemsCount=function(){var e=this,t=0;return null!=this.props.notifications&&this.props.notifications.length>0&&this.props.notifications.forEach((function(n){if((e.props.includeUnseenMailInCount||n.providerType!==S.a.NewMailNotification)&&n.providerType!==S.a.ChatNotification)if(n.providerType===S.a.NewAppNotification&&n.payload){var i=n.payload;t+=i.UnseenCount}else 0!==n.toastState&&1!==n.toastState||t++})),t},t.prototype.componentDidMount=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.componentDidUpdate=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.render=function(){var e=this.getUnseenItemsCount(),t=Object(s.I)(h.a.UnreadBadge_Title,e.toString(),h.a.Bell_Title);return i.createElement(s.r,{unseenItemCount:e,isParentHovered:this.props.isParentHovered,badgeStyles:this.props.badgeStyles},i.createElement("label",{htmlFor:this.props.bellAriaID,id:this.props.bellAriaLabelID,className:s.P.visuallyHidden},t))},t}(i.Component),v=Object(o.b)((function(e,t){return{notifications:e.notificationState.notifications,includeUnseenMailInCount:!Object(g.c)(e.shellInitDataState.clientData.WorkloadId),isParentHovered:t.isParentHovered,badgeStyles:t.badgeStyles}}))(y),I=function(e){function t(t){var n=e.call(this,t)||this;return n.setBellAriaLabel=function(e){n.setState({bellAriaLabel:e})},n.state={isHovered:!1,bellAriaLabel:null},n}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(r.e)().perfMarker("BellTimeToInteractive")},t.prototype.render=function(){var e=this,t=!0;this.props.notifications&&this.props.notifications.some((function(e){return 3!==e.toastState}))&&(t=!1);var n=t&&this.props.isActive?h.a.Notification_Title+", "+h.a.NoNewNotifications+", "+h.a.NoNewCheckLaterNote:h.a.Notification_Title,a={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:null==this.state.bellAriaLabel?n:null,ariaLabelledBy:this.state.bellAriaLabel,affordanceMenuItemText:h.a.Notifications,iconID:"Ringer",iconFontSize:b.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?i.createElement(f.b,Object(d.__assign)({},a),i.createElement(v,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:c.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:m.headerButtonBadgePosition})):i.createElement(f.a,Object(d.__assign)({},a),i.createElement(v,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:c.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:u.affordanceContextMenuItemBadgePosition}))},t}(i.Component),A=Object(o.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,id:t&&t.id,isActive:e.flexPaneState&&"Notifications"===e.flexPaneState.activeProviderKey,notifications:e.notificationState.notifications,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,n){t.stopPropagation(),Object(r.e)().click("Notifications","NotificationsPane",null,null,"Active state: "+n.isActive+", Render context: "+n.renderContext),n.onClick&&n.onClick(t),e(Object(s.eb)(t.currentTarget&&t.currentTarget.id)),e(Object(p.f)("Notifications"))}}}),(function(e,t,n){var i=Object(d.__assign)(Object(d.__assign)({},n),e);return Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},i),t),{onClick:function(e){return t.onClick(e,i)}})}))(I),O=n(470),x=n(472),T=n(487),w=n(160),C=n(13),_=n(158),E=n(300),N=n(557),R=n(302),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onToastActionClick=function(e){switch(e.preventDefault(),e.stopPropagation(),Object(r.e)().click("NotificationClick","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType),t.props.notificationPayload.type){case _.a.message:case _.a.call:try{t.props.notificationPayload.actionLink.action()}catch(e){Object(r.e)().exception("ChatNotification_AcceptError",6,e)}break;case _.a.summary:t.props.onRecentsOpen(!0)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Close","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType);try{t.props.notificationPayload.cancelLink.action()}catch(e){Object(r.e)().exception("ChatNotification_CancelError",6,e)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.handleOnError=function(){Object(r.e)().tag("ChatNotification_MePhoto_LoadError",4)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){if(null==this.props.notificationPayload)return null;var e=null,t=Object(C.a)();switch(this.props.notificationPayload.type){case _.a.message:e=i.createElement("div",{className:Object(s.y)(N.chatContent),onClick:this.onToastActionClick,role:"group"},i.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},i.createElement("div",{className:Object(s.y)(N.PersonaImage,s.P.tableCellMiddle)},i.createElement(w.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),i.createElement("div",{className:s.P.tableCellMiddle},i.createElement("span",{className:Object(s.y)(N.chatTitle,N.chatText,E.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),i.createElement("div",null,i.createElement("div",{className:N.chatIcon},i.createElement(s.f,{className:Object(s.y)(E.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),i.createElement("span",{className:Object(s.y)(s.P.maxWidth,N.chatText,N.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description)))));break;case _.a.call:e=i.createElement("div",null,i.createElement("div",{className:Object(s.y)(N.chatContent)},i.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},i.createElement("div",{className:Object(s.y)(N.PersonaImage,s.P.tableCellMiddle)},i.createElement(w.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),i.createElement("div",{className:s.P.tableCellMiddle},i.createElement("span",{className:Object(s.y)(N.chatTitle,N.chatText,E.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),i.createElement("div",null,i.createElement("div",{className:N.chatIcon},i.createElement(s.f,{className:Object(s.y)(E.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),i.createElement("span",{className:Object(s.y)(s.P.maxWidth,N.chatText,N.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description))))),i.createElement("div",{className:Object(s.y)(E.actionBar,t.neutral.accent.font,t.neutral.light.border)},i.createElement("button",{type:"button",onClick:this.onToastActionClick,className:Object(s.y)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},h.a.Accept),i.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(s.y)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},h.a.Ignore)));break;default:e=i.createElement("div",{className:Object(s.y)(N.condensed),onClick:this.onToastActionClick,role:"group"},i.createElement(s.f,{className:Object(s.y)(E.icon,N.condensedIcon),fontIconCss:"ms-Icon--OfficeChat"}),i.createElement("span",{className:Object(s.y)(N.condensedText,t.neutral.dark.font)},this.props.notificationPayload.description))}return i.createElement("div",{onContextMenu:R.f},i.createElement("button",{type:"button",className:Object(s.y)(E.closeButton,t.neutral.secondary.font,t.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":h.a.DismissNotification},i.createElement(s.f,{className:E.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),i.createElement("div",{className:Object(s.y)(N.toastContent),id:this.props.notificationPayload.id},e))},t}(i.Component),D=n(122),j=Object(o.b)(null,(function(e){return{onRecentsOpen:function(t){e(Object(D.c)(t))}}}))(P),k=n(559),U=n(475),M=n(360),L=function(e){function t(t){var n=e.call(this,t)||this;return n.clearTimer=function(e){if(null!=n.state.timers[e]){var t=n.state.timers;t[e]=clearTimeout(t[e])}},n.addDocumentListenter=function(){n.props.isNotificationsEnabled&&document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&M.a.ProcessGetReminderFromServer()}))},n.setTimer=function(e){var t=n.state.timers;t[e]=setTimeout((function(){return n.props.onClose(e)}),4e3),n.setState({timers:t})},n.state={timers:[],top:50},Object(r.b)().subscribe("ShyHeaderActivated",(function(e){n.setState({top:e?8:50})}),!0),n.addDocumentListenter(),n}return Object(d.__extends)(t,e),t.prototype.render=function(){var e,t,n,a=this,o=null!=this.props.notifications&&this.props.notifications.filter((function(e){return 0===e.toastState})),r=!0,c=null,l=this.props,p=null;if(o&&0!==o.length&&(this.props.isNotificationsEnabled||this.props.chatEnabled)){if(this.props.areToastsMuted&&(o.forEach((function(e){e&&e.providerType!==S.a.ReminderNotification&&e.providerType!==S.a.SystemAlert&&e.payload&&e.payload.id&&window.setTimeout((function(){return a.props.onClose(e.payload.id)}),0)})),r=!1),document.hidden)o.filter((function(e){return 0===e.toastType})).length>0&&(r=!1);p=o.filter((function(e){return e.providerType===S.a.ReminderNotification})),c=o.filter((function(e){return e.providerType!==S.a.ReminderNotification})).slice(0,R.g),t={dismiss:this.props.dismiss,onToastClose:this.props.onClose,snoozeReminders:this.props.snoozeReminders,setTimer:this.setTimer,clearTimer:this.clearTimer,notificationConfiguration:l,notificationSetting:this.props.notificationPreferencesData,dismissAll:this.props.dismissAll,removeReminder:this.props.removeReminder,alertImpressionLogEnabled:this.props.alertImpressionLogEnabled},p.length>0&&(null===(e=l.notificationPreferencesData)||void 0===e?void 0:e.EnableReminders)&&(n=i.createElement(T.a,Object(d.__assign)({},t,{notifications:p})))}else r=!1;return i.createElement(i.Fragment,null,i.createElement("div",{"aria-live":"polite",role:"region","aria-relevant":"additions text",ref:function(e){return a.ariaLiveContainer=e}}),r&&l.notificationPreferencesData&&(c.length>0||p.length>0)&&o.length>0&&i.createElement(s.h,{className:Object(s.y)(k.popupControl),focusTrapSelector:"a[href],button",noFocusOnRender:!0,isPersistant:!0,popupPosition:this.props.isRtl?{top:this.state.top,left:0}:{top:this.state.top,right:0},renderHost:this.ariaLiveContainer},i.createElement("div",{className:Object(s.y)(k.toastContainer),id:"popupContent","aria-label":o.length>1?h.a.NotificationsPopup:h.a.NotificationPopup,role:"region"},p.length>0&&this.getToast(n,p[0],!1),c.length>0&&c.map((function(e){return n=null,e.providerType===S.a.NewMailNotification&&l.notificationPreferencesData&&l.notificationPreferencesData.EnableNewItemNotify?n=i.createElement(O.a,Object(d.__assign)({notification:e},t,{notificationConfiguration:l})):e.providerType===S.a.SystemAlert?n=i.createElement(x.a,Object(d.__assign)({notification:e},t)):a.props.chatEnabled&&e.providerType===S.a.ChatNotification&&(l.notificationPreferencesData.EnableChat||l.notificationPreferencesData.EnableCalling)&&(n=i.createElement(j,Object(d.__assign)({notification:e},t,{notificationPayload:e.payload}))),null!=n&&a.getToast(n,e,e.subType===_.a.call)})))))},t.prototype.getToast=function(e,t,n){if(null==e)return null;var a=Object(R.c)(t,this.props),o=Object(C.a)();return i.createElement("div",{key:t.payload.id,className:Object(s.y)(U.toastSlot,E.notificationToast,o.neutral.light.border,o.neutral.foreground.background)},e,""!==a&&i.createElement(s.a,{source:a,id:t.payload.id,loop:n,type:"audio/mpeg"}))},t}(i.Component),F=n(295),B=Object(o.b)((function(e){return{notifications:e.notificationState.notifications,chatEnabled:e.chatState&&e.chatState.chatEnabled,isRtl:e.userState&&e.userState.isRtl,isNotificationsEnabled:null!=e.notificationState&&null!=e.notificationState.notificationsEnabled&&e.notificationState.notificationsEnabled,areToastsMuted:null!=e.notificationState&&e.notificationState.toastsMuted,isSystemNotificationsDisabled:null!=e.notificationState&&null!=e.notificationState.systemNotificationsDisabled&&e.notificationState.systemNotificationsDisabled,owaLaunchUrl:Object(s.J)(e.appsDataState.apps),mailNotificationAudioUrl:e.shellInitDataState.clientData.MailNotificationAudioUrl,systemNotificationAudioUrl:e.shellInitDataState.clientData.SystemNotificationAudioUrl,calendarNotificationAudioUrl:e.shellInitDataState.clientData.CalendarNotificationAudioUrl,callNotificationAudioUrl:e.shellInitDataState.clientData.CallNotificationAudioUrl,chatNotificationAudioUrl:e.shellInitDataState.clientData.ChatNotificationAudioUrl,workloadID:e.shellInitDataState.clientData.WorkloadId,notificationPreferencesData:e.notificationState.notificationPreferencesData,alertImpressionLogEnabled:e.shellInitDataState.clientData.AlertImpressionLogEnabled,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{setToastStatus:function(t,n,i,a){e(Object(F.h)(t,n,i,a))},onClose:function(t){e(Object(F.h)([t],1))},dismissAll:function(t,n){void 0===n&&(n=[]),e(Object(F.d)(t,n))},dismiss:function(t,n){e(Object(F.e)(t,n))},removeReminder:function(t){e(Object(F.m)(!0,null,t))},snoozeReminders:function(t,n){e(Object(F.j)(t,n))}}}))(L),z=n(485),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isNotificationsEnabled&&(this.props.isSubscriptionReady||this.subscribe(this.props))},t.prototype.componentWillReceiveProps=function(e){this.isNotificationSettingUpdate(this.props,e)&&this.props.isSubscriptionReady&&(z.a.config.notificationPreferencesData=e.notificationPreferencesData)},t.prototype.componentDidUpdate=function(e){this.props.isNotificationsEnabled!==e.isNotificationsEnabled&&this.props.isNotificationsEnabled&&!this.props.isSubscriptionReady&&this.subscribe(this.props)},t.prototype.render=function(){return null},t.prototype.isNotificationSettingUpdate=function(e,t){if(e&&t&&e.notificationPreferencesData&&t.notificationPreferencesData){var n=e.notificationPreferencesData,i=t.notificationPreferencesData;return n.EnableNewItemNotify!==i.EnableNewItemNotify||n.EnableReminders!==i.EnableReminders}return!1},t.prototype.subscribe=function(e){e.isNotificationsEnabled&&e.hasEXOLicense&&this.props.subscribe(e)},t}(i.Component),H=Object(o.b)((function(e){return{isSubscriptionReady:e.notificationState.isSubscriptionReady,isNotificationsEnabled:e.notificationState.notificationsEnabled&&e.notificationState.bellHeaderButtonInLayout,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,notificationPreferencesData:e.notificationState.notificationPreferencesData,owaLaunchUrl:Object(s.J)(e.appsDataState.apps),isSystemNotificationsDisabled:e.notificationState.systemNotificationsDisabled,doNotFetchSystemAlertsFromPortal:e.shellInitDataState.clientData.DoNotFetchSystemAlertsFromPortal,upn:e.userState.upn,workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{updateNotificationPreferences:function(t){e(Object(s.gb)(t))},subscribe:function(t){return e(Object(F.k)(t))}}}))(G),W=n(474),V=n(49),K=n(473),Y=[S.a.NewAppNotification];function Q(e,t,n){var i=e.notificationPreferencesData,a=e.notificationsEnabled,o=e.systemNotificationsDisabled;t&&(a=!!t.NotificationsEnabled&&t.NotificationsEnabled,o=null==t.SystemNotificationsDisabled||t.SystemNotificationsDisabled);var r=e.bellHeaderButtonInLayout;return null!=n&&n.centerCustomizationRegion&&(r=null!=Object(s.E)("NotificationBellIcon",n.centerCustomizationRegion.children)),Object(d.__assign)(Object(d.__assign)({},e),{notificationsEnabled:a,bellHeaderButtonInLayout:r,systemNotificationsDisabled:o,notificationPreferencesData:i})}function Z(e,t){var n=e.notifications.slice(0);return t.providerType===S.a.NewAppNotification&&(n=n.filter((function(e){return Y.indexOf(e.providerType)<0}))),n.push(t),Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}function q(e,t,n,i){if(e.providerType===S.a.NewAppNotification){var a=e.payload;null!=a&&(a.UnseenCount=0,e.toastState=t)}e.toastState=t,null!=n&&(e.isCondensed=n),null!=i&&(e.condensedCount=i)}var J={notificationState:function(e,t){if(!e){var n=t.shellInitData.shellInitDataState;e=Q(s.Q,n.clientData||{},n.layout)}var i=e;switch(t.type){case s.j:return Q(e,t.shellClientData);case s.k:return Q(e,void 0,t.shellLayout);case s.q:return function(e,t){return Object(d.__assign)(Object(d.__assign)({},e),{notificationPreferencesData:t.notificationPreferenceData})}(e,t);case W.a:return function(e,t){if(void 0===t.payload)return e;if(void 0!==t.payload.providerType)e=Z(e,t.payload);else if("string"==typeof t.payload&&null!=t.payload){var n=JSON.parse(t.payload);n.providerType===S.a.ReminderNotification&&function(e){var t=e.payload.reminder.ReminderItemDataModel;t.ReminderTime=V.a.parseISO8601DateTime(t.ReminderTime.toString()),t.StartDate=V.a.parseISO8601DateTime(t.StartDate.toString()),t.EndDate=V.a.parseISO8601DateTime(t.EndDate.toString());var n=new K.a(t);e.payload.reminder=n}(n),e=Z(e,n)}return function(e){var t=e.notifications.slice(0),n=t.filter((function(e){return 0===e.toastState&&e.providerType===S.a.NewMailNotification}));if(n.length>R.g)return t.forEach((function(e){e===n[0]?q(e,0,!0,n.length):n.slice(1).indexOf(e)>-1&&(e.toastState=1)})),Object(d.__assign)(Object(d.__assign)({},e),{notifications:t});return e}(e)}(e,t);case W.l:return function(e,t){var n=e.notifications.slice(0);if(t.isRemoved)return n=n.filter((function(e){return e.payload.id!==t.id})),Object(d.__assign)(Object(d.__assign)({},e),{notifications:n});if(null!==t.reminder)return n.forEach((function(e){e.payload.id===t.id&&(e.payload.reminder=t.reminder)})),Object(d.__assign)(Object(d.__assign)({},e),{notifications:n});return e}(e,t);case W.h:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];if(t.ids.indexOf(o.payload.id)>-1){q(o,t.toastStatus,t.isCondensed,t.condensedCount);break}}return Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e,t);case W.f:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];0!==o.toastState&&1!==o.toastState||q(o,2)}return Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e);case W.d:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];o.providerType===t.providerType&&q(o,3)}return Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e,t);case W.e:return function(e,t){for(var n=e.notifications.slice(0),i=0,a=n;i<a.length;i++){var o=a[i];t.id===o.payload.id&&q(o,3)}return Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e,t);case W.b:return function(e,t){if(null===t.notifications)return e;var n=e.notifications.slice(0);return t.notifications.forEach((function(e){n.push(e)})),Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e,t);case W.c:return function(e,t){var n=e.notifications.slice(0);return n.push({providerType:S.a.SystemAlert,payload:{systemAlert:t.alertData,id:t.alertData.Id},toastType:t.alertData.NotificationToastShouldPersist?1:0,toastState:0,navigationUrl:t.alertData.ActionUrl}),Object(d.__assign)(Object(d.__assign)({},e),{notifications:n})}(e,t);case W.i:i=function(e,t){return Object(d.__assign)(Object(d.__assign)({},e),{showSettings:t.shouldShowSettings})}(e,t);break;case W.j:i=function(e,t){return Object(d.__assign)(Object(d.__assign)({},e),{futureReminders:t.futureReminders})}(e,t);break;case W.k:i=function(e,t){return Object(d.__assign)(Object(d.__assign)({},e),{isSubscriptionReady:t.isReady})}(e,t);break;case W.g:i=function(e,t){return Object(d.__assign)(Object(d.__assign)({},e),{toastsMuted:t.muted})}(e,t)}return i}},X=n(325),$=function(){function e(){}return e.prototype.AddSystemNotification=function(e,t,n,i,a,o,c){null==e||null==t||null==n||null==i||null==o||null===c&&null==a||(Object(r.e)().impression("SystemAlert_NotificationShim","Apps_Notifications",0,null,o),Object(s.L)().dispatch(Object(F.c)({Title:e,Message:t,ActionUrl:n,ActionText:i,ActionTarget:a,Id:o,ActionCallback:c,NotificationToastShouldPersist:!0})))},e.prototype.AddNotification=function(e){Object(r.e)().impression("NotificationShim","Apps_Notifications"),Object(s.L)().dispatch(Object(F.a)(e))},e.prototype.MuteToasts=function(){Object(s.L)().dispatch(Object(F.g)(!0))},e.prototype.UnmuteToasts=function(){Object(s.L)().dispatch(Object(F.g)(!1))},e.prototype.RegisterSystemNotificationsOpenedCallback=function(e){Object(X.a)("O365Shell.Notifications.RegisterSystemNotificationsOpenedCallback","This API is no longer supported. Please remove it or reach out for further instruction.")},e}();var ee=n(48),te=n(561),ne=function(e){function t(t){var n=e.call(this,t)||this;return n.setSimpleBellAriaLabel=function(e){n.setState({simpleBellAriaLabel:e})},n.onMouseChange=function(e){return n.setState({isHovered:e})},n.state={isHovered:!1,simpleBellAriaLabel:null},n}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=Object(C.a)();return this.props.isAvailable&&i.createElement("button",{type:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1),onFocus:this.onMouseChange.bind(this,!0),onBlur:this.onMouseChange.bind(this,!1),id:c.h,className:Object(s.y)(m.button,e.headerButton,e.highContrastButton),role:"button","aria-disabled":"false","aria-label":null==this.state.simpleBellAriaLabel?h.a.Notification_Title:null,"aria-labelledby":this.state.simpleBellAriaLabel},i.createElement(s.f,{fontIconCss:"ms-Icon--Ringer",fontSize:b.f.toString(),className:Object(s.y)(te.icon),isAriaHidden:!0}),i.createElement(v,{isParentHovered:this.state.isHovered,bellAriaID:c.h,bellAriaLabelID:"SimpleBellAriaLabel",setAriaLabelId:this.setSimpleBellAriaLabel,badgeStyles:m.headerButtonBadgePosition}))},t.prototype.componentDidMount=function(){this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t.prototype.componentDidUpdate=function(e){e.isAvailable!==this.props.isAvailable&&this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t}(i.Component),ie=Object(o.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,registerNotificationsFlexPane:t.registerNotificationsFlexPane}}))(ne);var ae=Object(s.L)(),oe={component:Object(ee.a)((function(){return n.e("notificationflex").then(n.bind(null,669)).then((function(e){return e.NotificationFlexPaneConnector}))})),key:"Notifications",width:p.b};function se(){oe.nativeControlID="NotificationBellIcon",ae.dispatch(Object(p.e)(oe))}function re(){var e=document.getElementById("O365_MainLink_Bell_Container");a.render(i.createElement(o.a,{store:ae},i.createElement(ie,{registerNotificationsFlexPane:function(){oe.btnId=c.h,ae.dispatch(Object(p.e)(oe))}})),e)}var ce,le;s.bb.register(J),ce=new $,le=window.O365Shell.Notifications,window.O365Shell.Notifications=ce,le.applyCalls(ce);var de=!1,pe=!1,fe=Object(s.L)(),ue=Object(r.f)(),be=Object(r.b)();(be.subscribe("ShellDataUpdated",(function(){!function(){if(pe)return;var e=document.createElement("div");a.render(i.createElement(o.a,{store:fe},i.createElement(H,null)),e),pe=!0}()}),!0),ue.layout)?ue.layout.centerCustomizationRegion&&Object(s.E)("NotificationBellIcon",ue.layout.centerCustomizationRegion.children)&&(me(),be.invoke("LazyComponentLoaded",l.b,A),Object(r.b)().subscribe("ShellDataUpdated",se,!0)):document.getElementById("O365_MainLink_Bell_Container")&&(me(),Object(r.b)().subscribe("ShellDataUpdated",re,!0));function me(){var e=Object(r.f)();if(!(de||e&&e.disableToasts)){var t=document.getElementById(c.e);if(t){var n=document.createElement("div");n.id="NotificationToastContainer",t.appendChild(n),s.s.isMobileClient()||(a.render(i.createElement(o.a,{store:fe},i.createElement(B,null)),n),de=!0)}}}Object(r.b)().subscribe("ShellDataUpdated",(function(e,t){me()}),!0)},295:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"i",(function(){return S})),n.d(t,"l",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return A}));var i=n(4),a=n(49),o=n(423),s=n(319),r=n(153),c=n(485),l=n(474);function d(e){return function(t,n){t({type:l.a,payload:e}),s.a.Add(n().notificationState.notifications)}}function p(e,t,n){return function(i,a){i({type:l.l,isRemoved:e,reminder:t,id:n}),s.a.Add(a().notificationState.notifications)}}function f(e,t,n,i){return function(a,o){a({type:l.h,ids:e,toastStatus:t,isCondensed:n,condensedCount:i}),s.a.Add(o().notificationState.notifications)}}function u(){return function(e,t){e({type:l.f});var n=t().notificationState.notifications,i=t().notificationState.notifications.filter((function(e){return 3!==e.toastState&&e.providerType===r.a.NewAppNotification&&null!=e.payload}));s.a.Add(n),i.length>0&&o.a.setSeen(i[0].payload.AllNewAppIDs)}}function b(e,t){return function(n,o,r){n({type:l.d,providerType:e}),r.then((function(e){s.a.Add(o().notificationState.notifications),e.Calendar.dismissReminders(t,a.a.timeZone).catch((function(e){i.i.genericServiceExceptionLog("Notifications_DismissAllNotificationsForProvider_Failed",6,e)}))}))}}function m(e,t){return function(n,o,r){n({type:l.e,id:e}),r.then((function(e){null!=t&&e.Calendar.dismissReminders([t],a.a.timeZone).catch((function(e){i.i.genericServiceExceptionLog("Notifications_DismissNotification_Failed",6,e)})),s.a.Add(o().notificationState.notifications)}))}}function h(e){return{type:l.b,notifications:e}}function g(e){return function(t,n){t({type:l.c,alertData:e}),s.a.Add(n().notificationState.notifications)}}function S(e){return{type:l.i,shouldShowSettings:e}}function y(e){return{type:l.j,futureReminders:e}}function v(e){return{type:l.g,muted:e}}function I(e,t){return function(n,o,s){s.then((function(n){n.Calendar.snoozeReminders(e,t,a.a.timeZone).catch((function(e){i.i.genericServiceExceptionLog("Notifications_SnoozeReminders_Failed",6,e)}))}))}}function A(e){return function(t,n,i){i.then((function(){c.a.SubscribeAllProviders(e).then((function(){t({type:l.k,isReady:!0})})).catch((function(){}))}))}}},300:function(e,t,n){var i=n(547);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},302:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return p}));var i=n(153),a=n(158),o=2;function s(e,t,n){if(!e||0===e.length)return!1;switch(t){case 40:n.index++;break;case 38:n.index--;break;case 35:n.index=e.length;break;case 36:n.index=0;break;default:return!1}return n.index=n.index%e.length,n.index=n.index<0?0:n.index,n.selectedReminderId=e[n.index].payload.reminder.ReminderItemDataModel.ItemId,!0}function r(){var e=new Date;return e.getUTCFullYear().toString()+e.getUTCMonth().toString()+e.getUTCDate().toString()+e.getUTCHours().toString()+e.getUTCMinutes().toString()+e.getUTCSeconds().toString()+e.getUTCMilliseconds().toString()}function c(e,t){if(null==t||null==t.notificationPreferencesData||!t.notificationPreferencesData.EnableNewItemSoundNotify&&!t.notificationPreferencesData.EnableReminderSound&&!t.notificationPreferencesData.EnableChatSound&&!t.notificationPreferencesData.EnableCallingSound)return"";switch(e.providerType){case i.a.NewMailNotification:return null!=t.mailNotificationAudioUrl&&t.notificationPreferencesData.EnableNewItemSoundNotify?t.mailNotificationAudioUrl:"";case i.a.SystemAlert:return null!=t.systemNotificationAudioUrl?t.systemNotificationAudioUrl:"";case i.a.ReminderNotification:return null!=t.calendarNotificationAudioUrl&&t.notificationPreferencesData.EnableReminderSound?t.calendarNotificationAudioUrl:"";case i.a.ChatNotification:return e.subType===a.a.call?null!=t.callNotificationAudioUrl&&t.notificationPreferencesData.EnableCallingSound?t.callNotificationAudioUrl:"":null!=t.chatNotificationAudioUrl&&t.notificationPreferencesData.EnableChatSound?t.chatNotificationAudioUrl:"";default:return""}}function l(e,t,n){return e.filter((function(e){return n?e.payload.reminder.ReminderItemDataModel.ItemId===t:e.payload.reminder.ReminderItemDataModel.ItemId!==t}))}function d(e,t){var n=e.filter((function(e){return e.providerType===i.a.ReminderNotification}));return t?n.filter((function(e){return 3===e.toastState})):n.filter((function(e){return 3!==e.toastState}))}function p(e){e.preventDefault()}},319:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n(4),a=n(1),o=n(31),s=n(3),r=n(47),c=n(404),l=n(67),d=n(139),p=n(153),f=n(360),u=n(295),b=n(6),m="User",h=i.k.SuiteScope,g=function(){function e(){}return e.LoadItemsFromSessionStorageToState=function(t){var n=[];e.GetNoticationsFromSessionStorage(t).then((function(e){if(null!=e&&e.length>0){var i=e.filter((function(e){return e.providerType!==p.a.ReminderNotification||(f.a.isVisibleReminderOverdue(e.payload.reminder.ReminderItemDataModel.EndDate)&&n.push(e.payload.reminder),!1)}));Object(s.L)().dispatch(Object(u.b)(i))}t.notificationPreferencesData.EnableReminders&&(0===n.length&&f.a.GetRemindersFromServer(),f.a.OnGetRemindersSucceeded(n))})).catch((function(){}))},e.GetNoticationsFromSessionStorage=function(t){return new Promise((function(n,i){var s=new l.d;s.requestRead(e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(s).then((function(i){if(null!=i&&null!=i.value&&i.hasKey(e.notificationsStorageKey)){var a=i.value(e.notificationsStorageKey);null!==a&&a.length>0&&(Object(o.c)(t.workloadID)||t.notificationPreferencesData&&t.notificationPreferencesData.EnableNewItemNotify?n(e.loadNonMailNotificationFromStorage(a)):n(a))}n(null)})).catch((function(e){i(e)}))}),!0)}))},e.Add=function(t){var n=new l.d,i=[];t.forEach((function(e){3!==e.toastState&&i.push(e)})),null!=i&&i.length>0&&(n.requestWrite(i,e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(e){e.Storage.submitStorageRequestToSessionStorage(n).catch((function(){}))}),!0))},e.RemoveItems=function(t,n){var i=new l.d;i.requestRead(e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(i).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(e.notificationsStorageKey)){var a=t.value(e.notificationsStorageKey),o=void 0;null!=a&&(o=a.filter((function(e){return e.subType!==n}))).length>0&&(i.requestWrite(o,e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(i).catch((function(){})))}})).catch((function(){}))},e.RetrieveSystemAlertsSessionStorage=function(t,n,i){return new Promise((function(o,s){var d=new l.c(h,m,n),f=new l.c(h,m,t),u=new l.d;u.requestRead(d,f),Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(u).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(d)){var n=t.value(d);null!=n&&c.c.UTCNow.compare(c.c.parseISO8601DateTime(n))<c.a&&t.hasKey(f)?o(t.value(f)):(e.RemoveItems(p.a.SystemAlert,i),o([]))}else o([])})).catch((function(e){s(e)}))}),!0)}))},e.StoreSystemAlertToCache=function(e,t,n){if(null!=e){var i=new l.c(h,m,n),o=new l.c(h,m,t),s=new l.d;s.requestWrite(c.c.UTCNow.getNativeDateTime(),i),s.requestWrite(e,o),Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(s).catch((function(){}))}),!0)}},e.GetSystemAlertsLastViewedTime=function(){var e=this;return new Promise((function(t,n){var o=new l.d,s=new l.c(h,m,"SystemAlertsLastRefreshDate"),c=null;o.requestRead(s),Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then((function(n){if(null!=n&&null!=n.value&&n.hasKey(s)){var i=n.value(s);null!=i&&(c=new Date(i))}else e.GetSystemAlertsLastViewedFromStorage().then((function(e){c=e})).catch((function(){}));t(c)})).catch((function(e){i.i.genericServiceRejection("Notifications_GetSystemAlertsLastViewedTime_Failed",4,e,n)}))}),!0)}))},e.SetSystemAlertsLastViewedToSessionStorage=function(e){var t=new l.d,n=new l.c(h,m,"SystemAlertsLastRefreshDate");t.requestWrite(e,n),r.b.Instance.Storage.submitStorageRequestToSessionStorage(t).catch((function(e){i.i.isCallsBlockedException(e)||i.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToSessionStorage_Failed",4,e)}))},e.GetSystemAlertsLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("SystemAlertsLastRefreshDate")},e.SetSystemAlertsLastViewedToStorage=function(){var e=this,t=(new Date).getTime();r.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"SystemAlertsLastRefreshDate",t).then((function(n){e.SetSystemAlertsLastViewedToSessionStorage(t)})).catch((function(e){i.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToStorage_Failed",6,e)}))},e.loadNonMailNotificationFromStorage=function(t){return new Promise((function(n,i){var o=new l.d,s=t.filter((function(e){return e.providerType!==p.a.NewMailNotification}));o.requestRemove(e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then((function(t){o.requestWrite(s,e.notificationsStorageKey),r.b.Instance.Storage.submitStorageRequestToSessionStorage(o).catch((function(){})),n(s)})).catch((function(e){i(e)}))}),!0)}))},e.GetLegalAlertLastViewedFromLocalStorage=function(){return new Promise((function(e,t){var n=window.localStorage,a=null;try{if(null!=n){var o=n.getItem("GallatinLegalAlertTimestamp"),s=n.getItem("GallatinLegalAlertLastFetchedTimestamp");if(!Object(b.isNullOrEmptyString)(o)&&!Object(b.isNullOrEmptyString)(s))(new Date).getTime()-new Date(parseInt(s)).getTime()<c.a&&e(a=new Date(parseInt(o)))}e(a)}catch(e){i.i.genericServiceRejection("Notifications_Error_ReadingGallatinAlertTimeStamp_FromLocalStorage",6,e,t)}}))},e.SetLegalAlertLastViewedToLocalStorage=function(e){var t=new Date,n=window.localStorage;try{null!=n&&(null!=e&&n.setItem("GallatinLegalAlertTimestamp",e.getTime().toString()),n.setItem("GallatinLegalAlertLastFetchedTimestamp",t.getTime().toString()))}catch(e){i.i.genericServiceExceptionLog("Notifications_Error_WritingGallatinAlertTimeStamp_ToLocalStorage",6,e)}},e.GetLegalAlertLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("GallatinLegalAlertTimestamp")},e.SetLegalAlertLastViewedToStorage=function(){var e=this,t=new Date;r.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"GallatinLegalAlertTimestamp",t.getTime()).then((function(n){e.SetLegalAlertLastViewedToLocalStorage(t)})).catch((function(e){i.i.genericServiceExceptionLog("Notifications_SetLegalAlertsLastViewedToStorage_Failed",6,e)}))},e.GetAlertLastViewedFromStorage=function(e){return new Promise((function(t,n){Object(a.b)().subscribe("SuiteAPILoaded",(function(){r.b.Instance.WebShellStorage.readStorage(d.b.User,d.a.SystemMetadata,e).then((function(e){var n=null;null!=e.value&&(n=new Date(e.value)),t(n)})).catch((function(t){i.i.genericServiceRejection("Notifications_GetAlertLastViewedFromStorage_"+e+"_Failed",6,t,n)}))}),!0)}))},e.notificationsStorageKey=new l.c(h,m,"NotificationsHistory"),e}()},325:function(e,t,n){"use strict";function i(e,t,n){var i="Warning: Deprecated Shell API ("+e+") usage detected.  "+t;n&&(i+="More info: "+n),console;try{throw new Error(i)}catch(e){}}n.d(t,"a",(function(){return i}))},360:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i,a,o,s=n(4),r=n(1),c=n(3),l=n(62),d=n(49),p=n(108),f=n(473),u=n(295),b=n(302),m=n(153),h=8*l.b,g=1*l.c,S=!1,y=function(){function e(){}return e.handleNotification=function(e,t){if(null!==e){e&&e.shouldGetReminders&&this.GetRemindersFromServer()}},e.GetReminderNotificationItem=function(e){var t=null;if(e&&e.length>0){var n=e.filter((function(e){return e.providerType===m.a.ReminderNotification}));null!=n&&n.length>0&&(t=n[0])}return t},e.GetRemindersFromServer=function(){document.hidden||i?S=!0:(o&&window.clearInterval(o),Object(r.b)().subscribe("SuiteAPILoaded",(function(){p.a.Instance.Calendar.getReminders(null,d.a.UTCNow.addDays(10).getNativeDateTime(),!0,d.a.timeZone).then((function(t){e.OnGetRemindersFromServerSucceeded(t)})).catch((function(e){!1===s.i.isCallsBlockedException(e)&&Object(r.e)().exception("Notifications_GetRemindersFromServer_Failed",6,e)}))}),!0))},e.ProcessGetReminderFromServer=function(){S&&(S=!1,this.GetRemindersFromServer())},e.OnGetRemindersFromServerSucceeded=function(t){var n=this,a=Object(c.L)(),s=a.getState().notificationState.notifications.slice(0);if("ErrorTooManyObjectsOpened"===t.ResponseCode)S=!0,i=window.setTimeout((function(){window.clearInterval(i),i=null,n.GetRemindersFromServer()}),g);else{var r=Object(b.a)(s,!0);if(r.length>0)return void a.dispatch(Object(u.m)(!0,null,r[0].payload.id));if(null!=t.Reminders){var l,d=[];t.Reminders.forEach((function(t){n.isVisibleReminderOverdue(t.EndDate)&&(l=e.CreateReminderItem(t,0),d.push(l))})),e.OnGetRemindersSucceeded(d)}o=window.setTimeout((function(){n.GetRemindersFromServer()}),h)}},e.CreateReminderItem=function(e,t){var n={Subject:e.Subject,Location:e.Location,ReminderTime:d.a.parseISO8601DateTime(e.ReminderTime),StartDate:d.a.parseISO8601DateTime(e.StartDate),EndDate:d.a.parseISO8601DateTime(e.EndDate),ItemId:e.ItemId,RecurringMasterItemId:e.RecurringMasterItemId,ReminderGroup:e.ReminderGroup||0,ReminderGroups:e.ReminderGroupTypes,JoinOnlineMeetingUrl:e.JoinOnlineMeetingUrl,displayState:t};return new f.a(n)},e.initalReminderNotification=function(e){return{providerType:m.a.ReminderNotification,payload:{id:m.a[m.a.ReminderNotification]+Object(b.d)()+Math.floor(1e3*Math.random()),reminder:e},toastState:0,toastType:1,navigationUrl:null}},e.OnGetRemindersSucceeded=function(t){var n=this,i=Object(c.L)(),a=Object(b.a)(i.getState().notificationState.notifications.slice(0),!1),o=[],s=t.sort((function(e,t){return e.ReminderItemDataModel.StartDate.compare(t.ReminderItemDataModel.StartDate)})).map((function(e){return n.initalReminderNotification(e)})),r=d.a.UTCNow,l=0;if(s.forEach((function(e){e.payload.reminder.ReminderItemDataModel.ReminderTime.toUTC().compare(r)>0?o.push(e.payload.reminder):(a.length>l?i.dispatch(Object(u.m)(!1,e.payload.reminder,a[l].payload.id)):i.dispatch(Object(u.a)(e)),l++)})),a.length>l)for(var p=l;p<a.length;p++)i.dispatch(Object(u.m)(!0,null,a[p].payload.id));i.dispatch(Object(u.l)(o)),e.RefreshNextReminderTimer(i,r,o)},e.RefreshNextReminderTimer=function(e,t,n){var i=this;window.clearInterval(a),n.sort((function(e,t){return e.ReminderItemDataModel.ReminderTime.compare(t.ReminderItemDataModel.ReminderTime)}));var o=n.length>0?n[0]:null;o&&(a=window.setTimeout((function(){i.ActivateReminders(e,d.a.UTCNow,n)}),o.ReminderItemDataModel.ReminderTime.toUTC().Subtract(t)))},e.ActivateReminders=function(t,n,i){var a,o=this;i=i.filter((function(e){return!(e.ReminderItemDataModel.ReminderTime.toUTC().compare(n)<=0)||(a=o.initalReminderNotification(e),t.dispatch(Object(u.a)(a)),!1)})),null!=a&&t.dispatch(Object(u.l)(i)),e.RefreshNextReminderTimer(t,n,i)},e.isVisibleReminderOverdue=function(e){return("string"==typeof e?d.a.parseISO8601DateTime(e):e).toUTC().addMinutes(15).compare(d.a.UTCNow)>=0},e}()},361:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),a=n(2),o=n(3),s=n(13),r=n(300),c=n(5),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e="";switch(this.props.title){case c.a.Alert_Title:e=c.a.DismissAllAlerts;break;case c.a.Mail:e=c.a.DismissAllMails;break;case c.a.Reminder_Title:e=c.a.DismissAllReminders}var t=Object(s.a)();return a.createElement("div",{className:Object(o.y)(r.dismissContain)},a.createElement("button",{id:"DismissAll",type:"button",onClick:this.props.onDismissAll,className:Object(o.y)(r.dismissAll,r.itemLink,t.neutral.accent.font),"aria-label":e,role:"button",tabIndex:0,title:e},a.createElement("span",null,c.a.DismissAll)))},t}(a.Component)},404:function(e,t,n){"use strict";var i=n(49);n.d(t,"c",(function(){return i.a}));n(405);var a=n(62);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.c}))},405:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return l}));var i,a=n(62),o=n(73),s=n(183),r=7*a.a,c=((i={}).default=!0,i.en=!0,i["am-ET"]=!0,i["bg-BG"]=!0,i["bn-IN"]=!0,i["ca-ES"]=!0,i["cz-CZ"]=!0,i["cy-GB"]=!0,i["da-DK"]=!0,i["de-DE"]=!0,i["el-GR"]=!0,i["en-029"]=!0,i["en-AU"]=!0,i["en-BZ"]=!0,i["en-CA"]=!0,i["en-GB"]=!0,i["en-IE"]=!0,i["en-IN"]=!0,i["en-JM"]=!0,i["en-MY"]=!0,i["en-NZ"]=!0,i["en-PH"]=!0,i["en-SG"]=!0,i["en-TT"]=!0,i["en-US"]=!0,i["en-ZA"]=!0,i["en-ZW"]=!0,i["es-ES"]=!0,i["es-MX"]=!0,i["et-EE"]=!0,i["eu-ES"]=!0,i["fi-FI"]=!0,i["fr-BE"]=!0,i["fr-CA"]=!0,i["fr-CH"]=!0,i["fr-FR"]=!0,i["fr-LU"]=!0,i["fr-MC"]=!0,i["gl-ES"]=!0,i["gu-IN"]=!0,i["hi-IN"]=!0,i["hr-HR"]=!0,i["hu-HU"]=!0,i["id-ID"]=!0,i["is-IS"]=!0,i["it-IT"]=!0,i["kk-KZ"]=!0,i["kn-IN"]=!0,i["lt-LT"]=!0,i["lv-LV"]=!0,i["ms-MY"]=!0,i["nb-NO"]=!0,i["nl-NL"]=!0,i["pl-PL"]=!0,i["pt-BR"]=!0,i["pt-PT"]=!0,i["ro-RO"]=!0,i["ru-RU"]=!0,i["sk-SK"]=!0,i["sl-SI"]=!0,i["sv-SE"]=!0,i["ta-IN"]=!0,i["te-IN"]=!0,i["tr-TR"]=!0,i["uk-UA"]=!0,i["vi-VN"]=!0,i),l=function(){function e(){}return e.ConvertToDateTime=function(e){var t=new Date(e.year,e.month,e.date,e.hour).getTimezoneOffset()*a.c,n=e.GetMilliseconds()+t;return new Date(n)},e.GetShortTime=function(t){var n=null,i=null;o.a.Instance.is24HourFormat?i="H":(i="h",n=c[o.a.Instance.userCulture]?"t":"tt",n="t");var a=o.a.Instance.timeFormat,r=e.ConvertToDateTime(t),l=s(r,i);l=l+e.GetTimeSeparator(a)+s(r,"MM");var d=null==n?"":s(r,n);return 0===a.indexOf("tt")?d+l:l+d},e.GetTimeSeparator=function(e){var t=null;if(-1!==e.indexOf("'h'"))return"'h'".replace("/'+/g","");if(-1!==e.indexOf("' h '"))return"' h '".replace("/'+/g","");var n=e.split(new RegExp("[hH]+"));return null!=n&&n.forEach((function(e){e.length>1&&(t=e.substring(0,1))})),t},e}()},423:function(e,t,n){"use strict";var i,a=n(0),o=n(3),s=n(1),r=n(295),c=n(35),l=n(4);!function(e){e.New="New",e.Seen="Seen",e.Dismissed="Dismissed"}(i||(i={}));var d=n(153),p=n(5);n.d(t,"a",(function(){return f}));var f=function(){function e(){}return e.getNewAppNotification=function(){Object(o.L)().dispatch(u(l.b.GET))},e.dismiss=function(e){Object(o.L)().dispatch(u(l.b.POST,e,i.Dismissed))},e.setSeen=function(e){Object(o.L)().dispatch(u(l.b.POST,e,i.Seen))},e.myAppsUrl="",e}();function u(e,t,n){return function(u,b,m){var h=t?{Status:n,IDs:t}:"";m.then((function(t){(function(e,t,n){return new Promise((function(i,a){e.Service.callWebClientShellServiceFunction("/api/notifications",t,null,n).then((function(e){i(e)})).catch((function(e){l.i.isCallsBlockedException(e)||Object(s.e)().exception("NewAppProvider_CallNewAppNotificationAPI_Failed",6,e),a(e)}))}))})(t,e,h).then((function(e){var t=function(e,t){if(!e)return null;var n=e.Notifications,s=null;if(n&&n.length>0){var r=n.filter((function(e){return"NewApp"===e.Type}));r.length>0&&(s=function(e,t){var n=null,s=null,r=null,l=null,u=0;if(e.length>0&&null!=t&&t.length>0){var b,m=[];e.forEach((function(e){(b=function(e,t){if(t){var n=e.filter((function(e){return!!e.Id&&e.Id.substring(e.Id.indexOf("Shell")<0?0:5)===t.Payload}));if(n.length>0)return Object(a.__assign)(Object(a.__assign)({},t),{LaunchFullUrl:n[0].LaunchFullUrl,Title:n[0].Title,CollectorID:n[0].CollectorId})}return null}(t,e))&&(m.push(b),e.Status===i.New&&u++)}));var h=m.length;if(0===h)return null;1===h?(n=Object(o.I)(p.a.SingleNewAppTitle,m[0].Title),s=Object(o.I)(p.a.SingleNewAllMessage,m[0].Title),r=p.a.SingleNewAppAction,l=m[0].LaunchFullUrl?m[0].LaunchFullUrl:""):(n=p.a.MultipleNewAppTitle,m[0].Title&&m[1].Title&&(s=h<=3?Object(o.I)(2===h?p.a.MultipleTwoNewAppsMessage:p.a.MultipleThreeNewAppsMessage,m[0].Title,m[1].Title):Object(o.I)(p.a.MultipleFourNewAppsMessage,m[0].Title,m[1].Title,(h-2).toString())),r=p.a.MultipleNewAppAction,l=f.myAppsUrl);var g={ID:"NewAppNotification",Title:n,Message:s,Type:d.a.NewAppNotification,LaunchFullUrl:l,ActionText:r,UnseenCount:u,AllNewAppIDs:m.map((function(e){return e.ID})),ItemID:1===h?m[0].ID:"NewAppNotification",CollectorID:1===h?m[0].CollectorID:"",AllAppTileIDs:m.map((function(e){return c.c(e.ID,e.CollectorID)}))};return{providerType:d.a.NewAppNotification,payload:g,toastState:0,toastType:3,navigationUrl:l}}return null}(r,t))}return s}(e,b().appsDataState.apps);null!=t&&u(Object(r.a)(t))})).catch((function(){}))}))}}},470:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(0),a=n(2),o=n(31),s=n(3),r=n(160),c=n(5),l=n(153),d=n(471),p=n(300),f=n(548),u=n(13),b=n(1),m=n(302),h=function(e){function t(t){var n=e.call(this,t)||this;return n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(b.e)().click("Close","NotificationToast",l.a[n.props.notification.providerType]),n.props.isInFlexPane||n.props.onToastClose(n.props.notification.payload.id),n.props.dismiss(n.props.notification.payload.id)},n.onMailClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.notification.navigationUrl;null!=t&&""!==t&&(Object(b.e)().click("NotificationClick",n.props.isInFlexPane?"NotificationsPane":"NotificationToast",l.a[n.props.notification.providerType],"Mail"),n.props.notification.isCondensed?Object(o.c)(n.props.notificationConfiguration.workloadID)||null!=n.props.notificationConfiguration&&null!=n.props.notificationConfiguration.owaLaunchUrl&&window.open(n.props.notificationConfiguration.owaLaunchUrl,"Mail","toolbar=0,status=0,width=1000,height=325"):Object(d.a)(t),n.props.dismiss(n.props.notification.payload.id)),n.props.isInFlexPane||n.props.onToastClose(n.props.notification.payload.id)},n.handleKeyDown=function(e){13===e.keyCode&&n.onMailClick(e)},n.setEmailState=function(e,t){if(e.stopPropagation(),e.preventDefault(),n.setState({isHover:t}),!n.props.isInFlexPane){var i=n.props.notification.payload.id;t?n.props.clearTimer(i):n.props.setTimer(i)}},n.handleOnError=function(){Object(b.e)().tag("NewMailNotification_MePhoto_LoadError",4)},n.handleOnFocus=function(){n.setState({isHover:!0})},n.handleOnBlur=function(){n.setState({isHover:!1})},n.handleOnMouseEnter=function(e){n.setEmailState(e,!0)},n.handleOnMouseLeave=function(e){n.setEmailState(e,!1)},n.state={isHover:!1},n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled&&Object(b.e)().impression(l.a[this.props.notification.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t=this.props.notification.payload,n=null,i="",o=Object(u.a)();if(!this.props.isInFlexPane&&this.props.notification.isCondensed){var l=Object(s.I)(c.a.CondensedNewMailMessage,this.props.notification.condensedCount.toString());i=l,n=a.createElement("div",{className:Object(s.y)(f.condensed)},a.createElement(s.f,{className:Object(s.y)(p.icon,f.condensedIcon),fontIconCss:"ms-Icon--Mail"}),a.createElement("span",{className:Object(s.y)(f.condensedMailText,o.neutral.dark.font)},l))}else{i=t.PreviewText.length<70?t.Sender+" "+t.Subject+" "+t.PreviewText:t.Sender+" "+t.Subject+" "+t.PreviewText.substring(0,70);var d=Object(u.a)();n=a.createElement("div",{className:Object(s.y)(f.itemContent)},a.createElement("div",{className:Object(s.y)(s.P.table,s.P.maxWidth,s.P.maxHeight)},a.createElement("div",{className:Object(s.y)(f.newMailPersonaImage,s.P.tableCellMiddle)},a.createElement(r.a,{photoSize:32,upn:t.SenderSmtpEmailAddress,displayName:t.Sender,onError:this.handleOnError})),a.createElement("div",{className:s.P.tableCellMiddle},a.createElement("span",{className:Object(s.y)(f.mailText,f.sender,p.notificationTitle,d.neutral.dark.font)},t.Sender),a.createElement("div",null,a.createElement("div",{className:f.mailIcon},a.createElement(s.f,{className:Object(s.y)(p.icon,d.neutral.dark.font),fontIconCss:"ms-Icon--Mail",fontSize:"10px",isAriaHidden:!0})),a.createElement("span",{className:Object(s.y)(s.P.maxWidth,f.mailText,f.mailSubject,d.neutral.tertiary.font)},t.Subject)))),a.createElement("span",{className:Object(s.y)(f.mailText,f.bodyPreviewText,d.neutral.secondary.font)},t.PreviewText))}return a.createElement("div",{id:"NewMailItemId",role:"group","aria-label":i,className:Object(s.y)(f.newMailLink),onContextMenu:m.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,tabIndex:0,onClick:this.onMailClick,onKeyDown:this.handleKeyDown},a.createElement("button",{type:"button",onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:Object(s.y)((e={},e[s.P.visuallyHidden]=!this.state.isHover&&this.props.isInFlexPane,e),p.closeButton,o.neutral.secondary.font,o.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":c.a.DismissNotification,title:c.a.DismissNotification},a.createElement(s.f,{className:p.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),a.createElement("div",{className:Object(s.y)(f.newMailPopupButton)},a.createElement("div",{className:Object(s.y)(f.newMailPopupButtonCell)},n)))},t}(a.Component)},471:function(e,t,n){"use strict";function i(e){window.open(e,"_blank","width=1000,height=600,top=150,left=150,menubar=no,resizable=yes,status=no,scrollbars=yes,titlebar=no,toolbar=no")}n.d(t,"a",(function(){return i}))},472:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(0),a=n(2),o=n(3),s=n(153),r=n(1),c=n(302),l=n(5),d=n(300),p=n(550),f=n(13),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.notification.payload.systemAlert,i=t.ActionUrl;if(Object(r.e)().click("NotificationClick",n.props.isInFlexPane?"NotificationsPane":"NotificationToast",s.a[n.props.notification.providerType],null,n.props.notification.subType),t.ActionCallback&&t.ActionCallback(),null!=i&&""!==i){var a=t.ActionTarget||"_self";window.open(i,a)}n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id)},n.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(r.e)().click("Close","NotificationToast",s.a[n.props.notification.providerType],null,n.props.notification.subType),n.props.onToastClose&&n.props.onToastClose(n.props.notification.payload.id),n.props.dismiss(n.props.notification.payload.id)},n.handleKeyDown=function(e){13===e.keyCode&&n.onClick(e)},n.setReminderState=function(e,t){e.stopPropagation(),e.preventDefault(),n.setState({isHover:t})},n.handleOnFocus=function(){n.setState({isHover:!0})},n.handleOnBlur=function(){n.setState({isHover:!1})},n.handleOnMouseEnter=function(e){n.setReminderState(e,!0)},n.handleOnMouseLeave=function(e){n.setReminderState(e,!1)},n.state={isHover:!1},n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){if(this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled){var e=s.a[this.props.notification.providerType];this.props.notification.subType&&(e=e+":"+this.props.notification.subType),Object(r.e)().impression(e,this.props.isInFlexPane?"FlexPane":"NotificationToast")}},t.prototype.componentWillUnmount=function(){this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t,n,i=this.props.notification.payload.systemAlert,s=Object(f.a)();return a.createElement("div",{id:"SystemAlert"+(this.props.isInFlexPane?"_pane":"")+i.Id,role:"group",tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,className:Object(o.y)(p.container,s.neutral.light.border),onContextMenu:c.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,"aria-label":i.Title+" "+i.Message},a.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(o.y)((e={},e[o.P.visuallyHidden]=!this.state.isHover,e),p.systemClose,d.closeButton,s.neutral.secondary.font,s.neutral.lightAlt.hover.background),"aria-label":l.a.DismissNotification,title:l.a.DismissNotification},a.createElement(o.f,{className:d.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),a.createElement("div",null,a.createElement(o.f,{className:Object(o.y)(o.P.tableCellMiddle,o.P.floatLeft,s.neutral.dark.font,(t={},t[p.alertIcon]=!this.props.isInFlexPane,t),(n={},n[p.alertPaneIcon]=this.props.isInFlexPane,n)),fontIconCss:"ms-Icon--Warning",isAriaHidden:!0}),a.createElement("span",{className:Object(o.y)(p.title,s.neutral.dark.font)}," ",i.Title),a.createElement("span",{className:Object(o.y)(p.message,d.notificationBodyText,s.neutral.secondary.font)},i.Message)),a.createElement("div",{"aria-label":i.ActionText,className:Object(o.y)(d.actionBar,s.neutral.accent.font,s.neutral.light.border)},a.createElement("a",{tabIndex:0,role:"button",onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":i.ActionText,className:Object(o.y)(d.notificationLink,s.neutral.accent.link)},a.createElement("span",{className:d.itemLink,role:"link","aria-label":i.ActionText},i.ActionText),a.createElement(o.f,{className:Object(o.y)(d.icon,d.actionArrow),fontIconCss:"ms-Icon--Forward"}))))},t}(a.Component)},473:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(31),a=n(62),o=n(49),s=n(405),r=n(47),c=n(1),l=n(11),d=n(153),p=n(471),f=n(5),u=function(){function e(t){this.reminderItemDataModel=null,this.isReminderOverdue=!1,this.reminderItemDataModel=t,this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime(),0!==this.reminderItemDataModel.ReminderGroup&&1!==this.reminderItemDataModel.ReminderGroup&&Object(r.a)(Object(l.b)("Invalid value {0} for reminder group",this.reminderItemDataModel.ReminderGroup))}return Object.defineProperty(e.prototype,"ReminderItemDataModel",{get:function(){return this.reminderItemDataModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsReminderOverdue",{get:function(){return this.isReminderOverdue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartValue",{get:function(){return this.timeToStartValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartUnit",{get:function(){return this.timeToStartUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeLabel",{get:function(){var t="";return 0===this.reminderItemDataModel.ReminderGroup?t=o.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.referenceDateTime)&&o.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.reminderItemDataModel.EndDate)?Object(l.b)("{0} - {1}",s.a.GetShortTime(this.reminderItemDataModel.StartDate),s.a.GetShortTime(this.reminderItemDataModel.EndDate)):e.GetLongDateTimeString(this.reminderItemDataModel.StartDate):1===this.reminderItemDataModel.ReminderGroup&&(t=s.a.GetShortTime(this.reminderItemDataModel.ReminderTime)),t},enumerable:!0,configurable:!0}),e.prototype.UpdateReferenceTimeFromNow=function(){this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime()},e.prototype.UpdateReferenceTime=function(t){this.referenceDateTime=e.GetReferenceTime(t),this.UpdateTimeToStartFromReferenceTime()},e.GetLongDateTimeString=function(t){var n=s.a.GetShortTime(t),i=e.daysOfTheWeek[s.a.ConvertToDateTime(t).getDay()],a=e.monthsOfTheYear[t.month],o=t.date.toString(),r=t.year.toString();return Object(l.b)("{0} {1}, {2} {3}, {4}",n,i,a,o,r)},e.prototype.UpdateTimeToStartFromReferenceTime=function(){var e=this.GetTimeToStartInMillis(),t=this.GetDurationInfo(Math.abs(e));this.isReminderOverdue=Math.floor(e/a.c)<0,this.timeToStartValue=t[0],this.timeToStartUnit=t[1]},e.prototype.GetTimeToStartInMillis=function(){var e=null;return 0===this.reminderItemDataModel.ReminderGroup?e=this.reminderItemDataModel.StartDate:1===this.reminderItemDataModel.ReminderGroup&&(e=this.reminderItemDataModel.ReminderTime),e.Subtract(this.referenceDateTime)},e.prototype.GetTimeToEndInMillis=function(){var e=null;if(0===this.reminderItemDataModel.ReminderGroup)e=this.reminderItemDataModel.EndDate;else{if(1!==this.reminderItemDataModel.ReminderGroup)return 0;e=this.reminderItemDataModel.ReminderTime}return e.Subtract(this.referenceDateTime)},e.prototype.OpenItem=function(e,t){Object(c.e)().click("NotificationClick","NotificationToast",d.a[d.a.ReminderNotification]);var n="",a=null,o=t.indexOf("?")>-1?"&":"?",s=this.reminderItemDataModel.ReminderGroups;1==(1&s)?a=4==(4&s)?"IBirthdayFactory":"ICalendarItemDetailsViewModelFactory":2==(2&s)&&(a="TaskReadingPaneViewModelPopOutFactory");n=Object(i.c)(e)?Object(l.b)("{0}{1}path=/owa&viewmodel={2}&ispopout=1&ItemID={3}",t,o,a,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)):Object(l.b)("{0}{1}path=/owa&ItemID={2}",t,o,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)),Object(p.a)(n)},e.prototype.GetDurationInfo=function(e){var t=0,n=f.a.Now_Title;return e>=s.b?n=1===(t=Math.floor(e/s.b))?f.a.Week_Title:f.a.Weeks_Title:e>=a.a?n=1===(t=Math.floor(e/a.a))?f.a.Day_Title:f.a.Days_Title:e>=a.b?n=1===(t=Math.floor(e/a.b))?f.a.Hour_Title:f.a.Hours_Title:e>=a.c&&(n=1===(t=Math.floor(e/a.c))?f.a.Min_Title:f.a.Mins_Title),[t>0?t.toString():"",n]},e.GetReferenceTimeFromNow=function(){var t=o.a.Now;return e.GetReferenceTime(t)},e.GetReferenceTime=function(e){return new o.a(e.year,e.month,e.date,e.hour,e.minute,0,0,0)},e.daysOfTheWeek=[f.a.Sunday_Title,f.a.Monday_Title,f.a.Tuesday_Title,f.a.Wednesday_Title,f.a.Thursday_Title,f.a.Friday_Title,f.a.Saturday_Title],e.monthsOfTheYear=[f.a.January_Title,f.a.February_Title,f.a.March_Title,f.a.April_Title,f.a.May_Title,f.a.June_Title,f.a.July_Title,f.a.August_Title,f.a.September_Title,f.a.October_Title,f.a.November_Title,f.a.December_Title],e}()},474:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"h",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return u})),n.d(t,"g",(function(){return b}));var i="suiteux-notification.ADD_NOTIFICATION",a="suiteux-notification.UPDATE_NOTIFICATION",o="suiteux-notification.SET_TOAST_STATUS",s="suiteux-notifications.SET_SEEN_IN_FLEXPANE",r="suiteux-notifications.DISMISS_ALL_NOTIFICATIONS_FOR_PROVIDER",c="suiteux-notifications.DISMISS_NOTIFICATION_FOR_PROVIDER",l="suiteux-notification.ADD_NOTIFICATIONS_FROM_SESSIONSTORAGE",d="suiteux-notification.ADD_SYSTEM_NOTIFICATION",p="suiteux-notification.SHOW_SETTINGS_ACTION",f="suiteux-notification.UPDATE_FUTUREREMINDERS_ACTION",u="suiteux-notification.UPDATE_IS_SUBSCRIPTION_READY_ACTION",b="suiteux-notification.SET_TOASTMUTEDSTATE_ACTION"},475:function(e,t,n){var i=n(554);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},485:function(e,t,n){"use strict";var i=n(31),a=n(3),o=n(91),s=n(1),r=n(47),c=n(404),l=n(319),d=function(){function e(){this.OnGetSystemAlertsSucceeded=function(e){l.a.SetSystemAlertsLastViewedToStorage()}}return e.prototype.GetSystemAlerts=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.GetSystemAlertsLastViewedTime().then((function(t){var n=new Date;(null==t||n.getTime()-t.getTime()>c.a)&&r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))})).catch((function(t){r.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))}))},e}(),p=n(4),f=n(35),u=n(5),b=n(295),m=n(153),h=function(){function e(e){var t=this;this.launchFullUrl=e,this.retryCount=0,this.OnGetOofAlertSucceeded=function(e){var n=t.CreateOofSystemAlertArray(e);null!=n&&(l.a.StoreSystemAlertToCache(n,"OofAlert","OofAlertFetchTime"),Object(a.L)().dispatch(Object(b.a)(n)))},this.OnGetOofAlertFailed=function(e){!1===p.i.isCallsBlockedException(e)&&(e.message=f.g(e.message),Object(s.e)().exception("Notifications_Error_GettingOOFAlerts",6,e),t.retryCount<2&&(t.retryCount++,t.GetOofAlert()))}}return e.prototype.GetOofAlert=function(){var e=this;r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("OofAlert","OofAlertFetchTime","OofAlert").then((function(t){null!=t&&0!==t.length||r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)})).catch((function(t){!1===p.i.isCallsBlockedException(t)&&Object(s.e)().exception("Notifications_Error_ReadingOOFAlertFromStorage",4,t),r.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)}))},e.prototype.CreateOofSystemAlertArray=function(e){var t=null;if(null!=e&&e.IsOofOn){var n=this.launchFullUrl.indexOf("/mail/"),i=this.launchFullUrl.indexOf("/owa/"),a="";if(-1!==n)a=this.launchFullUrl.substring(0,n)+"?#path=/options/automaticreplies";else{if(-1===i)return null;a=this.launchFullUrl.substring(0,i)+"?#path=/options/automaticreplies"}var o={Title:u.a.AutomaticReplies_Title,Message:u.a.AutomaticRepliesOn_Text,ActionText:u.a.AutomaticRepliesOff_Text,ActionTarget:"_self",Id:"OofAlert",ActionUrl:a};t={providerType:m.a.SystemAlert,subType:"OofAlert",payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:a}}return t},e}(),g=function(){function e(){}return e.CreateAlert=function(){var e=null,t=Object(a.L)().getState(),n=Object(a.J)(t.appsDataState.apps);if("AdminPortal"!==t.shellInitDataState.clientData.WorkloadId){var i={Title:u.a.TimeZoneAlertTitle,Message:u.a.TimeZoneAlertText,ActionText:u.a.TimeZoneAlertActionText,ActionTarget:"_self",Id:"TimeZoneAlert",ActionUrl:n||""};e={providerType:m.a.SystemAlert,subType:"TimeZoneAlert",payload:{systemAlert:i,id:i.Id},toastType:1,toastState:0,navigationUrl:i.ActionUrl},Object(a.L)().dispatch(Object(b.a)(e))}},e}(),S=n(302),y=function(){function e(){}return e.handle=function(e,t,n,i){if(null!==e){var o=e;if("Reload"!==o.EventType){var s=Object(a.L)(),r=(null===o.SenderSmtpEmailAddress?"":o.SenderSmtpEmailAddress.trim().toLowerCase())!==(null!=i?i.trim().toLowerCase():""),c=t.UserOptions.IsFocusedInboxEnabled||"Other"!==o.InferenceClassification;if(r&&c){var l={providerType:m.a.NewMailNotification,payload:o,toastType:0,toastState:0,navigationUrl:Object(a.I)("{0}ItemID={1}&viewmodel=ReadMessageItem",n+(n.indexOf("?")>-1?"&":"?"),encodeURIComponent(o.ItemId))},d=Object(S.d)();l.payload.id=m.a[m.a.NewMailNotification]+d,s.dispatch(Object(b.a)(l))}}}},e}(),v=n(423),I=n(360),A=function(){function e(){var e=this;this.retryCount=0,this.OnGetPasswordExpiryAlertSucceeded=function(t){var n=e.CreatePasswordExpirySystemAlert(t);null!=n&&(l.a.StoreSystemAlertToCache(n,"PasswordExpiryAlert","PasswordExpiryAlertFetchTime"),Object(a.L)().dispatch(Object(b.a)(n)))},this.OnGetPasswordExpiryAlertFailedFromOWA=function(t){!1===p.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromOWA(e.actionUrl,e.isConsumerShell)))},this.OnGetPasswordExpiryAlertFailedFromWCSS=function(t,n){!1===p.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromWCSS",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromWCSS(n)))}}return e.prototype.GetPasswordExpiryAlertFromOWA=function(e,t){var n=this;this.actionUrl=e,this.isConsumerShell=t,r.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(e){null!==e&&0!==e.length||r.b.Instance.User.getDaysUntilPasswordExpiration().then(n.OnGetPasswordExpiryAlertSucceeded).catch(n.OnGetPasswordExpiryAlertFailedFromOWA)})).catch((function(e){!1===p.i.isCallsBlockedException(e)&&Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,e),r.b.Instance.User.getDaysUntilPasswordExpiration().then(n.OnGetPasswordExpiryAlertSucceeded).catch(n.OnGetPasswordExpiryAlertFailedFromOWA)}))},e.prototype.GetPasswordExpiryAlertFromWCSS=function(e){var t=this;this.actionUrl=e,l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(n){null!=n&&0!==n.length||r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(n){return t.OnGetPasswordExpiryAlertFailedFromWCSS(n,e)}))})).catch((function(n){r.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(n){return t.OnGetPasswordExpiryAlertFailedFromWCSS(n,e)}))}))},e.prototype.CreatePasswordExpirySystemAlert=function(e){var t=null;if(0<=e&&e<100){var n="";1<e?n=Object(a.I)(u.a.PasswordExpiration_Text,e.toString()):1===e?n=Object(a.I)(u.a.PasswordExpiration_IsOne_Text,e.toString()):0===e&&(n=u.a.PasswordExpirationZero_Text);var i="",o={ActionTarget:"_self",ActionUrl:i=this.isConsumerShell?"https://account.live.com/password/Change":this.actionUrl+"/ChangePassword.aspx",ActionText:u.a.ChangePassword_Link,Title:u.a.ChangePassword_Title,Id:"PasswordExpiryAlert",Message:n};t={providerType:m.a.SystemAlert,subType:"PasswordExpiryAlert",payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:i}}return t},e}(),O=function(){function e(){}return e.prototype.GetGallatinLegalAlert=function(){var e=this;l.a.GetLegalAlertLastViewedFromLocalStorage().then((function(t){null!==t?e.OnGetAlertLastViewedSucceeded(t):l.a.GetLegalAlertLastViewedFromStorage().then((function(t){e.OnGetAlertLastViewedSucceeded(t)}))}))},e.prototype.OnGetAlertLastViewedSucceeded=function(t){var n=new Date;(null==t||e.ShouldShowTheAlert(n,t))&&this.CreateLegalAlert(),l.a.SetLegalAlertLastViewedToLocalStorage(t)},e.ShouldShowTheAlert=function(e,t){var n=new Date(Date.UTC(e.getFullYear(),0,1,0,0,0,1)),i=new Date(Date.UTC(e.getFullYear(),6,1,0,0,0,1)),a=n.getTime()-e.getTime(),o=i.getTime()-e.getTime();return(o>0?a:Math.max(o,a))>t.getTime()-e.getTime()},e.prototype.CreateLegalAlert=function(){var e={Id:"GallatinLegalAlert",Title:u.a.GallatinLegalAlert_Title,Message:u.a.GallatinLegalAlert_Text,ActionText:u.a.GallatinLegalAlertAction_Text,ActionUrl:"https://www.21vbluecloud.com/office365/O365-VAT/",ActionTarget:"_blank",ActionCallback:function(){l.a.SetLegalAlertLastViewedToStorage()}},t={providerType:m.a.SystemAlert,subType:"GallatinLegalAlert",payload:{systemAlert:e,id:e.Id},toastType:1,toastState:0,navigationUrl:e.ActionUrl};Object(a.L)().dispatch(Object(b.a)(t))},e}();n.d(t,"a",(function(){return x}));var x=function(){function e(){}return e.SubscribeAllProviders=function(t){e.config=t;var n=e.config;return n.isSystemNotificationsDisabled||e.subscribeSystemNotification(),n.isConsumerShell||(v.a.myAppsUrl=n.myAppsUrl,v.a.getNewAppNotification()),new Promise((function(t,i){r.b.Instance.User.getOwaUserConfiguration().then((function(i){if(null!=i){e.owaUserConfiguration=i;var r=Object(o.f)(i,n.notificationPreferencesData);if(n.notificationPreferencesData=r,e.subscribeNewMailNotification(),e.subscribeReminderNotification(),l.a.LoadItemsFromSessionStorageToState(n),r)Object(a.L)().dispatch(Object(a.gb)(r));Object(s.e)().perfMarker("NotificationSubscriptionComplete"),t(!0)}})).catch((function(e){e&&e.message&&e.message.indexOf&&e.message.indexOf("OwaInvalidUserLanguageException")>-1?(g.CreateAlert(),t(!0)):(Object(s.e)().exception("Notifications_GetOwaUserConfiguration_Failed",6,e),i(e))}))}))},e.subscribeNewMailNotification=function(){var t=e.config,n={subscriptionId:m.a[m.a.NewMailNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:m.a[m.a.NewMailNotification]}};r.b.Instance.Notification.subscribe(n,(function(n){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableNewItemNotify&&null!==n&&y.handle(n,e.owaUserConfiguration,t.owaLaunchUrl,t.upn)}))},e.subscribeReminderNotification=function(){var t=e.config,n={subscriptionId:m.a[m.a.ReminderNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:m.a[m.a.ReminderNotification]}};r.b.Instance.Notification.subscribe(n,(function(n){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableReminders&&null!==n&&I.a.handleNotification(n,e.owaUserConfiguration)}))},e.subscribeSystemNotification=function(){var t=e.config;t.isConsumerShell||t.isOnPremShell||t.doNotFetchSystemAlertsFromPortal||(new d).GetSystemAlerts();r.b.Instance.Calendar.IsInitialized&&Object(i.c)(t.workloadID)&&new h(t.owaLaunchUrl).GetOofAlert();var n=new A;(t.isConsumerShell||t.isOnPremShell?n.GetPasswordExpiryAlertFromOWA(t.portalUrl,t.isConsumerShell):n.GetPasswordExpiryAlertFromWCSS(t.portalUrl),t.isGallatinLegalAlertEnabled)&&(new O).GetGallatinLegalAlert()},e.owaUserConfiguration=null,e}()},487:function(e,t,n){"use strict";var i=n(0),a=n(2),o=n(3),s=n(1),r=n(13),c=n(5),l=n(404),d=n(153),p=n(360),f=n(300),u=n(552),b=n(302),m=function(e){function t(t){var n=e.call(this,t)||this;return n.dismiss=function(e){e.preventDefault(),e.stopPropagation(),Object(s.e)().click("Dismiss",n.props.isInFlexPane?"NotificationsPane":"NotificationToast",d.a[d.a.ReminderNotification]),null!=n.props.reminderItem?n.props.onDismiss(n.props.reminderItem.payload.id,n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId):Object(s.e)().tag("Notifications_DismissReminder_EmptySelectedReminder",6)},n.setStateWhenBlur=function(){n.state.isIconFocus||null!=n.props.snoozeReminderId||window.setTimeout((function(){n.setState({isReminderFocus:!1}),n.props.onSelectedItem(null)}),500)},n.setReminderState=function(e,t){e.preventDefault(),e.stopPropagation(),n.props.snoozeReminderId||n.setState({isHover:t})},n.handleKeyDown=function(e){13===e.keyCode&&n.onClick(e)},n.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.reminderItem.payload.reminder;n.props.snoozeReminderId===t.ReminderItemDataModel.ItemId?n.props.onSnoozeClose():(n.props.onClick(t.ReminderItemDataModel.ItemId),null!=n.props.config&&null!=n.props.config.workloadID&&(t.OpenItem(n.props.config.workloadID,n.props.config.owaLaunchUrl),n.props.onDismiss(n.props.reminderItem.payload.id,n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId)))},n.onSnoozeClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId;n.props.snoozeReminderId?n.props.onSnoozeClose():t&&n.props.onSnoozeClick(t,document.activeElement)},n.handleOnSnoozeFocus=function(){n.setState({isIconFocus:!0,isReminderFocus:!0})},n.handleOnReminderFocus=function(){n.setState({isReminderFocus:!0})},n.handleSnoozeButtonOnBlur=function(){n.setState({isIconFocus:!1})},n.handleCloseButtonOnBlur=function(){n.setState({isIconFocus:!1,isReminderFocus:!1})},n.handleOnClick=function(e){n.dismiss(e)},n.handleOnMouseEnter=function(e){n.setReminderState(e,!0)},n.handleOnMouseLeave=function(e){n.setReminderState(e,!1)},n.state={isHover:!1,isIconFocus:!1,isReminderFocus:!1},n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.reminderItem.payload.reminder&&this.props.alertImpressionLogEnabled&&Object(s.e)().impression(d.a[this.props.reminderItem.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillReceiveProps=function(e){if(this.props.LastUpdatedTime!==e.LastUpdatedTime){var t=this.props.reminderItem.payload.reminder;t.UpdateReferenceTime(this.props.LastUpdatedTime),p.a.isVisibleReminderOverdue(t.ReminderItemDataModel.EndDate)||this.props.removeReminder(this.props.reminderItem.payload.id)}},t.prototype.render=function(){var e,t,n,i,s=Object(r.a)(),l=this.props.reminderItem.payload.reminder;l.UpdateReferenceTime(this.props.LastUpdatedTime);var d=this.props.order,p=Object(o.y)(u.remindersRemain,o.P.tableCellMiddle,u.remindersRightColumn,((e={})[s.neutral.darkRed.font]=l.IsReminderOverdue,e[s.neutral.dark.font]=!l.IsReminderOverdue,e)),m=a.createElement("div",{id:"rmdcontext"+d,"aria-labelledby":"rmdSubject"+d+" rmdBody"+d,className:Object(o.y)(f.overflowHidden,o.P.table,o.P.maxWidth,o.P.maxHeight)},a.createElement("div",{className:Object(o.y)(o.P.tableCellMiddle)},a.createElement(o.f,{className:Object(o.y)(u.reminderIcon,s.neutral.dark.font),fontIconCss:"ms-Icon--Event",isAriaHidden:!0})),a.createElement("div",{"aria-label":l.ReminderItemDataModel.Subject,className:Object(o.y)(o.P.tableCellMiddle,o.P.maxWidth,f.notificationTitle,s.neutral.dark.font)},a.createElement("span",{className:Object(o.y)(u.remindersTitle)},l.ReminderItemDataModel.Subject)),a.createElement("div",{id:"rmdBody"+d,"aria-label":Object(o.I)("{0} {1} {2}",l.TimeToItemStartValue,l.TimeToItemStartUnit,c.a.ReminderOverDue),className:p},a.createElement("div",{className:Object(o.y)((t={},t[o.P.visuallyHidden]=this.state.isHover||this.state.isReminderFocus||this.state.isIconFocus,t)),"aria-hidden":"true"},a.createElement("span",{className:Object(o.y)(u.toastRemindersTimeToStartValue)},l.TimeToItemStartValue),a.createElement("span",{className:Object(o.y)(u.remindersTimeToStartUnit)},l.TimeToItemStartUnit),a.createElement("span",{className:Object(o.y)(s.neutral.darkRed.font,(n={},n[o.P.visuallyHidden]=!l.IsReminderOverdue,n))},c.a.ReminderOverDue)),a.createElement("div",{className:Object(o.y)((i={},i[o.P.visuallyHidden]=!this.state.isHover&&!this.state.isReminderFocus&&!this.state.isIconFocus,i))},a.createElement("button",{id:"reminderSnoozeButton"+d,tabIndex:0,title:c.a.ReminderSnooze_Title,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleSnoozeButtonOnBlur,"aria-label":c.a.ReminderSnooze_Aria_Text,role:"button",className:Object(o.y)(u.alarmButton,f.notificationLink,s.neutral.accent.font,s.neutral.light.hover.background),onClick:this.onSnoozeClick},a.createElement(o.f,{className:Object(o.y)(f.icon),fontIconCss:"ms-Icon--AlarmClock"})),a.createElement("button",{id:"reminderCloseButton"+d,type:"button",tabIndex:0,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleCloseButtonOnBlur,className:Object(o.y)(f.closeButton,u.reminderCloseButton,s.neutral.secondary.font,s.neutral.light.hover.background),"aria-label":c.a.DismissNotification,role:"button",title:c.a.Dismiss,onClick:this.handleOnClick},a.createElement(o.f,{className:f.icon,fontIconCss:"ms-Icon--ChromeClose"}))))),h=a.createElement("div",{className:Object(o.y)(u.remindersDescription,s.neutral.secondary.font)},a.createElement("div",null,l.TimeLabel),""!==l.ReminderItemDataModel.Location&&a.createElement("div",null,l.ReminderItemDataModel.Location)),g=this.props.selectedReminderId===l.ReminderItemDataModel.ItemId;return a.createElement("div",{id:this.props.id,role:"group",tabIndex:0,className:Object(o.y)(f.toastControl),"aria-labelledby":"rmdRow"+d+" rmdDesc"+d,ref:function(e){g&&e&&e.focus()},onContextMenu:b.f,onClick:this.onClick,onKeyDown:this.handleKeyDown,onFocus:this.handleOnReminderFocus,onBlur:this.setStateWhenBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave},a.createElement("div",{className:Object(o.y)(u.remindersContainer)},a.createElement("div",{id:"rmdRow"+d,"aria-labelledby":"rmdcontext"+d,className:Object(o.y)(u.remindersRow)},m),a.createElement("div",{id:"rmdDesc"+d,"aria-label":l.ReminderItemDataModel.Location,className:Object(o.y)(u.remindersRow)},h)))},t}(a.Component),h=n(361),g=function(){function e(){}return e.prototype.getSnoozeOptions=function(){return[-15,-5,0,5,10,15,30,60,120,240,480,720,1440,2880,4320,5760,10080,20160]},e.prototype.getSnoozeDisplayText=function(e){var t="";switch(e){case-15:t=Object(o.I)(c.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"15");break;case-10:t=Object(o.I)(c.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"10");break;case-5:t=Object(o.I)(c.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"5");break;case 0:t=c.a.ReminderSnoozeOption_AtStart_Text;break;case 5:t=Object(o.I)(c.a.ReminderSnoozeOption_Minutes_Text,"5");break;case 10:t=Object(o.I)(c.a.ReminderSnoozeOption_Minutes_Text,"10");break;case 15:t=Object(o.I)(c.a.ReminderSnoozeOption_Minutes_Text,"15");break;case 30:t=Object(o.I)(c.a.ReminderSnoozeOption_Minutes_Text,"30");break;case 60:t=c.a.ReminderSnoozeOption_Hour_Text;break;case 120:t=Object(o.I)(c.a.ReminderSnoozeOption_Hours_Text,"2");break;case 240:t=Object(o.I)(c.a.ReminderSnoozeOption_Hours_Text,"4");break;case 480:t=Object(o.I)(c.a.ReminderSnoozeOption_Hours_Text,"8");break;case 720:t=Object(o.I)(c.a.ReminderSnoozeOption_Day_Text,"0.5");break;case 1440:t=Object(o.I)(c.a.ReminderSnoozeOption_Day_Text,"1");break;case 2880:t=Object(o.I)(c.a.ReminderSnoozeOption_Days_Text,"2");break;case 4320:t=Object(o.I)(c.a.ReminderSnoozeOption_Days_Text,"3");break;case 5760:t=Object(o.I)(c.a.ReminderSnoozeOption_Days_Text,"4");break;case 10080:t=c.a.ReminderSnoozeOption_OneWeek_Text;break;case 20160:t=c.a.ReminderSnoozeOption_TwoWeeks_Text}return t},e}(),S=n(475),y=n(555);n.d(t,"a",(function(){return v}));var v=function(e){function t(t){var n=e.call(this,t)||this;return n.onClick=function(e){n.snoozeOptionChanged(e.currentTarget&&e.currentTarget.id)},n.onShowOrHideMoreItems=function(e){Object(s.e)().click(n.state.ShowMoreRemindersExpanded?"SeeLess":"SeeMore","NotificationsPane",d.a[d.a.ReminderNotification]),n.setState({ShowMoreRemindersExpanded:!n.state.ShowMoreRemindersExpanded})},n.snoozeOptionChanged=function(e){n.onSnoozeClose();var t=Object(b.b)(n.props.notifications,n.state.SnoozeReminderId,!0);if(t.length>0){var i=parseInt(e),a=void 0;a=i<0?t[0].payload.reminder.ReminderItemDataModel.StartDate.addMinutes(i):0===i?t[0].payload.reminder.ReminderItemDataModel.StartDate:l.c.Now.addMinutes(i);var o=l.c.generateISO8601DateTimeMsStringWithOffset(a);n.props.removeReminder(t[0].payload.id),n.props.snoozeReminders(t.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId})),o)}},n.dismissAll=function(){Object(s.e)().click("DismissAll","NotificationToast",d.a[d.a.ReminderNotification]);var e=n.props.notifications.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId}));n.props.dismissAll(d.a.ReminderNotification,e)},n.onSelectedItem=function(e){n.setState({SelectedReminderId:e})},n.onSnoozeClose=function(){n.setState(Object(i.__assign)(Object(i.__assign)({},n.state),{SnoozeReminderId:null}))},n.onSnoozeClick=function(e,t){Object(s.e)().click("Snooze","NotificationToast",d.a[d.a.ReminderNotification]),n.setState({SnoozeReminderId:e,SnoozeElement:t})},n.onReminderContainerClick=function(e){e.stopPropagation()},n.onReminderItemClick=function(e){Object(s.e)().click("NotificationClick","NotificationToast",d.a[d.a.ReminderNotification]),n.setState(Object(i.__assign)(Object(i.__assign)({},n.state),{SelectedReminderId:e}))},n.handleKeydown=function(e){if(e instanceof KeyboardEvent&&"keydown"===e.type&&[38,40,35,36].indexOf(e.which)>-1){var t={index:n.state.CurrentIndex,selectedReminderId:n.state.SelectedReminderId};if(!Object(b.e)(n.props.notifications,e.which,t))return;null!=t.selectedReminderId&&t.index>-1&&n.setState({SelectedReminderId:t.selectedReminderId,CurrentIndex:t.index})}},n.state={SelectedReminderId:null,CurrentIndex:-1,SnoozeReminderId:null,SnoozeElement:null,ShowMoreRemindersExpanded:!1,LastUpdatedTime:l.c.now},n.aggregatedId=n.props.isInFlexPane?"Flexpane_Reminders_Id":"Aggregated_Reminders_Id",n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=l.c.Now,n=l.b-1e3*t.second-t.millisecond;setTimeout((function(){e.timeInterval=window.setInterval((function(){return e.setState({LastUpdatedTime:l.c.now})}),6e4)}),n),Object(o.t)([this.aggregatedId],o.e.KEYDOWN,this.handleKeydown);var i=new g,a=i.getSnoozeOptions();this.dropdownItems=a.map((function(e){return{id:e.toString(),text:i.getSnoozeDisplayText(e)}}))},t.prototype.componentWillUnmount=function(){window.clearInterval(this.timeInterval),Object(o.T)([this.aggregatedId],o.e.KEYDOWN,this.handleKeydown)},t.prototype.render=function(){var e,t=this,n=this.props.notifications,s=n.length;this.props.isInFlexPane&&!this.state.ShowMoreRemindersExpanded&&s>3&&(n=n.slice(0,3));var l=Object(r.a)();e=this.props.isInFlexPane?Object(o.y)(f.notificationItem,f.itemContent,l.neutral.foreground.background,l.neutral.lighter.border,l.neutral.foregroundAlt.hover.background):Object(o.y)(S.reminderBox,l.neutral.lighter.border,l.neutral.lighter.hover.background);var d,p,u=0,b=n.map((function(n){var i=n.payload.reminder.ReminderItemDataModel.ItemId===t.state.SelectedReminderId,o=t.aggregatedId+u;return u++,a.createElement("div",{id:"rmdContainer"+u,"aria-labelledby":"rmdcontext"+u,key:o,"aria-selected":i,role:"option",className:e},a.createElement(m,{id:o,order:u,reminderItem:n,isInFlexPane:!1,selectedReminderId:t.state.SelectedReminderId,config:t.props.notificationConfiguration,LastUpdatedTime:t.state.LastUpdatedTime,onClick:t.onReminderItemClick,snoozeReminderId:t.state.SnoozeReminderId,onSnoozeClick:t.onSnoozeClick,onSnoozeClose:t.onSnoozeClose,onSelectedItem:t.onSelectedItem,onDismiss:t.props.dismiss,removeReminder:t.props.dismiss,alertImpressionLogEnabled:t.props.alertImpressionLogEnabled}))}));this.props.isInFlexPane?d=s>0&&a.createElement("div",{className:Object(o.y)(f.header,o.P.maxWidth,o.P.maxHeight,l.neutral.light.border),"aria-hidden":!0},a.createElement("div",{className:Object(o.y)(o.P.tableCellMiddle,f.label)},a.createElement("h2",{className:Object(o.y)(f.headerText,l.neutral.dark.font),"aria-label":c.a.Reminder_Title},c.a.Reminder_Title)),a.createElement("div",{className:o.P.tableCellMiddle},a.createElement(h.a,{onDismissAll:this.dismissAll,title:c.a.Reminder_Title})),a.createElement("div",{className:f.clearStyle})):p=a.createElement("div",{id:"ReminderHeader",className:Object(o.y)(o.P.maxWidth,o.P.maxHeight,S.header,l.neutral.light.border),"aria-hidden":!0},a.createElement("div",{className:Object(o.y)(o.P.tableCellMiddle,S.label)},a.createElement("span",{"aria-label":c.a.Reminder_Title,className:Object(o.y)(f.headerText,l.neutral.dark.font)},c.a.Reminder_Title)),a.createElement("div",{className:Object(o.y)(o.P.tableCellMiddle,S.label)},a.createElement(h.a,{onDismissAll:this.dismissAll,title:c.a.Reminder_Title})));var g=this.props.isInFlexPane?Object(o.y)(f.toastControl,f.headingBar):Object(o.y)(o.P.table,o.P.maxWidth,o.P.maxHeight),v=this.state.SnoozeElement?this.state.SnoozeElement.getBoundingClientRect():null,I=v?{left:v.left-147,top:v.top+32}:{margin:0},A=this.props.isInFlexPane?f.notificationContainer:S.toastScrollRegion;return a.createElement("div",{onClick:this.onReminderContainerClick,className:g,role:"group"},d,this.state.SnoozeReminderId&&a.createElement(o.c,{className:y.dropDrown,popupPosition:I,ariaLabel:c.a.ReminderSnooze_Aria_Text,onDismiss:this.onSnoozeClose,isScrollHidden:!0,scrollContainerId:this.props.isInFlexPane?"flexPaneScrollRegion":"Aggregated_Reminders_Id"},this.dropdownItems.map((function(e){return a.createElement(o.d,Object(i.__assign)({className:Object(o.y)(y.snoozeContextMenuItem,l.neutral.dark.font,l.neutral.foreground.background,l.neutral.light.hover.background),displayText:e.text,key:e.id,itemId:e.id,onclick:t.onClick},e,{role:"button"}))}))),p,a.createElement("div",{id:this.aggregatedId,role:"listbox","aria-multiselectable":"true",tabIndex:-1,className:Object(o.y)(A),"aria-label":c.a.Reminder_Title},b),s>3&&this.props.isInFlexPane&&a.createElement("button",{type:"button",onClick:this.onShowOrHideMoreItems,className:Object(o.y)(f.footer,f.itemLink),"aria-label":this.state.ShowMoreRemindersExpanded?c.a.ShowLess:c.a.ShowMore},a.createElement("span",{className:Object(o.y)(f.showMoreLink,l.neutral.accent.font)},this.state.ShowMoreRemindersExpanded?c.a.ShowLess:c.a.ShowMore)))},t}(a.Component)},547:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base ._87c41c80bf2017bb3c1612e7ee5a3cb5\\.scss{border-width:1px;border-style:solid;box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);-webkit-box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);margin:0 16px 10px;display:block}.o365cs-base ._87c41c80bf2017bb3c1612e7ee5a3cb5\\.scss:hover{box-shadow:0 8px 10px -2px rgba(0,0,0,.08);-webkit-box-shadow:0 8px 10px -2px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear}.o365cs-base .b823239cdf58a943bd77b1219048608e\\.scss{box-shadow:0 16px 18px -4px rgba(0,0,0,.08);-webkit-box-shadow:0 16px 18px -4px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear;border-width:1px;border-style:solid}.o365cs-base .b54a17ce6e6d4fb3ac0a02d994ca8296\\.scss{display:block}.o365cs-base ._1d4727a416e41bc89c354894012f9e1a\\.scss{display:table-cell;height:auto;padding:8px 16px;line-height:16px;text-align:center;vertical-align:middle;opacity:1%;border-radius:2px;font:400 14px;border-width:1px;border-style:solid}.o365cs-base ._7106de1af790bd51ac2381031e57c79f\\.scss{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss{display:table-cell}.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss,.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss div,.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss div,.o365cs-base ._86b8b1e58b59845f56e4410ddd87fee9\\.scss span{display:inline-block}.o365cs-base ._3a45e674dded614b057e61d206d25229\\.scss{margin:0 auto 1px;display:inline-block;font-size:12px}.o365cs-base ._9e7a2470eb060b0fdb0ce5cd5e115d64\\.scss{min-width:0;position:absolute;right:14px;border-width:0;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;margin:4px 8px 0 0;box-sizing:border-box;text-align:center}.o365cs-base ._9e7a2470eb060b0fdb0ce5cd5e115d64\\.scss span{font-size:12px}.o365cs-base ._5e7c498d7df80201c5191960566ff465\\.scss{background-color:transparent;border-width:0;height:22px;display:inline-block;white-space:nowrap;min-width:0;font-size:12px;line-height:16px;padding:0 16px 0 0}.o365cs-base ._5e7c498d7df80201c5191960566ff465\\.scss span{cursor:pointer;font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .d7944a847ecea0bf60136c5d9d3d7e67\\.scss{width:100%;text-align:right;display:block}.o365cs-base .d7944a847ecea0bf60136c5d9d3d7e67\\.scss button,.o365cs-base .d7944a847ecea0bf60136c5d9d3d7e67\\.scss div,.o365cs-base .d7944a847ecea0bf60136c5d9d3d7e67\\.scss span{text-align:right}.o365cs-base ._85f77e12d10661e5ab56ca20f057a2f6\\.scss{line-height:19px;padding-left:0;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._85f77e12d10661e5ab56ca20f057a2f6\\.scss div{display:inline-block}.o365cs-base .da20a5fe353313f5b0a8aae83cc483f1\\.scss{display:none}.o365cs-base ._2166307a581211902cce35d139d37a21\\.scss{border-top-width:1px;border-top-style:solid;padding-top:8px;margin-top:16px;display:block;width:100%}.o365cs-base ._2166307a581211902cce35d139d37a21\\.scss a{line-height:20px;padding:0 0 10px}.o365cs-base ._2166307a581211902cce35d139d37a21\\.scss button{width:72px;height:32px;border-radius:2px;border-style:solid;border-width:1px;margin-right:10px}.o365cs-base .d4336ebb488eca87a9be3bb21b123dc8\\.scss{padding-left:5px;vertical-align:middle;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.o365cs-base .d485296664e3a3f55929a52f1df4fde9\\.scss{padding-right:8px}.o365cs-base ._967f95569f0229c179314f43edc45026\\.scss{display:block}.o365cs-base ._650257aa76cbd6d581c434d855af1301\\.scss{clear:"both"}.o365cs-base .e600ecf8acbef4c7a4feb85b4259e336\\.scss{line-height:21px;display:table-cell;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;padding:0 0 0 16px;max-height:40px}.o365cs-base .c2efa238944307c451f9c621b68cda40\\.scss{overflow:hidden}.o365cs-base ._52411c96800582385abb2c2759b59ab1\\.scss{text-decoration:none}.o365cs-base ._52411c96800582385abb2c2759b59ab1\\.scss:hover{text-decoration:underline}.o365cs-base ._91948199a2ccb0dde680d04c0cfe076a\\.scss{font-size:10px}.o365cs-base .abff9bf33769226109abc065b5ea3c7e\\.scss{text-align:left;overflow:hidden;box-sizing:content-box;width:100%;padding:0}.o365cs-base .fdc515d39e197278887ea329bf56d1d5\\.scss{display:table;padding:0;height:auto;background-color:transparent;margin-bottom:12px;border:none}.o365cs-base ._0a181001f033632e606b08ec6c7951a2\\.scss{display:table-cell}.o365cs-base .b294aeca3f6df935f210d8106a8cec97\\.scss{margin-top:10px;box-sizing:content-box;width:100%;padding-bottom:16px}.o365cs-base .b234dde7289d28517292fd90bd536a1f\\.scss{display:block;height:100%;min-height:64px}.o365cs-base .cdeb804ed418461987d147e3cc841962\\.scss:hover{text-decoration:underline}.o365cs-base ._85bcb14807630c8390347922dbbef40d\\.scss{padding:0 10px 0 16px;text-align:left;width:100%;height:auto;border-width:0;background:transparent}.o365cs-base ._85bcb14807630c8390347922dbbef40d\\.scss span{cursor:pointer;font:400 14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._49d96cdc4d0f690877a19cf21518e5c7\\.scss{padding-top:10px}',""]),t.locals={notificationItem:"_87c41c80bf2017bb3c1612e7ee5a3cb5.scss",notificationToast:"b823239cdf58a943bd77b1219048608e.scss",notificationContainer:"b54a17ce6e6d4fb3ac0a02d994ca8296.scss",notificationButton:"_1d4727a416e41bc89c354894012f9e1a.scss",notificationBodyText:"_7106de1af790bd51ac2381031e57c79f.scss",notificationLink:"_86b8b1e58b59845f56e4410ddd87fee9.scss",icon:"_3a45e674dded614b057e61d206d25229.scss",closeButton:"_9e7a2470eb060b0fdb0ce5cd5e115d64.scss",dismissAll:"_5e7c498d7df80201c5191960566ff465.scss",dismissContain:"d7944a847ecea0bf60136c5d9d3d7e67.scss",notificationTitle:"_85f77e12d10661e5ab56ca20f057a2f6.scss",hidden:"da20a5fe353313f5b0a8aae83cc483f1.scss",actionBar:"_2166307a581211902cce35d139d37a21.scss",actionArrow:"d4336ebb488eca87a9be3bb21b123dc8.scss",paddingRight:"d485296664e3a3f55929a52f1df4fde9.scss",displayBlock:"_967f95569f0229c179314f43edc45026.scss",clearStyle:"_650257aa76cbd6d581c434d855af1301.scss",headerText:"e600ecf8acbef4c7a4feb85b4259e336.scss",overflowHidden:"c2efa238944307c451f9c621b68cda40.scss",itemLink:"_52411c96800582385abb2c2759b59ab1.scss",headingBar:"_91948199a2ccb0dde680d04c0cfe076a.scss",toastControl:"abff9bf33769226109abc065b5ea3c7e.scss",header:"fdc515d39e197278887ea329bf56d1d5.scss",label:"_0a181001f033632e606b08ec6c7951a2.scss",content:"b294aeca3f6df935f210d8106a8cec97.scss",itemContent:"b234dde7289d28517292fd90bd536a1f.scss",showMoreLink:"cdeb804ed418461987d147e3cc841962.scss",footer:"_85bcb14807630c8390347922dbbef40d.scss",paddingTop:"_49d96cdc4d0f690877a19cf21518e5c7.scss"}},548:function(e,t,n){var i=n(549);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},549:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base ._1e14a4fd01a4e51889a00e2ae37e1afb\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base .b02ba978c52f6a1d5468bec690c46cd1\\.scss{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base .d71e3a584b46cef83d1a4ac42e33a543\\.scss{line-height:16px;max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}.o365cs-base ._62dcf7891566649e72cd9db567995519\\.scss{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:12px;vertical-align:bottom}.o365cs-base .f83cf8e8238404e7ec0ca4be05c4da01\\.scss{line-height:18px;padding:4px 0 0;width:250px;font-size:14px}.o365cs-base ._39b59f9d63d551fbb687c8d0cdb11e36\\.scss{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base ._933a59458cf2344d084f99429a0f3f29\\.scss{display:table-cell;vertical-align:middle}.o365cs-base .cf5fe479ec39fa8d0c7a9ad659d8697c\\.scss{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._3ad677d0af1cf902a5a73cb7134c8bca\\.scss{margin-top:5px;top:auto}.o365cs-base .f382d611078071fe0ef99bea70185180\\.scss{margin-top:20px}.o365cs-base ._412202598d3a93e63c8a4c130c2bb7c9\\.scss a{min-height:64px;position:relative;text-decoration:none}.o365cs-base ._6c3040e616f5acb5c1e89f3ccab78ed7\\.scss{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px;padding:6px 0;min-height:34px}.o365cs-base ._6c3040e616f5acb5c1e89f3ccab78ed7\\.scss div,.o365cs-base ._6c3040e616f5acb5c1e89f3ccab78ed7\\.scss span{display:table-cell;vertical-align:top}.o365cs-base .e1031ade09fe06a123a9fc6605e9f5fa\\.scss{font-size:24px;padding:0 16px 0 6px;margin-top:-2px}.o365cs-base ._4dfd8fa49d1e2c3b0bd432849f4e546d\\.scss{width:155px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;padding-top:0;margin-top:-2px}',""]),t.locals={mailText:"_1e14a4fd01a4e51889a00e2ae37e1afb.scss",sender:"b02ba978c52f6a1d5468bec690c46cd1.scss",mailSubject:"d71e3a584b46cef83d1a4ac42e33a543.scss",mailIcon:"_62dcf7891566649e72cd9db567995519.scss",bodyPreviewText:"f83cf8e8238404e7ec0ca4be05c4da01.scss",newMailPopupButton:"_39b59f9d63d551fbb687c8d0cdb11e36.scss",newMailPopupButtonCell:"_933a59458cf2344d084f99429a0f3f29.scss",itemContent:"cf5fe479ec39fa8d0c7a9ad659d8697c.scss",newMailPersonaImage:"_3ad677d0af1cf902a5a73cb7134c8bca.scss",newFlexPaneNewMailNotification:"f382d611078071fe0ef99bea70185180.scss",newMailLink:"_412202598d3a93e63c8a4c130c2bb7c9.scss",condensed:"_6c3040e616f5acb5c1e89f3ccab78ed7.scss",condensedIcon:"e1031ade09fe06a123a9fc6605e9f5fa.scss",condensedMailText:"_4dfd8fa49d1e2c3b0bd432849f4e546d.scss"}},550:function(e,t,n){var i=n(551);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},551:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base .bfbe99cd2bcbd9f76a86af6b0acde924\\.scss{border-left:0;border-right:0;max-height:none;height:auto!important;display:block;text-align:left;min-height:auto;padding:12px 14px 0;cursor:pointer;text-decoration:none!important;white-space:normal;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .ca3d5f0d1e15b7be7dce3a5fb2a4d7c8\\.scss{margin:6px 18px 0 6px;font-size:24px}.o365cs-base .d5da59413566a96f5646ea46ac6c5d11\\.scss{margin:3px 8px 0 0;font-size:14px}.o365cs-base ._334f13cd5a0761abfc5a70e491a89776\\.scss{display:block;font-size:14px}.o365cs-base ._1f0c633b5fc7707603d1f7ec2920cfe1\\.scss{padding-right:0;padding-top:2px;display:block;box-sizing:content-box;white-space:normal}.o365cs-base ._1f0c633b5fc7707603d1f7ec2920cfe1\\.scss span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._763bf634b5331f89df0d4cd585b0cdb9\\.scss{box-sizing:content-box;white-space:normal;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .c6e1836db6eeb64b1ae5db628c54ea06\\.scss{padding-right:5px;padding-bottom:24px;font-size:11px;box-sizing:content-box;white-space:normal}.o365cs-base ._6bfd1901fccfa320412f0a8aa0fe615e\\.scss{margin-top:-9px}',""]),t.locals={container:"bfbe99cd2bcbd9f76a86af6b0acde924.scss",alertIcon:"ca3d5f0d1e15b7be7dce3a5fb2a4d7c8.scss",alertPaneIcon:"d5da59413566a96f5646ea46ac6c5d11.scss",text:"_334f13cd5a0761abfc5a70e491a89776.scss",message:"_1f0c633b5fc7707603d1f7ec2920cfe1.scss",title:"_763bf634b5331f89df0d4cd585b0cdb9.scss",actionText:"c6e1836db6eeb64b1ae5db628c54ea06.scss",systemClose:"_6bfd1901fccfa320412f0a8aa0fe615e.scss"}},552:function(e,t,n){var i=n(553);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},553:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base .e532c07e6c984a9e8139df5ca9e9ccec\\.scss{position:relative;height:auto;padding:12px 14px;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;touch-action:pan-x pan-y pinch-zoom manipulation;-ms-touch-action:pan-x pan-y pinch-zoom manipulation}.o365cs-base .e532c07e6c984a9e8139df5ca9e9ccec\\.scss:first-child{border-top:none}.o365cs-base .b89aa1d178366acaecd90cffb3a3acf4\\.scss{width:245px}.o365cs-base ._9fc51e4cf1acb8ccff59dc754b2a581a\\.scss{width:140px}.o365cs-base .cda8fcbfeedeb082f2b3834eaa0e98dd\\.scss,.o365cs-base ._9fc51e4cf1acb8ccff59dc754b2a581a\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:inline-block;height:19px;text-align:left}.o365cs-base .cda8fcbfeedeb082f2b3834eaa0e98dd\\.scss{width:125px}.o365cs-base .cda8fcbfeedeb082f2b3834eaa0e98dd\\.scss span{line-height:19px;height:19px}.o365cs-base ._40abe3217e9434e3396064dbd5c76952\\.scss{text-align:right;display:block;width:100%}.o365cs-base .ccca4d419545108fb7e17592e5d68676\\.scss{display:inline-block;padding-right:1px}.o365cs-base ._77cb05724a7950881f5326b73fb53b1f\\.scss{display:inline-block;line-height:19px;padding:0 3px}.o365cs-base .c2e91a8b8a1ca573671007b71f2c75d2\\.scss{height:50%;width:100%;display:block}.o365cs-base .b4c592c1428250343a56e1e01c3079da\\.scss{max-width:210px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.o365cs-base .b4c592c1428250343a56e1e01c3079da\\.scss div{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px}.o365cs-base ._1469b77e244b7f83d549df379d7493a2\\.scss{margin:1px 8px 0 0}.o365cs-base ._0a056f8eb88e1acf08b04ce87dd23e9f\\.scss{min-width:0;position:absolute;right:36px;border-width:0;margin-top:-8px;padding-top:8px;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;line-height:12px;box-sizing:border-box}.o365cs-base ._0a056f8eb88e1acf08b04ce87dd23e9f\\.scss span{font-size:14px}.o365cs-base ._0a056f8eb88e1acf08b04ce87dd23e9f\\.scss:hover{text-decoration:none}.o365cs-base .dff7ee3039b7c7019a01ebf97604338e\\.scss{margin:-8px 0 0;right:4px;padding-top:10px}',""]),t.locals={remindersContainer:"e532c07e6c984a9e8139df5ca9e9ccec.scss",remindersLeftColumn:"b89aa1d178366acaecd90cffb3a3acf4.scss",remindersTitle:"_9fc51e4cf1acb8ccff59dc754b2a581a.scss",remindersRemain:"cda8fcbfeedeb082f2b3834eaa0e98dd.scss",remindersRightColumn:"_40abe3217e9434e3396064dbd5c76952.scss",toastRemindersTimeToStartValue:"ccca4d419545108fb7e17592e5d68676.scss",remindersTimeToStartUnit:"_77cb05724a7950881f5326b73fb53b1f.scss",remindersRow:"c2e91a8b8a1ca573671007b71f2c75d2.scss",remindersDescription:"b4c592c1428250343a56e1e01c3079da.scss",reminderIcon:"_1469b77e244b7f83d549df379d7493a2.scss",alarmButton:"_0a056f8eb88e1acf08b04ce87dd23e9f.scss",reminderCloseButton:"dff7ee3039b7c7019a01ebf97604338e.scss"}},554:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".o365cs-base ._878519d693600f6f4972731fe3ed5c07\\.scss a:active,.o365cs-base ._878519d693600f6f4972731fe3ed5c07\\.scss a:hover,.o365cs-base ._878519d693600f6f4972731fe3ed5c07\\.scss a:link,.o365cs-base ._878519d693600f6f4972731fe3ed5c07\\.scss a:visited{text-decoration:none}.o365cs-base ._878519d693600f6f4972731fe3ed5c07\\.scss .systemNotification *{white-space:normal}.o365cs-base ._38149dac64d98530a9805aa566131657\\.scss{overflow:hidden;margin-bottom:10px;line-height:normal}.o365cs-base .e252d02671c7bacbffd7683c59e9335b\\.scss{display:table;height:40px;box-sizing:content-box;margin:0;border-bottom-width:1px;border-bottom-style:solid}.o365cs-base .e3847e27b35544d699884221ca614df5\\.scss{display:inline-block;width:20px}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss{-ms-flex:1;flex:1;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;min-width:125px;max-height:230px}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar{width:6px}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button,.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-corner,.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-track{background-color:transparent}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button{background-repeat:no-repeat;cursor:pointer}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button:vertical{background-position:50%;width:18px;height:18px}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUUlEQVQ4T6XLMQ6AMAwEwfz/bXRIfOeQCxckK8iKYgqvfCPJLxgNjAZGA6OB0VjCcV55M/8/jkbDMv+VJbSdccHYvsYFo4HRwGhgNDAaGPdl3LNlBnofQ4+bAAAAAElFTkSuQmCC)}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUklEQVQ4T6XLsQ2AMAwF0ey/A1swAnt95MIFyQlyoniFT/4jyS8YDYwGRgOjgdFYwnFeeTP/P45GwzL/lSW0nXHB2L7GBaOB0cBoYDQwGhj3Zdx8sf7rjOGQqwAAAABJRU5ErkJggg==)}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVUlEQVQ4T6XMMQoAIQxEUe9/NrsFrzOSIqDxgzu7xSv8ZGySfsHowOjA6MDowOjAmPozFGpfYQw5vn2CsY5TvQtHoOGq3m+PLzA6MDowOjA6ML6nNgFW+wZ6kTk6FAAAAABJRU5ErkJggg==)}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVklEQVQ4T6XMwQ3AIAwEQfrvgS5SAn0d8sMSmJXIJY95sPLRJP2C0YHRgdGB0YHRgTH1ZyjUvsIYcnz7BGMdp3oXjkDDVb3fHl9gdGB0YHRgdGB8T20CB+X+675uLU0AAAAASUVORK5CYII=)}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-thumb{border-radius:9px;border:none;background-color:#ccd3d6}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-thumb:vertical{min-height:50px}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss::-webkit-scrollbar-thumb:hover{background-color:#9db4c4}.o365cs-base ._40a9676ccafc71272afbbb24ef9de16c\\.scss:not(:-webkit-any-link){box-sizing:border-box}.o365cs-base ._673b875dc797aac4a820dd90d2931491\\.scss{padding-top:5px;padding-left:10px;text-align:left;height:25px;width:100%}.o365cs-base ._882cff50d994eaa772cac178e87f7c11\\.scss{margin-top:10px}.o365cs-base ._56278803dbfbf910a525e156a2916a25\\.scss{display:table-cell}.o365cs-base ._1a5af1ef0657ffe73963c8813af125ee\\.scss{border-bottom-width:1px;border-bottom-style:solid}.o365cs-base .c398af2d5a7fa486dc7b8201bca06b81\\.scss{position:relative;right:5px;margin:0;padding-top:5px}",""]),t.locals={o365cs:"_878519d693600f6f4972731fe3ed5c07.scss",toastSlot:"_38149dac64d98530a9805aa566131657.scss",header:"e252d02671c7bacbffd7683c59e9335b.scss",chevronDiv:"e3847e27b35544d699884221ca614df5.scss",toastScrollRegion:"_40a9676ccafc71272afbbb24ef9de16c.scss",footer:"_673b875dc797aac4a820dd90d2931491.scss",notificationsContent:"_882cff50d994eaa772cac178e87f7c11.scss",label:"_56278803dbfbf910a525e156a2916a25.scss",reminderBox:"_1a5af1ef0657ffe73963c8813af125ee.scss",headerCloseButton:"c398af2d5a7fa486dc7b8201bca06b81.scss"}},555:function(e,t,n){var i=n(556);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},556:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'._1248e61c4ff0b2cf7b2c7b8bb81b86ed\\.scss{width:170px;height:335px;display:block;position:fixed;overflow:hidden;box-sizing:border-box;z-index:1000101}.o365cs-base .f4e3f0ccb17edc357d87fc1141a7d1e0\\.scss{width:190px;padding:7px 0 0 18px;line-height:0;height:35px;font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:400;position:relative}',""]),t.locals={dropDrown:"_1248e61c4ff0b2cf7b2c7b8bb81b86ed.scss",snoozeContextMenuItem:"f4e3f0ccb17edc357d87fc1141a7d1e0.scss"}},557:function(e,t,n){var i=n(558);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},558:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base ._9431b3a0eb9d255801609abc06379809\\.scss{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;min-height:34px}.o365cs-base ._9431b3a0eb9d255801609abc06379809\\.scss div,.o365cs-base ._9431b3a0eb9d255801609abc06379809\\.scss span{display:table-cell}.o365cs-base ._99b62c65e0e6b53a237e2b6258fe9ddb\\.scss{font-size:24px;padding:6px 16px 0 6px}.o365cs-base ._3d283d5c57674fed8b0c784e96475d48\\.scss{width:180px;text-overflow:ellipsis;overflow:hidden;vertical-align:middle}.o365cs-base ._77507a84d2d4937746bbd99cd9842560\\.scss{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base .f8d4987b1263720a0202e35b83172f8c\\.scss{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._19dfa29d48566968873e4fea27ec9971\\.scss{margin-top:5px;top:auto}.o365cs-base .b565834899a017696bc5863a79a11d0f\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base ._5fede363b6d49c261fc3ff003650ce13\\.scss{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base ._159c39181e147a87a7168678ca3d069f\\.scss{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:15px;vertical-align:bottom}.o365cs-base .d25ba19936abe00c1145a861104f2519\\.scss{max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}',""]),t.locals={condensed:"_9431b3a0eb9d255801609abc06379809.scss",condensedIcon:"_99b62c65e0e6b53a237e2b6258fe9ddb.scss",condensedText:"_3d283d5c57674fed8b0c784e96475d48.scss",toastContent:"_77507a84d2d4937746bbd99cd9842560.scss",chatContent:"f8d4987b1263720a0202e35b83172f8c.scss",PersonaImage:"_19dfa29d48566968873e4fea27ec9971.scss",chatText:"b565834899a017696bc5863a79a11d0f.scss",chatTitle:"_5fede363b6d49c261fc3ff003650ce13.scss",chatIcon:"_159c39181e147a87a7168678ca3d069f.scss",chatPreview:"d25ba19936abe00c1145a861104f2519.scss"}},559:function(e,t,n){var i=n(560);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},560:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".e9c16c2e6ca75d98fd60849559df75db\\.scss{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;background:transparent;min-width:320px;max-width:320px;width:324px;height:auto;outline:0;display:block;overflow-y:hidden;z-index:1000100;box-shadow:none}.e9c16c2e6ca75d98fd60849559df75db\\.scss:focus{box-shadow:none!important}.o365cs-base .de697b876b9a03d28633f27bdc9e0687\\.scss{margin:12px 16px 16px}.o365cs-base ._22116fe58c4ca7234390ba81b793a488\\.scss{min-height:800px}",""]),t.locals={popupControl:"e9c16c2e6ca75d98fd60849559df75db.scss",toastContainer:"de697b876b9a03d28633f27bdc9e0687.scss",toastContainerHeight:"_22116fe58c4ca7234390ba81b793a488.scss"}},561:function(e,t,n){var i=n(562);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},562:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.o365cs-base ._300e4cbe1d6398b037910b394b812987\\.scss{display:inline-block;font-size:19px;vertical-align:middle}.o365cs-base ._55c2a96212c0df9f39373e5778a92842\\.scss{color:inherit}.o365cs-base .fac03af64c7578dce5712745ac0b3e6c\\.scss{position:absolute;bottom:43px;left:22px}.o365cs-base .b4d473f2544e767af9dd34c64ec05fff\\.scss{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:18px;height:18px;line-height:16px!important;border-radius:.8em;box-sizing:border-box}.o365cs-base ._4a8a7e61a1f472753e17e26b9a5c06e2\\.scss{border:1px solid}.o365cs-base ._2afe8a950b3b4d2fe9ef864ca7b12bf0\\.scss{width:26px!important}',""]),t.locals={icon:"_300e4cbe1d6398b037910b394b812987.scss",button:"_55c2a96212c0df9f39373e5778a92842.scss",unseenitems:"fac03af64c7578dce5712745ac0b3e6c.scss",unseenCount:"b4d473f2544e767af9dd34c64ec05fff.scss",unseenCountBorder:"_4a8a7e61a1f472753e17e26b9a5c06e2.scss",unseenCountOval:"_2afe8a950b3b4d2fe9ef864ca7b12bf0.scss"}},585:function(e,t,n){var i=n(586);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},586:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".a93177dcd740b6f5c1611045aef0c10b\\.scss{bottom:0;right:0;padding-right:20px;position:absolute;display:flex;z-index:1000001;align-items:flex-end;max-width:calc(100% - 320px);-webkit-box-align:end}.a93177dcd740b6f5c1611045aef0c10b\\.scss .conversation{display:initial}.a93177dcd740b6f5c1611045aef0c10b\\.scss iframe{margin-right:10px}",""]),t.locals={wrapperStyle:"a93177dcd740b6f5c1611045aef0c10b.scss"}},587:function(e,t,n){var i=n(588);"string"==typeof i&&(i=[[e.i,i,""]]);n(25)(i,{});i.locals&&(e.exports=i.locals)},588:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".a2a634632a5044e6567e6a5159201803\\.scss{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden;min-width:320px;max-width:320px;top:50px;height:450px;outline:0;display:block;visibility:hidden;z-index:1000001;-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:ease;animation-timing-function:ease}._400f7cc5b0b914b825049b4c1047d1dc\\.scss{-webkit-animation-name:slideInFrames;animation-name:slideInFrames;visibility:visible}@-webkit-keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.b1b84e4fda8cbbc8c31e01074fadf525\\.scss{box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden}._286aef024bbf6c72ed58178a3516ca08\\.scss{height:450px;width:320px}",""]),t.locals={chatWindowWidth:"320",chatPopup:"a2a634632a5044e6567e6a5159201803.scss",popupSlideIn:"_400f7cc5b0b914b825049b4c1047d1dc.scss",callout:"b1b84e4fda8cbbc8c31e01074fadf525.scss",recentsWrapper:"_286aef024bbf6c72ed58178a3516ca08.scss"}},673:function(e,t,n){"use strict";n.r(t);var i=n(10),a=n(3),o=n(33),s=n(295),r=n(0),c=n(2),l=n(138),d=n(1),p=n(17),f=n(185),u=n(195),b=n(9),m=n(51),h=n(585);var g,S,y,v,I,A=function(){var e=Object(b.b)(Object(a.y)(m.a.ChatWrapper,h.wrapperStyle),"chat_wrapper_pane");return document.body.appendChild(e),e},O=n(13),x=n(5),T=n(71),w=n(587),C=function(e){function t(t){var n=e.call(this,t)||this;return n.populateRecentsContent=function(e){e&&(n.props.isChatRecentsPaneInitialized?Object(T.g)(e,n.props.isTeamsChatActivated):n.initializeRecents(e))},n.initializeRecents=function(e){n.props.isChatAPIInitialized?Object(T.a)(e,n.props.onRecentsReady,n.props.isTeamsChatActivated):window.addEventListener(m.b.ChatAPIReady,(function(){n.onChatAPIReady(e)}))},n.onChatAPIReady=function(e){window.removeEventListener(m.b.ChatAPIReady,(function(){n.onChatAPIReady(e)})),Object(T.a)(e,n.props.onRecentsReady,n.props.isTeamsChatActivated)},n.onAnimationEnd=function(){n.chatPopUp&&n.chatPopUp.focus()},n.handleKeydown=function(e){switch(e.keyCode){case 27:e.stopPropagation(),e.preventDefault(),n.props.onDismiss(e),n.chatHeaderButton.focus()}},n.state={popupPosition:null},n}return Object(r.__extends)(t,e),t.prototype.calculatePopupPosition=function(){var e,t=parseInt(w.chatWindowWidth),n=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect();if(n&&0!==n.x||(this.chatHeaderButton=document.getElementById(p.a),n=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect()),n&&n.x>0){var i=n.left+.5*n.width-t/2;e=i+t>this.chatHeaderButton.offsetParent.clientWidth+this.chatHeaderButton.offsetWidth?{right:10}:i<0?{left:10}:{left:i}}else e=this.props.isRtl?{left:10}:{right:10};this.props.isThinHeader&&(e=Object(r.__assign)(Object(r.__assign)({},e),{top:this.props.isThinHeader?48:50})),this.setState({popupPosition:e})},t.prototype.render=function(){var e,t=Object(O.a)();return c.createElement(a.h,{onDismiss:this.props.onDismiss,ariaLabel:x.a.ChatOpened,role:"region",className:Object(a.y)(w.chatPopup,(e={},e[w.popupSlideIn]=this.props.isChatRecentsPaneOpen,e)),popupPosition:this.state.popupPosition,id:"chat_popup",onAnimationEnd:this.onAnimationEnd,isVisible:this.props.isChatRecentsPaneOpen,isPersistant:!0},c.createElement("div",{"data-style":"o365shell",className:Object(a.y)(m.a.ChatRecents,w.recentsWrapper,t.neutral.lighterAlt.background),ref:this.populateRecentsContent,id:"chat_recent_pane"}))},t.prototype.componentDidUpdate=function(e){!e.isChatRecentsPaneOpen&&this.props.isChatRecentsPaneOpen&&this.calculatePopupPosition()},t.prototype.componentDidMount=function(){window.addEventListener(a.e.RESIZE,this.props.onDismiss),window.addEventListener(a.e.SCROLL,this.props.onDismiss),this.chatPopUp||(this.chatPopUp=document.getElementById("chat_popup"),this.chatPopUp.addEventListener(a.e.KEYDOWN,this.handleKeydown))},t.prototype.componentWillUnmount=function(){window.removeEventListener(a.e.RESIZE,this.props.onDismiss),window.removeEventListener(a.e.SCROLL,this.props.onDismiss),this.chatPopUp.removeEventListener(a.e.KEYDOWN,this.handleKeydown)},t}(c.Component),_=n(122),E=Object(i.b)((function(e){return{isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneInitialized:e.chatState.isChatRecentsPaneInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isThinHeader:Object(d.f)().isThinHeader,isTeamsChatActivated:e.chatState.isTeamsChatActivated,isRtl:e.userState&&e.userState.isRtl}}),(function(e){return{onRecentsReady:function(){e(Object(_.b)(!0))},onDismiss:function(t){var n=document.getElementById(p.a);t instanceof MouseEvent&&t.target&&n&&n.contains(t.target)||e(Object(_.c)(!1))}}}))(C),N=n(194),R=document.getElementById(p.b),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myPresenceStatusUpdate=function(e){if(t.props.userPresenceStatusItems){var n=Object(l.b)(e,t.props.userPresenceStatusItems);t.props.userPresenceStatusUpdate(n)}t.presenceStatusKey=e},t.onPresenceStatusChanged=function(e){var n=t.props.presenceStatus,i=Object(l.b)(e,t.props.userPresenceStatusItems);Object(T.j)(i,(function(){Object(d.e)().exception("Chat API setUserPresenceStatus failed",6,null),t.props.userPresenceStatusUpdate(n)}))},t.onChatClickHandler=function(e){var n=e instanceof MouseEvent;if(e instanceof KeyboardEvent)switch(e.which){case 40:n=e.altKey;break;case 13:case 32:e.preventDefault(),n=!0}n&&t.chatClicked(e)},t.onNotificationReceived=function(e){var n=e;if(n){var i=t.props.chatNotificationsEnabled&&(n.type===f.a.message||n.type===f.a.summary);if(t.props.callingNotificationsEnabled&&n.type===f.a.call||i){var a={type:n.type,title:n.title,description:n.description,actionLink:n.actions.length>0?n.actions[0]:null,cancelLink:n.actions.length>1?n.actions[1]:null,image:n.avatarUrl,sender:n.sender,id:n.id},o={providerType:f.b.ChatNotification,subType:n.type,payload:a,toastType:n.type===f.a.call?1:0,toastState:0};t.props.onNotificationReceived(o),Object(d.e)().impression(n.type,"Chat")}}},t.onStartChat=function(){t.props.onRecentsOpen(!1,p.a),Object(d.e)().impression("ChatWindowOpened","Chat")},t.onChatNotificationSettingsUpdated=function(e){var n=e;if(n){var i=Object(T.e)(n.value);switch(n.name){case m.e.NewMessage:t.updateChatSettings(i);break;case m.e.IncomingCall:t.updateCallSettings(i)}}},t}return Object(r.__extends)(t,e),t.prototype.render=function(){return this.props.chatEnabled&&this.props.isChatAPIInitialized?c.createElement(E,null):null},t.prototype.componentDidMount=function(){t.chatLoading||!this.props.chatEnabled||this.props.isChatAPIInitialized||this.beginChatInitialization()},t.prototype.componentDidUpdate=function(){t.chatLoading||!this.props.chatEnabled||this.props.isChatAPIInitialized||this.beginChatInitialization()},t.prototype.beginChatInitialization=function(){var e=this;t.chatLoading=!0,this.props.isConsumerShell?(g=function(){e.onChatCoreReady()},S=function(){e.onChatAPIReady()},window.addEventListener(m.b.ChatCoreReady,g),window.addEventListener(m.b.ChatAPIReady,S),this.appendChatAPIDownloadScript()):(y=function(){e.props.onTeamsChatActivated(!0),e.onChatCoreReady(),window.removeEventListener(N.b.TeamsChatAPIReady,y)},window.addEventListener(N.b.TeamsChatAPIReady,y),this.appendTeamsChatDownloadScript())},t.prototype.onChatCoreReady=function(){var e=this,t=this.getInitParams();!this.props.isTeamsChatActivated&&swc&&t?(window.removeEventListener(m.b.ChatCoreReady,g),swc.init(null,t).catch((function(t){window.removeEventListener(m.b.ChatAPIReady,S),e.handleAPIInitializationError(t)}))):TeamsClient?TeamsClient.SDK.create({chatsParentElement:A(),hostCtx:this.props.workloadId,loginHint:this.props.upn}).then((function(e){return TeamsClient.client=e,TeamsClient.client.notifications.get()})).then((function(t){t.subscribe((function(t){t.type===N.a.UnreadCounterUpdate&&e.props.onUnreadConversationUpdate(t.data)})),e.onChatAPIInitialized(!0)})).catch((function(t){e.handleAPIInitializationError(t)})):(window.removeEventListener(m.b.ChatAPIReady,S),this.handleAPIInitializationError())},t.prototype.onChatAPIReady=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return window.removeEventListener(m.b.ChatAPIReady,S),this.initializeChat(),[2]}))}))},t.prototype.initializeChat=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return this.registerSwcChatEvents(),[4,swc.create(m.c.Messaging,T.f,A()).then((function(){return swc.getPresence()})).then((function(t){return t.subscribeToMyStatus(e.myPresenceStatusUpdate),t.getStatusList()})).then((function(t){Object(a.hb)(t)&&(e.props.onUserPresenceStatusListUpdate(t),e.presenceStatusKey?(e.myPresenceStatusUpdate(e.presenceStatusKey),e.presenceStatusKey=void 0):Object(d.e)().tag("Presence_API_getStatusList_Invalid",6))})).catch((function(e){Object(d.e)().exception("Presence_API_getStatusList_Failed",6,e)})).then((function(){return Object(r.__awaiter)(e,void 0,void 0,(function(){var e=this;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return swc.getKeyboard?[4,swc.getKeyboard().then((function(t){t.onKeyDown((function(t){"Escape"===t.key&&e.props.isChatRecentsPaneOpen&&e.dismissChatRecentsPane()}))})).catch((function(e){Object(d.e)().exception("get_keyboard_API_Failed",6,e)}))]:[3,2];case 1:t.sent(),t.label=2;case 2:return Object(d.e)().impression("Chat_Button","Chat",0,void 0,"successful"),this.onChatAPIInitialized(!0),[2]}}))}))}))];case 1:return t.sent(),[2]}}))}))},t.prototype.registerSwcChatEvents=function(){this.props.disableToasts||(swc.API.registerEvent(m.b.ApiReceivedNotification,this.onNotificationReceived),swc.API.registerEvent(m.b.ApiHideNotification,this.props.onNotificationDismissed)),swc.API.registerEvent(m.b.ApiUnreadConversationUpdate,this.props.onUnreadConversationUpdate),swc.API.registerEvent(m.b.ApiStartChat,this.onStartChat),swc.API.registerEvent(m.b.ApiOnCallStart,(function(){Object(d.e)().impression("CallStart","Chat")})),swc.API.registerEvent(m.b.ApiOnRecentItemSelected,(function(){Object(d.e)().click("ChatRecentItem","Chat")})),swc.API.registerEvent(m.b.ApiRecentsShown,this.startChatLoadingTime),swc.API.registerEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.registerEvent(m.b.ApiSettingsChanged,this.onChatNotificationSettingsUpdated)},t.prototype.handleAPIInitializationError=function(e){Object(d.e)().exception("Chat_API_Initialization_Failed",6,e),t.chatLoading=!1,this.onChatAPIInitialized(!1),this.props.responsiveEnabled||R&&this.props.isConsumerShell&&(R.style.display="block")},t.prototype.getInitParams=function(){return{toLoadUnreadConversationsCount:!0,locale:this.props.locale,correlationId:this.props.correlationId,loginHint:this.props.upn}},t.prototype.onChatAPIInitialized=function(e){var n=this;if(this.props.onChatAPIInitialized(e),e&&!this.props.responsiveEnabled){var i=document.getElementById(p.a);i&&(Object(a.T)(i,a.e.CLICK+" "+a.e.KEYDOWN,u.b),Object(a.t)(i,a.e.CLICK+" "+a.e.KEYDOWN,this.onChatClickHandler),R.style.display="block")}var o=Object(d.b)();o.subscribe("ThemeChanged",(function(){var e=Object(d.g)().getThemeState().isDarkMode?"dark":Object(d.g)().getCurrentThemeId();n.props.isTeamsChatActivated||swc.setTheme(e)}),!0),o.subscribe("PresenceStatusChanged",this.onPresenceStatusChanged,!1),this.updateNotificationSettings(),this.showCurrentPresence(),t.chatLoading=!1},t.prototype.showCurrentPresence=function(){var e=this;!this.props.isTeamsChatActivated&&swc&&swc.getPresence().then((function(t){t.getMyStatus().then((function(t){t?e.myPresenceStatusUpdate(t):Object(d.e)().tag("Presence_API_getMyStatus_Undefined",6)})).catch((function(e){Object(d.e)().exception("Presence_API_getMyStatus_Failed",6,e)}))})).catch((function(e){Object(d.e)().exception("Presence_API_Initialization_Failed",6,e)}))},t.prototype.chatClicked=function(e){e.preventDefault(),Object(d.e)().click("ChatButton","NavBar",null,null,"Chat recents list open "+!this.props.isChatRecentsPaneOpen),this.props.onRecentsOpen(!this.props.isChatRecentsPaneOpen,p.a)},t.prototype.dismissChatRecentsPane=function(){this.props.onRecentsOpen(!1,p.a);var e=document.getElementById(p.a);e&&e.focus()},t.prototype.appendChatAPIDownloadScript=function(){var e=this;v=function(){e.onChatAPIDownloadScriptFailed()};var t=document.createElement("script");t.type="text/javascript",t.setAttribute("data-style","o365shell"),t.setAttribute("data-disable-autostart","true"),t.setAttribute("data-platform-id",this.props.workloadId),t.setAttribute("data-auth-type",this.props.isConsumerShell?"msa":"aad"),t.src=this.props.chatSDKUrl,t.onerror=v,document.head.appendChild(t)},t.prototype.appendTeamsChatDownloadScript=function(){var e=document.createElement("script");e.dataset.loginHint=this.props.upn;var t=null;window.URLSearchParams&&(t=new URLSearchParams(window.location.search)),e.src=t&&t.has("teams-embed-sdk-url")?t.get("teams-embed-sdk-url"):"https://teams.microsoft.com/embed-client/loader.js",document.body.appendChild(e)},t.prototype.onChatAPIDownloadScriptFailed=function(){Object(d.e)().exception("Chat API download script failed",6,null),this.props.onChatAPIInitialized(!1),this.props.responsiveEnabled||this.props.isConsumerShell&&(R.style.display="block")},t.prototype.startChatLoadingTime=function(){I=Date.now()},t.prototype.logChatLoadingTime=function(){I&&(Object(d.e)().timer("Chat_FirstTimeChatListShown",Date.now()-I),swc.API.unregisterEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.unregisterEvent(m.b.ApiRecentsShown,this.startChatLoadingTime))},t.prototype.updateNotificationSettings=function(){var e=this;Object(T.d)().then((function(t){e.updateChatSettings(t)})).catch((function(){})),Object(T.c)().then((function(t){e.updateCallSettings(t)})).catch((function(){}))},t.prototype.updateChatSettings=function(e){var t=Object(r.__assign)(Object(r.__assign)({},this.props.notificationPreferences),{EnableChat:e.Enabled,EnableChatSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t.prototype.updateCallSettings=function(e){var t=Object(r.__assign)(Object(r.__assign)({},this.props.notificationPreferences),{EnableCalling:e.Enabled,EnableCallingSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t.chatLoading=!1,t}(c.Component);n.d(t,"mapStateToProps",(function(){return D})),n.d(t,"ChatBaseControlConnector",(function(){return j}));var D=function(e){var t=e.shellInitDataState;return{disableToasts:t.renderSettings.disableToasts,locale:e.shellInitDataState.navBarData.CultureName,notificationsEnabled:e.shellInitDataState.clientData.NotificationsEnabled,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,correlationId:e.shellInitDataState.clientData.SHSID,responsiveEnabled:null!=e.shellInitDataState.layout,chatEnabled:e.chatState.chatEnabled,chatSDKUrl:e.chatState.webChatSDKUrl,isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isTeamsChatActivated:e.chatState.isTeamsChatActivated,chatNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableChat,callingNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableCalling,workloadId:t.clientData.WorkloadId,presenceStatus:e.meControlState.userPresenceStatus,userPresenceStatusItems:e.meControlState.userPresenceStatusItems,notificationPreferences:e.notificationState&&e.notificationState.notificationPreferencesData||null,upn:e.userState&&e.userState.upn}},j=Object(i.b)(D,(function(e){return{onChatAPIInitialized:function(t){e(Object(_.a)(t))},onRecentsOpen:function(t,n){e(Object(_.c)(t)),e(Object(a.eb)(n))},onNotificationDismissed:function(t){e(Object(s.e)(t))},onNotificationReceived:function(t){e(Object(s.a)(t))},onUnreadConversationUpdate:function(t){e(Object(_.e)(t))},userPresenceStatusUpdate:function(t){e(Object(o.h)(t))},onUserPresenceStatusListUpdate:function(t){e(Object(o.i)(t))},onNotificationPreferencesUpdated:function(t){e(Object(a.gb)(t))},onTeamsChatActivated:function(t){e(Object(_.d)(t))}}}))(P)}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_notifications_end"),shellPerformance.measure("shell_notifications","shell_notifications_start","shell_notifications_end"));
//# sourceMappingURL=https://oneshellprcorp.blob.core.windows.net/oneshellpr/20200719.1/notifications.map