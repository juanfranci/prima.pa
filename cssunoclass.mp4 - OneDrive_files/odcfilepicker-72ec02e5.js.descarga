define("odsp-next/pages/filePicker/odc/ConsumerFilePicker",["require","exports","./ConsumerFilePicker.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ConsumerFilePickerViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-consumer-file-picker",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/pages/filePicker/odc/ConsumerFilePicker.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko component:{name:filePickerTagName,params:filePickerParams}--\x3e\x3c!--ko host:{data:$host}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/pages/filePicker/odc/ConsumerFilePickerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../od/FilePicker","../od/FilePickerAgentHelper","../../../resources/DataSourceResourceKeys","../../../dataSources/itemPicker/odc/ItemPickerDataSource","../../../dataSources/itemPicker/odc/LeftNavDataSource","../../../bindings/host/HostBinding","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r.addBindingHandlers({host:f.default});var c,h=r.resources;h.exposeFactory(o.itemPicker,new l.AliasResourceFactory(u.resourceKey));h.exposeFactory(o.leftNav,new l.AliasResourceFactory(a.resourceKey));if(t.agent)c=t;else{var p=new(r.child(s.typeResourceKey));c={agent:p.getAgent(),behavior:p.getBehavior()}}r.filePickerTagName=i.default.tagName;r.filePickerParams=c;return r}return t})(r.default);t.default=c});
define("odsp-next/pages/filePicker/od/FilePicker",["require","exports","./FilePicker.html","./FilePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFilePicker_css","../../../controls/progressSpinnerFlat/ProgressSpinnerFlat","../../../controls/itemPicker/ItemPicker"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-filepicker",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/pages/filePicker/od/FilePicker.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FilePicker"><div class="od-FilePicker-picker" data-bind="component:{name:\'od-item-picker\',params:itemPickerParams},hideWhenInactive">\x3c!--ko if:isRetrievingData--\x3e<div class="od-FilePicker-loadingDiv" data-bind="component:{name:\'ms-progressSpinnerFlat\'}"></div>\x3c!--/ko--\x3e<div class="od-FilePicker-content" data-bind="scrollContainer"><div class="od-FilePicker-innerContent">\x3c!--ko host:{data:$host}--\x3e\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e</div></div></div>\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko if:shouldHostOverlays--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/pages/filePicker/od/FilePickerViewModel",["require","exports","tslib","../../baseInnerPage/od/DataManagerPageViewModel","../../../providers/dataManager/files/FilesDataManager","../../../providers/dataManager/photos/PhotosDataManager","./commandSets/FilePickerCommandSet","../../../dataSources/itemPicker/ItemPickerConstants","../../../dataSources/url/QueryType","../../../bindings/component/ControlBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/host/HostBinding","../../../controls/itemContent/photosRoot/PhotosRootItemContent.key","../../../controls/list/allphoto2/PhotosItemsScopeItemContent.key","../../../controls/itemContent/folder/FolderItemContent","../../../models/engagement/Engagement","../Engagement","../../../models/command/set/UnionCommandSet","./commandSets/FilePickerItemCommandProvider","../../../providers/itemCommand/ItemCommandProvider","../../../models/itemPicker/ItemPickerSelectionHelper","../../../bindings/aria/HideWhenInactiveBinding","../../../providers/dialog/DialogProvider","../../../providers/panel/PanelProvider","../../../controls/overlays/host/OverlayHost","../../../controls/dialogHost/DialogHost","../../../controls/panelHost/PanelHost","../../../actions/toggleListLayout/odc/ToggleListLayoutAction","../../../controls/list/layouts/LayoutType","../../../models/itemsScope/ItemsScopeFeature.key","../../../controls/FabricIconsDeferred"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r.overlayHostTagName=T.default.tagName;r.dialogHostTagName=N.default.tagName;r.panelHostTagName=C.default.tagName;r.addBindingHandlers({scrollContainer:l.default,host:c.default,hideWhenInactive:E.default});var i=r.resources;i.bind(x.resourceKey);i.bind(S.resourceKey);var s=t.behavior,u=t.commandSet,a=t.agent,f=t.shouldHostOverlays,h=void 0===f||f;r._behavior=s;var p=s.layoutType;r._photosItemsScopeItemProps=r.createPureComputed(r._computePhotosItemsScopeProps);r._useAllPhotosItemsScopePicker=i.consume(A.isItemsScopeEnabledInAllPhotosFilePickerResourceKey);i.expose(v.engagementSourceResourceKey,i.consume(v.engagementSourceResourceKey).withPart(m.filePickerEngagementPart,{behavior:s}));r.shouldHostOverlays=h;var d=new(i.consume(y.typeResourceKey))({behavior:s});i.expose(b.resourceKey,d);var w=new(r.managed(o.default))({behavior:s}),L=[];L.push(w);u&&L.push(u);r.itemPickerParams={behavior:s,agent:a,commandSet:new(r.managed(g.default))({commandSets:L})};w.navigateToPivot();if(p){var O=new(r.managed(k.default))({layoutType:p});O.isAvailable.peek()&&O.execute(void 0)}return r}t.prototype.computeCurrentPageName=function(){var e;switch(this.item.peek().displayType){case a.default.AllMyPhotos:e="Photos";break;default:e="Files"}return"FilePicker-"+e};t.prototype.computeContentControl=function(){var t=e.prototype.computeContentControl.call(this),n=this.item();if(t)return t;var r=this.urlDataSource.getKeyParams(n.key);if(this.urlDataSource.getQueryType(r)===a.default.AllMyPhotos&&this._useAllPhotosItemsScopePicker)return f.toSpecification(p.resourceKey,this._photosItemsScopeItemProps());var i=this.getContentControlParams();switch(n.displayType){case a.default.AllMyPhotos:return f.toSpecification(h.resourceKey,i);default:return f.toSpecification(d.resourceKey,i)}};t.prototype.computeCreateDataManager=function(){var e,t=this.viewParams();switch(this.urlDataSource.getQueryType(t)){case a.default.AllMyPhotos:e=this._createPhotosDataManager;break;default:e=this._createFilesDataManager}return e};t.prototype.getSelectionOptions=function(e){var t=e.behavior,n=t.selectionMode,r=t.maximumSelectedCount,i=e.behavior,s=new(this.child(w.typeResourceKey))({behavior:i});return{mode:u.SELECTION_MODE_MAPPING[n],maximumSelectedCount:r,canSelectItem:s.getCanSelectItem()}};t.prototype._createFilesDataManager=function(){return new(this.managed(i.default))({itemResultSetOptions:this._behavior.itemResultSetOptions})};t.prototype._createPhotosDataManager=function(){return new(this.managed(s.default))({itemResultSetOptions:this._behavior.itemResultSetOptions})};t.prototype._computePhotosItemsScopeProps=function(){var e=this;return{props:{layoutType:L.AllPhotos,isMobile:this.platform.isMobile,child:function(t){return e.child(t)},photoType:0,isInFilePicker:!0}}};return t})(r.default);t.default=O});
define("odsp-next/pages/filePicker/od/commandSets/FilePickerCommandSet",["require","exports","tslib","knockout","../../../../controls/commands/BaseCommandSet","../../../../resources/ControlResourceKeys","../../../../controls/commands/Command","../../../../controls/commands/Commands.resx","../../../../utilities/icons/Icon","../../../../controls/itemPicker/resources/ItemPickerResourceKeys","../../../../controls/operation/commands/OperationCommandBuilder","../../../files/od/SwitchLayoutCommandBuilder","../../../../providers/itemPicker/ItemPickerProvider","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(n){var i;void 0===n&&(n={});var d=e.call(this,n)||this;d._itemPickerProvider=d.resources.consume(h.resourceKey);d._viewParams=d.resources.consume(s.viewParams);d._selection=d.resources.consume(s.itemsSelection);d._isSelectionModeOn=d.createPureComputed(d._computeSelectionModeOn);var v=n.behavior,m=void 0===v?d.resources.consume(f.behavior):v;d._behavior=m;d._actionMap=d.resources.consume(s.actionMap);d._initializePivots(d._behavior);d._navigationAction=new(d.managed(d._actionMap.NavigationAction))({url:d.createPureComputed(d._computeInitialUrl),ignoreHistory:!0});var g=new(d.managed(l.default))({renderLabel:1}).command,y=m.showCommandBar,b=void 0===y||y;(i=d.commands).push.apply(i,d._pivots);b&&d.commands.push(new(d.managed(o.CommandViewModel))({location:0,action:new(d.managed(d._actionMap.OpenAction))({openRelation:3}),keys:["AltUp"]}),new(d.managed(o.CommandViewModel))({text:u.default.CreateFolderCommand,icon:new a.default("Folder"),action:new(d.managed(d._actionMap.CreateFolderAction)),automationId:"createFolder",isHidden:d._isSelectionModeOn,engagementName:"NewFolder"+t.sourceNameEngagement}),new(d.managed(o.CommandViewModel))({text:u.default.Upload,tooltip:u.default.UploadCommandTooltip,icon:new a.default("Upload"),requiredChildren:1,automationId:"upload",isHidden:d._isSelectionModeOn,engagementName:"Upload"+t.sourceNameEngagement,children:r.observableArray([new(d.managed(o.CommandViewModel))({text:u.default.UploadFile,collapsedText:d.createObservable(u.default.Upload),action:new(d.managed(d._actionMap.UploadAction))({uploadProcessorType:p.UploadProcessorType.Html5file}),automationId:"uploadFiles",engagementName:"UploadFiles"+t.sourceNameEngagement}),new(d.managed(o.CommandViewModel))({text:u.default.UploadFolder,action:new(d.managed(d._actionMap.UploadAction))({uploadProcessorType:p.UploadProcessorType.Folder}),automationId:"uploadFolder",engagementName:"UploadFolder"+t.sourceNameEngagement})])}),new(d.managed(o.CommandViewModel))({text:u.default.selectItems,renderLabel:2,icon:new a.default("CheckboxComposite"),action:new(d.managed(d._actionMap.ToggleSelectionModeAction))}),g,new(d.managed(c.default))({isSelectionMode:d._isSelectionModeOn}).command,new(d.managed(o.CommandViewModel))({location:0,action:new(d.managed(d._actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}));return d}t.prototype.navigateToPivot=function(){this._navigationAction.execute(null).done()};t.prototype._initializePivots=function(e){var t=this;this._pivots=[];if(!e.showNavigation){var n=this._itemPickerProvider.getPivots({behavior:e,viewParams:this._viewParams.peek()}).pivots;if(1===n.length)return;for(var r=function(e){return t.createPureComputed(function(){return e(t._viewParams())})},i=0;i<n.length;i++){var s=n[i],u=s.item,a=r(s.isActive),f=this.createObservable(u);this._pivots.push(new(this.managed(o.CommandViewModel))({text:u.displayName,isPermanent:!0,action:new(this.managed(this._actionMap.DefaultClickAction))({item:f,sourceEngagement:"FilePicker.Pivot.Click"}),isCurrentView:a,isLastPivot:i===n.length-1}))}}};t.prototype._computeInitialUrl=function(){var e=this._itemPickerProvider.getInitialViewParams({behavior:this._behavior,viewParams:this._viewParams.peek()}).viewParams;return"#"+d.serializeQuery(e)};t.prototype._computeSelectionModeOn=function(){return this._selection&&this._selection.selection().length>0};t.sourceNameEngagement=".InFilePickerCommandBar";return t})(i.default);t.default=v});
define("odsp-next/controls/itemPicker/resources/ItemPickerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.actionMap=new n.ResourceKey("actionMap");t.agent=new n.ResourceKey("agent");t.behavior=new n.ResourceKey("behavior");t.status=new n.ResourceKey("status")});
define("odsp-next/pages/files/od/SwitchLayoutCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/commands/Command","../FilesCommandSetHelper","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../controls/commands/Commands.resx","../../../utilities/features/Features","../../../controls/list/layouts/LayoutType","../../../utilities/icons/Icon","knockout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=l.isFeatureEnabled(l.CompactListViewInFiles),v=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this,i=r.resources.consume(u.actionMap);r._layoutType=r.resources.consume(a.files.layoutType);var l=t.isSelectionMode,v=void 0===l?r.createObservable(!1):l,m=t.location,g=void 0===m?4:m,y=t.allowAlbumView,b=void 0!==y&&y,w=t.clearContextualFilter,E=void 0!==w&&w;r._shouldClearContextualFilter=E;var S=new(r.managed(o.default))({showLabels:null});r._viewToggleIcon=r.createPureComputed(function(){return S.computeViewSelectorIcon()},{deferEvaluation:!0});r._viewSelectorAriaLabel=r.createPureComputed(r._computeViewSelectorAriaLabel);var x=n.__spreadArrays([new(r.managed(s.CommandViewModel))({text:f.default.ViewList,tooltip:f.default.ViewListCommandTooltip,icon:new h.default(o.default.detailsIcon),renderLabel:0,isToggleable:!0,isHidden:v,hasIconOnly:!0,action:new(r.managed(i.ToggleListLayoutAction))({layoutType:c.Details,clearContextualFilter:r._shouldClearContextualFilter}),automationId:"switchLayout",engagementName:"ViewList"})],d?[new(r.managed(s.CommandViewModel))({text:f.default.ViewCompactList,tooltip:f.default.ViewCompactListCommandTooltip,icon:new h.default(o.default.compactDetailsIcon),renderLabel:0,isToggleable:!0,isHidden:v,hasIconOnly:!0,action:new(r.managed(i.ToggleListLayoutAction))({layoutType:c.CompactDetails,clearContextualFilter:r._shouldClearContextualFilter}),engagementName:"ViewCompactList"})]:[],[new(r.managed(s.CommandViewModel))({text:f.default.ViewGrid,tooltip:f.default.ViewGridCommandTooltip,icon:new h.default(o.default.gridIcon),renderLabel:0,isToggleable:!0,isHidden:v,hasIconOnly:!0,action:new(r.managed(i.ToggleListLayoutAction))({layoutType:c.Grid,clearContextualFilter:r._shouldClearContextualFilter}),engagementName:"ViewGrid"})]);b&&x.push(new(r.managed(s.CommandViewModel))({text:f.default.ViewLargeGrid,renderLabel:0,icon:new h.default(o.default.singleAlbumIcon),isToggleable:!0,isHidden:v,hasIconOnly:!0,action:new(r.managed(i.ToggleListLayoutAction))({layoutType:c.SingleAlbum,clearContextualFilter:r._shouldClearContextualFilter}),engagementName:"ViewLargeGrid"}));var T=new(r.managed(s.CommandViewModel))({tooltip:f.default.ViewsCommandTooltip,accessibleLabel:r._viewSelectorAriaLabel,renderLabel:0,icon:r._viewToggleIcon,location:g,isHidden:v,hasIconOnly:!0,collapseSingleChildCommands:!0,requiredChildren:2,children:p.observableArray(x)});r.command=T;return r}t.prototype._computeViewSelectorAriaLabel=function(){var e,t=this._layoutType();e=t===c.SingleAlbum?f.default.ViewAlbumView:t===c.Grid||t===c.CustomGridList?f.default.ViewGrid:t===c.CompactDetails?f.default.ViewCompactList:f.default.ViewList;return i.format(f.default.ViewsCommandAriaLabel,e,"","")};return t})(r.default);t.default=v});
define("odsp-next/providers/itemPicker/ItemPickerProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemPickerDataSource=n.itemPickerDataSource;r._urlDataSource=n.urlDataSource;return r}t.prototype.getHandler=function(e){return this._itemPickerDataSource.getHandler(e)};t.prototype.getPivots=function(e){return this._itemPickerDataSource.getPivots(e)};t.prototype.getInitialViewParams=function(e){var t=e.behavior.typeFilter,r=void 0===t?{filters:[]}:t,i=e.viewParams;return{viewParams:n.__assign(n.__assign({},i),this._urlDataSource.saveItemTypeFilter(r))}};t.prototype.getItemFromPickerItem=function(e){var t={key:""};s.default(t,{itemId:e.id,graph:{itemId:e.id,driveId:o.optional(e.parentReference&&e.parentReference.driveId)},name:o.backup(e.name),extension:o.backup(e.extension),folder:o.optional(e.folder&&{})});s.default(t,this._itemPickerDataSource.getItemFromPickerItem(e));return t};t.prototype.getPickerItemFromItem=function(e,t){var n={id:e.itemId};s.default(n,{id:o.optional(e.graph&&e.graph.itemId),parentReference:o.optional(e.graph&&{driveId:e.graph.driveId}),folder:o.optional(e.folder&&{})});t.hostAuthenticationLevel>0&&s.default(n,{name:e.name,extension:e.extension});s.default(n,this._itemPickerDataSource.getPickerItemFromItem(e,t));return n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemPickerDataSource:i.itemPicker,urlDataSource:i.url});return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a)});
define("odsp-next/dataSources/itemPicker/ItemPickerConstants",["require","exports"],function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});t.MSA_CLIENT_ID_PARAM="msa_client_id";t.AAD_CLIENT_ID_PARAM="aad_client_id";t.RETURN_URL_PARAM="ru";t.VIEW_TYPE_PARAM="view_type";t.SELECTION_MODE_PARAM="selection_mode";t.LINK_TYPE_PARAM="link_type";t.ACCESS_LEVEL_PARAM="access";t.PROMPT_PARAM="prompt";t.PROMPT_SELECT_ACCUNT_VALUE="select_account";t.SELECTION_MODE_VALUES={"":0,multi:1,multiple:1,single:0};t.SELECTION_MODE_MAPPING=((n={})[1]=0,n[0]=1,n);t.VIEW_TYPE_VALUES={"":1,file:1,folder:2,all:0};t.LINK_TYPE_VALUES={"":1,weblink:1,downloadlink:2,webviewlink:0};t.ACCESS_LEVEL_VALUES={"":0,read:0,readwrite:1};t.SELECTION_MAX_ITEMS=10;t.ORIGIN_VALIDATION_TIMEOUT=1e3});
define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./PhotosRootItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/pages/filePicker/Engagement",["require","exports","tslib","../../models/engagement/Engagement"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filePickerEngagementPart=new r.EngagementPart("FilePicker",3,{getEngagementData:function(e){var t=e.behavior;return{scenario:"FilePicker",extraData:n.__assign({clientId:t.aadClientId||t.msaClientId,isFilePicker:1,pickerOrigin:""+(t.origin||""),pickerSdk:t.sdkVersion,pickerViewType:u(t.viewType),pickerLinkType:s(t.linkType),pickerAccessLevel:i(t.accessLevel),pickerSelectionMode:o(t.selectionMode)},t.qosData)}}});function i(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readWrite";break;default:case 0:t="readOnly"}return t}function s(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;case 4:t="all";break;case 3:t="share";break;default:case 1:t="web"}return t}function o(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:t="single"}return t}function u(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:t="all"}return t}});
define("odsp-next/pages/filePicker/od/commandSets/FilePickerItemCommandProvider",["require","exports","../../../../providers/itemCommand/ItemCommandProvider","../../../../models/item/command/CoreItemCommandKeys","../../../../models/item/command/FileSystemItemCommandKeys","../../../../models/item/command/WebItemCommandKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){this._behavior=e.behavior;this._itemCommandProvider=t.itemCommandProvider}e.prototype.getCommand=function(e,t){var n,o=this._behavior,u=o.viewType,a=o.commandMode;switch(t){case r.defaultClick:case i.createFolder:n="none"!==a;break;case i.open:n=!0;break;case s.upload:n=2!==u&&"none"!==a;break;default:n=!1}if(n)return this._itemCommandProvider.getCommand(e,t)};e.dependencies={itemCommandProvider:n.resourceKey};return e})();t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/models/itemPicker/ItemPickerSelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../item/ItemType","../item/ItemParentHelper","../item/IItemTypeFilter","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.behavior;r._behavior=i;r._itemParentHelper=n.itemParentHelper;return r}t.prototype.getCanSelectItem=function(){for(var e=this,t=this._behavior,n=t.viewType,r=t.typeFilter,s=void 0===r?{filters:[]}:r,a=t.allowRootItem,f=void 0===a||a,l=[],c=function(e){if("string"==typeof e)"."===e[0]&&l.push(function(t){return u.equalsCaseInsensitive(t.extension,e)});else switch(e){case o.ItemTypeFilter.folder:break;case o.ItemTypeFilter.photo:l.push(function(e){return!!e.photo&&!e.video});break;case o.ItemTypeFilter.video:l.push(function(e){return!!e.video});break;case o.ItemTypeFilter.media:l.push(function(e){return!!e.audio||!!e.photo||!!e.video});break;case o.ItemTypeFilter.document:l.push(function(e){return!!e.appMap});break;case o.ItemTypeFilter.audio:l.push(function(e){return!!e.audio})}},h=0,p=s.filters;h<p.length;h++){c(p[h])}var d=[];l.length&&d.push(function(e){return l.some(function(t){return t(e)})});switch(n){case 1:d.push(function(e){return e.type!==i.default.Folder});break;case 2:d.push(function(e){return e.type===i.default.Folder})}d.push(function(e){return!!e.itemId||!!e.isRootFolder});d.push(function(e){return!e.subsite});d.push(function(t){return!e.peekUnwrapObservable(e._itemParentHelper.getFacetedAncestorOrSelf(t,"mountPoint"))});return function(t){var n=e.peekUnwrapObservable(t);return!(n&&!f&&n.isRootFolder)&&(!n||d.every(function(e){return e(n)}))}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemParentHelper:s.resourceKey});return t})(r.default);t.default=f;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,f)});
define("odsp-next/controls/itemPicker/ItemPicker",["require","exports","./ItemPicker.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerViewModel","ODCFilePicker_css","../buttonBar/ButtonBar","../notificationHost/NotificationHost","./header/ItemPickerHeader"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-item-picker",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemPicker/ItemPicker.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ItemPicker" data-bind="css:{\'od-ItemPicker--hasBranding\':showBranding,\'od-ItemPicker--hasActions\':showActions,\'od-ItemPicker--hasCommandBar\':showCommandBar,\'od-ItemPicker--hasLeftPane\':showLeftPane,\'od-ItemPicker--leftPaneIsOpen\':showLeftPane()&&isLeftPaneOpen()},focusTrap:{isEnabled:isFocusTrapEnabled}">\x3c!--ko if:showSecureExperienceDialog--\x3e\x3c!--ko component:{name:dialogOverlayTagName,params:{commandSet:secureExperienceCommandSet}}--\x3e<p data-bind="text:secureExperienceWarningText"></p>\x3c!--ko if:secureExperienceErrorText--\x3e<p data-bind="text:secureExperienceErrorText,class:\'od-ItemPicker-secureExperienceStatus--\'+secureExperienceErrorStyle()"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showBranding--\x3e<div class="od-ItemPicker-branding" data-bind="component:{name:itemPickerHeaderTagName,params:itemPickerHeaderParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showContent--\x3e<div class="od-ItemPicker-picker" data-bind="control:pickerSpecification">\x3c!--ko if:showCommandBar--\x3e<div class="od-ItemPicker-topBar" data-bind="component:{name:topBarTagName,params:{}}">\x3c!--ko if:showLeftPaneExpander--\x3e<div class="od-ItemPicker-leftNavExpander od-TopBar-item od-TopBar-leftNavExpander" data-bind="component:{name:leftNavExpanderTagName}"></div>\x3c!--/ko--\x3e<div class="od-ItemPicker-commandBar od-TopBar-item od-TopBar-commandBar" data-bind="control:commandBarSpecification"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showLeftPane()--\x3e<div class="od-ItemPicker-leftPane" data-bind="control:leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if:!showLeftPane()&&isLeftPaneOpen()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:true,animation:{afterAdd:1,beforeRemove:500}}}--\x3e<div class="od-ItemPicker-leftPaneModal ms-ModalOverlay"></div>\x3c!--ko focusTrap:{}--\x3e<div class="od-ItemPicker-leftPaneOverlay" tabindex="-1" data-bind="dismiss:{isOpen:isLeftPaneOpen},recoverFocus:{isEnabled:$host.isOpen},preserveFocus:{},control:leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="od-ItemPicker-selector" data-bind="host:hostBindingOptions"></div>\x3c!--ko if:showActions--\x3e<div class="od-ItemPicker-actions" data-bind="component:{name:buttonBarTagName,params:buttonBarParams}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/itemPicker/ItemPickerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding","./commandSets/ItemPickerInlineCommandSet","./commandSets/ItemPickerSecureExperienceCommandSet","./actions/ItemPickerActionMap","./resources/ItemPickerResourceKeys","../../resources/ControlResourceKeys","../../resources/LoggingResourceKeys","./header/ItemPickerHeader","../commandBar/CommandBar.key","../itemsScope/CommandBar.key","../buttonBar/ButtonBar","../../models/command/set/UnionCommandSet","../commands/BaseCommandSet","./commandSets/ItemPickerTopCommandSet","../topBar/TopBar","../overlays/dialog2/DialogOverlay","./ItemPicker.resx","./commands/ItemPickerStatusHelper","../commands/CommandState","../leftPane/LeftPane","../leftNavExpander/LeftNavExpander","../../resources/PagesResourceKeys","../../bindings/component/ControlBinding","../../bindings/dismiss/DismissBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/RecoverFocusBinding","../../bindings/focus/PreserveFocusBinding","../overlays/Overlay","../../utilities/browser/ResponsiveUI","../../models/leftNav/SourceTypeFilter","../../dataSources/rootItems/RootItemsTypeFilter.key","../../dataSources/leftNav/RootSourceTypeFilter.key","@ms/telemetry-manager/lib/events/Qos.event","../../providers/engagement/Engagement","./itemsScope/ItemsPicker.key","./itemsScope/ItemsPickerPlaceholder","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/resources/Resources","../../actions/base/ItemSelectionHelper","./GetItemsPickerFilters","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var X=(function(t){n.__extends(r,t);function r(e,n){void 0===n&&(n={});var r=t.call(this,e)||this;r.itemPickerHeaderTagName=c.default.tagName;r.buttonBarTagName=d.default.tagName;r.topBarTagName=y.default.tagName;r.dialogOverlayTagName=b.default.tagName;r.leftNavExpanderTagName=T.default.tagName;r.overlayTagName=M.default.tagName;r.secureExperienceWarningText=w.default.secureExperienceWarningText;r.addBindingHandlers({host:i.default,control:C.default,dismiss:k.default,focusTrap:L.default,recoverFocus:A.default,preserveFocus:O.default});var h=e.behavior,p=void 0===h?{}:h,m=e.agent,S=e.commandSet,F=n.topCommandSetType,I=void 0===F?g.default:F,q=n.inlineCommandSetType,R=void 0===q?s.default:q,U=n.secureExperienceCommandSetType,z=void 0===U?o.default:U;r._useItemsScope=r.observables.wrap(e.useItemsScope);var W=p.showActions,X=void 0!==W&&W,V=p.showBranding,$=void 0!==V&&V,J=p.showNavigation,K=void 0!==J&&J,Q=p.enableFocusTrap,G=void 0!==Q&&Q,Y=r,Z=Y.resources,ee=Y.observables;r._isNavigationEnabled=K;Z.expose(a.actionMap,new(r.managed(u.default)));Z.expose(a.agent,m);r._status=Z.expose(a.status,ee.create({state:0}));Z.expose(a.behavior,p);Z.expose(P.resourceKey,p.typeFilter);Z.expose(H.resourceKey,D.mergeSourceTypeFilters(p.sourceTypes,D.getSourceTypeFilter(p.typeFilter)));r._responsiveUI=Z.consume(_.resourceKey);r._rumone=Z.consume(l.rumOneHelper.optional);r._statusHelper=Z.consume(E.resourceKey);r._itemsSelection=Z.consume(f.itemsSelection);ee.subscribe(r._itemsSelection.selection,r._onSelectionChanged);r._engagement=r.resources.consume(j.resourceKey);r.itemPickerHeaderParams={};r._itemSelectionHelperTypeKey=r._getItemSelectionHelperTypeKey();if(S||!X){var te=[];X||te.push(r._getCommandSet(I));S&&te.push(S);r.commandBarSpecification=r._getCommandBarSpecification(new(r.managed(v.default))({commandSets:te}))}if(X){var ne=r._getCommandSet(R);r.buttonBarParams={commandSet:ne}}r.showContent=ee.create(!1);r.showSecureExperienceDialog=ee.create(!1);r.secureExperienceErrorText=ee.pureCompute(r._computeSecureExperienceErrorText);r.secureExperienceErrorStyle=ee.pureCompute(r._computeSecureExperienceErrorStyle);r.showBranding=$;r.showActions=X;r.showCommandBar=!!S;r.isFocusTrapEnabled=ee.create(G);r.secureExperienceCommandSet=new(r.managed(z));r.hostBindingOptions={data:{status:r._status}};r.showLeftPane=ee.pureCompute(r._computeShowLeftPane);r.showLeftPaneExpander=ee.pureCompute(r._computeShowLeftPaneExpander);var re=r.isLeftPaneOpen=ee.create(!1);r.leftPaneSpecification=C.toSpecification(x.default,{isLeftNavVisible:ee.pureCompute(function(){return r.showLeftPane()||re()}),overrideResponsiveBehavior:!0});Z.expose(N.base.leftNav.isLeftNavUserExpanded,re);Z.expose(N.base.leftNav.toggleIsLeftNavUserExpanded,function(){re(!re.peek());return!1});r.pickerSpecification=r._getPickerSpecification({behavior:p});var ie=new B.Qos({name:"ItemPicker.initialize"});m.initialize().done(function(){ie.end({resultType:B.ResultTypeEnum.Success});r.showContent(!0)},function(e){ie.end({resultType:B.ResultTypeEnum.Failure,error:e&&e.message,extraData:{pickerOrigin:""+(p.origin||"")}});r._engagement.logData({name:"ItemPicker.SecureExperience.View",isIntentional:!1});r.showSecureExperienceDialog(!0)});return r}r.prototype._onSelectionChanged=function(){this._status({state:0})};r.prototype._computeSecureExperienceErrorText=function(){var e=this._statusHelper.commandStatus();return e&&e.text||""};r.prototype._computeSecureExperienceErrorStyle=function(){var e=this._statusHelper.commandStatus();return S.default[e&&e.state||S.default.initialized]};r.prototype._computeShowLeftPane=function(){var e=this._responsiveUI;return this._isNavigationEnabled&&e.compareSize(e.formFactorSize(),"Large")>0};r.prototype._computeShowLeftPaneExpander=function(){return this._isNavigationEnabled&&!this.showLeftPane()};r.prototype._getCommandBarSpecification=function(e){var t=this,n=C.toSpecification(h.resourceKey,{commandSet:e,isMobile:!1}),r={props:{handleRenderComplete:function(e,n){var r=t._rumone;r&&r.logRUMOneForDeferredControl("TopLevelCommandBar",e);n.unblockItemPageRender()}},useDOMContext:!0},i=C.toSpecification(p.resourceKey,r);return this.observables.pureCompute(function(){return t._useItemsScope()?i:n})};r.prototype._getPickerSpecification=function(e){var t=e.behavior,n={props:{selectionMode:0===t.selectionMode?"single":"multiple",itemMode:2===t.viewType?"folders":1===t.viewType?"files":"all",filters:z.getItemsPickerFilters(t),commandMode:t.commandMode},rootProps:{className:"od-ItemPicker-picker"}},r=C.toSpecification(F.resourceKey,n),i=C.toSpecification(I.knockoutResourceKey,n);return this.observables.pureCompute(function(){return W.isFeatureEnabled(W.UseItemsScopeInPicker)?r:i})};r.prototype._getCommandSet=function(e){var t,n=this;return this.observables.pureCompute(function(){var r=n._useItemsScope(),i=r&&n._itemSelectionHelperTypeKey();return n.observables.ignore(function(){t&&t.dispose();t=n.scope.attach(new q.default);var s;if(r){if(!i)return t.attach(new(n.resources.injected(m.default)));(s=t.attach(new R.ResourceScope(n.resources))).exposeFactory(U.typeResourceKey,new R.AliasResourceFactory(i))}else s=n.resources;return t.attach(new(s.injected(e)))})})};r.prototype._getItemSelectionHelperTypeKey=function(){var t=this.observables.create(),n=!1;return this.observables.pureCompute(function(){if(!n){n=!0;new Promise(function(t,n){e(["../../actions/base/itemsScope/ItemSelectionHelper"],t,n)}).then(function(e){t(e.typeResourceKey)})}return t()})};return r})(r.default);t.default=X});
define("odsp-next/controls/itemPicker/commandSets/ItemPickerInlineCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../resources/ItemPickerResourceKeys","../commands/ItemPickerStatusCommandBuilder","../ItemPicker.resx","../../loadingSpinner/LoadingSpinner.resx"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(s.behavior),f=n.resources.consume(s.actionMap),l=n.resources.consume(s.status),c=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif"),h=r.completeText,p=void 0===h?2===r.viewType&&1===r.accessLevel?u.default.completeReadWriteFoldersActionText:u.default.completeReadFilesActionText:h,d=r.cancelText,v=void 0===d?u.default.cancelActionText:d;n.commands.push(new(n.managed(o.default))({location:12}).command,new(n.managed(i.CommandViewModel))({location:12,iconUrl:c,isDisabled:n.createObservable(!0),isHidden:n.createPureComputed(function(){return 1!==l().state}),text:a.default.LoadingText,renderLabel:0}),new(n.managed(i.CommandViewModel))({text:p,action:new(n.managed(f.ItemPickerCompleteAction)),isPermanent:!0}),new(n.managed(i.CommandViewModel))({text:v,action:new(n.managed(f.ItemPickerCancelAction)),isPermanent:!0}));return n}return t})(r.default);t.default=f});
define("odsp-next/controls/itemPicker/commands/ItemPickerStatusCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../commands/Command","../../commands/CommandState","./ItemPickerStatusHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(o.resourceKey);n._commandStatus=r.commandStatus;n._label=n.createPureComputed(n._computeLabel);n.command=new(n.managed(i.CommandViewModel))({isDisabled:n.createObservable(!0),text:n._label,location:t.location,isHidden:n.createPureComputed(function(){return!n._label()}),state:n.createPureComputed(n._computeState)});return n}t.prototype._computeLabel=function(){var e=this._commandStatus();return e&&e.text};t.prototype._computeState=function(){var e=this._commandStatus();return e&&e.state||s.default.initialized};return t})(r.default);t.default=u});
define("odsp-next/controls/itemPicker/commands/ItemPickerStatusHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../resources/ItemPickerResourceKeys","../../../resources/ControlResourceKeys","../../commands/CommandState","@ms/odsp-utilities/lib/string/StringHelper","../ItemPicker.resx","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemPickerStatus=n.itemPickerStatus;r._behavior=n.behavior;r._itemsSelection=n.itemsSelection;r._error=r.createObservable();r._application=r.createObservable();r.commandStatus=r.createPureComputed(r._computeCommandStatus);r.commandStatus.equalityComparer=l.deepCompare;var i=n.agent;i&&r.trackPromise(i.getApplication()).done(function(e){r._application(e)},function(e){r._error(e)});return r}t.prototype._computeCommandStatus=function(){var e,t=this._itemPickerStatus(),n=this._behavior.viewType,r=this._itemsSelection.maximumSelectedCount,i=this._itemsSelection.selectedCount();1===t.state||(e=t.error?{text:u.pluralSelect(i,2===n?a.default.shareSingleFolderErrorText:a.default.shareSingleFileErrorText,2===n?a.default.shareMultipleFolderErrorText:a.default.shareMultipleFileErrorText),state:o.default.failed}:r&&i>=r?{text:u.format(2===n?a.default.selectionMaxFoldersErrorFormat:a.default.selectionMaxFilesErrorFormat,r),state:o.default.failed}:this._computeConsentCommandStatus());return e};t.prototype._computeConsentCommandStatus=function(){var e,t=this._application();if(t){var n=this._behavior,r=n.viewType,i=n.linkType,s=n.selectionMode,f=n.accessLevel;e={text:u.format(2===r&&1===f?a.default.saveSingleConsentFormat:2!==i&&0===f?0===s?a.default.shareSingleConsentFormat:a.default.shareMultipleConsentFormat:0===s?a.default.openSingleConsentFormat:a.default.openMultipleConsentFormat,t.name)}}else this._error()&&(e={text:a.default.unknownApplicationErrorText,state:o.default.failed});return e};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{behavior:i.behavior,agent:i.agent,itemsSelection:s.itemsSelection,itemPickerStatus:i.status});return t})(r.default);t.ItemPickerStatusHelper=c;t.resourceKey=f.createResolvedResourceKey(e("module").id,c);t.default=c});
define("odsp-next/controls/itemPicker/commandSets/ItemPickerSecureExperienceCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/CommandViewModel","../resources/ItemPickerResourceKeys","../ItemPicker.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(s.actionMap);n.commands.push(new(n.managed(i.default))({text:o.default.secureExperienceActionText,action:new(n.managed(r.ItemPickerSecureExperienceAction)),isPermanent:!0}),new(n.managed(i.default))({text:o.default.cancelActionText,action:new(n.managed(r.ItemPickerCancelAction)),isPermanent:!0}));return n}return t})(r.default);t.default=u});
define("odsp-next/controls/itemPicker/actions/ItemPickerActionMap",["require","exports","./ItemPickerCompleteAction","./ItemPickerCancelAction","./ItemPickerSwitchAccountAction","./secureExperience/ItemPickerSecureExperienceAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){this.ItemPickerCompleteAction=n.default;this.ItemPickerCancelAction=r.default;this.ItemPickerSwitchAccountAction=i.default;this.ItemPickerSecureExperienceAction=s.default};t.default=o});
define("odsp-next/controls/itemPicker/actions/ItemPickerCompleteAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../resources/ItemPickerResourceKeys","../../../actions/base/ItemSelectionHelper","../../../models/itemPicker/ItemPickerSelectionHelper","../../../resources/ProviderResourceKeys","../../../utilities/features/Features","@ms/odsp-utilities/lib/icons/IconSelector","../../../models/engagement/Engagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=new h.EngagementPart("ItemPickerCompleteAction",2),d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ItemPicker.Complete";var i=r.resources.consume(o.behavior);r._itemPickerAgent=r.resources.consume(o.agent);r._itemPickerStatus=r.resources.consume(o.status);r._mruRecentProvider=r.resources.consumeAsync(f.mruRecent.optional);r._canSelectItem=new(r.child(a.typeResourceKey))({behavior:i}).getCanSelectItem();var s=i.viewType,l=void 0===s?0:s,c=i.selectionMode,h=void 0===c?0:c,p=n.itemSelectionHelperType,d=void 0===p?r.resources.consume(u.typeResourceKey):p;r._itemSelectionHelper=new(r.scope.attached(d))({overrideItem:t.item,canFallback:1!==l,allowMultiSelect:1===h});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection()[0],t=this.unwrapObservable(e),n=this._itemPickerStatus().state;return!!this._itemPickerAgent&&!!t&&this._canSelectItem(e)&&(0===n||2===n)};t.prototype.recordRecentlyUsedForSelection=function(e){var t=this;return new s.default(function(n){var r=!1;if(e.length>0&&e[0].extension){var i=c.getIconNameFromExtension(e[0].extension);if(("photo"===i||"video"===i)&&l.isFeatureEnabled(l.WriteMruSignalWhenMediaPicked)){r=!0;t._mruRecentProvider.then(function(r){if(r){var i=r.recordDocumentView(e[0]),o=new s.default(function(e){var n=t.async.setTimeout(function(){t.async.clearTimeout(n);e()},300)});s.default.race([i,o]).then(function(){n()},function(e){n()})}else n()})}}r||n()})};t.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemSelectionHelper.resolveSelection().then(function(e){return s.default.all([t.recordRecentlyUsedForSelection(e),t._itemPickerAgent.complete(e)])}).then(function(){t._itemPickerStatus({state:3});return{resultType:i.ResultTypeEnum.Success}},function(e){e[0];var n=e[1];t._itemPickerStatus({state:2,error:n});return{resultType:i.ResultTypeEnum.ExpectedFailure}})};t.prototype.getEngagement=function(){var t;return e.prototype.getEngagement.call(this).withPart(p,{extraData:{selectedCount:this._itemSelectionHelper.selection().length,extension:null===(t=this.unwrapObservable(this._itemSelectionHelper.firstItem))||void 0===t?void 0:t.extension}})};return t})(r.default);t.default=d});
define("odsp-next/controls/itemPicker/actions/ItemPickerCancelAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../resources/ItemPickerResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ItemPicker.Cancel";n._itemPickerAgent=n.resources.consume(o.agent);n._itemPickerStatus=n.resources.consume(o.status);return n}t.prototype.onIsAvailable=function(){return!!this._itemPickerAgent};t.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemPickerAgent.cancel().then(function(){t._itemPickerStatus({state:4});return{resultType:i.ResultTypeEnum.Success}},function(e){t._itemPickerStatus({state:2,error:e});return s.default.wrapError(e)})};return t})(r.default);t.default=u});
define("odsp-next/controls/itemPicker/actions/ItemPickerSwitchAccountAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../resources/ItemPickerResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ItemPicker.SwitchAccount";n._behavior=n.resources.consume(o.behavior);n._agent=n.resources.consume(o.agent);return n}t.prototype.onExecute=function(e){return this._agent.switchAccount().then(function(){return s.default.wrap({resultType:i.ResultTypeEnum.Success})})};t.prototype.onIsAvailable=function(){var e=this._behavior.showSwitchAccount;return void 0!==e&&e};return t})(r.default);t.default=u});
define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../actions/base/ControlExecutorAction","./ItemPickerSecureExperienceExecutor"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createObservable({isAvailable:!0});return n}return t})(r.default);t.ItemPickerSecureExperienceHandler=o;var u=i.create({name:"ItemPickerSecureExperience",source:{component:s.default}});t.default=u});
define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutor",["require","exports","./ItemPickerSecureExperienceExecutor.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerSecureExperienceExecutorViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-item-picker-secure-experience-executor",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko if:showFilePicker--\x3e\x3c!--ko component:{name:filePickerRemoteHostTagName,params:filePickerRemoteHostParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/itemPicker/actions/secureExperience/ItemPickerSecureExperienceExecutorViewModel",["require","exports","tslib","../../../../actions/base/ControlExecutorViewModel","../../../filePickerRemoteHost/FilePickerRemoteHost","../../resources/ItemPickerResourceKeys","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.filePickerRemoteHostTagName=i.default.tagName;n._agent=n.resources.consume(s.agent);n._behavior=n.resources.consume(s.behavior);n._status=n.resources.consume(s.status);n.showFilePicker=n.createObservable(!0);n.filePickerRemoteHostParams={agent:{initialize:function(){return n._agent.initialize()},complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()},switchAccount:function(){return n._switchAccount()},getApplication:function(){return n._agent.getApplication()}},behavior:n._behavior};return n}t.prototype._complete=function(e){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.complete(e).then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return o.default.wrapError(e)})};t.prototype._cancel=function(){var e=this;this._status({state:1});this.showFilePicker(!1);return this._agent.cancel().then(function(){e._status({state:4});e.action.cancel()},function(t){e._status({state:2,error:t});return o.default.wrapError(t)})};t.prototype._switchAccount=function(){var e=this;this._status({state:1});this.showFilePicker(!1);return this._agent.switchAccount().then(function(){e._status({state:3});e.action.complete()},function(t){e._status({state:2,error:t});return o.default.wrapError(t)})};return t})(r.default);t.default=u});
define("odsp-next/actions/base/ControlExecutorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.action;n.action=r;return n}t.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})};t.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){t.action.fail(e);return i.default.wrapError(e)})};return t})(r.default);t.default=s});
define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHost",["require","exports","./FilePickerRemoteHost.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePickerRemoteHostViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-file-picker-remote-host",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHost.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko childWindow:childWindowOptions--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/filePickerRemoteHost/FilePickerRemoteHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/window/ChildWindowBinding","../../dataSources/itemPicker/Sdk71","@ms/odsp-utilities/lib/async/Promise","../../providers/itemPicker/ItemPickerProvider","@ms/odsp-utilities/lib/guid/Guid","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/uri/SimpleUri","../../models/item/ItemType","../../dataSources/url/PageType","../../dataSources/itemPicker/Sdk71PickerUrlHelper","../../dataSources/itemPicker/Sdk72PickerUrlHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/math/Rectangle"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t,r){var s,o,b,w;void 0===t&&(t={});void 0===r&&(r={});var E=e.call(this,t,r)||this;E.addBindingHandlers({childWindow:i.default});E._itemPickerProvider=E.resources.consume(u.resourceKey);var S=E.resources.consume(f.url);E._messenger=E.createObservable();E._pickerId=a.default.generate();var x=t.itemKey,T=t.agent,N=r.window,C=void 0===N?window:N;E._agent=T;var k={};l.default(k,t.behavior||{});l.default(k,{id:E._pickerId,showBranding:!0,showActions:!0,returnUrl:c.remove(),origin:new h.default(C.location.href).authority,state:c.remove()});var L,A,O=S.getDefaultClickUrl({key:x||S.getRootItemKey(),type:p.default.Folder},{page:d.default.FilePicker,viewParams:{}}),M=S.qualifyUrl("#"+g.serializeQuery(n.__assign(n.__assign({},g.deserializeQuery(O.substring(1))),"7.2"===k.sdkVersion?m.saveItemPickerBehavior(k):v.saveItemPickerBehavior(k)))),_=C.screen,D=void 0===_?{availLeft:0,availTop:0,left:0,top:0,width:window.innerWidth,height:window.innerHeight}:_;L=void 0===(o=D.availLeft)?L=void 0===(s=D.left)?0:s:o,A=void 0===(w=D.availTop)?A=void 0===(b=D.top)?0:b:w;var P=Math.min(800,D.width-20),H=Math.min(600,D.height-20),B=(D.width-P)/2+L,j=(D.height-H)/2+A;E.childWindowOptions={url:M,position:new y.default(B,j,P,H),messenger:E._messenger,onMessage:function(e){return E._onMessage(e)},onCancel:function(){return E._agent.cancel().done()}};return E}t.prototype._onMessage=function(e){var t=this._messenger.peek();if(0===e.indexOf(s.MESSAGE_FROM_PICKER_PREFIX)){var n=JSON.parse(e.substring(s.MESSAGE_FROM_PICKER_PREFIX.length)),r=n.conversationId,i=n.pickerId;if(i!==this._pickerId)return;var u=void 0;switch(n.type){case"success":u=this._onSuccess(n);break;case"cancel":u=this._onCancel(n);break;case"switch":u=this._onSwitch(n);break;case"initialize":u=o.default.wrap({pickerId:i,conversationId:r,type:"activate"})}o.default.as(u).done(function(e){e&&t.postMessage(""+s.MESSAGE_TO_PICKER_PREFIX+JSON.stringify(e))})}};t.prototype._onSuccess=function(e){var t=this,n=e.items.map(function(e){return t._itemPickerProvider.getItemFromPickerItem(e)});return w(this._agent.complete(n),e)};t.prototype._onCancel=function(e){return w(this._agent.cancel(),e)};t.prototype._onSwitch=function(e){return w(this._agent.switchAccount(),e)};return t})(r.default);t.default=b;function w(e,t){return e.then(function(){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"acknowledge"}},function(e){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"error",error:{message:e.message}}})}});
define("odsp-next/bindings/window/ChildWindowBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,s=r.valueAccessor(),o=s.url,u=s.position,a=s.messenger,f=s.onMessage,l=s.onCancel;r._onMessage=f;r._onCancel=l;var c=n.window,h=void 0===c?window:c;r._window=h;var p=new i.default(o);r._targetOrigin=p.authority;f&&r.events.on(r._window,"message",r._onMessageReceived);var d=["scrollbars=yes"];u&&d.push("left="+u.x,"top="+u.y,"width="+u.width,"height="+u.height);r._childWindow=r._window.open(o,"_blank",d.join(", "));r.async.setInterval(r._checkWindow,100);r.addDisposable({dispose:function(){r._childWindow&&!r._childWindow.closed&&r._childWindow.close()}});a&&a(r._createMessenger());return r}t.prototype._checkWindow=function(){this._childWindow&&!this._childWindow.closed||this._onCancel&&this._onCancel()};t.prototype._onMessageReceived=function(e){if(e.source===this._childWindow&&e.origin===this._targetOrigin){var t=""+(e.data||"");this._onMessage&&this._onMessage(t)}};t.prototype._createMessenger=function(){var e=this;return{postMessage:function(t){e._childWindow.postMessage(t,e._targetOrigin)}}};t.supportsVirtualElements=!0;return t})(r.default);t.default=s});
define("odsp-next/dataSources/itemPicker/Sdk71",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MESSAGE_FROM_PICKER_PREFIX="[OneDrive-FromPicker]";t.MESSAGE_TO_PICKER_PREFIX="[OneDrive-ToPicker]";t.PICKER_PARAM_KEY="picker"});
define("odsp-next/dataSources/itemPicker/Sdk71PickerUrlHelper",["require","exports","tslib","./Sdk70PickerUrlHelper","./ItemTypeFilterHelper","./Sdk71","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","../../controls/list/layouts/LayoutType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!0};t.getItemPickerBehavior=function(e){return n.__assign(n.__assign({},f(l(e))),c(e))};function f(e){void 0===e&&(e={});var t=e.id,s=e.aid,o=e.a,u=e.v,f=e.s,l=e.l,c=e.f,h=e.o,p=e.sa,d=void 0===p||p,v=e.ss,m=void 0===v||v,g=e.tf,y=void 0!==g&&g,b=e.cbt,w=e.fbt,E=e.cm,S=e.qos,x=e.sn,T=void 0===x||x,N=!(function(){try{return!!parent.document}catch(e){return!1}})()||T,C=r.getViewType(u);return n.__assign(n.__assign({id:t,showActions:d,showBranding:N,showSwitchAccount:m,enableFocusTrap:y,aadClientId:s,accessLevel:r.getAccessLevel(o),viewType:C,selectionMode:r.getSelectionMode(f),linkType:r.getLinkType(l),origin:h,typeFilter:i.getItemTypeFilter({typeFilter:r.getTypeFilter(c),viewType:C}),completeText:b,cancelText:w},(function(e){if(e){var t=void 0;switch(e){case"d":t=a.Details;break;case"cd":t=a.CompactDetails;break;case"t":t=a.Grid}if(t)return{layoutType:t}}})(e.lt)||{}),{sdkVersion:"7.1",commandMode:E,qosData:S})}t.getItemPickerBehaviorFromOptions=f;function l(e){var t,n=e[s.PICKER_PARAM_KEY]||"";try{t=JSON.parse(n)}catch(e){t={}}return t}t.getItemPickerOptions=l;function c(e){return{state:e.state,accessToken:e.access_token}}t.getStateAndAccessToken=c;t.saveItemPickerBehavior=function(e){var t=p(e);return n.__assign(n.__assign({},d(e)),h(t))};function h(e){var t;return(t={})[s.PICKER_PARAM_KEY]=JSON.stringify(e),t}t.saveItemPickerOptions=h;function p(e){var t=e.showActions,n=e.showBranding,i=e.showSwitchAccount,s=e.aadClientId,a=e.accessLevel,f=e.viewType,l=e.selectionMode,c=e.linkType,h=e.typeFilter,p=e.origin,d=e.id,m=e.commandMode,g=e.qosData,y={};o.default(y,{sa:u.optional(t),sn:u.optional(n),ss:u.optional(i),aid:u.optional(s),id:u.optional(d),o:u.optional(p),a:u.optional(r.saveAccessLevel(a)),s:u.optional(r.saveSelectionMode(l)),v:u.optional(r.saveViewType(f)),f:u.optional(r.saveTypeFilter(h)),l:u.optional(r.saveLinkType(c)),lt:u.optional(v(e.layoutType)),cm:u.optional("safe-write"!==m?m:void 0),qos:u.optional(g)});return y}t.saveItemPickerBehaviorToOptions=p;function d(e){var t=e.msaClientId,n=e.state,r=e.accessToken,i={};n&&(i.state=n);t&&(i.client_id=t);r&&(i.access_token=r);return i}t.saveStateAndAccessToken=d;function v(e){if(e)switch(e){case a.Details:return"d";case a.CompactDetails:return"cd";case a.Grid:return"t"}}});
define("odsp-next/dataSources/itemPicker/Sdk70PickerUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/WindowStateManager","../../models/item/IItemTypeFilter","./ItemTypeFilterHelper","../../utilities/uri/UriValidator","./Sdk70FilterHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTypeFilter=o.getTypeFilter;t.WINDOW_STATE_PICKER_KEY="picker";t.WINDOW_STATE_OPTIONS_KEY="options";t.isApplicable=function(e){return!!(new n.default).getState(t.WINDOW_STATE_PICKER_KEY)};t.getItemPickerBehavior=function(e){var r=new n.default,c=r.getState(t.WINDOW_STATE_PICKER_KEY)||{},h=r.getState(t.WINDOW_STATE_OPTIONS_KEY)||{},p=c.accessLevel,d=c.viewType,v=c.linkType,m=c.selectionMode,g=c.filter,y=h.clientId,b=h.advanced.redirectUri,w=!!y&&!!b,E=l(d);return{showActions:!0,showBranding:!0,accessLevel:u(p),viewType:E,linkType:f(v),selectionMode:a(m),typeFilter:i.getItemTypeFilter({typeFilter:o.getTypeFilter(g),viewType:E}),aadClientId:y,returnUrl:s.getSafeAbsoluteWebUrl(b),showSwitchAccount:w,sdkVersion:"7.0"}};function u(e){void 0===e&&(e="");var t;switch(e){case"readwrite":t=1;break;default:case"read":t=0}return t}t.getAccessLevel=u;t.saveAccessLevel=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readwrite";break;default:case 0:}return t};function a(e){void 0===e&&(e="");var t;switch(e){case"multiple":t=1;break;default:case"single":t=0}return t}t.getSelectionMode=a;t.saveSelectionMode=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:}return t};function f(e){void 0===e&&(e="");var t;switch(e){case"download":t=2;break;case"webView":t=0;break;case"share":t=3;break;case"all":t=4;break;default:case"web":t=1}return t}t.getLinkType=f;t.saveLinkType=function(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;default:case 1:}return t};function l(e){void 0===e&&(e="");var t;switch(e){case"files":t=1;break;case"folders":t=2;break;default:t=0}return t}t.getViewType=l;t.saveViewType=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:}return t};t.saveTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t,n=[],i=0,s=e.filters;i<s.length;i++){var o=s[i];if("string"==typeof o)n.push(o);else{var u=void 0;switch(o){case r.ItemTypeFilter.folder:u="folder";break;case r.ItemTypeFilter.photo:u="photo"}u&&n.push(u)}}n.length>1?t=n:n.length&&(t=n[0]);return t}});
define("@ms/odsp-shared/lib/utilities/navigation/WindowStateManager",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VALUE_KEY="value";var n=(function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t;window.name=JSON.stringify(n)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];delete t[e];window.name=JSON.stringify(t);return n};e.prototype._getNormalizedWindowName=function(){var e,n;try{n=JSON.parse(name)||{}}catch(e){n={}}"object"!=typeof n&&(n=((e={})[t.VALUE_KEY]=n,e));return n};return e})();t.default=n});
define("odsp-next/dataSources/itemPicker/ItemTypeFilterHelper",["require","exports","tslib","../../models/item/IItemTypeFilter","../../utilities/array/ArrayHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemTypeFilter=function(e){var t=e.viewType,s=void 0===t?0:t,o=e.typeFilter,u=(void 0===o?{filters:[]}:o).filters;2===s&&(u=n.__spreadArrays(u,[r.ItemTypeFilter.folder]));return{filters:i.removeDuplicates(u)}}});
define("odsp-next/utilities/uri/UriValidator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["HTTP:","HTTPS:"];t.getSafeAbsoluteWebUrl=function(e){void 0===e&&(e="");var t=e.toUpperCase();return n.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0}});
define("odsp-next/dataSources/itemPicker/Sdk70FilterHelper",["require","exports","../../models/item/IItemTypeFilter"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTypeFilter=function(e){void 0===e&&(e="");var t;if(e){for(var r=[],i=0,s="string"==typeof e?e.split(","):e;i<s.length;i++){var o=s[i];if("."===o.charAt(0)){var u=o.toLowerCase();r.indexOf(u)<0&&r.push(u)}else{var a=void 0;switch(o){case"folder":a=n.ItemTypeFilter.folder;break;case"photo":a=n.ItemTypeFilter.photo;break;case"video":a=n.ItemTypeFilter.video}a&&r.push(a)}}r.length&&r.push(n.ItemTypeFilter.folder);t={filters:r}}return t}});
define("odsp-next/dataSources/itemPicker/Sdk72PickerUrlHelper",["require","exports","tslib","./Sdk71PickerUrlHelper","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={ONEDRIVE:"oneDrive",SITES:"sites",RECENT:"recent",SHARED:"shared",PHOTOS:"photos",BUSINESS:"business",CONSUMER:"consumer"};t.isApplicable=function(e){var t=r.getItemPickerOptions(e);return!!t&&"7.2"===t.sdk};t.getItemPickerBehavior=function(e){return n.__assign(n.__assign({},u(r.getItemPickerOptions(e))),r.getStateAndAccessToken(e))};t.saveItemPickerBehavior=function(e){var t=a(e);return n.__assign(n.__assign({},r.saveStateAndAccessToken(e)),r.saveItemPickerOptions(t))};function u(e){var t=e.ln,i=void 0===t||t;return n.__assign(n.__assign(n.__assign({},r.getItemPickerBehaviorFromOptions(e)),(function(e){var t="string"==typeof e?e.split(","):e;if(t){for(var n={},r=0,i=t;r<i.length;r++){var s=(""+i[r]).trim().toUpperCase(),u=o[s];u&&(n[u]=!0)}return{sourceTypes:n}}})(e.st)||{}),{showNavigation:i,showBranding:!1,sdkVersion:"7.2"})}t.getItemPickerBehaviorFromOptions=u;function a(e){var t=n.__assign(n.__assign({},r.saveItemPickerBehaviorToOptions(e)),{sdk:"7.2"});i.default(t,{ln:s.optional(e.showNavigation),st:s.optional(f(e.sourceTypes)),sn:!1});return t}t.saveItemPickerBehaviorToOptions=a;function f(e){if(e){var t=[];for(var n in e)e[n]&&t.push(n);return 1===t.length?t[0]:t}}});
define("odsp-next/controls/itemPicker/header/ItemPickerHeader",["require","exports","./ItemPickerHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemPickerHeaderViewModel","../../contextualMenu/ContextualMenu","ODCFilePicker_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-item-picker-header",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemPicker/header/ItemPickerHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ItemPickerHeader"><div class="od-ItemPickerHeader-application" data-bind="css:{\'od-ItemPickerHeader-application--hasLogo\':isLogoLoaded}"><span class="od-ItemPickerHeader-applicationLogo"><img data-bind="imageLoader:{src:applicationLogoUrl,isLoaded:isLogoLoaded}"></span><span class="od-ItemPickerHeader-applicationTitle" data-bind="text:applicationText"></span></div><div class="od-ItemPickerHeader-account" data-bind="dismiss:{isOpen:accountCommand.isOpen}"><span class="od-ItemPickerHeader-accountDropdown" data-bind="css:{\'od-ItemPickerHeader-accountDropdown--isOpen\':accountCommand.isOpen,\'od-ItemPickerHeader-accountDropdown--isEnabled\':!accountCommand.isDisabled()},click:accountCommand.onClick.bind(accountCommand)"><span class="od-ItemPickerHeader-accountDropdownLabel" data-bind="text:accountCommand.label"></span>\x3c!--ko ifnot:accountCommand.isDisabled--\x3e<i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e</span>\x3c!--ko if:accountCommand.isOpen--\x3e<div class="od-ItemPickerHeader-accountMenu" data-bind="component:{name:\'ms-contextual-menu\',params:accountMenuParams}"></div>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/itemPicker/header/ItemPickerHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/dismiss/DismissBinding","../../../bindings/imageLoader/ImageLoaderBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","@ms/odsp-utilities/lib/locale/Locale","../resources/ItemPickerResourceKeys","../../../resources/DataSourceResourceKeys","../ItemPicker.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.applicationText=c.default.applicationName;n.addBindingHandlers({dismiss:i.default,imageLoader:s.default});n._identityDataSource=n.resources.consume(l.identity);var r=n.resources.consume(f.actionMap),h=n._identityDataSource.getIdentity();n.accountCommand=new(n.managed(o.default))({text:h.email?h.email:h.loginName,engagementName:"SwitchAccountMenu",requiredChildren:1,collapseSingleChildCommands:!1,isPermanent:!0});n.accountCommand.children.push(new(n.managed(o.default))({text:c.default.switchAccountActionText,action:new(n.managed(r.ItemPickerSwitchAccountAction))}));n.accountMenuParams={items:n.accountCommand.children,isOpen:n.accountCommand.isOpen,alignment:n.createObservable(a.default.isRightToLeft?u.default.Left:u.default.Right),left:n.createObservable(a.default.isRightToLeft?"0":"100%"),hasExplicitAlignment:!0};n.applicationLogoUrl=window.require.toUrl("odsp-media/images/filepicker/onedrivelogolight.png");n.isLogoLoaded=n.createObservable(!1);return n}return t})(r.default);t.default=h});
define("odsp-next/controls/itemPicker/commandSets/ItemPickerTopCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../ItemPicker.resx","../resources/ItemPickerResourceKeys","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources.consume(o.behavior),a=r.completeText,f=void 0===a?2===r.viewType&&1===r.accessLevel?s.default.completeReadWriteFoldersActionText:s.default.completeReadFilesActionText:a,l=r.cancelText,c=void 0===l?s.default.cancelActionText:l,h=n.resources.consume(o.actionMap);n.commands.push(new(n.managed(i.CommandViewModel))({text:f,action:new(n.managed(h.ItemPickerCompleteAction)),icon:new u.default("CheckMark"),renderLabel:2}),new(n.managed(i.CommandViewModel))({text:c,action:new(n.managed(h.ItemPickerCancelAction)),icon:new u.default("Cancel"),location:12,renderLabel:0}));return n}return t})(r.default);t.default=a});
define("odsp-next/controls/overlays/dialog2/DialogOverlay",["require","exports","./DialogOverlay.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DialogOverlayViewModel","ODCFilePicker_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-dialog-overlay-2",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/overlays/dialog2/DialogOverlay.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:overlayTagName,params:{animation:{beforeRemove:500},alignToParent:false}}--\x3e<div class="od-Dialog" data-bind="css:{\'od-Dialog--close\':showCloseButton},focusTrap:{}"><div class="ms-ModalOverlay od-DialogOverlay"></div><div class="od-Dialog-main od-Dialog-main--dialog od-Dialog-main--visible" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},scrollContainer,dismiss:{close:$component.onDismiss.bind($component)},class:\'od-Dialog-main--\'+$component.widthClass(),attr:{\'aria-label\':title},element:$component.contentElement">\x3c!--ko if:showTitle--\x3e<div class="od-Dialog-header od-Dialog-header--s"><div class="od-Dialog-title" data-bind="text:title"></div></div>\x3c!--/ko--\x3e<div class="od-Dialog-inner"><div class="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:showActions--\x3e<div class="od-Dialog-actions"><div class="od-Dialog-actionsRight" data-bind="component:{name:buttonBarTagName,params:buttonBarParams}"></div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:$component.onClose.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/overlays/dialog2/DialogOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../Overlay","../../../bindings/dismiss/DismissBinding","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/element/ElementBinding","../../../utilities/browser/ResponsiveUI","../../panelHost/PanelHost.resx","../../buttonBar/ButtonBar"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=i.default.tagName;n.buttonBarTagName=v.default.tagName;n.closeLabel=d.default.closePanelLabel;n.addBindingHandlers({dismiss:s.default,element:h.default,host:o.default,interactionScope:u.default,focusTrap:c.default,recoverFocus:l.default,preserveFocus:f.default,scrollContainer:a.default});var r=t.size,p=void 0===r?"Small":r,m=t.title,g=void 0===m?"":m,y=t.onClose,b=t.showCloseButton,w=void 0===b||b,E=t.commandSet;n._size=p;n._onClose=y;n.contentElement=n.createObservable();n.title=n.wrapObservable(g);n.showCloseButton=n.createObservable(!!n._onClose&&w);n.showTitle=n.createPureComputed(n._computeShowTitle);n.widthClass=n.createPureComputed(n._computeWidthClass);n.showActions=n.createObservable(!!E);n.buttonBarParams={commandSet:E};return n}t.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype._computeWidthClass=function(){return p.default.determineCssClass(this._size)};t.prototype._computeShowTitle=function(){return!!this.title()};return t})(r.default);t.default=m});
define("odsp-next/models/leftNav/SourceTypeFilter",["require","exports","../item/IItemTypeFilter","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../utilities/features/Features"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSourceTypeFilter=function(e){void 0===e&&(e={filters:[]});var t=e.filters;if(t.length){for(var o={},u=s.isFeatureEnabled(s.EnableRecentForMediaTypeFilters),a=0,f=t;a<f.length;a++){var l=f[a];if("string"==typeof l){var c=r.getIconNameFromExtension(l);if(i.OfficeIconFileTypeMap[c]){o.recent=!0;o.shared=!0}else switch(c){case"photo":case"video":o.photos=!0;o.shared=!0;u&&(o.recent=!0)}}else switch(l){case n.ItemTypeFilter.media:case n.ItemTypeFilter.photo:case n.ItemTypeFilter.video:o.photos=!0;o.shared=!0;u&&(o.recent=!0);break;case n.ItemTypeFilter.audio:o.shared=!0;break;default:case n.ItemTypeFilter.folder:o.oneDrive=!0;o.sites=!0;o.shared=!0;o.business=!0;o.consumer=!0}}return o}};t.mergeSourceTypeFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){if(!t)return e;if(!e)return t;var n={};for(var r in t)e[r]&&t[r]&&(n[r]=!0);return n},void 0)}});
define("odsp-next/dataSources/leftNav/RootSourceTypeFilter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/controls/itemPicker/itemsScope/ItemsPicker.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsPicker"],t,n)}).then(function(e){return e.knockoutResourceKey.local})})})});
define("odsp-next/controls/itemPicker/itemsScope/ItemsPickerPlaceholder",["require","exports","tslib","react","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../../bindings/component/ReactControlBinding"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(r.Fragment,null,this.props.children)};t.contextTypes=n.__assign({},i.RESOLVED_COMPONENT_CONTEXT_TYPES);return t})(r.PureComponent);t.ItemsPickerPlaceholder=o;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,o,{});t.knockoutResourceKey=s.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker-placeholder",name:e("module").id+".knockout"})});
define("odsp-next/controls/itemPicker/GetItemsPickerFilters",["require","exports","@ms/items-view/lib/private/models/itemSets/filters/itemTypeFilterHandler","@ms/items-view/lib/private/models/itemSets/filters/itemExtensionFilterHandler","../../models/item/IItemTypeFilter"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemsPickerFilters=function(e){var t=e.typeFilter;if(t){for(var s=[],o=t.filters,u=0,a=void 0===o?[]:o;u<a.length;u++){var f=a[u];if("string"==typeof f)s.push(r.getItemExtensionFilterHandler(f));else switch(f){case i.ItemTypeFilter.folder:s.push(n.itemFolderTypeFilterHandler);break;case i.ItemTypeFilter.photo:s.push(n.itemPhotoTypeFilterHandler);break;case i.ItemTypeFilter.video:s.push(n.itemVideoTypeFilterHandler)}}return s}}});
define("odsp-next/controls/notificationHost/NotificationHost",["require","exports","./NotificationHostViewModel","../../bindings/component/ControlBinding","./NotificationHost.html","ODCFilePicker_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-notification-host",name:e("module").id,template:i.default,viewModelType:n.default})});
define("odsp-next/controls/notificationHost/NotificationHostViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","@ms/odsp-shared/lib/base/ViewModel","./NotificationHost.resx","../../bindings/dismiss/DismissBinding","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({dismiss:o.default});r.closeText=s.default.Close;r.notification=n.notificationProvider.currentNotification;r.severityClass=r.createComputed(r._computeSeverityClass);r.iconClass=r.createComputed(r._computeIconClass);return r}t.prototype.dismiss=function(){var e=this.notification.peek();if(e&&e.canImplicitDismiss){e.dismiss();return!1}return!0};t.prototype.close=function(){var e=this.notification.peek();if(e&&e.showCloseButton){e.complete();return!1}return!0};t.prototype.onButtonClick=function(e,t){if(e&&e.action){e.action.execute(t);e.dismiss()}};t.prototype._computeSeverityClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:return"od-MessageBar--info";case 5:return"od-MessageBar--remove";case 4:return"od-MessageBar--error";case 3:return"od-MessageBar--severeWarning";case 2:return"od-MessageBar--warning";case 0:return"od-MessageBar--success"}};t.prototype._computeIconClass=function(){var e=this.notification();switch(e?e.severity:1){default:case 1:case 2:return r.getIconClassName("Info");case 5:return r.getIconClassName("Blocked2");case 4:return r.getIconClassName("ErrorBadge");case 3:return r.getIconClassName("Warning");case 0:return r.getIconClassName("Success")}};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{notificationProvider:u.notification,notificationManager:u.notificationManager});return t})(i.default);t.default=a});
define("odsp-next/controls/notificationHost/NotificationHost.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="NotificationHost">\x3c!--ko with:notification--\x3e<div class="od-Notification" role="alert" data-bind="css:{\'od-Notification--canClose\':showCloseButton},dismiss:{isAutomatic:!!timeout,timeout:timeout,isOpen:isOpen,close:$component.dismiss.bind($component)}"><div class="od-Notification-content"><div class="od-MessageBar" data-bind="class:$component.severityClass"><div class="od-MessageBar-content"><div class="od-MessageBar-icon"><i class="ms-Icon" data-bind="class:$component.iconClass"></i></div><div class="od-MessageBar-text"><span data-bind="text:text"></span>\x3c!--ko if:action--\x3e<a class="od-Notification-link od-Link" href="javascript:;" data-bind="text:actionText,click:$component.onButtonClick.bind($component)"></a>\x3c!--/ko--\x3e</div></div></div></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Notification-close" data-bind="attr:{\'aria-label\':$parent.closeText,title:$parent.closeText},click:$component.close.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/pages/filePicker/od/FilePickerAgentHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ControlResourceKeys","../../../providers/itemPicker/ItemPickerProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._applicationDataSource=n.applicationDataSource;var i=n.itemPickerProvider,s=n.viewParams.peek(),o=i.getHandler({viewParams:s}).handlerTypeKey,u=new(r.child(o))({viewParams:s,getApplication:function(){return r._getApplication()}});r._behavior=u.getBehavior();r._agent={initialize:function(){return u.initialize()},getApplication:function(){return r._getApplication()},complete:function(e){return u.complete(e)},cancel:function(){return u.cancel()},switchAccount:function(){return u.switchAccount()}};return r}t.prototype.getAgent=function(){return this._agent};t.prototype.getBehavior=function(){return this._behavior};t.prototype._getApplication=function(){var e,t=this._behavior.msaClientId;e=this._applicationDataSource&&t?this._applicationDataSource.getApplicationDetails({clientId:t}):u.default.wrap();this._getApplication=function(){return e};return e};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{applicationDataSource:o.application.optional,viewParams:i.viewParams,itemPickerProvider:s.resourceKey});return t})(r.default);t.default=f;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,f)});
define("odsp-next/dataSources/itemPicker/odc/ItemPickerDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk50Handler","./Sdk60Handler","./Sdk70Handler","./Sdk71Handler","../Sdk72Handler","../../../models/item/OneDriveItem","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../controls/leftPane/LeftPane.resx","./Sdk50PickerUrlHelper","./Sdk60PickerUrlHelper","./Sdk70PickerUrlHelper","../Sdk72PickerUrlHelper","../../../models/item/IItemTypeFilter","../../../models/store/ItemsStore","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._itemsStore=n.itemsStore;return r}t.prototype.getHandler=function(e){var t=e.viewParams;return{handlerTypeKey:p.isApplicable(t)?i.typeResourceKey:v.isApplicable(t)?o.typeResourceKey:d.isApplicable(t)?s.typeResourceKey:m.isApplicable(t)?a.typeResourceKey:u.typeResourceKey}};t.prototype.getPivots=function(e){var t=e.behavior,n=this._createFilesRootItem(t),r=this._createPhotosRootItem(t),i=[];n&&i.push({item:n,isActive:this._isCurrentViewFiles});r&&i.push({item:r,isActive:this._isCurrentViewPhotos});return{pivots:i}};t.prototype.getItemFromPickerItem=function(e){var t;return{key:this._urlDataSource.getKey(((t={}).id=e.id,t)),id:e.root?"root":e.id}};t.prototype.getPickerItemFromItem=function(e){return{root:b.optional("root"===e.id?{}:void 0),endpoint:this._urlDataSource.getApiBaseUrl()}};t.prototype._isCurrentViewFiles=function(e){return!e.qt};t.prototype._isCurrentViewPhotos=function(e){return"allmyphotos"===e.qt};t.prototype._createFilesRootItem=function(e){var t=e.typeFilter,n=void 0===t?{filters:[]}:t,r=new f.default(this._urlDataSource.getKey(this._urlDataSource.saveItemTypeFilter(n)));r.name=h.default.Files;r.displayName=h.default.Files;r.properties.commandsSupported={defc:"1"};r.type=l.default.Folder;var i=this._itemsStore.getItem(r.key);i&&!i.peek().isPlaceholder||this._itemsStore.setItem(r);return r};t.prototype._createPhotosRootItem=function(e){for(var t,n,r=e.typeFilter,i=void 0===r?{filters:[]}:r,s=0===i.filters.length,o=0,u=i.filters;o<u.length;o++){var a=u[o];if(s)break;if("string"==typeof a);else switch(a){case g.ItemTypeFilter.media:case g.ItemTypeFilter.file:case g.ItemTypeFilter.photo:case g.ItemTypeFilter.video:s=!0}}if(s){(n=new f.default(this._urlDataSource.getKey(((t={}).qt="allmyphotos",t)))).name=h.default.Photos;n.displayName=h.default.Photos;n.properties.commandsSupported={defc:"1"};n.type=l.default.Folder;var c=this._itemsStore.getItem(n.key);c&&!c.peek().isPlaceholder||this._itemsStore.setItem(n)}return n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:c.url,itemsStore:y.resourceKey});return t})(r.default);t.default=E;t.resourceKey=w.createResolvedResourceKey(e("module").id,E)});
define("odsp-next/dataSources/itemPicker/odc/Sdk50Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../url/odc/UrlDataSource","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/uri/Uri","../../base/odc/Config","./Sdk50PickerUrlHelper","../../base/odc/DataRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../SecureExperienceHelper","../OriginValidator","@ms/odsp-utilities/lib/resources/Resources","../ItemPickerConstants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this,i=t.viewParams;r._liveSdkScriptSource=i.livesdk;r._urlType=i.auth===l.Files.skyDrivePickerOAuth?2:1;var s=n.getSkyDrivePicker,o=void 0===s?b:s,u=n.DataRequest,a=void 0===u?h.default:u;r._getSkyDrivePicker=o;var f=r._behavior=c.getBehavior(i);r._validateSignal=r._getValidateSignal();var p=r.scope;r._dataRequest=new(p.attached(a));r._secureExperienceHelper=new(p.attached(n.secureExperienceHelperType))({behavior:f});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._loadSkyDrivePicker().then(function(){e.async.setTimeout(function(){e._validateSignal.complete({authenticationLevel:0,reason:"timeout"})},g.ORIGIN_VALIDATION_TIMEOUT);return e._validateSignal.getPromise()}).then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){var t=this,n=i.default.all(e.map(function(e){return t._getSkyApiItem(e)}));return this._loadSkyDrivePicker().then(function(e){return n.then(function(t){e.onSuccess(t)})})};t.prototype.cancel=function(){return this._loadSkyDrivePicker().then(function(e){e.onFailure(void 0)})};t.prototype.switchAccount=function(){return i.default.wrap()};t.prototype._loadSkyDrivePicker=function(){var e=this.trackPromise(this._getSkyDrivePicker(this._liveSdkScriptSource).then(function(e){return new i.default(function(t,n){e.init({subscribe:function(e,n){t({onSuccess:e,onFailure:n})}})})}));this._loadSkyDrivePicker=function(){return e};return e};t.prototype._getSkyApiItem=function(e){var t={caller:o.default.viewerId,m:l.Config.mkt,rset:"skyweb_picker",v:""+Math.random(),d:"1",iabch:"1",pi:"5",path:1,lct:1,id:e.id,urlType:this._urlType},n=o.default.skyApiBaseUrl+"GetItems?"+p.serializeQuery(t),r={"X-SkyApiOriginId":""+Math.random()};return this._dataRequest.send({apiName:"GetItems",url:n,headers:r}).then(function(e){return(e.items||[e.item])[0]})};t.prototype._getValidateSignal=function(){var e=this,t=this._behavior.origin,n=new s.default;v.isApprovedDomain(t)?this.events.on(window,"message",function(r){var i=""+(r.data||"");if(r.source===window.parent&&r.origin===t&&0===i.indexOf("<file_dialog>")){n.complete({authenticationLevel:2,reason:"origin"});e.events.off(window,"message")}}):n.complete({authenticationLevel:0,reason:"origin"});return n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{secureExperienceHelperType:d.typeResourceKey});return t})(r.default);t.default=y;function b(e){var t,n=l.Config.isINT,r=void 0!==n&&n?"js.live-int.net":"js.live.net";if((new f.default(e).getHost()||"").toUpperCase()!==r.toUpperCase())throw new Error("Cannot continue with the picker because the SDK is not from a trusted domain");var s=e.lastIndexOf(".js");s===e.length-3&&(e=e.substring(0,s));u.default.addPaths(((t={}).livesdk=e,t));return a.loadModule({path:"livesdk",getModule:function(){return new i.default(function(e,t){window.require(["livesdk"],e,t)})}}).then(function(){return WL&&WL.skydrivePicker})}t.typeResourceKey=m.createResolvedTypeResourceKey(e("module").id,y)});
define("odsp-next/dataSources/itemPicker/odc/Sdk50PickerUrlHelper",["require","exports","./FolderPickerUrlHelper","../ItemTypeFilterHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!!e.livesdk};t.getBehavior=function(e){var t=n.getFolderPickerOverrides(e),s=t.viewType,o=t.accessLevel,u=e.domain,a={showActions:!0,showBranding:!0,showSwitchAccount:!1,viewType:s,selectionMode:i(e.select),accessLevel:o,typeFilter:r.getItemTypeFilter({viewType:s}),sdkVersion:"5.0"};u&&(a.origin="https://"+u);return a};function i(e){var t;switch(e){case"multi":t=1;break;default:case"single":t=0}return t}});
define("odsp-next/dataSources/itemPicker/odc/FolderPickerUrlHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFolderPickerOverrides=function(e){var t,n;switch(e.v){case"1":case"FolderPickerView":t=2;n=1}return{viewType:t,accessLevel:n}}});
define("odsp-next/dataSources/itemPicker/SecureExperienceHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/telemetry-manager/lib/events/Qos.event"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.currentWindow,s=void 0===i?window:i;r._currentWindow=s;return r}t.prototype.validateExperience=function(e){void 0===e&&(e={authenticationLevel:0,reason:"unknown"});var t=new o.Qos({name:"ItemPickerSecureExperienceHelper.validateExperience"}),n=this._currentWindow;if(n.self===n.top){t.end({resultType:o.ResultTypeEnum.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"self"}});return i.default.wrap()}var r=n.parent;if(r)try{if(r.location.href){t.end({resultType:o.ResultTypeEnum.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:"sameDomain"}});return i.default.wrap()}}catch(e){}if(e.authenticationLevel>0){t.end({resultType:o.ResultTypeEnum.Success,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}});return i.default.wrap()}t.end({resultType:"origin"===e.reason?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure,extraData:{pickerHostIdentityLevel:e.authenticationLevel,pickerHostIdentityReason:e.reason}});return this._createInsecureError()};t.prototype._createInsecureError=function(){return i.default.wrapError(new Error("The picker is not being loaded in a secure context."))};t.dependencies=n.__assign({},r.default.dependencies);return t})(r.default);t.default=u;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/dataSources/itemPicker/OriginValidator",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["DOCS.COM","ONEDRIVE.COM","LIVE.COM","LIVE-INT.COM","OFFICE.COM","LIVE-TST.COM","OFFICEAPPS.LIVE.COM","GOV.ONLINE.OFFICE365.US","DOD.ONLINE.OFFICE365.US","OFFICEAPPS-DF.LIVE.COM","ONLINE.OFFICE.DE","PARTNER.OFFICEWEBAPPS.CN"];t.isApprovedDomain=function(e){for(var t=new n.default(e).domain.toUpperCase(),r=0,s=i;r<s.length;r++){var o=s[r],u="."+o;if(o===t||t.indexOf(u,t.length-u.length)>-1)return!0}return!1};t.validateOrigin=function(e){if(!e)throw new Error("No specified origin");var t=new r.default(e),n=t.getScheme();if(!n||!/http(s)?/.test(n))throw new Error("Invalid origin scheme");var i=t.getHost();if(!i||i.indexOf("*")>-1)throw new Error("Invalid origin host")}});
define("odsp-next/dataSources/itemPicker/odc/Sdk60Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk60PickerUrlHelper","../Sdk60AccountChooserUrlHelper","./OAuthConsentHelper","../AccountChooserQueryStringHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,o=t.viewParams,u=t.getApplication,a=r._behavior=i.getItemPickerBehavior(o),f=r.scope;r._oAuthConsentHelper=new(f.attached(n.oAuthConsentHelperType))({behavior:a,returnUrl:i.getOAuthReturnUrl(o),getApplication:u});r._accountChooserQueryStringHelper=new(f.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:s.getAccountChooserUrl(a)});r._secureExperienceHelper=new(f.attached(n.secureExperienceHelperType))({behavior:a});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{oAuthConsentHelperType:o.typeResourceKey,accountChooserQueryStringHelperType:u.typeResourceKey,secureExperienceHelperType:a.typeResourceKey});return t})(r.default);t.default=l;t.typeResourceKey=f.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/dataSources/itemPicker/odc/Sdk60PickerUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/WindowStateManager","./ItemPickerConstants","@ms/odsp-utilities/lib/uri/Uri","../ItemTypeFilterHelper","../../../utilities/uri/UriValidator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!!e.scope};t.getItemPickerBehavior=function(e){var t=((new n.default).getState(r.WINDOW_STATE_KEY)||{}).aad_client_id,f=e.scope,l=u(e),c=(function(e){void 0===e&&(e="");var t,n,r,i,s=e.split(":")[1],o=(void 0===s?"":s).split("|"),u=o[0],a=void 0===u?"":u,f=o[1],l=void 0===f?"":f,c=o[2],h=void 0===c?"":c;switch(a.toUpperCase()){case"READWRITEFOLDER":t=1;i=2;break;case"READWRITEFILE":t=1;i=1;break;case"READFOLDER":t=0;i=2;break;default:case"READFILE":t=0;i=1}switch(l.toUpperCase()){case"MULTI":case"MULTIPLE":n=1;break;default:case"SINGLE":n=0}switch(h.toUpperCase()){case"DOWNLOADLINK":r=2;break;case"WEBVIEWLINK":r=0;break;default:case"WEBLINK":r=1}return{accessLevel:t,viewType:i,selectionMode:n,linkType:r}})(f),h=c.accessLevel,p=c.viewType,d=c.selectionMode,v=c.linkType,m=a(e),g=(function(e){void 0===e&&(e="");var t=new i.default(e).getQueryParameter("redirect_uri");return t&&o.getSafeAbsoluteWebUrl(t)})(l);return{showActions:!0,showBranding:!0,showSwitchAccount:!(!g||!m&&!t),accessLevel:h,viewType:p,selectionMode:d,linkType:v,returnUrl:g,aadClientId:t,msaClientId:m,typeFilter:s.getItemTypeFilter({viewType:p}),sdkVersion:"6.0"}};function u(e){return o.getSafeAbsoluteWebUrl(e.ru)}t.getOAuthReturnUrl=u;function a(e){var t=e.client_id;return(void 0===t?"":t).split(",")[0]}t.getMsaClientId=a;t.getState=function(e){return new i.default(e.ru||"").getQueryParameter("state")}});
define("odsp-next/dataSources/itemPicker/odc/ItemPickerConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WINDOW_STATE_KEY="odcpicker";t.HIDE_HEADER_PARAM="hideHeader";t.HIDE_FOOTER_PARAM="hideFooter";t.NO_MAX_ITEMS_PARAM="noMaxItems";t.SELECTION_OVERRIDE_PARAM="selection";t.SELECTION_OVERRIDE_PARAM_SHORT="select";t.API_SCENARIO="skyweb_picker";t.SELECTION_MAX_ITEMS=100;t.MAX_ITEMS_MAPPINGS={"":t.SELECTION_MAX_ITEMS,true:void 0}});
define("odsp-next/dataSources/itemPicker/Sdk60AccountChooserUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./ItemPickerConstants"],function(e,t,n,r){"use strict";var i,s,o,u;Object.defineProperty(t,"__esModule",{value:!0});t.ACCOUNT_CHOOSER_BASE_URL="https://onedrive.live.com/picker/accountchooser";var a=((i={})[1]="file",i[2]="folder",i),f=((s={})[0]="webViewLink",s[1]="webLink",s[2]="downloadLink",s),l=((o={})[1]="multi",o[0]="single",o),c=((u={})[1]="readwrite",u[0]="read",u);t.getAccountChooserUrl=function(e){var i,s;if(e.msaClientId||e.aadClientId){var o=((i={})[r.MSA_CLIENT_ID_PARAM]=e.msaClientId,i[r.AAD_CLIENT_ID_PARAM]=e.aadClientId,i[r.RETURN_URL_PARAM]=e.returnUrl,i[r.VIEW_TYPE_PARAM]=a[e.viewType],i[r.SELECTION_MODE_PARAM]=l[e.selectionMode],i[r.LINK_TYPE_PARAM]=f[e.linkType],i[r.ACCESS_LEVEL_PARAM]=c[e.accessLevel],i[r.PROMPT_PARAM]=r.PROMPT_SELECT_ACCUNT_VALUE,i);s=t.ACCOUNT_CHOOSER_BASE_URL+"?"+n.serializeQuery(o,null,!0)}return s}});
define("odsp-next/dataSources/itemPicker/odc/OAuthConsentHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../providers/sharing/SharingProvider","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=t.behavior,o=t.returnUrl,u=t.getApplication,a=void 0===u?function(){return i.default.wrap()}:u;r._behavior=s;r._returnUrl=o;r._sharingProvider=n.sharingProvider;r._navigation=n.navigation;r._onGetApplication=a;return r}t.prototype.complete=function(e){var t=this,n=this._behavior,r=n.accessLevel,s=n.linkType,u=this._returnUrl;if(!u)return i.default.wrapError(new Error("No return URL specified to handle completion."));var a=1!==r&&2!==s,f=1===r?2:1;return this.trackPromise(this._onGetApplication().then(function(n){if(!n)return i.default.wrapError({code:1});if(a){var r={role:f,type:4,name:n.name,create:!0,person:n};return t._sharingProvider.manageSharingLinks(e,r).then(function(e){return{userId:e[0].id,itemId:e[0].item.id}})}return t._sharingProvider.share([n],{items:e,roleValue:String(f)}).then(function(e){return{userId:e.people[0].sharingInfo.userId,itemId:e.itemId}})}).then(function(e){var n=[e.itemId];1!==r&&2!==s&&n.push(e.userId);var i={res:"success",resuictx:{uriValue:"selection_"+n.join("!")}};t._navigation.navigateTo({url:u+"&"+o.serializeQuery(i)})}))};t.prototype.cancel=function(){var e=this._returnUrl;if(!e)return i.default.wrapError(new Error("No return URL specified to handle cancellation."));this._navigation.navigateTo({url:e+"&"+o.serializeQuery({res:"cancel"})});return i.default.wrap()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{sharingProvider:s.resourceKey,navigation:u.navigation});return t})(r.default);t.default=f;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,f)});
define("odsp-next/dataSources/itemPicker/AccountChooserQueryStringHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.accountChooserUrl;r._accountChooserUrl=i;r._navigation=n.navigation;return r}t.prototype.switchAccount=function(){var e=this._accountChooserUrl;this._navigation.navigateTo({url:e});return s.default.wrap()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{navigation:i.navigation});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/dataSources/itemPicker/odc/Sdk70Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk70PickerUrlHelper","./Sdk60PickerUrlHelper","../Sdk70AccountChooserUrlHelper","./OAuthConsentHelper","../AccountChooserQueryStringHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,u=t.viewParams,a=r.scope,f=r._behavior=i.getItemPickerBehavior(u);r._oAuthConsentHelper=new(a.attached(n.oAuthConsentHelperType))({behavior:f,returnUrl:s.getOAuthReturnUrl(u),getApplication:t.getApplication});r._accountChooserQueryStringHelper=new(a.attached(n.accountChooserQueryStringHelperType))({accountChooserUrl:o.getAccountChooserUrl(f)});r._secureExperienceHelper=new(a.attached(n.secureExperienceHelperType))({behavior:f});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};t.prototype.complete=function(e){return this._oAuthConsentHelper.complete(e)};t.prototype.cancel=function(){return this._oAuthConsentHelper.cancel()};t.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{oAuthConsentHelperType:u.typeResourceKey,accountChooserQueryStringHelperType:a.typeResourceKey,secureExperienceHelperType:f.typeResourceKey});return t})(r.default);t.default=c;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/dataSources/itemPicker/odc/Sdk70PickerUrlHelper",["require","exports","./Sdk60PickerUrlHelper","../Sdk70PickerUrlHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return n.isApplicable(e)&&r.isApplicable(e)};t.getItemPickerBehavior=function(e){var t=r.getItemPickerBehavior(e);t.msaClientId=n.getMsaClientId(e);return t}});
define("odsp-next/dataSources/itemPicker/Sdk70AccountChooserUrlHelper",["require","exports","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/guid/Guid"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOGIN_BASE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize";t.getAccountChooserUrl=function(e){var i=e.aadClientId,s=e.returnUrl,o=e.state;if(!i||!s)return"";var u={client_id:i,redirect_uri:s,response_type:{uriValue:"id_token+token"},scope:"profile openid https://graph.microsoft.com/Files.ReadWrite https://graph.microsoft.com/User.Read",response_mode:"fragment",state:void 0===o?"aad_login":o,nonce:r.default.generate()};return t.LOGIN_BASE_URL+"?"+n.serializeQuery(u,null,!0)}});
define("odsp-next/dataSources/itemPicker/odc/Sdk71Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk71PickerUrlHelper","../PostMessageHelper","../SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=t.viewParams,o=r._behavior=i.getItemPickerBehavior(s),u=r.scope;r._postMessageHelper=new(u.attached(n.postMessageHelperType))({behavior:o});r._secureExperienceHelper=new(u.attached(n.secureExperienceHelperType))({behavior:o});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){return this._postMessageHelper.complete(e)};t.prototype.cancel=function(){return this._postMessageHelper.cancel()};t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{postMessageHelperType:s.typeResourceKey,secureExperienceHelperType:o.typeResourceKey});return t})(r.default);t.default=a;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,a)});
define("odsp-next/dataSources/itemPicker/odc/Sdk71PickerUrlHelper",["require","exports","../Sdk71PickerUrlHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return n.isApplicable(e)};t.getItemPickerBehavior=function(e){return n.getItemPickerBehavior(e)}});
define("odsp-next/dataSources/itemPicker/PostMessageHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/uri/SimpleUri","./OriginValidator","./Sdk71","./PickerItemHelper","@ms/odsp-utilities/lib/resources/Resources","./ItemPickerConstants"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.behavior;r._behavior=i;var o=n.currentWindow,a=void 0===o?window:o,f=r._postMessageTargetSignal=new s.default,l=r._hostIdentitySignal=new s.default,c=a.parent!==a?a.parent:void 0,h=a.opener,p=i.origin,d=c||h;if(d){var v=r._getOrigin(d,p),m=v.origin,g=v.hostAuthenticationLevel;f.complete({window:d,origin:m});g&&l.complete({authenticationLevel:g,reason:"origin"})}u.isApprovedDomain(i.origin)||l.complete({authenticationLevel:0,reason:"origin"});r._pickerItemHelper=new n.pickerItemHelperType({behavior:i});r._responseSignals={};r.events.on(a,"message",r._onMessage);return r}t.prototype.initialize=function(){var e=this._behavior.id,n=this._hostIdentitySignal;this.async.setTimeout(function(){n.complete({authenticationLevel:0,reason:"timeout"})},c.ORIGIN_VALIDATION_TIMEOUT);this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"initialize"}).done(function(e){n.complete({authenticationLevel:0,reason:"invalid"})});return n.getPromise()};t.prototype.complete=function(e){var n=this,r=this._behavior.id;return this._hostIdentitySignal.getPromise().then(function(s){return n._pickerItemHelper.getPickerItemsFromItems(e,{hostAuthenticationLevel:s.authenticationLevel}).then(function(e){return n._sendRequest({conversationId:++t._nextConversationId,pickerId:r,type:"success",items:e})}).then(function(e){if("error"===e.type)return i.default.wrapError(new Error(e.error.message))})})};t.prototype.cancel=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"cancel"}).then(function(e){if("error"===e.type)return i.default.wrapError(new Error(e.error.message))})};t.prototype.switchAccount=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++t._nextConversationId,pickerId:e,type:"switch"}).then(function(e){if("error"===e.type)return i.default.wrapError(new Error(e.error.message))})};t.prototype._getOrigin=function(e,t){var n,r;try{var i=e;n=new o.default(i.location.href).authority;r=2}catch(e){t===this._behavior.origin&&(n=t)}return{origin:n,hostAuthenticationLevel:r}};t.prototype._sendRequest=function(e){var t=this;return this._postMessageTargetSignal.getPromise().then(function(n){var r=n.window,i=n.origin;u.validateOrigin(i);var o=e.conversationId,f=""+a.MESSAGE_FROM_PICKER_PREFIX+JSON.stringify(e),l=new s.default;t._responseSignals[o]=l;r.postMessage(f,i);return l.getPromise().then(function(e){delete t._responseSignals[o];return e})})};t.prototype._onMessage=function(e){var t=this,n=""+(e.data||"");if(0===n.indexOf(a.MESSAGE_TO_PICKER_PREFIX))try{var r=JSON.parse(n.substring(a.MESSAGE_TO_PICKER_PREFIX.length));if(r.pickerId===this._behavior.id){var i=this._postMessageTargetSignal;if("activate"===r.type){var s=this._getOrigin(e.source,e.origin),o=s.hostAuthenticationLevel,f=void 0===o?u.isApprovedDomain(e.origin)?2:0:o,l=s.origin;this._hostIdentitySignal.complete({authenticationLevel:f,reason:"origin"});i.complete({window:e.source,origin:l})}i.getPromise().done(function(n){if(e.origin===n.origin){var i=t._responseSignals[r.conversationId];i&&i.complete(r)}})}}catch(e){}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pickerItemHelperType:f.typeResourceKey});t._nextConversationId=0;return t})(r.default);t.default=h;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,h)});
define("odsp-next/dataSources/itemPicker/PickerItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/vroom/VroomDataRequestor","../../providers/itemPicker/ItemPickerProvider","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f;(function(t){var n=(function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getItem=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:t+"?select=*,sharePointIds",accessToken:n,apiName:"GetItem"})};e.prototype.createLink=function(e){var t=e.itemUrl,n=e.accessToken;return this._vroomDataRequestor.send({path:t+"/oneDrive.createLink",accessToken:n,apiName:"CreateLink",postData:JSON.stringify({type:"view"}),requestType:"POST"})};e.dependencies={vroomDataRequestor:i.resourceKey};return e})();t.PickerItemService=n;t.pickerItemServiceResourceKey=new a.ResourceKey({name:e("module").id+".internals.pickerItemService",factory:new a.ResolvedResourceFactory(n)})})(f=t.Internals||(t.Internals={}));var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._pickerItemService=n.pickerItemService;r._itemPickerProvider=n.itemPickerProvider;r._behavior=t.behavior;return r}t.prototype.getPickerItemsFromItems=function(e,t){var n=this,r=t.hostAuthenticationLevel;return u.default.all(e.map(function(e){var t=u.default.wrap(n._itemPickerProvider.getPickerItemFromItem(e,{hostAuthenticationLevel:r}));if(r>=2){var i=n._behavior.linkType;4!==i&&2!==i||(t=t.then(function(t){return n._attachDriveItemToPickerItem(e,t)}));4!==i&&3!==i||(t=t.then(function(t){return n._attachShareUrlToPickerItem(e,t)}))}return t}))};t.prototype._attachDriveItemToPickerItem=function(e,t){var r=t.urls,i=void 0===r?{}:r,s=n.__rest(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){return n.__assign(n.__assign({},s),{urls:n.__assign(n.__assign({},i),{download:e["@content.downloadUrl"]}),driveItem:e})})};t.prototype._attachShareUrlToPickerItem=function(e,t){var r=t.urls,i=void 0===r?{}:r,s=n.__rest(t,["urls"]);return this._getShareLink(e).then(function(e){return n.__assign(n.__assign({},s),{urls:n.__assign(n.__assign({},i),{share:e})})})};t.prototype._getOneDrivePickerItem=function(e){var t=this;return this.resources.consumeAsync(o.graph).then(function(n){return u.default.resolve().then(function(){return n.getAccessToken(e)||n.refreshAccessToken&&n.refreshAccessToken(e)}).then(function(r){return t._pickerItemService.getItem({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:r})})})};t.prototype._getShareLink=function(e){var t=this;return this.resources.consumeAsync(o.graph).then(function(n){return t._pickerItemService.createLink({itemUrl:n.getItemUrl(e,{useDirectEndpoint:!0,isPath:!1}),accessToken:n.getAccessToken(e)}).then(function(e){return e.link.webUrl})})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pickerItemService:f.pickerItemServiceResourceKey,itemPickerProvider:s.resourceKey});return t})(r.default);t.default=l;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/dataSources/itemPicker/Sdk72Handler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./Sdk72PickerUrlHelper","./PostMessageHelper","./SecureExperienceHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=r._behavior=i.getItemPickerBehavior(t.viewParams),o=r.scope;r._postMessageHelper=new(o.attached(n.postMessageHelperType))({behavior:s});r._secureExperienceHelper=new(o.attached(n.secureExperienceHelperType))({behavior:s});return r}t.prototype.getBehavior=function(){return this._behavior};t.prototype.initialize=function(){var e=this;return this._postMessageHelper.initialize().then(function(t){return e._secureExperienceHelper.validateExperience(t)})};t.prototype.complete=function(e){return this._postMessageHelper.complete(e)};t.prototype.cancel=function(){return this._postMessageHelper.cancel()};t.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};t.dependencies={postMessageHelperType:s.typeResourceKey,secureExperienceHelperType:o.typeResourceKey};return t})(r.default);t.default=a;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,a)});
define("odsp-next/dataSources/itemPicker/odc/LeftNavDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../leftNav/handlers/SwitchAccountLeftNavHandler","../../leftNav/odc/handlers/OneDriveLeftNavHandler.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHandlerTypeKeys=function(){return[s.typeResourceKey,i.typeResourceKey]};return t})(r.default);t.LeftNavDataSource=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u)});
define("odsp-next/dataSources/itemPicker/leftNav/handlers/SwitchAccountLeftNavHandler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../controls/itemPicker/resources/ItemPickerResourceKeys","../../../../controls/itemPicker/ItemPicker.resx","@ms/odsp-utilities/lib/resources/Resources","../../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables;r._switchAccountAction=new(r.child(n.itemPickerActionMap.ItemPickerSwitchAccountAction));var o=i.createArray();o.push({url:"#",action:r._switchAccountAction,isActive:i.create(!1),isFocused:i.create(!1),text:s.default.switchAccountActionText,engagementName:"SwitchAccount",altText:s.default.switchAccountActionText,icon:new u.default("Contact")});(r.linkGroups=i.createArray()).push({text:"",url:void 0,isActive:i.create(!1),isFocused:i.create(!1),automationId:"switchAccount",hideGroupHeader:!0,isExpanded:i.create(!0),links:r.scope.attach(o.filter(function(e){return e.action.isAvailable()}))});return r}t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemPickerActionMap:i.actionMap});return t})(r.default);t.default=a;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,a)});
define("odsp-next/dataSources/leftNav/odc/handlers/OneDriveLeftNavHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneDriveLeftNavHandler"],t,n)}).then(function(e){return e.typeResourceKey.local})})})});
define("odsp-next/dataSources/leftNav/odc/handlers/OneDriveLeftNavHandler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../../controls/leftPane/LeftPane.resx","../../../../controls/leftNav/LeftNav.resx","../../../../resources/ControlResourceKeys","../../../url/QueryType","../../../../models/item/ItemParentHelper","../../../rootItems/RootItems.key","../../RootSourceTypeFilter.key","../../../base/odc/Config","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._rootItems=n.rootItems;r._actionMap=n.actionMap;r._itemParentHelper=n.itemParentHelper;r._currentItem=n.currentItem;r._rootSourceTypeFilter=n.rootSourceTypeFilter;r._config=n.config;r.linkGroups=r._getLinkGroups();return r}t.prototype._getLinkGroups=function(){var e=this.observables,t=e.createArray();t.push({text:h.format(i.default.oneDriveGroupHeaderFormat,i.default.oneDriveGroupTitle,i.default.consumerOneDriveName),subText:this._config.email,icon:e.create({iconUrl:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/product-fluent/svg/onedrive_48x1_5.svg",mode:"person"}),url:null,isExpanded:e.create(!0),isActive:e.create(!1),isFocused:e.create(!1),automationId:"LeftNav-OneDriveGrouping",links:this._getOneDriveLinks()});return t};t.prototype._getOneDriveLinks=function(){var e=this,t=this.observables,n=t.createArray(),r=this._rootItems.peek(),i=r.files,o=r.recent,a=r.photos,f=this._rootSourceTypeFilter,l=!f||f.recent,c=!f||f.photos;n.push({text:i.peek().displayName,altText:s.default.filesAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:i}),isActive:this._getIsActive(i),isFocused:t.create(!1),engagementName:"Files"});l&&n.push({text:o.peek().displayName,altText:s.default.recentAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:o}),isActive:this._getIsActive(o),isFocused:t.create(!1),engagementName:"Recent"});c&&n.push({text:a.peek().displayName,altText:s.default.photosAlt,action:new(this.child(this._actionMap.DefaultClickAction))({item:a}),isActive:t.pureCompute(function(){return e._currentItem().displayType===u.default.AllMyPhotos}),isFocused:t.create(!1),engagementName:"Photos"});return n};t.prototype._getIsActive=function(e){var t=this,n=this.observables;return n.pureCompute(function(){var r=e().key;return!!n.unwrap(t._itemParentHelper.getAncestorOrSelf(t._currentItem(),function(e){return e.key===r}))})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{rootItems:f.resourceKey,actionMap:o.actionMap,currentItem:o.currentItem,itemParentHelper:a.resourceKey,rootSourceTypeFilter:l.resourceKey.optional,config:c.configResourceKey});return t})(r.default);t.default=d;t.typeResourceKey=p.createResolvedTypeResourceKey(e("module").id,d)});
define('ODCFilePicker_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-FilePicker{position:absolute;top:0;bottom:0;left:0;right:0;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;z-index:280}.od-FilePicker-content{overflow-y:hidden;position:absolute;bottom:0;left:0;right:0;top:0;overflow-y:scroll;-webkit-overflow-scrolling:touch}.od-FilePicker-innerContent{position:relative;min-height:100%;padding-bottom:32px;box-sizing:border-box}.lg .od-FilePicker-innerContent,.md .od-FilePicker-innerContent,.xlg .od-FilePicker-innerContent,.xxlg .od-FilePicker-innerContent,.xxxlg .od-FilePicker-innerContent,.xxxxlg .od-FilePicker-innerContent{padding-bottom:70px}.sm .od-FilePicker-innerContent{padding-bottom:100px}.od-FilePicker-loadingDiv{position:absolute;top:0;left:0;right:0;background:linear-gradient(to bottom,rgba(255,255,255,.9),rgba(255,255,255,0))}"},{"rawString":".od-ItemPickerHeader{height:50px;background-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ItemPickerHeader-application{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-application{left:16px}[dir=rtl] .od-ItemPickerHeader-application{right:16px}.od-ItemPickerHeader-applicationTitle{font-size:21px;font-weight:300}.od-ItemPickerHeader-applicationLogo{display:none}.od-ItemPickerHeader-account{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-account{right:16px}[dir=rtl] .od-ItemPickerHeader-account{left:16px}.od-ItemPickerHeader-accountDropdown{padding:0 4px;height:100%;display:inline-block;font-size:12px;font-weight:300}.od-ItemPickerHeader-accountDropdown .ms-Icon{font-size:14px;vertical-align:middle}[dir=ltr] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-left:4px}[dir=rtl] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-right:4px}.od-ItemPickerHeader-accountDropdown--isEnabled{cursor:pointer}.od-ItemPickerHeader-accountDropdown--isEnabled:hover{background-color:rgba(255,255,255,.28)}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationLogo{display:inline-block;padding-top:5px}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationTitle{display:inline-block;width:0;height:0;overflow:hidden}"},{"rawString":".od-ItemPicker{position:absolute;top:0;left:0;bottom:0;right:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ItemPicker-picker{position:absolute;top:0;left:0;bottom:0;right:0}.od-ItemPicker-branding{position:absolute;top:0;left:0;right:0;height:50px;z-index:3}.od-ItemPicker-topBar{position:absolute;top:0;left:0;right:0;height:40px}.md .od-ItemPicker-topBar,.sm .od-ItemPicker-topBar{height:44px}.od-ItemPicker-leftPane{position:absolute;top:0;bottom:0;width:208px;box-sizing:border-box}[dir=ltr] .od-ItemPicker-leftPane{left:0}[dir=rtl] .od-ItemPicker-leftPane{right:0}html[dir=ltr] .od-ItemPicker-leftPane{border-right:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir=rtl] .od-ItemPicker-leftPane{border-left:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.md .od-ItemPicker-commandBar,.sm .od-ItemPicker-commandBar{padding-left:4px;padding-right:4px}.lg .od-ItemPicker-commandBar,.xlg .od-ItemPicker-commandBar,.xxlg .od-ItemPicker-commandBar,.xxxlg .od-ItemPicker-commandBar,.xxxxlg .od-ItemPicker-commandBar{padding-left:16px;padding-right:16px}.od-ItemPicker-selector{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.od-ItemPicker--hasBranding .od-ItemPicker-topBar{top:50px}.od-ItemPicker--hasBranding .od-ItemPicker-selector{top:50px}[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{left:208px}[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{right:208px}.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:40px}.isFluent .od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:44px}.md .od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:44px}.od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:90px}.md .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:94px}.od-ItemPicker--hasActions .od-ItemPicker-selector{bottom:50px}.od-ItemPicker-actions{position:absolute;left:0;right:0;bottom:0;height:50px;box-sizing:border-box;padding:10px 20px;z-index:1}html[dir=ltr] .od-ItemPicker-actions{text-align:right}html[dir=rtl] .od-ItemPicker-actions{text-align:left}.od-ItemPicker-actions .od-Button--primary:enabled,.od-ItemPicker-actions .od-Button:active{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ItemPicker-actions .od-ButtonBarCommand--text{font-size:12px}.od-ItemPicker .DetailsRow,.od-ItemPicker .ItemTile{opacity:.3}.od-ItemPicker .DetailsRow.can-select,.od-ItemPicker .DetailsRow.od-DetailsRow--isInvokable,.od-ItemPicker .DetailsRow.od-ItemTile--isInvokable,.od-ItemPicker .ItemTile.can-select,.od-ItemPicker .ItemTile.od-DetailsRow--isInvokable,.od-ItemPicker .ItemTile.od-ItemTile--isInvokable{opacity:1}.od-ItemPicker-secureExperienceStatus{font-style:italic}.od-ItemPicker-secureExperienceStatus--failed{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{position:absolute;top:40px;bottom:0;width:272px;box-shadow:30px 0 30px -30px "},{"theme":"blackTranslucent40","defaultValue":"rgba(0,0,0,.4)"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-sizing:border-box;opacity:0}[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{left:0}[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{right:0}html[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-right:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-left:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay:focus{outline:1px solid transparent}.md .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay,.sm .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{top:44px}.od-OverlayHost-overlay .od-ItemPicker-leftPaneModal{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{opacity:1;animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation:none}}"},{"rawString":".od-MessageBar{padding:8px;display:table;background-color:"},{"theme":"infoBackground","defaultValue":"#f4f4f4"},{"rawString":"}.od-MessageBar-icon,.od-MessageBar-text{display:table-cell;vertical-align:top}.od-MessageBar-icon{padding-right:8px;font-size:16px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-MessageBar-text{font-size:12px;font-weight:400}.od-MessageBar.od-MessageBar--warning{background-color:"},{"theme":"warningBackground","defaultValue":"#fff4ce"},{"rawString":"}.od-MessageBar.od-MessageBar--severeWarning{background-color:"},{"theme":"severeWarningBackground","defaultValue":"#fed9cc"},{"rawString":"}.od-MessageBar.od-MessageBar--severeWarning .od-MessageBar-icon{color:"},{"theme":"severeWarning","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--error{background-color:"},{"theme":"errorBackground","defaultValue":"rgba(232,17,35,.2)"},{"rawString":"}.od-MessageBar.od-MessageBar--error .od-MessageBar-icon{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--remove{background-color:"},{"theme":"errorBackground","defaultValue":"rgba(232,17,35,.2)"},{"rawString":"}.od-MessageBar.od-MessageBar--remove .od-MessageBar-icon{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-MessageBar.od-MessageBar--remove .ms-Icon{font-size:8px;margin-left:3px}.od-MessageBar.od-MessageBar--success{background-color:"},{"theme":"successBackground","defaultValue":"#dff6dd"},{"rawString":"}.od-MessageBar.od-MessageBar--success .od-MessageBar-icon{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-MessageBar.od-MessageBar--success .ms-Icon{font-size:12px;top:3px}.od-MessageBar.od-MessageBar--success .ms-Icon:before{margin-left:1px}.od-MessageBar.od-MessageBar--success .ms-Icon:after{font-size:8px;margin-left:3px;top:1px}.NotificationHost{position:relative}.od-Notification-close{font-size:12px;width:40px;cursor:pointer;border:none;background-color:transparent;position:absolute;top:0;bottom:0;padding-top:4px}[dir=ltr] .od-Notification-close{right:0}[dir=rtl] .od-Notification-close{left:0}.od-Notification{width:100%}.od-Notification .od-MessageBar{width:100%;padding:0}.od-Notification .od-MessageBar-content{padding:8px}.od-Notification .od-MessageBar-text{vertical-align:middle;cursor:default}.od-Notification .od-MessageBar-icon .ms-Icon--Info{display:block}[dir=ltr] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-right:40px}[dir=rtl] .od-Notification--canClose .od-MessageBar .od-MessageBar-content{padding-left:40px}.od-Notification .od-MessageBar--info{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-Notification-link{white-space:nowrap}[dir=ltr] .od-Notification-link{padding-left:4px}[dir=rtl] .od-Notification-link{padding-right:4px}"}]);});