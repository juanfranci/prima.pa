define("odsp-next/pages/files/odc/ConsumerFiles",["require","exports","./ConsumerFiles.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ConsumerFilesViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-consumer-files",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/pages/files/odc/ConsumerFiles.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko component:{name:filesTagName,params:filesParams}--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/pages/files/odc/ConsumerFilesViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../od/Files"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.filesTagName=i.default.tagName;n.filesParams={};return n}return t})(r.default);t.default=s});
define("odsp-next/pages/files/od/Files",["require","exports","./Files.html","./FilesViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css","../../../controls/list/CompactDetailsList","../../../controls/list/DetailsList","../../../controls/list/GridList","../../../controls/list/SingleAlbumList"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-files",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/pages/files/od/Files.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Files od-Files-dragAndDrop" data-bind="dragAndDrop:dragAndDrop.getOptions,interactionScope:{isActive:isActive}">\x3c!--ko if:showMobileWebToAppUpsellV2()--\x3e<div class="od-files-mobileWebToAppUpsellV2" data-bind="react:mobileWebToAppUpsellV2"></div>\x3c!--/ko--\x3e\x3c!--ko if:showSmartBanner()--\x3e<div class="Files-smartBanner" data-bind="component:{name:smartBannerTagName,params:{isVisible:isSmartBannerVisible,useODCAdjustLink:true}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!!upsellComponent()--\x3e<div class="SetView-firstRunBanner" data-bind="component:upsellComponent()"></div>\x3c!--/ko--\x3e\x3c!--ko with:guidedTourComponent--\x3e\x3c!--ko control:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showVaultUpsell()--\x3e<div class="od-files-vaultUpsell" data-bind="component:{name:vaultUpsellTagName,params:vaultUpsellParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:vaultSuggestCardListLoaded()--\x3e\x3c!--ko component:{name:vaultSuggestCardListName,params:{item:item}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!isEmptyView()--\x3e\x3c!--ko component:{name:listFooterTagName,params:{dragAndDropHintComponent:dragAndDropFooterHintComponent}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:commandBarTransclusionContentParams}--\x3e<div data-bind="control:commandBarSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if:isOneUp--\x3e\x3c!--ko component:{name:oneUpOverlayTagName}--\x3e\x3c!--ko if:showUnauthBanner--\x3e<div class="od-Files-unauthBanner" data-bind="component:unauthenticatedBannerTagName"></div>\x3c!--/ko--\x3e<div class="od-Files-oneUp" data-bind="control:oneUpSpecification,css:{\'od-Files-OneUp--showUnauthBanner\':showUnauthBanner()&&!isOneUpSlideshow()}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with:dragAndDrop.decorationComponent()--\x3e\x3c!--ko control:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isFirstRunExperienceVisible--\x3e\x3c!--ko control:firstRunComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with:premiumUpsellComponent--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isFamiliesGroupsFreEnabled--\x3e\x3c!--ko with:familiesFreComponent--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/pages/files/od/FilesViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","knockout","../../baseInnerPage/od/DataManagerPageViewModel","../../../resources/ProviderResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/PagesResourceKeys","../../../providers/dataManager/files/FilesDataManager","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../providers/item/ItemProvider","../../../dataSources/vault/odc/VaultDataSource.key","./DragAndDropHelper","./FilesCommandSet","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemType","../../../controls/guidedTour/GuidedTour.key","../../../controls/itemContent/folder/FolderItemContent.key","../../../controls/itemContent/itemsScope/ItemsScopeItemContent.key","../../../controls/itemContent/albumItemContentList/AlbumItemContentList.key","../../../controls/itemsScope/CommandBar.key","../../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../../providers/notificationManager/NotificationManager.key","../../../controls/firstRunExperience/FirstRunExperienceStatus","../../../controls/firstRunExperience/FirstRunExperience.key","../../../dataSources/base/vroom/VroomDataRequestor","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","../../../dataSources/url/PageType","../../../resources/ControlResourceKeys","../../../utilities/features/Features","../../../utilities/educationAndUpsells/EducationAndUpsells","../../../models/upsell/Upsells","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../providers/engagement/Engagement","../../../providers/guidedTour/GuidedTourProvider.key","../../../providers/inAppMessaging/InAppMessagingProvider.key","../../../controls/clipboard/ClipboardHelper.key","../../../models/store/ItemsStore","../../../controls/commandBar/CommandBar.key","@ms/odsp-utilities/lib/events/EventGroup","../../../bindings/contextMenu/ContextMenuHelper","../../../bindings/component/ControlBinding","../../../bindings/react/ReactBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../models/inAppMessaging/MessagingTypeHelper","../../../models/vault/VaultUpsellType","../../../dataSources/vault/IVaultDataSource","../../../controls/vaultTeachingBubble/VaultTeachingBubbleHelper","../../../controls/listFooter/ListFooter","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/transclusion/content/TransclusionContent","../../../controls/unauthenticatedBanner/UnauthenticatedBanner","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../controls/list/viewModels/DetailsListViewModel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var ne={props:{}},re=(function(t){n.__extends(s,t);function s(e){var n=t.call(this,e)||this;n.listFooterTagName=Q.default.tagName;n.oneUpOverlayTagName=G.default.tagName;n.transclusionContentTagName=Y.default.tagName;n.unauthenticatedBannerTagName=Z.default.tagName;n.firstRunComponent=z.toSpecification(N.resourceKey,{});n.addBindingHandlers({react:W.default,control:z.default,interactionScope:X.default});n._identity=n.resources.consume(u.identity).getIdentity();n._navigation=n.resources.consume(l.navigation);n._userInfoProvider=n.resources.consume(o.userInfo);n._bundleLoader=n.resources.consume(o.bundleLoader);n._dragAndDropRobotProvider=n.resources.consume(o.dragAndDropRobot);n._storageOptionsProvider=n.resources.consume(o.storageOptions);n._isExistingUserPremiumUpsellEligible=n.observables.create(!1);n._firstRunExperienceStatus=n.resources.consume(S.resourceKey);n.isFirstRunExperienceVisible=n.observables.pureCompute(function(){return n._firstRunExperienceStatus()===T.FirstRunExperienceStatus.visible});n._educationAndUpsells=n.resources.consume(_.resourceKey);n._dialogDataStore=new ee.default("SignInDialogCounter",te.default.local);n._engagement=n.resources.consume(H.resourceKey);n._dataStore=n.resources.consume(I.resourceKey);n._iamProvider=n.resources.consumeAsync(j.resourceKey);n.isActive=n.observables.create(!1);n.showVaultUpsell=n.createObservable(!1);n._applicableVaultUpsellType=n.createObservable($.UpsellType.None);n.vaultSuggestCardListLoaded=n.createObservable(!1);n.showUnauthBanner=n.createObservable(!n._userInfoProvider.isAuthenticated());n._actionMap=n.resources.consume(O.actionMap);var r=new(n.managed(n._actionMap.UploadAction))({uploadProcessorType:P.UploadProcessorType.Html5file});n._isUploadAvailable=r.isAvailable;var s=n._navigation.viewParams;n.isEmptyView=n.createPureComputed(n._computeIsEmptyView);n._robotRootOverride=s.robotMimicRoot;n.isGridBasedView=n.createPureComputed(n._computeIsGridBasedView);n._iosMobilePathDataSource=n.resources.isExposed(u.iosMobileAppPath)?n.resources.consume(u.iosMobileAppPath):null;var a=n.responsiveUI;n._isMobileAtStart=a.compareSize(a.formFactorSize.peek(),"Medium")<=0;if(n._dragAndDropRobotProvider&&!n._isMobileAtStart){n.isDragAndDropRobotApplicable=n.createPureComputed(n._computeIsRobotApplicable);n.dragAndDropGridHintComponent=n.createPureComputed(function(){return n._dragAndDropRobotProvider.getGridHintComponent(n.isGridBasedView,n.isDragAndDropRobotApplicable)});n.dragAndDropFooterHintComponent=n.createPureComputed(function(){return n.isEmptyView()?null:n._dragAndDropRobotProvider.getFooterHintComponent(n.isGridBasedView,n.isDragAndDropRobotApplicable)})}else{n.dragAndDropGridHintComponent=void 0;n.dragAndDropFooterHintComponent=void 0}n.dragAndDrop=new(n.managed(p.default))({});n.itemProvider=n.resources.consume(c.resourceKey);n._isPremiumUpsellVisible=n.resources.consume(O.isPremiumUpsellVisible);n._isFamiliesOrGroupsFreVisible=n.createObservable(!1);n._hasFamily=n.createObservable(!1);n._familyStatusComputed=n.createObservable(!1);n._isGuidedTourVisible=n.resources.consume(O.isGuidedTourVisible);n._guidedTourUploadTimerStartTime=0;if(n._userInfoProvider.isAuthenticated()){var f=n._dialogDataStore.getValue(Z.LAST_SIGN_IN_DIALOG);f&&f+36e5<=Date.now()&&n._engagement.logData({name:"SignInDialog.SignedIn"})}n.upsellComponent=n.createObservable();n.upsell=i.observable(null);n.upsellParams={upsell:n.upsell,item:n.item};n.isUpsellApplicable=n.createObservable(!1);n.createBackgroundComputed(n._determineIfUpsellIsApplicable);n.createBackgroundComputed(n._initializeUpsellComponent);n._freOverride=s.showFre;n._guidedTourOverride=s.showGuidedTour;n._basicPositioningOverride=s.showPremiumPositioning;n._newFeaturesOverride=s.showNewFeaturesExperience;n._welcomeOverride=s.showWelcomeExperience;n._familiesFreOverride=s.showFamiliesFre;n._groupsFreOverride=s.showGroupsFre;n.premiumUpsellComponent=n.createObservable();n.createBackgroundComputed(n._initializeFirstRunComponent);n.guidedTourComponent=n.createObservable();n.createBackgroundComputed(n._initializeGuidedTourComponent);n.createBackgroundComputed(n._configureAreOverrideParamsAvailable);var h=n.createBackgroundComputed(n._configureIsFirstRunExperienceVisible),d=n.createBackgroundComputed(n._configureIsPremiumUpsellVisible);n.createBackgroundComputed(n._configureIsGuidedTourVisible);n._hasUpsellBeenShownAlready=n.createObservable(!1);n.familiesFreComponent=n.createObservable();n.isFamiliesGroupsFreEnabled=M.isFeatureEnabled(M.FamilySharing)&&M.isFeatureEnabled(M.FamiliesAndGroupsFRE);if(n.isFamiliesGroupsFreEnabled&&n._userInfoProvider.isAuthenticated()){n.createBackgroundComputed(n._setFamiliesGroupsAvailable);n.createBackgroundComputed(n._configureIsFamiliesFREVisible);n.createBackgroundComputed(n._initializeFamiliesFREComponent)}if(M.isFeatureEnabled(M.ProjectVWeb)&&n._userInfoProvider.isAuthenticated()){n.createBackgroundComputed(n._initializeVaultSuggestCardList);n.createBackgroundComputed(n._initializeVaultUpsell);n.createBackgroundComputed(n._computeVaultUpsell)}h.extend({rateLimit:{timeout:1500,method:"notifyWhenChangesStop"}});d.extend({rateLimit:{timeout:1500,method:"notifyWhenChangesStop"}});n.showSmartBanner=n.createObservable(!1);n.showMobileWebToAppUpsellV2=n.createObservable(!1);n.createBackgroundComputed(n._initializeMobileWebToAppUpsell);n._mobileWebToAppUpsellDismissed=n.resources.consume(O.mobileUpsellDismissedThisSession.optional);n._setupCommandSets();n._userInfoProvider.isAuthenticated()&&n._checkForNotifications();n.createBackgroundComputed(function(){!n.isLeftNavVisible()&&n.isLeftNavVisible()||n.async.setTimeout(function(){R.default.raise(document.body,"resize",void 0,!0)},300)});n.resources.consumeAsync(F.typeResourceKey).then(function(e){n.scope.attach(new e({isEnabled:n.isActive}))});var v=n.observables.create();n._vaultDataSource=v;var m=n._canShowVaultFREUpsell=n.observables.create(!1);n.observables.backgroundCompute(function(){var e=v();if(!n._isGuidedTourVisible()&&!K.isVaultInContainer()&&m()){n._loadVaultUpsell($.UpsellType.Created);e.setVaultState(J.VaultFreState.BubbleShown)}});n.observables.backgroundCompute(function(){var e=v();e&&e.isVaultOpen()()&&e.getQuota().then(function(){n._loadVaultUpsell($.UpsellType.Premium)})});n.observables.backgroundCompute(function(){if(n._isGuidedTourVisible()&&n.item().vault){n.guidedTourComponent(null);n._isGuidedTourVisible(!1)}});M.isFeatureEnabled(M.UseItemsScopeInOneDrive)||n._makeGetItemShadowCall();return n}s.prototype.onDismissMobileWebToAppUpsellV2=function(){this.showMobileWebToAppUpsellV2(!1);this._mobileWebToAppUpsellDismissed(!0)};s.prototype.onMobileWebToAppUpsellGetAppClick=function(e){this.onDismissMobileWebToAppUpsellV2();this._navigation.navigateTo(e)};s.prototype.onMobileWebToAppUpsellOpenAppClick=function(e){var t=this;this.showMobileWebToAppUpsellV2(!1);var n=Date.now();if(this.platform.isIOS)this._navigation.navigateTo(e);else{this.async.setTimeout(function(){Date.now()-n<750&&t._navigation.navigateTo(e)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};s.prototype.dispose=function(){t.prototype.dispose.call(this);this.contextMenuHelper(null)};s.prototype.computeCurrentPageName=function(){var e,t=this.item.peek(),n=this.urlDataSource.getKeyParams(t.key);switch(this.urlDataSource.getQueryType(n)){case k.default.RecycleBin:e="RecycleBin";break;case k.default.Recent:e="Recent";break;case k.default.SharedWithMe:e="Shared";break;case k.default.Search:e="Search";break;default:e="Folder"}return"Files-"+e};s.prototype.computeContentControl=function(){var e=t.prototype.computeContentControl.call(this);if(e)return e;var n=this.item(),r=this.layoutType(),i=this.useItemsScope(),s=this._getFooterHostContentControlParams();if(n.type===m.default.Folder||void 0===n.type){if(r===L.SingleAlbum)return z.toSpecification(w.resourceKey,s);if(i){return z.toSpecification(b.resourceKey,ne)}return z.toSpecification(y.resourceKey,s)}};s.prototype.computeCreateDataManager=function(){return this._createFilesDataManager};s.prototype._getFooterHostContentControlParams=function(){var e={footerItem:this.dragAndDropGridHintComponent};this._getFooterHostContentControlParams=function(){return e};return e};s.prototype._computeIsGridBasedView=function(){var e=this.layoutType();return e===L.Grid||e===L.SingleAlbum};s.prototype._computeIsEmptyView=function(){return 0===this.itemSet().content().items.length};s.prototype._computeIsRobotApplicable=function(){var e=this.itemSet(),t=e.item(),n=e.content().items;return!(t.key!==this.urlDataSource.getRootItemKey()&&!this._robotRootOverride||e.isPlaceholder||e.isExpired||!(n.length<=3)||!this._educationAndUpsells.getAreNoFilesAdded(e))};s.prototype._createFilesDataManager=function(){return new(this.managed(f.default))({requiredPageType:A.default.Files})};s.prototype._setupCommandSets=function(){var e=new(this.managed(d.default))({});this.resources.expose(a.listViewContextMenuHelper,new(this.managed(U.default))({items:e.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));var t=new(this.managed(U.default))({items:e.commands.peek(),rootElementClass:"od-BasePage-content",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0});this.contextMenuHelper(t);this.commandBarSpecification=this._getCommandBarSpecification(e)};s.prototype._checkForNotifications=function(){var e=this;this.resources.consumeAsync(x.resourceKey).then(function(t){t.createNotificationHandlers(function(t){return new(e.managed(t))})});this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this.createBackgroundComputed(function(){var t=e.item();if(!t.isPlaceholder&&!e._hasConfiguredUpsell){e._hasConfiguredUpsell=!0;e._getUpsellToShow(t)}})};s.prototype._initializeVaultUpsell=function(){var e=this;this._bundleLoader.getBundleInfo(1).isLoaded()&&this.resources.consumeAsync(h.resourceKey).then(function(t){e._vaultDataSource(t);t.createVaultIfNotExist().then(function(t){t&&(e._vaultItem=t);e.async.setTimeout(function(){e._canShowVaultFREUpsell(!!t)},2e3)})})};s.prototype._loadVaultUpsell=function(t){var n=this;new Promise(function(t,n){e(["../../../controls/vaultUpsell/VaultUpsellContainer"],t,n)}).then(function(e){n.vaultUpsellParams={vaultItem:n._vaultItem,resources:n.resources,upsellType:t,onGoToVaultClick:n._onGoToVault.bind(n),onClose:t===$.UpsellType.Premium?null:n._onVaultUpsellClose.bind(n)};n.vaultUpsellTagName=e.default.tagName;n._applicableVaultUpsellType(t)})};s.prototype._computeVaultUpsell=function(){var e=this._applicableVaultUpsellType();if(e){var t=this.item(),n=this.resources.consume(h.resourceKey.optional),r=n&&n.isOverQuota&&n.isOverQuota(),i=n&&n.freState&&n.freState()()===J.VaultFreState.FreShown;this.showVaultUpsell(e===$.UpsellType.Created&&t.isRootFolder&&!i||e===$.UpsellType.Premium&&!!t.vault&&r&&!t.vault.isLocked)}};s.prototype._onVaultUpsellClose=function(){this.showVaultUpsell(!1);this._applicableVaultUpsellType($.UpsellType.None)};s.prototype._onGoToVault=function(){this._applicableVaultUpsellType($.UpsellType.None)};s.prototype._initializeVaultSuggestCardList=function(){var t=this;this._bundleLoader.getBundleInfo(1).isLoaded()&&new Promise(function(t,n){e(["../../../controls/vaultSuggestCard/VaultSuggestCardList"],t,n)}).then(function(e){t.vaultSuggestCardListName=e.default.tagName;t.vaultSuggestCardListLoaded(!0)})};s.prototype._getUpsellToShow=function(e){var t=this;this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this._userInfoProvider.getUpsellToShow(e).then(function(e){e&&t.upsell(e)})};s.prototype._determineIfUpsellIsApplicable=function(){var e=this.item(),t=this.upsell();this._bundleLoader.getBundleInfo(4).isLoaded()&&e&&!this._isMobileAtStart&&this._identity.type===v.IdentityType.msa&&e.key===this.urlDataSource.getRootItemKey()&&t?this.isUpsellApplicable(t.id!==D.default.NewBrandFRE):this.isUpsellApplicable(!1)};s.prototype._configureIsGuidedTourVisible=function(){var e=this;this._guidedTourOverride?this._activateGuidedTourExperimentWithoutLightbox():this._isUploadAvailable()?this._userInfoProvider.getGuidedTourCompleted().then(function(t){t||e._userInfoProvider.getGuidedTourViewCount().then(function(t){t>0&&t<3&&e._activateGuidedTourExperimentWithoutLightbox()})}):this._isGuidedTourVisible(!1)};s.prototype._activateGuidedTourExperimentWithoutLightbox=function(){this._isMobileAtStart||this._isGuidedTourVisible(!0)};s.prototype._configureIsFamiliesFREVisible=function(){return n.__awaiter(this,void 0,r.default,function(){var e,t,r,i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:e=this._familyStatusComputed();t=V.POSITIONING_MESSAGES.concat(V.UPSELL_MESSAGES);r=[151,152];i=t.filter(function(e){return-1===r.indexOf(e)});return[4,this._getAnyMessageActive(i)];case 1:return n.sent()||(this._familiesFreOverride||this._groupsFreOverride)?[2]:e?[4,this._getAnyMessageActive([401])]:[3,4];case 2:s=n.sent();return[4,this._getAnyMessageActive([451])];case 3:o=n.sent();s&&o?this._isFamiliesOrGroupsFreVisible(!0):this._isFamiliesOrGroupsFreVisible(!1);n.label=4;case 4:return[2]}})})};s.prototype._getAnyMessageActive=function(e){return this.resources.consumeAsync(j.resourceKey).then(function(t){return t.isAnyMessageActive.apply(t,e)})};s.prototype._setFamiliesGroupsAvailable=function(){return n.__awaiter(this,void 0,void 0,function(){var t,i,s;return n.__generator(this,function(n){switch(n.label){case 0:if(this._familiesFreOverride){this._hasFamily(!0);this._isFamiliesOrGroupsFreVisible(!0);return[2]}if(this._groupsFreOverride){this._hasFamily(!1);this._isFamiliesOrGroupsFreVisible(!0);return[2]}t=this._bundleLoader.getBundleInfo(4).isLoaded();return[4,this._bundleLoader.loadNow("../../../controls/familiesGroupsFirstRunDialog/FamiliesGroupsFirstRunHelper",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/familiesGroupsFirstRunDialog/FamiliesGroupsFirstRunHelper"],t,n)}))})];case 1:i=n.sent();return t?[4,i.getDoesUserHaveFamily(this.resources)]:[3,3];case 2:s=n.sent();this._hasFamily(s);this._familyStatusComputed(!0);n.label=3;case 3:return[2]}})})};s.prototype._initializeFamiliesFREComponent=function(){var t=this;if(this._isFamiliesOrGroupsFreVisible()){var n=this._bundleLoader.getBundleInfo(4).isLoaded();this._bundleLoader.loadNow("../../../controls/familiesGroupsFirstRunDialog/FamiliesGroupsFirstRunDialog",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/familiesGroupsFirstRunDialog/FamiliesGroupsFirstRunDialog"],t,n)}))}).then(function(e){n&&t.familiesFreComponent({name:e.tagName,params:{useFamiliesTextFre:t._hasFamily()}})})}};s.prototype._configureAreOverrideParamsAvailable=function(){var e=this._storageOptionsProvider.isReady();if(this._freOverride)this._firstRunExperienceStatus(T.FirstRunExperienceStatus.visible);else if(e)if(this._basicPositioningOverride){this._premiumUpsellType=1;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._welcomeOverride){this._premiumUpsellType=3;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._newFeaturesOverride){this._premiumUpsellType=5;this._isExistingUserPremiumUpsellEligible(!0)}};s.prototype._configureIsPremiumUpsellVisible=function(){this.itemSet.peek().content();this._storageOptionsProvider.isReady();this._isMobileAtStart||this._activatePremiumUpsell(this.item(),this.itemSet(),!1)};s.prototype._activatePremiumUpsell=function(e,t,n){var r=this;this._educationAndUpsells.getExistingUserTypeOfPremiumUpsell(e,t,n).then(function(e){if(null!=e&&!r._freOverride){r._premiumUpsellType=e;5!==e&&6!==e&&1!==e&&3!==e&&7!==e||r._isExistingUserPremiumUpsellEligible(!0)}})};s.prototype._configureIsFirstRunExperienceVisible=function(){var e=this;if(!this._isMobileAtStart&&!this.isFirstRunExperienceVisible.peek()){var t=this.item(),n=this.itemSet();n.content();n.isPlaceholder||this._educationAndUpsells.getIsNewUser(t,n).then(function(t){if(t){e._firstRunExperienceStatus(T.FirstRunExperienceStatus.visible);e._isGuidedTourVisible(!0);e._guidedTourUploadTimerStartTime=Date.now();e.resources.consumeAsync(B.resourceKey).then(function(t){t.setUploadTimerStartTime(e._guidedTourUploadTimerStartTime)})}})}};s.prototype._initializeFirstRunComponent=function(){var t=this;if(!this._hasUpsellBeenShownAlready.peek())if(this.isFirstRunExperienceVisible())this.resources.consumeAsync(N.resourceKey).then(function(){t._hasUpsellBeenShownAlready(!0);t._iamProvider.then(function(e){e.markMessagesRead(206,126)})});else if(this._isExistingUserPremiumUpsellEligible()){var i=this._bundleLoader.getBundleInfo(4).isLoaded();this._bundleLoader.loadNow("../../../controls/premiumIntro/PremiumIntro",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/premiumIntro/PremiumIntro"],t,n)}))}).then(function(e){if(i){t._isPremiumUpsellVisible(!0);t._hasUpsellBeenShownAlready(!0);t.premiumUpsellComponent({name:e.tagName,params:{upsellType:t._premiumUpsellType}});t._iamProvider.then(function(e){e.markMessagesReadIfPresent.apply(e,n.__spreadArrays(V.POSITIONING_MESSAGES,V.UPSELL_MESSAGES))})}})}};s.prototype._initializeUpsellComponent=function(){var t=this,n=this._bundleLoader.getBundleInfo(4).isLoaded();this.isUpsellApplicable()&&this.upsell()?this._bundleLoader.loadNow("../../../controls/firstRunBanner/FirstRunBanner",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/firstRunBanner/FirstRunBanner"],t,n)}))}).then(function(e){n&&t.upsellComponent({name:e.tagName,params:t.upsellParams})}):this.upsellComponent(null)};s.prototype._initializeGuidedTourComponent=function(){var t=this,n=this._bundleLoader.getBundleInfo(4).isLoaded();this._isGuidedTourVisible()?this._bundleLoader.loadNow("../../../controls/guidedTour/GuidedTour",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/guidedTour/GuidedTour"],t,n)}))}).then(function(){n&&t.resources.consumeAsync(B.resourceKey).then(function(e){e.getDismissedThisSession()||t.guidedTourComponent({specification:z.toSpecification(g.resourceKey,{onClose:t._onCloseGuidedTour.bind(t)})})})}):this.guidedTourComponent(null)};s.prototype._onCloseGuidedTour=function(){this.guidedTourComponent(null)};s.prototype._initializeMobileWebToAppUpsell=function(){if(this.isBannerApplicable&&!this.viewParams.peek().action)if(M.isFeatureEnabled(M.MobileWebToAppUpsellV2)){var e=this._dataStore.getValue("mobileWebToAppUpsellV2Displayed",te.default.local)||0,t=this._dataStore.getValue("mobileWebToAppUpsellV2LastDisplayed",te.default.local)||0,n=new Date;!this._mobileWebToAppUpsellDismissed.peek()&&e<3&&n.getTime()-t>1728e5&&this._initializeMobileWebToAppUpsellV2()}else this._initalizeSmartBanner()};s.prototype._initalizeSmartBanner=function(){var t=this,n=this._bundleLoader.getBundleInfo(1).isLoaded();this._bundleLoader.loadNow("../../../controls/smartBannerV2/SmartBannerV2",function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/smartBannerV2/SmartBannerV2"],t,n)}))}).then(function(e){if(n){t.smartBannerTagName=e.tagName;t.showSmartBanner(!0)}})};s.prototype._initializeMobileWebToAppUpsellV2=function(){if(this._bundleLoader.getBundleInfo(1).isLoaded()){this.mobileWebToAppUpsellV2={componentPath:"../../../controls/mobileWebToAppUpsellV2/ReactMobileWebToAppUpsellV2",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/mobileWebToAppUpsellV2/ReactMobileWebToAppUpsellV2"],t,n)}))},props:{upsellPresentationType:this.responsiveUI.compareSize(this.responsiveUI.formFactorSize(),"Small")>0?"Dialog":"Banner",upsellType:"ODCWebToAppUpsell",upsellDeviceType:this.platform.isAndroid?"Android":"IOS",onClose:this.onDismissMobileWebToAppUpsellV2.bind(this),onGetAppClick:this.onMobileWebToAppUpsellGetAppClick.bind(this),onOpenAppClick:this.onMobileWebToAppUpsellOpenAppClick.bind(this),openApp:!0}};this.showMobileWebToAppUpsellV2(!0);var t=this._dataStore.getValue("mobileWebToAppUpsellV2Displayed",te.default.local)||0;this._dataStore.setValue("mobileWebToAppUpsellV2Displayed",t+1,te.default.local);this._dataStore.setValue("mobileWebToAppUpsellV2LastDisplayed",(new Date).getTime(),te.default.local)}};s.prototype._getCommandBarSpecification=function(e){var t=this,n=z.toSpecification(q.resourceKey,{commandSet:e}),r=z.toSpecification(E.resourceKey,{props:{handleRenderComplete:function(e,t){t.unblockItemPageRender()}}});return this.observables.pureCompute(function(){return t.useItemsScope()?r:n})};s.prototype._makeGetItemShadowCall=function(){var e=this;this._bundleLoader.waitForPLT().then(function(){if(M.isFeatureEnabled(M.VroomGetItemShadowCall)){window&&window.requestIdleCallback&&window.requestIdleCallback(function(){e.isDisposed||e.resources.consumeAsync(C.resourceKey).then(function(t){var n=function(e,n){t.send({apiName:"getItemShadowCall."+n,path:e,requestType:"GET",useAuthorizationHeaders:!0})};e.resources.consumeAsync(u.graph).then(function(t){var r=e.item.peek(),i=e.urlDataSource.getKeyParams(r.key).id,s=t.getItemUrl(r,{useDirectEndpoint:!0}),o=t.getDriveUrl(r,{useDirectEndpoint:!0});if("root"===i){n(o+"/items/root","root");n(o+"/items/root/children?$top=30&expand=thumbnails&select=*,webDavUrl","children");n(o+"/items/root/children?$top=100&expand=thumbnails&select=*,webDavUrl","children.100")}else{n(s+"/children?$top=30&expand=thumbnails&select=*,webDavUrl","children");n(o+"/items/root/children?$top=100&expand=thumbnails&select=*,webDavUrl","children.100")}})})})}})};return s})(s.default);t.default=re});
define("odsp-next/pages/baseInnerPage/od/DataManagerPageViewModel",["require","exports","tslib","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../resources/DataSourceResourceKeys","../../files/od/ODFiles.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/async/Promise","../../../controls/error/Error","../../../providers/operation/MoveCopyItemsAsyncOperation.key","../../../models/operation/OperationBatch","../../../models/promiseTracker/PromiseTracker","@ms/odsp-utilities/lib/async/Semaphore","@ms/odsp-utilities/lib/string/StringHelper","../../../models/item/VirtualItemType","../../../models/item/ItemType","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../providers/dataManager/FocusItemHelper","../../../controls/userState/lockedPage/LockedPage","../../../bindings/contextMenu/ContextMenuBinding","../../../models/selection/ItemSetSelectionModel","../../../providers/item/ItemProvider","../../../dataSources/item/IGetWorkProgressContext","../../../dataSources/item/ITaskProgress","../../../controls/oneUp/OneUp.key","./BaseInnerPageViewModel","@ms/odsp-datasources/lib/Permissions","../../../providers/dataManager/mapper/IdentityDataManagerMapper","../../../bindings/component/ControlBinding","../../../models/selection/Selection.key","../../../controls/list/react/SelectionManager","../../../models/instrumentation/PageViewReporter"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var o=e.call(this,t,n)||this;o.addBindingHandlers({contextMenu:E.default,control:O.default});var a=o,f=a.resources,l=a.observables;o.loadingPromiseTracker=f.isExposed(r.promiseTracker)?f.consume(r.promiseTracker):f.expose(r.promiseTracker,new(o.managed(h.default)));o.itemProvider=f.consume(x.resourceKey);o._identityDataSource=f.consume(s.identity);o.viewParams=f.consume(r.viewParams);o.platform=f.consume(u.platformDetection);o.autoScrollEnabled=l.create(!1);o.autoScrollYPosition=l.create(0);o._createDataManager=o.createPureComputed(o._computeCreateDataManager);o._createDataManager.equalityComparer=y.objectStrictEquality;o.dataManager=o.createPureComputed(o._computeDataManager);o.dataManager.equalityComparer=y.objectStrictEquality;f.expose(i.sortManager,{updateSort:function(e,t){return o.dataManager.peek().updateSort(e,t)}});o.item=f.expose(r.currentItem,o.createPureComputed(o._computeItem));o.item.equalityComparer=y.objectStrictEquality;o.unmappedItemSet=o.createPureComputed(o._computeUnmappedItemSet);o.unmappedItemSet.equalityComparer=y.objectStrictEquality;o.dataManagerMapper=o.createObservable(new(o.managed(A.default))({itemSet:o.unmappedItemSet,requiredRange:o.createPureComputed(function(){return o.dataManager().requiredRange()})}));o.dataManagerMapper.equalityComparer=y.objectStrictEquality;o.createBackgroundComputed(o._computeUpdateDataManagerMapper);f.expose(r.currentDataManagerMapper,o.dataManagerMapper);o.itemSet=o.createPureComputed(o._computeItemSet);o.itemSet.equalityComparer=y.objectStrictEquality;f.expose(r.currentItemSet,o.itemSet);o.focusItem=o.createPureComputed(o._computeFocusItem);o.focusItem.equalityComparer=y.objectStrictEquality;o.error=f.expose(i.error,o.createPureComputed(o._computeError));o.error.equalityComparer=g.deepCompare;o.isOneUp=o.createPureComputed(o.computeIsOneUp);o._initializeRange();o._initializeLayoutType();f.expose(i.files.layoutType,o.layoutType);o._indexResolver=f.expose(r.selectionIndexResolver,{isItemResolved:function(e){return o.dataManager.peek().isItemResolved(e)},resolveIndices:function(e){return o.dataManager.peek().resolveIndices(e)}});o._initializeItemSelectionModel(t);o._initializeRedirectAction();o._initializeAutoExecuteAction();o.createBackgroundComputed(o._computeCollapseLeftNavOnViewChange);var c=f.consume(M.hasSelectionResourceKey);o.hasSelectionState=c;o.scope.attach(c.register(f.consume(_.hasSelectionResourceKey)));o.title=o.createPureComputed(o._computeTitle);o.isTitleVisible=o.createPureComputed(o._computeIsTitleVisible);o.createBackgroundComputed(o._computeSetDocumentTitle);var p=o._identityDataSource.getIdentity();p&&p.type!==L.IdentityType.anonymous&&o._checkForPendingOperations(T.IGetWorkProgressTypes.itemCopy);o._initializeFocusItemHelper();o.createBackgroundComputed(o._computeOneUpItemViewed).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}});o.isSmartBannerVisible=f.isExposed(i.base.isSmartBannerVisible)?f.consume(i.base.isSmartBannerVisible):f.expose(i.base.isSmartBannerVisible,l.create(!1));o._setUpSmartBanner();o._initializeOneUpParams();o.contentControl=o.createPureComputed(o._computeContentControl);o.hasContent=o.createPureComputed(function(){return!!o.contentControl()});var d=f.consume(D.typeResourceKey);o.scope.attach(new d({getCurrentPageName:o.computeCurrentPageName.bind(o),getFocusPageName:o.computeFocusPageName.bind(o),itemSet:o.itemSet,focusItem:o.focusItem,isOneUp:o.isOneUp}));return o}t.prototype.computeShouldSelectFocusItem=function(){return!this.isOneUp()&&this.dataManager().focusItemIndexInItemSet()>-1};t.prototype.computeReportPageView=function(){};t.prototype.computeCurrentPageName=function(){return"Default"};t.prototype.computeFocusPageName=function(){return"OneUp"};t.prototype.computeIsOneUp=function(){var e=this.focusItem(),t=(e||this.itemSet().item)(),n=!!this.error()||t.type===m.default.Error;return!(!this.urlDataSource.getFocusItemKey(this.viewParams())||!e||n||this.urlDataSource.getAutoActionType(this.viewParams()))};t.prototype.computeContentControl=function(){var e=this.error(),t=this.item();return t&&t.error&&4===t.error.type?O.toSpecification(w.resourceKey,this.getContentControlParams()):t&&t.error&&6===t.error.type?void 0:e?O.toSpecification(f.resourceKey,this._getErrorParams()()):void 0};t.prototype.getSelectionOptions=function(e){void 0===e&&(e={});return{}};t.prototype.computeDataManagerMapper=function(){return new(this.managed(A.default))({itemSet:this.unmappedItemSet,requiredRange:this.dataManager().requiredRange})};t.prototype.getContentControlParams=function(){var e={};this.getContentControlParams=function(){return e};return e};t.prototype._getErrorParams=function(){var e=this,t=this.observables.pureCompute(function(){return{error:e.error()}});this._getErrorParams=function(){return t};return t};t.prototype._computeUpdateDataManagerMapper=function(){this.dataManagerMapper(this.computeDataManagerMapper())};t.prototype._initializeFocusItemHelper=function(){var e=this;return new(this.managed(b.default))({focusItem:this.focusItem,canSelect:function(){return e.computeShouldSelectFocusItem()}})};t.prototype._setUpSmartBanner=function(){this.isBannerApplicable=!this.platform.isWinPhone&&(this.platform.isIOS||this.platform.isAndroid)};t.prototype._computeContentControl=function(){var e=!this.item().isPlaceholder&&this._redirectAction.isAvailable(),t=this.dataManager().isActive();if(!this.error()&&(!t||e)){return this.contentControl.peek()}return this.computeContentControl()};t.prototype._computeCreateDataManager=function(){var e=this.computeCreateDataManager();return e||this._createDataManager.peek()};t.prototype._computeDataManager=function(){var e=this._createDataManager(),t=this.dataManager.peek();t&&t.dispose();return e.call(this)};t.prototype._checkForPendingOperations=function(e){var n=this;return this.itemProvider.getWorkProgress({type:e}).then(function(e){if(e.progress){var r=new c.default;e.progress.map(function(e){if(e.status===N.ITaskStatuses[N.ITaskStatuses.InProgress]||e.status===N.ITaskStatuses[N.ITaskStatuses.NotStarted]){var i=n._extractCidFromResId(e.sourceResourceId),s=n._extractCidFromResId(e.targetResourceId);t._getWorkProgressQueue.enqueue(function(){var t,o,u={parentKey:n.urlDataSource.getKey((t={},t.id=e.sourceResourceId,t.cid=i,t))},f=n.itemProvider.getItem(u),c={parentKey:n.urlDataSource.getKey((o={},o.id=e.targetResourceId,o.cid=s,o))},h=n.itemProvider.getItem(c);return a.default.all([f,h]).then(function(t){if(t&&!(t&&t.length<2)){var i=t[0].item.peek(),o=t[1].item.peek();if(i&&o)return n.resources.consumeAsync(l.resourceKey).then(function(t){var n={items:[i],parentKey:o.parent.key,targetId:o.id,targetKey:o.key,cid:s,group:i.isGroup?1:0,isMove:!1},u=t.registerOperation(i,n,o,e.id,r);return t.handleMoveCopyAsyncItems(n,[u],e.id)})}})})}})}},function(e){})};t.prototype._extractCidFromResId=function(e){return e.split("!")[0]};t.prototype._computeTitle=function(){var e=this.itemSet().item();return e.displayName||e.name||""};t.prototype._computeIsTitleVisible=function(){var e=this.itemSet().item(),t=!1;switch(e.virtualItemType){case v.default.AlbumRoot:case v.default.Tag:case v.default.Album:t=!0}return(!!e.displayName||!!e.name)&&(!e.parent||t)};t.prototype._computeSetDocumentTitle=function(){var e=this.focusItem()&&this.focusItem()()||this.itemSet().item(),t=e.displayName||e.name||"";document.title=t?d.format(o.default.pageTitleFormat,t):o.default.pageTitleDefault};t.prototype._computeItemSet=function(){return this.dataManagerMapper().mappedItemSet()};t.prototype._computeUnmappedItemSet=function(){return this.dataManager().itemSet()};t.prototype._computeItem=function(){return this.dataManager().item()};t.prototype._computeFocusItem=function(){return this.dataManager().focusItem()};t.prototype._computeError=function(){return this.dataManager().error()};t.prototype._computeOneUpItemViewed=function(){if(this.isOneUp()&&this.focusItem()&&!this.focusItem()().isPlaceholder){var e=this.focusItem.peek().peek();if(e.type!==m.default.Media)return;this.itemProvider.updateViewCount({items:[e]})}};t.prototype._initializeRange=function(){var e=this,t=this.observables;this.listRange=t.create({start:0,end:0});this.listRange.equalityComparer=g.deepCompare;this.resources.expose(i.contentRange,this.listRange);this.focusRange=t.create({start:0,end:0});this.focusRange.equalityComparer=g.deepCompare;this.createBackgroundComputed(function(){var t;if(e.item().isPlaceholder)t={start:0,end:0};else if(e.isOneUp()){t=e.focusRange();e.focusItem.peek()||(t=e.dataManagerMapper.peek().mappedRequiredRange.peek())}else t=e.listRange();e.dataManagerMapper().mappedRequiredRange(t)})};t.prototype._initializeLayoutType=function(){var e=this;this.layoutType=this.createComputed({read:function(){return e.dataManager().layoutType()},write:function(t){return e.dataManager.peek().layoutType(t)},pure:!0})};t.prototype._computeCollapseLeftNavOnViewChange=function(){this.dataManager().queryType();this.isLeftNavUserExpanded(!1)};t.prototype._initializeItemSelectionModel=function(e){var t=this;void 0===e&&(e={});var n=this.getSelectionOptions(e),i=this.createObservable();this.createBackgroundComputed(function(){i(t.itemSet())});this.itemSelectionModel=this.resources.expose(r.itemsSelection,new(this.managed(S.default))({itemSet:i,mode:n.mode,maximumSelectedCount:n.maximumSelectedCount,canSelectItem:n.canSelectItem,indexResolver:this._indexResolver}))};t.prototype._initializeAutoExecuteAction=function(){this._autoExecuteAction=new(this.managed(this.actionMap.AutoExecuteAction))({focusItem:this.focusItem});this.createBackgroundComputed(this._computeAutoExecuteAction).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};t.prototype._initializeRedirectAction=function(){var e=this;this._redirectAction=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.createPureComputed(function(){return(e.focusItem()||e.itemSet().item)()}),itemSet:this.itemSet,preserveAction:!0,focusUrl:this.createPureComputed(function(){return!!e.urlDataSource.getAutoActionType(e.viewParams())||!!e.focusItem()}),ignoreHistory:!0,openLocal:!0});this.createBackgroundComputed(this._computeAttemptRedirectForItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};t.prototype._computeAutoExecuteAction=function(){var e=this.itemSet().item;if(e.peek().isPlaceholder||this._redirectAction.isAvailable())e();else{if(!this.focusItem()||this.dataManager().focusItemIndexInItemSet()>-1){var t=this._autoExecuteAction;t.isAvailable.peek()?t.execute(null).done(function(){},function(){}):t.isAvailable()}}};t.prototype._computeAttemptRedirectForItem=function(){var e=this.focusItem()||this.itemSet().item;if(e.peek().isPlaceholder||this.itemSet().item.peek().isPlaceholder){e();e!==this.itemSet().item&&this.itemSet().item()}else{var t=this._redirectAction;if(t.isAvailable.peek()){this.viewParams();this.async.setTimeout(function(){t.isAvailable.peek()&&t.execute(null).done(function(){},function(){})},0)}}};t.prototype._initializeOneUpParams=function(){var e,t=this;e=this.createPureComputed(function(){var n=t.focusItem();return!n&&e?e.peek():n});this.resources.expose(r.focusItem,e);this.isOneUpSlideshow=this.createObservable(!1);this.oneUpSpecification=O.toSpecification(C.resourceKey,{requiredRange:this.focusRange,isSlideshow:this.isOneUpSlideshow})};t.MAX_CONCURRENT_GET_WORK_PROGRESS=4;t._getWorkProgressQueue=new p.default(t.MAX_CONCURRENT_GET_WORK_PROGRESS);return t})(k.default);t.default=P});
define("odsp-next/controls/error/Error",["require","exports","./Error.html","./ErrorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","ODCFiles_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-error",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-error",template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/error/Error.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>'});
define("odsp-next/controls/error/ErrorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../dataSources/item/ItemDataSource.resx","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/string/StringHelper","../detailsPane/IsDetailsPaneExpanded","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../providers/error/ErrorProvider","../../resources/ControlResourceKeys","../../actions/vault/VaultActionType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,h=t.error;r._navigation=r.resources.consume(f.navigation);r._actionMap=r.resources.consume(c.actionMap.optional);var p,v,m,g,y,b,w=r.resources.consume(l.resourceKey);r.errorClassName="od-Error-imageTag";if(d(h)){p=h.errorTitle;v=h.errorCode;m=h.errorDetailedText;g=h.errorDetailedHtml;y=h.correlationId;b=w.getAction(h)}else h.message&&(m=h.message);p||(p=i.default.DefaultTitle);r.errorTitle=p;r.errorDetailedText=m;r.errorHtml=g;r.errorCode=v;m||g||(m=i.default.DefaultSubText);r.errorDetailedText=m;r.showAction=!!b&&!b.hideButton&&!t.hideAction;if(b){r.actionText=b.text;r.actionUrl=b.url}r.showErrorCode=v&&r.errorTitle===i.default.DefaultTitle;if(r.showErrorCode){s.default.log(h,"ServerError",""+v);r.errorCodeText=u.format(i.default.errorCodeText,v)}else r.errorCodeText="";r.correlationIdText=y?u.format(i.default.errorCorrelationIdText,y):"";if("accessremoved"===v){r.isAccessRemoved=!0;r.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")}else{r.isAccessRemoved=!1;r.imageUrl=r._getRandomImage()}if(d(h)&&h.actionUrl&&161===h.errorCode){r.resources.consume(a.resourceKey)(!1);r.actionText=i.default.UnlockButtonText;r.errorDetailedText=i.default.UnlockRequiredErrorText;r.errorCodeText="";r.errorTitle=i.default.UnlockRequiredErrorTitle;r.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg");r.errorClassName="od-Error-vaultImage";o.Engagement.logData({name:"Vault.Bookmarked.Loaded"})}return r}t.prototype.onButtonClick=function(){if(this.showAction)if(161===this.errorCode&&this._actionMap){o.Engagement.logData({name:"Vault.Bookmarked.Unlock"});new(this.managed(this._actionMap.VaultAction))({actionType:h.default.Unlock}).execute(null)}else{this._navigation.navigateTo(this.actionUrl)}return!1};t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error"+e+".svg")};return t})(r.default);t.default=p;function d(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}});
define("odsp-next/providers/error/ErrorProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../dataSources/item/ItemDataSource.resx","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this._errorDataSource=t.errorDataSource;this._defaultErrorAction={text:r.default.DefaultActionText,url:t.urlDataSource.getRootUrl()}}e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction};return e})();t.default=s;t.resourceKey=n.createResolvedResourceKey(e("module").id,s,{errorDataSource:i.error.optional,urlDataSource:i.url})});
define("odsp-next/providers/operation/MoveCopyItemsAsyncOperation.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./MoveCopyItemsAsyncOperation"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/dataManager/FocusItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.canSelect,s=t.focusItem;n._canSelect=r;n._focusItem=s;n._itemSelectionModel=n.resources.consume(i.itemsSelection);n._initializeSetFocusItemSelection();return n}t.prototype._initializeSetFocusItemSelection=function(){var e,t,n=this,r=this._itemSelectionModel;this.createBackgroundComputed(function(){var i=n._focusItem();if(i){if(n._canSelect()){r.setItemFocus(i);var s=n.observables.ignore(function(){return r.getItemKey(i)});r.setSelectedKeys([s]);e=!0}t||(e=r.selectedCount.peek()>0)}else if(t){r.setItemFocus(t);if(!0===e){s=n.observables.ignore(function(){return r.getItemKey(t)});r.setSelectedKeys([s]);e=void 0}else r.clear()}t=i}).extend({deferred:!0})};return t})(r.default);t.default=s});
define("odsp-next/controls/userState/lockedPage/LockedPage",["require","exports","./LockedPage.html","./LockedPageViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-locked-page",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-locked-page",template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/userState/lockedPage/LockedPage.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-LockedPage"></div>'});
define("odsp-next/controls/userState/lockedPage/LockedPageViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(s,t);function s(e,n){void 0===e&&(e={});void 0===n&&(n={});var r=t.call(this,e,n)||this;r._bundleLoader=r.resources.consume(u.bundleLoader);var s=r.resources.consume(o.promiseTracker);r._loaded=new i.default;s.registerPromise(r._loaded.getPromise());r.createComputed(r._compute);return r}s.prototype._compute=function(){var t=this;this._bundleLoader.getBundleInfo(2).isLoaded()&&r.default.resolve(new Promise(function(t,n){e(["../LockedHandler"],t,n)})).then(a.getDefaultExport).then(function(e){new(t.managed(e));t._loaded.complete()})};return s})(s.default);t.default=f});
define("odsp-next/models/selection/ItemSetSelectionModel",["require","exports","tslib","./BaseSelectionModel","../../providers/item/ItemProvider","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","knockout","./SelectionResolver","../item/ItemParentHelper","../item/RefreshMessageHelper","../../pages/files/UseItemCacheData.key","../store/ItemsStore","../../dataSources/item/ItemCacheToKOStoreDataSource.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=this,r={getItemKey:y};f.utils.extend(r,t||{});n=e.call(this,r)||this;var s=t.itemSet,u=void 0===s?n.resources.consume(o.currentItemSet):s,a=t.indexResolver,v=t.enableSelectionResolution,m=void 0===v||v;n.itemSet=u;n.itemProvider=n.resources.consume(i.resourceKey);n._enableSelectionResolution=m;n._itemParentHelper=n.resources.consume(c.resourceKey);n._refreshMessageHelper=n.resources.consume(h.resourceKey);n._currentItems=n.createPureComputed(n.computeCurrentItems);n._itemKey=n.createPureComputed(n._computeItemKey);n._useItemCacheData=n.resources.consume(p.resourceKey);n._itemsStore=n.resources.consume(d.resourceKey);n.createComputed(function(){n._onItemSetChanged(n._currentItems())});n.createComputed(n._computeResetSelectionOnKeyChange);a&&(n._selectionResolver=new(n.managed(l.default))({itemSet:n.itemSet,indexResolver:a}));n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource();n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate);return n}t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return s.default.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],r=this.getItems(),i=0;i<r.length;i++)(this.isIndexSelected(i)||!r[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var o={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new u.default,getItemPromises:[]};this.validateResolvedSelection(o);return o.signal.getPromise()}return s.default.wrap(this._unwrapSelection(this.selection.peek(),!0))};t.prototype.validateResolvedSelection=function(e){e.resolveAttempt++;if(e.resolveAttempt>4)e.signal.error({resultType:a.ResultTypeEnum.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();e.getItemPromises=[];e.missingRanges=t;e.pendingCount=t.length;if(0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}};t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),r=f.utils.extend({},e.itemSet.context);r.avoidSeamSnapping=!0;r.startIndex=n.start;r.endIndex=n.end;r.pageSize=n.end-n.start+1;e.getItemPromises.push(this.itemProvider.getItem(r).then(function(){e.pendingCount--;e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}};t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()};t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,r=this.getMissingIndicies();if(r.length){t=r[0];n=r[r.length-1];for(;t>-1;){var i=Math.min(n,t+1e3-1),s={start:t,end:i};e.push(s);t=i===n?-1:i+1}}return e};t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]};t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),r=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));r&&r.list?this.getItemKey=g.bind(void 0,r.list.isDocumentLibrary):this.getItemKey=y;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,s=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=s?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0;this.setItems(e,!1);this._refreshMessageHelper.clearRecentlyRefreshedItems()};t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey();this.clear(!0)};t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=this.peekUnwrapObservable(s);!o&&t||n.push(o)}return n};t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key};t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,r=e.selectedKOItemKeys();n<r.length;n++){var i=r[n];if(i){var s=this._itemsStore.getItem(i);t.push(this.getItemKey(s))}}0===t.length?this.clear():this.setSelectedKeys(t)}};t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(v.resourceKey.optional).then(function(e){e&&t(e)}):e._useItemCacheData()});return this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})};return t})(r.default);function g(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function y(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.default=m});
define("odsp-next/models/selection/BaseSelectionModel",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r._clearFocusIsUserInput=function(){r.isDisposed||(r._focusIsUserInput=!1)};r._keyForItem=new Map;r._focusIsUserInput=!1;r.mode=n.mode||0;r.maximumSelectedCount=n.maximumSelectedCount;r.getItemKey=n.getItemKey;r._canSelectItem=n.canSelectItem||o;r._selectionModelGroup=n.selectionModelGroup;r._allSelectables={};r._items=[];r.selectedCount=r.createObservable();r.selection=r.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});r.isAllSelected=r.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});r.focusedItem=r.createObservable();r.focusedItem.equalityComparer=i.objectStrictEquality;r.isActive=r.createObservable(!0);r.clear(!0);r._clearFocusIsUserInput=r.async.throttle(r._clearFocusIsUserInput,0,{trailing:!0});r._selectionModelId=""+ ++t._nextSelectionModelId;r._selectionModelGroup&&r._selectionModelGroup.registerSelectionModel(r,r._selectionModelId);return r}Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear();this._getItemKey=function(n){var r=t.get(n);if(!r){r=e(n);t.set(n,r)}return r}},enumerable:!0,configurable:!0});t.prototype.dispose=function(){e.prototype.dispose.call(this);this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId);this._allSelectables={};this._keyForItem.clear()};t.prototype.clear=function(e){this.isSelectedDefaultState=!1;this._keysExempt={};this._exemptCount=0;if(e){this._focusIndex=-1;this._anchorIndex=-1;this._anchorKey=null;this._focusIsUserInput=!1;this.focusedItem(null)}this.selection.removeAll();this.isAllSelected(!1);this._updateAllSelectables();this._updateSelectedCount()};t.prototype.setItems=function(e,t){this._items=e;this._selectableItems=this._items;t&&this.clear(!0);this._onItemsChanged(!0)};t.prototype.setAllFocusableItems=function(e){this._items=e;this._focusIndex=-1;this._onItemsChanged(!1)};t.prototype.getItems=function(){return this._items};t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)};t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)};t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,r=e;n<r.length;n++){var i=r[n],s=this._keyToIndex[i];if(s>=0){var o=this._items[s];if(this.canSelectItem(o)){this._keysExempt[i]=o;t.push(o)}}}this._exemptCount=t.length;this.isSelectedDefaultState=!1;this.selection(t);this._updateIsAllSelected();this._updateSelectedCount();this._updateAllSelectables();this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)};t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)};t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null};t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)};t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)};t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)};t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))};t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])};t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,r=void 0!==n&&n,i=t.isFocusInput,s=void 0===i||i,o=this.focusedItem.peek(),u=this.getItemKey(e),a=this._keyToIndex[u];this._focusIsUserInput=s;if(e!==o){var f=this.getItemKey(o);this._updateSelectable(f,{focusState:0,isFocused:!1})}if(a>=0){f=this.getItemKey(e);this._focusIndex=a;this.focusedItem(e||null);f&&this._updateSelectable(f,{focusState:s?2:1,isFocused:!0})}else this.focusedItem(null);if(!r){this._anchorIndex=a||-1;this._anchorKey=u}this._clearFocusIsUserInput()};t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={});this.setItemFocus(this._items[e],t)};t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),r=this._allSelectables[n];if(r&&r.length)for(var i=0;i<r.length;i++){var s=r[i];if(s.onInvoke)return s.onInvoke(e)}return!0};t.prototype.setIsActive=function(e){this.isActive(e)};t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var r=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),s=Math.max(r,i),o=[];if(t.length&&s>=0)for(var u=Math.min(r,i);u<=s;u++)o.push(t[u]);this._setItemsSelected(o,!0)}}};t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])};t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var r=n[t];this._canSelectItem(r)&&e.push(r)}this.selection(e);this._keysExempt={};this._exemptCount=0;this._updateIsAllSelected();this._updateAllSelectables();this._updateSelectedCount();this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()};t.prototype.registerSelectable=function(e,t){var n,r=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e);this._allSelectables[n]||(this._allSelectables[n]=[]);this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],s=this.focusedItem.peek()===i,o=s?this._focusIsUserInput?2:1:0,u=this.isItemSelected(i);this._updateSelectable(n,{focusState:o,isFocused:s,isSelected:u});return{dispose:function(){if(r._allSelectables&&r._allSelectables[n]){var e=r._allSelectables[n];if(1===e.length)delete r._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}};t.prototype.getFocusIndex=function(){return this._focusIndex};t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var r=t[n];this.isItemSelected(r)&&!this.getItemKey(r)&&e.push(n)}return e};t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup};t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)};t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null};t.prototype._setItemSelectedCore=function(e,t,n){var r=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return r.canSelectItem(e)}))return;1===this.mode&&t&&this.clear();this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var s=this.selection.peek(),o=[];o=t?s.concat([e]):s.filter(function(e){return r.getItemKey(e)!==i});this.selection(o);this._updateSelectable(i,{isSelected:this.isItemSelected(e)});this._exemptCount+=t?1:-1;this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};t.prototype._setItemsSelected=function(e,t){var n=this,r=this.selection.peek(),i=[],s=[],o=[];e.forEach(function(e){var r=n.getItemKey(e);if(r&&r in n._keyToIndex&&t!==n.isItemSelected(e)&&n.canSelectItem(e)){s.push(r);t&&o.push(e);n._keysExempt[r]?delete n._keysExempt[r]:n._keysExempt[r]=e}});i=t?r.concat(o):r.filter(function(e){return-1===s.indexOf(n.getItemKey(e))});this.selection(i);s.forEach(function(e){n._updateSelectable(e,{isSelected:t});n._exemptCount+=t?1:-1});this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)};t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)};t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];for(var o in t){var u=t[o],a=s[o];this.isObservable(a)&&a(u)}}};t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})};t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={};this._keyForItem.clear();e&&(this._selectableItemsMap={});var n=this._items,r=[],i=this.getItemKey(this.focusedItem.peek()),s=this._anchorKey;if(n){for(var o=0,u=function(u){var f=n[u],l=a.observables.ignore(function(){return t.getItemKey(f)});if(l){a._keyToIndex[l]=u;e&&(a._selectableItemsMap[l]=!0);i&&i===l&&(a._focusIndex=u);s&&s===l&&(a._anchorIndex=u)}if(a.isItemSelected(f)){if(a.onAddItem&&!1===a.onAddItem(f)){o++;a._keysExempt[l]=f;return"continue"}r.push(f)}},a=this,f=0;f<n.length;f++)u(f);this._exemptCount+=o;this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1;this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1});this.selection(r);this._updateIsAllSelected();this._updateSelectedCount()}};t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)};t._nextSelectionModelId=1;return t})(r.default);t.default=s;function o(e){return!0}});
define("odsp-next/models/selection/SelectionResolver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.itemSet,i=void 0===r?n.resources.consume(s.currentItemSet):r,o=t.indexResolver;n._itemSet=i;n._indexResolver=o;return n}t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):i.default.wrap()};t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)};t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)};t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=t[s];this._isItemResolved(o)||n.push(s)}return n};return t})(r.default);t.default=o});
define("odsp-next/models/item/RefreshMessageHelper",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._itemRefreshMessages={};this._itemKeysRefreshed=[]}e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null};e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var r=n[t];this._itemRefreshMessages[r.id]=r}};e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}};e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)};e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)};e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]};e.dependencies={};return e})();t.default=r;t.resourceKey=n.createResolvedResourceKey(e("module").id,r)});
define("odsp-next/pages/files/UseItemCacheData.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".useItemCacheData",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("odsp-next/dataSources/item/IGetWorkProgressContext",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IGetWorkProgressTypes={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}});
define("odsp-next/dataSources/item/ITaskProgress",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.notStarted=0]="notStarted";e[e.NotStarted=0]="NotStarted";e[e.inProgress=1]="inProgress";e[e.InProgress=1]="InProgress";e[e.completed=2]="completed";e[e.Completed=2]="Completed";e[e.cancelled=3]="cancelled";e[e.Cancelled=3]="Cancelled";e[e.failed=4]="failed";e[e.Failed=4]="Failed";e[e.unknown=5]="unknown";e[e.Unknown=5]="Unknown"})(t.ITaskStatuses||(t.ITaskStatuses={}))});
define("odsp-next/controls/oneUp/OneUp.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUp"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/pages/baseInnerPage/od/BaseInnerPageViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../utilities/browser/ResponsiveUI","../../../controls/detailsPane/IsDetailsPaneExpanded","../../../dataSources/url/PageType","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../models/selection/Selection.key","../../../utilities/browser/WebViewDetector","../../../resources/DataSourceResourceKeys","../../../pages/files/UseItemsScope.key","../../../pages/files/UseItemCacheData.key","../../../dataSources/url/QueryType","../../../models/itemsScope/ItemsScopeManager.key","../../../dataSources/item/od/ItemCacheToKOStoreDataSource.key","../../../models/itemsScope/ItemsScopeFeature.key","../../../dataSources/url/odc/UrlHelpers"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this,f=i.resources;i.actionMap=f.consume(s.actionMap);i.addPaddingBottom=i._exposeIfNeeded(o.base.addPaddingBottom,r.observable(!0));i.isScrollbarHidden=i._exposeIfNeeded(o.base.isScrollbarHidden,r.observable(!1));i.makeFlexBox=i._exposeIfNeeded(o.base.makeFlexBox,r.observable(!1));i.isTopBarHamburgerVisible=i._exposeIfNeeded(o.base.suiteNav.isTopBarHamburgerVisible,r.observable(!1));i.isTopBarVisible=i._exposeIfNeeded(o.base.suiteNav.isTopBarVisible,r.observable(!0));i.isTopBarVisible(!0);i.isLeftNavUserExpanded=i._exposeIfNeeded(o.base.leftNav.isLeftNavUserExpanded,r.observable(!1));i.isSuiteNavHamburgerVisible=i._exposeIfNeeded(o.base.suiteNav.isSuiteNavHamburgerVisible,r.observable(!1));i.supportHamburgerInSuiteNav=i._exposeIfNeeded(o.base.suiteNav.supportHamburgerInSuiteNav,!1);i.toggleIsLeftNavUserExpanded=i._exposeIfNeeded(o.base.leftNav.toggleIsLeftNavUserExpanded,function(){return null});i.hideLeftNav=i._exposeIfNeeded(o.base.leftNav.hideLeftNav,r.observable(!1));i.hideLeftNav(!1);i.isLeftNavVisible=i._exposeIfNeeded(o.base.leftNav.isLeftNavVisible,r.observable(!1));i.hasSelectionState=f.consume(h.hasSelectionResourceKey);i.pageType=f.consume(s.currentPage);i.isInfoPaneExpanded=f.consume(a.resourceKey);i.isRetrievingData=i._exposeIfNeeded(o.base.isRetrievingData,r.observable(!1));i.responsiveUI=f.consume(u.resourceKey);i.platform=f.consume(c.platformDetection);i.isCommandBarDarkTheme=i._exposeIfNeeded(o.base.commandBar.isDarkTheme,r.observable(!1));i.isOneUpForPhotosOnly=i._exposeIfNeeded(o.base.oneUpOverlay.isPhotosOnly,r.observable(!1));i.isSuiteNavHidden=i._exposeIfNeeded(o.base.suiteNav.isSuiteNavHidden,r.observable(!0));i.isSuiteNavHidden(p.isWebViewHosted()||p.isOneDriveWinApp());i.contextMenuHelper=i._exposeIfNeeded(o.base.contextMenuHelper,r.observable(null));i.viewParams=f.consume(s.viewParams);i.isSearchHidden=i._exposeIfNeeded(o.base.commandBar.isSearchHidden,r.observable(!1));i.isSearchHidden(p.isOneDriveWinApp());i.instrumentationProvider=f.consume(l.instrumentation);i.useItemsScope=f.expose(v.resourceKey,i.observables.pureCompute(i._computeUseItemsScope));i.useItemCacheData=f.expose(m.resourceKey,i.observables.pureCompute(i._computeUseItemCacheData));i.commandBar=i._exposeIfNeeded(o.base.commandBar.transclusionProvider,null);i.urlDataSource=f.consume(d.url);i._isItemsScopeEnabledInFilesPivot=f.consume(w.isItemsScopeEnabledInFilesPivotResourceKey.lazy);i._isItemsScopeEnabledInRecentPivot=f.consume(w.isItemsScopeEnabledInRecentPivotResourceKey.lazy);i._isItemsScopeEnabledInSharedPivot=f.consume(w.isItemsScopeEnabledInSharedPivotResourceKey.lazy);i._isItemsScopeEnabledInAllPhotosPivot=f.consume(w.isItemsScopeEnabledInAllPhotosPivotResourceKey.lazy);i._isItemsScopeEnabledInAllAlbumsPivot=f.consume(w.isItemsScopeEnabledInAllAlbumsPivotResourceKey.lazy);i._isItemsScopeEnabledInAllTagsPivot=f.consume(w.isItemsScopeEnabledInAllTagsPivotResourceKey.lazy);i._isItemsScopeEnabledInAllPhotosFilePicker=f.consume(w.isItemsScopeEnabledInAllPhotosFilePickerResourceKey.lazy);i._isItemsScopeEnabledInAllPlacesPivot=f.consume(w.isItemsScopeEnabledInAllPlacesPivotResourceKey.lazy);i._isItemsScopeEnabledInSingleAlbumView=f.consume(w.isItemsScopeEnabledInSingleAlbumViewResourceKey.lazy);i._isItemsScopeEnabledInSinglePlaceView=f.consume(w.isItemsScopeEnabledInSinglePlaceViewResourceKey.lazy);i._isItemsScopeEnabledInSingleTagView=f.consume(w.isItemsScopeEnabledInSingleTagViewResourceKey.lazy);i._isVroomEnabledInItemsScopeAllPhotos=i.resources.consume(w.isVroomEnabledInItemsScopeAllPhotosPivotResourceKey.lazy);i._isVroomEnabledInItemsScopeSingleTag=i.resources.consume(w.isVroomEnabledInItemsScopeSingleTagViewResourceKey.lazy);i._isVroomEnabledInItemsScopeSinglePlace=i.resources.consume(w.isVroomEnabledInItemsScopeSinglePlaceViewResourceKey.lazy);i.observables.backgroundCompute(i.computeReportPageView).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});i.commandBarTransclusionContentParams={provider:i.commandBar};i._initializeItemsScopeManager();i._initializeItemCacheToKOStoreDataSource();return i}t.prototype.computeReportPageView=function(){this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),name:this.computeCurrentPageName()})};t.prototype.computeCurrentPageName=function(){return f.default[this.pageType.peek()]};t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};t.prototype._computeUseItemsScope=function(){var e=this.viewParams();return this.urlDataSource.isCurrentQuery(g.default.Files,e)?this._isItemsScopeEnabledInFilesPivot():this.urlDataSource.isCurrentQuery(g.default.Recent,e)?this._isItemsScopeEnabledInRecentPivot():this.urlDataSource.isCurrentQuery(g.default.SharedWithMe,e)||this.urlDataSource.isCurrentQuery(g.default.SharedByMe,e)?this._isItemsScopeEnabledInSharedPivot():!(!E.isSingleAlbum(e)||!this._isItemsScopeEnabledInSingleAlbumView()||this.urlDataSource.isCurrentQuery(g.default.Search))||(!(!E.isSingleTag(e)||!this._isItemsScopeEnabledInSingleTagView())||(!(!E.isSinglePlace(e)||!this._isItemsScopeEnabledInSinglePlaceView())||(!(!E.isFilePickerAllPhotos(e)||!this._isItemsScopeEnabledInAllPhotosFilePicker())||(!(!E.isAllPlaces(e)||!this._isItemsScopeEnabledInAllPlacesPivot())||(!(!E.isAlbums(e)||!this._isItemsScopeEnabledInAllAlbumsPivot())||(!(!E.isAllTags(e)||!this._isItemsScopeEnabledInAllTagsPivot())||!(!E.isAllMyPhotos(e)||!this._isItemsScopeEnabledInAllPhotosPivot())))))))};t.prototype._computeUseItemCacheData=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return E.isFilePickerAllPhotos(e)?this._isItemsScopeEnabledInAllPhotosFilePicker()&&this._isVroomEnabledInItemsScopeAllPhotos():E.isSingleTag(e)?this._isVroomEnabledInItemsScopeSingleTag():E.isSinglePlace(e)?this._isVroomEnabledInItemsScopeSinglePlace():E.isAllMyPhotos(e)?this._isVroomEnabledInItemsScopeAllPhotos():t!==f.default.Photos&&this.useItemsScope()};t.prototype._initializeItemsScopeManager=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemsScope.peek()?e.resources.consumeAsync(y.resourceKey):e.useItemsScope()})};t.prototype._initializeItemCacheToKOStoreDataSource=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemCacheData.peek()&&e.resources.consumeAsync(b.resourceKey)})};return t})(i.default);t.default=S});
define("odsp-next/pages/files/UseItemsScope.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".useItemsScope",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("odsp-next/models/itemsScope/ItemsScopeManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeManager"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/dataManager/mapper/IdentityDataManagerMapper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.itemSet=t.itemSet;n.mappedItemSet=t.itemSet;n.mappedRequiredRange=t.requiredRange;n.refreshedItemSetFlag=n.createObservable(!1);return n}t.prototype.getOriginalItemIndexByMappedIndex=function(e){return e};t.prototype.getNewMappedIndexByOldIndex=function(e){return e};return t})(r.default);t.IdentityDataManagerMapper=i;t.default=i});
define("odsp-next/models/instrumentation/PageViewReporter",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._getCurrentPageName=t.getCurrentPageName;r._getFocusPageName=t.getFocusPageName||a;r._itemSet=t.itemSet;r._focusItem=t.focusItem;r._isOneUp=r.observables.wrap(t.isOneUp);r._instrumentationProvider=n.instrumentationProvider;r._viewParams=n.viewParams;r._initializeReportPageView();return r}t.prototype._initializeReportPageView=function(){var e=this;this.observables.backgroundCompute(function(){if(e._itemSet){var t=e._viewParams.peek();if(e._isOneUp()&&e._focusItem){i=(r=e._itemSet.peek()).item.peek();var n=e._focusItem();n&&(n.peek().isPlaceholder?n():e._instrumentationProvider.userViewPage({viewParams:t,item:n.peek(),name:e._getCurrentPageName({currentItem:i,viewParams:t})+"-"+e._getFocusPageName({currentItem:i,focusItem:n.peek(),viewParams:t})}))}else{var r,i;(i=(r=e._itemSet()).item.peek()).isPlaceholder?r.item():r.isPlaceholder?r.content():e._instrumentationProvider.userViewPage({viewParams:t,item:i,name:e._getCurrentPageName({currentItem:i,viewParams:t})})}}else{t=e._viewParams.peek();e._instrumentationProvider.userViewPage({viewParams:t,name:e._getCurrentPageName({viewParams:t})})}}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{instrumentationProvider:s.instrumentation,viewParams:i.viewParams});return t})(r.default);t.PageViewReporter=u;function a(){return"OneUp"}t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/dataManager/files/FilesDataManager",["require","exports","tslib","../DataManager","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../../dataSources/url/SearchTypeChecker","../../../controls/list/layouts/LayoutType","@ms/odsp-utilities/lib/async/Semaphore","../../../utilities/range/RangeHelper","./FilesDataManagerContextHelper","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._contextHelper=new(n.resources.injected(l.default));n._groupingType=n.createPureComputed(n._computeGroupingType,{deferEvaluation:!0});return n}t.prototype.resolveIndices=function(e){for(var t=this,n=new a.default(4),r=[],s=function(e){return function(){return t._resolveRange(e)}},o=0,u=f.createRanges(f.groupIndices(e,1e3));o<u.length;o++){var l=u[o];r.push(n.enqueue(s(l)))}return i.default.all(r).then(function(){})};t.prototype.amendCurrentContext=function(e){var t=this.itemSet.peek();t.schema.peek()&&t.schema.peek().length||(e.needSchema=!0)};t.prototype.getCurrentItemSetSync=function(e){return this.itemProvider.getItemSync(e)};t.prototype.getFocusItemSet=function(e){return this.getCurrentItemSet(e)};t.prototype.getCurrentItemSet=function(e){c.default.mark("DataManager.GetData.Started");return this.itemProvider.getItem(e)};t.prototype.computeCurrentContext=function(){var e,t=this.focusItemKey();t&&this.focusItemIndexInItemSet()<0&&(e=t);var n=this.requiredRange();return this._createGetItemContext(n,e)};t.prototype._computeGroupingType=function(){var e,t=this.queryType();if(o.isSearchType(t)||t===s.default.RecycleBin)e=0;else{switch(this.layoutType()){case u.Grid:case u.SingleAlbum:e=1;break;default:e=0}}return e};t.prototype._createGetItemContext=function(e,t){var n=this._contextHelper.getDefaultGetItemContext(this.viewParams());n.sortField=this.sortConfiguration().field;n.isAscending=this.sortConfiguration().isAscending;n.startIndex=e.start;n.endIndex=e.end;n.startKey=t;n.groupingType=this._groupingType();n.revision=this.referenceRevision();n.resultSetOptions=this.itemResultSetOptions;return n};t.prototype._resolveRange=function(e){var t=this._createGetItemContext(e);return this.getCurrentItemSet(t)};return t})(r.default);t.default=h});
define("odsp-next/providers/dataManager/DataManager",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../models/store/ItemsStore","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/logging/ErrorHelper","../../controls/list/layouts/LayoutType","../../dataSources/url/QueryType","../../dataSources/url/SearchTypeChecker","../../dataSources/url/PageType","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../dataSources/layout/ContentType","../../utilities/features/Features","../../dataSources/item/od/ItemCacheToKOStoreDataSource.key","../../pages/files/UseItemCacheData.key","../item/ItemProvider","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/performance/PerformanceCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k={timeout:0,method:"notifyWhenChangesStop"},L=w.isFeatureEnabled(w.CompactListViewInFiles),A=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.itemResultSetOptions,c=n,p=c.observables,d=c.resources;n.itemProvider=d.consume(x.resourceKey);n._itemsStore=d.consume(o.resourceKey);n.viewParams=d.consume(i.viewParams);n.urlDataSource=d.consume(u.url);n.platform=d.consume(f.platformDetection);n.navigation=d.consume(a.navigation);n.promiseTracker=d.consume(i.promiseTracker);n._loaderProvider=d.consume(s.bundleLoader);n.referenceItemSet=n._getReferenceItemSet();n.defaultLayoutType=b.GRID;n.itemResultSetOptions=r;n._pageType=d.consume(i.currentPage);n.useItemCacheData=d.consume(S.resourceKey);n.itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource();n._rumOneHelper=d.consume(l.rumOneHelper);n.isActive=p.pureCompute(n._computeIsActive);n.focusItemKey=p.pureCompute(n._computeFocusItemKey);n.currentItemKey=p.pureCompute(n._computeCurrentItemKey);n.itemSet=p.pureCompute(n._computeItemSet);n.itemSet.equalityComparer=T.objectStrictEquality;n.item=p.pureCompute(n._computeItem);n.item.equalityComparer=T.objectStrictEquality;n.error=p.create(null);var v=t.requiredPageType;n._requiredPageType=v;n._setupContextualQueryType();n.queryType=p.pureCompute(n._computeQueryType);n._layoutTypeTrigger=p.create({});n.layoutType=p.compute({read:n._computeLayoutType,write:n.updateLayoutType,deferEvaluation:!0,pure:!0});n._initializeRange();n.focusItemContext=p.pureCompute(n._computeFocusItemContext);n.focusItemContext.equalityComparer=h.deepCompare;n.focusItemIndexInItemSet=p.pureCompute(n._computeFocusItemIndexInItemSet);n.focusItemSet=p.pureCompute(n._computeFocusItemSet);n.focusItemSet.equalityComparer=T.objectStrictEquality;n.focusItem=p.pureCompute(n._computeFocusItem);n.focusItem.equalityComparer=T.objectStrictEquality;n._isFocusItemResolved=p.pureCompute(n._computeIsFocusItemResolved);n._temporarySortConfiguration=p.create();n._temporarySortConfiguration.equalityComparer=h.deepCompare;n.sortConfiguration=p.compute({read:n._computeSortConfiguration,write:n._temporarySortConfiguration,deferEvaluation:!0,pure:!0});n.sortConfiguration.equalityComparer=h.deepCompare;p.backgroundCompute(n._computeClearSortConfiguration);n.currentContext=p.pureCompute(n.computeCurrentContext);n.currentContext.equalityComparer=h.deepCompare;p.backgroundCompute(n._computeRefreshItemSet).extend({rateLimit:k});n.referenceRevision=p.pureCompute(n._computeReferenceRevision);return n}t.prototype.updateSort=function(e,t){this.sortConfiguration({field:e,isAscending:t})};t.prototype.getDefaultLayoutForView=function(){var e=this.queryType(),t=this.viewParams.peek(),n=this.urlDataSource.getLayoutContentType(t)||this._contextualQueryTypes[v.default[e]]||this.defaultLayoutType,r=m.isSearchType(e)&&this._pageType.peek()===g.default.Photos;return this.currentItemKey()===this.urlDataSource.getRootItemKey(v.default.SharedWithMe)?d.SharedGrid:n===b.GRID||r?d.Grid:n===b.LIST?d.Details:n===b.COMPACT_LIST?L?d.CompactDetails:d.Details:n===b.PHOTO?d.SingleAlbum:n===b.ALLPHOTOS?d.AllPhotos:d.Details};t.prototype.isItemResolved=function(e){return e&&e.peek()&&!e.peek().isPlaceholder};t.prototype.resolveIndices=function(e){return c.default.wrap()};t.prototype.getContextualQueryType=function(e){return this._contextualQueryTypes[v.default[e]]};t.prototype.computeFocusContext=function(e){var t=this.urlDataSource.getKeyParams(e);return{parentKey:e,ownerId:this.urlDataSource.getOwnerId(e),queryType:this.urlDataSource.getQueryType(t),resultSetOptions:this.itemResultSetOptions,ignoreChildren:!0}};t.prototype.computeCurrentContext=function(){return null};t.prototype.getFocusItemSetSync=function(e){return this.itemProvider.getItemSync(e)};t.prototype.getCurrentItemSetSync=function(e){return null};t.prototype.getFocusItemSet=function(e){return this.itemProvider.getItem(e)};t.prototype.getCurrentItemSet=function(e){return c.default.wrap(null)};t.prototype.updateLayoutType=function(e,t){var n;switch(e){case d.Details:n=b.LIST;break;case d.CompactDetails:n=b.COMPACT_LIST;break;case d.SingleAlbum:n=b.PHOTO;break;case d.AllPhotos:n=b.ALLPHOTOS;break;default:n=b.GRID}t=t||this.queryType.peek();if(this.currentItemKey.peek()!==this.urlDataSource.getRootItemKey(v.default.SharedWithMe)){this._contextualQueryTypes[v.default[t]]=n;this._itemsStore.setValue(this._getSetViewLocalStorageKey(),this._contextualQueryTypes,y.default.local);this._layoutTypeTrigger({})}};t.prototype.amendCurrentContext=function(e){};t.prototype._computeItemSet=function(){var e=this.itemCacheToKOStoreDataSource();if(e)return e.koItemSet();var t=h.deepCopy(this.currentContext());if(this.isActive.peek()){return this.getCurrentItemSetSync(t)}return this.itemSet.peek()};t.prototype._computeItem=function(){var e=this.itemCacheToKOStoreDataSource();if(e)return e.koItem();var t=this.itemSet();return t&&t.item()};t.prototype._computeRefreshItemSet=function(){var e=this;if(!this.useItemCacheData()){var t,n=this.itemSet(),r=h.deepCopy(this.currentContext()),i=n.item.peek();r.skipInMemoryCache=i.key!==this._lastRequestKey;this._lastRequestKey=i.key;(r.revision||i.vault&&i.vault.isLocked)&&(r.skipCache=!0);this.amendCurrentContext(r);if(this.isActive.peek())if(i.isPlaceholder&&!this._isFocusItemResolved()){var s=h.deepCopy(this.focusItemContext());t=this.getFocusItemSet(s)}else t=this.getCurrentItemSet(r);else t=null;var o=this.urlDataSource.getKeyParams(i.key),u=this.urlDataSource.getQueryType(o),a=this.urlDataSource.getPageType(this.viewParams.peek()),f=this.focusItem.peek()?g.default[g.default.OneUp]:(g.default[a]||"Default")+"-"+(v.default[u]||"Default");this._getItemPromise=t;if(this._getItemPromise){this.promiseTracker.registerPromise(t);this.error(null);this.trackPromise(t.then(function(n){if(t===e._getItemPromise){e._getItemPromise=null;C.default.mark("DataManager.GetData.Done")}},function(t){t.errorTitle||p.default.log(t);c.default.isCanceled(t)||e.error(t)}).then(function(){e.async.setTimeout(function(){e._loaderProvider.pageLoaded(f);e._rumOneHelper.logRUMOneForListView(C.default.now())},0)}))}}};t.prototype._computeFocusItemContext=function(){var e=this.focusItemKey();return e?this.computeFocusContext(e):null};t.prototype._computeLayoutType=function(){this._layoutTypeTrigger();return this.getDefaultLayoutForView()};t.prototype._computeReferenceRevision=function(){var e=this.referenceItemSet(),t=e&&e.item&&this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t&&t().revision||0};t.prototype._computeSortConfiguration=function(){var e=this._temporarySortConfiguration();if(e)return e;this.queryType();return{}};t.prototype._computeClearSortConfiguration=function(){this.currentItemKey();this._temporarySortConfiguration(void 0)};t.prototype._computeQueryType=function(){var e=this.referenceItemSet(),t=e&&e.item||this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t?t().isPlaceholder?this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(t().key)):t().queryType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(this.currentItemKey()))};t.prototype._getSetViewLocalStorageKey=function(){return"OneDrive.Web.Files.FilesQueryType."+this.urlDataSource.getOwnerId("",this.viewParams.peek())};t.prototype._setupContextualQueryType=function(){var e,t;this._contextualQueryTypes=n.__assign(n.__assign(((e={})[v.default[v.default.Photos]]=b.GRID,e[v.default[v.default.AllMyPhotos]]=b.ALLPHOTOS,e[v.default[v.default.Files]]=b.GRID,e[v.default[v.default.Search]]=b.GRID,e[v.default[v.default.Recent]]=b.LIST,e[v.default[v.default.RecycleBin]]=b.LIST,e),this._itemsStore.getValue(this._getSetViewLocalStorageKey(),y.default.local)||{}),((t={})[v.default[v.default.SharedWithMe]]=b.GRID,t))};t.prototype._computeFocusItemKey=function(){return this.urlDataSource.getFocusItemKey(this.viewParams())};t.prototype._computeCurrentItemKey=function(){return this.urlDataSource.getCurrentItemKey(this.viewParams())};t.prototype._computeFocusItemIndexInItemSet=function(){var e=this.focusItemContext();if(e)for(var t=this.referenceItemSet(),n=t&&t.content(),r=n&&n.items||[],i=0,s=Object.keys(r);i<s.length;i++){var o=s[i],u=Number(o),a=r[u],f=a&&a.peek();if(f&&this.urlDataSource.areKeysEqual(f.key,e.parentKey))return u}return-1};t.prototype._computeFocusItem=function(){if(!this.isActive())return this.focusItem.peek();var e=this.focusItemSet();if(e){var t=this.focusItemIndexInItemSet();if(t>-1){var n=e&&e.content();return(n&&n.items||[])[t]}return e.item}return null};t.prototype._computeFocusItemSet=function(){if(!this.isActive())return this.focusItemSet.peek();var e=this.focusItemContext();if(e){return this.focusItemIndexInItemSet()>-1?this.referenceItemSet():this.getFocusItemSetSync(e)}};t.prototype._computeIsFocusItemResolved=function(){var e=this.focusItem();return!e||!e().isPlaceholder&&!e().error};t.prototype._initializeRange=function(){this.requiredRange=r.observable({start:0,end:0});this.requiredRange.equalityComparer=h.deepCompare};t.prototype._computeIsActive=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return!this._requiredPageType||t===this._requiredPageType};t.prototype._getReferenceItemSet=function(){var e,t=this,n=this.observables,r=n.create();n.backgroundCompute(function(){t.itemSet();e&&t.async.clearImmediate(e);e=t.async.setImmediate(function(){r(t.itemSet.peek());e=void 0})});return n.pureCompute(function(){var e=r();if(!e||e.item().key===t.currentItemKey())return e})};t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();this.observables.backgroundCompute(function(){e.useItemCacheData.peek()?e.resources.consumeAsync(E.resourceKey).then(function(e){t(e)}):e.useItemCacheData()});return this.observables.pureCompute(function(){return e.useItemCacheData()?t():void 0})};return t})(N.default);t.default=A});
define("odsp-next/utilities/range/RangeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupIndices=function(e,t){void 0===t&&(t=1e3);for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=n[n.length-1];if(!o||s-o[0]>=t){o=[];n.push(o)}o.push(s)}return n};t.createRanges=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],s={start:i[0],end:i[i.length-1]+1};t.push(s)}return t}});
define("odsp-next/pages/files/od/DragAndDropHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/quota/QuotaStatus","../../../controls/dragAndDrop/DropHelper","../../base/od/BasePageViewModel","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/DataSourceResourceKeys","../../../controls/dragAndDrop/dragAndDropHint/DragAndDropHint","../../../controls/dragAndDrop/DragAndDrop.resx","../../../controls/dragAndDrop/targetFrame/DragAndDropTargetFrame","../../../bindings/component/ControlBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dropHelper=n.resources.consume(s.resourceKey);n._currentItem=n.resources.consume(u.currentItem);n._bundleLoader=n.resources.consume(a.bundleLoader);n._isDroppingTarget=n.createObservable(!1);n._quotaLoaded=n.createComputed(n._computeQuotaLoaded);n.events.on(window,o.DragAndDropEvents.onDragging,n._onDragging);n.events.on(window,o.DragAndDropEvents.onReceiveDrop,n._onReceiveDrop);n.events.on(window,o.DragAndDropEvents.onMayReceiveDrop,n._onMayReceiveDrop);n._platform=n.resources.consume(d.platformDetection);n.hintComponent=n.createComputed(n._computeHintComponent);n.decorationComponent=n.createComputed(n._computeDecorationComponent);n._vaultDataSource=n.createObservable();n.resources.consumeAsync(f.vault).then(function(e){return n._vaultDataSource(e)});return n}t.prototype.getOptions=function(){return{mayReceiveDrop:this._onMayReceiveDrop,isDragging:this._onDragging,receiveDrop:this._onReceiveDrop}};t.prototype._onDragging=function(e){var t=e.args,n=t&&t.value,r=t&&t.data,i=n&&r&&0===r.dragData.type;this._isDroppingTarget(i)};t.prototype._onReceiveDrop=function(e){var t=e.args;return this._dropHelper.processDrop(t,this._currentItem.peek())};t.prototype._onMayReceiveDrop=function(e){var t=e.args,n=this._currentItem&&this._currentItem.peek&&this._currentItem.peek();return n&&t&&0===t.type?{targetName:n.name}:null};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(2).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(a.quota));return!0}return!1};t.prototype._computeHintComponent=function(){return this._quotaLoaded()&&this._userStateProvider.status()>=i.default.full||this._platform.isWinAppWipEnabled?null:{name:l.default.tagName,params:{}}};t.prototype._computeDecorationComponent=function(){if(!this._isDroppingTarget())return null;var e={message:c.default.TargetFrameMessage,isError:!1};this._platform.isWinAppWipEnabled&&(e={message:c.default.winAppWipEnabled,isError:!0});if(this._quotaLoaded()){if(2===this._userStateProvider.accountState())return null;var t=this._userStateProvider.status();t===i.default.outOfSpace?e={message:c.default.genericOverlayMessage,isError:!0}:t===i.default.full?e={message:c.default.fullOverlayMessage,isError:!0}:t===i.default.overQuota&&(e={message:c.default.exceedingOverlayMessage,isError:!0});var n=this._currentItem();if(n&&n.vault&&!n.vault.isLocked){var r=this._vaultDataSource(),s=r&&r.isVaultOpen();s&&s()&&r.isOverQuota()&&(e={message:c.default.exceedingVaultOverlayMessage,isError:!0})}}return p.toSpecification(h.resourceKey,e)};return t})(r.default);t.default=v});
define("odsp-next/controls/dragAndDrop/DropHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../providers/operator/UploadOperator.key","../../providers/moveCopy/MoveCopyProvider.key","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../providers/item/ShortcutProvider","@ms/odsp-utilities/lib/uri/Uri","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../../pages/files/spo/itemSetProjections/PostUploadProjectionHelper","@ms/odsp-utilities/lib/resources/Resources","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateItemMetadataOperatorTypeResourceKey=new E.ResourceKey({name:e("module").id+".updateItemMetadataOperator",loader:new E.AliasResourceLoader(function(){return i.default.resolve(new Promise(function(t,n){e(["../../providers/operator/UpdateItemMetadataOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var x=(function(e){n.__extends(E,e);function E(t,n){var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._shortcutProvider=n.shortcutProvider;r._currentItemSet=n.currentItemSet;r._engagement=n.engagement;r._postUploadProjectionHelper=n.postUploadProjectionHelper;r._isItemsScopeEnabled=n.isItemsScopeEnabled;r._wip=n.wip;r._quotaBlockAction=new(r.managed(n.actionMap.QuotaBlockAction))({isDragAndDrop:!0});return r}E.prototype.processDrop=function(e,n,r,i){var m=this;void 0===r&&(r=!1);void 0===i&&(i=!1);if(!n||!n.isDropEnabled||n===e.item||this._wip&&this._wip.isWIPEnabled())return!1;var y=this._engagement;if(0===e.type){y.logData({name:"DragAndDropEvent",isIntentional:!0});if(this._quotaBlockAction.isAvailable.peek()){this._quotaBlockAction.execute(null);return!1}var b=this._currentItemSet.peek();this.resources.consumeAsync(c.asyncTypeResourceKey).then(function(t){var i=new t({files:e.files,parentItem:n,itemSet:b,wasDragAndDropped:!0,type:e.uploadType,metadata:e.metadata,skipInvalidation:!!r});m.trackPromise(i.start());return i.wait()}).done(null,function(e){p.default.log(e)});return!0}if(1===e.type){var w=e.metadata&&e.metadata.group;if(w){this._resolveSelection(e).then(function(c){var h=new f.Action({name:"DragChangeGroup",pageType:u.default[m._urlDataSource.getPageType()],queryType:a.default[m._urlDataSource.getQueryType()]}),g=[];r&&c.forEach(function(e){var t=d.deepCopy(e);if(!i){var n=v.deserializeQuery(t.key);n.group=w.groupingId;t.key=v.serializeQuery(n)}t.state.upload.status=1;t.properties[w.fieldSchema.Name]=w.groupingId;g.push(m.createObservable(t));e.state.removing=!0});m.resources.consumeAsync(t.updateItemMetadataOperatorTypeResourceKey).then(function(t){var i=new t({items:c,metadata:e.metadata,parentItem:n,skipInvalidation:r,onComplete:function(t){if(t){r&&m._postUploadProjectionHelper.updateItemSetPostUpload(e.itemSet,g,w);m._isItemsScopeEnabled()&&w.itemKey&&m.resources.consumeAsync(l.itemInvalidator).then(function(e){e.invalidateGroups([w.itemKey])})}else alert("failure updating metadata")}});m.trackPromise(i.start());return i.wait()}).done(void 0,function(e){return p.default.log(e)});var y={},b={count:c.length};if(1===c.length){y.fileType=s.default[c[0].type];y.extension=c[0].extension||""}h.end({resultType:o.ResultTypeEnum.Success,extraData:y,extraMetrics:b})}).done(null,function(e){return p.default.log(e)});return!0}if(e.itemSet.item.peek().key===n.key)return!1;this._resolveSelection(e).then(function(t){t=t.filter(function(e){return e!==n});var r=new f.Action({name:"DragMove",pageType:u.default[m._urlDataSource.getPageType()],queryType:a.default[m._urlDataSource.getQueryType()]});return m.resources.consumeAsync(h.resourceKey).then(function(r){return r.copyItems({items:t,parentKey:e.item.parentKey,targetId:n.id,targetKey:n.key,cid:m._urlDataSource.getOwnerId(),group:n.isGroup?1:0,isAsync:!1,isMove:!0})}).then(function(){var e={},i={count:t.length};m._isItemsScopeEnabled()&&m.resources.consumeAsync(l.itemInvalidator).then(function(e){e.invalidateItems(n.key)});if(1===t.length){e.fileType=s.default[t[0].type];e.extension=t[0].extension||""}r.end({resultType:o.ResultTypeEnum.Success,extraData:e,extraMetrics:i})},function(){r.end({resultType:o.ResultTypeEnum.Failure})})}).done(null,function(e){return p.default.log(e)});return!0}if(3===e.type&&this._shortcutProvider){y.logData({name:"Link.DragAndDrop.Drop",isIntentional:!0});var E=e.links.split("\n");(E=E.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var t=new g.default(e).getHost()+".url";m._shortcutProvider.createShortcut(n.key,t,e)});return!0}};E.prototype._resolveSelection=function(e){return e.selection?e.selection.resolve().then(function(t){t&&0!==t.length||(t=[e.item]);return t}):i.default.wrap([e.item])};E.dependencies=n.__assign(n.__assign({},r.default.dependencies),{shortcutProvider:m.resourceKey.optional,urlDataSource:l.url,wip:l.wip.optional,actionMap:b.actionMap,currentItemSet:b.currentItemSet,postUploadProjectionHelper:w.resourceKey,engagement:y.resourceKey,isItemsScopeEnabled:S.isItemsScopeEnabledResourceKey.lazy});return E})(r.default);t.DropHelper=x;t.resourceKey=E.createResolvedResourceKey(e("module").id,x);t.default=x});
define("odsp-next/providers/moveCopy/MoveCopyProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./MoveCopyProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/item/ShortcutProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","./ItemProvider","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;return r}t.prototype.createShortcut=function(e,t,n){var r=this;return this._getShortcutDataSource().then(function(r){return r.createShortcut(e,t,n)}).then(function(t){r._itemProvider.invalidateItem(e);return t})};t.prototype.getShortcutTargetData=function(e,t){return this._getShortcutDataSource().then(function(n){return n.getShortcutTargetData(e,t)})};t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})};t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(o.default.Recent),startIndex:0,endIndex:5,queryType:o.default.Recent};return this._itemProvider.getItem(e)};t.prototype._getShortcutDataSource=function(){return this.resources.consumeAsync(i.shortcut)};return t})(r.default);t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a,n.__assign(n.__assign({},r.default.dependencies),{urlDataSource:i.url,itemProvider:s.resourceKey}))});
define("odsp-next/pages/files/spo/itemSetProjections/PostUploadProjectionHelper",["require","exports","../../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._itemProvider=t.itemProvider}e.prototype.updateItemSetPostUpload=function(e,t,n){if(e&&t&&t.length>0){var r=e.item.peek().key,i=this._itemProvider.computeProjectedItemSet(r+"&state=postUpload",e,{parentKey:r,itemSetProjections:{PostUpload:{uploadedItems:t,group:n}}},!0);i&&e.content({groupings:i.content.peek().groupings,items:i.content.peek().items})}};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{itemProvider:n.resourceKey})});
define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame",["require","exports","./DragAndDropTargetFrame.html","./DragAndDropTargetFrameViewModel","../../../bindings/component/ControlBinding","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-drag-and-drop-target-frame",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrame.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:overlayComponent--\x3e<div class="od-DragAndDropTargetFrame" data-bind="css:classes"><div class="od-DragAndDropTargetFrame-header"><div class="od-DragAndDropTargetFrame-message" data-bind="text:message"></div></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/dragAndDrop/targetFrame/DragAndDropTargetFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../overlays/Overlay","../DragAndDrop.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,o=t.message,u=void 0===o?s.default.TargetFrameMessage:o;r.message=u;r.overlayComponent={name:i.default.tagName,params:{animation:{afterAdd:1,beforeRemove:300}}};r.classes={"od-DragAndDropTargetFrame-hasError":t.isError};return r}return t})(r.default);t.default=o});
define("odsp-next/pages/files/od/FilesCommandSet",["require","exports","tslib","knockout","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../../actions/sort/od/SortActionMode","../../../controls/commands/SeparatorCommandSet","../../../utilities/icons/Icon","../../../controls/list/layouts/LayoutType","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../resources/ControlResourceKeys","../../../controls/commands/Command","../../../controls/commands/Commands.resx","../../../controls/commands/PLTCommands.resx","../../../controls/itemsScope/spo/SortCommand.resx","../../../controls/commands/SortMenuBuilder","../../../controls/detailsPane/DetailsPaneId","../../../controls/detailsPane/IsDetailsPaneExpanded","../FilterMenuBuilder","../FilterDateMenuBuilder","../../../controls/operation/commands/OperationCommandBuilder","../../../utilities/features/Features","../FilesCommandSetHelper","../../../utilities/icons/IconHelper","../../../actions/vault/VaultActionType","../../../controls/sharing/share/odc/CommandBuilder","../../../controls/vault/VaultCommandBuilder","../../../controls/sharing/share/odc/Share.key","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=E.isFeatureEnabled(E.CompactListViewInFiles),M=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isOneDriveWinApp=A.isOneDriveWinApp();n._parentNavigation=!t.disableParentNavigation;n.filesCommandSetHelper=new(n.managed(S.default))({showLabels:n.responsiveUI.showLabels});n.hideNewShareCommands=n.createPureComputed(n._computeHideNewShareCommands);n.hideOldShareCommand=n.createPureComputed(n._computeHideOldShareCommand);n.buildCommands();return n}t.prototype.buildCommands=function(){var e=this,t=this.actionMap,o=this.resources,A=o.consume(l.currentItemSet),M=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOpenInOfficeOnlineText()}),_=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOpenInOfficeClientText()}),D=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOfficeIcon()}),P=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOfficeClass()}),H=[new(this.managed(c.CommandViewModel))({text:h.default.Create,tooltip:h.default.CreateCommandTooltip,icon:new u.default("Add"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,automationId:"create",children:r.observableArray([new(this.managed(c.CommandViewModel))({text:h.default.CreateFolder,iconUrl:x.getIconUrl(o,"folder",16),hasLineBreakAfter:!0,action:new(this.managed(t.CreateFolderAction)),automationId:"createFolder"}),new(this.managed(c.CommandViewModel))({text:h.default.CreateWord,iconUrl:x.getIconUrl(o,"docx",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.Word})}),new(this.managed(c.CommandViewModel))({text:h.default.CreateExcel,iconUrl:x.getIconUrl(o,"xlsx",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.Excel})}),new(this.managed(c.CommandViewModel))({text:h.default.CreatePowerPoint,iconUrl:x.getIconUrl(o,"pptx",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.PowerPoint})}),new(this.managed(c.CommandViewModel))({text:h.default.CreateOneNote,iconUrl:x.getIconUrl(o,"onetoc",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.OneNote})}),new(this.managed(c.CommandViewModel))({text:E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)?h.default.CreateForm:h.default.CreateExcelSurvey,iconUrl:E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)?x.getIconUrl(o,"form",16):x.getIconUrl(o,"xlsx",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.ExcelSurvey})}),new(this.managed(c.CommandViewModel))({text:h.default.CreateText,iconUrl:x.getIconUrl(o,"txt",16),action:new(this.managed(t.CreateDocumentAction))({docType:i.DocumentType.Text}),automationId:"createTextFile"})])}),new(this.managed(c.CommandViewModel))({text:h.default.Upload,tooltip:h.default.UploadCommandTooltip,icon:new u.default("Upload"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,children:r.observableArray([new(this.managed(c.CommandViewModel))({text:h.default.UploadFile,collapsedText:r.observable(h.default.Upload),action:new(this.managed(t.UploadAction))({uploadProcessorType:f.UploadProcessorType.Html5file})}),new(this.managed(c.CommandViewModel))({text:h.default.UploadFolder,action:new(this.managed(t.UploadAction))({uploadProcessorType:f.UploadProcessorType.Folder})})])}),new(this.managed(c.CommandViewModel))({text:h.default.survey,icon:D,classSuffix:P,renderLabel:2,requiredChildren:1,children:r.observableArray([new(this.managed(c.CommandViewModel))({text:h.default.shareSurvey,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.SurveyAction))({actionType:1})}),new(this.managed(c.CommandViewModel))({text:h.default.viewSurvey,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.SurveyAction))({actionType:2})}),new(this.managed(c.CommandViewModel))({text:h.default.editSurvey,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.SurveyAction))({actionType:3})})])}),new(this.managed(c.CommandViewModel))({text:h.default.selectItems,renderLabel:2,icon:new u.default("CheckboxComposite"),action:new(this.managed(t.ToggleSelectionModeAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Open,icon:D,classSuffix:P,renderLabel:2,requiredChildren:1,location:3,children:r.observableArray([new(this.managed(c.CommandViewModel))({text:M,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.OpenInOfficeOnlineAction))}),new(this.managed(c.CommandViewModel))({text:_,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.OpenInOfficeClientAction))}),new(this.managed(c.CommandViewModel))({text:h.default.OpenInBrowser,renderLabel:2,icon:new u.default("PDF"),action:new(this.managed(t.OpenPdfInBrowserAction))})])}),new(this.managed(c.CommandViewModel))({text:M,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.OpenInOfficeOnlineAction)),location:8}),new(this.managed(c.CommandViewModel))({text:_,renderLabel:2,icon:D,classSuffix:P,action:new(this.managed(t.OpenInOfficeClientAction)),location:8}),new(this.managed(c.CommandViewModel))({text:h.default.OpenInBrowser,renderLabel:2,icon:new u.default("PDF"),action:new(this.managed(t.OpenPdfInBrowserAction)),location:8}),new(this.managed(c.CommandViewModel))({text:h.default.OpenInTextEditor,renderLabel:2,icon:new u.default("Edit"),automationId:"textEditor",action:new(this.managed(t.OpenInTextEditorAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Edit,icon:new u.default("EditNote"),renderLabel:2,action:new(this.managed(t.RedeemAction))}),new(this.managed(c.CommandViewModel))({text:h.default.SaveViewCommit,icon:new u.default("Save"),automationId:"save",renderLabel:2,action:new(this.managed(t.SaveAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Preview,location:8,renderLabel:2,engagementName:"Preview",action:new(this.managed(t.PreviewAction))({})})],B=[new(this.managed(N.default))({renderLabel:2,mode:L.Mode.share,itemsKey:k.shareResourceKey,text:h.default.Share,tooltip:h.default.ShareCommandTooltipV3,icon:new u.default("Share"),keys:["S"],engagementName:"newShareCommand",isHidden:this.hideNewShareCommands}).command,new(this.managed(c.CommandViewModel))({text:h.default.Share,isHidden:this.hideOldShareCommand,tooltip:h.default.ShareCommandTooltipV3,renderLabel:2,icon:new u.default("Share"),automationId:"share",keys:["S"],action:E.isFeatureEnabled(E.SharingDialogRedux)?new(this.managed(t.ShareByLinkAction)):new(this.managed(t.ShareAction))({activeTab:2})})];H=H.concat(B);var j=[new(this.managed(c.CommandViewModel))({text:h.default.unlock,renderLabel:2,icon:new u.default("OneDriveFileVault"),action:new(this.managed(t.VaultAction))({actionType:T.default.Unlock})}),new(this.managed(c.CommandViewModel))({text:h.default.LockVault,renderLabel:2,isHidden:this.selectionModeOff,icon:new u.default("OneDriveFileVault"),action:new(this.managed(t.VaultAction))({actionType:T.default.Lock})}),new(this.managed(c.CommandViewModel))({text:h.default.Download,renderLabel:2,icon:new u.default("Download"),action:new(this.managed(t.DownloadAction))}),new(this.managed(c.CommandViewModel))({text:h.default.emptyRecycleBin,renderLabel:2,icon:new u.default("Delete"),action:new(this.managed(t.EmptyRecycleBinAction))}),new(this.managed(c.CommandViewModel))({text:h.default.DeleteItem,renderLabel:2,icon:new u.default("Delete"),action:new(this.managed(t.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(c.CommandViewModel))({text:h.default.CreateMountPoint,renderLabel:2,icon:new u.default("FabricFolderLink"),action:new(this.managed(t.CreateMountPointAction)),automationId:"createMountPoint",resources:o}),new(this.managed(c.CommandViewModel))({text:h.default.RemoveMountPoint,renderLabel:2,icon:new u.default("Cancel"),action:new(this.managed(t.RemoveMountPointAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Remove,icon:new u.default("Cancel"),renderLabel:2,action:new(this.managed(t.RemoveFromRecentAction))}),new(this.managed(c.CommandViewModel))({text:h.default.restoreAll,renderLabel:2,icon:new u.default("RevToggleKey"),action:new(this.managed(t.RestoreAllAction))}),new(this.managed(c.CommandViewModel))({text:h.default.ShowVaultFiles,renderLabel:2,icon:new u.default("OneDriveFileVault"),action:new(this.managed(t.VaultAction))({actionType:T.default.ShowFiles})}),new(this.managed(c.CommandViewModel))({text:h.default.restore,renderLabel:2,icon:new u.default("RevToggleKey"),action:new(this.managed(t.RestoreAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Move,renderLabel:2,icon:new u.default("FabricMovetoFolder"),action:new(this.managed(t.LaunchMoveCopyPanelAction))({isMove:!0})}),new(this.managed(c.CommandViewModel))({text:h.default.Copy,renderLabel:2,icon:new u.default("Copy"),automationId:"copy",action:new(this.managed(t.LaunchMoveCopyPanelAction))({isMove:!1})}),new(this.managed(c.CommandViewModel))({text:h.default.MoveExisting,renderLabel:2,icon:new u.default("FabricMovetoFolder"),isHidden:this.selectionModeOn,action:new(this.managed(t.AddToFolderAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Rename,renderLabel:2,icon:new u.default("Edit"),action:new(this.managed(t.RenameAction)),keys:["F2"],automationId:"rename"})],F=[new(this.managed(c.CommandViewModel))({text:h.default.addToSharedList,renderLabel:2,icon:new u.default("Add"),action:new(this.managed(t.AddToSharedListAction))}),new(this.managed(c.CommandViewModel))({text:h.default.removeFromSharedList,renderLabel:2,icon:new u.default("Cancel"),action:new(this.managed(t.RemoveFromSharedListAction))}),new(this.managed(c.CommandViewModel))({text:h.default.Play,renderLabel:2,icon:new u.default("Play"),action:new(this.managed(t.PlayAudioAction))}),new(this.managed(c.CommandViewModel))({text:h.default.createAlbumFromFolder,renderLabel:2,icon:new u.default("Picture"),action:new(this.managed(t.CreateAlbumFromFolderAction))}),new(this.managed(c.CommandViewModel))({text:h.default.AddToAlbum,renderLabel:2,icon:new u.default("Photo2Add"),action:new(this.managed(t.AddToAlbumAction))}),new(this.managed(c.CommandViewModel))({text:h.default.addAsCover,renderLabel:2,icon:new u.default("Picture"),action:new(this.managed(t.AddCoverPhotoAction))}),new(this.managed(c.CommandViewModel))({text:h.default.removeAsCover,renderLabel:2,icon:new u.default("Picture"),action:new(this.managed(t.RemoveCoverPhotoAction))}),new(this.managed(c.CommandViewModel))({text:h.default.editTags,renderLabel:2,icon:new u.default("Tag"),keys:["T"],action:E.isFeatureEnabled(E.EnableNewDetailsPane)?new(this.managed(t.ShowTagsEditorAction)):new(this.managed(t.EditTagsAction))}),new(this.managed(c.CommandViewModel))({text:h.default.rotate,renderLabel:2,icon:new u.default("rotate"),action:new(this.managed(t.RotateAction))}),new(this.managed(c.CommandViewModel))({text:h.default.OrderPrints,icon:new u.default("Print"),renderLabel:2,action:new(this.managed(t.OrderPrintsAction))}),new(this.managed(c.CommandViewModel))({text:h.default.addToBundle,icon:new u.default("Add"),renderLabel:2,action:new(this.managed(t.AddToBundleAction))({})}),new(this.managed(c.CommandViewModel))({text:h.default.removeFromBundle,icon:new u.default("Cancel"),renderLabel:2,action:new(this.managed(t.RemoveFromBundleAction))({})}),new(this.managed(c.CommandViewModel))({text:h.default.Embed,icon:new u.default("Embed"),renderLabel:2,automationId:"embed",action:new(this.managed(t.EmbedAction))}),new(this.managed(c.CommandViewModel))({text:h.default.versionHistory,icon:new u.default("StackIndicator"),renderLabel:2,action:new(this.managed(t.ShowVersionHistoryAction))({})}),new(this.managed(c.CommandViewModel))({text:E.isFeatureEnabled(E.UseNewReportAbuseDialog)?h.default.reportAConcern:h.default.reportAbuse,icon:new u.default("EditNote"),renderLabel:2,action:new(this.managed(t.ReportAbuseAction))({})}),new(this.managed(c.CommandViewModel))({text:h.default.requestReview,icon:new u.default("EditNote"),renderLabel:2,action:new(this.managed(t.RequestReviewAction))({})}),new(this.managed(c.CommandViewModel))({text:h.default.viewInFolder,iconUrl:x.getIconUrl(o,"folder",16),action:new(this.managed(t.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),this.overflowHostCommand,new(this.managed(w.default))({renderLabel:2}).command],I=[new(this.managed(c.CommandViewModel))({text:d.default.SortAscending,isToggleable:!0,action:new(this.managed(t.OneDriveSortAction))({mode:s.default.Order,ascending:!0})}),new(this.managed(c.CommandViewModel))({text:d.default.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(t.OneDriveSortAction))({mode:s.default.Order,ascending:!1})})],q=[new(this.managed(c.CommandViewModel))({text:h.default.Rearrange,isToggleable:!1,hasLineBreakAfter:!0,action:new(this.managed(t.RearrangeAction))({})}),new(this.managed(c.CommandViewModel))({text:h.default.SaveSortOrder,isToggleable:!1,action:new(this.managed(t.SaveSortOrderAction))})],R=new(this.managed(v.default))({currentItemSet:A,itemsToAppend:this._isOneDriveWinApp?I:n.__spreadArrays(I,q)}),U=new(this.managed(c.CommandViewModel))({text:d.default.Sort,renderLabel:2,icon:new u.default("SortLines"),isHidden:this.selectionModeOn,requiredChildren:1,children:R.sortItems,location:4}),z=r.observable(!1),W=new(this.managed(y.default))({showCurrentView:z}),X=new(this.managed(c.CommandViewModel))({text:h.default.Type,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return e.responsiveUI.showLabels()?void 0:new u.default("Filter")}),isCurrentView:z,requiredChildren:1,children:W&&W.filterItems}),V=r.observable(!1),$=new(this.managed(b.default))({showCurrentView:V}),J=new(this.managed(c.CommandViewModel))({text:h.default.date,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return e.responsiveUI.showLabels()?void 0:new u.default("Clock")}),isCurrentView:V,requiredChildren:1,children:$&&$.filterItems});H.push(X);H.push(J);var K=this.createPureComputed(function(){return e.filesCommandSetHelper.showSelectionActionText()}),Q=new(this.managed(c.CommandViewModel))({text:h.default.ViewList,tooltip:h.default.ViewListCommandTooltip,icon:new u.default(S.default.detailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:a.Details}),automationId:"switchLayout",engagementName:"ViewList"}),G=new(this.managed(c.CommandViewModel))({text:h.default.ViewCompactList,tooltip:h.default.ViewCompactListCommandTooltip,icon:new u.default(S.default.compactDetailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:a.CompactDetails}),automationId:"switchLayout",engagementName:"ViewCompactList"}),Y=new(this.managed(c.CommandViewModel))({text:h.default.ViewGrid,tooltip:h.default.ViewGridCommandTooltip,icon:new u.default(S.default.gridIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:a.Grid}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),Z=new(this.managed(c.CommandViewModel))({text:h.default.ViewPhoto,tooltip:h.default.ViewPhotoCommandTooltip,icon:new u.default(S.default.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(t.ToggleListLayoutAction))({layoutType:a.SingleAlbum}),automationId:"switchLayout",location:4,engagementName:"ViewPhoto"}),ee=new(this.managed(c.CommandViewModel))({renderLabel:0,icon:this.createComputed(function(){return e.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:r.observableArray(n.__spreadArrays([Q],O?[G]:[],[Y],[Z])),automationId:"switchLayoutSwitcher",text:h.default.Views,tooltip:h.default.ViewsCommandTooltip}),te=new(this.managed(C.default))({selectionModeOn:this.selectionModeOn,location:4,commandName:h.default.Vault,commandTooltip:h.default.VaultCommandTooltip,actionMap:t}).command,ne=new(this.managed(c.CommandViewModel))({text:K,tooltip:h.default.showSelection,isHidden:this.selectionModeOff,icon:new u.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(t.ShowSelectionAction)),keys:["CtrlD","MetaD"],automationId:"deselectAll"}),re=o.consume(m.resourceKey),ie=o.consume(g.resourceKey),se=new(this.managed(c.CommandViewModel))({text:h.default.Details,tooltip:p.default.DetailsPane,icon:new u.default("Info"),location:12,action:new(this.managed(t.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:re,ariaExpanded:ie,renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"}),oe=new(this.managed(c.CommandViewModel))({location:0,action:new(this.managed(t.OpenAction))({openRelation:3}),keys:["AltUp"]}),ue=new(this.managed(c.CommandViewModel))({location:0,action:new(this.managed(t.ShowKeyboardMapAction)),keys:["Shift/"]}),ae=new(this.managed(c.CommandViewModel))({location:0,action:new(this.managed(t.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]}),fe=new(this.managed(c.CommandViewModel))({location:0,action:new(this.managed(t.SelectAllAction)),keys:["CtrlA","MetaA"]}),le=[H,j,F,n.__spreadArrays([te,U],[ee],[ne,se],this._parentNavigation?[oe]:[],[ue,ae,fe])].map(function(t){return e.createObservable(t)});this.commandSets(le)};t.prototype._computeHideNewShareCommands=function(){return!E.isFeatureEnabled(E.UseNewShareDialog)||this._isOneDriveWinApp&&!E.isFeatureEnabled(E.UseNewShareDialogForWinApp)||this.vaultItemSelected()};t.prototype._computeHideOldShareCommand=function(){return E.isFeatureEnabled(E.UseNewShareDialog)&&(!this._isOneDriveWinApp||E.isFeatureEnabled(E.UseNewShareDialogForWinApp))&&!this.vaultItemSelected()};return t})(o.default);t.default=M});
define("odsp-next/controls/commands/SeparatorCommandSet",["require","exports","tslib","./BaseCommandSet","../../resources/ControlResourceKeys","../list/react/SelectionManager"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r.selection=r.resources.consume(i.itemsSelection);r.actionMap=r.resources.consume(i.actionMap);r._isSelectionModal=r.resources.consume(s.isSelectionModalResourceKey);r.commandSets=r.createObservable([]);r.selectionModeOn=r.createPureComputed(r._computeSelectionModeOn);r.selectionModeOff=r.createPureComputed(r._computeSelectionModeOff);r.multipleSelected=r.createPureComputed(r._computeMultipleSelected);r.vaultItemSelected=r.createPureComputed(r._computeVaultItemSelected);var o=r.createPureComputed(r._computeCommands);r.createComputed(function(){var e;(e=r.commands).splice.apply(e,n.__spreadArrays([0,r.commands.peek().length],o()))});r.createComputed(r._computeSeparators).extend({rateLimit:0});return r}t.prototype._computeCommands=function(){var e=this.commandSets()||[];return[].concat.apply([],e.map(function(e){return e()}))};t.prototype._computeSeparators=function(){this.selection.selection();var e=this.commandSets();if(e.length){for(var t=!1,n=[],r=0,i=e;r<i.length;r++){for(var s=(0,i[r])(),o=!1,u=0,a=s.length-1;a>=0&&u<2;a--){if((c=s[a])&&c.isVisible.peek()){c.hasLineBreakAfter(!o);if(!o){o=!0;n.push(c)}u++}}u>1&&(t=!0)}if(!t)for(var f=0,l=n;f<l.length;f++){var c;(c=l[f]).hasLineBreakAfter(!1)}}};t.prototype._computeSelectionModeOn=function(){return this.selection&&this.selection.selection().length>0||this._isSelectionModal()};t.prototype._computeSelectionModeOff=function(){return!this.selectionModeOn()};t.prototype._computeMultipleSelected=function(){return this.selection.selection().length>1};t.prototype._computeVaultItemSelected=function(){for(var e=0,t=this.selection.selection();e<t.length;e++){if(t[e].peek().vault)return!0}return!1};return t})(r.default);t.default=o});
define("odsp-next/controls/commands/SortMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./CommandViewModel","knockout","../../actions/sort/od/OneDriveSortAction","../../actions/sort/od/SortActionMode"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.sortItems=s.observableArray();n._commands=[];var r=t.itemsToAppend,a=t.currentItemSet;n.createComputed(function(){n._commands.map(function(e){return e.dispose()});n._commands=[];var e=a(),t=e.schema()||[];if(0!==t.length||!e.isPlaceholder){var s=t.filter(function(e){return!(!e.sortable||!e.name)}),f=[];s.length>0&&(f=s.map(function(e,t,s){var a=new(n.managed(i.default))({text:e.name,isToggleable:!0,action:new(n.managed(o.default))({mode:u.default.Column,column:e}),hasLineBreakAfter:r&&t===s.length-1});n._commands.push(a);return a}).concat(r||[]));n.sortItems(f)}});return n}return t})(r.default);t.default=a});
define("odsp-next/pages/files/FilterMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../controls/commands/CommandViewModel","knockout","../../resources/ControlResourceKeys","../../controls/commands/Commands.resx","../../utilities/icons/Icon","../../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._filterTypes=[{type:f.SearchFilterType.all,icon:void 0},{type:f.SearchFilterType.photos,icon:new a.default("Picture")},{type:f.SearchFilterType.documents,icon:new a.default("Documentation")},{type:f.SearchFilterType.music,icon:new a.default("MusicInCollection")},{type:f.SearchFilterType.folders,icon:new a.default("Folder")}];n._actionMap=n.resources.consume(o.actionMap);n.filterItems=s.observableArray();for(var r=[],l=0,c=n._filterTypes;l<c.length;l++){var h=c[l];r.push(new i.default({text:u.default[f.SearchFilterType[h.type].replace(/(\w)(\w*)/g,function(e,t,n){return t.toUpperCase()+n.toLowerCase()})],isToggleable:!0,icon:h.icon,action:new(n.managed(n._actionMap.FilterSearchAction))({filter:h.type,showCurrentView:t.showCurrentView}),hasLineBreakAfter:!1}))}n.filterItems(r);return n}return t})(r.default);t.default=l});
define("odsp-next/pages/files/FilterDateMenuBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../controls/commands/CommandViewModel","knockout","../../resources/ControlResourceKeys","../../controls/commands/Commands.resx","../../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(o.actionMap);n.filterItems=s.observableArray();for(var r=[],f=0,l=Object.keys(a.SearchFilterDateType).filter(function(e){return isNaN(parseInt(e,10))});f<l.length;f++){var c=l[f];r.push(new i.default({text:u.default[c],isToggleable:!0,action:new(n.managed(n._actionMap.FilterSearchByDateAction))({filter:a.SearchFilterDateType[c],showCurrentView:t.showCurrentView}),hasLineBreakAfter:!1}))}n.filterItems(r);return n}return t})(r.default);t.default=f});
define("odsp-next/controls/operation/commands/OperationCommandBuilder",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../commands/Command","../monitor/OperationMonitor.key","../../../providers/operation/OperationProvider","../../../models/operation/OperationState","../../../models/operation/OperationType","../../../utilities/icons/Icon","../strings/OperationStringMappings","@ms/odsp-shared/lib/utilities/knockout/Renderers","../../../resources/ControlResourceKeys","../../commands/Commands.resx","knockout","../SuppressOperationUI.key","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,u=i.observables;r._operationProvider=s.consume(o.resourceKey);r._actionMap=s.consume(h.actionMap);r._completedOperations=u.createArray();r._currentOperations=u.createArray();r._autoDismissPayload=u.pureCompute(r._computeAutoDismissPayload);var a=t.suppressNotifications,f=void 0!==a&&a;r._suppressNotifications=f;r._operationHidden=r.resources.consume(v.resourceKey.optional);r._initializeCurrentOperation();r._showOperationsAction=new(r.managed(r._actionMap.ShowOperationsAction));r._initializeCommand(t);var l=n.openCommandExtenders,c=void 0===l?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:l,p=n.cleanupOperationsExtenders,d=void 0===p?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:p;u.backgroundCompute(r._computeOpenCommand).extend(c);u.backgroundCompute(r._computeCleanupOperationsOnClose).extend(d);return r}t.prototype._computeOpenCommand=function(){this._completedOperations().length&&this.command.isOpen(!0)};t.prototype._computeCleanupOperationsOnClose=function(){this.command.isOpen()||this.command.action.isToggled()||this.command.action.isExecuting()||d.computedContext.isInitial()||this._operationProvider.cleanup(!0)};t.prototype._initializeCurrentOperation=function(){var e=this,t=this._completedOperations,r=this._currentOperations;this._operationProvider.groups.map({mappingWithDisposeCallback:function(i){var s=e.createComputed(function(){var s=i.state(),o=!e._suppressNotifications&&!i.visibility.peek();switch(s){case u.default.completed:case u.default.failed:case u.default.created:case u.default.started:r.remove(i)}switch(s){case u.default.completed:case u.default.failed:var a=[];o&&a.push(i);t.splice.apply(t,n.__spreadArrays([0,1/0],a));break;case u.default.started:e.async.setTimeout(function(){(function(e){var t=e.state.peek()===u.default.started,n=e.progress.current.peek()<(e.progress.maximum.peek()-e.progress.minimum.peek())/2;return t&&n})(i)&&o&&t.splice(0,1/0,i)},500)}switch(s){case u.default.created:case u.default.started:r.unshift(i)}});return{mappedValue:i.batch.id,dispose:function(){s.dispose();t.remove(i);r.remove(i)}}}})};t.prototype._initializeCommand=function(e){var t=e.renderLabel,n=void 0===t?0:t,r=e.isDisabled,s=void 0!==r&&r,o=this.observables,u=this._suppressNotifications?void 0:{control:this._getPayload(),autoDismiss:this._autoDismissPayload,announce:!0,timeout:4e3};this.command=new(this.managed(i.CommandViewModel))({action:this._showOperationsAction,renderLabel:n,isDisabled:o.create(s),icon:o.pureCompute(this._computeIcon),iconBadge:o.pureCompute(this._computeIconBadge),hasIconOnly:o.pureCompute(this._computeHasIconOnly),accessibleLabel:o.pureCompute(this._computeAccessibilityLabel),prependTextToAccessibleLabel:!0,text:o.pureCompute(this._computeText).extend({rateLimit:{timeout:10,method:"notifyWhenChangesStop"}}),payload:u,isHidden:this._operationHidden,hasDynamicText:!0,hasAnimation:!0,location:4,keys:["G"]})};t.prototype._computeText=function(){var e,t=this._currentOperations()[0];if(t&&t.visibility.peek()<1){var n=u.default[t.state()],r=a.default[t.type()],i=a.default[a.default.multiple],s=l.default.types[r],o=l.default.types[i],f=s.states[n],h=o.states[n],p=f&&(f.shortTitle||f.title)||h&&(h.shortTitle||h.title)||s.shortTitle||o.shortTitle,d={count:t.count,states:t.states,error:t.error,payloads:t.payloads,progress:t.progress};e=c.renderText({context:d,resources:this.resources},l.resolveEntry(p,d))}else e="";return e};t.prototype._computeIcon=function(){var e=this._operationProvider.overall.state();return e===u.default.created||e===u.default.started?new f.default("Sync","is-active"):new f.default("Sync")};t.prototype._computeIconBadge=function(){return this._operationProvider.overall.states().failed?new f.default("StatusErrorFull"):null};t.prototype._computeAccessibilityLabel=function(){return this._operationProvider.overall.states().failed?p.default.ViewActivitiesFailure:p.default.ViewActivities};t.prototype._getPayload=function(){var e=this,t=this.observables,n=t.create(),r=t.pureCompute(function(){return!!e._completedOperations().length});t.backgroundCompute(function(){r.peek()?e.trackPromise(e.resources.consumeAsync(s.resourceKey.local)).done(function(t){n(t.toSpecification({groups:e._completedOperations,expandGroups:!1,onViewAll:function(){return e._onViewAll()},showCloseAction:!1,onExecuteAction:function(){e.command.isOpen(!1)}}))}):r()});return n};t.prototype._onViewAll=function(){this._showOperationsAction.isAvailable.peek()&&this._showOperationsAction.execute(void 0).done()};t.prototype._computeAutoDismissPayload=function(){return this._completedOperations().every(function(e){return e.state.peek()!==u.default.failed})};t.prototype._computeHasIconOnly=function(){var e=this._currentOperations()[0];return!(e&&e.visibility.peek()<1)};return t})(r.default);t.OperationCommandBuilder=m;t.default=m});
define("odsp-next/controls/operation/monitor/OperationMonitor.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OperationMonitor"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/operation/strings/OperationStringMappings",["require","exports","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../monitor/OperationMonitor.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/dataSources/upload/Upload","../../../utilities/icons/Icon","../../itemLink/ItemLink","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../dataSources/vault/IVaultDataSource","../../../utilities/features/PLTFeatures"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.format,h=i.pluralSelect;function p(e){return c(r.default.percentProgressFormat,Math.round(e.progress.current()/e.progress.maximum()*100))}function d(e){return c(r.default.progressFormat,n.default.getDisplayString(e.progress.current()),n.default.getDisplayString(e.progress.maximum()))}var v=r.default.createdDescription,m=r.default.completedDescription;function g(e){return e.error()&&e.error().message||r.default.failedDescription}var y=r.default.canceledDescription;function b(e,t){return"function"==typeof e?e(t):e}t.resolveEntry=b;function w(e){return function(t){var n=t.error(),r=n&&n.payloads.upload&&n.payloads.upload.error;return b(r&&e[s.UploadErrorType[r.errorType]],r)||b(g,t)}}function E(e){return function(t){return c(e,n.default.getDisplayString(t.maxSizeInBytes),r.default.productName)}}var S,x=w({general:r.default.generalUploadErrorText,fileSize:E(r.default.fileSizeUploadErrorFormat),emptyFileOrFolder:r.default.emptyFileOrFolderUploadErrorFormat,emptyFileOrFolderForDocLib:(S=r.default.emptyFileOrFolderUploadErrorFormat2,function(e){return c(S,e.libraryName)}),overQuota:r.default.overQuotaCreateItemErrorText,overQuotaSharedFolder:r.default.overQuotaSharedFolderUploadErrorText,lockMismatch:r.default.lockMismatchUploadErrorText,accessDenied:r.default.accessDeniedUploadErrorText,unlockRequired:r.default.unlockRequiredUploadErrorText,insufficientVaultQuota:i.format(r.default.insufficientVaultQuotaErrorText,f.VAULT_FREE_FILE_LIMIT),invalidName:r.default.invalidNameUploadErrorText,pathTooLong:r.default.pathTooLongUploadErrorText,conflict:function(e){return l.isFeatureEnabled(l.EnableNewConflictUploadErrorStrings)&&e.supportsVersioning?e.allowRename?r.default.newConflictUploadErrorText:r.default.newConflictUploadWithoutRenameErrorText:e.allowRename?r.default.conflictUploadErrorText:r.default.conflictUploadWithoutRenameErrorText},folderUploadNotSupported:r.default.folderUploadNotSupported,versionMismatch:r.default.generalUploadErrorText,targetFolderMissing:r.default.targetFolderMissingUploadErrorText,authFailure:r.default.authFailureUploadErrorText,malwareDetected:r.default.malwareDetectedUploadErrorText,throttled:r.default.throttledUploadErrorText,disconnected:r.default.disconnectedUploadText}),T={general:r.default.generalSaveErrorText,fileSize:E(r.default.fileSizeSaveErrorFormat),emptyFileOrFolder:r.default.emptyFileSaveErrorFormat,overQuota:r.default.overQuotaCreateItemErrorText,overQuotaSharedFolder:r.default.overQuotaSharedFolderSaveErrorText,lockMismatch:r.default.generalSaveErrorText,accessDenied:r.default.accessDeniedSaveErrorText,invalidName:r.default.invalidNameUploadErrorText,pathTooLong:r.default.pathTooLongUploadErrorText,conflict:r.default.generalSaveErrorText,folderUploadNotSupported:r.default.generalSaveErrorText,versionMismatch:r.default.revisionConflictSaveErrorText},N={general:r.default.generalCreateItemErrorText,fileSize:E(r.default.fileSizeCreateItemErrorFormat),emptyFileOrFolder:r.default.generalCreateItemErrorText,overQuota:r.default.overQuotaCreateItemErrorText,overQuotaSharedFolder:r.default.overQuotaSharedFolderCreateItemErrorText,lockMismatch:r.default.generalCreateItemErrorText,accessDenied:r.default.accessDeniedCreateItemErrorText,invalidName:r.default.invalidNameUploadErrorText,pathTooLong:r.default.pathTooLongUploadErrorText,conflict:r.default.generalCreateItemErrorText,folderUploadNotSupported:r.default.generalCreateItemErrorText,versionMismatch:r.default.revisionConflictCreateItemErrorText},C=["","",r.default.moveCopySharingAccessWarning];function k(e){return"<span data-bind=\"component: { name: '"+u.default.tagName+"', params: { item: "+e+' } }"></span>'}function L(e){var t=e.payloads().shareItem;switch(t&&t.result){case 0:return r.default.completedDescription;case 1:return r.default.shareAccessRequestQueued;case-2:case-1:return r.default.shareAccessDenied;case void 0:return"";default:return g(e)}}function A(e){return e.states().completed?1===e.payloads().shareItem.result?r.default.shareAccessRequestQueued:e.payloads().shareItem.items.length>1?c(r.default.shareMultipleTitleFormat,e.payloads().shareItem.items.length):c(r.default.shareTitleFormat,a.default.encodeText(e.payloads().shareItem.items[0].name)):e.states().failed?M(e.payloads().shareItem.items.length,r.default.shareFailedTitleFormat,r.default.shareMultipleFailedTitleFormat):M(e.payloads().shareItem.items.length,r.default.variousSingleTitleFormat,r.default.variousMultipleTitleFormat)}function O(e){var t=e.states();return t.completed+t.created+t.started}function M(e,t,n,r){return c(h(e,t,n),e,r)}function _(e,t,n){return function(r){return M(O(r),e,t,n)}}function D(e,t,n){return function(r){return M(r.states().completed,e,t,n)}}function P(e,t,n){return function(r){return M(r.states().failed,e,t,n)}}function H(e,t,n){return function(r){return M(r.states().canceled,e,t,n)}}function B(e){return function(t){return c(e,a.default.encodeText(t.payloads().uploadItems.name))}}function j(e){return function(t){return c(e,a.default.encodeText(t.payloads().triggerFlow.flowDisplayName))}}function F(e){return function(t){return c(e,a.default.encodeText(t.payloads().createColumn.name))}}function I(e){return function(t){return c(e,a.default.encodeText(t.payloads().editColumn.name))}}function q(e){return function(t){return c(e,a.default.encodeText(t.payloads().deleteColumn.name))}}function R(e){return function(t){return c(e,a.default.encodeText(t.payloads().downloadAsZip.fileName))}}function U(e,t){return function(n){return h(n.count(),e,t)}}t.getOperationWarning=function(e){return e?C[e]:""};var z=_(r.default.variousSingleTitleFormat,r.default.variousMultipleTitleFormat),W=D(r.default.completedVariousSingleTitleFormat,r.default.completedVariousMultipleTitleFormat),X=P(r.default.failedVariousSingleTitleFormat,r.default.failedVariousMultipleTitleFormat),V=H(r.default.failedVariousSingleTitleFormat,r.default.failedVariousMultipleTitleFormat),$={types:{multiple:{title:z,shortTitle:z,states:{created:{description:v},started:{description:function(e){var t=e.progress.current();return c(r.default.progressFormat,t%1!=0?t.toFixed(2):t,e.progress.maximum())}},completed:{title:W,shortTitle:W,description:m},failed:{title:X,shortTitle:X,description:g},canceled:{title:V,shortTitle:V,description:y},expired:{description:""}}},renameItems:{title:_(r.default.startedRenameSingleShortTitleFormat,r.default.startedRenameMultipleShortTitleFormat),shortTitle:_(r.default.startedRenameSingleShortTitleFormat,r.default.startedRenameMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRenameSingleTitleFormat,r.default.completedRenameMultipleTitleFormat)},failed:{title:P(r.default.failedRenameSingleTitleFormat,r.default.failedRenameMultipleTitleFormat)},canceled:{title:H(r.default.failedRenameSingleTitleFormat,r.default.failedRenameMultipleTitleFormat)}}},requestReview:{title:_(r.default.startedRequestReviewSingleShortTitleFormat,r.default.startedRequestReviewMultipleShortTitleFormat),shortTitle:_(r.default.startedRequestReviewSingleShortTitleFormat,r.default.startedRequestReviewMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRequestReviewSingleTitleFormat,r.default.completedRequestReviewMultipleTitleFormat)},failed:{title:P(r.default.failedRequestReviewSingleTitleFormat,r.default.failedRequestReviewMultipleTitleFormat)},canceled:{title:H(r.default.failedRequestReviewSingleTitleFormat,r.default.failedRequestReviewMultipleTitleFormat)}}},reportAbuse:{title:function(e){return c(r.default.startedReportAbuseSingleShortTitleFormat,a.default.encodeText(e.payloads().reportAbuse.item.name))},shortTitle:r.default.startedReportAbuseSingleShortTitleFormat,states:{completed:{title:c(r.default.completedReportAbuseSingleTitleFormat,k("context.payloads().reportAbuse.item"))},failed:{title:c(r.default.failedReportAbuseSingleTitleFormat,k("context.payloads().reportAbuse.item"))},canceled:{title:c(r.default.failedReportAbuseSingleTitleFormat,k("context.payloads().reportAbuse.item"))}}},deleteItems:{title:_(r.default.deleteSingleTitleFormat,r.default.deleteMultipleTitleFormat,k("context.payloads().deleteItems.parent")),shortTitle:_(r.default.startedDeleteSingleShortTitleFormat,r.default.startedDeleteMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedDeleteSingleTitleFormat,r.default.completedDeleteMultipleTitleFormat,k("context.payloads().deleteItems.parent"))},failed:{title:P(r.default.failedDeleteSingleTitleFormat,r.default.failedDeleteMultipleTitleFormat)},canceled:{title:H(r.default.failedDeleteSingleTitleFormat,r.default.failedDeleteMultipleTitleFormat)}},actions:{undo:{mode:1},deleteLocked:{mode:1}}},pointInTimeRestore:{title:r.default.pointInTimeRestoreTitleFormat,shortTitle:r.default.pointInTimeRestoreTitleFormat,states:{created:{description:v},started:{description:p},completed:{title:r.default.completedPointInTimeRestoreTitleFormat},failed:{title:r.default.failedPointInTimeRestoreTitleFormat},canceled:{title:r.default.canceledPointInTimeRestoreTitleFormat}}},sharepointPointInTimeRestore:{title:r.default.sharepointPointInTimeRestoreTitleFormat,shortTitle:r.default.siteOwnerPointInTimeRestoreTitleFormat,states:{created:{description:r.default.siteOwnerPointInTimeRestoreDescription},started:{description:p},completed:{title:r.default.sharepointCompletedPointInTimeRestoreTitleFormat},failed:{title:r.default.failedPointInTimeRestoreTitleFormat},canceled:{title:r.default.sharepointCanceledPointInTimeRestoreTitleFormat}}},restoreItems:{title:_(r.default.restoreSingleTitleFormat,r.default.restoreMultipleTitleFormat),shortTitle:_(r.default.startedRestoreSingleShortTitleFormat,r.default.startedRestoreMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRestoreSingleShortTitleFormat,r.default.completedRestoreMultipleShortTitleFormat)},failed:{title:P(r.default.failedRestoreSingleTitleFormat,r.default.failedRestoreMultipleTitleFormat)},canceled:{title:H(r.default.failedRestoreSingleTitleFormat,r.default.failedRestoreMultipleTitleFormat)}}},runModelOnItems:{title:_(r.default.runModelSingleItemProgress,r.default.runModelMultipleItemsProgress),shortTitle:_(r.default.runModelSingleItemProgress,r.default.runModelMultipleItemsProgress),states:{started:{description:d},completed:{title:D(r.default.runModelSingleItemCompleted,r.default.runModelMultipleItemsCompleted)},failed:{title:P(r.default.runModelSingleItemFailed,r.default.runModelMultipleItemsFailed),description:x},canceled:{title:r.default.runModelMultipleItemsCancelled}}},uploadItems:{title:_(r.default.uploadSingleTitleFormat,r.default.uploadMultipleTitleFormat,k("context.payloads().uploadItems.parent")),shortTitle:_(r.default.startedUploadSingleShortTitleFormat,r.default.startedUploadMultipleShortTitleFormat),states:{started:{description:d},completed:{title:D(r.default.completedUploadSingleTitleFormat,r.default.completedUploadMultipleTitleFormat,k("context.payloads().uploadItems.parent"))},failed:{title:P(r.default.failedUploadSingleTitleFormat,r.default.failedUploadMultipleTitleFormat),description:x},canceled:{title:H(r.default.failedUploadSingleTitleFormat,r.default.failedUploadMultipleTitleFormat)}},actions:{cancel:{mode:3}}},moveItems:{title:_(r.default.moveSingleTitleFormat,r.default.moveMultipleTitleFormat,k("context.payloads().moveItems.destination")),shortTitle:_(r.default.startedMoveSingleShortTitleFormat,r.default.startedMoveMultipleShortTitleFormat),states:{started:{description:p},completed:{title:D(r.default.completedMoveSingleTitleFormat,r.default.completedMoveMultipleTitleFormat,k("context.payloads().moveItems.destination"))},failed:{title:P(r.default.failedMoveSingleTitleFormat,r.default.failedMoveMultipleTitleFormat)},canceled:{title:H(r.default.canceledMoveSingleTitleFormat,r.default.canceledMoveMultipleTitleFormat)}},actions:{cancel:{mode:1}}},copyItems:{title:_(r.default.copySingleTitleFormat,r.default.copyMultipleTitleFormat,k("context.payloads().copyItems.destination")),shortTitle:_(r.default.startedCopySingleShortTitleFormat,r.default.startedCopyMultipleShortTitleFormat),states:{started:{description:p},completed:{title:D(r.default.completedCopySingleTitleFormat,r.default.completedCopyMultipleTitleFormat,k("context.payloads().copyItems.destination"))},failed:{title:P(r.default.failedCopySingleTitleFormat,r.default.failedCopyMultipleTitleFormat)},canceled:{title:H(r.default.canceledCopySingleTitleFormat,r.default.canceledCopyMultipleTitleFormat)}},actions:{cancel:{mode:1}}},rotateItems:{title:_(r.default.rotateSingleTitleFormat,r.default.rotateMultipleTitleFormat),shortTitle:_(r.default.startedRotateSingleShortTitleFormat,r.default.startedRotateMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRotateSingleShortTitleFormat,r.default.completedRotateMultipleShortTitleFormat)},failed:{title:P(r.default.failedRotateSingleTitleFormat,r.default.failedRotateMultipleTitleFormat)},canceled:{title:H(r.default.failedRotateSingleTitleFormat,r.default.failedRotateMultipleTitleFormat)}}},downloadAsZip:{title:r.default.downloadMultipleTitleFormat,shortTitle:r.default.downloadMultipleTitleFormat,states:{started:{title:R(r.default.startedDownloadMultipleLongTitleFormat)},completed:{title:R(r.default.completedDownloadMultipleLongTitleFormat)},canceled:{title:R(r.default.canceledDownloadMultipleLongTitleFormat)}}},applyOfficeLens:{title:_(r.default.applyOfficeLensSingleTitleFormat,r.default.applyOfficeLensMultipleTitleFormat),shortTitle:_(r.default.startedApplyOfficeLensSingleShortTitleFormat,r.default.startedApplyOfficeLensMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedApplyOfficeLensSingleShortTitleFormat,r.default.completedApplyOfficeLensMultipleShortTitleFormat)},failed:{title:P(r.default.failedApplyOfficeLensSingleTitleFormat,r.default.failedApplyOfficeLensMultipleTitleFormat)},canceled:{title:H(r.default.failedApplyOfficeLensSingleTitleFormat,r.default.failedApplyOfficeLensMultipleTitleFormat)}}},removeOfficeLens:{title:_(r.default.removeOfficeLensSingleTitleFormat,r.default.removeOfficeLensMultipleTitleFormat),shortTitle:_(r.default.startedRemoveOfficeLensSingleShortTitleFormat,r.default.startedRemoveOfficeLensMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRemoveOfficeLensSingleShortTitleFormat,r.default.completedRemoveOfficeLensMultipleShortTitleFormat)},failed:{title:P(r.default.failedRemoveOfficeLensSingleTitleFormat,r.default.failedRemoveOfficeLensMultipleTitleFormat)},canceled:{title:H(r.default.failedRemoveOfficeLensSingleTitleFormat,r.default.failedRemoveOfficeLensMultipleTitleFormat)}}},addItemsToAlbum:{title:_(r.default.addToAlbumSingleTitleFormat,r.default.addToAlbumMultipleTitleFormat,k("context.payloads().addItemsToAlbum.album")),shortTitle:_(r.default.startedAddToAlbumSingleShortTitleFormat,r.default.startedAddToAlbumMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedAddToAlbumSingleTitleFormat,r.default.completedAddToAlbumMultipleTitleFormat,k("context.payloads().addItemsToAlbum.album"))},failed:{title:P(r.default.failedAddToAlbumSingleTitleFormat,r.default.failedAddToAlbumMultipleTitleFormat)},canceled:{title:H(r.default.failedAddToAlbumSingleTitleFormat,r.default.failedAddToAlbumMultipleTitleFormat)}}},addCoverPhotos:{title:_(r.default.addAsCoverPhotosSingleTitleFormat,r.default.addAsCoverPhotosMultipleTitleFormat,k("context.payloads().coverPhotos.parent")),shortTitle:_(r.default.startedAddAsCoverPhotosSingleShortTitleFormat,r.default.startedAddAsCoverPhotosMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedAddAsCoverPhotosSingleTitleFormat,r.default.completedAddAsCoverPhotosMultipleTitleFormat,k("context.payloads().coverPhotos.parent"))},failed:{title:P(r.default.failedAddAsCoverPhotosSingleTitleFormat,r.default.failedAddAsCoverPhotosMultipleTitleFormat)},canceled:{title:H(r.default.failedAddAsCoverPhotosSingleTitleFormat,r.default.failedAddAsCoverPhotosMultipleTitleFormat)}}},removeCoverPhotos:{title:_(r.default.removeAsCoverPhotosSingleTitleFormat,r.default.removeAsCoverPhotosMultipleTitleFormat,k("context.payloads().coverPhotos.parent")),shortTitle:_(r.default.startedRemoveAsCoverPhotosSingleShortTitleFormat,r.default.startedRemoveAsCoverPhotosMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedRemoveAsCoverPhotosSingleTitleFormat,r.default.completedRemoveAsCoverPhotosMultipleTitleFormat,k("context.payloads().coverPhotos.parent"))},failed:{title:P(r.default.failedRemoveAsCoverPhotosSingleTitleFormat,r.default.failedRemoveAsCoverPhotosMultipleTitleFormat)},canceled:{title:H(r.default.failedRemoveAsCoverPhotosSingleTitleFormat,r.default.failedRemoveAsCoverPhotosMultipleTitleFormat)}}},createAlbumFromFolder:{title:c(r.default.startedCreateAlbumFromFolderSingleTitleFormat,k("context.payloads().createAlbumFromFolder.folder")),states:{completed:{title:c(r.default.completedCreateAlbumFromFolderSingleTitleFormat,k("context.payloads().createAlbumFromFolder.album"))},failed:{title:c(r.default.failedCreateAlbumFromFolderSingleTitleFormat,k("context.payloads().createAlbumFromFolder.folder"))}}},createColumn:{title:F(r.default.startedCreateColumnSingleTitleFormat),shortTitle:r.default.startedCreateColumnSingleShortTitle,states:{completed:{title:F(r.default.completedCreateColumnSingleTitleFormat)},failed:{title:F(r.default.failedCreateColumnSingleTitleFormat)}}},editColumn:{title:I(r.default.startedEditColumnSingleTitleFormat),shortTitle:r.default.startedEditColumnSingleShortTitle,states:{completed:{title:I(r.default.completedEditColumnSingleTitleFormat)},failed:{title:I(r.default.failedEditColumnSingleTitleFormat)}}},deleteColumn:{title:q(r.default.startedDeleteColumnSingleTitleFormat),shortTitle:r.default.startedDeleteColumnSingleShortTitle,states:{completed:{title:q(r.default.completedDeleteColumnSingleTitleFormat)},failed:{title:q(r.default.failedDeleteColumnSingleTitleFormat)}}},createAlbum:{title:_(r.default.addToAlbumSingleTitleFormat,r.default.addToAlbumMultipleTitleFormat,k("context.payloads().createAlbum.album")),shortTitle:_(r.default.startedAddToAlbumSingleShortTitleFormat,r.default.startedAddToAlbumMultipleShortTitleFormat),states:{completed:{title:function(e){return M(e.payloads().createAlbum.album().childCount,r.default.completedAddToAlbumSingleTitleFormat,r.default.completedAddToAlbumMultipleTitleFormat,k("context.payloads().createAlbum.album"))}},failed:{title:P(r.default.failedAddToAlbumSingleTitleFormat,r.default.failedAddToAlbumMultipleTitleFormat)},canceled:{title:H(r.default.failedAddToAlbumSingleTitleFormat,r.default.failedAddToAlbumMultipleTitleFormat)}}},checkInItem:{title:c(r.default.checkInItemTitleFormat,k("context.payloads().checkInItem.parent")),states:{}},checkOutItem:{title:c(r.default.checkOutItemTitleFormat,k("context.payloads().checkOutItem.parent")),states:{}},undoCheckOutItem:{title:c(r.default.undoCheckOutItemTitleFormat,k("context.payloads().undoCheckOutItem.parent")),states:{}},publishItem:{title:c(r.default.publishItemTitleFormat,k("context.payloads().publishItem.parent")),states:{}},makeHomepage:{title:r.default.MakeHomepageProgress,states:{completed:{title:r.default.MakeHomepageCompleted},failed:{title:r.default.MakeHomepageError}}},setupApprovalFlow:{title:r.default.SetUpApprovalFlow,states:{completed:{title:r.default.SetUpApprovalFlowCompleted},failed:{title:r.default.SetUpApprovalFlowFailure}}},setupReminderFlow:{title:function(e){return c(r.default.ReminderFlowCreationInProgressFormat,a.default.encodeText(e.payloads().createReminderFlow.dateColumnName))},states:{completed:{title:function(e){return c(r.default.ReminderFlowCreationSuccessFormat,a.default.encodeText(e.payloads().createReminderFlow.dateColumnName))}},failed:{title:function(e){return c(r.default.ReminderFlowCreationFailureFormat,a.default.encodeText(e.payloads().createReminderFlow.dateColumnName))}}}},unPublishItem:{title:c(r.default.unPublishItemTitleFormat,k("context.payloads().unPublishItem.parent")),states:{}},shareItem:{title:A,states:{started:{title:A},completed:{description:L,title:A},failed:{description:L}}},createFolder:{title:c(r.default.createFolderTitleFormat,k("context.payloads().createFolder.parent")),states:{}},updateBundle:{title:c(r.default.updateBundle,k("context.payloads().updateBundle.item")),states:{}},setAlbumCoverPhoto:{title:c(r.default.setCoverPhotoTitleFormat,k("context.payloads().setAlbumCoverPhoto.album")),states:{completed:{title:c(r.default.completedSetCoverPhotoTitleFormat,k("context.payloads().setAlbumCoverPhoto.album"))},failed:{title:c(r.default.failedSetCoverPhotoTitleFormat,k("context.payloads().setAlbumCoverPhoto.album"))}}},uploadVideos:{title:function(e){return M(O(e),r.default.uploadSingleTitleFormat,r.default.uploadMultipleTitleFormat,a.default.encodeText(e.payloads().uploadItems.parent.name))},states:{started:{description:d},completed:{title:function(e){return M(e.states().completed,r.default.completedUploadSingleTitleFormat,r.default.completedUploadMultipleTitleFormat,a.default.encodeText(e.payloads().uploadItems.parent.name))}},failed:{title:P(r.default.failedUploadSingleTitleFormat,r.default.failedUploadMultipleTitleFormat),description:x},canceled:{title:H(r.default.failedAddToAlbumSingleTitleFormat,r.default.failedAddToAlbumMultipleTitleFormat)}}},saveItem:{title:B(r.default.saveTitleFormat),shortTitle:B(r.default.saveTitleFormat),states:{started:{description:d},completed:{title:B(r.default.completedSaveTitleFormat)},failed:{title:B(r.default.failedSaveTitleFormat),description:w(T)},canceled:{title:B(r.default.failedSaveTitleFormat)}},actions:{cancel:{mode:3}}},createItem:{title:B(r.default.createItemTitleFormat),shortTitle:B(r.default.createItemTitleFormat),states:{started:{description:d},completed:{title:B(r.default.completedCreateItemTitleFormat)},failed:{title:B(r.default.failedCreateItemTitleFormat),description:w(N)},canceled:{title:B(r.default.failedCreateItemTitleFormat)}},actions:{cancel:{mode:3},learnMore:{mode:2},close:{mode:1}}},updateMetadata:{title:_(r.default.updateSingleTitleFormat,r.default.updateMultipleTitleFormat),shortTitle:_(r.default.startedUpdateSingleShortTitleFormat,r.default.startedUpdateMultipleShortTitleFormat),states:{completed:{title:D(r.default.completedUpdateSingleShortTitleFormat,r.default.completedUpdateMultipleShortTitleFormat)},failed:{title:P(r.default.failedUpdateSingleTitleFormat,r.default.failedUpdateMultipleTitleFormat)},canceled:{title:H(r.default.failedUpdateSingleTitleFormat,r.default.failedUpdateMultipleTitleFormat)}}},triggerFlow:{title:j(r.default.TriggerFlowStarting),shortTitle:j(r.default.TriggerFlowStarting),states:{created:{title:j(r.default.TriggerFlowInitializing)},started:{title:j(r.default.TriggerFlowStarting)},completed:{title:j(r.default.TriggerFlowStarted)},failed:{title:j(r.default.TriggerFlowError)}}},saveAutoAlbum:{title:c(r.default.saveAutoAlbumTitleFormat,k("context.payloads().saveAutoAlbum.album")),states:{completed:{title:c(r.default.completedSaveAutoAlbumTitleFormat,k("context.payloads().saveAutoAlbum.album"))},failed:{title:c(r.default.failedSaveAutoAlbumTitleFormat,k("context.payloads().saveAutoAlbum.album"))}}},discardAutoAlbum:{title:c(r.default.discardAutoAlbumTitleFormat,k("context.payloads().discardAutoAlbum.album")),states:{completed:{title:c(r.default.completedDiscardAutoAlbumTitleFormat,k("context.payloads().discardAutoAlbum.album"))},failed:{title:c(r.default.failedDiscardAutoAlbumTitleFormat,k("context.payloads().discardAutoAlbum.album"))}}},editViewColumns:{title:r.default.startedEditViewColumns,shortTitle:r.default.startedEditViewColumns,states:{completed:{title:r.default.completedEditViewColumns},failed:{title:r.default.failedEditViewColumns}}},addToOneDrive:{title:_(r.default.startedAddToOneDriveSingleTitleFormat,r.default.startedAddToOneDriveMultipleTitleFormat),states:{completed:{title:D(r.default.completedAddToOneDriveSingleTitleFormat,r.default.completedAddToOneDriveMultipleTitleFormat)},failed:{title:P(r.default.failedAddToOneDriveSingleTitleFormat,r.default.failedAddToOneDriveMultipleTitleFormat)},canceled:{title:H(r.default.failedAddToOneDriveSingleTitleFormat,r.default.failedAddToOneDriveMultipleTitleFormat)}}},removeFromSharedList:{title:_(r.default.startedRemovalSharedSingleTitleFormat,r.default.startedRemovalSharedMultipleTitleFormat),states:{completed:{title:D(r.default.completedRemovalSharedSingleTitleFormat,r.default.completedRemovalSharedMultipleTitleFormat)},failed:{title:P(r.default.failedRemovalSharedSingleTitleFormat,r.default.failedRemovalSharedMultipleTitleFormat)}}},sharingReport:{title:r.default.runningReport,states:{completed:{title:r.default.runningReport,description:(function(e){return function(t){return c(e,a.default.encodeText(t.payloads().sharingReport.folderUrl))}})(r.default.creatingReport)},failed:{title:r.default.reportFailed}}}},actions:{cancel:{name:r.default.cancelActionText,icon:new o.default("Cancel")},close:{name:r.default.closeActionText,icon:new o.default("Cancel"),mode:1},overwrite:{name:U(r.default.overwriteSingleActionText,r.default.overwriteMultipleActionText)},addNewVersion:{name:U(r.default.addNewVersionActionText,r.default.addNewVersionMultipleActionText)},restart:{name:r.default.restartActionText},undo:{name:U(r.default.undoSingleActionText,r.default.undoMultipleActionText)},rename:{name:U(r.default.renameSingleActionText,r.default.renameMultipleActionText)},unlockVault:{name:r.default.unlockButtonText},vaultFileLimit:{name:r.default.insufficientVaultQuotaErrorButtonText},moveSharedFileVault:{name:r.default.moveSharedFileVaultErrorButtonText},moveAnyway:{name:r.default.moveAnywayButtonText},moveAnywaySchemaMismatch:{name:U(r.default.moveAnywaySingleActionText,r.default.moveAnywayMultipleActionText)},moveAnywayVersionLimit:{name:U(r.default.moveAnywaySingleActionText,r.default.moveAnywayMultipleActionText)},deleteLocked:{name:U(r.default.deleteSingleActionText,r.default.deleteMultipleActionText)},moveLockedFile:{name:r.default.moveAnywayButtonText},compare:{name:r.default.compareActionText},hipCheck:{name:r.default.hipCheckActionText},verifyAccount:{name:r.default.verifyAccountActionText},learnMore:{name:r.default.learnMoreActionText}}};t.default=$});
define("@ms/odsp-utilities/lib/string/DriveSpaceHelper",["require","exports","@ms/items-view-utilities/lib/string/DriveSpaceHelper.resx","../locale/Locale"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=1.2.toLocaleString(r.default.language).replace(/\d+/g,""),o=/\.?0+$/;(function(e){e.getDisplayString=function(e,r){void 0===r&&(r={});if("number"!=typeof e||isNaN(e)||r.ignoreZero&&0===e||e<0)return"";var i=r.trimDecimal;return 1===e?n.default.fileSizeBytesSingular:e<1024?t(n.default.fileSizeBytesPlural,e,i):e<1024e3?t(n.default.fileSizeKB,e/1024,i):e<1048576e3?t(n.default.fileSizeMB,e/1048576,i):e<0xfa00000000?t(n.default.fileSizeGB,e/1073741824,i):t(n.default.fileSizeTB,e/1099511627776,i)};function t(e,t,n){return e.replace("{0}",(function(e,t){if(e>=100||e===Math.floor(e))return e.toFixed(0);var n=e.toFixed(e>=10?1:2);return(t?n.replace(o,""):n).replace(".",s)})(t,n))}})(i||(i={}));t.default=i});
define("odsp-next/controls/itemLink/ItemLink",["require","exports","./ItemLink.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemLinkViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-item-link",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemLink/ItemLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko with:open--\x3e\x3c!--ko if:isAvailable--\x3e<a class="od-ItemLink" href="#" data-bind="click:$component.execute.bind($component),text:$component.name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:isAvailable--\x3e<span class="od-ItemLink" data-bind="text:$component.name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/itemLink/ItemLinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../models/item/Item.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=n.wrapObservable(t.item);n.name=n.createPureComputed(n._computeName);var r=n.resources.consume(i.actionMap);n.open=new(n.managed(r.OpenAction))({openRelation:2,item:n._item});return n}t.prototype.execute=function(e,t){if(e.isAvailable()){e.execute(t).done();return!1}};t.prototype._computeName=function(){var e=this._item();return e&&(e.displayName||e.name)||s.default.fileTypeFolder.toLocaleLowerCase()};return t})(r.default);t.default=o});
define("@ms/odsp-utilities/lib/encoding/HtmlEncoding",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[<>&'"\\]/g,r={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function i(e){return r[e]}var s=(function(){function e(){}e.encodeText=function(e){return e?e.replace(n,i):""};return e})();t.default=s});
define("@ms/odsp-shared/lib/utilities/knockout/Renderers",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderText=function(e,t){var r=document.createElement("div");r.innerHTML=t;n.applyBindings(e,r);var i=r.textContent;n.cleanNode(r);return i}});
define("odsp-next/controls/operation/SuppressOperationUI.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".OperationPanel",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/pages/files/FilesCommandSetHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../../controls/commands/Commands.resx","../../controls/list/layouts/LayoutType","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/icons/OfficeFileNameHelper","../../utilities/selection/SelectionHelper","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.selection=n.resources.consume(i.itemsSelection);n.showLabels=t.showLabels;n.layoutType=n.resources.consume(s.files.layoutType);return n}t.prototype.showSelectionActionText=function(){var e=this.selection&&this.selection.selection().length||0;return this.showLabels()?a.format(o.default.NumberSelected,e):e.toString()};t.prototype.computeOpenInOfficeOnlineText=function(){return f.getOfficeOnlineStringMap(l.getSelectedItemApp(this.selection))||o.default.Open};t.prototype.computeOpenInOfficeClientText=function(){return f.getOfficeStringMap(l.getSelectedItemApp(this.selection))};t.prototype.computeOfficeIcon=function(){var e,t=l.getSelectedItemApp(this.selection);t&&(e=f.getOfficeIconMap(t));return e||new c.default("Page")};t.prototype.computeOfficeClass=function(){return f.getAppName(l.getSelectedItemApp(this.selection))};t.prototype.computeViewSelectorIcon=function(){return new c.default(this.computeViewSelectorIconName())};t.prototype.computeViewSelectorIconName=function(){var e=this.layoutType();return e===u.SingleAlbum||e===u.AllPhotos?t.singleAlbumIcon:e===u.CompactDetails?t.compactDetailsIcon:e===u.Grid||e===u.CustomGridList?t.gridIcon:t.detailsIcon};t.compactDetailsIcon="AlignLeft";t.detailsIcon="List";t.gridIcon="ViewAll";t.tilesIcon="Tiles";t.singleAlbumIcon="LargeGrid";return t})(r.default);t.default=h});
define("odsp-next/controls/sharing/share/odc/CommandBuilder",["require","exports","tslib","../../../../controls/commands/Command","../../../../resources/ControlResourceKeys","@ms/odsp-shared/lib/base/BaseModel","../odc/Share.key","../../../../base/ColorVariation","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var s=e.call(this,t,n)||this,o=s,f=o.observables,l=o.resources,c=t.renderLabel,h=void 0===c?0:c,p=t.mode,d=t.itemsKey;s._mode=p;s._actionMap=l.consume(i.actionMap);s._itemsBeingShared=l.consume(d);s._renderLabel=h;s._copyLinkShortcut=p===a.Mode.copy;var v={text:t.text,tooltip:t.tooltip,icon:t.icon,keys:t.keys,engagementName:t.engagementName,renderLabel:s._renderLabel,action:new(s.managed(s._actionMap.ShowShareMultiItemAction))({focusItems:s._itemsBeingShared}),payload:{control:s._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0,calloutLayerProps:{styles:{root:{zIndex:300}}}},enableRecoverFocusBinding:!1,beakColor:u.default.neutralLighterAlt,isHidden:t.isHidden};s.command=new(s.managed(r.CommandViewModel))(v);f.backgroundCompute(s._computeIsOpen);return s}t.prototype._computeIsOpen=function(){this._itemsBeingShared()&&this.command.isOpen(!0)};t.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemsBeingShared(void 0)};t.prototype._resizeShare=function(){if(!this._registeredClear){this._registeredClear=!0;this.observables.backgroundCompute(this._computeShouldClearItem)}};t.prototype._dismissShare=function(){this._itemsBeingShared(void 0)};t.prototype._getPayload=function(){var e=this,t=this.observables,n=t.pureCompute(this._computeShareParams),r=t.pureCompute(function(){return!!e._itemsBeingShared()}),i=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(e.resources.consumeAsync(o.default.local)).done(function(e){i(e)}):r()});return t.pureCompute(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};t.prototype._computeShareParams=function(){var e=this._itemsBeingShared();if(e&&e.items&&e.items[0])return{items:this._itemsBeingShared,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:this._mode}};return t})(s.default);t.default=f});
define("@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces",["require","exports","@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces","./enums/AccessStatus","@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces","./enums/FileShareType","./enums/OutlookAvailability","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","./enums/ShareType","./enums/SharingCapabilityDisabledReason"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharingAudienceTemplates=n.SharingAudienceTemplates;t.AccessStatus=r.default;t.Error=i.Error;t.Category=i.Category;t.UpdatePermissionsRole=i.UpdatePermissionsRole;t.SharePermission=i.SharePermission;t.SharingAudience=i.SharingAudience;t.SharingLinkKind=i.SharingLinkKind;t.SharingRole=i.SharingRoleV3;t.Mode=i.Mode;t.ClientId=i.ClientId;t.FileShareType=s.default;t.OutlookAvailability=o.default;t.PrincipalType=u.default;t.ShareType=a.default;t.SharingCapabilityDisabledReason=f.default});
define("@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces",["require","exports","./IUpdatePermissionsResponse","./enums/SharingLinkKind","./enums/SharingLinkType","./enums/SharingInfoType","./enums/SharingRole","./enums/AccessStatus","./enums/ClientId","./enums/Error","./enums/Mode","./enums/SharePermission","./enums/SharingAudience","./enums/SharingAudienceTemplates","./enums/SharingRoleV3","./enums/SharingLinkExpressOptions"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UpdatePermissionsRole=n.UpdatePermissionsRole;t.SharingLinkKind=r.SharingLinkKind;t.SharingLinkType=i.SharingLinkType;t.SharingInfoType=s.SharingInfoType;t.SharingRole=o.SharingRole;t.AccessStatus=u.AccessStatus;t.ClientId=a.default;t.Error=f.default;t.Category=f.Category;t.Mode=l.default;t.SharePermission=c.default;t.SharingAudience=h.default;t.SharingAudienceTemplates=p.SharingAudienceTemplates;t.SharingRoleV3=d.SharingRoleV3;t.SharingLinkExpressOptions=v.SharingLinkExpressOptions});
define("@ms/odsp-datasources/lib/interfaces/sharing/IUpdatePermissionsResponse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT";e[e.OWNER=3]="OWNER";e[e.REVIEW=6]="REVIEW"})(t.UpdatePermissionsRole||(t.UpdatePermissionsRole={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingLinkKind",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible"})(t.SharingLinkKind||(t.SharingLinkKind={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingLinkType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Network=1]="Network";e[e.Embed=3]="Embed";e[e.App=4]="App";e[e.View=5]="View";e[e.Edit=6]="Edit";e[e.Form=7]="Form";e[e.Direct=8]="Direct";e[e.Organization=9]="Organization";e[e.AppAccess=10]="AppAccess"})(t.SharingLinkType||(t.SharingLinkType={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingInfoType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Email=0]="Email";e[e.User=1]="User";e[e.Group=2]="Group";e[e.Link=3]="Link";e[e.Public=4]="Public";e[e.Friends=5]="Friends";e[e.Facebook=6]="Facebook";e[e.Application=7]="Application";e[e.GroupOwned=99]="GroupOwned"})(t.SharingInfoType||(t.SharingInfoType={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingRole",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Owner=0]="Owner";e[e.View=1]="View";e[e.Edit=2]="Edit";e[e.Submitter=3]="Submitter";e[e.CoOwner=4]="CoOwner";e[e.None=5]="None";e[e.Review=6]="Review";e[e.Custom=7]="Custom"})(t.SharingRole||(t.SharingRole={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/AccessStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=1]="none";e[e.pending=2]="pending";e[e.hasAccess=3]="hasAccess"})(t.AccessStatus||(t.AccessStatus={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/ClientId",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos"})(n||(n={}));var r=void 0;t.getClientId=function(e){if(void 0===r){r={};for(var t in n){var i=parseInt(t);if(!isNaN(i)){var s=n[i].toLowerCase();r[s]=i}}}var o=e?e.toLowerCase():"";return r[o]||n.unknown};t.default=n});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/Error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.authFailure=1]="authFailure";e[e.serverFailure=2]="serverFailure";e[e.invalidItem=3]="invalidItem";e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl";e[e.generic=5]="generic";e[e.objectNotSupported=6]="objectNotSupported";e[e.invalidEmail=7]="invalidEmail";e[e.linkNoLongerAvailable=8]="linkNoLongerAvailable"})(n||(n={}));(function(e){e[e.getSharingInformation=1]="getSharingInformation";e[e.shareLink=2]="shareLink";e[e.shareObject=3]="shareObject";e[e.permissions=4]="permissions";e[e.item=5]="item";e[e.me=6]="me";e[e.drive=7]="drive";e[e.invite=8]="invite"})(t.Category||(t.Category={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/Mode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharePermission",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.view=1]="view";e[e.edit=2]="edit"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingAudience",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingAudienceTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.anyone=0]="anyone";e[e.organization=1]="organization";e[e.specificPeople=2]="specificPeople"})(t.SharingAudienceTemplates||(t.SharingAudienceTemplates={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingRoleV3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit"})(t.SharingRoleV3||(t.SharingRoleV3={}))});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SharingLinkExpressOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.uninitialized=0]="uninitialized";e[e.AddressBarLink=1]="AddressBarLink"})(t.SharingLinkExpressOptions||(t.SharingLinkExpressOptions={}))});
define("@ms/odsp-shared-sharing/lib/interfaces/enums/AccessStatus",["require","exports","@ms/odsp-datasources/lib/interfaces/sharing/SharingInterfaces"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.AccessStatus});
define("@ms/odsp-shared-sharing/lib/interfaces/enums/FileShareType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.anyone=0]="anyone";e[e.workGroup=1]="workGroup";e[e.specificPeople=2]="specificPeople";e[e.onlyYou=3]="onlyYou";e[e.existing=4]="existing";e[e.chat=5]="chat";e[e.mail=6]="mail"})(n||(n={}));t.default=n});
define("@ms/odsp-shared-sharing/lib/interfaces/enums/OutlookAvailability",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"})(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(n||(n={}));t.default=n});
define("@ms/odsp-shared-sharing/lib/interfaces/enums/ShareType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"})(n||(n={}));t.default=n});
define("@ms/odsp-shared-sharing/lib/interfaces/enums/SharingCapabilityDisabledReason",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unavailable=-1]="unavailable";e[e.none=0]="none";e[e.disabled=1]="disabled";e[e.notShareableByLink=2]="notShareableByLink";e[e.parentListIsPrivate=3]="parentListIsPrivate";e[e.parentListIsCatalogDocLib=4]="parentListIsCatalogDocLib";e[e.notSupportedByWopi=5]="notSupportedByWopi";e[e.irmIsEnabled=6]="irmIsEnabled";e[e.documentIsProtectedByDlp=7]="documentIsProtectedByDlp";e[e.forceCheckoutEditLink=8]="forceCheckoutEditLink";e[e.anonymousEditLinkNotAllowedByTenant=9]="anonymousEditLinkNotAllowedByTenant";e[e.nonClaimsWebapp=10]="nonClaimsWebapp";e[e.accessDeniedToAnonGuest=11]="accessDeniedToAnonGuest";e[e.blockedByWhoCanShareSettings=12]="blockedByWhoCanShareSettings";e[e.blockedByExternalShareSettings=13]="blockedByExternalShareSettings";e[e.accessDeniedNotEnoughPermissions=14]="accessDeniedNotEnoughPermissions"})(n||(n={}));t.default=n});
define("odsp-next/controls/vault/VaultCommandBuilder",["require","exports","tslib","knockout","../../controls/commands/Command","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/common/DirectionalHint","../../controls/vault/VaultCallout.key","../../controls/vault/IVaultCallout","../../controls/commands/Commands.resx","../../resources/DataSourceResourceKeys","../../actions/vault/VaultActionType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t,o){void 0===o&&(o={});var a=e.call(this,t,o)||this,l=a,c=l.observables,v=l.resources,m=t.selectionModeOn,g=t.location,y=t.commandName,b=t.commandTooltip,w=t.actionMap;a._vaultUnlocked=a.observables.createCallback(u.forSingleValue(!1));a._showLockNotification=a.observables.createCallback(u.forSingleValue(!1));a._vaultQuota=a.observables.createCallback(u.forSingleValue(void 0));a._showVaultFreMessage=a.observables.createCallback(u.forSingleValue(!1));a.resources.isDefined(p.vault)&&v.consumeAsync(p.vault).then(function(e){a._vaultDataSource=e;e.vaultStateSubscribe(a._vaultUnlocked);e.vaultLockMessageSubscribe(a._showLockNotification);e.vaultQuotaSubscribe(a._vaultQuota);e.vaultMenuCalloutSubscribe(a._showVaultFreMessage)});a._selectionModeOn=m;a._isHidden=a.createComputed(a._computeIsHidden);a._fileRemainingString=a.createComputed(a._getRemainingFilesString);a._showFilesRemaining=a.createComputed(function(){return!a._fileRemainingString()});0;a.command=new(a.managed(i.CommandViewModel))({renderLabel:0,icon:new s.default("OneDriveFileVault"),isHidden:a._isHidden,hasIconOnly:!0,location:g,payload:{control:a._getPayload(),timeout:3e3,autoDismiss:!0,announce:!0,preventDismissOnLostFocus:!0,directionalHint:f.DirectionalHint.bottomCenter},callback:a._dismissVaultFreMessage.bind(a),text:y,tooltip:b,children:r.observableArray(n.__spreadArrays([new(a.managed(i.CommandViewModel))({text:h.default.LockVault,isToggleable:!1,action:new(a.managed(w.VaultAction))({actionType:d.default.Lock,isGlobal:!0}),keys:["AltL"],engagementName:"Vault.Icon.Lock"}),new(a.managed(i.CommandViewModel))({text:h.default.ManageVault,isToggleable:!1,action:new(a.managed(w.VaultAction))({actionType:d.default.Manage}),hasLineBreakAfter:!0,engagementName:"Vault.Icon.Manage"}),new(a.managed(i.CommandViewModel))({text:a._fileRemainingString,isHidden:a._showFilesRemaining,isToggleable:!1,action:new(a.managed(w.VaultAction))({actionType:d.default.FilesRemaining})})],[]))});c.backgroundCompute(a._computeIsOpen);c.backgroundCompute(a._computeDismiss);return a}t.prototype._computeIsHidden=function(){var e=this._showLockNotification(),t=this._vaultUnlocked();return this._selectionModeOn()||!e&&!t};t.prototype._computeIsOpen=function(){var e=this._showLockNotification(),t=this._showVaultFreMessage();(e||t)&&this.command.isOpen(!0)};t.prototype._computeDismiss=function(){this.command.isOpen()||this._dismissNotification()};t.prototype._dismissNotification=function(){var e=this._vaultDataSource;return e&&e.dismissLockNotification()};t.prototype._dismissVaultFreMessage=function(){var e=this._vaultDataSource;e&&e.setShowVaultFreMessage(!1)};t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createObservable(void 0);this.resources.consumeAsync(p.vault).then(function(e){n(e)});var r=t.create();t.backgroundCompute(function(){n()&&e.trackPromise(e.resources.consumeAsync(l.resourceKey.local)).done(function(e){r(e)})});return this.createPureComputed(function(){var t=r(),n=e._showLockNotification(),i=e._showVaultFreMessage();if(t&&(n||i))return t.toSpecification({onDismiss:n?e._dismissNotification.bind(e):e._dismissVaultFreMessage.bind(e),messageType:n?c.VaultMessageType.lockMessage:c.VaultMessageType.secondSessionMessage})})};t.prototype._getRemainingFilesString=function(){var e=this._vaultQuota(),t=e&&e.totalFiles<0;switch(e&&e.state&&e.state.toLowerCase()){case"exceeded":return h.default.OverVaultQuota;case"critical":return h.default.VaultIsFull;case"normal":case"nearing":var n=e&&e.remainingFiles,r=e&&e.totalFiles;return n&&!t?a.format(h.default.FileRemainingStrings,n,r):"";default:return""}};return t})(o.default);t.default=v});
define("office-ui-fabric-react/lib/common/DirectionalHint",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DirectionalHint={topLeftEdge:0,topCenter:1,topRightEdge:2,topAutoEdge:3,bottomLeftEdge:4,bottomCenter:5,bottomRightEdge:6,bottomAutoEdge:7,leftTopEdge:8,leftCenter:9,leftBottomEdge:10,rightTopEdge:11,rightCenter:12,rightBottomEdge:13}});
define("odsp-next/controls/vault/VaultCallout.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VaultCallout"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/vault/IVaultCallout",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.lockMessage=1]="lockMessage";e[e.secondSessionMessage=2]="secondSessionMessage"})(t.VaultMessageType||(t.VaultMessageType={}))});
define("odsp-next/controls/guidedTour/GuidedTour.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./GuidedTour"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/folder/FolderItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./FolderItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/itemsScope/ItemsScopeItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeItemContent"],t,n)}).then(function(e){return e.knockoutResourceKey.local})})})});
define("odsp-next/controls/itemContent/albumItemContentList/AlbumItemContentList.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumItemContentList"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemsScope/CommandBar.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./CommandBar"],t,n)}).then(function(e){return e.knockoutResourceKey.local})})})});
define("odsp-next/controls/firstRunExperience/FirstRunExperience.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./FirstRunExperience"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/providers/guidedTour/GuidedTourProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./GuidedTourProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/clipboard/ClipboardHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ClipboardHelper"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/bindings/contextMenu/ContextMenuHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.items=t.items.filter(s);n.rootElementClass=t.rootElementClass||null;n.boundingElementClass=t.boundingElementClass||null;n.shouldHideIcons=!!t.shouldHideIcons;n.engagementSource=t.engagementSource||null;n.alignment=t.alignment;n.point=t.point;n.anchorElement=t.anchorElement;n.isMenuOpen=t.isMenuOpen;var r=t.dismissOnClick,i=void 0===r||r;n.dismissOnClick=i;return n}return t})(r.default);function s(e){return 8==(8&e.location)}t.default=i});
define("odsp-next/models/inAppMessaging/MessagingTypeHelper",["require","exports","../../utilities/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertInAppMessageToPremiumUpsellType=function(e){switch(e){case 101:return 101;case 102:return 1;case 126:return 2;case 127:return 3;case 151:return 5;case 152:return 6;case 303:return n.isFeatureEnabled(n.InAppMessagingMLUpsellPositioning)?7:void 0}};t.POSITIONING_MESSAGES=[102,101,127,126,151,152];t.UPSELL_MESSAGES=[303];t.FAMILIESGROUPS_MESSAGES=[401,451];t.isPositioningMessage=function(e){return-1!==t.POSITIONING_MESSAGES.indexOf(e)};t.isUpsellMessage=function(e){return-1!==t.UPSELL_MESSAGES.indexOf(e)}});
define("odsp-next/models/vault/VaultUpsellType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.None=0]="None";e[e.Created=1]="Created";e[e.Premium=2]="Premium"})(t.UpsellType||(t.UpsellType={}))});
define("odsp-next/controls/vaultTeachingBubble/VaultTeachingBubbleHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isVaultInContainer=function(){var e=document.getElementsByClassName("od-FolderItemContent-list"),t=e&&e[0]&&e[0].getBoundingClientRect(),n=document.getElementsByClassName("od-VaultSection"),r=document.getElementsByClassName("ms-VaultCover"),i=n[0]?n[0]:r[0],s=i&&i.getBoundingClientRect();return!(!s||!t)&&(Math.abs(s.top)>=Math.abs(t.top)&&Math.abs(s.bottom)<=Math.abs(document.documentElement.clientHeight))}});
define("odsp-next/controls/listFooter/ListFooter",["require","exports","./ListFooter.html","./ListFooterViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-list-footer",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/listFooter/ListFooter.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:isVisible()--\x3e<div class="od-ListFooter">\x3c!--ko if:!dragAndDropHintComponent--\x3e<div class="od-ListFooter-dragAndDropHint" data-bind="component:{name:dragAndDropHintTagName,params:{}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!!dragAndDropHintComponent--\x3e\x3c!--ko with:dragAndDropHintComponent--\x3e<div class="od-ListFooter-dragAndDropHint" data-bind="component:$data"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showRecycleBinInFooter()--\x3e<div class="od-ListFooter-recycleBin"><span class="od-ListFooter-recycleBinText" data-bind="text:recycleBinText"></span><a href=";" class="od-ListFooter-recycleBinLink" data-bind="text:recycleBinLink,click:onRecycleBinClick"></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/listFooter/ListFooterViewModel",["require","exports","tslib","./ListFooter.resx","../../resources/ControlResourceKeys","../dragAndDrop/dragAndDropHint/DragAndDropHint","../../utilities/features/Features","../../models/itemSet/ItemSetMonitor","@ms/odsp-shared/lib/base/ViewModel","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(i.actionMap);n._isItemSetRendered=n.resources.consume(i.isItemSetRendered);n._itemSetMonitor=n.resources.consume(u.resourceKey);n._recycleBinProvider=n.resources.consume(f.recycleBin.optional);n.dragAndDropHintTagName=s.default.tagName;n.recycleBinLink=r.default.RecycleBinLink;n.recycleBinText=r.default.RecycleBinText;n.isVisible=n.createPureComputed(n._computeShowListFooter);n._recycleBinItem=n.createPureComputed(n._computeRecycleBinItem);n._openRecycleBinAction=new(n.child(n._actionMap.DefaultClickAction))({sourceEngagement:"ListFooter.OpenRecycleBin.Click",item:n._recycleBinItem});n.showRecycleBinInFooter=n.createPureComputed(n._computeShowRecycleBinInFooter);n.dragAndDropHintComponent=t.dragAndDropHintComponent;return n}t.prototype.onRecycleBinClick=function(e,t){this._openRecycleBinAction.execute(t).done()};t.prototype._computeRecycleBinItem=function(){var e=this._itemSetMonitor.itemSet();e.content();return!e.isPlaceholder&&this._recycleBinProvider?this._recycleBinProvider.getRecycleBinItem(this._itemSetMonitor.item.peek()):null};t.prototype._computeShowListFooter=function(){var e=this._itemSetMonitor.itemSet();e.content();return this._isItemSetRendered()&&!e.isPlaceholder};t.prototype._computeShowRecycleBinInFooter=function(){return o.isFeatureEnabled(o.RecycleBinListFooter)&&this._openRecycleBinAction.isAvailable()};return t})(a.default);t.default=l});
define("odsp-next/controls/overlays/oneUp/OneUpOverlay",["require","exports","./OneUpOverlay.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OneUpOverlayViewModel","ODCFiles_css","../Overlay"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-one-up-overlay",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/overlays/oneUp/OneUpOverlay.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="od-OneUpOverlay" data-overlay-parent="true" role="presentation" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},host"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/overlays/oneUp/OneUpOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/focus/FocusTrapBinding","../Overlay"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=f.default.tagName;n.addBindingHandlers({host:i.default,interactionScope:s.default,preserveFocus:o.default,recoverFocus:u.default,focusTrap:a.default});return n}return t})(r.default);t.default=l});
define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBanner",["require","exports","./UnauthenticatedBanner.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UnauthenticatedBannerViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAST_SIGN_IN_DIALOG=i.LAST_SIGN_IN_DIALOG;var s=r.registerComponent({tagName:"od-unauthenticated-banner",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBanner.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-unauthenticatedBanner"><button class="od-unauthenticatedBanner-OneDrive" data-bind="text:brandingString,attr:{href:homePageURL,alt:brandingString},click:onClickOneDrive"></button><div class="od-unauthenticatedBanner-AccountBox"><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignIn" data-bind="attr:{href:signInURL},text:signIn,click:onClickSignIn"></button><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignUp" data-bind="attr:{href:signUpURL},text:signUp,click:onClickSignUp"></button></div></div>\x3c!--ko if:showSignIn--\x3e\x3c!--ko component:{name:signInDialogTagName,params:{onCancel:onClickClose}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/unauthenticatedBanner/UnauthenticatedBannerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ControlResourceKeys","./UnauthenticatedBanner.resx","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../signInDialog/SignInDialog","../../utilities/browser/ResponsiveUI","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAST_SIGN_IN_DIALOG="lastSignInDialog";var h=(function(e){n.__extends(r,e);function r(n){void 0===n&&(n={});var r=e.call(this,n)||this;r.signUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var h=encodeURIComponent(window.location.href);r.signInURL="https://login.live.com/login.srf?wa=wsignin1.0&wreply="+h;r.homePageURL="https://go.microsoft.com/fwlink/?linkid=853503";r.brandingString=o.default.brandingString;r.signIn=o.default.signIn;r.signInDialogTagName=f.default.tagName;r.signUp=o.default.signUp;r._actionMap=r.resources.consume(s.actionMap);r._responsiveUI=r.resources.consume(l.resourceKey);r._navigation=r.resources.consume(i.navigation);r._onClickSignUpAction=new(r.managed(r._actionMap.NavigationAction))({url:r.signUpURL});r._onClickSignInAction=new(r.managed(r._actionMap.NavigationAction))({url:r.signInURL});r._onClickOneDriveAction=new(r.managed(r._actionMap.NavigationAction))({url:r.homePageURL});r.showCloseButton=r.createObservable(!0);r.onClickClose=r.onClickClose.bind(r);r._dataStore=new u.default("SignInDialogCounter",a.default.local);var p=r._dataStore.getValue(t.LAST_SIGN_IN_DIALOG),d=r._responsiveUI.compareSize(r._responsiveUI.formFactorSize.peek(),"Small")>0,v=r.resources.consume(s.didUserEnterPasswordForFile),m=!1;if(c.isFeatureEnabled(c.EnableAnonymousSigninDialog)){m=d&&!v.peek();p&&(m=m&&p+864e5<=Date.now());m&&r._dataStore.setValue(t.LAST_SIGN_IN_DIALOG,Date.now())}r.showSignIn=r.createObservable(m);return r}r.prototype.onClickSignUp=function(e,t){this._onClickSignUpAction.execute(t)};r.prototype.onClickSignIn=function(e,t){var n="1"===this._navigation.viewParams.expectsBusiness;c.isFeatureEnabled(c.UnauthenticatedBannerUseSigninDialog)||n?this.showSignIn(!0):this._onClickSignInAction.execute(t)};r.prototype.onClickOneDrive=function(e,t){this._onClickOneDriveAction.execute(t)};r.prototype.onClickClose=function(e){this.showSignIn(!1)};return r})(r.default);t.default=h});
define("odsp-next/controls/signInDialog/SignInDialog",["require","exports","./SignInDialog.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SignInDialogViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-SignInDialog",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/signInDialog/SignInDialog.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:overlayComponent--\x3e<div class="od-SignInDialog-modal"><div class="ms-ModalOverlay"></div>\x3c!--ko focusTrap:{}--\x3e<div tabindex="-1" role="dialog" class="od-SignInDialogMSAVar" data-bind="preserveFocus:true,interactionScope:{isScope:true},dismiss:{close:onClickOutCancel},recoverFocus:{isEnabled:true},attr:{\'aria-labelledby\':\'signInDialog\',\'aria-describedby\':\'od-SignInDialog-content\'}"><div id="signInDialog" class="ms-accessible" data-bind="text:dialogLabel"></div><div id="od-SignInDialog-content"><div class="od-SignInDialogMSAVar-header"><img data-bind="attr:{src:logoURL,alt:logoLabelString}"></div><div class="od-SignInDialogMSAVar-content"><div class="od-SignInDialogMSAVar-upsell" data-bind="text:MSAupsellText"></div><div class="od-SignInDialogMSAVar-useMSA" data-bind="bindableHtml:useMSAccount"></div><input type="text" class="od-SignInDialogMSAVar-input" data-bind="textInput:username,keyboard:{allowButtonEvents:true,mappings:{Enter:onClickSignInDialog}},attr:{\'aria-label\':usernameLabel,placeholder:usernameInputPlaceholder}"><div id="signInDialog" class="ms-accessible" data-bind="text:usernameLabel"></div><button class="od-SignInDialogMSAVar-next od-button" data-bind="text:nextString,click:onClickSignInDialog,attr:{\'aria-label\':nextLabel}"></button><div class="od-SignInDialogMSAVar-createMSA" data-bind="bindableHtml:createAccountString"></div><div class="od-SignInDialogMSAVar-line"></div><button class="od-Button od-SignInDialogMSAVar-dismiss" data-bind="text:dismissText,click:onClickCancelFooter"></button><button class="od-SignInDialog-close" data-bind="attr:{\'aria-label\':closeLabel,title:closeLabel},click:onClickCancelX"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/signInDialog/SignInDialogViewModel",["require","exports","tslib","cookies","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../overlays/Overlay","../../bindings/dismiss/DismissBinding","../../bindings/html/BindableHtmlBinding","./SignInDialog.resx","../../bindings/focus/FocusTrapBinding","../../bindings/focus/RecoverFocusBinding","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/focus/PreserveFocusBinding","../../bindings/keyboard/KeyboardBinding","../../resources/ControlResourceKeys","../../bindings/interactionScope/InteractionScopeBinding","../../resources/DataSourceResourceKeys","../../providers/engagement/Engagement","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MSAccountInfoURL="https://go.microsoft.com/fwlink/?linkid=853223";t.MSASignUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var S;(function(e){e.INVALID_EMAIL="Error.Invalid Email";e.API_TIMEOUT="Error.API Timeout";e.MS_ACCOUNT="MSAccount";e.ORG_ID_PLACEHOLDER="OrgId,Placeholder";e.NEITHER="Neither";e.BOTH="Both"})(S||(S={}));var x=(function(e){n.__extends(o,e);function o(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:f.default,focusTrap:h.default,bindableHtml:l.default,keyboard:m.default,recoverFocus:p.default,preserveFocus:v.default,interactionScope:y.default});var r=n.resources.consume(g.actionMap);n._identityDataSource=n.resources.consume(b.identity);n._engagement=n.resources.consume(w.resourceKey);n._navigation=n.resources.consume(u.navigation);n._setUpDialogStrings();n._setUpMSAVariation();n._onClickSignUpAction=new(n.managed(r.NavigationAction))({url:n.signUpURL});n._onClickSignInAction=new(n.managed(r.NavigationAction))({url:n._signInURL});n._onCancel=t.onCancel;n.overlayComponent={name:a.default.tagName,params:{animation:{},alignToParent:!1}};n._engagement.logData({name:"Display.SignInDialog"});return n}o.prototype.dismissedDialog=function(e,t){this._onCancel&&this._onCancel(t)};o.prototype.onClickOutCancel=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.OutsideDialog.Click",isIntentional:!0});this.dismissedDialog(e,t)};o.prototype.onClickCancelX=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.XButton.Click",isIntentional:!0});this.dismissedDialog(e,t)};o.prototype.onClickCancelFooter=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.CancelFooter.Click",isIntentional:!0});this.dismissedDialog(e,t)};o.prototype.onClickSignUpDialog=function(e,t){this._onClickSignUpAction.execute(t);this._engagement.logData({name:"SignUp.SignInDialog.CreateOneLink.Click",isIntentional:!0})};o.prototype.onClickSignInDialog=function(e,t){var n=this,r=encodeURIComponent(this.username.peek());this._signInURL=this._signInURL+"&username="+r;var o="1"===this._navigation.viewParams.expectsBusiness;if(E.isFeatureEnabled(E.SigninDialogSupportBusinessAccounts)||o){var u=new s.default({name:"SignInDialog.GetIdentityProvider"});i.default.start({url:"https://odc.officeapps.live.com/odc/emailhrd/getidp?hm=0&emailAddress="+r+"&_="+Date.now(),method:"GET",requestTimeoutInMS:3e3}).then(function(e){if(e.status>=200&&e.status<400){var t=e.responseText;u.end({resultType:s.ResultTypeEnum.Success,extraData:{identityProviderResponse:t}});switch(t){case S.ORG_ID_PLACEHOLDER:n._continueBusinessSignin(r);break;default:n._continueSignin()}}else{u.end({resultType:s.ResultTypeEnum.Failure,resultCode:"ErrorResponse",error:e.status+" - "+e.responseText});n._continueSignin()}},function(e){u.end({resultType:s.ResultTypeEnum.Failure,resultCode:"Generic",error:e.status+" - "+e.responseText});n._continueSignin()})}else this._continueSignin();this._engagement.logData({name:"SignIn.SignInDialog.NextButton.Click",isIntentional:!0})};o.prototype._continueSignin=function(){var e=this.resources.consume(g.actionMap);this._onClickSignInAction=new(this.managed(e.NavigationAction))({url:this._signInURL});this._onClickSignInAction.execute(event)};o.prototype._continueBusinessSignin=function(e){r.set("aad_redirect_url",window.location.href);this._signInURL="https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/oauth2/authorize?response_type=id_token+code&redirect_uri=https%3a%2f%2fonedrive.live.com%2fbusiness&client_id=6a9b9266-8161-4a7b-913a-a9eda19da220&scope=openid&response_mode=form_post&nonce=01F08DF7-CA7E-4BB6-A2D1-AAE2E2F1BF44&msafed=0&state=aad_redirect_url&domain_hint=organizations&login_hint="+e;this._continueSignin()};o.prototype._setUpDialogStrings=function(){this.logoLabelString=c.default.MicrosoftLogoLabel;this.closeLabel=c.default.closeLabel;this.upsellText=c.default.upsellString;this.signUpText=c.default.signUp;this.dismissText=c.default.dismiss;this.logoURL=window.require.toUrl("odsp-media/images/signindialog/microsoft_logo.svg");this.cloudsURL=window.require.toUrl("odsp-media/images/signindialog/clouds.png");var e=encodeURIComponent(window.location.href);this._signInURL=this._identityDataSource.getSignInUrl()+e;this.signUpText=c.default.signUp;this.signUpURL=t.MSASignUpURL;this.username=this.createObservable("");this.usernameLabel=c.default.usernameLabelString;this.usernameInputPlaceholder=c.default.MSAInputPlaceholder;var n=this.resources.consume(g.focusItem);this.dialogLabel=this.createPureComputed(function(){return(n()().displayName||"")+". "+c.default.dialogLabelString});this.MSAupsellText=c.default.MSAVarUpsell};o.prototype._setUpMSAVariation=function(){var e="<a href='"+t.MSAccountInfoURL+"'>";this.useMSAccount=d.format(c.default.UseMSA,e,"</a>");var n='<a data-bind="click: onClickSignUpDialog" href=\''+this.signUpURL+"'>";this.createAccountString=d.format(c.default.CreateMSA,n,"</a>");this.nextString=c.default.MSANext;this.nextLabel=c.default.MSANextLabel};return o})(o.default);t.default=x});
define("odsp-next/bindings/html/BindableHtmlBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeRefreshChildElements);return n}t.prototype._computeRefreshChildElements=function(){var e=i.unwrap(this.valueAccessor());i.virtualElements.emptyNode(this.element);this.element.innerHTML=e;i.applyBindingsToDescendants(this.bindingContext,this.element)};return t})(r.default);t.default=s});
define("odsp-next/controls/list/viewModels/DetailsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/DetailsLayout","../layouts/MobileDetailsLayout","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../detailsRow/DetailsRow","../../detailsHeader/DetailsHeader"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,a=r.resources.consume(u.platformDetection),f=new(r.managed(a.isMobile&&r.resources.isExposed(o.useMobileList)&&r.resources.consume(o.useMobileList)?s.default:i.default))(t);r.initialize(f);return r}return t})(r.default);t.default=a});
define("odsp-next/controls/list/viewModels/ListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../../../bindings/selection/MultiSelectBinding","../../../bindings/viewport/ViewportBinding","../../../bindings/customRender/CustomRenderBinding","../../../bindings/keyboard/KeyboardBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/contextMenu/ContextMenuBinding","../../../bindings/pulse/PulseBinding","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-utilities/lib/object/ObjectUtil","../../../bindings/selection/MarqueeSelectionBinding","../../../bindings/selection/ClearSelectionBinding","../../../bindings/element/ElementBinding","@ms/odsp-shared/lib/utilities/logging/events/ListViewStartRender.event","../../../providers/engagement/Engagement","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIST_VIEW_SURFACE_CLASSNAME="List-surface";t.LIST_VIEW_PAGE_CLASSNAME="List-page";t.LIST_VIEW_CELL_CLASSNAME="List-cell";t.MAX_PAGE_HEIGHT=1e6;var N=(function(e){n.__extends(r,e);function r(t,n){var r=e.call(this,t)||this;r.headerParams={};var d=n.element;r.addBindingHandlers({selection:s.default,marqueeSelection:g.default,clearSelection:y.default,viewport:o.default,contextMenu:h.default,customRender:u.default,keyboard:a.default,pulse:p.default,element:b.default,interactionScope:f.default,recoverFocus:l.default});r._renderedCellsByKey={};r._renderedCellsByIndex={};r._visibleCells=[];r.surfaceElement=r.createObservable();r.placeHolderHeight=r.createObservable(0);r.pages=[];r.viewport={viewport:r.createObservable({width:0,height:0,visibleTop:0,visibleBottom:0}),scrollElement:c.getScrollContainer(d)};r._viewport=r.createPureComputed(function(){return r.viewport.viewport()}).extend({rateLimit:0});r._asyncEnqueueOffScreenRenders=r.async.debounce(r._enqueueOffScreenRenders,400);var T=t.isSelectionOnKeyInputEnabled,N=void 0===T||T,C=t.layoutIterationObservable,k=void 0===C?r.createObservable(0):C,L=t.enableMarqueeSelection,A=void 0!==L&&L,O=t.enableClearSelection,M=void 0===O||O;r.isSelectionOnKeyInputEnabled=N;r.visibleModels=i.observable();r.itemSet=t.itemSet;r._itemHistoryProvider=r.resources.isExposed(S.itemHistory)?r.resources.consume(S.itemHistory):null;r.items=r.createComputed(r._computeItems);r.selectionModel=t.selectionModel;r.enableMarqueeSelection=A;r.enableClearSelection=M;r.requiredRange=i.observable({start:0,end:0});r.requiredRange.equalityComparer=m.deepCompare;r.headerType=i.observable("");r.headerStyle=i.observable("");r._findElements(d,t);r.contextMenuHelper=t.contextMenuHelper;r.tooltip=t.tooltip;r._layoutIteration=k;r.requiredGroup=t.requiredGroup;r._isItemSetRendered=r.resources.consume(x.isItemSetRendered);r.activeLayout=i.observable();r.activeLayout.equalityComparer=v.objectStrictEquality;r._isLoading=t.isLoading||i.observable(!0);r._isLoading(!0);r._headerVisibleObservable=i.observable(i.observable(!0));r.headerVisible=r.createPureComputed(r._computeHeaderVisible);r.isActive=r.createObservable(!0);r.tabIndex=r.createObservable(0);r.resources.consume(E.resourceKey).logData({name:"ListView.AppLoad"});r._change=r.async.debounce(function(){r.isDisposed||r._onLayoutChanged()},50,{maxWait:200});r._updateVisibles=r.async.debounce(function(){if(!r.isDisposed&&r.activeLayout().supportsLazyBinding()){for(var e=0,t=r._visibleCells;e<t.length;e++){var n=t[e].element.firstChild,s=n&&i.dataFor(n);s&&s.activateBindings&&s.activateBindings()}r.bindingsActivated=!0}},500);r._updateAnchor=r.async.debounce(r._handleUpdateAnchor,501);r.subscribe(r._viewport,function(){r.activeLayout()&&r.activeLayout().updateViewport(r._viewport())});var _=r.createComputed(function(){t.requiredRange&&t.requiredRange(r.requiredRange())}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});r._itemHistoryProvider&&r.createBackgroundComputed(function(){r._itemHistoryProvider.currentItem()});r.subscribe(r.itemSet,function(){r._isLoading(!0);var e=r.surfaceElement.peek();e&&r.placeHolderHeight.peek()<e.scrollHeight&&r.placeHolderHeight(e.scrollHeight);r._isItemSetRendered(!1);r._removeAll();r.requiredRange({start:0,end:0});_();w.ListViewStartRender.logData()});r.subscribe(r.selectionModel.focusedItem,function(){r.makePages(r.activeLayout.peek().getSurfaceSize().height);r._renderFocusCell();r._change()});r.createBackgroundComputed(function(){var e=r.itemSet();e.content();e.isExpired&&r._removeCells(r.activeLayout().getVisibleRange())});t.visibleItemRange&&r.createBackgroundComputed(function(){r._layoutIteration();var e=r.activeLayout();e?t.visibleItemRange(e.getVisibleItemRange(r.viewport.viewport())):t.visibleItemRange({start:0,end:0})});return r}r.prototype.initialize=function(e){var t=this,n=this.activeLayout.peek();this._isItemSetRendered(!1);if(n){this.events.off(n);n.dispose()}this.events.on(e,"change",function(){t._change();t._updateVisibles();t._updateAnchor()});this.activeLayout(e);T.default.mark("EUPL.ListView.Init");e.updateViewport(this._viewport.peek())};r.prototype.isReadyToBeSelected=function(e){var t=!1;e&&this._renderedCellsByKey[e().key]&&(t=!0);return t};r.prototype.makePages=function(e){for(var n=Math.ceil(e/t.MAX_PAGE_HEIGHT),r=0;r<n;r++){var s=this.pages[r],o=t.MAX_PAGE_HEIGHT;if(!s){var u=document.createElement("div");u.className=t.LIST_VIEW_PAGE_CLASSNAME;u.style.height=o+"px";this._surfaceElement.appendChild(u);s=this.pages[r]={element:u,start:r*t.MAX_PAGE_HEIGHT,index:r}}r===n-1&&(o=e-t.MAX_PAGE_HEIGHT*r);s.element.style.height=o+"px"}if(this.pages.length>n){this.pages.splice(n).map(function(e){i.removeNode(e.element)})}var a=this.selectionModel.focusedItem.peek();this._firstGroupHeader&&!a&&this._focusFirstHeader()};r.prototype.setCellWidth=function(e,t){e.width=t.width};r.prototype._handleUpdateAnchor=function(){if(!this.isDisposed&&this._itemHistoryProvider){var e=this.activeLayout().getVisibleRange().start,t=this.itemSet.peek(),n=t.content.peek().items;if(e>=0&&e<n.length){var r=n[e],i=this._itemHistoryProvider.getHistoryItemByKey(t.key);i&&r&&i.anchorItem(r.peek())}}};r.prototype._findElements=function(e,n){var r=this;this._surfaceElement=e.getElementsByClassName(t.LIST_VIEW_SURFACE_CLASSNAME)[0];this.events.on(this._surfaceElement,"focus",function(){if(r._firstGroupHeader||r._layoutIteration.peek()<1){r.selectionModel.clear(!0);r._focusFirstHeader()}else{var e=r.selectionModel.focusedItem.peek();e||(e=r.selectionModel.getItems()[0]);e&&r.selectionModel.setItemFocus(e,{isFocusInput:!1})}})};r.prototype._onLayoutChanged=function(){T.default.mark("EUPL.ListViewModel.LayoutChanged");var e=this.activeLayout();if(e){for(var t=e.getSurfaceSize().height;t!==this._lastHeight;){this._lastHeight=t;t=e.getSurfaceSize().height;this._change();return}this.makePages(t);var n=e.supportsGrouping(),r=e.getVisibleRange(),s=e.getVisibleItemRange(),o=e.getMaterializedRange(),u=n?e.getRequiredGroup():null,a=e.getHeaderCell();if(a){this.headerParams=a.viewData;this.headerStyle("margin-"+d.default.safeLeft+": "+a.left+"px; width: "+a.width+"px; height: "+a.height+"px;");this.headerType(a.viewType);this._headerVisibleObservable(a.headerVisible?a.headerVisible:i.observable(!0))}var f=e.getAllFocusableItems();f&&this.selectionModel.setAllFocusableItems(f);T.default.mark("EUPL.ListView.RenderCell.Start");this._visibleCells=this._renderRange(r);T.default.mark("EUPL.ListView.RenderCell.End");this.placeHolderHeight(0===this._visibleCells.length?t:0);this._isLoading(!1);var l=this._viewport.peek().width,c=this.items().length,h=this._lastItemsLength,p=void 0===h?c:h,v=this._lastWidth,m=void 0===v?l:v,g=this.items().length!==p;this._lastItemsLength=c;if(n){var y=e.getVisibleItemCount(),b=this._lastVisibleItemsLength;g=g||y!==(void 0===b?y:b);this._lastVisibleItemsLength=y}(l!==m||g)&&(r.start<0||r.end<0?this._removeAll():this._removeCells(r));this._lastWidth=l;this._rangesToUpdate=[];this._asyncEnqueueOffScreenRenders(o,r);this._renderFocusCell();u&&this.requiredGroup?this.requiredGroup(u):s.end>0&&this.requiredRange(s);if(this._layoutIteration){var w=this._layoutIteration.peek();this._layoutIteration(w+1)}}};r.prototype._renderFocusCell=function(){var e=this,t=this._getFocusedKey(),n=0;if(t){var r=this.activeLayout().getCellByKey(t),i=this._renderedCellsByKey[t];if(r){i?this._updateCell(r):this._createCell(r);n=-1}else i&&this._removeCell(t)}else document.activeElement===this._surfaceElement&&this.async.setTimeout(function(){if(e._firstGroupHeader)e._focusFirstHeader();else{var t=e.selectionModel.getItems()[0];t&&document.activeElement===e._surfaceElement&&e.selectionModel.setItemFocus(t,{isFocusInput:!1})}},0);this.tabIndex(n)};r.prototype._renderRange=function(e){var t=this,n=this.activeLayout(),r={},i={},s=[];this.bindingsActivated=!1;for(var o=function(e){if(e&&e.viewType){var n=t._renderedCellsByKey[e.key];n?i[e.key]=e:n=t._createCell(e);s.push(n);r[e.key]=!1}},u=e.start;u>=0&&u<=e.end;u++){var a=n.getCellAt(u),f=this._renderedCellsByIndex[u];o(a);!f||a&&f.key===a.key||void 0!==r[f.key]||(r[f.key]=!0)}for(var l in r)r[l]&&this._removeCell(l);for(var c in i){a=i[c];this._updateCell(a)}this._isItemSetRendered(!0);return s};r.prototype._updateCell=function(e){var n=e.cellIndex,r=this._renderedCellsByKey[e.key],i=r.element.style;r.cellIndex!==n&&r===this._renderedCellsByIndex[r.cellIndex]&&delete this._renderedCellsByIndex[r.cellIndex];var s=this.pages[Math.floor(e.top/t.MAX_PAGE_HEIGHT)];r.cellIndex=n;r.top=e.top-s.start;r.left=e.left;this.setCellWidth(r,e);r.height=e.height;r.element.setAttribute("data-index",""+r.index);r.element.setAttribute("data-key",r.key);r.viewData&&r.viewData.cellSize({width:r.width,height:r.height});i[d.default.safeLeft]=r.left+"px";i.top=r.top+"px";i.width=r.width+"px";i.height=r.height+"px";this._renderedCellsByIndex[n]=r};r.prototype._createCell=function(e){var n=e.key,r=e.index,s=e.cellIndex,o=e.width,u=e.height,a=e.left,f=e.top,l=e.viewType,c=e.viewData,h=document.createElement("div");h.className=t.LIST_VIEW_CELL_CLASSNAME;h.setAttribute("role","listitem");0===s&&c.group&&(this._firstGroupHeader=h);var p=m.extend({cellSize:this.createObservable({width:o,height:u})},c),d=this._renderedCellsByKey[e.key]={key:n,index:r,cellIndex:s,width:o,height:u,left:a,top:f,viewType:l,viewData:p,element:h};this._updateCell(e);l&&i.applyBindingsToNode(h,{component:{name:l,params:p}},i.contextFor(this._surfaceElement));this.pages[Math.floor(e.top/t.MAX_PAGE_HEIGHT)].element.appendChild(h);return d};r.prototype._processRanges=function(){var e=this;if(!this._processRangeEnqueued){this._processRangeEnqueued=!0;this.async.setTimeout(function(){e._processRangeEnqueued=!1;var t=e._rangesToUpdate.shift();if(t)if(t.remove)e._removeCells(t);else{e.makePages(e.activeLayout.peek().getSurfaceSize().height);e._renderRange(t)}e._rangesToUpdate.length&&e._processRanges()},4)}};r.prototype._enqueueOffScreenRenders=function(e,t){if(t.start>-1&&t.end>-1){for(var n=t.end+1;n<=e.end;n+=4)this._rangesToUpdate.push({start:n,end:n+4-1});this._rangesToUpdate.push({start:e.start,end:e.end,remove:!0});for(n=t.start-1-4;n>=e.start;n-=4)this._rangesToUpdate.push({start:n,end:n+4-1});this._processRanges()}};r.prototype._removeAll=function(){for(var e in this._renderedCellsByKey){var t=this._renderedCellsByKey[e];i.cleanNode(t.element)}for(var n in this.pages)if(this.pages.hasOwnProperty(n)){var r=this.pages[n];r.element.innerHTML="";r.element.style.height="0px"}this._renderedCellsByIndex={};this._renderedCellsByKey={}};r.prototype._removeCells=function(e){for(var t=i.utils.extend({},this._renderedCellsByKey),n=this.activeLayout(),r=e.start;e.start>=0&&r<=e.end;r++){var s=n.getCellAt(r);s&&delete t[s.key]}var o=this._getFocusedKey();o&&delete t[o];for(var u in t)this._removeCell(u)};r.prototype._removeCell=function(e){var t=this._renderedCellsByKey[e];i.removeNode(t.element);delete this._renderedCellsByKey[e];this._renderedCellsByIndex[t.cellIndex]===t&&delete this._renderedCellsByIndex[t.cellIndex]};r.prototype._computeItems=function(){return this.itemSet().content().items};r.prototype._computeHeaderVisible=function(){return this._headerVisibleObservable()()};r.prototype._getFocusedKey=function(){var e=this.peekUnwrapObservable(this.peekUnwrapObservable(this.selectionModel.focusedItem));return e&&e.key};r.prototype._focusFirstHeader=function(){if(this._firstGroupHeader){var e=this._firstGroupHeader.children[0];if(e){var t=this._getScrollPosition(),n=t.scrollTop,r=t.scrollLeft;e.focus();this._setScrollPosition(n,r)}}};r.prototype._getScrollPosition=function(){var e=this.viewport.scrollElement;return{scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}};r.prototype._setScrollPosition=function(e,t){var n=this.viewport.scrollElement;n.scrollTop!==e&&(n.scrollTop=e);n.scrollLeft!==t&&(n.scrollLeft=t)};return r})(r.default);t.default=N});
define("odsp-next/bindings/selection/MultiSelectBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","@uifabric/utilities/lib/KeyCodes","../../utilities/events/EventTargetFilters"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=r.layout,s=r.selectionModel,o=r.isSelectionOnKeyInputEnabled,u=void 0===o||o,a=r.shouldRespectInputKeyboardEvent,f=void 0!==a&&a,l=r.cancelBubbleOnArrowKey,c=void 0!==l&&l;n._isSelectionOnKeyInputEnabled=u;n._layout=i;n._selectionModel=s;n._shouldRespectInputKeyboardEvent=f;n._cancelBubbleOnArrowKey=c;n.events.on(n.element,"click",n._onClick);n.events.on(n.element,"keydown",n._onKeyDown);return n}t.prototype._onKeyDown=function(e){var t=e.target,n=o.isInputElement(t);if(!this._shouldRespectInputKeyboardEvent&&n)return!0;if(e.altKey)return!0;var r=this._selectionModel,i=this._layout(),u=r.getFocusIndex(),a=-1,f=!!e.shiftKey,l=!!e.metaKey,c=!!e.ctrlKey,h=!0;switch(e.which){case s.KeyCodes.up:h=(a=i.getItemIndexAbove(u))!==u;break;case s.KeyCodes.down:h=(a=i.getItemIndexBelow(u))!==u;break;case s.KeyCodes.left:h=(a=i.getItemIndexLeft(u))!==u;break;case s.KeyCodes.right:h=(a=i.getItemIndexRight(u))!==u;break;case s.KeyCodes.home:a=0;break;case s.KeyCodes.end:a=r.getItems().length-1;break;case s.KeyCodes.space:if(o.isButtonElement(t))return!0;r.toggleIndexSelected(u);break;case s.KeyCodes.enter:return!(!o.isButtonElement(t)&&this.element.contains(t))||r.invokeFocusedItem(e);default:return}if(a>=0)if(f){c||l||r.clear();r.selectToIndex(a);r.setIndexFocus(a,{preventAnchor:!0})}else if(c||l)r.setIndexFocus(a);else{r.clear();this._isSelectionOnKeyInputEnabled&&r.setIndexSelected(a,!0);r.setIndexFocus(a)}return!this._cancelBubbleOnArrowKey&&!h};t.prototype._onClick=function(e){var t=this._getItemFromElement(e.target);if(t){var n=this._selectionModel,r=!!e.shiftKey,i=!!e.metaKey,s=!!e.ctrlKey;if(r){s||n.clear();n.selectToItem(t);n.setItemFocus(t,{preventAnchor:!0})}else if(s||i){n.setItemSelected(t,!0);n.setItemFocus(t)}else{if(!n.isItemSelected(t)||n.selection().length>1){n.clear();n.setItemSelected(t,!0)}n.setItemFocus(t)}e.stopPropagation();e.preventDefault()}};t.prototype._getItemFromElement=function(e){for(var t,n=r.contextFor(e);n&&!t;){t=n&&n.$data&&"function"==typeof n.$data.getItem?n.$data.getItem():null;n=n.$parentContext}return t};return t})(i.default);t.default=u});
define("odsp-next/bindings/viewport/ViewportBinding",["require","exports","knockout","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}e.init=function(t,s,o,u,a){var f=new r.default(this),l=new i.default(null),c=s(),h=c.scrollElement||document.body,p=c.viewport||c;function d(){f.setTimeout(function(){var n=e.getViewport(t);p(n)},0)}d();l.on(h,"scroll",d);l.on(window,"resize",d);n.utils.domNodeDisposal.addDisposeCallback(t,function(){l.dispose()})};e.getViewport=function(e){var t=e.getBoundingClientRect(),n=window.innerHeight;return{width:t.width,height:n,visibleTop:-t.top,visibleBottom:n-t.top}};return e})();t.default=s});
define("odsp-next/bindings/customRender/CustomRenderBinding",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.init=function(){return{controlsDescendantBindings:!0}};return e})();t.default=n});
define("odsp-next/bindings/pulse/PulseBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._pulseTargets=[];n._throttledPulse=n.async.debounce(n.pulse,5e3);n.createComputed(function(){var e=t.valueAccessor()();if(e&&e.length){var r=e.length;n._pulseTargets=[];for(var i=0;i<r;i++){var s=e[i];if(s&&s.pulseTarget){var o=s.pulseTarget();o&&o.canPulse()&&n._pulseTargets.splice(Math.floor(Math.random()*(1+n._pulseTargets.length)),0,o)}}n._throttledPulse()}else n._pulseTargets=[]});return n}t.prototype.pulse=function(){var e=this,t=2,n=function(){if(t=Math.min(e._pulseTargets.length,t)){var r=e._pulseTargets.shift();if(r){r.pulse();e._pulseTargets.push(r);t--}}t?e.async.setTimeout(n,150):e._throttledPulse()};n()};return t})(r.default);t.default=i});
define("odsp-next/bindings/selection/MarqueeSelectionBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/domUtils/DomUtils","../../resources/ControlResourceKeys","../scrollContainer/ScrollContainerBinding","../autoScroll/AutoScrollBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key","ODCFiles_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.valueAccessor(),s=i.selectionModel,o=i.layout,u=void 0===o?r.observable():o,a=i.isEnabled,p=void 0===a||a;n._selectionModel=s;n._layout=u;n._throttledEvaluateSelection=n.async.throttle(n._evaluateSelection,40);n._isSelecting=r.observable(!1);n._yOffset=r.observable(0);n._offsetElement=r.observable(n.element);n._isEnabled=r.isObservable(p)?p:r.observable(p);n._canUserSelect=n.resources.consume(f.canUserSelect.optional)||n.observables.create(!1);var d=n.resources.consume(h.platformDetection.optional);n._isMobile=!!d&&d.isMobile;n._container=l.getScrollContainer(n.element);n.events.on(n._container,"mousedown",n._onMouseDown);n.events.on(window,"click",n._onClick,!0);new(n.managed(c.default))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{enabled:n._isSelecting,y:n._yOffset}}});return n}t.prototype._getRegion=function(e,t){var n=this._container,r=n.getBoundingClientRect(),i=n.scrollTop,o=n.scrollLeft,u=Math.max(r.left,t.clientX),a=Math.max(r.top,t.clientY),f=new s.default(Math.min(e.x,u+o)-r.left,Math.min(e.y,Math.max(0,a)+i)-r.top,Math.abs(u+o-e.x),Math.abs(a+i-e.y));f.x=Math.max(0,f.x);f.y=Math.max(0,f.y);f.width=Math.min(n.scrollWidth-f.x,f.width);f.height=Math.min(n.scrollHeight-f.y,f.height);return f};t.prototype._getOffsetRegion=function(e){var t=this._container,n=this._offsetElement.peek(),r=new s.default(e);if(n){var i=t.getBoundingClientRect(),o=n.getBoundingClientRect();r.x-=o.left-i.left+t.scrollLeft;r.y-=o.top-i.top+t.scrollTop;u.default.isRightToLeft&&(r.x=o.width-r.x-r.width)}return r};t.prototype._canSelect=function(e){var t=this._layout();return this._isEnabled.peek()&&!!t&&!this._isMobile&&0===this._selectionModel.mode&&!this._selectionModel.isIndexSelected(t.getItemIndicesInRegion(e)[0])&&this._canUserSelect.peek()};t.prototype._onScroll=function(){if(this._marqueeBox){this._onMouseMove(this._lastMouseEvent);this._throttledEvaluateSelection()}};t.prototype._onMouseDown=function(e){if(0===e.button){var t=this._container,n=new o.default(e.clientX,e.clientY+t.scrollTop),r=this._getRegion(n,e),i=this._getOffsetRegion(r);this._suppressNextClick=!1;if(!this._marqueeBox&&this._canSelect(i)&&e.target!==this._container){this._downPoint=n;this._lastMouseEvent=e;this._downPoint=new o.default(e.clientX,e.clientY+t.scrollTop);this._shouldClearSelection=!e.shiftKey;this.events.on(window,"mousemove",this._onMouseMove,!0);this.events.on(window,"mouseup",this._onMouseUp,!0);this.events.on(t,"scroll",this._onScroll)}}};t.prototype._initializeDrag=function(e){this._marqueeArea=a.default.ce("div",{class:"od-MarqueeSelection"});this._marqueeBox=a.default.ce("div",{class:"od-MarqueeSelection-box"});this._shouldClearSelection&&this._selectionModel.clear();this._isSelecting(!0);this._onMouseMove(e);this._marqueeArea.appendChild(this._marqueeBox);this._container.appendChild(this._marqueeArea);this._canUserSelect(!1);this._suppressNextClick=!0};t.prototype._onMouseMove=function(e){var t=e.buttons;if(1===(void 0===t?1:t)){var n=this._container;if(this._downPoint&&!this._marqueeBox){var r=Math.abs(e.clientX-this._downPoint.x),i=Math.abs(e.clientY+n.scrollTop-this._downPoint.y);(r>5||i>5)&&this._initializeDrag(e)}if(this._marqueeBox){this._marqueeArea.style.height=n.scrollHeight+"px";this._lastMouseEvent=e;var s=this._getRegion(this._downPoint,e),o=this._marqueeBox.style;this._yOffset(e.clientY);o.left=s.x+"px";o.top=s.y+"px";o.width=s.width+"px";o.height=s.height+"px";this._lastRegion=s;this._throttledEvaluateSelection();return!1}}else this._onMouseUp(e)};t.prototype._evaluateSelection=function(){var e,t=this._lastRegion,n=this._getOffsetRegion(t),r=this._layout();if(r){e=r.getItemIndicesInRegion(n);for(var i=this._lastIndicesInRegion||[],s=0;s<e.length;s++){for(var o=e[s];i.length&&i[0]!==o;){this._selectionModel.setIndexSelected(i[0],!1);i.shift()}i.length?i.shift():this._selectionModel.setIndexSelected(e[s],!0)}for(;i.length;){this._selectionModel.setIndexSelected(i[0],!1);i.shift()}}this._lastIndicesInRegion=e};t.prototype._onMouseUp=function(e){var t=this;if(0===e.button){var n=!!this._marqueeBox,r=this._container;if(n){this._container.removeChild(this._marqueeArea);this.async.setTimeout(function(){t._suppressNextClick=!1},0)}else this._lastRegion=null;this._isSelecting(!1);this._lastIndicesInRegion=this._downPoint=this._marqueeArea=this._marqueeBox=null;this.events.off(window,"mousemove",this._onMouseMove,!0);this.events.off(window,"mouseup",this._onMouseUp,!0);this.events.off(r,"scroll",this._onScroll);this._canUserSelect(!0);return!n}};t.prototype._onClick=function(e){if(this._suppressNextClick&&0===e.button){this._suppressNextClick=!1;e.stopImmediatePropagation();return!1}return!0};return t})(i.default);t.default=p});
define("odsp-next/bindings/autoScroll/AutoScrollBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding","knockout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._container=i.getScrollContainer(n.element);var r=s.unwrap(n.valueAccessor()),o=r.enabled,u=void 0===o?s.observable(!1):o,a=r.y,f=void 0===a?s.observable(0):a;n._enabled=u;n._y=f;n.createComputed(n._computeScrollOnYPosition);return n}t.prototype._computeScrollOnYPosition=function(){var e=this._enabled(),t=this._container;this.async.clearTimeout(this._timeoutId);this._timeoutId=null;if(e){var n=t.getBoundingClientRect(),r=this._y(),i=n.top,s=i+n.height,o=0;r<=i+100?o=-(1-(r-n.top)/100):r>=s-100&&(o=1-(n.top+n.height-r)/100)}if(o){t.scrollTop=Math.min(t.scrollHeight-n.height,Math.max(0,t.scrollTop+15*o));this._timeoutId=this.async.setTimeout(this._computeScrollOnYPosition,30)}};return t})(r.default);t.default=o});
define("odsp-next/bindings/selection/ClearSelectionBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding","knockout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,o=r.valueAccessor(),u=o.selectionModel,a=o.isEnabled,f=void 0===a||a;r._selectionModel=u;r._isEnabled=s.isObservable(f)?f:s.observable(f);var l=n.getScrollContainer,c=void 0===l?i.getScrollContainer:l;r._container=c(r.element);r.events.on(r._container,"click",r._onClick);return r}t.prototype._onClick=function(e){if(this._isEnabled.peek()&&this._selectionModel.selectedCount.peek()&&e.target!==this._container){this._selectionModel.clear(!0);return!1}return!0};return t})(r.default);t.default=o});
define("odsp-next/controls/list/layouts/DetailsLayout",["require","exports","tslib","knockout","./BaseLayout","../react/SelectionManager","../../../resources/ControlResourceKeys","../../detailsRow/DetailsRow","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(a.platformDetection);n._selectionModel=n.resources.consume(o.itemsSelection);n._isSelectionModal=n.resources.consume(s.isSelectionModalResourceKey);n.cellLocations=r.observable([]);n._checkShown=n.createComputed(function(){return n.isCheckSupported()&&(!n._platform.isMobile||n._isSelectionModal()||n._selectionModel.selection().length>0)});n.rowCheckWidth=n.createComputed(function(){return n._checkShown()?40:0});n.createComputed(function(){n._checksOld!==n._checkShown()&&n.evaluateLayout(!0);n._checksOld=n._checkShown()});return n}t.prototype.isCheckSupported=function(){return!0};t.prototype.getSettings=function(){return{headerHeight:32,rowHeight:36,outerPadding:0,innerPadding:8}};t.prototype.getHeaderCell=function(){var e=this.getSettings();return{key:"details-header",index:0,cellIndex:-1,left:e.outerPadding,top:0,width:this.viewport.width-2*e.outerPadding,height:e.headerHeight,viewType:"ms-details-header",viewData:{itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations}}};t.prototype.getSurfaceSize=function(){return{width:this.viewport.width,height:this.getSettings().rowHeight*this._itemSet.peek().content.peek().items.length}};t.prototype.getVisibleRange=function(){var e=this.viewport,t=this.getSettings();return{start:Math.max(0,Math.floor(e.visibleTop/t.rowHeight)),end:Math.min(this._itemSet.peek().content.peek().items.length-1,Math.floor(e.visibleBottom/t.rowHeight))}};t.prototype.getMaterializedRange=function(){var e=this.getVisibleRange(),t=this.viewport,n=this.getSettings(),r=Math.ceil(t.height/n.rowHeight),i=Math.max(3*r,4),s=Math.max(5*r,4);return{start:Math.max(0,e.start-i),end:Math.min(this._itemSet.peek().content.peek().items.length-1,e.end+s)}};t.prototype.evaluateLayout=function(e){var t=this,n=this._itemSet.peek().schema.peek();if(e||Math.round(this.viewport.width)!==Math.round(this._lastViewportWidth)||this._lastColumnCount!==n.length){this._lastColumnCount=n.length;this._lastViewportWidth=this.viewport.width;this.cellLocations(this.calculateCellLocations(n.filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})))}return!0};t.prototype.calculateCellLocations=function(e){var t,n,r,i=[],s=0,o=this.viewport,u=this.getSettings(),a=o.width-2*u.outerPadding-this.rowCheckWidth.peek();for(n=0;n<e.length;n++){t=e[n];var f=n>0?u.innerPadding:0,l=t.minWidth||t.width;if(t.isCollapsable&&s+f+l>a){l=0;f=0}else r=n;s+=l+f;i.push({left:0,width:l})}for(;s<a&&r>=0;){if(void 0!==(t=e[r]).minWidth){var c=a-s,h=Math.min(c,t.width-t.minWidth);i[r].width+=h;s+=h}r--}var p=this.rowCheckWidth.peek();for(n=0;n<e.length;n++){i[n].left=p;p+=i[n].width+u.innerPadding}return i};t.prototype.getCellCount=function(){return this._itemSet.peek().content.peek().items.length};t.prototype.getCellAt=function(e){var t=this._itemSet.peek().content.peek().items[e],n=t?u.default.tagName:null,r=this.getSettings();return{key:t?t.peek().key:"item-"+e,item:t,index:e,cellIndex:e,viewType:n,viewData:{item:t,itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations,onInvoke:this.onRowInvoke},left:r.outerPadding,top:r.rowHeight*e,width:this.viewport.width-2*r.outerPadding,height:r.rowHeight}};t.prototype.onRowInvoke=function(e){return!0};t.prototype.getCellByKey=function(e){for(var t,n=this._itemSet.peek().content.peek().items,i=0;i<n.length;i++){var s=r.utils.unwrapObservable(n[i]);if(s&&s.key===e){t=this.getCellAt(i);break}}return t};t.prototype.getItemIndexAbove=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e-1))};t.prototype.getItemIndexBelow=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e+1))};t.prototype.getItemIndexLeft=function(e){return e};t.prototype.getItemIndexRight=function(e){return e};t.prototype.getItemIndicesInRegion=function(e){var t=[],n=this.getSurfaceSize();if(e.x+e.width>this.getSettings().outerPadding&&e.x<n.width-this.getSettings().outerPadding&&e.y+e.height>0&&e.y<n.height)for(var r=this.getSettings(),i=Math.max(0,Math.floor(e.y/r.rowHeight)),s=Math.min(this._itemSet().content().items.length-1,Math.floor((e.y+e.height)/r.rowHeight)),o=i;o<=s;o++)t.push(o);return t};t.prototype.getToggleClass=function(){return"DetailsRow-check"};t.prototype.supportsLazyBinding=function(){return!0};return t})(i.default);t.default=f});
define("odsp-next/controls/list/layouts/BaseLayout",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/events/EventGroup","knockout","../../../utilities/browser/ResponsiveUI"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.viewport={width:0,height:0,visibleTop:0,visibleBottom:0};n._itemCanary=s.observable().extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n._itemSet=t.itemSet;n._scrollBarWidth=o.default.getScrollbarWidth();n.subscribe(n._itemSet,n.onItemSetChanged);n._subscribeForContentChange();n._isGrouped=t.isGrouped;n._isGrouped&&n._refreshGroupSubscriptions();n.subscribe(n._itemCanary,n._onItemCanaryChanged);return n}t.prototype.onContentChanged=function(){var e=this;this._disposeItemSubscriptions();this._itemSubscriptions=[];for(var t=this._itemSet.peek().content.peek().items,n=t.length,r=0;r<n;r++){var i=t[r];i&&i.subscribe&&this._itemSubscriptions.push(i.subscribe(function(){return e._itemCanary({})}))}this._isGrouped&&this._refreshGroupSubscriptions();this.evaluateLayout(!0)&&this.change()};t.prototype.onItemSetChanged=function(){this._contentSubscription.dispose();this._subscribeForContentChange();this.onContentChanged()};t.prototype.getHeaderCell=function(){return null};t.prototype.getItemAspectRatio=function(e){return 1};t.prototype.updateViewport=function(e){this.viewport=e;this.evaluateLayout(Math.round(e.width)!==Math.round(this._lastWidth))&&this.change();this._lastWidth=e.width};t.prototype.evaluateLayout=function(e){return!0};t.prototype.change=function(){i.default.raise(this,"change")};t.prototype.dispose=function(){e.prototype.dispose.call(this);this._disposeItemSubscriptions();this._disposeGroupSubscriptions();this._contentSubscription.dispose()};t.prototype.supportsLazyBinding=function(){return!1};t.prototype.supportsGrouping=function(){return!1};t.prototype.getVisibleRange=function(e){void 0===e&&(e=this.viewport);return{start:0,end:0}};t.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);return this.getVisibleRange(e)};t.prototype.getRequiredGroup=function(){return null};t.prototype.getAllFocusableItems=function(){return null};t.prototype.getVisibleItemCount=function(){return 0};t.prototype.onGroupStateChange=function(){this.evaluateLayout(!1)&&this.change()};t.prototype._subscribeForContentChange=function(){this._contentSubscription=this._itemSet.peek().content.subscribe(this.onContentChanged,this)};t.prototype._onItemCanaryChanged=function(){this.evaluateLayout(!0)&&this.change()};t.prototype._disposeItemSubscriptions=function(){if(this._itemSubscriptions)for(var e=0;e<this._itemSubscriptions.length;e++)this._itemSubscriptions[e].dispose();this._itemSubscriptions=null};t.prototype._disposeGroupSubscriptions=function(){if(this._groupSubscriptions&&this._groupSubscriptions.length>0)for(var e=0,t=this._groupSubscriptions;e<t.length;e++){t[e].dispose()}this._groupSubscriptions=null};t.prototype._refreshGroupSubscriptions=function(){var e=this;this._disposeGroupSubscriptions();this._groupSubscriptions=[];var t=this._itemSet.peek().content.peek().groupings;if(t&&t.length)for(var n=0,r=t;n<r.length;n++){var i=r[n].itemGroups;i&&i.length&&i.forEach(function(t){t.state&&e._groupSubscriptions.push(e.subscribe(t.state,e.onGroupStateChange))})}};return t})(r.default);t.default=u});
define("odsp-next/controls/detailsRow/DetailsRow",["require","exports","./DetailsRow.html","knockout","./DetailsRowViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={tagName:"ms-details-row",template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);t.default=s});
define("odsp-next/controls/detailsRow/DetailsRow.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<div class=\"DetailsRow\" role=\"row\" data-bind=\"click:onClick,delayedHasFocus:{focusState:focusState},css:{dropping:isDroppingTarget,'is-selected':isSelected,'is-focused':isFocused,'is-checkVisible':isMobile&&isCheckVisible,'is-receivingDrop':isReceivingDrop,'can-select':isSelectable,'od-DetailsRow--isInvokable':isInvokable,'od-DetailsRow--isMobile':isMobileRow},attr:{tabindex:tabindex,'aria-label':getRowAriaLabel(),'aria-selected':getRowAriaSelected()},keyboard:{mappings:{Right:detailsRowOnRight},context:$data},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop},customRender:true\"></div>"});
define("odsp-next/controls/detailsRow/DetailsRowViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../fieldRender/FieldRenderManager","../dragAndDrop/DropHelper","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/locale/Locale","../../controls/list/react/SelectionManager","../../bindings/keyboard/KeyboardBinding","../../bindings/customRender/CustomRenderBinding","../../bindings/dragAndDrop/DragAndDropBinding","../fieldRender/FieldRender.resx","./DetailsRowRenderer","../../bindings/focus/DelayedHasFocusBinding","../../bindings/element/ElementBinding","../../bindings/longTap/LongTapBinding","../../utilities/accessibility/AriaHelper","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/selection/SelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i.draggable=!0;i.isBasePage=!1;i.isSelected=r.observable(!1);i.focusState=i.createObservable(0);i.isFocused=i.createPureComputed(function(){return!!i.focusState()});i.isDroppingTarget=r.observable(!1);i.targetDropped=r.observable(!1);i.selectionModel=i.resources.consume(u.itemsSelection);i._selectionHelper=i.resources.consume(S.resourceKey);i.ignoreClickTime=r.observable(0);i.isReceivingDrop=r.observable(!1);i._isSelectionModal=i.resources.consume(l.isSelectionModalResourceKey);i._platform=i.resources.consume(E.platformDetection);i._fieldRenderers={};i.item=i.resources.expose(u.currentItem,t.item);i._instrumentationProvider=i.resources.consume(a.instrumentation);var s=t.itemSet.peek().schema;i.columns=i.createComputed(function(){return s().filter(function(e){return e.isVisible&&!i._platform.isMobile||i._platform.isMobile&&e.isVisibleMobile})});i._cellLocations=t.cellLocations;i._onInvoke=t.onInvoke;i._dropHelper=i.resources.consume(o.resourceKey);i.longestRenderedCells=t.longestRenderedCells;var f=i.resources.consume(u.actionMap);i._action=new(i.child(f.DefaultClickAction))({item:i.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"});i.isDroppable=i.createComputed(function(){return i.item().isDropEnabled&&!i.isSelected()});i.isMobile=i._platform.isMobile;i.isCheckVisible=i.createComputed(function(){return i._isSelectionModal()||i.selectionModel.selection().length>0});i._currentFocusColumnIndex=r.observable(-1);i._createFocusObservables();i.subscribe(i._currentFocusColumnIndex,function(e){e>=0&&i.columns.peek().length>0&&i.focusedObservables[e](!1)},!0);i.subscribe(i._currentFocusColumnIndex,function(e){e>=0&&i.columns.peek().length>0&&i.focusedObservables[e](!0)});i._itemKey=i.createComputed(function(){return i.item().key});i.subscribe(i._itemKey,function(){i._updateSelectionSubscription(i.item)});i._updateSelectionSubscription(i.item);i.tabindex=i.createPureComputed(function(){return i.selectionModel.focusedItem()===i.item?0:-1});i._rowRenderer=new v.default({rowViewModel:i,rootElement:n.element});i._rowRenderer.renderRow();i.subscribe(i.item,function(){i._rowRenderer.refreshRow()});i.subscribe(i._cellLocations,function(){i._rowRenderer.refreshRow()});i.subscribe(i.columns,function(){i._createFocusObservables();i._rowRenderer.refreshRow()});i.createComputed(function(){i.isReceivingDrop()&&i.isReceivingDrop(!1)}).extend({rateLimit:{timeout:167,method:"notifyWhenChangesStop"}});i.isSelectable=i.createComputed(i._computeIsSelectable);i.isInvokable=i.createComputed(i._computeIsInvokable);i.isMobileRow=i._platform.isMobile&&i.resources.isExposed(u.useMobileList)&&i.resources.consume(u.useMobileList);i.createBackgroundComputed(function(){var e=i.item();e&&!e.isPlaceholder&&i._instrumentationProvider.userSeeItem(e)});var d={dragAndDrop:p.default,keyboard:c.default,customRender:h.default,delayedHasFocus:m.default,longTap:y.default,element:g.default};i.addBindingHandlers(d);return i}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._updateSelectionSubscription(null)};t.prototype.activateBindings=function(){this._rowRenderer.activateBindings()};t.prototype.getCellFocusObservable=function(e){return this.focusedObservables[e]};t.prototype.getCellTabindex=function(e){var t=-1;this.focusedObservables[e]()&&(t=0);return t};t.prototype.getCellAriaLabel=function(e){return null};t.prototype.getDragData=function(){var e=this,t=this.item.peek(),n=null,r=this.selectionModel;t.isDraggable&&r.isItemSelected(this.item)&&(n={type:1,item:t,itemSet:r.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:r.selectedCount.peek(),resources:r.resources}});return n};t.prototype.onMayReceiveDrop=function(e){if(!this.isDroppable.peek())return null;var t=this.item&&this.item.peek&&this.item.peek();return!t||1!==e.type&&0!==e.type?null:{targetName:t.name}};t.prototype.onReceiveDrop=function(e){if(!this.isDroppable.peek())return!1;var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.targetDropped(!0);return t};t.prototype.onSelectableItemClick=function(e,t,n){var r=this.ignoreClickTime(),i=(new Date).getTime();if(r&&i-r<=1e3){n.stopPropagation();n.preventDefault();return!1}var s=t.columns.peek()[e];if(!this.isCheckVisible()&&"type"!==s.key)return t.onClick(s,n,!0);this.onItemCheckClick(t,n)};t.prototype.onItemCheckClick=function(e,t){var n=this.resources.consume(u.itemsSelection);if(t.shiftKey)n.selectToItem(this.item);else{n.toggleItemSelected(this.item);n.setItemFocus(this.item)}t.cancelBubble=!0;t.preventDefault();return!1};t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)};t.prototype.getClass=function(e){return"DetailsRow-cell "+e.key};t.prototype.getStyle=function(e,t){var n=this._cellLocations()[t()];return n&&n.width?"width: "+n.width+"px; "+f.default.safeLeft+": "+n.left+"px;":"display: none"};t.prototype.getTextValue=function(e){var t=this.item(),n="";if(t&&e&&!e.isIcon){void 0===(n=t[e.key])&&(n=t.properties[e.key]);if(n&&e.fieldType===w.ColumnFieldType.User){for(var r="",i=0,s=Array.isArray(n)?n:[n];i<s.length;i++){r&&(r+=", ");r+=s[i].title}n=r}else n=void 0===n?"":Array.isArray(n)?n.join(", "):n}return n};t.prototype.getHtmlValue=function(e){return s.default.RenderFieldByType(this,this.item.peek(),e)};t.prototype.getEmptyAriaLabel=function(e){return e.isRequired?d.default.RequiredEmptyFieldAriaLabel:d.default.EmptyFieldAriaLabel};t.prototype.registerFieldRenderer=function(e,t){this._fieldRenderers[e]=t};t.prototype.getFieldRenderer=function(e){return this._fieldRenderers[e]};t.prototype.getItem=function(){return this.item};t.prototype.getRowAriaLabel=function(){return b.getRowAriaLabel(this.item())};t.prototype.getRowAriaSelected=function(){return this.isSelected().toString()};t.prototype.onClick=function(e,t,n){var r=this.ignoreClickTime.peek(),i=(new Date).getTime();if(r&&i-r<=50){t.stopPropagation();t.preventDefault();return!1}var s=e;if(!e||e===this&&this._platform.isMobile||"displayName"===s.key||"name"===s.key||s.fieldType===w.ColumnFieldType.Custom){if(this._action.isAvailable.peek()){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}}else if(n){var o=this.getFieldRenderer(s.key);o&&"function"==typeof o.onClick&&o.onClick(t,this.item,this.resources);t.stopPropagation();t.preventDefault();return!1}};t.prototype.onLongTap=function(e){if(!this.isCheckVisible()){this.ignoreClickTime((new Date).getTime());this.onItemCheckClick(this,e)}};t.prototype.onMouseDown=function(e,t){if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.selectionModel.isItemSelected(this.item)||this.selectionModel.clear();this.selectionModel.setItemSelected(this.item,!0);this.selectionModel.setItemFocus(this.item)}};t.prototype.onInvoke=function(e){if(!1!==this._onInvoke.call(this,e)&&this._action.isAvailable.peek()){this._action.execute(e);e.stopPropagation();e.preventDefault();return!1}};t.prototype.onEnter=function(e,t,n){return t.onClick(t.columns.peek()[e],n,!0)};t.prototype.onLeft=function(e){var t=Math.max(e._currentFocusColumnIndex()-1,0);e._currentFocusColumnIndex(t);return!1};t.prototype.onRight=function(e){var t=Math.min(e._currentFocusColumnIndex()+1,e.columns.peek().length-1);e._currentFocusColumnIndex(t);return!1};t.prototype.detailsRowOnRight=function(e){e._currentFocusColumnIndex(-1);e._currentFocusColumnIndex(0);return!1};t.prototype._computeIsSelectable=function(){return this.item()&&this.selectionModel.canSelectItem(this.item)};t.prototype._computeIsInvokable=function(){return this._action.isAvailable()};t.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{focusState:this.focusState,isSelected:this.isSelected,isFocused:this.createObservable(!1),onInvoke:function(e){return t.onInvoke(e)}}))};t.prototype._createFocusObservables=function(){this.focusedObservables=[];for(var e=0;e<this.columns.peek().length;e++)this.focusedObservables.push(r.observable(!1))};return t})(i.default);t.default=x});
define("odsp-next/controls/fieldRender/FieldRenderManager",["require","exports","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","./FieldRenderer","./ComputedFieldRenderer","./CustomFieldRenderer","./FileSizeFieldRenderer","./nameField/NameFieldRenderer","./titleField/TitleFieldRenderer","./dateField/DateFieldRenderer","./sharedField/SharedFieldRenderer","./sharedWithField/SharedWithFieldRenderer","./dotDotDot/DotDotDotFieldRenderer","./userField/UserFieldRenderer","./FileTypeIconFieldRenderer","./tagField/TagFieldRenderer","./urlField/UrlFieldRenderer","./lookupField/LookupFieldRenderer","./taxonomyField/TaxonomyFieldRenderer","./attachmentsField/AttachmentsFieldRenderer","./activityField/ActivityFieldRenderer","./dataBarField/DataBarFieldRenderer","./rating/RatingFieldRenderer","./workflowField/WorkflowFieldRenderer","./like/LikeFieldRenderer","./ComplianceRecordFlagFieldRenderer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=(function(){function e(){}e.RenderFieldByType=function(t,n,r){return e.GetFieldRenderer(t,r,n).renderField(n)};e.GetFieldRenderer=function(e,t,C){var k=null;if(null!=t.fieldRenderer&&t.fieldRenderer.isCacheable())return t.fieldRenderer;var L=window.SPClientTemplates;if(L){var A=L.TemplateManager;if(A){var O=A.c_templateOverrides;if(O&&O[t.internalName]&&O[t.internalName].View)return new s.default(t,e,O[t.internalName].View)}}switch(t.fieldType){case n.ColumnFieldType.Computed:k=new i.default(t).fieldRenderer();break;case n.ColumnFieldType.ComplianceRecordFlag:k=new N.default(t);break;case n.ColumnFieldType.FileSize:k=new o.default(t);break;case n.ColumnFieldType.Name:k=new u.default(t,e);break;case n.ColumnFieldType.Title:k=new a.default(t,e,C);break;case n.ColumnFieldType.Shared:k=new l.default(t,e);break;case n.ColumnFieldType.SharedWith:k=new c.default(t,e);break;case n.ColumnFieldType.DotDotDot:k=new h.default(t,e);break;case n.ColumnFieldType.User:k=new p.default(t,e);break;case n.ColumnFieldType.FileIcon:k=new d.default(t,e);break;case n.ColumnFieldType.DateTime:k=new f.default(t);break;case n.ColumnFieldType.Tag:k=new v.default(t,e);break;case n.ColumnFieldType.Hyperlink:k=new m.default(t,e);break;case n.ColumnFieldType.Image:k=new m.default(t,e,!0);break;case n.ColumnFieldType.Lookup:k=new g.default(t,e);break;case n.ColumnFieldType.Taxonomy:k=new y.default(t,e);break;case n.ColumnFieldType.Activity:k=new w.default(t,e);break;case n.ColumnFieldType.Attachments:k=new b.default(t,e);break;case n.ColumnFieldType.AverageRating:k=new S.default(t,e);break;case n.ColumnFieldType.WorkflowStatus:k=new x.default(t,e);break;case n.ColumnFieldType.ProgressBar:k=new E.default(t,e);break;case n.ColumnFieldType.RatedBy:case n.ColumnFieldType.Ratings:k=new S.default(t,e);break;case n.ColumnFieldType.Likes:case n.ColumnFieldType.LikedBy:k=new T.default(t,e);break;default:k=new r.default(t)}return k};return e})();t.default=C});
define("odsp-next/controls/fieldRender/FieldRenderer",["require","exports","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._column=e;this._parentViewModel=t;this._key=this._column.key;this._isAutoHyperLink=e.isAutoHyperLink;this._parentViewModel&&this._parentViewModel.registerFieldRenderer&&this._parentViewModel.registerFieldRenderer(this._key,this)}e.prototype.isCacheable=function(){return!this._parentViewModel};e.prototype.renderField=function(e){var t;this._column.getValue&&(t=this._column.getValue(e));void 0===t&&(t=e[this._column.key]);void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);t=void 0===t?"":Array.isArray(t)?t.join(", "):t;if(!this._isAutoHyperLink&&!this._column.isAppendOnly&&t){t=n.default.encodeText(t);this._column.isNote&&t&&(t=t.replace(/\n/g,"<br>"))}return t};e.prototype._getThis=function(){return"$data.getFieldRenderer('"+this._key+"')"};e.prototype._getOnClick=function(){return"function(data, evt) { "+this._getThis()+".onClick(evt); }"};return e})();t.default=r});
define("odsp-next/controls/fieldRender/ComputedFieldRenderer",["require","exports","tslib","./FieldRenderer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.fieldRenderer=function(){return new r.default(this._column)};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/CustomFieldRenderer",["require","exports","tslib","./FieldRenderer","../../resources/SPOResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n,r){var i=e.call(this,t,n)||this;i._jsCode=r;return i}t.prototype.renderField=function(e){var t={};t.CurrentItem=e.properties;var n=this._parentViewModel.resources.consume(i.listContext);if(n.rawListSchema&&n.rawListSchema.Field)for(var r=0;r<n.rawListSchema.Field.length;r++){var s=n.rawListSchema.Field[r];if(s.Name===this._column.internalName){t.CurrentFieldSchema=s;break}}try{return("string"==typeof this._jsCode?new Function("ctx",this._jsCode):this._jsCode)(t)}catch(e){0}};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/FileSizeFieldRenderer",["require","exports","tslib","./FieldRenderer","@ms/odsp-utilities/lib/string/DriveSpaceHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.renderField=function(e){return i.default.getDisplayString(e.size,{ignoreZero:!0})};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/nameField/NameFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../resources/DataSourceResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../utilities/accessibility/AriaHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,void 0)||this;r._urlDataSource=n.resources.consume(s.url);var i=n.resources.consume(u.platformDetection);r._useCustomColumn=i.isMobile&&n.resources.isExposed(o.useMobileList)&&n.resources.consume(o.useMobileList);return r}t.prototype.renderField=function(t){var n=e.prototype.renderField.call(this,t),r=i.default.encodeText(a.getNameFieldAriaLabelForItem(t)),s=this._urlDataSource.getDefaultClickUrl(t,{preferCurrentView:!0});return'<a tabindex="-1" aria-label="'+r+'" title="'+n+'" href="'+(s?i.default.encodeText(s):"#")+'" data-bind="event: {'+(this._useCustomColumn?"":"click: function(obj, ev) { return $data.onClick(null, ev); },mousedown: function(obj, ev) { return $data.onMouseDown(null, ev); }")+'}">'+n+"</a>"};return t})(r.default);t.default=f});
define("odsp-next/utilities/accessibility/AriaHelper",["require","exports","@ms/odsp-utilities/lib/list/SharingTypeHelper","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/string/StringHelper","../complianceTag/ComplianceTagUtilities","../list/ListUtilities.resx","../../dataSources/item/odb/ODBDataSource.resx","../../dataSources/url/QueryType","../../models/item/ItemType","../../models/item/Item.resx","../../models/item/LifeCycleStatus","../../models/item/SharingType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRowAriaLabel=function(e,t){switch(e.queryType){case a.default.Recent:return d(e);case a.default.Files:default:return p(e)}};function p(e,t){var n=[],u=m(e)||e.name,a=g(e)||e.dateModified,f=e.defaultSubText,p=e.size,d=c.getStatusToDisplay(e.lifeCycleStatus);u&&n.push(u);d>0&&n.push((function(e){var t;return((t={})[3]=o.default.TrendingStatus,t[2]=o.default.NewStatus,t[4]=o.default.MalwareDetectedStatus,t[1]=o.default.ExternalStatus,t)[e]||""})(d));a&&n.push(a);f&&n.push(f);p&&n.push(r.default.getDisplayString(p,{ignoreZero:!0}));if(e.folder){var v=e.folder.totalCount,y=void 0===v?e.childCount:v;n.push(i.format(i.getLocalizedCountValue(l.default.itemCountFormat,l.default.itemCountIntervals,y),y))}e.sharingType===h.default.Shared?n.push(o.default.SharedStatus):e.sharingType!==h.default.Unknown&&n.push(o.default.NotSharedStatus);if(s.complianceRecordFlagValue(e)){var b=s.getRecordLabelHoverText();n.push(b)}t&&n.push(l.default.selected);return n.join(", ")||void 0}t.getFilesRowAriaLabel=p;function d(e){var t=[],n=m(e)||e.name;n&&t.push(n);var r=e.displayPath;if(r){var i=r.segments.join(" "+o.default.RecentFilePathSlash+" ");t.push(o.default.RecentFilePath+": "+i)}var s=e.dateAccessed;s&&t.push(u.default.LastAccessedColumnName+" "+s);return t.join(", ")||void 0}t.getRecentRowAriaLabel=d;function v(e){var t=e.extension,r=[];if(e.type===f.default.Folder)r.push(n.useSharedFolderAriaLabel(e.sharingType)?l.default.fileTypeSharedFolder:l.default.fileTypeFolder);else{var s=e.appMap;if(s){var o=s.toLowerCase();-1!==o.indexOf("ms-word")?r.push(l.default.fileTypeDoc):-1!==o.indexOf("ms-excel")?r.push(l.default.fileTypeXls):-1!==o.indexOf("ms-powerpoint")?r.push(l.default.fileTypePpt):-1!==o.indexOf("onenote")&&r.push(l.default.fileTypeOneNotebook)}else if(e.type===f.default.Media&&e.photo)r.push(i.format(l.default.fileTypeImage,t||"").trim());else if(t){var a="."===t[0]?t.substring(1):t;r.push(i.format(l.default.fileTypeUnknown,a))}else e.type===f.default.App&&e.properties&&e.properties.appTypeString?r.push(i.format(u.default.IconAccessibleName,e.properties.appTypeString)):e.type===f.default.Subsite&&e.name&&r.push(i.format(u.default.IconAccessibleName,e.name));var c=y(e);c&&r.push(c)}return r.join(", ")}t.getIconFieldAriaLabelForItem=v;function m(e){var t=[],n=v(e);t.push(e.name);n&&t.push(n);return t.join(", ")}t.getNameFieldAriaLabelForItem=m;function g(e){return!e.dateDeleted||e.queryType!==a.default.RecycleBin&&e.queryType!==a.default.SecondStageRecycleBin?e.dateModified?i.format(l.default.dateModifiedLabelFormat,e.dateModified):void 0:i.format(l.default.dateDeletedLabelFormat,e.dateDeleted)}t.getModifiedFieldAriaLabelForItem=g;function y(e){var t=[];e.itemStatus?t.push(l.default.sharedViolationWarningViewer):e.isViolation&&t.push(l.default.sharedViolationWarning);e.policyTip&&(2&e.policyTip?t.push(l.default.policyTipBlockText):1===e.policyTip&&t.push(l.default.policyTipNotifyText));e.hasMissingMetadata&&t.push(l.default.missingMetadataText);if(s.complianceRecordFlagValue(e)){var n=s.getRecordLabelHoverText();t.push(n)}var r=e.properties.CheckoutUser,o=(void 0===r?[]:r)[0],u=(void 0===o?{}:o).title,a=void 0===u?void 0:u;a&&t.push(i.format(l.default.checkedOutTo,a));return t.join(" ")}t.getTooltipText=y});
define("odsp-next/utilities/complianceTag/ComplianceTagUtilities",["require","exports","../../controls/fieldEditor/booleanEditor/BooleanEditor.resx","@ms/odsp-utilities/lib/string/StringHelper","./ComplianceTagUtilities.resx","../features/Features"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";t.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";t.ASSETID_FIELD_NAME="ComplianceAssetId";t.ASSETID_FIELD_ID="3A6B296C-3F50-445C-A13F-9C679EA9DDA3";t.UNLOCKRECORD_FIELD_NAME="RecordUnlocked";t.UNLOCKRECORD_FIELD_ID="96BE7325-AFA4-48CF-8503-9258F0A7817D";t.COMPLIANCEFLAGS_NAME="_ComplianceFlags";t.MAX_ITEM_SIZE=200;t.isClientFormComplianceAssetIdField=function(e){return!!(e&&e.schema&&o(e.schema.FieldType,e.schema.Id))};function o(e,n){return!(!e||"text"!==e.toLowerCase()||!n||n.toLowerCase()!==t.ASSETID_FIELD_ID.toLowerCase())}t.isComplianceAssetIdField=o;t.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&u(e.schema.FieldType,e.schema.Id))};function u(e,n){return!(!e||"lookup"!==e.toLowerCase()||!n||n.toLowerCase()!==t.COMPLIANCETAG_FIELD_ID.toLowerCase())}t.isComplianceTagField=u;t.isClientFormUnlockedRecordField=function(e){return!!(e&&e.schema&&a(e.schema.FieldType,e.schema.Id))};function a(e,n){return!(!e||"boolean"!==e.toLowerCase()||!n||n.toLowerCase()!==t.UNLOCKRECORD_FIELD_ID.toLowerCase())}t.isUnlockedRecordField=a;t.isUnlockRecordTurnedOn=function(e){return!!(256&e)};t.complianceRecordFlagValueAsYesNoString=function(e){return f(e)?n.default.yes:n.default.no};t.complianceRecordIconValue=function(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){if(4&+e.properties._ComplianceFlags)return!0}return!1};function f(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(s.isFeatureEnabled(s.IPRecordVersioningClient)){if(4&t||256&t)return!0}else if(4&t&&1&t)return!0}return!1}t.complianceRecordFlagValue=f;t.getRecordLabelHoverText=function(){return i.default.RecordLabelHoverText};t.getPlaceholder=function(){return i.default.ComplianceTagFieldPlaceHolder};t.getTagDescription=function(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.default.RetainForeverText:" ";var t=l(e.TagDuration);return e.BlockDelete?r.format(i.default.PreserveTagText,t):e.AutoDelete?r.format(i.default.DeleteTagText,t):" "};t.getTagTooltip=function(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.default.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.default.PreserveForeverTooltip:i.default.NoRetentionTooltip;var t=l(e.TagDuration),n="",s="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(s=i.default.PreserveIsRecordTooltipModifier);e.ReviewerEmail?s+=i.default.ReviewTooltip:s+=e.AutoDelete?i.default.PreserveAutoDeleteTooltipModifier:i.default.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i.default[n];return o?r.format(o,t)+s:null};function l(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var s=n>1?i.default.RetentionPeriodYears:i.default.RetentionPeriodYear;t=r.format(s,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?i.default.RetentionPeriodMonths:i.default.RetentionPeriodMonth;t=r.format(u,o)}else{var a=e>1?i.default.RetentionPeriodDays:i.default.RetentionPeriodDay;t=r.format(a,e)}}}return t}t.getDurationAsString=l});
define("odsp-next/models/item/LifeCycleStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStatusToDisplay=function(e){if(e&&Object.keys(e).length>0){if(e.isMalwareDetected)return 4;if(e.isExternal)return 1;if(e.isTrending)return 3;if(e.isNew)return 2}return 0}});
define("odsp-next/controls/fieldRender/titleField/TitleFieldRenderer",["require","exports","tslib","../FieldRenderer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t,n,r){return e.call(this,t,n)||this}t.prototype.renderField=function(t){var n=e.prototype.renderField.call(this,t);return'<a tabindex="-1" href="javascript: " title="'+n+'" data-bind="click: function(obj, ev) { return $data.onClick(null, ev); }">'+n+"</a>"};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/dateField/DateFieldRenderer",["require","exports","tslib","../FieldRenderer","ODCFiles_css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(t){var n="<span>"+e.prototype.renderField.call(this,t)+"</span>",r=null;t.dateModifiedValue?r=t.dateModifiedValue:t.dateDeleted&&(r=t.dateDeleted);if(r&&"dateModified"===this._key){var i=new Date(r).getTime();i&&Math.abs(Date.now()-i)<=36e5&&(n='<span class="od-DateField--newItem">&#10033;<span>'+n)}return n};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/sharedField/SharedFieldRenderer",["require","exports","tslib","../FieldRenderer","office-ui-fabric-react/lib/Styling","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._column,n=e[t.key];n||(n=e.properties[t.key]);return n?'<i class="od-SharedField--shared '+i.getIconClassName("People")+'"></i><span>'+n+"</span>":""};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/sharedWithField/SharedWithFieldRenderer",["require","exports","tslib","../FieldRenderer","./SharedWithFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","ODCFiles_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this.sharedWithViewModel=new(this._parentViewModel.resources.injected(i.default))({item:e}),n=t.sharingString,r=t.imageClass,o=s.default.encodeText(t.imageAlt);return'<div class="od-FieldRender" href="javascript: " title="'+o+'" data-bind="click: '+this._getOnClick()+'"><span class="od-FieldRender-icon"><i class="'+r+'" alt="'+o+'"></i></span><span class="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock">'+n+"</span></div>"};t.prototype.onClick=function(e){this.sharedWithViewModel.onClick(e)};return t})(r.default);t.default=o});
define("odsp-next/controls/fieldRender/sharedWithField/SharedWithFieldViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../FieldRender.resx","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(o,t);function o(e){var n,r=t.call(this,e)||this;r._item=e.item;if(Number(r._item.properties.PrincipalCount)<1){r.imageClass=u.getIconClassName("Lock");r.imageAlt=i.default.SharedWithNoneIcon;n=i.default.SharedWithNone_Short}else{r.imageClass=u.getIconClassName("People");r.imageAlt=i.default.SharedWithSomeIcon;n=i.default.SharingHintShared_Short}r.sharingString=s.default.encodeText(n);return r}o.prototype.onClick=function(t){var n=this;this.trackPromise(r.default.resolve(new Promise(function(t,n){e(["../../../actions/ShowPropertiesAction"],t,n)})).then(a.getDefaultExport)).done(function(e){new(n.resources.injected(e))({useToggleBehavior:!1,isSharingSectionExpanded:!0}).execute(t)})};return o})(o.default);t.default=f});
define("odsp-next/controls/fieldRender/dotDotDot/DotDotDotFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./DotDotDotViewModel","office-ui-fabric-react/lib/Styling","ODCFiles_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.dotDotDotViewModel=new(this._parentViewModel.resources.injected(s.default))({item:r.observable(e)});return'<div class="od-FieldRender-dot" data-bind="click: '+this._getOnClick()+'"><i class="'+o.getIconClassName("More")+'"></i></div>'};t.prototype.onClick=function(e){this.dotDotDotViewModel.onDotDotDotClicked(null,e)};return t})(i.default);t.default=u});
define("odsp-next/controls/fieldRender/dotDotDot/DotDotDotViewModel",["require","exports","tslib","../textField/TextFieldViewModel","../../../providers/engagement/Engagement"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.onDotDotDotClicked=function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("contextmenu",!0,!0,t);t.currentTarget.dispatchEvent(n);this.resources.consume(i.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0})};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/textField/TextFieldViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._parent=null;n._parent=t.parent;return n}t.prototype.getTextValue=function(e){return this._parent.getTextValue(e)};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/userField/UserFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./UserFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../../utilities/features/Features","ODCFiles_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.userFieldViewModel=new(this._parentViewModel.resources.injected(s.default))({item:r.observable(e),column:this._column});var t=this.userFieldViewModel.users.peek();if(!t)return"";for(var n="",i=0,u=0,a=t;u<a.length;u++){var f=a[u],l=o.default.encodeText(f.title);n+='<div class="od-FieldRender" aria-label="'+o.default.encodeText(this.userFieldViewModel.getAriaLabel(l))+'"><span class="'+this._getUserFieldClassNames()+'" data-bind="event: {click: '+this._getOnClickHandler(i)+",clickBubble: false,mousemove: "+this._getOnMouseMovedHandler(i)+",mouseout: "+this._getOnHoverEndedHandler()+"},element: "+this._getElementBinding()+'">'+l+"</span></div>";i++}return n};t.prototype.onClick=function(e,t){t="number"==typeof t?t:0;this.userFieldViewModel.launchPersonaCard(e,t)};t.prototype.mouseMoved=function(e,t){this.userFieldViewModel.launchPersonaCardAfterDelay(e,t)};t.prototype.hoverEnded=function(){this.userFieldViewModel.cancelDelayedPersonaCardLaunch()};t.prototype._getOnClickHandler=function(e){return"function(data, evt) { "+this._getThis()+".onClick(evt, "+e+"); }"};t.prototype._getOnMouseMovedHandler=function(e){return"function(data, evt) { "+this._getThis()+".mouseMoved(evt, "+e+"); }"};t.prototype._getOnHoverEndedHandler=function(){return"function(data, evt) { "+this._getThis()+".hoverEnded(); }"};t.prototype._getElementBinding=function(){return this._getThis()+".userFieldViewModel.fieldElement"};t.prototype._getUserFieldClassNames=function(){var e="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock";(u.isFeatureEnabled(u.PeopleCardsOnLoki)||u.isFeatureEnabled(u.PeopleCardsReactComponent))&&(e+=" od-FieldRender-person");return e};return t})(i.default);t.default=a});
define("odsp-next/controls/fieldRender/userField/UserFieldViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","knockout","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ProviderResourceKeys","../../../resources/SPOResourceKeys","../../peopleCard/PeopleCardCommons","../../../utilities/features/Features","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(t){n.__extends(s,t);function s(n){var s=t.call(this,n)||this,a=s.observables,c=n.item();s.item=a.create(c);s._column=n.column;s._peopleCardTimeoutId=-1;s._peopleCardDataTimeoutId=-1;s._profileProvider=s.resources.consume(o.profile.optional);s.fieldElement=a.create(null);s.users=a.createArray();var h=c.properties[s._column.key];if(h&&h.length){s.users(h);if(s._profileProvider){var p=h.map(function(e){return e.sip});s._profileProvider.personRendered(p)}}if(f.isFeatureEnabled(f.PeopleCardsReactComponent)){var d=s.users.peek()[0];if(d){var v=s.resources.consume(u.pageContext);s.createBackgroundComputed(function(){var t=s.fieldElement();t&&s.trackPromise(r.default.resolve(new Promise(function(t,n){e(["../../personaCard/PersonaCardLauncher"],t,n)})).then(l.getDefaultExport).then(function(e){e.personaRendered(t,d.sip||d.email,v);i.utils.domNodeDisposal.addDisposeCallback(t,function(){e.personaRemoved(t,d.sip||d.email,v)})}))})}}return s}s.prototype.getAriaLabel=function(e){return this._column.name+", "+e};s.prototype.launchPersonaCardAfterDelay=function(e,t){var n=this;void 0===t&&(t=0);var r=this.users.peek()[t];if(r){this._lastMouseMove=e;this._profileProvider&&-1===this._peopleCardDataTimeoutId&&(this._peopleCardDataTimeoutId=this.async.setTimeout(function(){return n._profileProvider.getPeopleCardData(r.email||r.userId||r.sip)},a.PEOPLE_CARD_DATA_PRELOAD_DELAY));-1===this._peopleCardTimeoutId&&(this._peopleCardTimeoutId=this.async.setTimeout(function(){return n.launchPersonaCard(null,t,!0)},a.PEOPLE_CARD_HOVER_DELAY))}};s.prototype.cancelDelayedPersonaCardLaunch=function(){this._lastMouseMove=null;this.async.clearTimeout(this._peopleCardTimeoutId);this.async.clearTimeout(this._peopleCardDataTimeoutId);this._peopleCardTimeoutId=-1;this._peopleCardDataTimeoutId=-1};s.prototype.launchPersonaCard=function(t,n,i){var s=this;void 0===t&&(t=null);void 0===n&&(n=0);void 0===i&&(i=!1);t=t||this._lastMouseMove;this.cancelDelayedPersonaCardLaunch();var o=this.users.peek()[n];o&&o.sip&&r.default.resolve(new Promise(function(t,n){e(["../../personaCard/PersonaCardLauncher"],t,n)})).then(function(e){return r.default.resolve(e.default)}).then(function(e){var n={name:o.title,email:o.email,image:o.picture,sip:o.sip,userId:o.sip};new(s.managed(e))(n).show(t,i)})};return s})(s.default);t.default=c});
define("odsp-next/controls/peopleCard/PeopleCardCommons",["require","exports","@ms/odsp-utilities/lib/navigation/AddressParser","./../../utilities/features/Features"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={edog:"ppe",msit:"msit",spdf:"df"};t.PEOPLE_CARD_HOVER_DELAY=300;t.PEOPLE_CARD_DATA_PRELOAD_DELAY=50;t.PEOPLE_CARD_HOVER_EVENT_NAME="mousemove";t.openNewTab=function(e){window.open(e,"_blank").opener=null};t.getLokiRegion=function(e){if(r.isFeatureEnabled(r.DebugWindow)){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var s=n.deserializeQuery(t);if(s.lokideployment)return s.lokideployment}return(function(e){var t=e.farmLabel.toLowerCase().split("_",1)[0],n=i[t];"msit"===n&&r.isFeatureEnabled(r.PeopleCardsLokiDogfood)&&(n="df");return n})(e)}});
define("odsp-next/controls/fieldRender/FileTypeIconFieldRenderer",["require","exports","tslib","knockout","./FieldRenderer","../fileTypeIcon/FileTypeIconViewModel","./iconField/IconFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/icons/IconSelector","../../resources/ControlResourceKeys","../../utilities/accessibility/AriaHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key","ODCFiles_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._parentViewModel.resources,n=r.observable(e),i=t.consume(c.platformDetection).isMobile&&t.consume(f.useMobileList.optional),a={iconName:this._getIconName(e),iconUrl:this._getIconUrl(e,i),extension:e.extension,desiredSize:i?48:16,overlayType:o.default.getOverlayType(n),iconFieldAriaLabel:l.getIconFieldAriaLabelForItem(e),hoverText:o.default.getHoverText(n),onClick:o.default.getOnClick(n,t)};this.fileTypeIconViewModel=new(t.injected(s.default))(a);var h=this.fileTypeIconViewModel.onClick?"FileTypeIcon FileTypeIcon--clickable":"FileTypeIcon",p=this.fileTypeIconViewModel.overlayUrl,d=this.fileTypeIconViewModel.iconFieldAriaLabel.peek(),v=u.default.encodeText(d),m=this.fileTypeIconViewModel.size;return'<span class="'+h+'" title="'+u.default.encodeText(this.fileTypeIconViewModel.hoverText)+'"'+(d?' aria-label="'+v+'"':"")+' data-bind="click: '+this._getOnClick()+'" tabindex="-1"><img class="FileTypeIcon-icon" src="'+u.default.encodeText(this.fileTypeIconViewModel.iconUrl.peek()||"")+'"'+(d?' alt="'+v+'"':"")+' style="width: '+m+"; height: "+m+"; font-size: "+m+'" data-bind="attr: {src: '+this._getThis()+'.fileTypeIconViewModel.iconUrl}" />'+(p?'<img class="FileTypeIcon-overlay" src="'+u.default.encodeText(p)+'" />':"")+"</span>"};t.prototype.onClick=function(e){"function"==typeof this.fileTypeIconViewModel.onClick&&this.fileTypeIconViewModel.onClick(e)};t.prototype._getIconName=function(e){return e.state&&4===e.state.upload.status?a.genericFile:e.iconName};t.prototype._getIconUrl=function(e,t){var n=window.require.toUrl("odsp-media/images/loading/loadingSpinner.gif");if(e.state)switch(e.state.upload.status){case 1:return n;default:return e.iconUrl}return e.iconUrl};return t})(i.default);t.default=h});
define("odsp-next/controls/fieldRender/iconField/IconFieldViewModel",["require","exports","tslib","../textField/TextFieldViewModel","../../fileTypeIcon/OverlayType","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/accessibility/AriaHelper","../../../utilities/complianceTag/ComplianceTagUtilities","@ms/odsp-utilities/lib/modules/ModuleHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){n.__extends(r,t);function r(e){var n=t.call(this,e)||this;n.item=e.item;n.iconFieldViewModelType=r;return n}r.getOverlayType=function(e){var t=e(),n=i.default.none,r=t.policyTip;if(r){var s=1==(1&r);2==(2&r)?n=i.default.block:s&&(n=i.default.notify)}else t.isViolation?n=i.default.block:t.properties.CheckedOutUserId?n=i.default.checkOut:t.state&&4===t.state.upload.status?n=i.default.notify:u.complianceRecordIconValue(t)&&(n=i.default.record);return n};r.getHoverText=function(e){var t=e();return o.getTooltipText(t)};r.getOnClick=function(t,n){return 1&t().policyTip?function(r){s.Engagement.logData({name:"PolicyTip.LaunchFromListView"});new Promise(function(t,n){e(["../../../actions/PolicyTipAction"],t,n)}).then(a.getDefaultExport).then(function(e){new(n.injected(e))({item:t}).execute(r)});return!1}:null};return r})(r.default);t.default=f});
define("odsp-next/controls/fileTypeIcon/OverlayType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"})(n||(n={}));t.default=n});
define("odsp-next/controls/fieldRender/tagField/TagFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/HtmlEncoding","../../photos/Photos.resx","../../../controls/fluentStyling/FluentStyling.key","ODCFiles_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e.childCount,n=i.format(i.pluralSelect(t,o.default.photosCountSingular,o.default.photosCount),t),r=e.folder,a=r&&r.covers[0],f=this._parentViewModel.resources.consume(u.resourceKey)?32:50;return'<div class="od-TagField"><div class="od-TagField-image">'+(a?'<img src="'+i.format(a.url,f,f)+'" alt="" />':"")+'</div><div class="od-TagField-name ms-font-m">'+s.default.encodeText(e.name)+'</div><div class="od-TagField-count"'+s.default.encodeText(n)+"</div></div>"};return t})(r.default);t.default=a});
define("odsp-next/controls/fieldRender/urlField/UrlFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/encoding/HtmlEncoding","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n,r){var i=e.call(this,t,n)||this;i._isPicture=!!r;i._url="";return i}t.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var n=e.properties[this._column.key+".desc"];n||(n=t);this._url=t;var r=i.default.encodeText(t),s=i.default.encodeText(n);return this._isPicture?'<div class="od-FieldRender-image"><img src="'+r+'" title="'+s+'" class="od-FieldRender-imageDisplay" data-bind="click: '+this._getOnClick()+',clickBubble: false"></a></div>':'<div class="od-FieldRender"><a class="od-FieldRender-display od-FieldRender-display--link" href="'+r+'" tabindex="-1" title="'+r+'" target="_blank" data-bind="click: '+this._getOnClick()+',clickBubble: false">'+s+"</a></div>"};t.prototype.onClick=function(e){e&&e.target&&this._url&&window.open(this._url,"_blank")};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/lookupField/LookupFieldRenderer",["require","exports","tslib","../FieldRenderer","./LookupFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._lookupFieldViewModel=new(this._parentViewModel.resources.injected(i.default))({item:e,column:this._column});var t=this._lookupFieldViewModel.lookups,n="";if("string"==typeof t)n=s.default.encodeText(t);else if(t)for(var r=0;r<t.length;r++){var o=t[r],u=s.default.encodeText(o.lookupValue);n+='<div class="od-FieldRender" aria-label="'+u+'"><span class="od-FieldRender-display od-FieldRender-display--link" data-bind="click: function (data, evt) { '+this._getThis()+".onClick(evt, "+r+'); },clickBubble: false">'+u+"</span></div>"}return n};t.prototype.onClick=function(e,t){this._lookupFieldViewModel.launchLookupDisplayForm(e,this._lookupFieldViewModel.lookups[t].lookupId)};return t})(r.default);t.default=o});
define("odsp-next/controls/fieldRender/lookupField/LookupFieldViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../iFrameDialog/IFrameDialog.key","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._column=t.column;var r=t.item.properties[n._column.key];(r&&"string"==typeof r||Array.isArray(r)&&r.length)&&(n.lookups=r);return n}t.prototype.launchLookupDisplayForm=function(e,t){var n=this._column.dispFormUrl;n+="&ID=";n+=t;n+="&RootFolder=*&IsDlg=1";return this.resources.consume(i.resourceKey).requestDialog({title:"",size:"Large",control:u.toSpecification(o.default,{componentUrl:n,showInDialog:!0,heightOffset:.5})}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t})(r.default);t.default=a});
define("odsp-next/controls/iFrameDialog/IFrameDialog.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./IFrameDialog"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/fieldRender/taxonomyField/TaxonomyFieldRenderer",["require","exports","tslib","knockout","../FieldRenderer","./TaxonomyFieldViewModel","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._taxonomyFieldViewModel=new(this._parentViewModel.resources.injected(s.default))({item:r.observable(e),column:this._column});for(var t="",n=0,i=this._taxonomyFieldViewModel.terms();n<i.length;n++){var u=i[n],a=o.default.encodeText(u.Label);t+='<div class="od-UserField" aria-label="'+a+'"><span class="ms-noWrap ms-imnSpan ms-displayInlineBlock">'+a+"</span></div>"}return t};return t})(i.default);t.default=u});
define("odsp-next/controls/fieldRender/taxonomyField/TaxonomyFieldViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.item();n.item=r.observable(i);n._column=t.column;n.terms=r.observableArray(null);var s=i.properties[n._column.key];!s||s instanceof Array||""===s||(s=[{Label:s.Label,TermID:s.TermID}]);s&&s.length>0&&n.terms(s);return n}return t})(i.default);t.default=s});
define("odsp-next/controls/fieldRender/attachmentsField/AttachmentsFieldRenderer",["require","exports","tslib","../FieldRenderer","office-ui-fabric-react/lib/Styling","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(t){return'<div class="ms-Attachment-icon">'+("1"===e.prototype.renderField.call(this,t)?'<span class="'+i.getIconClassName("Attach")+'"></span>':"")+"</div>"};return t})(r.default);t.default=s});
define("odsp-next/controls/fieldRender/activityField/ActivityFieldRenderer",["require","exports","tslib","../FieldRenderer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e[this._column.key];void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);return t=void 0===t?"":Array.isArray(t)?t.join(", "):t};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/dataBarField/DataBarFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","../../progress/bar/ProgressBarViewModel","./DataBarField.resx","ODCFiles_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.renderField=function(e){if(!e.properties||!e.properties.progress)return"";this.viewModel=new(this._parentViewModel.resources.injected(s.default))({progress:e.properties.progress});var t=this._getThis(),n=t+".getTitle()";return'<div class="ProgressBar-listview-track" data-bind="attr: {\'aria-label\': '+n+",'title': "+n+'}"><div class="ProgressBar-listview-value" data-bind="style: {width: '+t+".viewModel.percentage() + '%'}\"></div></div>"};t.prototype.getTitle=function(){return i.format(i.getLocalizedCountValue(o.default.ViewsText,o.default.ViewsTextIntervals,this.viewModel.current()),this.viewModel.current())};return t})(r.default);t.default=u});
define("odsp-next/controls/progress/bar/ProgressBarViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.progress,i=r.minimum,s=void 0===i?n.createObservable(0):i,o=r.maximum,u=void 0===o?n.createObservable(0):o,a=r.current,f=void 0===a?n.createObservable(0):a,l=t.description,c=void 0===l?n.createObservable(""):l;n.minimum=s;n.maximum=u;n.current=f;n.description=c;n.size=n.createPureComputed(n._computeSize);n.value=n.createPureComputed(n._computeValue);n.percentage=n.createPureComputed(n._computePercentage);n.normalizedPercentage=n.createPureComputed(n._computeNormalizedPercentage);return n}t.prototype._computeSize=function(){return this.maximum()-this.minimum()};t.prototype._computeValue=function(){return this.current()-this.minimum()};t.prototype._computePercentage=function(){return 0===this.size()?0:this.value()/this.size()*100};t.prototype._computeNormalizedPercentage=function(){var e=this.percentage();return e>100?1e4/e:e};return t})(r.default);t.default=i});
define("odsp-next/controls/fieldRender/rating/RatingFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/DataSourceResourceKeys","../../../providers/item/ItemProvider","../FieldRender.resx","../../../resources/SPOResourceKeys","office-ui-fabric-react/lib/Styling","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","ODCFiles_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._ratingDataSource=r._parentViewModel.resources.consume(s.rating);r._itemProvider=r._parentViewModel.resources.consume(o.resourceKey);r._pageContext=r._parentViewModel.resources.consume(a.pageContext);r.onMouseover=function(e){return r._highlightStars(e,!1)};r.onMouseout=function(e){return r._highlightStars(e,!0)};return r}t.prototype.renderField=function(e){this._listItem=e;var t=!l.isCheckedOutByOther(e,this._pageContext.userId);this._rateBylength=e.reputationProperties.RatedBy?e.reputationProperties.RatedBy.length:0;this._averageRating=parseFloat(e.reputationProperties.AverageRating);for(var n='<a tabindex="0">',r=0;r<5;r++){var i="od-Rating-star"+(this._averageRating>=r+1?"Full":this._averageRating>r?"Half":"Empty")+" "+f.getIconClassName("FavoriteStarFill");n+='<div tabindex="0" id="'+r+'" title="" class="'+(i+=t?" od-Rating-enabled":"")+'" ';n+=t?'data-bind="\nclick: '+this._getOnClick()+",\nevent: {\n    mouseover: function(data, evt){"+this._getThis()+".onMouseover(evt)},\n    mouseout: function(data, evt){"+this._getThis()+'.onMouseout(evt)}\n}"':"";n+="></div>"}return n+='</a><span tabindex="0" title="'+u.default.RatedByCountTitle+'" class="od-Rating-count">'+this._rateBylength+"</span>"};t.prototype.onClick=function(e){if(e&&e.target){var t=e.target;this._averageRating=this.computeAverageRating(Number(this._selectedStarid)+1);this._highlightStars(e,!0);this.setRating(e,Number(t.id)+1)}e.cancelBubble=!0;e.preventDefault()};t.prototype._highlightStars=function(e,t){if(e&&e.target){var n=e.target,r=n.parentElement.children,i=t?"od-Rating-starFull":"od-Rating-starHover";this._selectedStarid=Number(n.id);var s=this._averageRating,o=t?s-1:this._selectedStarid;r[this._selectedStarid].setAttribute("title",this.getElementTitle());r[this._selectedStarid].setAttribute("aria-label",this.getAriaLabel());for(var u=0;u<5;u++)r[u].className=(u<=o?i:"od-Rating-starEmpty")+" "+f.getIconClassName("FavoriteStarFill");var a=r[Math.floor(s)];t&&s&&s%1&&a&&(a.className="od-Rating-starHalf "+f.getIconClassName("FavoriteStarFill"))}};t.prototype.setRating=function(e,t){var n=this,r={item:this._listItem,rating:t};return this._ratingDataSource.setRating(r).then(function(e){isNaN(e)||(n._averageRating=e);return n._itemProvider.invalidateItem(n._listItem.parentKey,{triggerFetch:!0})})};t.prototype.rated=function(){for(var e=this._listItem.reputationProperties,t=e.Ratings.split(","),n=e.RatedBy||[],r=0;r<n.length;r++)if(Number(n[r].id)===this._pageContext.userId)return Number(t[r]);return-1};t.prototype.getElementTitle=function(){var e=this.rated();return-1!==e?i.format(u.default.ModifyRatingTitle,e):i.format(u.default.ApplyRatingTitle,Number(this._selectedStarid)+1)};t.prototype.getAriaLabel=function(){var e=this.rated(),t=this._averageRating>0?i.format(i.pluralSelect(this._averageRating,u.default.AverageRatingAriaLabel,u.default.AverageRatingPluralAriaLabel),this._averageRating):"";t+=-1!==e?i.format(u.default.ModifyRatingTitle,e):"";return t+=i.format(u.default.ApplyRatingTitle,Number(this._selectedStarid)+1)};t.prototype.computeAverageRating=function(e){var t=this._averageRating||0,n=this._rateBylength;return-1!==this.rated()&&0!==n?(t*n-this.rated()+e)/n:(t*n+e)/(n+1)};return t})(r.default);t.default=c});
define("odsp-next/controls/fieldRender/workflowField/WorkflowFieldRenderer",["require","exports","tslib","../FieldRenderer","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/encoding/HtmlEncoding","ODCFiles_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._navigation=n.resources.consume(i.navigation);return r}t.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var n=this._getWorkflowStatusUrlAndDisplay(t),r=s.default.encodeText(n.url),i=s.default.encodeText(n.display);return'<a class="ms-workflowStatus--linkText" href="'+r+'" title="'+r+'" target="_blank" data-bind="click: '+this._getOnClick()+', clickBubble: false">'+i+"</a>"};t.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,n=null;"A"===t.tagName?n=t.href:"IMG"===t.tagName&&(n=t.src);this._navigation.navigateTo(n)}};t.prototype._getWorkflowStatusUrlAndDisplay=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("a");return{url:n.href,display:n.innerHTML}};return t})(r.default);t.default=o});
define("odsp-next/controls/fieldRender/like/LikeFieldRenderer",["require","exports","tslib","../FieldRenderer","../../../resources/DataSourceResourceKeys","../../../providers/item/ItemProvider","../../../resources/SPOResourceKeys","../FieldRender.resx","office-ui-fabric-react/lib/Styling","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","ODCFiles_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._ratingDataSource=r._parentViewModel.resources.consume(i.rating);r._itemProvider=r._parentViewModel.resources.consume(s.resourceKey);r._pageContext=r._parentViewModel.resources.consume(o.pageContext);return r}t.prototype.renderField=function(e){this._listItem=e;this._likeCount=Number(this._listItem.properties.LikesCount)||0;this._isEnabled=!f.isCheckedOutByOther(e,this._pageContext.userId);return'\n<div class="od-Like" '+(this._isEnabled?'data-bind="click: '+this._getOnClick()+'"':"")+'>\n  <div class="'+this.getHeartClass()+'"></div>\n  <span class="od-Like-count">'+this._likeCount+'</span>\n  <span class="od-Like-text">'+u.default.LikesCountText+"</span>\n</div>"};t.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,n=!this.isLiked();t.firstElementChild.className=this.getHeartClass();this.setLike(n);t.getElementsByClassName("od-Like-count")[0].innerHTML=String(this._likeCount+(n?1:-1))}e.cancelBubble=!0;e.preventDefault()};t.prototype.setLike=function(e){var t=this,n={item:this._listItem,like:e};return this._ratingDataSource.setLike(n).then(function(e){isNaN(e)||(t._likeCount=e);return t._itemProvider.invalidateItem(t._listItem.parentKey,{triggerFetch:!0})})};t.prototype.isLiked=function(){var e=this,t=this._listItem.reputationProperties.LikedBy;return t&&t.some(function(t){return Number(t.id)===e._pageContext.userId})};t.prototype.getHeartClass=function(){var e=this.isLiked()?"od-Like-heartFull "+a.getIconClassName("HeartFill"):"od-Like-heartEmpty "+a.getIconClassName("Heart");return e+=this._isEnabled?" od-Like-enabled":""};return t})(r.default);t.default=l});
define("odsp-next/controls/fieldRender/ComplianceRecordFlagFieldRenderer",["require","exports","tslib","./FieldRenderer","../../utilities/complianceTag/ComplianceTagUtilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){return i.complianceRecordFlagValueAsYesNoString(e)};return t})(r.default);t.default=s});
define("odsp-next/controls/detailsRow/DetailsRowRenderer",["require","exports","knockout","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/HtmlEncoding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._detailsRowViewModel=e.rowViewModel;this._rootElement=e.rootElement.getElementsByClassName("DetailsRow")[0];this._bindingsActive=!1}e.prototype.activateBindings=function(){if(!this._bindingsActive){n.applyBindingsToDescendants(this._detailsRowViewModel,this._rootElement);this._bindingsActive=!0}};e.prototype.refreshRow=function(){this.renderRow();this.activateBindings()};e.prototype.renderRow=function(){this._rootElement.innerHTML=this._getRowHtml();this._bindingsActive=!1};e.prototype._getCustomColumnHtmlValue=function(e){for(var t="",n=0,r=0,i=e;r<i.length;r++){var s=i[r];t+='<span class="DetailsRow-cellItem '+(n!==s.customRowNumber?"DetailsRow-cellItem--isLastRowItem":"")+'">'+this._detailsRowViewModel.getHtmlValue(s)+"</span>";n=s.customRowNumber}return t};e.prototype._getRowHtml=function(){for(var e=this._detailsRowViewModel.columns.peek(),t=!1,s=0,o=e;s<o.length;s++){if((c=o[s]).customFields){t=!0;break}}for(var u='<span role="{6}" class="{0}" {5} style="{1}" {2}data-bind="'+(t?"click: $data.onSelectableItemClick.bind($data, {3}), longTap: { callback: $data.onLongTap.bind($data) },":"")+'attr: { tabindex: $data.getCellTabindex({3}) }, hasFocus: $data.getCellFocusObservable({3}),keyboard: { mappings: { Enter: $data.onEnter.bind($data, {3}), Left: $data.onLeft.bind($data), Right: $data.onRight.bind($data) }}">{4}</span>',a=!this._detailsRowViewModel.isMobile||this._detailsRowViewModel.isCheckVisible?'<div class="DetailsRow-check" data-bind="click: onItemCheckClick"><div class="ItemCheck"><div class="ItemCheck-background"></div><div class="ItemCheck-check"></div></div></div>':"",f="",l=0;l<e.length;l++){var c=e[l],h=n.observable(l),p=this._detailsRowViewModel.getCellAriaLabel(h),d=this._detailsRowViewModel.getTextValue(c),v=this._detailsRowViewModel.getHtmlValue(c);if(c.canAutoResize&&this._detailsRowViewModel.longestRenderedCells&&d){var m=this._detailsRowViewModel.longestRenderedCells[c.internalName];(!m||m.text.length<d.length)&&(this._detailsRowViewModel.longestRenderedCells[c.internalName]={text:d,html:v})}f+=r.format(u,this._detailsRowViewModel.getClass(c),this._detailsRowViewModel.getStyle(c,h),p?'aria-label="'+i.default.encodeText(p)+'"':"",l,c.customFields?this._getCustomColumnHtmlValue(c.customFields):v,c.showTooltip?'title="'+i.default.encodeText(d)+'"':"",c.isRowHeader?"rowheader":"gridcell")}return a+'<span class="DetailsRow-columns">'+f+"<span>"};return e})();t.default=s});
define("odsp-next/bindings/focus/DelayedHasFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../scrollContainer/ScrollContainerBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n,r,i=e.call(this,t)||this,s=i.valueAccessor();r=(n=i.isObservable(s)?{hasFocus:s}:s).focusState?n.focusState:n.hasFocus?i.createComputed({read:function(){return n.hasFocus()?2:0},write:function(e){return n.hasFocus(!!e)},pure:!0}):i.createObservable(0);i._focusState=r;i._asyncUpdateFocus=i.async.debounce(i._updateFocus,30);i.events.on(i.element,"focus",i._onFocus);i.events.on(i.element,"blur",i._onBlur);i.subscribe(i._focusState,i._onFocusStateChanged);n.timeout?i.async.setTimeout(i._startUpdateFocus,n.timeout):i._startUpdateFocus();return i}t.prototype._onFocus=function(){this._focusState(2);this._startUpdateFocus()};t.prototype._onBlur=function(){this._focusState(0);this._startUpdateFocus()};t.prototype._onFocusStateChanged=function(){this._startUpdateFocus()};t.prototype._startUpdateFocus=function(){this._focusAttempts=0;this._updateFocus()};t.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=i.getScrollContainer(this.element),n=void 0,r=void 0;t&&(n=t.scrollTop,r=t.scrollLeft);this.element.focus();if(t&&1===e){t.scrollTop!==n&&(t.scrollTop=n);t.scrollLeft!==r&&(t.scrollLeft=r)}!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()};t.prototype._checkIfFocused=function(){var e,t=this.element.ownerDocument;try{e=t.activeElement}catch(n){e=t.body}return e===this.element};return t})(r.default);t.default=s});
define("odsp-next/bindings/longTap/LongTapBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||1e3;n.events.on(n.element,"mousedown",n._onTouchStart);n.events.on(n.element,"touchstart",n._onTouchStart);n.events.on(n.element,"mouseup",n._onTouchEnd);n.events.on(n.element,"touchend",n._onTouchEnd);return n}t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=null}};t.prototype._onTouchStart=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onLongTap.bind(this,e),this._delay)};t.prototype._onTouchEnd=function(e){this._clearTimer()};t.prototype._onLongTap=function(e){this._timerID=null;this._callback&&this._callback(e)};return t})(r.default);t.default=i});
define("odsp-next/controls/list/layouts/MobileDetailsLayout",["require","exports","tslib","./DetailsLayout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:15}};t.prototype.getHeaderCell=function(){return null};return t})(r.default);t.default=i});
define("odsp-next/controls/detailsHeader/DetailsHeader",["require","exports","./DetailsHeader.html","./DetailsHeaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css","../itemCheck/ItemCheck"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-details-header",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/detailsHeader/DetailsHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="DetailsHeaderContainer" data-bind="if:!isMobile"><div class="DetailsHeader" role="row" tabindex="0" data-bind="keyboard:{mappings:{Right:$component.headerContainerOnRight.bind($component)},context:$data}">\x3c!--ko if:isCheckVisible--\x3e<ms-item-check class="DetailsHeader-check" data-bind="click:$component.toggleAllSelected.bind($component),css:{\'can-select\':isSelectAllAvailable,\'is-selected\':isAllSelected,\'is-selection-active\':isSelectionActive,\'is-focused\':$data.isItemCheckFocused},hasFocus:$data.isItemCheckFocused,keyboard:{mappings:{Enter:$component.toggleAllSelected.bind($component),Right:$component.onRight.bind($component)},context:$data},attr:{tabindex:$data.isItemCheckFocused()?0:-1,\'aria-label\':checkBoxAriaLabel}"></ms-item-check>\x3c!--/ko--\x3e<div class="DetailsHeader-columns" data-bind="foreach:columns"><div role="columnheader" data-bind="if:$data.name,class:$component.getClass($data),attr:{style:$component.getStyle($data,$index),\'aria-sort\':$component.getColumnAriaSort($data),tabindex:$data.isFocused()?0:-1},hasFocus:$data.isFocused,keyboard:{mappings:{Enter:$component.onEnter.bind($component),Space:$component.onEnter.bind($component),Left:$component.onLeft.bind($component),Right:$component.onRight.bind($component),Down:$component.onDown.bind($component)},context:$data}"><div data-bind="click:$component.onClick.bind($component),class:$component.getCellClass($data)"><div class="cellBuffer"><div data-bind="class:$component.getSortClass($data)"></div><div class="cellText" data-bind="text:$data.name"></div></div></div>\x3c!--ko if:$data.filterable--\x3e<div data-bind="click:$component.onMenuClick.bind($component),class:$component.getMenuClass($data),attr:{\'aria-label\':$component.getColumnFilterAriaLabel($data),role:$data.isFiltered()?\'button\':null}"></div>\x3c!--/ko--\x3e</div></div></div></div>'});
define("odsp-next/controls/detailsHeader/DetailsHeaderViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/PagesResourceKeys","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/locale/Locale","../../bindings/contextMenu/ContextMenuBinding","../../bindings/contextMenu/ContextMenuHelper","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/string/StringHelper","./DetailsHeader.resx","../../controls/list/react/SelectionManager","../../bindings/keyboard/KeyboardBinding","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=(function(t){n.__extends(u,t);function u(e){var n=t.call(this,e)||this;n.addBindingHandlers({keyboard:m.default});var u=e.itemSet,a=e.cellLocations;n.navigation=n.resources.consume(x.navigation);n.sortManager=n.resources.consume(o.sortManager);n._selectionModel=n.resources.consume(i.itemsSelection);n._isSelectionModal=n.resources.consume(v.isSelectionModalResourceKey);n._platform=n.resources.consume(T.platformDetection);n._urlDataSource=n.resources.consume(s.url);n._currentView=n.resources.isExposed(i.currentView)?n.resources.consume(i.currentView):r.observable(null);n._engagement=n.resources.consume(c.resourceKey);n._itemSet=u;n._cellLocations=a;n.isAllSelected=n._selectionModel.isAllSelected;n.isSelectionActive=n._selectionModel.isActive;n.isMobile=n._platform.isMobile;n._currentFocusColumnIndex=r.observable(-1);n.isItemCheckFocused=r.observable(!1);n.isFilterMenuFocused=r.observable(!1);n.columns=n.createPureComputed(n._computeColumns);n.isCheckVisible=n.createPureComputed(n._computeIsCheckVisible);n.isSelectAllAvailable=n.createPureComputed(n._computeIsSelectAllAvailable);n.checkBoxAriaLabel=n.createPureComputed(n._computeCheckBoxAriaLabel);n.subscribe(n._currentFocusColumnIndex,function(e){e>=0&&n.columns().length>0&&n.columns()[e].isFocused(!1)},!0);n.subscribe(n._currentFocusColumnIndex,function(e){e>=0&&n.columns().length>0&&n.columns()[e].isFocused(!0)});return n}u.prototype.dispose=function(){t.prototype.dispose.call(this);this.columns.dispose()};u.prototype.getStyle=function(e,t){var n=this._cellLocations()[t()];return n&&n.width?"width: "+n.width+"px; "+a.default.safeLeft+": "+n.left+"px;":"display: none"};u.prototype.getClass=function(e){return"DetailsHeader-cell "+e.key+(e.sortable?" isSortable":"")};u.prototype.getCellClass=function(e){return"cellContainer"+(e.filterable?" isFilterable":"")+(!e.isFocused||!e.isFocused()||e.filterable&&this.isFilterMenuFocused()?"":" is-focused")};u.prototype.getSortClass=function(e){return"cellSort"+(e.isSorted?" isSorted":"")+(e.isAscending?" isAscending":"")};u.prototype.getMenuClass=function(e){return"cellMenuLink"+(e.isFiltered()?" isFiltered":"")+(e.isFocused&&e.isFocused()&&this.isFilterMenuFocused()?" is-focused":"")};u.prototype.onClick=function(e,t){if(e.sortable){if(this.resources.isExposed(N.rumOneHelper)){this.resources.consume(N.rumOneHelper).logFilterSort("Sort")}if(e.internalName){var n=[h.capitalizeFirstLetter(e.internalName),"Header","Click"].join(".");this._engagement.logData({name:n,isIntentional:!0})}var r=e.internalName||e.key,i=e.isSorted?!e.isAscending:!e.sortDescFirst,s=new g.Action({name:"ColumnHeaderSort",pageType:b.default[this._urlDataSource.getPageType()],queryType:w.default[this._urlDataSource.getQueryType()]}),o={sortMode:e.isSorted?"Column":"Order",sortColumn:r,sortAscending:i?"Ascending":"Descending"};s.end({resultType:y.ResultTypeEnum.Success,extraData:o});this.sortManager.updateSort(r,i);t.stopPropagation();t.preventDefault();return!1}};u.prototype.onMenuClick=function(t,n){var r=this;if(t.filterable){var i=[h.capitalizeFirstLetter(t.name),"HeaderGlyph",h.ClickName].join(".");this._engagement.logData({name:i,isIntentional:!0,extraData:{action:h.capitalizeFirstLetter(n.type)}});var o=t.internalName||t.key,u=E.serializeQuery(this.navigation.viewParams),a=this._currentView&&this._currentView.peek(),c=a&&a.id,p=this.resources.consumeAsync(s.items).then(function(e){return e.getFilterData(o,u,c)}),d=S.default.resolve(new Promise(function(t,n){e(["../../utilities/list/ListFilterHelperDeferred"],t,n)})).then(C.getDefaultExport);S.default.all({filterData:p,type:d}).then(function(e){var i=e.filterData,s=e.type,a=i?s.getFilterMenuItems(r.resources,t,i,u,o):[],c=new l.default({items:a,rootElementClass:"List",boundingElementClass:"Files-content"});f.default.createContextMenu(n,c,r)});n.stopPropagation();n.preventDefault();return!1}};u.prototype.toggleAllSelected=function(e,t){this._selectionModel.setIsActive(!0);this._selectionModel.toggleSelectAll();t.stopPropagation();t.preventDefault();return!1};u.prototype.onLeft=function(e){if(e.filterable&&this.isFilterMenuFocused())this.isFilterMenuFocused(!1);else{var t=this.getLeftFocusColumnIndex();this._currentFocusColumnIndex(t);-1===t&&this.isItemCheckFocused(!0);this.isFilterMenuFocused(!0)}return!1};u.prototype.onRight=function(e){if(!e.filterable||this.isFilterMenuFocused()){this.isFilterMenuFocused(!1);this._currentFocusColumnIndex(this.getRightFocusColumnIndex())}else this.isFilterMenuFocused(!0);return!1};u.prototype.onDown=function(e,t){if(e.filterable&&this.isFilterMenuFocused()){this.onMenuClick(e,t);return!1}};u.prototype.onEnter=function(e,t){e.filterable&&this.isFilterMenuFocused()?this.onMenuClick(e,t):this.onClick(e,t);return!1};u.prototype.headerContainerOnRight=function(){this.isItemCheckFocused(!0);this._currentFocusColumnIndex(-1);return!1};u.prototype.getColumnAriaSort=function(e){var t="none";e.isSorted&&(t=e.isAscending?u._ascendingAriaSort:u._descendingAriaSort);return t};u.prototype.getColumnFilterAriaLabel=function(e){var t=null;e.isFiltered()&&(t=p.format(d.default.columnFilterAriaLabel,e.name,e.filterValues()));return t};u.prototype.getRightFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),n=e+1;n<t.length;n++)if(t[n].name){e=n;break}return e};u.prototype.getLeftFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),n=!1,r=e-1;r>=0;r--)if(t[r].name){e=r;n=!0;break}n||(e=-1);return e};u.prototype._computeIsSelectAllAvailable=function(){return 0===this._selectionModel.mode||this._selectionModel.selection().length>0};u.prototype._computeIsCheckVisible=function(){return!this._platform.isMobile||this._isSelectionModal()||this._selectionModel.selection().length>0};u.prototype._computeColumns=function(){var e=this;return this._itemSet().schema().filter(function(t){return t.isVisible&&!e._platform.isMobile||e._platform.isMobile&&t.isVisibleMobile})};u.prototype._computeCheckBoxAriaLabel=function(){return this._selectionModel.isAllSelected()?d.default.deselectAllAriaLabel:d.default.selectAllAriaLabel};u._ascendingAriaSort="ascending";u._descendingAriaSort="descending";return u})(u.default);t.default=k});
define("odsp-next/controls/itemCheck/ItemCheck",["require","exports","./ItemCheck.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemCheckViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-item-check",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/itemCheck/ItemCheck.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="ItemCheck"><i class="ItemCheck-circle ms-Icon ms-Icon--CircleRing" data-bind="icon:true"></i><i class="ItemCheck-check ms-Icon ms-Icon--StatusCircleCheckmark" data-bind="icon:true"></i></span>'});
define("odsp-next/controls/itemCheck/ItemCheckViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.isSelectable,i=void 0!==r&&r,s=t.isSelected,o=void 0!==s&&s;n.isSelectable=n.wrapObservable(i);n.isSelected=n.wrapObservable(o);return n}return t})(r.default);t.default=i});
define("odsp-next/controls/list/CompactDetailsList",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.createComponent("ms-compact-details-list","./react/detailsList/ReactDetailsList",function(){return n.default.resolve(new Promise(function(t,n){e(["./react/detailsList/ReactDetailsList"],t,n)}))},{isCompact:!0});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);t.default=s});
define("odsp-next/controls/list/DetailsList",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.createComponent("ms-details-list","./react/detailsList/ReactDetailsList",function(){return n.default.resolve(new Promise(function(t,n){e(["./react/detailsList/ReactDetailsList"],t,n)}))});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);t.default=s});
define("odsp-next/controls/list/GridList",["require","exports","./List.html","knockout","./viewModels/GridListViewModel","@ms/odsp-utilities/lib/async/Promise","../../utilities/features/Features","../reactHost/ReactHost","@ms/odsp-datasources/lib/interfaces/WebTemplateType","ODCFiles_css","../itemTile/ItemTile"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=window._spPageContextInfo,l=!f||Number(f.webTemplate)===a.default.mySite,c=o.isFeatureEnabled(o.UseReactGridList)&&!l?u.createComponent("ms-grid-list","./react/gridList/ReactGridList",function(){return s.default.resolve(new Promise(function(t,n){e(["./react/gridList/ReactGridList"],t,n)}))}):{tagName:"ms-grid-list",template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(c.tagName)||r.components.register(c.tagName,c);t.default=c});
define("odsp-next/controls/list/List.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="List" role="list" data-bind="pulse:visibleModels">\x3c!--ko if:headerVisible()--\x3e<div class="List-header" data-bind="if:headerType(),attr:{style:headerStyle}">\x3c!--ko component:{name:headerType,params:headerParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="List-placeHolder" data-bind="style:{height:placeHolderHeight()+\'px\'}"></div><div class="List-surface" role="presentation" data-bind="viewport:viewport,marqueeSelection:{selectionModel:selectionModel,layout:activeLayout,isEnabled:enableMarqueeSelection},clearSelection:{selectionModel:selectionModel,isEnabled:enableClearSelection},selection:{isSelectionOnKeyInputEnabled:isSelectionOnKeyInputEnabled,items:items,layout:activeLayout,selectionModel:selectionModel,isReadyToBeSelected:$component.isReadyToBeSelected.bind($component)},interactionScope:{isActive:isActive},recoverFocus:{isEnabled:isActive,onlyRecoverFromBody:true},customRender:true,contextMenu:contextMenuHelper,attr:{\'aria-label\':tooltip,tabindex:tabIndex},element:surfaceElement"></div></div>'});
define("odsp-next/controls/list/viewModels/GridListViewModel",["require","exports","tslib","./ListViewModel","../layouts/GridLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(i.default))(t));return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/GridLayout",["require","exports","tslib","./BaseGridLayout","../../sharing/sharerHeader/SharerHeader","../../headerTile/HeaderTile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getGroup=function(e,t){var n,r=this._itemSet().content.peek().groupings||[];if(r&&r.length&&r[0].itemGroups)for(var i=0,s=r[0].itemGroups;i<s.length;i++){var o=s[i];if(o){var u=o.startIndex+o.count-1;if(o.startIndex<=e&&u>=e){n=o;break}}}return n};t.prototype.getHeader=function(e,t,n){var r=null,i=t&&t.peek&&t.peek(),s=this.getGroup(n,i);if(s&&!s.isPlaceholder&&this.currentGroup!==s){this.nextGroup=s;var o=this.getHeaderDetails(s,n);0!==n||o.viewType||(o.headerHeight=0);var u=o.key?o.key:i?i.key+"_header":null;u&&(r={key:u,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:o.headerHeight,viewType:o.viewType,viewData:o.viewData})}return r};t.prototype.getHeaderDetails=function(e,t){var n,r="",o={},u=20;if(e)if("sharer"===e.groupingId){0===e.startIndex&&(this.callerLongCid=null===(n=e.data)||void 0===n?void 0:n.sharerLongCid);r=i.default.tagName;o={group:e,cellsInGroup:0,resources:this.resources,callerLongCid:this.callerLongCid};u=84}else if(e.name){r=s.default.tagName;o={group:e};u=46}return{viewType:r,viewData:o,headerHeight:u}};return t})(r.default);t.default=o});
define("odsp-next/controls/list/layouts/BaseGridLayout",["require","exports","tslib","./BaseLayout","@ms/odsp-utilities/lib/locale/Locale","../../../controls/itemTile/ItemTile","../../../utilities/browser/ResponsiveUI","../../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;(function(e){e.folder={Small:110,Medium:110,Large:120,XLarge:120,XXLarge:120,XXXLarge:120,XXXXLarge:120};e.documents={Small:130,Medium:130,Large:160,XLarge:160,XXLarge:160,XXXLarge:160,XXXXLarge:160};e.photos={Small:90,Medium:90,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170};e.other={Small:120,Medium:120,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170}})(a=t.MinRowHeights||(t.MinRowHeights={}));var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.visibleRange=null;n.currentGroup=null;n.nextGroup=null;n._headerIndices=[];n.rows=[];n.responsiveHelper=n.resources.consume(o.resourceKey);n.canSelectHeaders=!1;n._footerItem=t.footerItem;n._footerItem&&n.subscribe(n._footerItem,function(){n.evaluateLayout(!0)&&n.change()});return n}t.prototype.getOuterMargin=function(){return{top:0,left:0,bottom:0,right:0}};t.prototype.getMinCellWidth=function(){return 40};t.prototype.getInnerMargin=function(){return this.isSmallWidthLayout?3:8};t.prototype.getMinRowHeight=function(){var e,t=this._getGroupName(this.currentGroup),n=this.responsiveHelper.formFactorSize.peek();switch(t){case"folder":e=a.folder[n];break;case"document":e=a.documents[n];break;case"photo":e=a.photos[n];break;default:e=a.other[n]}return e};t.prototype.getItemAspectRatio=function(e){var t,n=this._getGroupName(this.currentGroup),r=this.unwrapObservable(e);switch(n){case"folder":t=r&&r.isAlbum?1:this.isSmallWidthLayout?4/3:1.6;break;default:if(r&&r.subsite)t=5.5;else if(r&&(r.photo||r.video)&&r.thumbnail&&r.thumbnail.width){var i=r.orientedThumbnail,s=!!i&&i.rotation%2==1,o=(i||r).thumbnail,a=s?o.height:o.width,f=s?o.width:o.height,l=Math.max(a,this.getMinCellWidth()),c=Math.max(f,this.getMinRowHeight());t=Math.max(.5,Math.min(3,l/c))}else t=(r&&(r.queryType,u.default.Discover),1)}return t};t.prototype.getIsFixed=function(){switch(this._getGroupName(this.currentGroup)){case"photo":return!1;default:return!0}};t.prototype.getCellByKey=function(e){var t;if(this.cells)for(var n=0,r=this.cells;n<r.length;n++){var i=r[n];if(i.key===e){t=i;break}}return t};t.prototype.getItemViewType=function(e){return e?s.default.tagName:null};t.prototype.getItemViewData=function(e){return{item:e,resources:this.resources,group:this.currentGroup,engagementSource:"GridViewTile"}};t.prototype.getVisibleRange=function(e){void 0===e&&(e=this.viewport);var t=this.getRowRangeForViewport(e),n=t.start,r=t.end,i=this.rows[n],s=this.rows[r-1];this.visibleRange={start:n>=0?i.cells[0].cellIndex:-1,end:r>=0?s.cells[s.cells.length-1].cellIndex+1:-1};return this.visibleRange};t.prototype.getMaterializedRange=function(){var e={start:this.visibleRange.start,end:this.visibleRange.end};if(e.start>=0){var t=this.cells[e.end-1].rowIndex-this.cells[e.start].rowIndex+1,n=this.cells[this.visibleRange.start].rowIndex,r=this.cells[this.visibleRange.end-1].rowIndex,i=Math.max(3*t,30),s=Math.max(3*t,30);n=Math.max(0,n-i);r=Math.min(this.rows.length-1,r+s);e.start=this.rows[n].cells[0].cellIndex;var o=this.rows[r];e.end=o.cells[o.cells.length-1].cellIndex+1}return e};t.prototype.getSurfaceSize=function(){var e=this.lastRow,t=this.getOuterMargin();return{width:this.viewport.width,height:e?e.top+e.height+t.bottom:0}};t.prototype.getCellCount=function(){return this.cells.length};t.prototype.getCellAt=function(e){return this.cells&&this.cells[e]};t.prototype.getItemIndexAbove=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),n=t?t.index:-1;t&&(n=this._findNearestCellInRow(t,-1).index);return n};t.prototype.getItemIndexBelow=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),n=t?t.index:0;t&&(n=this._findNearestCellInRow(t,1).index);return n};t.prototype.getItemIndexLeft=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));t&&(t=this._findNextCell(t,i.default.isRightToLeft?1:-1));return t?t.index:-1};t.prototype.getItemIndexRight=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));t&&(t=this._findNextCell(t,i.default.isRightToLeft?-1:1));return t?t.index:-1};t.prototype.getItemIndicesInRegion=function(e){for(var t=[],n=0;n<this.rows.length;n++){var r=this.rows[n];if(r.top>e.y+e.height)break;if(r.top<=e.y+e.height&&r.top+r.height>=e.y)for(var i=0;i<r.cells.length;i++){var s=r.cells[i];s.item&&s.left<=e.x+e.width&&s.left+s.width>=e.x&&t.push(s.index)}}return t};t.prototype.getToggleClass=function(){return"ItemTile-rowCheck"};t.prototype.evaluateLayout=function(e){var t=this._itemSet.peek(),n=t&&t.content.peek().items;if(!n||!this.viewport||this.viewport.width<100)return!1;if(e){var r=!0,i=this.responsiveHelper;this.isSmallWidthLayout=i.compareSize(i.formFactorSize(),"Medium")<=0;this.cells=[];this._itemIndexToCell={};this.rows=[];this._headerIndices=[];this.lastRow=null;this._lastRowInGroup=null;this.currentGroup=null;this.nextGroup=null;this.currentRow=null;for(var s=0;s<n.length;s++){var o=n[s];o||(r=!1);this.addToCurrentRow(this.getHeader(n[s-1],o,s),!0);this.addToCurrentRow(this.getCell(o,s))}this._footerItem&&this._footerItem.peek()&&r&&this.addToCurrentRow(this.getFooterCell(this._footerItem));this.finalizeRow(!0)}return!0};t.prototype.addToCurrentRow=function(e,t){this.addToRow(this.getCurrentRow(),e,t)};t.prototype.addToRow=function(e,t,n){if(t){if(void 0===t.shouldLineBreak?n:t.shouldLineBreak){this.finalizeRow(!0,e.isHeader);(e=this.getCurrentRow()).isHeader=!0;e.cells.push(t);this.finalizeRow(!1,!0)}else{if(!this.canAddCell(t)){this.finalizeRow(!0,!1);e=this.getCurrentRow()}e.aspectRatio+=t.aspectRatio;e.cells.push(t);t.isHeader||t.shouldLineBreak||e.itemCellCount++}}};t.prototype.getFooterCell=function(e){var t=e.peek(),n=null;t.component&&(n={key:"footer",item:t.component,index:-1,cellIndex:this.cells.length,viewType:t.component.name,viewData:t.component.params,aspectRatio:t.aspectRatio?t.aspectRatio:1});return n};t.prototype.getCell=function(e,t){var n=e&&e.peek&&e.peek();return{key:n?n.key:"item-"+t,item:e,index:t,cellIndex:this.cells.length,viewType:this.getItemViewType(n),viewData:this.getItemViewData(e),aspectRatio:this.getItemAspectRatio(e)}};t.prototype.getCellIndexFromItemIndex=function(e){var t=this._itemIndexToCell&&this._itemIndexToCell[e];return t?t.cellIndex:-1};t.prototype.getAvailableWidth=function(){var e=this.getOuterMargin(),t=this.getInnerMargin(),n=this.currentRow?(this.currentRow.cells.length-1)*t:0;return this.viewport.width-(e.left+e.right)-n};t.prototype.finalizeRow=function(e,t){var n=this.currentRow;if(this.currentRow&&this.currentRow.cells.length){var r=this.getOuterMargin(),i=this.getInnerMargin(),s=this.lastRow,o=Math.ceil(this._getRowHeight(n,t)),u=0,a=null,f=null,l=null,c=void 0,h=!1;n.top=Math.round(s?s.top+s.height+i:r.top);n.height=o;for(c=0;c<n.cells.length;c++){var p=(l=n.cells[c]).aspectRatio||0,d=this._determineCellLeft(r,u,o,i,c),v=this._determineCellWidthWithAspectRatio(p,o,r,d);if(h=this._shouldCreateNewRow(l,n,c,v)){a&&(a.width+=v+i);break}l.isFixedWidth&&(p=l.width/o);t&&this._headerIndices.push(this.cells.length);l.cellIndex=this.cells.length;void 0!==l.index&&-1!==l.index&&(this._itemIndexToCell[l.index]=l);this.cells.push(l);l.left=this._determineCellLeft(r,u,o,i,c);l.top=n.top;l.isFixedWidth||(l.aspectRatio?l.width=this._determineCellWidthWithAspectRatio(p,o,r,l.left):l.width=this.viewport.width-r.right-l.left);l.height=o;l.rowIndex=this.rows.length;u+=p;a=l}h&&n.cells.pop();this.rows.push(n);t?this.currentHeaderCell=n.cells[0]:this.currentHeaderCell&&this.updateHeader(this.currentHeaderCell,n.cells.length);this.lastRow=n;this._lastRowInGroup=t?null:n;this.currentGroup=this.nextGroup;this.currentRow=null;if(h){f=this.makeNewRow();this.addToRow(f,l,l.isHeader);this.currentRow=f;l.cellIndex===this.cells.length-1&&this.finalizeRow()}}};t.prototype.canAddCell=function(e){var t=!1,n=this.getCurrentRow(),r=this.getInnerMargin(),i=this.getMinRowHeight(),s=this.getOuterMargin(),o=this.getRowMaxAspectRatio(s,r,i,n);this._processCell(e);e&&n.aspectRatio+e.aspectRatio<=o?t=!0:n.isFull=!0;return t};t.prototype.getRowMaxAspectRatio=function(e,t,n,r){return(this.viewport.width-(e.left+e.right)-r.cells.length*t)/n};t.prototype.getCurrentRow=function(){this.currentRow||(this.currentRow=this.makeNewRow());return this.currentRow};t.prototype.makeNewRow=function(){return{cells:[],top:0,height:0,aspectRatio:0,itemCellCount:0}};t.prototype.updateHeader=function(e,t){};t.prototype.getRowRangeForViewport=function(e){var t=-1,n=-1;if(this.rows.length&&e.width>0&&e.height>0){var r=this.rows.length-1,i=this.rows[0],s=this.rows[r],o=i.top,u=s.top+s.height,a=Math.max(o,Math.min(e.visibleTop,u-e.height)),f=Math.min(u,Math.max(e.visibleBottom,o+e.height)),l=i;t=0;for(;l&&l.top+l.height<a;)l=this.rows[++t];n=t;for(;l&&n<r&&l.top<f;)l=this.rows[++n];n=Math.min(n,r)+1}return{start:t,end:n}};t.prototype._determineCellLeft=function(e,t,n,r,i){return Math.ceil(e.left+t*n+r*i)};t.prototype._determineCellWidthWithAspectRatio=function(e,t,n,r){return Math.min(Math.ceil(e*t),this.viewport.width-n.right-r)};t.prototype._shouldCreateNewRow=function(e,t,n,r){var i=e.shouldNotBeLastInRow&&t.cells.length>1&&n===t.cells.length-1,s=r>0&&r<=30&&n===t.cells.length-1;return i||s};t.prototype._processCell=function(e){var t=this.getOuterMargin();e.width||(e.width=this.viewport.width-t.left-t.right)};t.prototype._getRowHeight=function(e,t){var n=this.getMinRowHeight(),r=0,i=this.getAvailableWidth(),s=this.getOuterMargin(),o=this.getInnerMargin(),u=e.cells[0],a=this.getIsFixed();if(u.width)if(!e.isFull&&a){var f=u.aspectRatio,l=1,c=void 0,h=void 0;do{c=this.viewport.width-(s.left+s.right)-l++*o;f+=u.aspectRatio;h=c/n}while(f<=h);r=(c+=o)/(f-=u.aspectRatio)}else e.isFull?r=i/e.aspectRatio:this._lastRowInGroup&&(r=i/this._lastRowInGroup.aspectRatio);else r=u.height;return Math.max(t?r:n,r)};t.prototype._findNextCell=function(e,t){for(var n=e.cellIndex+t,r=this.cells[n];n>=0&&n<this.cells.length&&void 0===r.index;){n+=t;r=this.cells[n]}return r};t.prototype._findNearestCellInRow=function(e,t){var n=-1,r=null,i=e.rowIndex+t,s=this.rows[i],o=this.rows[e.rowIndex];if(s&&s.isHeader&&!this.canSelectHeaders)return e;for(;e&&!r&&s;){for(var u=0;u<s.cells.length;u++){var a=s.cells[u],f=Math.abs(this._getPosition(e,o.isHeader)-this._getPosition(a));if(void 0!==a.index&&(-1===n||f<n)){n=f;r=a}}if(!r){i+=t;s=this.rows[i]}}return r||e};t.prototype._getPosition=function(e,t){var n=t&&this.canSelectHeaders?0:e.width;return e.left+n/2};t.prototype._getGroupName=function(e){var t="";e&&e.groupingId?t=e.groupingId:!e||void 0===e.closedFuture&&void 0===e.closedPast||(t="photo");return t};return t})(r.default);t.default=f});
define("odsp-next/controls/itemTile/ItemTile",["require","exports","./ItemTile.html","./ItemTileFolder.html","./ItemTileFile.html","./ItemTilePhoto.html","./ItemTileVideo.html","./ItemTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css","../folderCoverTile/FolderCoverTile","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.registerComponent({tagName:"ms-item-tile",template:n.default,viewModel:u.default,synchronous:!0});a.registerTemplate("ms-item-tile-folder",r.default);a.registerTemplate("ms-item-tile-file",i.default);a.registerTemplate("ms-item-tile-photo",s.default);a.registerTemplate("ms-item-tile-video",o.default);t.default=f});
define("odsp-next/controls/itemTile/ItemTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<div class=\"ItemTile od--hasContextMenu\" data-automationid=\"ms-item-tile\" data-bind=\"event:{focus:onFocus},delayedHasFocus:{focusState:focusState},class:colorName()?'od-ItemTile--color-'+colorName():'',css:{'is-tag':isTag(),'is-folder':isFolder()&&!isAlbum(),'is-file':isFile(),'is-media':isMedia(),'is-receivingDrop':isReceivingDrop,'is-dropping':isDroppingTarget,'is-checkVisible':isCheckVisible,'can-select':isSelectable,'has-thumbnail':hasThumbnail,'is-selected':isSelectable()&&isSelected(),'is-focused':isInteractable&&isFocused(),'od-ItemTile--isAlbum':isAlbum(),'od-ItemTile--isStory':isStory(),'od-ItemTile--isVideo':isVideo(),'od-ItemTile--noDate':!isDateVisible(),'od-ItemTile--isInteractable':isInteractable,'od-ItemTile--isInvokable':isInvokable,'od-ItemTile--hasImageStack':hasImageStack,'od-ItemTile--isDiscover':isDiscoverCard()},attr:{tabindex:tabindex,'aria-label':getRowAriaLabel()},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop},automation:itemAutomationId\"><a data-is-focusable=\"false\" class=\"ItemTile-link\" tabindex=\"-1\" data-bind=\"event:{click:onClick,mousedown:onMouseDown},element:inputElement,attr:{href:linkUrl,title:longTagTooltip},automation:'link'\"><div class=\"ItemTile-content\" data-bind=\"template:{name:templateName,if:templateName}\"></div><div class=\"ItemTile-selector\"><div class=\"ItemTile-frame\" data-bind=\"attr:{title:item().tooltipText}\"></div><div class=\"ItemTile-rowCheck\" data-bind=\"component:{name:itemCheckTagName,params:{}},automation:'select-link',event:{click:onItemCheckClick}\"></div></div></a>\x3c!--ko if:enableFileHoverCard--\x3e<div data-bind=\"react:fileHoverCardComponent\"></div>\x3c!--/ko--\x3e</div>"});
define("odsp-next/controls/itemTile/ItemTileFolder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ItemTile-image" data-bind="component:{name:\'od-folder-cover-tile\',params:{item:item,imageRect:imageRect,pulseTarget:pulseTarget}}"></div><div class="ItemTile-dragDropIcon"></div><div class="ItemTile-namePlate"><div class="ItemTile-folderBeak"></div><div class="ItemTile-folderBeakHighlight"></div>\x3c!--ko if:!isSubTextVisible()&&isShared()&&!isAlbum()--\x3e<i class="ItemTile-sharingIcon ms-Icon ms-Icon--People" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:hasNewBadge()--\x3e<div class="ItemTile-newBadge">\x3c!--ko component:{name:newBadgeTagName,params:newBadgeParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="ItemTile-name" data-bind="text:item().name"></div><div class="ItemTile-childCount" data-bind="text:childCount"></div><div class="ItemTile-date" data-bind="text:dateText"></div><div class="ItemTile-subText" data-bind="if:isSubTextVisible()&&!isAlbum()"><i class="ms-Icon" data-bind="icon:true,css:{\'ItemTile-sharingIcon ms-Icon--People\':isShared()&&!isBundle(),\'ms-Icon--AppIconDefault\':isBundle()}"></i><span data-bind="text:subText"></span></div></div>'});
define("odsp-next/controls/itemTile/ItemTileFile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ItemTile-fileContainer">\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,desiredSize:imageRect,alignment:[\'fitWidth\',\'top\'],isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="ItemTile-fileIconContainer"><div class="ItemTile-fileIcon" data-bind="css:{\'ItemTile-fileIcon--thumbnail\':hasThumbnail(),\'ItemTile-fileIcon--noThumbnail\':!hasThumbnail()},component:{name:\'ms-file-type-icon\',params:{iconName:item().iconName,extension:item().extension,iconSize:iconSize(),desiredSize:desiredSize()}}"></div></div><div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().displayName"></div><div class="ItemTile-subText"><img class="ItemTile-subTextImage" data-bind="attr:{src:subTextIconUrl},visible:subTextIconUrl"><i data-bind="css:subTextIconClass,visible:!subTextIconUrl()"></i><span data-bind="text:subText"></span></div></div></div>'});
define("odsp-next/controls/itemTile/ItemTilePhoto.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,rotation:rotation,desiredSize:imageRect,alignment:\'cover\',isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isNamePlateVisible--\x3e<div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().displayName"></div><div class="ItemTile-subText"><img class="ItemTile-subTextImage" data-bind="attr:{src:subTextIconUrl},visible:subTextIconUrl"><i data-bind="css:subTextIconClass,visible:!subTextIconUrl()"></i></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/itemTile/ItemTileVideo.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,desiredSize:imageRect,alignment:\'cover\',isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<span class="ItemTile-playButton"><i data-bind="css:subTextIconClass"></i></span>'});
define("odsp-next/controls/itemTile/ItemTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/ItemType","@ms/odsp-shared/lib/base/Rotation","../../resources/ControlResourceKeys","../../resources/PagesResourceKeys","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/list/SharingTypeHelper","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/string/DriveSpaceHelper","../../dataSources/url/QueryType","../../controls/list/react/SelectionManager","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../bindings/focus/DelayedHasFocusBinding","../../bindings/dragAndDrop/DragAndDropBinding","../../utilities/features/Features","../../controls/image/frame/ImageFrame","../newBadge/NewBadge","../../utilities/accessibility/AriaHelper","./ItemTile.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/dom/Dom","../../utilities/selection/SelectionHelper","../../bindings/react/ReactBinding","../../models/engagement/Engagement","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/logging/events/Qos.event","../../bindings/element/ElementBinding","office-ui-fabric-react/lib/Styling","../fileHoverCard/react/FileHoverCardHelper","../itemCheck/ItemCheck","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTileEngagementPart=new A.EngagementPart("ItemTile",3);var j=(function(r){n.__extends(j,r);function j(n){var i=r.call(this,n)||this;i.imageFrameTagName=w.default.tagName;i.newBadgeTagName=E.default.tagName;i.itemCheckTagName=H.default.tagName;i.addBindingHandlers({delayedHasFocus:g.default,element:_.default,react:L.default,dragAndDrop:y.default});var s=n.item,l=n.customTemplateName,h=void 0===l?"":l,p=n.cellSize,S=void 0===p?i.createObservable({width:100,height:100}):p,x=n.engagementSource,T=void 0===x?"ItemTile":x,C=n.isInteractable,O=void 0===C||C,M=n.button,D=n.group;i._selectionHelper=i.resources.consume(k.resourceKey);i.inputElement=i.createObservable();i.resources.expose(A.engagementSourceResourceKey,i.resources.consume(A.engagementSourceResourceKey).withPart(t.itemTileEngagementPart));i._urlDataSource=i.resources.consume(c.url);i._displayImageTileNames=!!i.resources.isExposed(o.displayImageTileNames)&&i.resources.consume(o.displayImageTileNames);i.parentItem=i.resources.consume(o.currentItem);i.resources.consume(u.base.isSPLightSpeed.optional)?i.item=i.wrapObservable(s):i.item=i.resources.expose(o.currentItem,i.wrapObservable(s));i._instrumentationProvider=i.resources.consume(v.instrumentation);i._platform=i.resources.consume(N.platformDetection);i._isSelectionModal=i.resources.consume(d.isSelectionModalResourceKey);var P=i.resources.consume(o.actionMap);i._customTemplateName=h;i.selectionModel=i.resources.consume(o.itemsSelection);i.draggable=O;i.isInteractable=O;i.isDroppingTarget=i.createObservable(!1);i.isReceivingDrop=i.createObservable(!1);i.isSelected=i.createObservable(!1);i.focusState=i.createObservable(0);i.isFocused=i.createPureComputed(function(){return!!i.focusState()});i.ignoreClickTime=i.createObservable(0);i.thumbnailError=i.createObservable();i.isThumbnailLoaded=i.createObservable(!1);i.pulseTarget=i.createObservable();i._folderChildCount=i.createObservable("");i.showPerson=i.createObservable(!1);i.button=M;i.imageRect=S;i.imageRect.equalityComparer=f.deepCompare;i.thumbnail=i.createPureComputed(i._computeThumbnail);i.thumbnail.equalityComparer=f.deepCompare;i._hasThumbnailError=i.createPureComputed(i._computeHasThumbnailError);i.hasThumbnail=i.createPureComputed(i._computeHasThumbnail);i.templateName=i.createPureComputed(i._computeTemplateName);i._action=new(i.child(P.DefaultClickAction))({item:i.item,userInvokedItem:!0,sourceEngagement:T+".Click"});i.isInvokable=i.createPureComputed(i._computeIsInvokable);i.rotation=i.createPureComputed(i._computeRotation);i.linkUrl=i.createPureComputed(i._computeLinkUrl);i.subText=i.createPureComputed(i._computeSubText);i.childCount=i.createComputed(i._computeChildCount);i.tagCount=i.createPureComputed(i._computeTagCount);i.longTagTooltip=i.createPureComputed(i._computeLongTagTooltip);i.isShared=i.createPureComputed(i._computeIsShared);i.isBundle=i.createPureComputed(i._computeIsBundle);i._subTextIconType=i.createPureComputed(i._computeSubTextIconType);i.subTextIconUrl=i.createPureComputed(i._computeSubTextIconUrl);i.subTextIconClass=i.createPureComputed(i._computeSubTextIconClass);i.isSubTextVisible=i.createPureComputed(i._computeIsSubTextVisible);i.isSelectable=i.createPureComputed(i._computeIsSelectable);i.dateText=i.createPureComputed(i._computeDateText);i.isDateVisible=i.createPureComputed(i._computeIsDateVisible);i.showTagCount=b.isFeatureEnabled(b.ShowTagCountInPhotos);i.newBadgeParams={desiredSize:i.createObservable("Small")};i.isCheckVisible=i.createPureComputed(function(){return i._platform.isMobile&&(i._isSelectionModal()||i.selectionModel.selection().length>0)});i._dropHelper=i.resources.consume(a.resourceKey);i.iconSize=i.createPureComputed(i._computeIconSize);i.desiredSize=i.createPureComputed(i._computeDesiredIconSize);i.isDroppable=i.createPureComputed(i._computeIsDroppable);i._isFirstCellInGroup=i.createPureComputed(function(){return!!D&&void 0!==D.startIndex&&i.selectionModel.getItemByIndex(D.startIndex)===i.item});i.tabindex=i.createPureComputed(function(){return i.selectionModel.focusedItem()===i.item||i._isFirstCellInGroup()?0:-1});i.isNamePlateVisible=i.createPureComputed(i._computeIsNamePlateVisible);i.colorName=i.createPureComputed(i._computeColorName);i.hasImageStack=i.createPureComputed(i._computeHasImageStack);i.itemAutomationId=i.createPureComputed(function(){var e=i.item();if(e)return e.displayName});i.createBackgroundComputed(function(){i.isReceivingDrop()&&i.isReceivingDrop(!1)}).extend({rateLimit:{timeout:1450,method:"notifyWhenChangesStop"}});i.createBackgroundComputed(function(){var e=i.item();e&&!e.isPlaceholder&&i._instrumentationProvider.userSeeItem(e)});i.createBackgroundComputed(function(){i._updateSelectionSubscription(i.item)});i._deferredLoadedTemplateName=i.createObservable(void 0);i.createBackgroundComputed(i._computeDeferredLoadedTemplateName);i.enableFileHoverCard=i.createPureComputed(i._fileHoverCardAvailable);i.fileHoverCardComponent={componentPath:"../fileHoverCard/react/FileHoverCard",getModule:function(){return m.default.resolve(new Promise(function(t,n){e(["../fileHoverCard/react/FileHoverCard"],t,n)}))},props:i.createPureComputed(i._computeFileHoverCardProps)};return i}j.prototype.dispose=function(){this._updateSelectionSubscription(null);r.prototype.dispose.call(this)};j.prototype.onItemCheckClick=function(e,t){t.shiftKey?this.selectionModel.selectToItem(this.item):this.selectionModel.toggleItemSelected(this.item);this.selectionModel.setItemFocus(this.item,{preventAnchor:!!t.shiftKey});t.preventDefault();t.stopPropagation();return!1};j.prototype.onFocus=function(e,t){this.selectionModel.setItemFocus(this.item,{})};j.prototype.onClick=function(e,t){var n=this.ignoreClickTime(),r=(new Date).getTime();if(n&&r-n<=50){t.stopPropagation();t.preventDefault();return!1}if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}return!0};j.prototype.onMouseDown=function(e,t){if(!this.isInteractable||2===t.button)return!0;var n=!!C.findAncestor(t.target,"ItemTile-rowCheck"),r=this.selectionModel.isItemSelected(this.item);if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){r||n||this.selectionModel.clear();n||this.selectionModel.setItemSelected(this.item,!0)}};j.prototype.onInvoke=function(e){if(!!!C.findAncestor(e.target,"ItemTile-rowCheck")&&this._action.isAvailable.peek()){this._action.execute(e).done();e.stopPropagation();e.preventDefault();return!1}};j.prototype.getRowAriaLabel=function(){return S.getRowAriaLabel(this.item())};j.prototype.getDragData=function(){var e=this,t=this.item.peek(),n=null,r=this.selectionModel;t.isDraggable&&r.isItemSelected(this.item)&&(n={type:1,item:t,itemSet:r.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:r.selectedCount.peek(),resources:r.resources}});return n};j.prototype.onMayReceiveDrop=function(e){var t=this.item&&this.item.peek&&this.item.peek();return t&&t.isDropEnabled&&e.item!==t&&(1===e.type||0===e.type)?{targetName:t.name}:null};j.prototype.onReceiveDrop=function(e){var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.isReceivingDrop(!0);return t};j.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1);this.pulseTarget().enablePulsing(!0)};j.prototype.getItem=function(){return this.item};j.prototype.isTag=function(){return!!this.item().tagInfo};j.prototype.isFolder=function(){return this.item().type===i.default.Folder};j.prototype.isFile=function(){return this.item().type!==i.default.Folder&&!this.isMedia()};j.prototype.isDiscoverCard=function(){return this.item().queryType===p.default.Discover};j.prototype.isMedia=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames};j.prototype.isAlbum=function(){return this.item().isAlbum};j.prototype.isStory=function(){return b.isFeatureEnabled(b.EnableEvokeAlignments)&&this.isAlbum()};j.prototype.isVideo=function(){return!!this.item().video&&this.hasThumbnail()&&!this._displayImageTileNames};j.prototype.isPhoto=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames};j.prototype.hasNewBadge=function(){var e=this.item();return!b.isFeatureEnabled(b.EnableEvokeAlignments)&&!(!e.properties.newTag||!e.properties.autoAlbumTag)};j.prototype.onButtonClick=function(e,t){if(this.button&&this.button.action){t.stopPropagation();return this.button.action.execute(t)}return m.default.wrap({resultType:M.ResultTypeEnum.ExpectedFailure})};j.prototype._fileHoverCardAvailable=function(){var e=this.item();return P.shouldEnableFileHoverCard(e,this.resources)};j.prototype._computeFileHoverCardProps=function(){var e=this.item(),t=this.inputElement();return{item:e,resources:this.resources,target:t}};j.prototype._computeSubTextIconType=function(){var e=this.item();return e.isViolation||e.policyTip&&e.policyTip>=2?4:e.properties.CheckedOutUserId?2:1===e.policyTip?3:this.isVideo()?5:this.isShared()?1:0};j.prototype._computeHasImageStack=function(){return"ms-item-tile-folder"===this.templateName()};j.prototype._computeSubTextIconUrl=function(){return 2!==this._subTextIconType()?"":window.require.toUrl("odsp-media/images/overlays/checkoutoverlaygrid.svg")};j.prototype._computeDateText=function(){var e=this.item();if(this.isAlbum()){if(b.isFeatureEnabled(b.EnableEvokeAlignments)&&e.dateCreatedTime){var t={month:"long",day:"numeric",year:void 0};e.dateCreatedTime.getFullYear()!==(new Date).getFullYear()&&(t.year="numeric");return e.dateCreatedTime.toLocaleDateString(O.default.language,t)}return e.dateCreated}return""};j.prototype._computeIsDateVisible=function(){var e=this.dateText();return!(!e||!e.length)};j.prototype._computeIsNamePlateVisible=function(){var e=this.item();return!this.isMedia()||e.isViolation};j.prototype._computeSubTextIconClass=function(){switch(this._subTextIconType()){case 1:return"ItemTile-sharingIcon ItemTile-subTextIcon "+D.getIconClassName("People");case 2:return"ItemTile-subTextImageShort";case 4:return"ItemTile-blockIcon ItemTile-subTextIcon "+D.getIconClassName("DRM");case 3:return" ItemTile-subTextIcon "+D.getIconClassName("IncidentTriangle");case 5:return"ItemTile-playButton "+D.getIconClassName("Play");case 6:return"ItemTile-badPhotoIcon "+D.getIconClassName("IncidentTriangle");default:return""}};j.prototype._computeTemplateName=function(){var e=this._deferredLoadedTemplateName();return this._customTemplateName?this._customTemplateName:this._isUsingDeferredLoadedTemplate()?e:this.isFolder()?"ms-item-tile-folder":this.isPhoto()?"ms-item-tile-photo":this.isVideo()?"ms-item-tile-video":"ms-item-tile-file"};j.prototype._isUsingDeferredLoadedTemplate=function(){return this.isStory()||this.isDiscoverCard()||this.isTag()};j.prototype._computeDeferredLoadedTemplateName=function(){var t,n=this;this.isStory()?t="ms-item-tile-album":this.isDiscoverCard()?t="ms-item-tile-discover":this.isTag()&&(t="ms-item-tile-tag");t&&m.default.resolve(new Promise(function(t,n){e(["./ItemTileDeferred"],t,n)})).then(B.getDefaultExport).then(function(e){n._deferredLoadedTemplateName(t)})};j.prototype._computeIsSelectable=function(){var e=this.item();return this.isInteractable&&this.selectionModel.canSelectItem(this.item)&&!e.tagInfo};j.prototype._computeThumbnail=function(){var e=this.item();return(e.orientedThumbnail||e).thumbnail};j.prototype._computeRotation=function(){var e=this.item().orientedThumbnail;return e?e.rotation:s.default.none};j.prototype._computeIconSize=function(){return this.hasThumbnail()?32:96};j.prototype._computeDesiredIconSize=function(){var e=.77*(this.imageRect().height-48);return this.hasThumbnail()?32:Math.min(96,Math.ceil(e))};j.prototype._computeIsSubTextVisible=function(){var e=this.item(),t=this.parentItem?this.parentItem():null;return e.type!==i.default.Folder||t&&(t.queryType===p.default.SharedWithMe||t.queryType===p.default.Discover)};j.prototype._computeLinkUrl=function(){var e=this.item(),t=this.resources.consume(o.currentItemSet);return this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0,itemSet:t()})};j.prototype._computeSubText=function(){var e="",t=this.item(),n=this.resources.consume(o.currentItemSet);switch(n?n().sortField:"name"){case"size":e=h.default.getDisplayString(t.size,{ignoreZero:!0});break;case"dateTaken":e=t.dateTaken;break;case"dateModified":e=t.dateModified;break;default:e=t.defaultSubText||""}t.queryType===p.default.Discover&&(e=this._getTidBit(t));return e};j.prototype._getTidBit=function(e){if(e.viewersCount>5){this.showPerson(!1);return x.default.popular}if(e.editorName&&e.editorsCount&&e.editorsCount>1){this.showPerson(!0);return T.format(x.default.modifiedByPersonAndOthers,e.editorName,e.editorsCount-1)}if(e.viewersCount>2){this.showPerson(!1);return x.default.popular}if(e.editorName){this.showPerson(!0);return T.format(x.default.modifiedBy,e.editorName)}this.showPerson(!1);return x.default.relevant};j.prototype._computeChildCount=function(){var e=this,t=this.item(),n="",r=this.resources.consume(c.url).getQueryType(),s="number"==typeof t.childCount&&!isNaN(t.childCount);if(t.type===i.default.Folder&&(t.queryType!==p.default.SharedWithMe||!t.isRootFolder)&&(!this._urlDataSource.isRecycleBin(t.queryType)||s||t.folder&&t.folder.totalCount>0))if(s)n=String(t.childCount);else if(r===p.default.Files){var o=this.resources.consume(c.folderItemCount.optional);o&&o.getFolderItemCountInfo(t).then(function(n){if(n){t.childCount=n.itemCount;e._folderChildCount(String(t.childCount))}},function(e){})}this._folderChildCount(n);return this._folderChildCount()};j.prototype._computeHasThumbnailError=function(){var e=this._hasThumbnailError.peek();e||(e=!!this.thumbnailError());return e};j.prototype._computeTagCount=function(){var e=this.item();return e.tagInfo&&e.folder?String(e.folder.childCount):""};j.prototype._computeLongTagTooltip=function(){var e=this.item();return e.tagInfo&&e.name&&e.name.length>50?e.name:""};j.prototype._computeIsShared=function(){var e=this.item().sharingType;return l.showSubTextSharingIcon(e)};j.prototype._computeIsBundle=function(){return this.item().isBundle};j.prototype._computeIsDroppable=function(){return this.item().isDropEnabled&&this.isInteractable};j.prototype._computeIsInvokable=function(){return!this._isSelectionModal()&&this._action.isAvailable()};j.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&this.isInteractable&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{isSelected:this.isSelected,isFocused:this.createObservable(!1),focusState:this.focusState,onInvoke:function(e){return t.onInvoke(e)}}))};j.prototype._computeHasThumbnail=function(){var e=this.item().video;return!(b.isFeatureEnabled(b.ListThumbnailThrottling)||e&&b.isFeatureEnabled(b.ListThumbnailVideoThrottling))&&(!!this.thumbnail()&&(this.isThumbnailLoaded()||!this._hasThumbnailError()))};j.prototype._computeColorName=function(){return""};return j})(r.default);t.default=j});
define("odsp-next/controls/image/frame/ImageFrame",["require","exports","./ImageFrame.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageFrameViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-image-frame",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/image/frame/ImageFrame.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>'});
define("odsp-next/controls/image/frame/ImageFrameViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/images/ThumbnailCache","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/object/ObjectUtil","../ImageEqualityComparer","../stack/ImageStack"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAYOUT_THROTTLE_MS=300;var c=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageStackTagName=l.default.tagName;var s=t.image,c=t.rotation,h=void 0===c?i.default.none:c,p=t.alignment,d=t.desiredSize,v=t.isLoaded,m=t.isCurrent,g=t.error,y=t.coverage,b=void 0===y?{minimum:1,maximum:1}:y,w=t.scale,E=t.fadeIn,S=t.allowLoading,x=t.position,T=t.loadImageScenarioName,N=n.thumbnailCache,C=void 0===N?r.resources.consume(o.resourceKey):N,k=n.outputExtenders,L=void 0===k?{deferred:!0}:k;r._thumbnailCache=C;r._image=r.wrapObservable(s);r._rotation=r.wrapObservable(h);r._alignment=u.createAlignment(p);r._desiredSize=r.wrapObservable(d);r._isLoaded=v;r._coverage=r.wrapObservable(b);r._loadedImage=r.createObservable();r._effectiveDesiredSize=r.createPureComputed(r._computeEffectiveDesiredSize);r._effectiveDesiredSize.equalityComparer=a.deepCompare;r._idealSize=r.createPureComputed(r._computeIdealSize);r._idealSize.equalityComparer=a.deepCompare;r._idealImage=r.createPureComputed(r._computeIdealImage).extend(L);r._idealImage.equalityComparer=f.compareImages;r._fallbackImage=r.createPureComputed(r._computeFallbackImage).extend(L);r._fallbackImage.equalityComparer=f.compareImages;r._cachedImage=r.createPureComputed(r._computeCachedImage);r._cachedImage.equalityComparer=f.compareImages;r._currentImage=r.createPureComputed(r._computeCurrentImage);r._currentImage.equalityComparer=f.compareImages;r._isCurrent=r.createPureComputed(r._computeIsCurrent);r.imageStackParams={image:r._currentImage,rotation:r._rotation,desiredSize:r._desiredSize,loadedImage:r._loadedImage,isLoaded:r._isLoaded,error:g,scale:w,alignment:r._alignment,fadeIn:E,allowLoading:S,position:x,loadImageScenarioName:T};m&&r.createBackgroundComputed(function(){return m(r._isCurrent())}).extend(L);return r}t.prototype._computeIsCurrent=function(){return f.compareImages(this._loadedImage(),this._idealImage())};t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),r=this._fallbackImage();return e?f.compareImages(e,t)?this._currentImage.peek():t:n||r||t};t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;t&&(e={width:t.width*n,height:t.height*n});return e};t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,r=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&r){var s=this._alignment.getTransform(t,i);e={width:s.scale*t.width,height:s.scale*t.height}}}else e={width:n,height:r}}return e};t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t);return e};t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=(this._coverage()||{}).fallback,i=void 0===r?0:r;if(i){var s={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,s))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,s,!1)}}return e};t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},s=i.minimum,o=void 0===s?1:s,u=i.maximum,a=o*r,f=(void 0===u?1:u)*r;e=this._thumbnailCache.retrieve(t,f,a)}return e};t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:s.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}};return t})(r.default);t.default=c});
define("odsp-next/controls/image/ImageEqualityComparer",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.compareImages=function(e,t){return e===t||(!e&&!t||!(!e||!t)&&e.url===t.url)}});
define("odsp-next/controls/image/stack/ImageStack",["require","exports","./ImageStack.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageStackViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-image-stack",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/image/stack/ImageStack.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>'});
define("odsp-next/controls/image/stack/ImageStackViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/BaseModel","../ImageEqualityComparer","@ms/odsp-utilities/lib/object/ObjectUtil","../tile/ImageTile","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.hasAnimated,i=t.fadeIn,s=t.image,o=t.referenceImage,u=t.referenceRotation;n._fadeIn=i;n._image=s;n._referenceImage=o;n._referenceRotation=u;n.isLoaded=n.createObservable(!1);n._hasAnimated=n._getHasAnimated();n.rotation=n.createPureComputed(n._computeRotation);n.createBackgroundComputed(function(){return r(n._hasAnimated())});return n}t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;if(e.isLoaded.peek())(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50);else{e.isLoaded();n=!1}return n})};t.prototype._computeRotation=function(){var e=this.rotation.peek();(s.compareImages(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation());return e};return t})(i.default);t.AnimationTracker=a;var f=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageTileTagName=u.default.tagName;var i=t.image,f=t.rotation,l=t.desiredSize,c=t.scale,h=void 0===c?1:c,p=t.fadeIn,d=void 0===p||p,v=t.allowLoading,m=void 0===v||v,g=t.isLoaded,y=t.isCurrent,b=t.alignment,w=t.position,E=t.loadedImage,S=t.error,x=t.loadImageScenarioName,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T,C=n.AnimationTracker,k=void 0===C?a:C;r._animationTrackerType=k;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(f);r._desiredSize=l;r._scale=h;r.fadeIn=r.wrapObservable(d);r._allowLoading=r.wrapObservable(m);r._alignment=b;r._scenarioName=x;r._tileDefinitions=r.createPureComputed(r._computeTileDefinitions);r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=o.deepCompare;r._loadedImage=r.createPureComputed(r._computeLoadedImage);r._loadedImage.equalityComparer=s.compareImages;r._error=r.createPureComputed(r._computeError);r._error.equalityComparer=o.deepCompare;r.tiles=r._getTiles();w&&r.createBackgroundComputed(function(){return w(r._position())}).extend(N);E&&r.createBackgroundComputed(function(){return E(r._loadedImage())}).extend(N);g&&r.createBackgroundComputed(function(){return g(!!r._loadedImage())}).extend(N);y&&r.createBackgroundComputed(function(){return y(s.compareImages(r._loadedImage(),r._image()))}).extend(N);S&&r.createBackgroundComputed(function(){return S(r._error())}).extend(N);return r}t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.error;if(i())break;if(s()){e=s();break}}return e};t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.position;if(i()){e=s();break}}return e};t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.image;if(i()){e=this.unwrapObservable(s);break}}return e};t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),r=void 0===t?[]:t;if(e){if(this._allowLoading()){var i=void 0,o=void 0,u=void 0,a=r[r.length-1];if(a){i=s.compareImages(a.image,e);o=a.hasAnimated.peek();u=!!a.error.peek()}else{i=!1;o=!1}if(i)o?r=[a]:a.hasAnimated();else{if(!a||o||u){a={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)};r=n.__spreadArrays(r,[a])}a.hasAnimated();a.error()}}}else r=[];return r};t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),r=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,r=t.error,i=t.hasAnimated,s=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:s.rotation,isLoaded:s.isLoaded,error:r,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){s.dispose()}}}}));this.createBackgroundComputed(function(){t.splice.apply(t,n.__spreadArrays([0,t.peek().length],e._tileDefinitions()))});return r};return t})(r.default);t.default=f});
define("odsp-next/controls/newBadge/NewBadge",["require","exports","./NewBadge.html","./NewBadgeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-new-badge",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/newBadge/NewBadge.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-newBadge"><span class="od-newBadge-icon ms-Icon ms-Icon--Glimmer" data-bind="icon:true"></span><span class="od-newBadge-text" data-bind="text:newItemText"></span></div>'});
define("odsp-next/controls/newBadge/NewBadgeViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../controls/commands/Commands.resx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.newItemText=i.default.Create.toUpperCase();return n}return t})(r.default);t.default=s});
define("odsp-next/controls/fileHoverCard/react/FileHoverCardHelper",["require","exports","../../../utilities/features/Features","../../../models/item/ItemType","../../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/ABExperiment","../../../utilities/killSwitch/KillSwitch","@ms/odsp-utilities/lib/logging/events/Experiment.event","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f;t.shouldEnableFileHoverCard=function(e,t){var s=n.isFeatureEnabled(n.HoverCardInSharedByMe);return e.type!==r.default.Folder&&(e.queryType===i.default.Files||e.queryType===i.default.DocumentLibraries||s&&e.queryType===i.default.SharedByMe)};function l(){f||(f=new s.ABExperiment({name:"FileHoverCardAssign",startDate:"1/26/2018"}));return f}t.getABExperiment=l;t.shouldShowCard=function(){return l().IsExperimentOn()||o.default.isActivated("10694632-7335-422F-B6FE-A8357D7C475D","02/01/2018","Disable ABExperiemtn in SPDF and MSIT")};t.logExperiment=function(){var e=l();o.default.isActivated("10694632-7335-422F-B6FE-A8357D7C475D","02/01/2018","Disable ABExperiemtn in SPDF and MSIT")||u.default.logData({name:"",isInRamp:e.IsExperimentOn(),experiment:"FileHoverAB",variant:e.IsExperimentOn().toString()})};t.getGraphAccessToken=function(e,t){return e.getAccessToken(t,{apiVersion:a.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E")?"v2.0":"v2.1"})};t.getGraphItemUrl=function(e,t){return e&&e.getItemUrl(t,{useDirectEndpoint:!0,apiVersion:a.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1"})};t.getGraphDriveUrl=function(e,t){return e&&e.getDriveUrl(t,{useDirectEndpoint:!0,apiVersion:"v2.1"})}});
define("odsp-next/controls/folderCoverTile/FolderCoverTile",["require","exports","./FolderCoverTile.html","./FolderCoverTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-folder-cover-tile",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/folderCoverTile/FolderCoverTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FolderCoverTile" data-bind="foreach:pulseRecords"><div data-bind="attr:{class:className}">\x3c!--ko if:isThumbnailVisible--\x3e<div class="od-FolderCoverTile-image" data-bind="component:{name:$component.thumbnailTagName,params:$component.getThumbnailParams($data)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isWatermarkVisible--\x3e<img class="od-FolderCoverTile-watermark" data-bind="attr:{src:watermarkUrl}">\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/folderCoverTile/FolderCoverTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/frame/ImageFrame","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.thumbnailTagName=i.default.tagName;var r=n.observables,s=n.resources;u||(u=s.consume(o.platformDetection).isRetinaSupported?"64_2x":"64");n.imageRect=t.imageRect;n._item=t.item;n._lastThumbnails=-1;n._thumbnailIndex=-1;n._isPulsingEnabled=!0;n.pulseRecords=r.createArray();r.compute(n._computeRecords);var a=t.pulseTarget;a&&a(n);return n}t.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&e.folder.covers.length>1)};t.prototype.enablePulsing=function(e){this._isPulsingEnabled=e};t.prototype.pulse=function(){if(this.canPulse()&&this._isPulsingEnabled){this._pushNextRecord();this.pulseRecords.shift();this._updatePulseClasses()}};t.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:s.AlignmentType.cover}};t.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",n=e.folder&&e.folder.covers?e.folder.covers.length:-1;if(t!==this._lastKey||n!==this._lastThumbnails){this._lastKey=t;this._lastThumbnails=n;this.pulseRecords.removeAll();this._thumbnailIndex=-1;0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord();this._updatePulseClasses()}}};t.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})};t.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()};t.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})};t.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var n=e[t],r=e.length-t-1;n.isEmpty||n.className("od-FolderCoverTile-item"+r);n.isThumbnailVisible(!(!n.thumbnail()||!(n.isThumbnailVisible()||r<2)));var i=this.unwrapObservable(this._item),s=!i.tagInfo&&!n.isThumbnailVisible()&&(1===r||i.isAlbum||i.isDocSet);n.isWatermarkVisible(s);n.watermarkUrl(s?this._getFolderWatermarkUrl():null)}};t.prototype._getFolderWatermarkUrl=function(){var e=this._item(),t="genericfolder";e.isAlbum&&(t="photofolder");switch(e.isSpecialFolder&&e.specialFolderCanonicalName){case"Music":t="musicfolder";break;case"Documents":t="documentfolder";break;case"Photos":t="photofolder"}e.isDocSet&&(t="Docset");return window.require.toUrl("odsp-media/images/watermarks/"+u+"/"+t.toLowerCase()+".png")};t.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,n=t&&t.length;if(n){return t[this._thumbnailIndex=(this._thumbnailIndex+1)%n]}};return t})(r.default);t.default=a});
define("odsp-next/controls/sharing/sharerHeader/SharerHeader",["require","exports","./SharerHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharerHeaderViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-sharer-header",template:n.default,viewModel:i.default});t.default=s});
define("odsp-next/controls/sharing/sharerHeader/SharerHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<a class="SharerHeader" data-bind="attr:{href:sharerUrl}"><div class="SharerHeader-userTile ms-Icon ms-Icon--Contact" data-bind="icon:true,css:{\'SharerHeader-hasProfileImage\':!!profileImageUrl}"><img data-bind="attr:{src:profileImageUrl}" width="40" height="40"></div><div class="SharerHeader-title" data-bind="text:name"></div><div class="SharerHeader-subText" data-bind="text:subText"></div>\x3c!--ko if:isShowAllVisible--\x3e<div class="SharerHeader-showAll" role="link" data-bind="text:showAllText"></div>\x3c!--/ko--\x3e</a>'});
define("odsp-next/controls/sharing/sharerHeader/SharerHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SharerHeader.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.group,u=r.data,a=t.callerLongCid;n.name=r.name||"";n.showAllText=i.default.showAll;if(u){var f=u.itemsSharedCount;n.subText=1===f?i.default.singleShared:s.format(i.default.multiShared,f);n.profileImageUrl=u.sharerProfileImageUrl;var l=n.resources.consume(o.url);n.sharerUrl=l.getSharedByUrl(u.sharerLongCid||a,u.sharerCid,u.sharerGroupId);n.isShowAllVisible=t.cellsInGroup<f}return n}return t})(r.default);t.default=u});
define("odsp-next/controls/headerTile/HeaderTile",["require","exports","./HeaderTile.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./HeaderTileViewModel","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-header-tile",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/headerTile/HeaderTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-HeaderTile" tabindex="0" data-bind="attr:{\'aria-label\':ariaLabel}"><div class="od-HeaderTile-title" data-bind="text:title"></div></div>'});
define("odsp-next/controls/headerTile/HeaderTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../list/react/detailsList/ReactDetailsList.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.group,i=r.name,s=r.count;n.title=i;n.ariaLabel=n._getAriaLabel(i,s);return n}t.prototype._getAriaLabel=function(e,t){var n=i.pluralSelect(t,i.format(s.default.itemsCountSingular,t),i.format(s.default.itemCountMulti,t));return i.format(s.default.groupHeaderAriaLabel,e,n,s.default.expandedText)};return t})(r.default);t.default=o});
define("odsp-next/controls/list/SingleAlbumList",["require","exports","./List.html","knockout","./viewModels/SingleAlbumListViewModel","./layouts/LayoutType","ODCFiles_css","../itemTile/ItemTile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={tagName:s.SingleAlbum,template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(o.tagName)||r.components.register(o.tagName,o);t.default=o});
define("odsp-next/controls/list/viewModels/SingleAlbumListViewModel",["require","exports","tslib","./ListViewModel","../layouts/SingleAlbumLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(i.default))(t));return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/SingleAlbumLayout",["require","exports","tslib","./BaseGridLayout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={Small:130,Medium:130,Large:210,XLarge:300,XXLarge:300,XXXLarge:300,XXXXLarge:300},s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getInnerMargin=function(){return 12};t.prototype.getHeader=function(e,t,n){var r=null,i=t&&t.peek&&t.peek(),s=this.getGroup(n,i);if(s&&this.currentGroup!==s){this.nextGroup=s;var o=this.getHeaderDetails(s,n);0!==n||o.viewType||(o.headerHeight=0);var u=o.key?o.key:i?i.key+"_header":null;u&&(r={key:u,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:o.headerHeight,viewType:o.viewType,viewData:o.viewData})}return r};t.prototype.getGroup=function(e,t){var n,r=this._itemSet().content.peek().groupings||[];if(r&&r.length&&r[0].itemGroups)for(var i=0,s=r[0].itemGroups;i<s.length;i++){var o=s[i];if(o){var u=o.startIndex+o.count-1;if(o.startIndex<=e&&u>=e){n=o;break}}}return n};t.prototype.getMinRowHeight=function(){var e=this.responsiveHelper.formFactorSize();return this.currentGroup&&"folder"===this.currentGroup.groupingId?r.MinRowHeights.folder[e]:this.currentGroup&&"document"===this.currentGroup.groupingId?r.MinRowHeights.documents[e]:i[e]};t.prototype.getHeaderDetails=function(e,t){return{viewType:"",viewData:{},headerHeight:20}};return t})(r.default);t.default=s});
define("odsp-next/controls/itemContent/folder/FolderItemContent",["require","exports","./FolderItemContent.html","./FolderItemContentViewModel","../../../bindings/component/ControlBinding","ODCFiles_css","../../list/CompactDetailsList","../../list/DetailsList","../../list/GridList"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-folder-item-content",template:n.default,viewModelType:r.default})});
define("odsp-next/controls/itemContent/folder/FolderItemContent.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<h1 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text:title"></h1>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShowSharedIndicator--\x3e<div class="od-ItemContent-header-sharedIndicator" data-bind="component:{name:sharedIndicatorTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isQuotaBarVisible--\x3e\x3c!--ko if:isFluentEnabled--\x3e<div class="StorageInfo-sectionHeading" data-bind="text:storageSummaryString"></div>\x3c!--/ko--\x3e<div class="od-ItemContent-progress-container"><div class="StorageInfo-totalUsed" data-bind="text:totalUsedString,style:{display:isFluentEnabled?\'block\':\'none\'}"></div><div class="od-ItemContent-progress" data-bind="component:{name:\'od-quota-progress-bar\'}"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:{itemSet:itemSet,selectionModel:itemSetSelectionModel,requiredRange:contentRange,enableMarqueeSelection:true,contextMenuHelper:listViewContextMenuHelper,footerItem:footerItem}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e</div>\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/itemContent/folder/FolderItemContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../emptyFolder/EmptyFolder","../../../bindings/component/ControlBinding","../../breadcrumbBar/BreadcrumbBar","../../folderSharedIndicator/FolderSharedIndicator","../../../models/itemSet/ItemSetMonitor","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","../../../models/item/SharingType","../../../actions/toggleListLayout/ToggleListLayoutHelper","../../../utilities/features/Features","../../detailsPaneTransclusionContent/DetailsPaneTransclusionContent","../../fluentStyling/FluentStyling.key","./FolderItemContent.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:u.default});r._urlDataSource=r.resources.consume(h.url);r.breadcrumbBarTagName=a.default.tagName;r.emptyFolderControl=u.toSpecification(o.resourceKey,{isViewOnly:r.createPureComputed(r._computeIsViewOnly,{deferEvaluation:!0})});r.isQuotaBarVisible=r.createObservable(!1);var d=r.resources.consume(i.actionMap);r._uploadAction=new(r.managed(d.UploadAction))({uploadProcessorType:c.UploadProcessorType.Html5file});r.sharedIndicatorTagName=f.default.tagName;r.isShowSharedIndicator=r.createPureComputed(r._computeIsShowSharedIndicator);r._itemSetMonitor=r.resources.consume(l.resourceKey);r.footerItem=t.footerItem;r.itemSet=r._itemSetMonitor.itemSet;r.itemSetSelectionModel=r.resources.consume(i.itemsSelection);r.contentRange=r.resources.consume(s.contentRange);r.layoutType=r.resources.consume(v.resolvedLayoutTypeResourceKey);r.isFluentEnabled=r.resources.consume(y.resourceKey);r.listViewContextMenuHelper=r.resources.isExposed(s.listViewContextMenuHelper)?r.resources.consume(s.listViewContextMenuHelper):void 0;r.title=r._itemSetMonitor.name;r.showBreadcrumb=r._itemSetMonitor.hasParent;r.showEmpty=r._itemSetMonitor.isEmpty;r.showList=r.observables.pureCompute(r._computeShowList);r.item=r._itemSetMonitor.item;r.storageSummaryString=b.default.storageSummaryString;r.totalUsedString=b.default.totalUsedString;r.showTitle=r.createPureComputed(r._computeShowTitle,{deferEvaluation:!0});var m=r.resources.consume(p.bundleLoader);r.createComputed(function(){var e=m&&m.getBundleInfo(2);e&&e.isLoaded()&&(r.itemSet()&&r._urlDataSource.isSearchPassThrough()?r.isQuotaBarVisible(!0):r.isQuotaBarVisible(!1))});r.detailsPaneSpecification=u.toSpecification(g.resourceKey,{});return r}t.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()};t.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()};t.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()};t.prototype._computeIsShowSharedIndicator=function(){if(m.isFeatureEnabled(m.EnableFolderShareAccessHint)){var e=this.item().sharingType;return e===d.default.Shared||e===d.default.Public||e===d.default.PublicUnlisted}return!1};return t})(r.default);t.default=w});
define("odsp-next/controls/emptyFolder/EmptyFolder",["require","exports","./EmptyFolder.html","./EmptyFolderViewModel","../../bindings/component/ControlBinding","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-empty-folder",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/emptyFolder/EmptyFolder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="EmptyFolder" data-bind="class:additionalContentCss">\x3c!--ko if:url--\x3e<div class="EmptyFolder-image"><img id="emptyFolderImg" class="EmptyFolder-imageTag" data-bind="attr:{src:url,alt:altText}"></div>\x3c!--/ko--\x3e<div role="alert"><div class="EmptyFolder-title" data-bind="text:title"></div>\x3c!--ko if:subText||subTextMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subText"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subTextMobile"></span></div>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/emptyFolder/EmptyFolderViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../models/item/ItemParentHelper","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../bindings/html/BindableHtmlBinding","./EmptyFolder.resx","../../dataSources/url/PageType","../../dataSources/url/QueryType","../../dataSources/rootItems/RootItems.key","../../utilities/browser/WebViewDetector","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y='<i class="EmptyFolder-icon '+r.getIconClassName("Add")+'" ></i>',b=g.default.isActivated("5E34EBC4-606B-498C-8C53-40910E216F64","5/28/2020","Lazy-initialize OneDrive root items"),w=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({bindableHtml:l.default});var i=r.observables,s=r.resources;r.isDocLib=!0;r._rootItems=i.create();r._urlDataSource=n.urlDataSource;r._content=i.pureCompute(r._computeContent);r._currentPage=r._urlDataSource.getPageType();r._isViewOnly=t.isViewOnly;r._item=n.item;r._itemParentHelper=n.itemParentHelper;b&&s.consumeAsync(d.resourceKey.optional).then(function(e){r._rootItems(e)});r._storageOptionsProvider=n.storageOptionsProvider;r._userInfoProvider=n.userInfoProvider;r._viewParams=n.viewParams;r._isOneDriveXboxApp=v.isOneDriveXboxApp();r._recentDocsNavigationAction=new(r.managed(n.actionMap.NavigationAction))({target:"blank",url:i.pureCompute(function(){if(!b)return r._urlDataSource.getRecentQueryUrl();var e=i.unwrap(i.unwrap(r._rootItems)),t=i.unwrap(e&&e.recent);return t&&r._urlDataSource.getDefaultClickUrl(t)||""})});r.altText=i.pureCompute(function(){return r._content().altText||""});r.subText=i.pureCompute(function(){return r._content().subText});r.subTextMobile=i.pureCompute(function(){return r._content().subTextMobile||r._content().subText});r.subTextPostIcon=i.pureCompute(function(){return r._content().subTextPostIcon});r.title=i.pureCompute(function(){return r._content().title});r.url=i.pureCompute(function(){return r._content().url});r.additionalContentCss=i.pureCompute(function(){return r._computeContentCss()});return r}t.prototype.navigateToRecentDocs=function(){this._recentDocsNavigationAction.execute(null);return!1};t.prototype.hasInsertPermission=function(){return!this.observables.unwrap(this._isViewOnly)};t.prototype.emptyFolderSubText=function(){return this._isOneDriveXboxApp?"":c.default.emptyFolderSubText};t.prototype.hasSmartFiltersApplied=function(){return!1};t.prototype._computeContent=function(){var e,t=this._item(),n=t.queryType,r=this.hasInsertPermission();switch(n){case p.default.Recent:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recent.svg"),title:c.default.emptyRecentTitle,subText:c.default.emptyRecentSubText};break;case p.default.RecycleBin:case p.default.SecondStageRecycleBin:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recyclebin.svg"),title:c.default.emptyRecycleBinTitle,subText:c.default.emptyRecycleBinSubText};break;case p.default.Search:case p.default.SearchOdbScope:var s=void 0;s=this._currentPage===h.default.Photos?c.default.emptyPhotosSearchSubText:this.isDocLib?i.format(c.default.emptySearchSubText,'<a class="EmptyFolder-subTextPart2 EmptyFolder-subTextPart2Link" href="#" data-bind="click: navigateToRecentDocs">',"</a>"):c.default.emptyListSearchSubText;e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search.svg"),title:c.default.emptySearchTitle,subText:s};break;case p.default.SharedWithMe:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared.svg"),title:c.default.emptySharedTitle,subText:c.default.emptySharedSubText};break;case p.default.DocsInCommon:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared.svg"),title:c.default.emptyDocsInCommonTitle,subText:c.default.emptyDocsInCommonSubText};break;case p.default.Subsites:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_sites.svg"),title:c.default.emptySubsitesTitle,subText:""};break;case p.default.Discover:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_discover.svg"),title:c.default.emptyDiscoverTitle,subText:""};break;case p.default.Apps:e=this._getSearchContentOrDefault(c.default.emptyAppsTitle);break;case p.default.Popular:e=this._getSearchContentOrDefault(c.default.emptyPopularTitle);break;case p.default.ExternallyShared:e=this._getSearchContentOrDefault(c.default.emptyExternallySharedTitle);break;case p.default.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:var o=!1;this._itemParentHelper.getAncestorOrSelf(t,function(e){return"Music"===e.specialFolderCanonicalName})&&(o=!0);if(o){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_music.svg"),title:c.default.emptyMusicFolderTitle,subText:r&&c.default.emptyMusicFolderSubText||"",subTextMobile:r&&i.format(c.default.emptyMusicFolderMobileSubText,y)||""};if(this._userInfoProvider){var u=this._userInfoProvider.getMarket();u=u&&u.toLowerCase()}break}if(this.hasSmartFiltersApplied()){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_filter.svg"),title:c.default.emptyFilterResultTitle,subText:c.default.emptyFilterResultSubText,altText:c.default.emptyFilterResultAltText};break}if(t.vault&&t.vault.root){var a=this._computeIsPremium()?c.default.vaultEmptyFolderPremiumSubtext:m.isFeatureEnabled(m.UseM365)?c.default.M365VaultEmptyFolderNonPremiumSubtext:c.default.vaultEmptyFolderNonPremiumSubtext;e={title:c.default.vaultEmptyFolderTitle,subText:a,url:""};break}e=this._item().isRootFolder&&!this.isDocLib?{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_list.svg"),title:c.default.emptyListTitle,subText:c.default.emptyListSubText,altText:c.default.emptyListDefaultAltText}:{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_folder.svg"),title:this._item().isRootFolder?c.default.emptyLibraryTitle:c.default.emptyFolderTitle,subText:r&&this.emptyFolderSubText()||"",subTextMobile:r&&i.format(c.default.emptyFolderMobileSubText,y)}}e.altText||(e.altText=c.default.emptyFolderDefaultAltText);return e};t.prototype._getSearchContentOrDefault=function(e){return this._viewParams().q?{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search.svg"),title:c.default.emptySearchTitle,subText:""}:{title:e,url:"",subText:""}};t.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case 5:case 1:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_album_albumsview.svg"),title:c.default.emptyAlbumsListTitle,subText:c.default.emptyAlbumsListSubText};break;case 2:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"),title:c.default.emptyPhotosTagsTitle,subText:i.format(c.default.emptyPhotosTagsSubTextFormat,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case 3:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_places.svg"),title:c.default.emptyAllPhotosTitle,subText:""};break;case 9:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_onthisday.svg"),title:c.default.emptyOnThisDayTitle,subText:""};break;default:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_allphotosview.svg"),title:c.default.emptyAllPhotosTitle,subText:""}}return e};t.prototype._computeIsPremium=function(){return!(!this._storageOptionsProvider||!this._storageOptionsProvider.isReady())&&this._storageOptionsProvider.hasOffice.peek()};t.prototype._computeContentCss=function(){var e=this._item();return e.vault&&e.vault.root?"EmptyFolder-content-vault":""};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{actionMap:u.actionMap,item:u.currentItem,itemParentHelper:o.resourceKey,urlDataSource:a.url,userInfoProvider:f.userInfo.optional,viewParams:u.viewParams,storageOptionsProvider:f.storageOptions.optional});return t})(s.default);t.default=w});
define("odsp-next/controls/breadcrumbBar/BreadcrumbBar",["require","exports","./BreadcrumbBar.html","./BreadcrumbBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-breadcrumb-bar",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/breadcrumbBar/BreadcrumbBar.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<nav class="BreadcrumbBar" data-bind="attr:{\'aria-label\':ariaLabelForBreadCrumbBar}"><ul class="BreadcrumbBar-list" data-bind="foreach:crumbs,dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}"><li>\x3c!--ko if:isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href="javascript:;" aria-haspopup="true" data-bind="click:$component.onClick.bind($component),dismiss:$component.overflowDismissParams,attr:{\'aria-expanded\':$component.isOverflowOpen(),\'aria-label\':$component.overflowMenuAriaLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},class:$component.iconClass,event:{mouseover:$component.onOverflowMouseover.bind($parent)}">\x3c!--ko if:$parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if:isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" data-bind="text:name,click:$component.onClick.bind($component),keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},attr:{href:url,title:name},css:{dropping:isDroppingTarget}"></a>\x3c!--/ko--\x3e\x3c!--ko if:isStaticItem--\x3e<span class="BreadcrumbBar-item" data-bind="text:name,attr:{title:name}"></span>\x3c!--/ko--\x3e\x3c!--ko if:showNextChevron--\x3e<i class="BreadcrumbBar-item-chevron" role="presentation"></i>\x3c!--/ko--\x3e</li></ul></nav>'});
define("odsp-next/controls/breadcrumbBar/BreadcrumbBarViewModel",["require","exports","tslib","knockout","../commands/CommandViewModel","../../bindings/dismiss/DismissBinding","../../bindings/dragAndDrop/DragAndDropBinding","../dragAndDrop/DropHelper","@ms/odsp-utilities/lib/math/Point","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../actions/NavigationAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/icons/Icon","../../bindings/keyboard/KeyboardBinding","../../resources/ControlResourceKeys","../leftPane/LeftPane.resx","./BreadcrumbBar.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._currentDroppingCrumb=null;n.addBindingHandlers({dismiss:s.default,dragAndDrop:o.default,keyboard:d.default});var i=t.iconClass,l=void 0===i?new p.default("More").getClass():i,c=t.canShowTooltipOverflow,m=void 0!==c&&c;n._responsiveUI=n.resources.consume(f.resourceKey);n._navigation=n.resources.consume(h.navigation);n.overflowMenuAriaLabel=g.default.overflowAriaLabel;n.iconClass=l;n._item=t.item;n._maxFoldersVisibleLgUp=t.maxFoldersVisibleLgUp;n._maxFoldersVisibleMdDown=t.maxFoldersVisibleMdDown;n.isDroppable=r.observable(!0);n.isDroppingTarget=r.observable(!1);n.isOverflowOpen=r.observable(!1);n.overflowMenuOffset=r.observable(new a.default(-24,24));n.ariaLabelForBreadCrumbBar=r.observable("");n._openActionItem=r.observable(null);n.overflowCrumbs=r.observableArray();n.mouseOverTrigger=n.createObservable(!1);n._canShowTooltipOverflow=m;n._crumbs=t.crumbs;n._actionMap=n.resources.consume(v.actionMap);n._openAction=new(n.managed(n._actionMap.OpenAction))({item:n._openActionItem,openRelation:2});n.overflowDismissParams={isOpen:n.isOverflowOpen,isAutomatic:n._canShowTooltipOverflow,timeout:100};n._dropHelper=n.resources.consume(u.resourceKey);n.crumbs=n.createComputed(function(){return n._computeCrumbs(t.getCrumbs)});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.crumbs.dispose()};t.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)};t.prototype.onMayReceiveDrop=function(e,t){var n=t?r.dataFor(t):null;if(n&&n.item&&n.showNextChevron){this.onRemoveDropLocation();this._currentDroppingCrumb=n;this._currentDroppingCrumb.isDroppingTarget(!0);return{targetName:n.item.name}}this.onRemoveDropLocation();return null};t.prototype.onReceiveDrop=function(e,t){var n=t?r.dataFor(t):null,i=this._dropHelper.processDrop(e,n.item);i&&this.onRemoveDropLocation();return i};t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)};t.prototype.onEnter=function(e,t){t.stopPropagation()};t.prototype.onClick=function(e,t){if(e.onClick)e.onClick(e,t);else if(e.isOverflow)this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen());else if(e.item&&!e.isFiltered){this._openActionItem(e.item);this._openAction.execute(t)}else{this._navigation.navigateTo(e.url)}e&&this.ariaLabelForBreadCrumbBar(y.format(g.default.breadCrumbNavigation,e.ariaLabel?e.ariaLabel:e.name))};t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,n=[],r=[],i=this._responsiveUI;t=i.compareSize(i.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var s=this._item(),o=[];this._crumbs?o=this._crumbs():s&&s.key&&(e?o=e(s):s.parent&&(o=this._getCrumbsForNonRoots(s)));for(var u=0;u<o.length;u++)n.length<t?n.unshift(o[u]):r.unshift(this._commandForCrumb(o[u]));r.length&&n.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""});this.overflowCrumbs().forEach(function(e){e.dispose()});this.overflowCrumbs(r);n&&n.length>0?n[n.length-1].ariaLabel?this.ariaLabelForBreadCrumbBar(y.format(g.default.breadCrumbNavigation,n[n.length-1].ariaLabel)):this.ariaLabelForBreadCrumbBar(y.format(g.default.breadCrumbNavigation,s&&s.key?s.name:n[n.length-1].name)):s&&s.key&&this.ariaLabelForBreadCrumbBar(y.format(g.default.breadCrumbNavigation,s.name));return n};t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],n=!1,i=this._getAriaLabelsForBreadCrumbs(e);e;){var s=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),o=s.isAvailable.peek();s.dispose();var u=n,a=!n;if(!o){u=!1;a=!0}if(e.isStub){u=!1;a=!0}var f={key:e.key,url:"#"+e.key,name:e.name||m.default.Files,showNextChevron:n,isDroppingTarget:r.observable(!1),item:e,isOverflow:!1,isNavItem:u,isStaticItem:a,ariaLabel:i.pop()};t.push(f);n=!0;e=e.parent}return t};t.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],n=void 0;e;){if(n){n=y.format(g.default.breadCrumbItem,n,e.name||m.default.Files);t.push(n)}else{n=e.name||m.default.Files;e.parent&&t.push(e.parent.name)}e=e.parent}return t};t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(i.default))({text:e.name,action:new(this.managed(c.default))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})};return t})(l.default);t.default=b});
define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicator",["require","exports","./FolderSharedIndicator.html","./FolderSharedIndicatorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCFiles_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"folder-shared-indicator",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicator.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<button class="od-ItemContent-metadata od-ItemContent-metadata-button" data-bind="attr:{\'aria-label\':sharedAriaLabel},tooltip:{content:sharedTooltip},click:onSharedIconClick"><i class="ms-Icon ms-Icon--People" data-bind="icon:true,attr:{alt:sharedWithSomeIcon}"></i></button>'});
define("odsp-next/controls/folderSharedIndicator/FolderSharedIndicatorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","./FolderSharedIndicator.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/tooltip/TooltipBinding","../../bindings/keyboard/KeyboardBinding"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({tooltip:a.default,keyboard:f.default});n.item=t.item;n._actionMap=n.resources.consume(i.actionMap);n._showPermissionsAction=new(n.managed(n._actionMap.ShowPermissionsAction))({item:n.item,engagementSource:"GlyphClick"});n.sharedTooltip=o.default.folderIsShared;n.sharedWithSomeIcon=o.default.sharedWithSomeIcon;n.sharedAriaLabel=n._getSharedGlyphAriaLabel();return n}t.prototype.onSharedIconClick=function(e,t){s.Engagement.logData({name:"folderSharedIndicatorClicked"});this._showPermissionsAction.execute(t).done()};t.prototype._getSharedGlyphAriaLabel=function(){return u.format(o.default.ariabelForSharedGlyph,this.item().name)};return t})(r.default);t.default=l});
define("odsp-next/controls/detailsPaneTransclusionContent/DetailsPaneTransclusionContent",["require","exports","./DetailsPaneTransclusionContent.html","./DetailsPaneTransclusionContentViewModel","../../bindings/component/ControlBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,template:n.default,automationName:"ms-details-pane-transclusion-component",viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/detailsPaneTransclusionContent/DetailsPaneTransclusionContent.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko if:isInfoPaneExpanded()--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:infoPaneTransclusionContentParams}--\x3e<div data-bind=\"control:infoPaneControlParams,attr:{'aria-label':infoPaneRegionLabel,role:infoPaneRole}\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/detailsPaneTransclusionContent/DetailsPaneTransclusionContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/component/ControlBinding","../../resources/PagesResourceKeys","../../utilities/features/Features","../detailsPane/IsDetailsPaneExpanded","../detailsPaneHost/legacy/LegacyDetailsPaneHost.key","../infoPane/InfoPane.key","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-shared/lib/base/BaseModel","../../providers/transclusion/RightPaneTransclusionProvider.key","../../controls/transclusion/content/TransclusionContent"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.infoPaneRegionLabel="";r.transclusionContentTagName=p.default.tagName;r.addBindingHandlers({control:i.default});r.isInfoPaneExpanded=n.isInfoPaneExpanded;r.infoPaneTransclusionContentParams={provider:n.infoPaneTransclusionProvider};var s=n.strings;s&&(r.infoPaneRegionLabel=s.infoPaneRegionLabel);r.infoPaneRole=r.observables.create("complementary");r.infoPaneControlParams={specification:i.toSpecification(o.isFeatureEnabled(o.EnableNewDetailsPane)?a.resourceKey:f.resourceKey,{}),placeholder:i.toSpecification(l.resourceKey,{})};return r}t.dependencies=n.__assign(n.__assign({},c.default.dependencies),{infoPaneTransclusionProvider:h.resourceKey,isInfoPaneExpanded:u.resourceKey,strings:s.files.resx.optional});return t})(r.default);t.DetailsPaneTransclusionContentViewModel=d;t.default=d});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./LegacyDetailsPaneHost"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/infoPane/InfoPane.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InfoPane"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define('ODCFiles_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"},{"rawString":".od-DragAndDropTargetFrame{position:absolute;box-sizing:border-box;top:0;left:0;right:0;bottom:0;border:3px solid "},{"theme":"themeAccent","defaultValue":"#3a96dd"},{"rawString":";border-top:none;pointer-events:none;transition:visibility 0s linear 167ms,opacity 167ms ease-out}.od-DragAndDropTargetFrame-hasError.od-DragAndDropTargetFrame{border:3px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-DragAndDropTargetFrame-header{height:50px;background-color:"},{"theme":"themeAccent","defaultValue":"#3a96dd"},{"rawString":";transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}.od-DragAndDropTargetFrame-hasError .od-DragAndDropTargetFrame-header{background-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-DragAndDropTargetFrame-message{text-align:center;line-height:45px;font-size:21px;font-weight:100;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-OverlayHost-overlay .od-DragAndDropTargetFrame{opacity:0;visibility:hidden}.od-OverlayHost-overlay .od-DragAndDropTargetFrame-header{transform:translate(0,-20px)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame{opacity:.9;visibility:inherit;transition-delay:0s,0s}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame-header{transform:none;transition-timing-function:ease-out}"},{"rawString":".od-ListFooter{text-align:center;margin-top:33px;margin-bottom:24px}.od-ListFooter-dragAndDropHint{margin-bottom:18px}.od-ListFooter-recycleBin{font-size:14px;font-weight:400}.od-ListFooter-recycleBinText{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ListFooter-recycleBinLink{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;opacity:0;visibility:hidden;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{transform:scale(.8,.8);opacity:0;visibility:hidden}"},{"rawString":".od-SignInDialog-modal{top:0;bottom:0;right:0;left:0;position:absolute;display:flex}.sm .od-SignInDialog-modal{display:none}.od-SignInDialog-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8)}.od-SignInDialogMSAVar{width:410px;height:315px;position:relative;align-self:center;margin:auto;outline:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SignInDialogMSAVar-header{height:65px;padding-top:22px;box-sizing:border-box}html[dir=ltr] .od-SignInDialogMSAVar-header{padding-left:32px}html[dir=rtl] .od-SignInDialogMSAVar-header{padding-right:32px}.od-SignInDialogMSAVar-header img{height:41px;display:inline-block;margin:0}.od-SignInDialogMSAVar-content{padding:5px 36px;height:135px;background-repeat:no-repeat;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SignInDialogMSAVar-upsell{font-size:21px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-SignInDialogMSAVar-useMSA{font-size:15px;margin:16px 0}.od-SignInDialogMSAVar-useMSA a{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-SignInDialogMSAVar-useMSA a:hover{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SignInDialogMSAVar-next{margin:auto;background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";height:34px;width:342px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-weight:300;font-size:15px;border:2px;border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SignInDialogMSAVar-next:focus{border-color:"},{"theme":"themeLighterAlt","defaultValue":"#eff6fc"},{"rawString":"}.od-SignInDialogMSAVar-next:hover{background-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.od-SignInDialogMSAVar-input{height:34px;width:342px;margin-bottom:12px;font-size:15px;padding:0 4px;box-sizing:border-box}.od-SignInDialogMSAVar-createMSA{font-size:13px;margin:16px 0}.od-SignInDialogMSAVar-createMSA a{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-SignInDialogMSAVar-createMSA a:hover{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SignInDialogMSAVar-line{width:410px;height:1px;background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";position:absolute;left:0;right:0}.od-SignInDialogMSAVar-dismiss{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:12px;font-weight:400;width:410px;height:35px;cursor:pointer;border:none;position:absolute;left:0;right:0;bottom:0}.od-SignInDialog-close{position:absolute;top:0;background:0 0;border:0;padding:16px;cursor:pointer}html[dir=ltr] .od-SignInDialog-close{right:0}html[dir=rtl] .od-SignInDialog-close{left:0}.od-SignInDialog-close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}"},{"rawString":".od-unauthenticatedBanner{position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-unauthenticatedBanner-OneDrive{position:absolute;top:0;bottom:0;border:none;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";line-height:48px;display:inline-block;font-weight:300;font-size:14px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:22px;-webkit-font-smoothing:antialiased;cursor:pointer}html[dir=ltr] .od-unauthenticatedBanner-OneDrive{left:10px}html[dir=rtl] .od-unauthenticatedBanner-OneDrive{right:10px}.od-unauthenticatedBanner-AccountBox{position:absolute;top:0;bottom:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{right:0}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{left:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{padding-right:8px}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{padding-left:8px}.od-unauthenticatedBanner-button{display:inline-block;padding:6px;font-weight:600;font-size:14px;border:none;margin:8px;padding-left:16px;padding-right:16px;cursor:pointer}.od-unauthenticatedBanner-SignIn{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding-bottom:6px;padding-top:6px}.od-unauthenticatedBanner-SignIn:hover{background-color:"},{"theme":"themeSecondary","defaultValue":"#2b88d8"},{"rawString":"}.od-unauthenticatedBanner-SignUp{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";padding-bottom:7px;padding-top:7px;display:none}.od-unauthenticatedBanner-SignUp:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.lg .od-unauthenticatedBanner-SignUp,.md .od-unauthenticatedBanner-SignUp,.xlg .od-unauthenticatedBanner-SignUp,.xxlg .od-unauthenticatedBanner-SignUp,.xxxlg .od-unauthenticatedBanner-SignUp,.xxxxlg .od-unauthenticatedBanner-SignUp{display:inline}"},{"rawString":".od-MarqueeSelection{position:absolute;z-index:650;top:0;left:0;width:100%;min-height:100%;background:rgba(255,0,0,0);cursor:default}.od-MarqueeSelection-box{position:absolute;box-sizing:border-box;border:1px solid "},{"theme":"themeAccent","defaultValue":"#3a96dd"},{"rawString":";background-color:"},{"theme":"themeAccentTranslucent10","defaultValue":"rgba(58,150,221,.1)"},{"rawString":"}"},{"rawString":".od-DateField--newItem{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":";margin-right:3px}"},{"rawString":".od-FieldRender{text-decoration:none;text-overflow:ellipsis;overflow:hidden}.od-FieldRender-display{cursor:pointer;white-space:nowrap}.od-FieldRender-icon{display:inline-block}[dir=ltr] .od-FieldRender-icon{margin-right:6px}[dir=rtl] .od-FieldRender-icon{margin-left:6px}.od-FieldRender-location:hover,.od-FieldRender-person:hover,.od-FieldRender-sharedWith:hover{cursor:pointer;text-decoration:underline}.od--isNonMobile .DetailsRow .od-FieldRender-dot{visibility:hidden;padding:0 10px}[dir=ltr] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-left:-10px}[dir=rtl] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-right:-10px}.od--isNonMobile .DetailsRow .od-FieldRender-dot:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od--isNonMobile .DetailsRow .od-FieldRender-dot .ms-Icon--More{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od--isNonMobile .DetailsRow .DetailsRow-cell:focus .od-FieldRender-dot,.od--isNonMobile .DetailsRow:hover .od-FieldRender-dot{visibility:visible}"},{"rawString":"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"},{"rawString":".ms-callout{display:inline-block;cursor:pointer}.ms-callout-icon{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}"},{"rawString":".od-TagField{height:54px;box-sizing:border-box;cursor:pointer}.isFluent .od-TagField{height:56px;display:flex;align-items:center}.od-TagField .od-TagField-image{width:50px;height:50px;background-color:rgba(0,0,0,.25)}html[dir=ltr] .od-TagField .od-TagField-image{float:left}html[dir=rtl] .od-TagField .od-TagField-image{float:right}.isFluent .od-TagField .od-TagField-image{height:32px;width:32px;border-radius:2px;overflow:hidden}.od-TagField .od-TagField-name{max-width:150px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle;height:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir=ltr] .od-TagField .od-TagField-name{margin-left:10px}[dir=rtl] .od-TagField .od-TagField-name{margin-right:10px}html[dir=ltr] .od-TagField .od-TagField-name{float:left}html[dir=rtl] .od-TagField .od-TagField-name{float:right}[dir=ltr] .od-TagField .od-TagField-name{margin-right:5px}[dir=rtl] .od-TagField .od-TagField-name{margin-left:5px}[dir=ltr] .isFluent .od-TagField .od-TagField-name{margin-left:12px}[dir=rtl] .isFluent .od-TagField .od-TagField-name{margin-right:12px}.od-TagField .od-TagField-count{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";font-weight:400;font-size:11px;font-weight:400;line-height:54px}.isFluent .od-TagField .od-TagField-count{line-height:56px}"},{"rawString":".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}.DetailsRow-cell a.od-FieldRender-display,.DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";font-size:14px}.DetailsRow-cell a.od-FieldRender-display:hover,.DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}"},{"rawString":".ms-Attachment-icon{font-size:16px;vertical-align:bottom;padding:0;border:0;width:30px;height:30px}"},{"rawString":".ProgressBar-track{height:2px;position:relative;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .ProgressBar-track{border-radius:1px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ProgressBar-track .ProgressBar-value--under{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .ProgressBar-track .ProgressBar-value--under{left:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--under{right:0}.ProgressBar-track .ProgressBar-value--exceeded{background-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{border-left:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{border-right:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{float:right}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{float:left}[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{right:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{left:0}.ProgressBar-listview-track{height:100%}.ProgressBar-listview-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";transition:width 267ms cubic-bezier(.1,.9,.2,1)}.ProgressBar-value{position:absolute;top:0;bottom:0;transition:width 267ms cubic-bezier(.1,.9,.2,1)}.isFluent .ProgressBar-value{border-radius:1px}"},{"rawString":".DetailsRow-cell.AverageRating{overflow:visible}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{width:16px;text-align:center;vertical-align:top;height:36px;position:relative;top:1px;cursor:pointer}.od-Rating-starEmpty:after,.od-Rating-starEmpty:before,.od-Rating-starFull:after,.od-Rating-starFull:before,.od-Rating-starHalf:after,.od-Rating-starHalf:before,.od-Rating-starHover:after,.od-Rating-starHover:before{vertical-align:top;position:relative;top:10px}.od-Rating-enabled.od-Rating-starHalf:focus,.od-Rating-starEmpty.od-Rating-enabled:focus,.od-Rating-starFull.od-Rating-enabled:focus,.od-Rating-starHalf.od-Rating-enabled:focus,.od-Rating-starHover.od-Rating-enabled:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-Rating-enabled.od-Rating-starHalf:active,.od-Rating-starEmpty.od-Rating-enabled:active,.od-Rating-starFull.od-Rating-enabled:active,.od-Rating-starHalf.od-Rating-enabled:active,.od-Rating-starHover.od-Rating-enabled:active{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-Rating-starFull{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-Rating-starEmpty,.od-Rating-starHalf{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";position:relative}@media screen and (-ms-high-contrast:active){.ms-Icon.ms-Icon--FavoriteStarFill.od-Rating-starHalf:before,.od-Rating-starEmpty.ms-Icon.ms-Icon--FavoriteStarFill:before{content:'\\E734'}}.od-Rating-starHalf:after{font-family:FabricMDL2Icons;content:'\\E735';width:40%;overflow:hidden;position:absolute;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}[dir=ltr] .od-Rating-starHalf:after{left:2px}[dir=rtl] .od-Rating-starHalf:after{right:2px}.od-Rating-starHover{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-Rating-count{display:inline-block;vertical-align:top;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;line-height:36px}[dir=ltr] .od-Rating-count{margin-left:8px}[dir=rtl] .od-Rating-count{margin-right:8px}"},{"rawString":".ms-workflowStatus--linkText>span{font-size:12px}"},{"rawString":".od-Like{height:34px;line-height:34px;padding:0 8px;display:inline-block;position:relative;top:1px}.od-Like.od-Like-enabled:hover{cursor:pointer}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty,.od-Like.od-Like-enabled:hover .od-Like-heartFull{color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty:before{content:'\\e16a'}.od-Like.od-Like-enabled:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-Like.is-disabled .od-Like-heartEmpty,.od-Like.is-disabled .od-Like-heartFull{color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-Like.is-disabled .od-Like-count,.od-Like.is-disabled .od-Like-text{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-Like-heartEmpty,.od-Like-heartFull{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";font-size:16px}[dir=ltr] .od-Like-count{margin-left:8px}[dir=rtl] .od-Like-count{margin-right:8px}[dir=ltr] .od-Like-count{margin-right:4px}[dir=rtl] .od-Like-count{margin-left:4px}"},{"rawString":".DetailsRow{overflow:hidden;height:100%;line-height:34px;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.DetailsRow.is-selected{background:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}@media screen and (-ms-high-contrast:active){.DetailsRow.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.DetailsRow.is-selected{background:#00c0ff}}.DetailsRow:focus{outline:1px solid transparent}.od--isNonMobile .DetailsRow.dropping,.od--isNonMobile .DetailsRow:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";outline:1px solid transparent}.od--isNonMobile .DetailsRow:hover.can-select .DetailsRow-check,.od--isNonMobile .DetailsRow:hover.is-selected .DetailsRow-check{opacity:1}.od--isNonMobile .DetailsRow:hover.can-select{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od--isNonMobile .DetailsRow:hover.is-selected{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent.od--isNonMobile .DetailsRow:active.can-select{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-focus--enabled .DetailsRow.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsRow-check{display:inline-block;vertical-align:top;padding:7px 8px;opacity:0}.od-Browser--edge .DetailsRow-check,.od-Browser--ie .DetailsRow-check{padding:8px}.DetailsRow.is-checkVisible .DetailsRow-check,.DetailsRow.is-selected .DetailsRow-check{opacity:1}.DetailsRow.dropping .DetailsRow-cell.type .FileTypeIcon-icon{transform:scale(1.5,1.5)}.DetailsRow.is-receivingDrop .DetailsRow-cell.type .FileTypeIcon-icon{transform:scale(1.6,1.6);transition-duration:.1s;transition-timing-function:cubic-bezier(.075,.82,.165,1)}.od-DetailsRow--isMobile .DetailsRow-check{padding:14px 0 17px 8px}html[dir=rtl] .od-DetailsRow--isMobile .DetailsRow-check{padding:14px 8px 17px 0}.od-DetailsRow--isMobile .DetailsRow-check .ItemCheck{vertical-align:baseline}.DetailsRow-cell.type .FileTypeIcon-icon{transition:transform 267ms cubic-bezier(.075,.82,.165,1)}.DetailsRow-cell{cursor:default;padding:0 8px;display:inline-block;vertical-align:top;position:absolute;height:auto;top:50%;transform:translateY(-50%);outline:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12px;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsRow-cell.type{line-height:30px;overflow:visible}.DetailsRow-cell.type .FileTypeIcon{line-height:16px}.DetailsRow-cell>a,.DetailsRow-cell>a:visited{cursor:pointer;text-decoration:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";font-size:14px}.DetailsRow-cell>a:hover,.DetailsRow-cell>a:visited:hover{text-decoration:underline;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.DetailsRow-cell:focus{outline:1px solid transparent}.DetailsRow-cell.custom a{font-size:17px;line-height:20px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.DetailsRow-cell.custom .ms-Icon{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.DetailsRow-cell.custom .DetailsRow-cellItem{font-size:12px;line-height:16px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}html[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{float:left}html[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{float:right}[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-right:10px}[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-left:10px}.DetailsRow-cell.custom .DetailsRow-cellItem.DetailsRow-cellItem--isLastRowItem{clear:both}.od-focus--enabled .DetailsRow-cell:focus{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsRow.is-checkVisible .DetailsRow-cell{padding:0}"},{"rawString":"@charset \"UTF-8\";.DetailsHeader{overflow:hidden;height:30px;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.DetailsHeader:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader:focus{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsHeader-check{position:absolute;z-index:1;display:inline-block;height:22px;padding:4px 8px;vertical-align:top}.DetailsHeader-check:hover .ItemCheck-background{display:inline-block}.DetailsHeader-check:hover .ItemCheck-check:after{color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.DetailsHeader-check .ItemCheck-background{display:none}.DetailsHeader-check .ItemCheck-check{display:inline-block}.DetailsHeader-check .ItemCheck-check:after{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.DetailsHeader-check:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader-check.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsHeader-check.can-select.is-selected:hover .ItemCheck-check:after{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.DetailsHeader-check.can-select.is-selected .ItemCheck-background{display:inline-block}.DetailsHeader-columns{position:absolute;left:0;right:0;height:30px;overflow:hidden;white-space:nowrap}.DetailsHeader-cell{display:inline-block;vertical-align:top;position:absolute;overflow:hidden;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";outline:0;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsHeader-cell.isSortable{cursor:pointer;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable{border-left:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";border-right:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";border-top:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable{border-left:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-right:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-top:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}.DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-right:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-top:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";border-right:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";border-top:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}.DetailsHeader-cell.isSortable:active{background:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.DetailsHeader-cell .cellContainer{height:30px;display:inline-block;width:100%}.DetailsHeader-cell .cellContainer.isFilterable{width:calc(100% - 21px)}.DetailsHeader-cell .cellBuffer{position:relative;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellBuffer{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellBuffer{padding-right:4px}.DetailsHeader-cell .cellText{display:inline-block;font-size:11px;text-overflow:ellipsis;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellText{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellText{padding-right:4px}.DetailsHeader-cell .cellSort{display:none}[dir=ltr] .DetailsHeader-cell .cellSort{padding-left:2px}[dir=rtl] .DetailsHeader-cell .cellSort{padding-right:2px}.DetailsHeader-cell .cellSort.isSorted{display:inline-block}.DetailsHeader-cell .cellSort:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:\"\";color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:10px}.DetailsHeader-cell .cellSort.isAscending:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:\"\"}.DetailsHeader-cell .cellMenuLink{position:absolute;top:0;height:30px;width:21px}[dir=ltr] .DetailsHeader-cell .cellMenuLink{right:0}[dir=rtl] .DetailsHeader-cell .cellMenuLink{left:0}.DetailsHeader-cell .cellMenuLink:after{position:relative;top:3px}[dir=ltr] .DetailsHeader-cell .cellMenuLink:after{left:2px}[dir=rtl] .DetailsHeader-cell .cellMenuLink:after{right:2px}.DetailsHeader-cell .cellMenuLink.isFiltered:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:\"\";color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-weight:900}.DetailsHeader-cell .cellMenuLink.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.DetailsHeader-cell.DetailsHeader-cell:focus .cellMenuLink:not(.isFiltered):after,.DetailsHeader-cell:hover .cellMenuLink:not(.isFiltered):after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:\"\"}.od-focus--enabled .DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}"},{"rawString":".ItemCheck{display:none;position:relative;width:18px;height:18px;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.can-select .ItemCheck{display:block}.ItemCheck:before{background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";content:'';width:16px;height:16px;position:absolute;border-radius:50%;left:1px;top:1px}.ItemCheck-circle{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;line-height:18px;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ItemCheck-check{font-size:16px;position:absolute;left:1.5px;top:0;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";opacity:0;width:16px;height:16px;line-height:16px}.od--isNonMobile .ItemCheck:hover .ItemCheck-check{opacity:1}.is-selected .ItemCheck:before{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-circle{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-check{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:1}"},{"rawString":".isFluent .LeftPane{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.NotificationHost{z-index:295}.od-BasePage:not(.od-BasePage--hasSmartBanner) .Files-smartBanner{display:none}.Files-loadingBar{opacity:1}.SetView-firstRunBanner .FirstRunBanner--isContentLoaded{margin-top:20px}.md .SetView-firstRunBanner,.sm .SetView-firstRunBanner{display:none}.od-Files--isReceiving .Files-listView{box-shadow:inset 0 0 0 3px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-Files-dragAndDropHint{text-align:center;margin-top:33px;margin-bottom:24px}.od-Files-unauthBanner{position:absolute;top:0;left:0;right:0;height:50px}.od-Files-oneUp{position:absolute;top:0;left:0;right:0;bottom:0}.od-Files-oneUp.od-Files-OneUp--showUnauthBanner{top:50px}.od-Share{width:320px}.ms-ContextualMenu.ms-FocusZone.is-open{position:relative;border:none;box-shadow:0 0 3px 1px #d3d3d3;max-width:320px;width:auto}"},{"rawString":".List{position:relative;display:block}.List .List-surface{position:relative;min-height:1px}.List .List-surface:focus{outline:0}.List .List-page{position:relative}.List .List-cell{position:absolute;display:inline-block}.List .List-placeHolder{width:1px;position:absolute;visibility:hidden}"},{"rawString":".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"},{"rawString":".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"},{"rawString":".od-newBadge{font-size:11px;font-weight:600}.od-newBadge .od-newBadge-icon{transform:translate(0,-.6em)}[dir=ltr] .od-newBadge .od-newBadge-icon{margin-right:-.46em}[dir=rtl] .od-newBadge .od-newBadge-icon{margin-left:-.46em}html[dir=rtl] .od-newBadge .od-newBadge-icon{transform:translate(0,-.6em) scale(-1,1)}"},{"rawString":"@charset \"UTF-8\";@keyframes fadeAndScale{0%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0;animation-timing-function:ease-out}25%{transform:translate(-50%,-50%) scale(1,1);opacity:1}75%{transform:translate(-50%,-50%) scale(1,1);opacity:1;animation-timing-function:ease-in}100%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0}}@keyframes ItemScope-NewTile{0%{transform:scale(.85);opacity:0}100%{transform:scale(1);opacity:100%}}.ItemTile{position:absolute;left:0;right:0;top:0;bottom:0;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;animation-duration:267ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-iteration-count:1;animation-name:ItemScope-NewTile}@media screen and (-ms-high-contrast:active){.ItemTile{border:1px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile{border:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}.ItemTile .ItemTile-link{top:0;left:0;bottom:0;right:0;position:absolute}.ItemTile:focus{outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile:focus{outline:0}}.od--isNonMobile .ItemTile{transition:transform .1s linear}.od--isNonMobile .ItemTile:active{transform:scale(.96)}.ItemTile-entity-container{display:inline}.ItemTile-entity{border-radius:50%;overflow:hidden;height:34px;width:34px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";vertical-align:top;max-width:20%}html[dir=ltr] .ItemTile-entity{float:left}html[dir=rtl] .ItemTile-entity{float:right}.ItemTile-longText{margin-left:10px;max-width:60%;display:inline-flex;white-space:pre-wrap}.ItemTile-image{position:absolute;top:0;left:0;right:0;bottom:0}.ItemTile-dragDropIcon{position:absolute;top:8px;right:2px;bottom:0;left:2px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";opacity:0;transform:translateY(100%)}.ItemTile-folderOverlay{position:absolute;display:inline-block;top:50%;left:50%;transform:translate(-50%,-50%);width:92px;height:92px}.ItemTile-photo{position:absolute;top:0;left:0;bottom:0;right:0}.ItemTile.is-file,.ItemTile.is-media{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ItemTile.is-file .od-ImageStack-tile,.ItemTile.is-folder .od-ImageStack-tile,.ItemTile.is-media .od-ImageStack-tile{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}@media screen and (-ms-high-contrast:active){.ItemTile.is-file .ItemTile-discoverFileContainer,.ItemTile.is-file .ItemTile-fileContainer{border:0}}.ItemTile.is-file .od-ImageStack-tile img{box-shadow:0 0 8px 0 rgba(0,0,0,.06)}.ItemTile.is-media .od-ImageFrame::after{content:\"\";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.ItemTile-fileContainer{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-discoverFileContainer{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-fileIconContainer{position:absolute;top:0;bottom:50px;left:0;right:0}.ItemTile.od-ItemTile--isDiscover .ItemTile-fileIconContainer{position:absolute;top:0;bottom:70px;left:0;right:0}.ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{margin:0;top:auto;bottom:0;padding:4px}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:auto}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:auto}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:0}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:0}.ItemTile-fileIcon{text-align:center}.ItemTile-fileIcon--thumbnail{position:absolute;top:50%;left:0;right:0;margin:-48px}.ItemTile-fileIcon--noThumbnail{position:relative;text-align:center;margin-top:14px}.ItemTile-rowCheck{display:none;position:absolute;top:0;width:100%;height:100%;opacity:0}[dir=ltr] .ItemTile-rowCheck{right:0}[dir=rtl] .ItemTile-rowCheck{left:0}.od-ItemTile--isInvokable .ItemTile-rowCheck{width:40px;height:40px}.is-checkVisible .ItemTile-rowCheck{opacity:1}.ItemTile.is-folder .ItemTile-rowCheck{top:6px}[dir=ltr] .ItemTile.is-folder .ItemTile-rowCheck{right:-1px}[dir=rtl] .ItemTile.is-folder .ItemTile-rowCheck{left:-1px}.ItemTile.is-folder.is-dropping .ItemTile-rowCheck,.ItemTile.is-folder.is-receivingDrop .ItemTile-rowCheck{opacity:0}.can-select .ItemTile-rowCheck{display:block}.od--isNonMobile .ItemTile.can-select:hover,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover{opacity:1}.ItemTile.is-selected .ItemTile-rowCheck,.od--isNonMobile .ItemTile:hover .ItemTile-rowCheck{opacity:1}.od-ItemTile-selector{display:none}.od-ItemTile--isInteractable .od-ItemTile-selector{display:block}.ItemTile-frame{position:absolute;display:none;left:2px;top:2px;right:2px;bottom:2px;box-shadow:0 0 0 2px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile-frame{outline:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile-frame{outline:2px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}}.od-ItemTile--hasImageStack .ItemTile-frame{top:8px}@media screen and (-ms-high-contrast:active){.od-ItemTile--hasImageStack .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-tag .ItemTile-frame{top:2px}.od--isNonMobile .ItemTile.can-select:hover .ItemTile-frame,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":"}.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{display:block;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 0 2px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{transform:translateY(0);animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:\"\";font-size:42px;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";top:50%;left:50%;transform:translate(-50%,-50%)}.ItemTile .ItemCheck{position:absolute;top:8px}[dir=ltr] .ItemTile .ItemCheck{right:8px}[dir=rtl] .ItemTile .ItemCheck{left:8px}.ItemTile-namePlate{position:absolute;bottom:0;left:0;right:0;min-height:20px;padding:4px 8px 8px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";white-space:nowrap;text-overflow:ellipsis}.ItemTile.is-file .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:35px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate{opacity:1;border-top:1px solid rgba(255,255,255,.2);max-height:74px}.ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";height:34px;width:34px;padding-top:5px;font-size:23px}[dir=ltr] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-left:5px}[dir=rtl] .ItemTile.od-ItemTile--isDiscover .ItemTile-namePlate .ItemTile-subText .Icon-main{padding-right:5px}.ItemTile.is-media .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:17px}.ItemTile.is-folder .ItemTile-namePlate{background-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-top:1px solid rgba(255,255,255,.2);transition:transform 367ms cubic-bezier(.1,.9,.2,1)}.ItemTile.is-folder .ItemTile-namePlate::before{content:'';position:absolute;width:32%;height:16px;border-top:1px solid rgba(255,255,255,.2);top:-16px;background-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";overflow:hidden}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{padding-left:1px}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{padding-right:1px}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{right:0}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{left:0}.ItemTile.is-folder.is-dropping .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{transform:translateY(0);opacity:1;animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:1.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:\"\";font-size:28px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";top:50%;left:50%;transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:\"\";font-size:42px;color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":";top:50%;left:50%;transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{animation:none}}.ItemTile-nameCover{background-color:rgba(0,0,0,.25);position:absolute;font-weight:600;text-shadow:0 0 8px #000;top:0;width:100%;height:100%}[dir=ltr] .ItemTile-nameCover{left:0}[dir=rtl] .ItemTile-nameCover{right:0}.ItemTile-tagText{position:relative;text-align:center;color:#fff;top:50%;left:50%;transform:translate(-50%,-50%);padding:0 8px}.ItemTile-folderBeak,.ItemTile-folderBeakHighlight{position:absolute;top:-16px;overflow:hidden}[dir=ltr] .ItemTile-folderBeak,[dir=ltr] .ItemTile-folderBeakHighlight{right:32%}[dir=rtl] .ItemTile-folderBeak,[dir=rtl] .ItemTile-folderBeakHighlight{left:32%}.ItemTile-folderBeak::before{content:'';position:absolute;top:1px;width:20px;height:30px;background-color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";transform-origin:top left;transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeak::before{right:-19px}[dir=rtl] .ItemTile-folderBeak::before{left:-19px}.ItemTile-folderBeak{width:18px;height:18px}.ItemTile-folderBeakHighlight{width:16px;height:16px}.ItemTile-folderBeakHighlight::before{content:'';position:absolute;top:0;width:1px;height:30px;background-color:rgba(255,255,255,.2);transform-origin:top left;transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeakHighlight::before{right:0}[dir=rtl] .ItemTile-folderBeakHighlight::before{left:0}html[dir=rtl] .ItemTile-folderBeak::before,html[dir=rtl] .ItemTile-folderBeakHighlight::before{transform-origin:top right;transform:rotate(-40deg)}.ItemTile-childCount,.ItemTile-name,.ItemTile-subText{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ItemTile-name{font-size:15px;line-height:20px}.ItemTile.is-tag .ItemTile-name{max-height:4.1em;font-weight:400;font-size:17px;white-space:normal;text-overflow:normal;word-wrap:break-word;line-height:23px;padding-bottom:4px}.ItemTile-tagCount{font-weight:600;font-size:12px;line-height:10px;opacity:.85}.ItemTile-sharingIcon{font-size:15px}.ItemTile.is-folder .ItemTile-sharingIcon{line-height:20px}html[dir=ltr] .ItemTile.is-folder .ItemTile-sharingIcon{float:right}html[dir=rtl] .ItemTile.is-folder .ItemTile-sharingIcon{float:left}.ItemTile.is-folder .ItemTile-subText .ItemTile-sharingIcon{float:inherit!important;line-height:1}.ItemTile-childCount{position:absolute;top:-14px;padding:0 3px;font-size:11px}[dir=ltr] .ItemTile-childCount{left:68%}[dir=rtl] .ItemTile-childCount{right:68%}.ItemTile.ItemTile.od-ItemTile--isDiscover .ItemTile-subText{padding-top:3px;opacity:1}.ItemTile.is-file .ItemTile-subText{font-size:11px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.ItemTile.is-folder .ItemTile-subText{font-size:11px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:.7}.ItemTile-subTextImage{width:14px;height:14px}[dir=ltr] .ItemTile-subTextImage{margin-right:4px}[dir=rtl] .ItemTile-subTextImage{margin-left:4px}.ItemTile-subTextImageShort{width:12px;height:12px}[dir=ltr] .ItemTile-subTextImageShort{margin-right:4px}[dir=rtl] .ItemTile-subTextImageShort{margin-left:4px}.ItemTile-subTextIcon{font-size:14px;position:relative;top:2px}[dir=ltr] .ItemTile-subTextIcon{margin-right:4px}[dir=rtl] .ItemTile-subTextIcon{margin-left:4px}.ItemTile-subTextIcon.ms-Icon.ms-Icon--IncidentTriangle{color:"},{"theme":"orange","defaultValue":"#d83b01"},{"rawString":"}.ItemTile-blockIcon{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeak,.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeakHighlight{display:none}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{font-size:12px;position:absolute;bottom:24px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate{height:50%;background:linear-gradient(0deg,rgba(0,0,0,.58),rgba(0,0,0,0));color:#fff;left:2px;right:2px}.ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{top:auto;bottom:10px;padding:0;font-size:10px;color:rgba(255,255,255,.8)}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:10px;right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-frame{top:8px}.ItemTile.od-ItemTile--isAlbum .ItemTile-rowCheck{top:6px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,.ItemTile.od-ItemTile--isAlbum .ItemTile-subText{position:absolute;bottom:10px}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{right:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{left:10px}.ItemTile.od-ItemTile--isStory .ItemTile-name{font-size:21px;font-weight:100;text-shadow:0 0 8px #000;bottom:28px;line-height:31px;left:12px;right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name{left:20px;right:20px;bottom:40px}.ItemTile.od-ItemTile--isStory .ItemTile-date{display:block;position:absolute;top:auto;bottom:12px;font-size:14px;text-shadow:0 0 8px #000}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-date{left:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-date{right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{left:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{right:20px}.ItemTile.od-ItemTile--isStory .ItemTile-childCount{font-size:14px;text-shadow:0 0 8px #000;bottom:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:auto}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:auto}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:20px}.ItemTile-newBadge{position:absolute;bottom:45px}[dir=ltr] .ItemTile-newBadge{left:1px}[dir=rtl] .ItemTile-newBadge{right:1px}.ItemTile-newBadge .od-newBadge{position:relative}[dir=ltr] .ItemTile-newBadge .od-newBadge{left:10px}[dir=rtl] .ItemTile-newBadge .od-newBadge{right:10px}.od-ItemTile--isVideo .ItemTile-fileIconContainer{bottom:0}.od-ItemTile--isVideo .ItemTile-namePlate{display:none}.ItemTile-playButton{position:absolute;color:#fff;bottom:8px;font-size:1.3em}[dir=ltr] .ItemTile-playButton{left:4px}[dir=rtl] .ItemTile-playButton{right:4px}html[dir=ltr] .ItemTile-viewerCount{float:right}html[dir=rtl] .ItemTile-viewerCount{float:left}.od-ItemTile-card{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.ItemTile-date{display:none}.od-ItemTile--color-oneDrive.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-ItemTile--color-oneDrive .ItemTile-folderBeak:before{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-ItemTile-button{position:absolute;top:15px;z-index:1;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:.8;text-shadow:0 1px 1px #000;border:0;padding:4px;visibility:hidden;background-color:transparent}[dir=ltr] .od-ItemTile-button{right:10px}[dir=rtl] .od-ItemTile-button{left:10px}.od-ItemTile-button:hover{cursor:pointer;background-color:#000;opacity:.3}.ItemTile:hover .od-ItemTile-button{visibility:visible}.od-ItemTile-button .od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:block}"},{"rawString":".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";transition:transform .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}"},{"rawString":".SharerHeader{display:block;padding:8px 0;margin:24px 0;text-decoration:none;vertical-align:middle;font-size:12px}.SharerHeader-userTile{width:40px;height:40px;border-radius:50%;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:21px;position:relative;overflow:hidden;text-align:center;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}html[dir=ltr] .SharerHeader-userTile{float:left}html[dir=rtl] .SharerHeader-userTile{float:right}[dir=ltr] .SharerHeader-userTile{margin-right:8px}[dir=rtl] .SharerHeader-userTile{margin-left:8px}.SharerHeader-userTile.SharerHeader-hasProfileImage{background-color:transparent}.SharerHeader-userTile.ms-Icon{line-height:40px}.SharerHeader-userTile img{position:absolute;top:0;left:0}.SharerHeader-title{font-size:17px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.SharerHeader-subText{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";display:inline-block}.SharerHeader-showAll{display:inline-block;padding:0 16px}"},{"rawString":".od-HeaderTile{box-sizing:border-box;height:46px;padding:9px 0}.od-HeaderTile:focus{outline:0}.od-focus--enabled .od-HeaderTile:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-HeaderTile-title{font-size:21px;font-weight:600}"},{"rawString":".EmptyFolder{text-align:center}.EmptyFolder.EmptyFolder-content-vault{padding-top:95px}.EmptyFolder-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.EmptyFolder-image .EmptyFolder-imageTag{height:208px;width:auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin:0 auto}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.isFluent .EmptyFolder-title{font-size:18px;font-weight:600}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-size:17px;font-weight:300;padding-top:64px}.EmptyFolder-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin:0 auto}html[dir=rtl] .EmptyFolder-subText{padding:6px 16px 0 16px}.isFluent .EmptyFolder-subText{padding:8px 16px 0}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}"},{"rawString":".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar,.xxxxlg .BreadcrumbBar{margin-top:7px}.isFluent.xlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxxxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.BreadcrumbBar-list{display:block;margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.isFluent .BreadcrumbBar-list li:last-child .BreadcrumbBar-item{font-weight:600}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";padding:8px 4px;cursor:pointer}.isFluent .BreadcrumbBar-overflow{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:8px 8px}.isFluent.xlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxxlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxxxlg .BreadcrumbBar-overflow{padding:5px 8px}.BreadcrumbBar-overflow:hover{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":" inset}.BreadcrumbBar-navItem:active{background:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}a.BreadcrumbBar-item{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.isFluent a.BreadcrumbBar-item{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-size:17px;font-weight:300}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:21px;font-weight:100;padding-bottom:1px;line-height:28px}.isFluent.sm .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.md .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.lg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";vertical-align:top;padding:0 2px;margin-top:11px}.lg .BreadcrumbBar-item-chevron{margin-top:13px}.isFluent.lg .BreadcrumbBar-item-chevron{margin-top:10px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{font-size:12px;margin-top:11px;padding:0 4px}.isFluent.xlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76c'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76b'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.isFluent .od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:21px;font-weight:100}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:28px;font-weight:100;line-height:1}"},{"rawString":".lg .od-ItemContent-metadata,.md .od-ItemContent-metadata,.sm .od-ItemContent-metadata{font-size:14px}.xlg .od-ItemContent-metadata,.xxlg .od-ItemContent-metadata,.xxxlg .od-ItemContent-metadata,.xxxxlg .od-ItemContent-metadata{font-size:16px}.od-ItemContent-metadata-button{cursor:pointer;border-width:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding-left:0;padding-right:0}.od-ItemContent-metadata-button i{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}"},{"rawString":".od-ItemContent-header{box-sizing:border-box;display:flex;flex-flow:row wrap;align-items:flex-end;padding-top:10px;padding-bottom:10px}.xlg .od-ItemContent-header,.xxlg .od-ItemContent-header,.xxxlg .od-ItemContent-header,.xxxxlg .od-ItemContent-header{padding-top:32px;padding-bottom:0}.od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 32px 20px;max-width:800px;font-size:18px;font-weight:600;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.sm .od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 16px 20px}.xxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxxlg .od-FolderItemContent .StorageInfo-sectionHeading{max-width:1080px}.isFluent.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.md .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.lg .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 16px 40px}.isFluent.xxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent.xxxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent.xxxxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent .od-FolderItemContent .od-ItemContent-progress-container{max-width:800px;box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108);border-radius:2px;margin:0 32px 20px;padding:24px 0}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main{display:flex;flex-direction:column}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main .od-quota-progress-bar-top{order:1;margin-top:12px}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .StorageInfo-totalUsed{font-weight:600}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-ItemContent-progress{padding:0 24px;margin-top:12px;height:46px}.od-FolderItemContent .StorageInfo-totalUsed{margin:0 24px}.od-ItemContent-progress{height:31px;padding:10px 32px}.md .od-ItemContent-progress,.sm .od-ItemContent-progress{padding-left:16px;padding-right:16px}.od-ItemContent-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:21px;font-weight:100}.isFluent .od-ItemContent-title{font-size:20px;font-weight:600}.lg .od-ItemContent-title,.md .od-ItemContent-title,.sm .od-ItemContent-title{font-weight:300}.isFluent.sm .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.isFluent.md .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.isFluent.lg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.xlg .od-ItemContent-title,.xxlg .od-ItemContent-title,.xxxlg .od-ItemContent-title,.xxxxlg .od-ItemContent-title{font-size:28px;font-weight:100}.isFluent.xlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.isFluent.xxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.isFluent.xxxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.isFluent.xxxxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:14px}.od-ItemContent-breadcrumb{font-size:17px;font-weight:300}.md .od-ItemContent-breadcrumb,.sm .od-ItemContent-breadcrumb{font-size:14px;font-weight:400}.xlg .od-ItemContent-breadcrumb,.xxlg .od-ItemContent-breadcrumb,.xxxlg .od-ItemContent-breadcrumb,.xxxxlg .od-ItemContent-breadcrumb{font-size:21px;font-weight:100;margin-bottom:1px}.isFluent.xlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxxlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxxxlg .od-ItemContent-breadcrumb{margin-top:14px}.xlg .od-ItemContent-list,.xxlg .od-ItemContent-list,.xxxlg .od-ItemContent-list,.xxxxlg .od-ItemContent-list{padding-top:20px}.od-ItemContent-footer{margin:0}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-left:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-right:32px}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-right:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-left:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-left:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-right:16px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-right:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-left:16px}.od-ItemContent-header-sharedIndicator{display:inline-block;position:relative;padding:0}.od-ItemContent-header-sharedIndicator .od-ItemContent-metadata{padding-bottom:3px;margin:0}"}]);});