define("odsp-next/actions/OdcExecutors",["require","exports","./createFolder/odc/CreateFolderExecutor","./delete/odc/DeleteExecutor","./download/odc/DownloadExecutor","./download/DownloadItemsOperator","./embed/odc/EmbedExecutor","./emptyRecycleBin/odc/EmptyRecycleBinExecutor","./launchMoveCopyPanel/LaunchMoveCopyPanelExecutor","./userActivity/odc/UserActivityExecutor","./rename/odc/RenameExecutor","./setPhotosRoot/odc/SetPhotosRootExecutor","./reportAbuse/odc/ReportAbuseExecutor","./removeFromSharedList/odc/RemoveFromSharedListExecutor","./requestReview/odc/RequestReviewExecutor","./restoreAll/odc/RestoreAllExecutor","./save/SaveExecutor","./setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor","./showOperations/ShowOperationsExecutor","./showPermissions/ShowPermissionsExecutor","./showSuggestedFiles/ShowSuggestedFilesExecutor","./showVersionHistoryAction/ShowReactVersionHistoryExecutor","./switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor","./addToAlbum/odc/AddToAlbumExecutor","./applyOfficeLens/odc/ApplyOfficeLensExecutor","./removeOfficeLens/odc/RemoveOfficeLensExecutor","./addToBundle/odc/AddToBundleExecutor","./feedback/odc/FeedbackExecutor","./createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor","./orderPrints/odc/OrderPrintsExecutor","./showKeyboardMap/ShowKeyboardMapExecutor","./redeemCode/odc/RedeemCodeExecutor","./editTags/odc/EditTagsExecutor","./editTags/odc/ShowTagsEditorExecutor","./shareByLink/odc/ShareByLinkExecutor","./addPhotosToAlbum/AddPhotosToAlbumExecutor","./createAlbum/CreateAlbumExecutor","./printPdf/odc/PrintPdfExecutor","./saveAutoAlbum/odc/SaveAutoAlbumExecutor","./discardAutoAlbum/odc/DiscardAutoAlbumExecutor","./addToFolder/odc/AddToFolderExecutor","./vault/odc/VaultExecutor","./downloadZipContents/odc/DownloadZipContentsAction","./moveCopy/odc/MoveCopyAction","./createNewFolder/odc/CreateNewFolderAction"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("odsp-next/actions/createFolder/odc/CreateFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../CreateFolderHelper","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n.name=t.actionName;n._forceRedeem=!n.resources.consume(o.userInfo).isAuthenticated();n._itemReedemer=n.resources.consume(i.resourceKey);n._createFolderHelper=new(n.managed(s.default));return n}t.prototype.execute=function(){var e=this;return this._itemReedemer.redeemItem(this._item,this,this._forceRedeem).then(function(){return e._createFolderHelper.showDialog({maxNameLength:255,supportInlineSharing:!1})})};return t})(r.default);t.default=u});
define("odsp-next/actions/createFolder/CreateFolderHelper",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../resources/ControlResourceKeys","../../controls/folderBuilder/FolderBuilder","./CreateFolderOperator","../../controls/folderBuilder/FolderBuilder.resx","@ms/odsp-utilities/lib/object/ObjectUtil","../../controls/sharing/share/commands/ShareCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dialogProvider=n.resources.consume(f.resourceKey);n._currentItem=n.resources.consume(l.currentItem);n._actionMap=n.resources.consume(l.actionMap);n._createdFolder=n.createObservable(null);return n}t.prototype.showDialog=function(e){var t=this,n=e.maxNameLength,s=e.supportInlineSharing,f=void 0!==s&&s,l=e.isCreateShareableFolder,m=void 0!==l&&l,g=this.observables.create(""),y=this.observables.create(""),b=this.observables.create(!1),w=this.observables.create(!0),E=this.observables.create(!0),S=this.observables.create([]),x=this.observables.create(""),T=this.observables.create(!0),N=m?a.default.CreateSharedFolder:a.default.CreateFolder,C=m?a.default.ContinueToShare:a.default.CreateCommit,k=m?"createSharedFolderDialog":"createFolderDialog";return this._dialogProvider.requestDialog({title:N,component:{name:c.default.tagName,params:{name:g,automationId:k,status:y,hasError:b,isEnabled:w,maxNameLength:n,hasFocus:E,supportInlineSharing:f,selectedPeople:S,sharingNote:x,statusVisible:T}},actions:[{name:C,execute:function(){T(!1);var e={tasks:null};d.extend(e,r);e.tasks.runEarly();y(a.default.CreateFolderCollapsed);T(!0);w(!1);b(!1);return t.resources.consumeAsync(h.typeResourceKey).then(function(e){var n=new e({parent:t._currentItem.peek(),folderName:g(),sharingNote:x(),selectedPeople:S().filter(function(e){return e.isResolved}),needItemDetails:!0,createdFolder:t._createdFolder});return t.trackPromise(n.start())}).then(function(){b(!1);w(!0);T(!1);var e=u.format(p.default.CreateFolderSuccess,g());y(e);T(!0);return 2},function(e){b(!0);T(!1);t.async.setTimeout(function(){b(!0);w(!0);E(!0);y(e.message);T(!0)},200);return 1})},isAvailable:this.observables.pureCompute(function(){return!!g()&&w()}),isDefault:!0,icon:new i.default("Save"),automationId:k+"Commit"}]}).wait().then(function(){if(m){new(t.managed(t._actionMap.ShowShareAction))({focusItemResourceKey:v.shareFocusItemResourceKey,overrideItem:t._createdFolder(),scenarioId:"CreateSharedFolder"}).execute(event)}return{resultType:o.ResultTypeEnum.Success}})};return t})(s.default);t.default=m});
define("odsp-next/controls/folderBuilder/FolderBuilder",["require","exports","./FolderBuilder.html","./FolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-folder-builder",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/folderBuilder/FolderBuilder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FolderBuilder"><div class="od-TextField"><input class="od-FolderBuilder-nameInput od-TextField-field" type="text" data-bind="value:name,textInput:name,hasFocus:hasFocus,attr:{placeholder:namePlaceholder,maxlength:maxNameLength,\'aria-invalid\':hasError,\'aria-label\':nameLabel},automation:automationId,css:{\'od-FolderBuilder-nameInput--error\':hasError},enable:isEnabled">\x3c!--ko if:supportInlineSharing--\x3e<button class="od-FolderBuilder-addEditorsButton od-Button" data-bind="visible:!areSharingFieldsVisible(),click:onAddEditorsClicked,text:addEditors"></button><div class="od-FolderBuilder-sharingFields" data-bind="visible:areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel od-Label" data-bind="text:editorsLabel"></label><div class="od-FolderBuilder-peoplePicker" data-bind="component:{name:peoplePickerTagName,params:peoplePickerParams}"></div><div><textarea class="od-FolderBuilder-noteInput" data-bind="value:sharingNote,attr:{placeholder:editorsNotePlaceholder,maxlength:4e3}"></textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text:editorsDescription"></div>\x3c!--/ko--\x3e</div><div class="od-FolderBuilder-status" role="alert" aria-live="polite" aria-relevant="text" data-bind="visible:statusVisible,text:status,css:{\'od-FolderBuilder-status--error\':hasError}"></div></div>'});
define("odsp-next/controls/folderBuilder/FolderBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./FolderBuilder.resx","../peoplePicker/PeoplePicker","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=i.default.FolderNamePlaceholder;n.nameLabel=i.default.FolderNameLabel;n.addEditors=i.default.AddEditors;n.editorsLabel=i.default.EditorsLabel;n.editorsDescription=i.default.EditorsDescription;n.editorsNotePlaceholder=i.default.EditorsNotePlaceholder;n.peoplePickerTagName=s.default.tagName;n.name=t.name;n.status=t.status||o.observable("");n.hasError=t.hasError||o.observable(!1);n.isEnabled=t.isEnabled||o.observable(!0);n.hasFocus=t.hasFocus||o.observable(!0);n.maxNameLength=t.maxNameLength;n.statusVisible=t.statusVisible||o.observable(!0);n.supportInlineSharing=t.supportInlineSharing;n.sharingNote=t.sharingNote;n.selectedPeople=t.selectedPeople;n.peoplePickerParams={selectedPeople:n.selectedPeople,peoplePickerQueryParams:void 0};n.areSharingFieldsVisible=o.observable(!1);return n}t.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)};return t})(r.default);t.default=u});
define("odsp-next/actions/createFolder/CreateFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.createdFolder,s=void 0===i?r.createObservable():i;r._context=t;r._fileSystemProvider=n.fileSystemProvider;r._payloads={createFolder:{parent:t.parent,createdFolder:s}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input,i=this._context.parent;n.type=s.default.createFolder;n.name=r;n.iconName=i.iconName;n.payloads=this._payloads;n.visibility=2;t.output&&this._payloads.createFolder.createdFolder(t.output);return n};t.prototype.onStart=function(e){return this._fileSystemProvider.createFolder(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{fileSystemProvider:i.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/fileSystem/FileSystemProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/item/DeletionType","../../dataSources/item/ItemTaskObserver","../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources","../item/ItemProvider","../quota/UserStateProvider.key","../../models/itemsScope/ItemsScopeFeature.key","../../models/itemsScope/ItemsScopeFeature.key","../../models/task/Task","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota;this._isItemsScopeEnabled=t.isItemsScopeEnabled;this._resources=t.resources}e.prototype.createFolder=function(e,t){var n=this,r=e.parent.key,i=e.folderName,s=new p.default(r+"&cf="+i,i);return this._performOperation([r],t,s,function(){return n._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var n=this,r=e.item,i=r.key,s=new p.default(i,r);return this._performOperation([e.parentKey,i],t,s,function(){return n._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(e){var t=this,n=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(e).then(function(r){var i;e.deletionType===s.default.Recycle&&(i={triggerFetch:!1,emptyAllOtherSets:!0});n.invalidateItem(e.parentKey,i);var o=e.items.map(function(e){return new p.default(e.key).succeed({item:{key:e.key,parentKey:m.remove()}})}),u=t._itemTaskObserver;u.update(o);u.flush();return r})};e.prototype._handleRestore=function(e){var t=this;return this._deleteRestoreDataSource.restoreItems(e).then(function(n){var r=i.deserializeQuery(e.parentKey);delete r.view;var s=i.serializeQuery(r);t._itemProvider.invalidateItem(s,{emptyAllOtherSets:!0});(t._isItemsScopeEnabled||t._resources.consume(h.isItemsScopeEnabledInAllPhotosPivotResourceKey))&&t._resources.consumeAsync(d.itemInvalidator).then(function(e){e.invalidateItems(s)});return n})};e.prototype._handleDeleteOrRestore=function(e,t,n){var r=this,i={},s=e.items.map(function(e){return i[e.id]=new p.default(e.key,e)}),o=this._itemProvider;t.update(s);return n.call(this,e).then(function(n){for(var i=0,o=e.items;i<o.length;i++){var u=o[i];r._invalidatePhoto(u)}r._store.invalidateAllPhotos();r._invalidateAllTags();s=s.map(function(e){return e.succeed()});t.update(s)},function(n){o.invalidateItem(e.parentKey);var r=n.data&&n.data.items||[];s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u],l=i[f.id];delete i[f.id];s.push(f.error?l.fail(f.error):l.succeed())}for(var c in i){l=i[c];s.push(l.cancel())}t.update(s)}).then(function(){r._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=i.deserializeQuery(e.key);delete t.qt;var n=i.serializeQuery(t);this._store.invalidateItem(n);(this._isItemsScopeEnabled||this._resources.consume(h.isItemsScopeEnabledInAllPhotosPivotResourceKey))&&this._resources.consumeAsync(d.itemInvalidator).then(function(e){e.invalidateItems(n)});if(e.tags)for(var r=0,s=e.tags;r<s.length;r++){var o=s[r];this._store.invalidateLocation(o.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var n=e.getAllPhotosSettings().peek();t.invalidateAllTags(n.rootId)}};e.prototype._performOperation=function(e,t,r,i){var s=this;t.update([r]);return i().then(function(n){for(var i=0,o=e;i<o.length;i++){var u=o[i];s._itemProvider.invalidateItem(u)}t.update([r.succeed(n)])},function(e){var i=new Error(e);t.update([r.fail(i)]);return n.default.wrapError(i)})};e.dependencies={itemDataSource:d.items,deleteRestoreDataSource:d.deleteRestore,itemProvider:f.resourceKey,itemsStore:u.resourceKey,itemTaskObserverType:o.resourceKey,photoProvider:v.photo.optional,tagProvider:v.tag.optional,updateQuota:l.resourceKey,isItemsScopeEnabled:c.isItemsScopeEnabledResourceKey,resources:a.resourceScopeKey};return e})();t.default=g;t.resourceKey=r.createResolvedResourceKey(e("module").id,g)});
define("odsp-next/actions/delete/odc/DeleteExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../dataSources/item/DeletionType","../DeleteExecutor","../../../controls/commands/Commands.resx","../DeleteExecutor.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../dataSources/url/odc/UrlDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../providers/dialog/DialogProvider","../../../utilities/features/Features","../../../controls/htmlContainer/HTMLContainer","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._itemReedemer=n.resources.consume(s.resourceKey);n._urlDataSource=n.resources.consume(h.resourceKey);n._navigation=n.resources.consume(p.navigation);return n}t.prototype.getDeleteExecutionInfo=function(e){var t,n,r=this.currentItem.queryType,i=u.default.Recycle;if(this._urlDataSource.isRecycleBin(r)){i=u.default.PermanantDelete;t=this._getRecycleBinDialogText(e);n=f.default.recycleBinDeleteConfirmTitle}else if(0!==e[0].sharingRole)if(1===e.length){t=f.default.deleteSharedSingleItem;n=f.default.deleteSharedSingleItemPromptTitle}else{t=f.default.deleteSharedMultipleItems;n=f.default.deleteSharedMultipleItemPromptTitle}else if(v.isFeatureEnabled(v.DeleteConfirmDialogODC)){var s=e&&1===e.length&&e[0].name;n=s?c.format(f.default.deleteConfirmTitleWithFileName,s):f.default.deleteConfirmTitle;t=e&&e.length>1?l.default.deleteMultiConfirmDescription:l.default.deleteConfirmDescription}return{text:t,title:n,type:i,allowUndo:!0,emptyRecycleBin:!1}};t.prototype.executeDelete=function(t){var n=this,i=t.length;t.forEach(function(e){if(e.vault&&e.vault.root){n._vaultDeleteDialog(i);t=[]}});return t.length<1?r.default.resolve({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"VaultDeleteNotExecuted",extraMetrics:{count:i}}):this._itemReedemer.redeemItems(t,this).then(function(){return e.prototype.executeDelete.call(n,t)})};t.prototype._vaultDeleteDialog=function(e){var t=this,n=this.resources.consume(d.resourceKey),s=l.default.DisableVaultTextBatchDeleteParagraph1+"<p>"+l.default.DisableVaultTextBatchDeleteParagraph2+"</p>",o=n.requestDialog({title:l.default.DisableVaultTitle,component:{name:m.default.tagName,params:{html:e>1?s:l.default.DisableVaultText}},actions:[{name:l.default.DisableVaultSettings,execute:function(){return t._onVaultSettingsClick()},isAvailable:this.observables.create(!0),icon:new g.default("CheckMark"),isDefault:!0},{name:l.default.DisableVaultCancel,execute:function(){i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Cancelled"});return r.default.resolve(3)},isAvailable:this.observables.create(!0),icon:new g.default("Cancel")}]});i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Shown"});o.wait().catch(function(){3===o.state.peek()&&i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Dismissed"})})};t.prototype._onVaultSettingsClick=function(){i.Engagement.logData({name:"Vault.Delete.GoToSettings"});this._navigation.navigateTo({url:this._urlDataSource.getManageVaultUrl()});return r.default.resolve(3)};t.prototype._getRecycleBinDialogText=function(e){return 1===e.length?c.format(f.default.recycleBinDeleteConfirmTextSingleSelection,e[0].name):f.default.recycleBinDeleteConfirmTextMultiSelection};return t})(a.default);t.default=y});
define("odsp-next/actions/delete/DeleteExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","./DeleteItemsOperator"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.selectionHelper=t.selectionHelper;n.currentItem=t.currentItem;n.dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this.currentItem?this.selectionHelper.resolveSelection().then(function(e){return e?t.executeDelete(e):t._getFailedQosData()}):r.default.wrap(this._getFailedQosData())};t.prototype.getDeleteExecutionInfo=function(e){return null};t.prototype.executeDelete=function(e){var t=this,n=this.getDeleteExecutionInfo(e);return(n.title?this._getConfirmationDialog(n):r.default.wrap()).then(function(){return t._executeDelete(e,n)})};t.prototype._getFailedQosData=function(){return{resultType:a.ResultTypeEnum.Failure,extraMetrics:{count:0}}};t.prototype._executeDelete=function(e,t){var n=this;this.selectionHelper.clearSelection();return this.resources.consumeAsync(h.typeResourceKey).then(function(r){var i=new r({items:e,deletionType:t.type,allowUndo:t.allowUndo,emptyRecycleBin:t.emptyRecycleBin,parentKey:n.currentItem.key});n.trackPromise(i.start());return i.wait()}).then(function(){var n={deletionType:u.default[t.type]},r={count:e.length};if(1===e.length){n.fileType=o.default[e[0].type];n.extension=e[0].extension||""}return{resultType:a.ResultTypeEnum.Success,extraData:n,extraMetrics:r}})};t.prototype._getConfirmationDialog=function(e){return this.dialogProvider.requestDialog({title:e.title,component:{name:c.default.tagName,params:{text:e.text}},actions:[{name:f.default.DeleteItem,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new i.default("Delete"),isDefault:!1},{name:f.default.cancelActionText,execute:function(){return r.default.wrap(3)},isAvailable:this.observables.create(!0),icon:new i.default("Cancel"),isDefault:!0}],focusOnPrimaryAction:!0}).wait()};return t})(s.default);t.default=p});
define("odsp-next/actions/delete/DeleteItemsOperator",["require","exports","tslib","../../models/task/Task","../../models/task/TaskObserver","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/fileSystem/FileSystemProvider","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._fileSystemProvider=n.fileSystemProvider;r._context=t;r.registerActions({undo:r._onUndo,deleteLocked:r._onDeleteLocked});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input.item;n.name=r.name;n.iconName=r.iconName;n.type=2===t.input.type?o.default.restoreItems:o.default.deleteItems;n.payloads.deleteItems={item:r,parent:r.parent};n.payloads.restoreItems={item:r};this._context.allowUndo&&this._canUndoItem(r)&&0===t.input.type&&1===t.status&&n.actions.push(this._onUndo);2===t.status&&t.error&&9001===t.error.code&&n.actions.push(this._onDeleteLocked);return n};t.prototype.onStart=function(e){var t=this._context.deletionType===a.default.PermanantDelete?1:0,n=this._context.overrideLock,i=this._context.items.map(function(e){return new r.default(e.key,{item:e,type:t,isOverride:n})});e.update(i);return this._fileSystemProvider.deleteItems({items:this._context.items,deletionType:this._context.deletionType,overrideLock:n,parentKey:this._context.parentKey,emptyRecycleBin:this._context.emptyRecycleBin},c(e,t,n))};t.prototype._canUndoItem=function(e){return!e.isAlbum};t.prototype._onDeleteLocked=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:e.type,isOverride:!0}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.deleteItems({items:e.map(function(e){return e.input.item}),deletionType:this._context.deletionType,overrideLock:!0,parentKey:this._context.parentKey},c(t,r,i))};t.prototype._onUndo=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:2,isOverride:!1}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.restoreItems({items:e.map(function(e){return e.input.item}),parentKey:this._context.parentKey,retainAcls:!0},c(t,r,i))};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{fileSystemProvider:u.resourceKey});return t})(s.default);t.default=l;function c(e,t,n){return i.default.map(e,function(e){return e.changeInput(function(e){return{item:e,type:t,isOverride:n}})})}t.typeResourceKey=f.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/actions/download/odc/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../DownloadExecutor","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer","../../../utilities/features/Features","../../../actions/odc/DownloadAction.resx","../../../resources/ODCResourceKeys","../../../models/item/ItemType","@ms/odsp-utilities/lib/object/ObjectUtil","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-datasources/lib/utilities/permissions/Identity","cookies","../../../controls/downloadAsZip/DownloadAsZip"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=window.FilesConfig,g=m&&m.df?"s":"p",y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(f.urlDataSource);n._identityDataSource=n.resources.consume(h.identity);return n}t.prototype.execute=function(t,n){var i=this;return this.selectionHelper.resolveSelection().then(function(s){if(s){var o=i._urlDataSource.getAuthKeyParamValue(),a=s.length>1||s[0].type===l.default.Folder;n.data.extraData||(n.data.extraData={});if(a&&u.isFeatureEnabled(u.DownloadAsZip)&&!i.isOneDriveWinApp){var f="",y=0,b=0,w=s.filter(function(e){return e}).map(function(e){if(e){var t=e.type===l.default.Folder;t&&b++;e.type===l.default.OneNote&&y++;var n=i._getDownloadUrl(e,t,o);f+=n;return{name:e.name+e.extension,size:e.size,docId:n,isFolder:t}}});c.extend(n.data.extraData,{oneNotesCount:y,filesCount:s.length-b,foldersCount:b});if(!w)return;var E=m&&m.appId,S="https://southcentralus1-media"+g+".svc.ms​​​/transform/zip?cs=V2VifE9EQw==";return e.prototype.executeVroomDownload.call(i,{itemsData:w,docIds:f,zipApiUrl:S,provider:"url",method:"POST",appId:E,loggingEvent:n})}if(a||(s[0].vault||!u.isFeatureEnabled(u.VroomSingleFileDownload))&&!i.isOneDriveWinApp)return e.prototype.execute.call(i,t,n);var x=s[0].name+s[0].extension;(i.isOneDriveWinApp?r.default.resolve(i._getDownloadUrl(s[0],!1,o)):r.default.resolve(i.resources.consumeAsync(h.graph).then(function(e){var t="SingleFileDownload",n=!!v.get("BadgerAuth");n&&(t+=".PasswordProtected");return e.getDownloadUrl(s[0],{useDirectEndpoint:!0,apiName:t,qosExtraData:{isAuthenticated:i._identityDataSource.getIdentity().type!==d.IdentityType.anonymous,isPasswordProtected:n,fileExtension:s[0].extension||""}})}))).then(function(t){return e.prototype.executeVroomDownload.call(i,{itemsData:null,docIds:t,zipApiUrl:t,provider:"",method:"Get",appId:"",loggingEvent:n,fileDisplayName:x||""})}).catch(function(r){p.default.log(r);return e.prototype.execute.call(i,t,n)})}})};t.prototype.onPreDownloadItems=function(e){if(1===e.length&&e[0].type!==l.default.Folder)return r.default.wrap(!0);for(var t=0,n=0,i=e.length;n<i&&t<107374182400;n++)e[n]&&(t+=e[n].size);if(t>=107374182400){this.resources.consume(s.resourceKey).requestDialog({title:a.default.NewSizeLimitError,component:{name:o.default.tagName,params:{text:""}}});return r.default.wrap(!1)}return r.default.wrap(!0)};t.prototype._getDownloadUrl=function(e,t,n){var r=this._urlDataSource.getApiBaseUrl(),i=e.graph&&e.graph.driveId&&e.graph.itemId?r+"/drives/"+e.graph.driveId+"/items":r+"/drive/items",s=r+"/shares",o="";if(FilesConfig.SuiteNavConfig&&FilesConfig.SuiteNavConfig.IsAuthenticated&&!n)o=i+"/"+e.id;else{var u="https://onedrive.live.com/redir?resid="+e.id;u+=n?"&authKey="+n:"";o=s+"/u!"+(o=window.btoa(u).replace("=","").replace("+","-").replace("/","_"))+"/root"}return o+(t?"":"/content")};return t})(i.default);t.default=y});
define("odsp-next/actions/download/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/dialog/DialogProvider","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../providers/hiddenDom/HiddenDomProvider","../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/features/Features","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/guid/Guid","../../providers/pushChannel/PushChannelProvider.key","../../providers/oAuthToken/OAuthTokenProvider","../../dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key","../../utilities/browser/WebViewDetector","../../providers/winApp/communication/WinAppCommunicator.key","@ms/utilities-error/lib/ApiError","../../models/winApp/communication/IWinAppCommunicator"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.downloadItemsOperatorTypeResourceKey=new d.ResourceKey({name:e("module").id,loader:new d.AliasResourceLoader(function(){return r.default.resolve(new Promise(function(t,n){e(["./DownloadItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var x=(function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n._sessionManagementProvider=n.resources.consume(c.resourceKey.optional);n._platform=n.resources.consume(f.platformDetection);n._oAuthTokenProvider=n.resources.consume(g.resourceKey.optional);n._navigation=n.resources.consume(h.navigation);n._hiddenDomProvider=n.resources.consume(l.resourceKey);n.selectionHelper=t.selectionHelper;n.currentItem=t.currentItem;n.dialogProvider=n.resources.consume(u.resourceKey);n.isOneDriveWinApp=b.isOneDriveWinApp();return n}i.prototype.execute=function(e,t){var n,i=this,u=this.selectionHelper.selection;n={items:u.peek().map(function(e){return e.peek()})};return this.onPreDownloadItems(n.items).then(function(e){if(e){if(i.isOneDriveWinApp){1===n.items.length&&n.items[0].type!==s.default.Folder?i.resources.consumeAsync(a.download).then(function(e){var t=n.items[0];e.getDownloadUrl(t,{downloadType:0}).then(function(e){i.resources.consumeAsync(w.resourceKey).then(function(n){var r={command:"Download",type:S.WinAppDownloadType.DownloadSingleFile,downloadUrl:e,zipFileName:t.displayName};n.sendCommand({command:JSON.stringify({DownloadCommand:r})})})})}):i.resources.consumeAsync(a.download).then(function(e){e.getDownloadZipRequest(n).then(function(e){i.resources.consumeAsync(w.resourceKey).then(function(t){t.sendCommand({command:e})})})});return{resultType:o.ResultTypeEnum.Success}}return i.resources.consumeAsync(a.download).then(function(e){return e.downloadItems(n).then(function(){var e={},t={count:n.items.length};if(1===n.items.length){e.fileType=s.default[n.items[0].type];e.extension=n.items[0].extension||""}return{resultType:o.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})})}return r.default.wrap({resultType:o.ResultTypeEnum.ExpectedFailure})})};i.prototype.executeVroomDownload=function(e){var t=this,n=e.itemsData,r=e.docIds,s=e.zipApiUrl,o=e.provider,u=(e.method,e.appId),a=(e.loggingEvent,e.fileDisplayName);if(!(i.doc_ids===r&&Date.now()-i.last_download<5e3)){i.last_download=Date.now();i.doc_ids=r;var f=function(){return t._doDownload(n,r,s,o,null,null,u,a||"")};if(n&&-1!==n[0].docId.indexOf("access_token")||"spo"===o&&this._oAuthTokenProvider)try{return this.resources.consumeAsync(y.resourceKey).then(function(e){return e.getMicroServiceEndPoints("media")}).then(function(e){return t._oAuthTokenProvider.getToken(e,!0)}).then(function(e){return t._doDownload(n,r,s,o,null,e,u,a||"")},f)}catch(e){return f()}return this._sessionManagementProvider.getToken().then(function(e){return t._doDownload(n,r,s,o,e,null,u,a||"")},function(e){if(e instanceof E.ApiError&&"unauthUser"===e.code)return f()})}};i.prototype.onPreDownloadItems=function(e){return r.default.wrap(!0)};i.prototype._doDownload=function(e,t,n,r,i,s,o,u){return e?this._completeDownloadasZip(e,n,r,i,s,o):this._completeDownloadFile(n,i,u)};i.prototype._completeDownloadFile=function(e,t,n){e+=t?"?access_token="+t.accessToken:"";this.isOneDriveWinApp&&this.resources.consumeAsync(w.resourceKey).then(function(t){var r={command:"Download",type:S.WinAppDownloadType.DownloadSingleFile,downloadUrl:e,zipFileName:n};t.sendCommand({command:JSON.stringify({DownloadCommand:r})})});if(this._platform.isMobile){this._navigation.navigateTo({url:e,frameId:"_self"});return r.default.wrap({resultType:o.ResultTypeEnum.Success})}if(this._platform.isIE){this._downloadForIE("od-download-tab",e);return r.default.wrap({resultType:o.ResultTypeEnum.Success})}var i=Math.random(),s=this._getDownloadIframe(i);document.body.appendChild(s);s.src=e;this.async.setTimeout(function(){s.remove()},2e4);return r.default.wrap({resultType:o.ResultTypeEnum.Success})};i.prototype._completeDownloadasZip=function(e,n,r,s,u,a){var f=this;i.zip_count++;var l=v.default.generate(),c="OneDrive_"+i.zip_count+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";e&&1===e.length&&(c=e[0].name+".zip");return this.resources.consumeAsync(m.resourceKey.optional).then(function(i){var h,d=i&&i.getNotificationUrl()||"";d&&p.isFeatureEnabled(p.DownloadNotifications)&&f.resources.consumeAsync(t.downloadItemsOperatorTypeResourceKey).then(function(e){var t=new e({items:[],guid:l,zipFileName:c});f.trackPromise(t.start());t.wait()});var v=2e4;if(f._platform.isIE){h=f._downloadForIE("od-download-tab");v=5e3}if(f.isOneDriveWinApp){var m={files:JSON.stringify({items:e}),notificationUrlValue:d,guid:l,provider:r,zipFileName:c,oAuthToken:u||"",accessToken:s&&s.accessToken||"",appId:a},g={command:"Download",type:S.WinAppDownloadType.DownloadMultiFile,downloadUrl:n,zipFileName:c,postBody:JSON.stringify({request:m})};f.resources.consumeAsync(w.resourceKey).then(function(e){e.sendCommand({command:JSON.stringify({DownloadCommand:g})})});return{resultType:o.ResultTypeEnum.Success}}var y=Math.random(),b=f._getDownloadIframe(y),E=f._hiddenDomProvider.requestControl({name:"od-downloadaszip",params:{filesValue:JSON.stringify({items:e}),notificationUrlValue:d,guid:l,formAction:n,providerValue:r,id:y,zipFileName:c,target:f._platform.isIE?"od-download-tab":b.id,oAuthToken:u||"",accessToken:s&&s.accessToken||"",appId:a||"",resources:f.resources}}),x=document.getElementById("form_download_as_zip"+y);x.parentNode.appendChild(b);x.submit();var T=f.addDisposable({dispose:function(){f._hiddenDomProvider.disposeControl(E)}});f.async.setTimeout(function(){T.dispose();h&&h.close()},v);return{resultType:o.ResultTypeEnum.Success}})};i.prototype._getDownloadIframe=function(e){var t=document.createElement("iframe");t.id="od-download-iframe"+e;t.name=t.id;t.hidden=!0;return t};i.prototype._downloadForIE=function(e,t){void 0===t&&(t="");var n;n=window.open(t,e);this.async.setTimeout(function(){n.close()},5e3);return n};i.zip_count=0;return i})(i.default);t.default=x});
define("odsp-next/providers/oAuthToken/OAuthTokenProvider",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","whatwg-fetch"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);t.oAuthTokenDataSourceKey=new i.ResourceKey({name:e("module").id+".dataSource",factory:{dependencies:{pageContext:r.pageContext},create:function(e){var t=new o.default(e.pageContext);return{instance:t,disposable:t}}}});t.resourceKey=i.createResolvedResourceKey(e("module").id,s.default,{oAuthTokenDataSource:t.oAuthTokenDataSourceKey})});
define("@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","whatwg-fetch"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(t.TokenFetchServerErrorCodes||(t.TokenFetchServerErrorCodes={}));var i=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};return e})();t.default=i});
define("whatwg-fetch",["require","exports","module"],function(e,t,n){(function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&(function(){try{new Blob;return!0}catch(e){return!1}})(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=function(e){return e&&DataView.prototype.isPrototypeOf(e)},a=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};d.prototype.append=function(e,t){e=c(e);t=h(t);var n=this.map[e];this.map[e]=n?n+","+t:t};d.prototype.delete=function(e){delete this.map[c(e)]};d.prototype.get=function(e){e=c(e);return this.has(e)?this.map[e]:null};d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))};d.prototype.set=function(e,t){this.map[c(e)]=h(t)};d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};d.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return p(e)};d.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return p(e)};d.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return p(e)};n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};b.call(w.prototype);b.call(x.prototype);x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})};x.error=function(){var e=new x(null,{status:0,statusText:""});e.type="error";return e};var l=[301,302,303,307,308];x.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})};e.Headers=d;e.Request=w;e.Response=x;e.fetch=function(e,t){return new Promise(function(n,i){var s=new w(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:S(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new x(t,e))};o.onerror=function(){i(new TypeError("Network request failed"))};o.ontimeout=function(){i(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);"include"===s.credentials&&(o.withCredentials=!0);"responseType"in o&&r&&(o.responseType="blob");s.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===s._bodyInit?null:s._bodyInit)})};e.fetch.polyfill=!0}function c(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){"string"!=typeof e&&(e=String(e));return e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};n&&(t[Symbol.iterator]=function(){return t});return t}function d(e){this.map={};e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function v(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function g(e){var t=new FileReader,n=m(t);t.readAsArrayBuffer(e);return n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function b(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&r&&u(e)){this._bodyArrayBuffer=y(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!a(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(r){this.blob=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}}this.text=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return(function(e){var t=new FileReader,n=m(t);t.readAsText(e);return n})(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve((function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")})(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};i&&(this.formData=function(){return this.text().then(E)});this.json=function(){return this.text().then(JSON.parse)};return this}function w(e,t){var n,r,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new d(e.headers));this.method=e.method;this.mode=e.mode;if(!i&&null!=e._bodyInit){i=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new d(t.headers));this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),f.indexOf(r)>-1?r:n);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function E(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function S(e){var t=new d;e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}function x(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new d(t.headers);this.url=t.url||"";this._initBody(e)}})("undefined"!=typeof self?self:this)});
define("@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource",["require","exports","tslib","../../utilities/oauthUtility/OAuthUtility","../base/DataSource","@ms/odsp-utilities/lib/async/Promise","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){this._qos=new u.default({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:u.ResultTypeEnum.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})};return e})(),f=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),l=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,{},{pageContext:t})||this;i.logger=new f;if(n){n.logger&&(i.logger=n.logger);n.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}i._oAuthUtility=new r.default(i);return i}t.prototype.qosMonitor=function(){return new a};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:o.getSafeWebServerRelativeUrl(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new s.default(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(i.default);t.default=l});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/OAuthUtility",["require","exports","./Constants","./OAuthUtilityError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var r=this;this._receiveMediaServiceFlushedToken();var i=this._getCachedTokenData(e);if(i&&!this._isExpiring(i)){var s={token:i.accessToken,isGuest:!1,expirationTimeMs:i.expiresOn};return Promise.resolve({tokenInfo:s,spRequestId:i.correlationId,spRequestTimestamp:i.requestTimestamp})}return this._retriableFetchWithDigest(e,n.default.retries,t).then(function(t){r._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,o=this._context.qosMonitor(),u=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(a){if(200!==a.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+a.statusText);var f=new r.default(r.OAuthUtilityErrorType.unknownError,{httpResponseStatus:a.status,message:a.statusText,correlationId:e._getCorrelationId(a)});if(400!==a.status){o.writeUnexpectedFailure("UnknownError",f);return Promise.reject(f)}return a.json().then(function(r){var u=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(u);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(u);o.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(a,o,u)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",n.default.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<n.default.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==n.default.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var r=new Headers;r.append("Content-Type","application/json; charset=utf-8");r.append("Odata-Version","4.0");r.append("Accept","application/json;odata.metadata=minimal");var i={method:"POST",headers:r,body:JSON.stringify(this._buildRequestBody(e))},s=t;s&&s.lastIndexOf("/")===s.length-1&&(s=s.substr(0,s.length-1));return new Request(s+n.default.apiUrl,i)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,i,s=this._getErrorCodeFromResponseCode(e);if(void 0===s)return new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:400,message:n.default.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;i=e.message.lang}return new r.default(r.OAuthUtilityErrorType.serverError,{httpResponseStatus:400,message:t,cultureName:i,serverErrorCode:s,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,i,s){try{return t.json().then(function(n){i.writeSuccess();return{accessToken:n.access_token,expiresOn:Number(n.expires_on),notBefore:Number(n.not_before),resource:n.resource,tokenType:n.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:s}})}catch(s){i.writeUnexpectedFailure("ResponseParseError",s);return Promise.reject(new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:200,message:n.default.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})();t.default=i});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/Constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();t.default=n});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/OAuthUtilityError",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r=t.OAuthUtilityErrorType||(t.OAuthUtilityErrorType={}));var i=(function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error);t.default=i});
define("odsp-next/dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource","@ms/odsp-utilities/lib/resources/Resources","../../resources/SPOResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}return t})(r.default);t.resourceKey=i.createResolvedResourceKey(e("module").id,o,{pageContext:s.pageContext})});
define("@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource",["require","exports","tslib","../base/DataSource"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){return e.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:t})||this}t.prototype.getMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})};t.prototype.getAllMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetAllServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results})};return t})(r.default);t.default=i});
define("odsp-next/controls/downloadAsZip/DownloadAsZip",["require","exports","./DownloadAsZip.html","./DownloadAsZipViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-downloadaszip",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/downloadAsZip/DownloadAsZip.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div id="od-Download-As-Zip" class="od-DownloadAsZip"><form class="DownloadAsZipForm" name="form_download_as_zip" data-bind="attr:{action:formAction,target:target,id:id,method:method}"><input id="download_input_1" name="provider" type="hidden" data-bind="value:providerValue"><input id="download_input_2" name="guid" type="hidden" data-bind="value:guid"><input id="download_input_3" name="files" type="hidden" data-bind="value:filesValue"><input id="download_input_4" name="notificationUrl" type="hidden" data-bind="value:notificationUrlValue"><input id="download_input_5" name="accessToken" type="hidden" data-bind="value:accessToken"><input id="download_input_6" name="zipFileName" type="hidden" data-bind="value:zipFileName"><input id="download_input_7" name="oAuthToken" type="hidden" data-bind="value:oAuthToken"><input id="download_input_8" name="appId" type="hidden" data-bind="value:appId"></form></div>'});
define("odsp-next/controls/downloadAsZip/DownloadAsZipViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.formAction=t.formAction;n.filesValue=t.filesValue;n.providerValue=t.providerValue;n.id="form_download_as_zip"+t.id;n.notificationUrlValue=t.notificationUrlValue;n.accessToken=t.accessToken;n.zipFileName=t.zipFileName;n.target=t.target;n.oAuthToken=t.oAuthToken;n.guid=t.guid;n.method=t.method||"Post";n.appId=t.appId;return n}return t})(r.default);t.default=i});
define("odsp-next/actions/download/DownloadItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/pushChannel/IPushChannelProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../providers/pushChannel/PushChannelProvider.key","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;(function(e){e[e.Success=0]="Success";e[e.RemoteHostClosedConnection_HttpException=1]="RemoteHostClosedConnection_HttpException";e[e.FileAndFolderDownloadError=2]="FileAndFolderDownloadError";e[e.FolderDownloadError=3]="FolderDownloadError";e[e.FileDownloadError=4]="FileDownloadError"})(l=t.ZipPayloadErrorCode||(t.ZipPayloadErrorCode={}));var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._pushChannelProvider=n.pushChannelProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=s.default.downloadAsZip;var r=t.input;n.name=r.name;t.output&&t.output.current>=0&&(n.progress={current:t.output.current,minimum:0,maximum:t.output.maximum});n.payloads={downloadAsZip:{fileName:this._context.zipFileName}};f.isOneDriveWinApp()&&(n.visibility=2);return n};t.prototype.onStart=function(e){var t=this;if(!this._pushChannelProvider)return o.default.wrap();var n=new r.Task("OverAllProgress",{key:this._context.guid}),s=[n=n.changeOutput(function(e){return{zipFileName:t._context.zipFileName}})];e.update(s);this._pushChannelProvider.setupNotificationHandler({source:i.NotificationSource.Meta,scenarios:[i.NotificationScenario.Zip],id:this._context.guid},function(n){if("ZipProgress"===n.type&&s&&t._context.guid===n.guid){s=s.map(function(e){if("OverAllProgress"===e.key){e=e.changeOutput(function(e){return{current:n.filesProcessed,maximum:n.totalFiles,zipFileName:t._context.zipFileName}});n.isComplete&&n.errorCode===l[l.RemoteHostClosedConnection_HttpException]?e=e.cancel():n.isComplete&&(e=e.succeed())}return e});e.update(s)}});return o.default.wrap()};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{pushChannelProvider:a.resourceKey.optional});return t})(r.default);t.default=c;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/actions/embed/odc/EmbedExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","./EmbedHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._helper=new(n.managed(s.default));n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){return e._helper.shareItem(t)})})};return t})(r.default);t.default=o});
define("odsp-next/actions/embed/odc/EmbedHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/SharingType","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../../providers/panel/PanelProvider","../../../controls/embedBuilder/EmbedBuilder","../../../providers/dialog/DialogProvider","../../../controls/embedBuilder/EmbedBuilder.resx","../../../controls/textContainer/TextContainer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(u.urlDataSource);n._dialogProvider=n.resources.consume(h.resourceKey);n._panelProvider=n.resources.consume(l.resourceKey);return n}t.prototype.shareItem=function(e){return e.isSpecialFolder&&e.sharingType!==o.default.Public?this._showWarningDialog(e):this._showEmbedDialog(e)};t.prototype._showWarningDialog=function(e){var t=this,n={text:p.default.specialFolderConfirmText},s=this._dialogProvider.requestDialog({title:p.default.specialFolderConfirmTitle,size:"Medium",component:{name:d.default.tagName,params:n},actions:[{name:p.default.specialFolderConfirmButton,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new i.default("Embed"),isDefault:!1}]});return s.wait().then(function(){2===s.state()&&t._showEmbedDialog(e);return{resultType:a.ResultTypeEnum.Success}})};t.prototype._showEmbedDialog=function(e){var t=f.format(p.default.title,e.name),n={item:e,embedPageUrl:this._urlDataSource.getEmbedPageUrl(e)};return this._panelProvider.requestPanel({title:t,component:{name:c.default.tagName,params:n}}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};return t})(s.default);t.default=v});
define("odsp-next/controls/embedBuilder/EmbedBuilder",["require","exports","./EmbedBuilder.html","./EmbedBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-embed-builder",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/embedBuilder/EmbedBuilder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="EmbedBuilder" data-bind="css:featureCssWrapperClass">\x3c!--ko if:isLoading--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerComponentTag,params:loadingSpinnerComponentParams}"></span>\x3c!--/ko--\x3e\x3c!--ko if:isHandlingError()--\x3e<div class="od-embed-error"><p class="od-embed-disclaimer ms-font-m ms-fontColor-neutralSecondary" data-bind="text:embedErrorText"></p></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e\x3c!--ko if:!isHandlingError()--\x3e<div class="od-embed-preview">\x3c!--ko if:!embedCode()--\x3e<img data-bind="attr:{src:embedIconImgSrc}" class="od-embed-generateIcon" tabindex="-1">\x3c!--/ko--\x3e\x3c!--ko if:embedCode()--\x3e\x3c!--ko if:!isPicture()--\x3e<iframe data-bind="attr:{src:iframeSrc},style:{width:previewWidth()+\'px\',height:previewHeight()+\'px\'}" tabindex="-1" frameborder="0" scrolling="no"></iframe>\x3c!--/ko--\x3e\x3c!--ko if:isPicture()--\x3e<img data-bind="attr:{src:photoUrl},style:{width:previewWidth()+\'px\',height:previewHeight()+\'px\'}" tabindex="-1">\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-embed-details">\x3c!--ko if:!embedCode()--\x3e<p class="od-embed-instructions" data-bind="text:instructionsText,css:{\'ms-font-l\':!isFluentEnabled}"></p><button class="od-Button od-embed-button od-Button--primary" data-bind="click:onGenerateClicked"><span class="od-Button-label" data-bind="text:generateText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:embedCode()--\x3e\x3c!--ko if:isPicture()--\x3e<div class="od-embed-pictureOptions"><h2 class="od-embed-imageSize ms-font-l" data-bind="text:imageSizeText"></h2><div><select class="od-embed-sizePicker" data-bind="options:imageSizes,optionsText:\'name\',value:selectedImageSize"></select></div><div class="od-embed-htmlTagsBox od-CheckBox"><input type="checkbox" class="od-embed-htmlTagsCheckbox od-CheckBox-input" id="od-embed-htmlTagsBox" data-bind="checked:htmlTagsOn"><label class="ms-font-m ms-fontColor-neutralSecondary od-CheckBox-field" for="od-embed-htmlTagsBox" data-bind="css:{\'is-checked\':htmlTagsOn}"><span class="od-Label" data-bind="text:htmlTagsText"></span></label></div><h2 class="od-embed-copyText ms-font-l"><span data-bind="text:copyText"></span><div class="od-embed-updateSpinner ms-font-m" data-bind="css:{\'od-embed-updateSpinnerOn\':isEmbedCodeUpdating},component:{name:loadingSpinnerComponentTag,params:updateSpinnerComponentParams}"></div></h2></div>\x3c!--/ko--\x3e<div class="od-TextField od-TextField--multiline"><textarea class="od-TextField-field" readonly aria-live="polite" data-bind="value:embedCodeDisplayed,selectOnFocus:{isPermanent:true},autoResizeHeight:{enabled:true,elementContents:embedCodeDisplayed,additionalPadding:2}"></textarea></div>\x3c!--/ko--\x3e<p class="od-embed-disclaimer ms-fontColor-neutralSecondary" data-bind="text:disclaimerText,css:{\'ms-font-m\':!isFluentEnabled,\'ms-font-s\':isFluentEnabled}"></p>\x3c!--ko if:configuratorUrl()--\x3e<p><a class="od-embed-configurator" target="_blank" data-bind="text:configuratorText,attr:{href:configuratorUrl},click:reportConfiguratorUsage.bind($data,embedConfiguratorClickUsageName)"></a></p>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/embedBuilder/EmbedBuilderViewModel",["require","exports","tslib","knockout","./EmbedBuilder.resx","../../providers/sharing/SharingProvider","../../utilities/icons/OfficeFileNameHelper","../../resources/ProviderResourceKeys","../../utilities/browser/ResponsiveUI","../../bindings/focus/SelectOnFocusBinding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/autoResizeHeight/AutoResizeHeightBinding","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/uri/Uri","../../models/item/ItemType","../loadingSpinner/LoadingSpinner","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){this.name=e.name;this.maxDim=e.maxDim;this.isOriginalSize=e.isOriginalSize};t.EmbeddedImageSize=w;var E=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n._embedPageUrl=t.embedPageUrl;n._thumbnailSizes=null;n._thumbnails=null;n.isFluentEnabled=n.resources.consume(b.resourceKey);n._sharingProvider=n.resources.consume(s.resourceKey);n._embedProvider=n.resources.consume(u.embed);n._responsiveUI=n.resources.consume(a.resourceKey);n._thumbnailProvider=n.resources.consume(u.thumbnail);n._instrumentationProvider=n.resources.consume(u.instrumentation);n.isLoading=r.observable(!0);n.isHandlingError=r.observable(!1);n.isPicture=r.observable(!1);n.photoUrl=r.observable("");n.iframeSrc=r.observable("");n.embedIconImgSrc=window.require.toUrl("odsp-media/images/embedpanel/embed.svg");n.embedCode=r.observable("");n.embedCode.subscribe(n.onEmbedCodeChange.bind(n));n.embedCodeDisplayed=r.observable("");n.configuratorUrl=r.observable("");n.embedConfiguratorClickUsageName=d.UsageName.EmbedConfiguratorClick;n.featureCssWrapperClass="od-embed-useModernEmbedPanel";n.htmlTagsOn=r.observable(!1);n.htmlTagsOn.subscribe(n.onHtmlTagsClicked.bind(n));n.previewWidth=r.observable(n._getPreviewWidth());n.previewHeight=r.observable(n._getPreviewHeight());n.instructionsText=r.observable("");n.generateText=i.default.generate;n.disclaimerText=i.default.disclaimer;n.loadingText=i.default.loading;n.embedErrorText=i.default.error;n.configuratorText=i.default.configurator;n.imageSizeText=i.default.imageSizeLabel;n.copyText=i.default.embedTextLabel;n.loadingSpinnerComponentTag=y.default.tagName;n.loadingSpinnerComponentParams={loadingText:n.loadingText};n.updateSpinnerComponentParams={loadingText:""};var o=0,l=!0;if(n._item.photo)if(n._item.photo.width>n._item.photo.height){o=n._item.photo.width;l=!0}else{o=n._item.photo.height;l=!1}n._populateImageSizes(o,l);n.selectedImageSize.subscribe(n.onImageSizeChange.bind(n));n.htmlTagsText=i.default.includeHTMLTags;n.isEmbedCodeUpdating=r.observable(!1);n._embedCodeUpdatingSpinnerTimeout=-1;n._getEmbedInfo();n.addBindingHandlers({selectOnFocus:f.default,autoResizeHeight:h.default});return n}t._getThumbnailSizeForMaxDim=function(e,t){return t?{width:e}:{height:e}};t._getEmbedCode=function(e,t){return t?'<img src="'+e.url+'" width="'+e.width+'" height="'+e.height+'" />':e.url};t.prototype.onGenerateClicked=function(){var e=this;this.isLoading(!0);this.isHandlingError(!1);this._sharingProvider.manageSharingLinks([this._item],{type:3,role:1,create:!0}).then(function(){e._getEmbedInfo()},function(){e.isLoading(!1);e.isHandlingError(!0)})};t.prototype.onImageSizeChange=function(e){this._updateEmbedCode(e,this.htmlTagsOn(),!0)};t.prototype.onHtmlTagsClicked=function(e){this._updateEmbedCode(this.selectedImageSize(),e,!1)};t.prototype.onEmbedCodeChange=function(){-1!==this._embedCodeUpdatingSpinnerTimeout&&this.async.clearTimeout(this._embedCodeUpdatingSpinnerTimeout);this.isEmbedCodeUpdating(!0);this.embedCodeDisplayed("");this._embedCodeUpdatingSpinnerTimeout=this.async.setTimeout(function(){this.embedCodeDisplayed(this.embedCode());this.isEmbedCodeUpdating(!1)},500)};t.prototype.reportConfiguratorUsage=function(e){p.default.logData({name:d.UsageName[e],location:d.LocationName[d.LocationName.EmbedPane],usageType:v.UsageType[v.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!0};t.prototype._updateEmbedCode=function(e,n,r){var i=this._item.photo;if(i&&this._thumbnails){var s=null,o=i.width>i.height;s=e.isOriginalSize?this._thumbnailProvider.getThumbnailForSize(this._thumbnails,i.width,i.height):this._thumbnailProvider.getThumbnailForLargestDimension(this._thumbnails,e.maxDim,o);this.embedCode(t._getEmbedCode(s,n));if(r){this.photoUrl(s.url);var u=this._getPreviewWidth(),a=this._getPreviewHeight();this.previewWidth(Math.min(u,s.width));this.previewHeight(Math.min(a,s.height))}}};t.prototype._getPreviewWidth=function(e){var t=165,n=this._item.photo||this._item.video,r=this.isFluentEnabled?292:320;if(n)t=n.width>n.height?Math.min(n.width,r):n.height<r?n.width:Math.floor(r*(n.width/n.height));else if(this._item.appMap&&e)switch(this._item.appMap){case o.wordType:case o.excelType:case o.powerpointType:case o.visioType:t=r}var i=this._responsiveUI.formFactorSize();t>300&&"Small"===i&&(t=300);return t};t.prototype._getPreviewHeight=function(e){var t=150,n=this._item.photo||this._item.video;if(n)t=n.height>n.width?Math.min(n.width,320):n.width<320?n.height:Math.floor(n.height/n.width*320);else if(this._item.appMap&&e)switch(this._item.appMap){case o.wordType:t=288;break;case o.excelType:t=346;break;case o.powerpointType:case o.visioType:t=327}var r=this._responsiveUI.formFactorSize();t>300&&"Small"===r&&(t=300);return t};t.prototype._getEmbedInfo=function(){var e=this,t=this._getItemType();this._embedProvider.getEmbedInfo(this._item).then(function(n){if(e._item.type===g.default.Media&&e._item.photo)if(n){e.isPicture(!0);e.previewWidth(e._getPreviewWidth(!0));e.previewHeight(e._getPreviewHeight(!0));e._thumbnailProvider.getThumbnails(e._item.graph,e._thumbnailSizes,e._getAuthKeyFromEmbedUrl(n.embedUrl)).then(function(t){e.isLoading(!1);e._thumbnails=t;e._updateEmbedCode(e.selectedImageSize(),e.htmlTagsOn(),!0)})}else{e.isLoading(!1);e.instructionsText(i.default["generateInstructions"+t])}else{e.isLoading(!1);if(n){e.embedCode(n.embedCode);n.embedUrl&&e.iframeSrc(n.embedUrl);if(n.configuratorUrl){e.configuratorUrl(n.configuratorUrl);e.reportConfiguratorUsage(d.UsageName.EmbedConfiguratorLinkShown)}e.previewWidth(e._getPreviewWidth(!0));e.previewHeight(e._getPreviewHeight(!0))}else{e.instructionsText(i.default["generateInstructions"+t]);e.iframeSrc(e._embedPageUrl)}}})};t.prototype._getAuthKeyFromEmbedUrl=function(e){return new m.default(e).getQueryParameter("authkey")};t.prototype._getItemType=function(){var e="File";this._item.photo?e="Photo":this._item.isAlbum?e="Album":this._item.folder&&(e="Folder");return e};t.prototype._populateImageSizes=function(e,n){var s=[];this._thumbnailSizes=[];var o=this._item.photo?c.format(i.default.imageSizeOriginal,e):null;s.push(new w({name:o,maxDim:e,isOriginalSize:!0}));this._item.photo&&this._thumbnailSizes.push(this._item.photo);for(var u=0;u<t.DEFUALT_EMBEDDED_IMAGES_SIZES.length;u++){var a=t.DEFUALT_EMBEDDED_IMAGES_SIZES[u];if(a.maxDim<e){s.push(a);this._thumbnailSizes.push(t._getThumbnailSizeForMaxDim(a.maxDim,n))}}this.imageSizes=r.observable(s);this.selectedImageSize=r.observable(this.imageSizes()[0])};t.DEFUALT_EMBEDDED_IMAGES_SIZES=[{name:i.default.imageSizeLarge,maxDim:1024,isOriginalSize:!1},{name:i.default.imageSizeMedium,maxDim:660,isOriginalSize:!1},{name:i.default.imageSizeSmall,maxDim:256,isOriginalSize:!1}];return t})(l.default);t.default=E});
define("odsp-next/bindings/autoResizeHeight/AutoResizeHeightBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.update=function(e,t,r,i,s){var o=n.utils.unwrapObservable(t());if(o.enabled){n.utils.unwrapObservable(o.elementContents);e.style.height="1px";var u=e.scrollHeight;o.additionalPadding&&(u+=o.additionalPadding);e.style.height=u+"px"}};return e})();t.default=r});
define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor",["require","exports","tslib","../../../resources/ODCResourceKeys","../../delete/odc/DeleteExecutor","./EmptyRecycleBinHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._usePollGetItemsForDeletion=t.usePollGetItemsForDeletion;n._recycleBinItemDataSource=n.resources.consume(r.recycleBinDataSource);n._emptyRecycleBinHelper=new(n.managed(s.default));return n}t.prototype.execute=function(t){if(this._usePollGetItemsForDeletion){if(!this.currentItem||this._recycleBinItemDataSource.isLargeRecycleBin())return this._emptyRecycleBinHelper.emptyAll();this.selectionHelper.selectAll();return e.prototype.execute.call(this,t)}return this._emptyRecycleBinHelper.emptyAllAsync()};t.prototype.getDeleteExecutionInfo=function(t){var n=e.prototype.getDeleteExecutionInfo.call(this,t);n.emptyRecycleBin=!0;return n};return t})(i.default);t.default=o});
define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ItemRedeemer","./LaunchMoveCopyPanelHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._isMove=t.isMove;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(i.resourceKey);n._launchMoveCopyPanelHelper=new(n.managed(s.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){return e._launchMoveCopyPanelHelper.launchPanel(t,e._isMove)})})};return t})(r.default);t.default=o});
define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../controls/folderSelect/FolderSelect","../../controls/folderTree/FolderTree","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/panel/PanelProvider","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/list/ShortcutUtilities","../../resources/DataSourceResourceKeys","../../controls/commands/Commands.resx","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(c.url);n._panelProvider=n.resources.consume(a.resourceKey);n._engagement=n.resources.consume(f.resourceKey);n._selectionHelper=new(n.child(p.typeResourceKey))({canFallback:!1,allowMultiSelect:!0});return n}t.prototype.launchPanel=function(e,t){this._logEngagement(e,t);var n=this._selectionHelper.currentItem.peek(),r=this.observables.create({items:e,parentKey:n.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:n.isGroup?1:0,isAsync:!1,isMove:t}),a=t?h.default.moveItemDialogTitle:h.default.copyItemDialogTitle,f=t?h.default.moveItemsDialogTitle:h.default.copyItemsDialogTitle,l=1===e.length?a:f,c=i.isFeatureEnabled(i.MoveCopyFolderSelectionUX),p=c?s.default.tagName:o.default.tagName,d=c?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";d+=t?".Move":".Copy";this._engagement.logData({name:d,extraData:{ItemCount:null!==e?e.length:0}});var v=this._panelProvider.requestPanel({hasCommandBar:!c,scrollMode:c?"hidden":"auto",noTitle:!0,title:l,component:{name:p,params:{context:r,onComplete:function(){v.state(1)},title:l,resources:this.resources}}});return v.wait().then(function(){return{resultType:u.ResultTypeEnum.Success}})};t.prototype._logEngagement=function(e,t){var n=this._engagement,r=e.filter(function(e){return l.default.isShortcutItem(e)}).length;r>0&&(t?n.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:r}}):n.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:r}}))};return t})(r.default);t.default=d});
define("odsp-next/controls/folderSelect/FolderSelect",["require","exports","./FolderSelect.html","./FolderSelectContent.html","./FolderSelectViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../overlays/anchor/AnchorOverlay","../fileNameWithIcon/FileNameWithIcon"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.registerComponent({tagName:"ms-folder-select",template:n.default,viewModel:i.default,synchronous:!0});s.registerTemplate("od-folder-select-content",r.default);t.default=o});
define("odsp-next/controls/folderSelect/FolderSelect.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FolderSelect-panel"><div class="od-FolderSelect-region"><h1 class="od-FolderSelect-title" data-bind="text:moveCopyText"></h1><div class="od-FolderSelect-title-fileInfo">\x3c!--ko if:isSingleItem--\x3e\x3c!--ko component:{name:\'ms-fileName-with-icon\',params:{oneDriveItem:fileItem}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:packageTooBig--\x3e<div class="od-FolderSelect-infoBar" data-bind="css:{\'od-FolderSelect-infoBarClickable\':showMinimalPackageWarning},component:{name:infoBarTagName,params:infoBarParams},click:onInfoBarClick"></div><div class="ms-accessible" aria-live="polite" data-bind="text:packageSizeWarning"></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-breadCrumbContainer"><span class="od-FolderSelect-breadCrumbRootIcon od-FolderSelect-clickableCrumb" role="button" data-bind="click:onBreadCrumbRootClick,keyboard:{mappings:{Enter:onBreadCrumbRootClick,Space:onBreadCrumbRootClick}},style:{display:hasBackToRootButton()?\'\':\'none\'},attr:{title:placesAltText,tabindex:hasBackToRootButton()?0:-1,\'aria-label\':placesAltText}"><i class="ms-Icon ms-Icon--DoubleChevronLeft" data-bind="icon:true"></i></span><span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semilight" role="button" data-bind="text:parentFolderName,class:parentBreadCrumbClass,click:onBreadCrumbParentClick,keyboard:{mappings:{Enter:onBreadCrumbParentClick,Space:onBreadCrumbParentClick}},style:{display:parentFolderName()?\'\':\'none\'},attr:{title:parentFolderName,tabindex:isParentBreadCrumbClickable()?0:-1,\'aria-label\':parentFolderName}"></span><i class="od-FolderSelect-breadCrumbIcon ms-Icon ms-Icon--ChevronRight" data-bind="style:{display:parentFolderName()?\'\':\'none\'}" aria-hidden="true"></i><span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semibold" data-bind="text:currentFolderName,attr:{title:currentFolderName}"></span></div><div class="od-FolderSelect-ruledLine" aria-hidden="true"></div>\x3c!--ko if:loading--\x3e<div class="od-FolderSelect-loading" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e\x3c!--ko if:itemOne.isActive()--\x3e<div data-bind="automationType:\'FolderSelectContent\',template:{name:\'od-folder-select-content\',data:itemOne,afterRender:itemOne.resizeStickyFooter.bind(true)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:itemTwo.isActive()--\x3e<div data-bind="automationType:\'FolderSelectContent\',template:{name:\'od-folder-select-content\',data:itemTwo,afterRender:itemTwo.resizeStickyFooter.bind(true)}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:waitingForItem--\x3e<div class="od-FolderSelect-waitingForData" data-bind="component:{name:stillSpinningTagName,params:waitingForItemParams}"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/folderSelect/FolderSelectContent.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FolderSelect-itemAnimation" data-bind="class:className,element:element">\x3c!--ko if:item().error--\x3e<div class="od-folderSelect-itemError od-folderSelect-itemErrorPadding" aria-live="assertive" data-bind="text:item().error"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:item().error--\x3e\x3c!--ko if:item().sections--\x3e<div class="od-FolderSelect-itemsRegion" data-bind="element:regionElement"><div class="od-FolderSelect-sectionContainer" data-bind="foreach:item().sections">\x3c!--ko if:title--\x3e<div class="od-FolderSelect-sectionHeader" data-bind="text:title"></div>\x3c!--/ko--\x3e\x3c!--ko if:items().length>0--\x3e<div class="od-FolderSelect-itemsContainer" tabindex="0" role="list" data-bind="foreach:items,element:listElement,attr:{tabindex:focusedItem()?-1:0,\'aria-label\':altTitle},selection:{data:items,mode:\'single\',direction:\'vertical\',focused:focusedItem,selectFirstItemOnActivate:true,clearSelectionOnRemoval:true}"><div class="od-FolderSelect-itemWrapper"><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role="listitem" data-bind="click:$component.onItemClick.bind($data),keyboard:{mappings:{Enter:$component.onKeyEnter,Space:$component.onKeyEnter}},css:{\'is-focused\':focused},attr:{tabindex:focused()||selected()?0:-1,\'aria-label\':title},hasFocus:focused"><i role="presentation" class="ms-Icon ms-Icon--OneDrive" data-bind="icon:true,style:{display:$component.isOneDrive($data)?\'\':\'none\'}"></i>\x3c!--ko if:$component.isSite($data)--\x3e<span class="od-FolderSelect-siteIcon" data-bind="component:{name:$component.siteIconTagName,params:siteIcon}"></span>\x3c!--/ko--\x3e\x3c!--ko if:$component.isLibraryOrFolder($data)--\x3e<span class="od-FolderSelect-folderIcon" data-bind="component:{name:$component.fileTypeIconTagName,params:{iconName:folderIcon,desiredSize:16}}"></span>\x3c!--/ko--\x3e<span class="od-FolderSelect-itemTitle" data-bind="text:title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreInfo--\x3e<div class="od-folderSelect-itemInfo" aria-live="polite" data-bind="text:showMoreInfo"></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreError--\x3e<div class="od-folderSelect-itemError" aria-live="assertive" data-bind="text:showMoreError"></div>\x3c!--/ko--\x3e\x3c!--ko if:showMore--\x3e<div>\x3c!--ko ifnot:showMoreLoading()--\x3e<div class="od-FolderSelect-itemWrapper"><a class="od-FolderSelect-showMore od-folderSelect-showMoreExtra od-FolderSelect-clickable" role="button" tabindex="0" data-bind="click:$component.onShowMoreClick.bind($data),keyboard:{mappings:{Enter:$component.onShowMoreClick.bind($data),Space:$component.onShowMoreClick.bind($data)}},css:{\'is-focused\':showMoreFocused},hasFocus:showMoreFocused,text:$component.getShowMoreText($data),automationType:\'FolderSelectShowMoreSites\'"></a></div>\x3c!--/ko--\x3e\x3c!--ko if:showMoreLoading--\x3e<div class="od-FolderSelect-showMoreLoading" aria-busy="true" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:item().subItems--\x3e<div class="od-FolderSelect-itemsRegion" data-bind="element:regionElement">\x3c!--ko if:item().subItems().length>0--\x3e<div class="od-FolderSelect-itemsContainer" role="list" data-bind="foreach:item().subItems,element:listElement,selection:{data:item().subItems,mode:\'single\',direction:\'vertical\',focused:$component.focusedItem,selectionModel:$component.selectionModel,selectFirstItemOnActivate:true,clearSelectionOnRemoval:true},attr:{\'aria-label\':$component.getListType(item()),tabindex:$component.selectionModel.selection().length>0?-1:0},css:{\'od-FolderSelect-addBottomMargin\':!$component.showAddFolder()}">\x3c!--ko if:$index()===0--\x3e<div class="od-FolderSelect-destinationHeader" data-bind="text:$component.chooseDestination"></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-itemWrapper"><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role="listitem" data-bind="click:$component.onItemClick.bind($data),keyboard:{mappings:{Enter:$component.onKeyEnter,Space:$component.onKeyEnter}},css:{\'is-focused\':focused,\'is-selected\':selected},attr:{tabindex:focused()||selected()?0:-1,\'aria-label\':title},hasFocus:focused"><span class="od-FolderSelect-folderIcon" data-bind="component:{name:$component.fileTypeIconTagName,params:{iconName:folderIcon,desiredSize:16}}"></span><span class="od-FolderSelect-itemTitle" data-bind="text:title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.showAddFolder()--\x3e<div class="od-FolderSelect-addFolder" data-bind="css:{\'od-FolderSelect-addTopMargin\':item().subItems().length===0}"><div class="od-FolderSelect-itemWrapper" data-bind="css:{\'od-FolderSelect-hidden\':!$component.newFolderActive()}"><div class="od-FolderSelect-addFolderContainer od-FolderSelect-clickable" data-bind="component:{name:$component.inlineCreateFolderTagName,params:{item:$component.getCurrentItem().oneDriveItem,newFolderItem:$component.newFolderItem,focused:$component.addFolderFocused,newItemFocused:$component.newFolderItemFocused,isActive:$component.newFolderActive}}"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-FolderSelect-stickyFooter" data-bind="stickyFooter:{scrollableElement:regionElement,forceResize:resizeStickyFooter}">\x3c!--ko if:$component.showBottomLine(item())--\x3e<div class="od-FolderSelect-ruledLine" role="separator" aria-hidden="true"></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.getStatusText(item())--\x3e<div class="od-FolderSelect-statusLabel"><span role="status" data-bind="text:$component.getStatusText(item())"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.isLibraryOrFolderOrOneDrive(item())--\x3e<div class="od-FolderSelect-actionContainer">\x3c!--ko if:$component.showKeepSharing--\x3e<div class="od-FolderSelect-checkBox"><div class="od-FolderSelect-keepSharing" data-bind="react:{componentType:$component.keepSharingComponent,props:$component.keepSharingProps}"></div></div>\x3c!--/ko--\x3e<button class="od-Button od-Button--primary" data-bind="click:$component.onUseLocationClick,enable:$component.chooseLocationButtonEnabled,automationType:\'FolderSelectUseLocation\',delayedHasFocus:$component.useLocationFocused,css:{\'od-Button-withCheckBox\':$component.showKeepSharing},attr:{\'aria-label\':$component.getChooseLocationAccText(item())}"><span class="od-Button-label" data-bind="text:$component.chooseLocationText"></span></button></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/folderSelect/FolderSelectViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../actions/createFolder/odb/CreateFolderAction","../../resources/DataSourceResourceKeys","../../bindings/element/ElementBinding","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/events/EventGroup","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch","../fileTypeIcon/FileTypeIcon","./FolderSelect.resx","../../providers/item/ItemProvider","../inlineCreateFolder/InlineCreateFolder","../infoBar/InfoBar","../../providers/suiteNav/SuiteNavProvider","../../models/item/ItemType","../../models/item/ItemParentHelper","../../dataSources/web/odb/WebDataSource.key","../../bindings/keyboard/KeyboardBinding","../../bindings/react/ReactBinding","@ms/odsp-utilities/lib/locale/Locale","../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../bindings/selection/SelectionBinding","../../models/selection/SelectionModel","../siteIcon/SiteIcon","../../bindings/stickyFooter/StickyFooterBinding","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../stillSpinning/StillSpinning","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../dataSources/url/QueryType","@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource","../../bindings/dismiss/DismissBinding","../../dataSources/url/odb/ItemUrlHelper","../../bindings/focus/DelayedHasFocusBinding","../../utilities/uri/EnvironmentHelper","../../actions/base/ItemSelectionHelper","../../controls/keepSharing/KeepSharing","../../controls/infoPane/sections/sharing/SharingSectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var $=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var s=e.call(this,t,n)||this;s.chooseDestination=p.default.chooseDestination;s.placesAltText=p.default.placesAltText;s.stillSpinningTagName=P.default.tagName;s.loadingSpinnerTagName=T.default.tagName;s.siteIconTagName=O.default.tagName;s.fileTypeIconTagName=h.default.tagName;s.inlineCreateFolderTagName=v.default.tagName;s.infoBarTagName=m.default.tagName;var f=s.resources,y=n.urlDataSource,w=void 0===y?f.consume(o.url):y,x=n.itemProvider,B=void 0===x?f.consume(d.resourceKey):x,V=n.actionMap,$=void 0===V?f.consume(i.actionMap):V,J=n.moveCopyDataSource,K=void 0===J?f.consume(o.copy):J,Q=n.pageContext,G=void 0===Q?f.consume(_.pageContext):Q,Y=n.itemUrlHelper,Z=void 0===Y?f.consume(R.resourceKey):Y,ee=n.itemParentHelper,te=void 0===ee?f.consume(b.resourceKey):ee,ne=n.engagement,re=void 0===ne?f.consume(a.resourceKey):ne,ie=n.suiteNavProvider,se=void 0===ie?f.consume(g.resourceKey):ie,oe=n.itemSelectionHelperType,ue=void 0===oe?f.consume(W.typeResourceKey):oe,ae=n.viewParams,fe=void 0===ae?f.consume(i.viewParams):ae,le=new(s.scope.attached(ue))({});s._suiteNavProvider=se;s._engagement=re;s._urlDataSource=w;s._itemProvider=B;s._actionMap=$;s._moveCopyDataSource=K;s._pageContext=G;s._itemUrlHelper=Z;s._itemParentHelper=te;s._viewParams=fe;s.loading=r.observable(!0);s.loadingOneDrive=r.observable(!0);var ce=new k.Qos({name:"MoveCopySelect.LaunchPane"});s.context=t.context;s.itemOne=s._createContentItem();s.itemTwo=s._createContentItem();s._itemOneUsedLast=!1;s.waitingForItem=r.observable(!1);s.addFolderFocused=r.observable(!1);s.useLocationFocused=r.observable(!1);s.packageTooBig=r.observable(!1);s.newFolderActive=r.observable(!0);s.isSingleItem=s.isFileInfoVisible(s.context.peek().items);s.isSingleItem&&(s.fileItem=s.context.peek().items[0]);s.top=r.observable("0px");s.left=r.observable("12px");s.chooseLocationText=s.context().isMove?p.default.moveButtonLabel:p.default.copyButtonLabel;s._targetIsCrossSite=s.createObservable(!1);s._shouldKeepSharing=s.createObservable(!1);s.showKeepSharing=s.createComputed(s._computeShowKeepSharing);s._sharedUsers=s.createComputed(s._getSharingPerson);s.keepSharingComponent=X.default;s.keepSharingProps=s.createComputed(s._getKeepSharingProps);s.chooseLocationButtonEnabled=r.observable(!0);s.onComplete=t.onComplete;s.newFolderItem=r.observable(null);s.newFolderItemFocused=r.observable(!1);s.showMinimalPackageWarning=r.observable(!0);s.createComputed(function(){if(s.newFolderItem()){var e=s.getCurrentItem();if(s.newFolderItem().parentKey===s._getParentKey(e)){var t=s._createFolderItem(s.newFolderItem(),e);e.subItems.push(t);t.focused(!0);s.focusedItem(t);s.selectionModel.selectItem(t);s.newFolderItemFocused(!1);s.newFolderItem(null)}else H.Verbose.logData({name:"FolderSelect.AddFolder.InvalidParent",message:"Tried to add folder but current item is different than the folder that was just created."})}});s._serverDataPromise=new C.default;s.waitingForItemParams={stillWaitingTimeout:4e3,promise:null,showControl:s.waitingForItem};s._breadCrumbItems=r.observableArray([]);s.hasBackToRootButton=r.observable(!1);s.parentBreadCrumbClass=r.observable("");s._isBreadCrumbRootClickable=!0;s.parentFolderName=s.createComputed(function(){var e=s._breadCrumbItems().length;return e>1?s.unwrapObservable(s._breadCrumbItems()[e-2].title):""});s.currentFolderName=s.createComputed(function(){var e=s._breadCrumbItems().length;return e>0?s.unwrapObservable(s._breadCrumbItems()[e-1].title):""});1===t.context().items.length?s.moveCopyText=D.format(t.context().isMove?p.default.moveSingleItem:p.default.copySingleItem,t.context().items.length):s.moveCopyText=D.format(t.context().isMove?p.default.moveMultipleItems:p.default.copyMultipleItems,t.context().items.length);s._sitesTitle=l.isFeatureEnabled(l.LeftNavTeamSiteLibraries)?r.observable(p.default.sharedLibraries):s._getSitesTitle();s.onItemClick=function(e){return s._onItemClick(e)};s.onBreadCrumbParentClick=function(){if(s.isParentBreadCrumbClickable())return s._onBreadCrumbClick(!1)};s.onBreadCrumbRootClick=function(){return s._onBreadCrumbClick(!0)};s.onShowMoreClick=function(e){return s._onShowMoreClick(e)};s.onUseLocationClick=function(e,t){return s._onUseLocationClick(e,t)};s.onKeyEnter=function(e,t){s._onItemClick(e);return!0};s.focusedItem=r.observable();s.selectionModel=new A.default;s.addBindingHandlers({selection:L.default,keyboard:E.default,element:u.default,stickyFooter:M.default,dismiss:q.default,react:S.default,delayedHasFocus:U.default});var he=s.context().isMove?p.default.itemTooBigInfoMove:p.default.itemTooBigInfo;s.infoBarParams={type:r.observable(1),infoText:r.observable(he)};s.context().isMove?s.packageSizeWarning=1===s.context().items.length?p.default.itemTooBigMove:p.default.itemsTooBigMove:s.packageSizeWarning=1===s.context().items.length?p.default.itemTooBig:p.default.itemsTooBig;s.stickyFooterElement=r.observable();var pe,de,ve={title:p.default.places,key:void 0,focused:r.observable(!1),selected:r.observable(!1),type:3,subItems:null,sections:[{title:s.chooseDestination,altTitle:p.default.currentSite,items:r.observableArray(),listElement:r.observable(),focusedItem:r.observable(),showMore:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:s.createObservable(!1),showMoreLoading:s.createObservable(!1)}]},me=le.currentItem,ge=s._getRootItem(me(),"list"),ye=s._getRootItem(me(),"subsite");if(ge){var be=s._itemUrlHelper.getItemUrlParts(ge.key);s._siteAbsoluteUrl=ye?s._itemUrlHelper.getItemUrlParts(ye.key).fullItemUrl:G.webAbsoluteUrl;s._siteTitle=ye&&ye.name?ye.name:G.webTitle;s._webId=ye&&ye.subsite&&ye.subsite.id?ye.subsite.id:G.webId;s._siteId=ye&&ye.subsite&&ye.subsite.itemReference&&ye.subsite.itemReference.SiteId?ye.subsite.itemReference.SiteId:G.siteId;s._listTitle=ge.name?ge.name:G.listTitle;s._siteLogoUrl=ye?ye.subsite.icon:G.webLogoUrl;s._isOneDrive=ge.list.templateType===j.default.mySiteDocumentLibrary;pe=s._loadWebDataSource().then(function(e){return e.getMyOneDriveUrl()});var we=!1;s.context().items.forEach(function(e){e.isDocSet&&(we=!0)});s._supportsCrossSite=(s._moveCopyDataSource.getCapabilities().supportsCopyCrossSite&&!s.context().isMove||s._moveCopyDataSource.getCapabilities().supportsMoveCrossSite&&s.context().isMove)&&(G.isNoScriptEnabled||!1)&&G.listBaseTemplate!==j.default.webPageLibrary&&ge.list.isDocumentLibrary&&!we&&!z.isGallatin();var Ee=function(e,t,n,i){return{title:s._getLocalLibraryTitle(i),key:t,oneDriveItem:e,focused:r.observable(!1),selected:r.observable(!1),type:s._isOneDrive?5:1,siteIcon:null,folderIcon:"folder",subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,listUrl:n,isCrossSite:!1,webId:s._webId,siteId:s._siteId}};de=s._isOneDrive?pe.then(function(e){return Ee(ge,be.fullItemUrl,be.fullListUrl,e)},function(e){return Ee(ge,be.fullItemUrl,be.fullListUrl)}):N.default.wrap(Ee(ge,be.fullItemUrl,be.fullListUrl));var Se=!0;if(!c.default.isActivated("419fa6c2-03b6-4bd4-8a28-7166ddfcffa2","04/07/2020","If item was added via A2OD, We dont allow moveto or copyto inside someone elses OneDrive")){Se=!(s._viewParams&&s._viewParams.peek().remoteItem)}Se&&de.then(function(e){ve.sections[0].items().length>0?ve.sections[0].items.unshift(e):ve.sections[0].items.push(e)});var xe=s._isPackageSizeWithinLimit()}if(s._supportsCrossSite&&xe){s._initialSitesQos=new k.Qos({name:"MoveCopySelect.GetInitialSites"});s._initialSitesQosDone=!1;var Te=new k.Qos({name:"MoveCopySelect.GetMyOneDriveCrossSite"});pe.then(function(e){if(null!==e){if(e!==s._siteAbsoluteUrl){var t={title:p.default.personalOneDriveRootfolder,key:e,focused:r.observable(!1),selected:r.observable(!1),type:5,siteIcon:null,folderIcon:null,subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,isCrossSite:!0};ve.sections[0].items.push(t)}Te.end({resultType:k.ResultTypeEnum.Success})}else{Te.end({resultType:k.ResultTypeEnum.ExpectedFailure});H.Verbose.logData({name:"MoveCopySelect.GetMyOneDriveCrossSite",message:"User does not have a my site provisioned"})}s.loadingOneDrive(!1)},function(e){Te.end({resultType:k.ResultTypeEnum.Failure});s.loadingOneDrive(!1)});var Ne={title:s._sitesTitle,altTitle:p.default.frequentSitesAltText,type:3,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)};ve.sections[1]=Ne;s._breadCrumbItems.push(ve);s._acronymDataSource=new I.AcronymAndColorDataSource(G);s._itemProvider.getItemSync({parentKey:s._urlDataSource.getRootItemKey(F.default.Subsites)});if(s._isOneDrive)s._getInitialSitesData(ve.sections[1]);else{var Ce=new k.Qos({name:"MoveCopySelect.GetCurrentTeamSiteAcronymAndColor"}),ke=new k.Qos({name:"MoveCopySelect.GetCurrentTeamSiteDocumentLibraryCount"}),Le=[];s._loadWebDataSource().then(function(e){Le.push(s._getInitialSitesData(ve.sections[1]));Le.push(s._getCurrentSiteData(Ce));Le.push(s._getHasMultipleDocumentLibraries(ke));N.default.all(Le).done(function(e){var t=e[0],n=e[1],r=e[2];if(t){n&&r&&t.unshift(n);t=t.slice(0,8);ve.sections[1].items(t);ve.sections[1].showMoreLoading(!1)}})})}s._initialLoadSuccess(ve,ce,!!ge)}else if(ge){s._breadCrumbItems.push(ve);s._isBreadCrumbRootClickable=!1;s.loadingOneDrive(!1);if(!xe&&s._supportsCrossSite){re.logData({name:"MoveCopySelect.PackageTooBig",extraData:{numItems:s.context.peek().items.length}});s.packageTooBig(!0)}de.then(function(e){var t=e;s._updateContextWithCurrentItem(t);s._getItemData(s._getParentKey(t),t.webId,t.siteId,!1,function(e){ve=t;s._parseFolderItems(e,ve);s._breadCrumbItems.push(ve);s._initialLoadSuccess(ve,ce,!0)},function(){s._initialLoadFailure(ve,ce)})},function(e){s._initialLoadFailure(ve,ce)})}else{H.Verbose.logData({name:"MoveCopySelect.LaunchPane",message:"List root item is null"});s.loadingOneDrive(!1);s._initialLoadFailure(ve,ce)}return s}t.prototype.getStatusText=function(e){if(e&&e.subItems&&0===e.subItems().length)switch(e.type){case 2:case 1:return p.default.noSubFolders;case 0:return p.default.noLibraries}return null};t.prototype.isSite=function(e){return!!e&&0===e.type};t.prototype.isRootItem=function(e){return!!e&&3===e.type};t.prototype.isLibraryOrFolder=function(e){return!!e&&(1===e.type||2===e.type)};t.prototype.isLibraryOrFolderOrOneDrive=function(e){return!!e&&(this.isLibraryOrFolder(e)||this.isOneDrive(e))};t.prototype.isOneDrive=function(e){return!!e&&5===e.type};t.prototype.onChangeShouldKeepSharing=function(e){this._shouldKeepSharing(e)};t.prototype.showAddFolder=function(){var e=this.getCurrentItem(),t=e.oneDriveItem,n=this._getRootItem(t,"list");return!(e.remote||!t||!n)&&s.isSpoCreateFolderAvailable(t,n)};t.prototype.showBottomLine=function(e){return!!(e&&e.subItems&&e.subItems().length>0||this.isLibraryOrFolderOrOneDrive(e)&&this.showAddFolder())};t.prototype.getListType=function(e){if(e)return e.title===p.default.siteCurrentLibrary?D.format(p.default.currentLibraryFolders,e.title):0===e.type?D.format(p.default.docLibs,e.title):5===e.type||1===e.type?D.format(p.default.libraryFolders,e.title):D.format(p.default.folders,e.title)};t.prototype.getShowMoreText=function(e){return e&&3===e.type?l.isFeatureEnabled(l.LeftNavTeamSiteLibraries)?p.default.moreSharedLibraries:p.default.browseSites:p.default.showMore};t.prototype.getChooseLocationAccText=function(e){return this.context().isMove?D.format(p.default.moveButtonAccText,e.title):D.format(p.default.copyButtonAccText,e.title)};t.prototype.getCurrentItem=function(){return this._itemOneUsedLast?this.itemTwo.item():this.itemOne.item()};t.prototype.isParentBreadCrumbClickable=function(){return this._breadCrumbItems.peek().length>2||this._isBreadCrumbRootClickable};t.prototype.onInfoBarClick=function(){if(this.showMinimalPackageWarning.peek()){this.infoBarParams.type(0);this.infoBarParams.infoText(this.packageSizeWarning);this.showMinimalPackageWarning(!1)}return!1};t.prototype.isFileInfoVisible=function(e){return 1===e.length};t.prototype._initialLoadSuccess=function(e,t,n){void 0===n&&(n=!1);this._setCurrentItemClass("od-FolderSelect-itemInitial");this.loading(!1);this._setCurrentItem(e,n);t.end({resultType:k.ResultTypeEnum.Success})};t.prototype._initialLoadFailure=function(e,t){e.error=r.observable(p.default.serverError);this.loading(!1);this._setCurrentItem(e);t.end({resultType:k.ResultTypeEnum.Failure})};t.prototype._getRootItem=function(e,t){var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return n||null};t.prototype._getKeepSharingProps=function(){return{shouldKeepSharing:this._shouldKeepSharing.peek(),onChangeShouldKeepSharing:this.onChangeShouldKeepSharing.bind(this),personaList:this._sharedUsers()}};t.prototype._getSharingPerson=function(){var e=[];if(!this.showKeepSharing())return e;this._sharingSectionHelper||(this._sharingSectionHelper=new(this.managed(V.default))({item:this.createObservable(this.fileItem)}));return e=this._sharingSectionHelper.personaTileKeepSharing().map(function(e){return e.personaParams.person.peek()})};t.prototype._loadWebDataSource=function(){return this.resources.consumeAsync(w.resourceKey)};t.prototype._loadSitesDataSource=function(){return this.resources.consumeAsync(o.sites)};t.prototype._onItemClick=function(e){var t=this,n=this._engagement;e.focused(!1);this._breadCrumbItems.push(e);this._updateBreadcrumb();this._exitCurrentItemLeft();this._targetIsCrossSite(!!e.isCrossSite);0===e.type?n.logData({name:"MoveCopySelect.SelectSite.Click",isIntentional:!0}):n.logData({name:"MoveCopySelect.SelectLibraryOrFolder.Click",isIntentional:!0});if(null===e.subItems)if(0===e.type||5===e.type&&e.isCrossSite){this.waitingForItemParams.promise=new N.default(function(n,i){t._loadWebDataSource().then(function(i){var s;s=5===e.type?function(e){return i.getDefaultOneDriveLibrary(e)}:function(e){return i.getDocumentLibraries(e)};t._serverDataPromise.debounce(s(e.key)).then(function(i){for(var s=[],o=0;o<i.length;o++){var u={title:i[o].title,key:i[o].target,focused:r.observable(!1),selected:r.observable(!1),listUrl:i[o].customSettingsUrl,type:1,folderIcon:"folder",subItems:null,sections:null,isCrossSite:e.isCrossSite,webId:e.webId,siteId:e.siteId,rootItemType:e.type,remote:i[o].remote};s.push(u)}if(1===s.length){var a=s[0];a.title=e.title;t._breadCrumbItems()[t._breadCrumbItems().length-1]=a;t._getItemWithWaiting(a,!1).then(function(){n()}).catch(function(){t._getItemWithWaiting(e,!0).then(function(){n()})})}else{e.subItems=r.observableArray(s);n();t._enterNextItem(e,!1)}},function(r){t._handleGetItemError(r,e);n()})})});this.waitingForItem(!0)}else 1!==e.type&&2!==e.type&&5!==e.type||this._getItemWithWaiting(e,!1).catch(function(){t._getItemWithWaiting(e,!0)});else{this._serverDataPromise.clear();this._enterNextItem(e,!1)}return!1};t.prototype._onBreadCrumbClick=function(e){var t,n=this._engagement;if(e){n.logData({name:"MoveCopySelect.Breadcrumb.Root.Click",isIntentional:!0});if(this._isBreadCrumbRootClickable){t=this._breadCrumbItems.shift();this._breadCrumbItems([t])}else{var r=this._breadCrumbItems.slice(0,2);t=r[1];this._breadCrumbItems(r)}}else{n.logData({name:"MoveCopySelect.Breadcrumb.Click",isIntentional:!0});this._breadCrumbItems.pop();t=this._breadCrumbItems()[this._breadCrumbItems().length-1]}var i=this.getCurrentItem();i.error&&i.error()&&(i.error=null);this._serverDataPromise.isExecuting()?this._serverDataPromise.clear():this._exitCurrentItemRight();this._updateBreadcrumb();this._enterNextItem(t,!0);return!1};t.prototype._onShowMoreClick=function(e){var t=this,n=this._engagement,i=!1,s=function(){i=!0};if(3===e.type){n.logData({name:"MoveCopySelect.ShowMoreSites.Click",isIntentional:!0});e.showMoreFocused(!1);if(this._sitesFolderItem){this._breadCrumbItems.push(this._sitesFolderItem);this._exitCurrentItemLeft();this._enterNextItem(this._sitesFolderItem,!1)}else{e.showMoreLoading(!0);var o={title:this._sitesTitle,key:void 0,focused:r.observable(!1),selected:r.observable(!1),type:4,subItems:null,sections:[{title:p.default.followed,altTitle:p.default.followedSites,type:0,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)},{title:p.default.recent,altTitle:p.default.recentSites,type:1,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)}]},u=new k.Qos({name:"MoveCopySelect.GetFollowedSites"}),a=new k.Qos({name:"MoveCopySelect.GetRecentSites"});this._serverDataPromise.debounce(N.default.all([this._getSitesData(o.sections[0],u,s),this._getSitesData(o.sections[1],a,s)])).done(function(n){if(!i)if(o.sections[0].showMoreError()&&o.sections[1].showMoreError()){e.showMoreError(p.default.serverError);e.showMore(!1)}else{t._breadCrumbItems.push(o);t._updateBreadcrumb();t._exitCurrentItemLeft();t._sitesFolderItem=o;t._enterNextItem(t._sitesFolderItem,!1)}e.showMoreLoading(!1)})}}else{n.logData({name:"MoveCopySelect.ShowMore.Click",isIntentional:!0,extraData:{Type:e.type}});var f=new k.Qos({name:"MoveCopySelect.ShowMoreSites"});this._serverDataPromise.debounce(this._getSitesData(e,f,s)).then(function(){if(i){e.showMoreLoading(!1);t._exitCurrentItemRight()}else e.listElement().focus()})}return!1};t.prototype._onUseLocationClick=function(e,t){var n=this._engagement;this.chooseLocationButtonEnabled(!1);var r=this.getCurrentItem(),i="MoveCopySelect.ChooseLocation",s=void 0!==r.rootItemType?r.rootItemType:r.type,o={ItemCount:this.context().items.length,FolderCount:this._getFolderCount(this.context().items),FileCount:this._getFileCount(this.context().items)};i+=this.context().isMove?".Move":".Copy";var u=this._getRootItem(r.oneDriveItem,"list");u&&!u.list.isDocumentLibrary&&(i+=".List");r.isCrossSite?i+=".CrossSite.Click":i+=0===s?".WithinSite.Click":".InLibrary.Click";n.logData({name:i,isIntentional:!0,extraData:o});if(r.isCrossSite){var a="MoveCopySelect.ChooseLocation";a+=this.context().isMove?".Move":".Copy";if(0!==s||this._isOneDrive)if(0===s&&this._isOneDrive)a+=".ODBToTeamSite.Click";else if(5!==s||this._isOneDrive)if(5===s&&this._isOneDrive)a+=".ODBToODB.Click";else{a+=".UnknownCrossSite.Click";H.Verbose.logData({name:"MoveCopySelect.ChooseLocation.UnknownCrossSite.Click",message:"rootItemType: "+s})}else a+=".TeamSiteToODB.Click";else a+=".TeamSiteToTeamSite.Click";n.logData({name:a,isIntentional:!0,extraData:o})}!this._initialSitesQosDone&&this._initialSitesQos&&this._initialSitesQos.end({resultType:k.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:3}});r.webId&&(this.context.peek().webId=r.webId);r.siteId&&(this.context.peek().siteId=r.siteId);var f={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove,isCheckBoxShown:this.showKeepSharing.peek(),keepSharing:this.showKeepSharing.peek()&&this._shouldKeepSharing.peek(),isCrossSite:r.isCrossSite};new(this.managed(this._actionMap.MoveCopyAction))(f).execute(t);t.stopPropagation();return!1};t.prototype._getFolderCount=function(e){for(var t=0,n=0;n<e.length;n++)e[n].folder&&t++;return t};t.prototype._getFileCount=function(e){return e.length-this._getFolderCount(e)};t.prototype._getItem=function(e,t,n,r){var i={parentKey:e,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e),filters:this._getFilters(),sortField:r?"ID":"LinkFilename",isAscending:!r,needSchema:!0,expandGroup:!0,ignoreListContext:!0,webId:t,siteId:n,noGroupReplace:!0};return this._itemProvider.getItem(i)};t.prototype._getItemData=function(e,t,n,r,i,s){return this._getItem(e,t,n,r).then(i,s)};t.prototype._getItemWithWaiting=function(e,t){var n=this;this.waitingForItemParams.promise=this._serverDataPromise.debounce(this._getItemData(this._getParentKey(e),e.webId,e.siteId,t,function(t){1!==e.type&&5!==e.type||(e.oneDriveItem=t.item());n._parseFolderItems(t,e);n._enterNextItem(e,!1)},function(r){if(r&&-2147024860===r.errorCode&&!t){r.retry=!0;return N.default.wrapError(r)}n._handleGetItemError(r,e)}));this.waitingForItem(!0);return this.waitingForItemParams.promise};t.prototype._handleGetItemError=function(e,t){if(!N.default.isCanceled(e)){e.status?404===e.status&&(t.error=r.observable(p.default.itemNotFoundError)):0===t.type?t.error=r.observable(p.default.loadLibrariesFailure):t.error=r.observable(p.default.loadFoldersFailure);this._setNextItemClass("");this._setNextItem(t)}};t.prototype._parseFolderItems=function(e,t){t.subItems=r.observableArray();for(var n=e.content().items,i=0;i<n.length;i++){var s=n[i]();s.type===y.default.Folder&&t.subItems.push(this._createFolderItem(s,t))}};t.prototype._computeShowKeepSharing=function(){var e=l.isFeatureEnabled(l.MoveKeepSharing),t=this.fileItem&&this.fileItem.type!==y.default.Folder&&this.fileItem.type!==y.default.OneNote;!this._sharingSectionHelper&&t&&(this._sharingSectionHelper=new(this.managed(V.default))({item:this.createObservable(this.fileItem)}));var n=this._sharingSectionHelper&&this._sharingSectionHelper.keepSharingHasAccess();return e&&!!(this._targetIsCrossSite()&&t&&this.isSingleItem&&this.context().isMove)&&n};t.prototype._createFolderItem=function(e,t){return{title:e.name,key:e.id,focused:r.observable(!1),selected:r.observable(!1),listUrl:t.listUrl,oneDriveItem:e,type:2,siteIcon:null,folderIcon:e.iconName,subItems:null,sections:null,isCrossSite:t.isCrossSite,webId:t.webId,siteId:t.siteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type}};t.prototype._createContentItem=function(){var e=r.observable(),t={item:r.observable(),className:r.observable(""),element:e,regionElement:r.observable(),listElement:r.observable(),stickyFooterElement:r.observable(),resizeStickyFooter:r.observable(!1),isActive:r.observable(!1),eventGroup:new f.default(e),isEntering:!1};this.addDisposable(t.eventGroup);return t};t.prototype._addAnimationEvents=function(e,t){var n=this;void 0===t&&(t=!1);var r=function(r){if(!(r&&r.target&&r.target.className.indexOf("ms-Checkbox-checkbox")>-1))if(t||e.isEntering){e.isEntering=!1;var i=e.item.peek();i.subItems&&(0===i.subItems.peek().length?n.useLocationFocused(!0):n.selectionModel.selectItem(i.subItems.peek()[0]))}else e.isActive(!1)};e.element()?(function(){if(t)r();else{e.eventGroup.on(e.element(),"transitionEnd",r);e.eventGroup.on(e.element(),"webkitTransitionEnd",r)}})():this.async.setTimeout(function(){n._addAnimationEvents(e,t)},10)};t.prototype._getSitesData=function(e,t,n){e.showMoreLoading(!0);var i,s=function(n){t.end({resultType:k.ResultTypeEnum.Success,extraData:{Length:n.length,Type:e.type}});e.lastIndex+=n.length;0===n.length&&0===e.lastIndex&&(0===e.type?e.showMoreInfo(p.default.noFollowedSites):e.showMoreInfo(p.default.loadRecentSitesFailure));for(var i=0;i<n.length;i++){var s={title:n[i].title,key:n[i].serverRelativeUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:n[i].icon,color:n[i].color,acronym:n[i].acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:n[i].itemReference&&n[i].itemReference.WebId,siteId:n[i].itemReference&&n[i].itemReference.SiteId};e.items.push(s)}5!==n.length&&e.showMore(!1);e.showMoreLoading(!1)},o=function(r){if(N.default.isCanceled(r)){t.end({resultType:k.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}});n&&n()}else{var i=!1;if(0===e.type)e.showMoreError(p.default.loadFollowedSitesFailure);else if(1===e.type){if(500011===(r.responseData&&r.responseData.ErrorCode)){e.showMoreInfo(p.default.noGraphRecentSitesFailure);i=!0}else e.showMoreError(p.default.loadRecentSitesFailure)}else e.showMoreError(p.default.loadSitesFailure);e.showMoreLoading(!1);i?t.end({resultType:k.ResultTypeEnum.ExpectedFailure,extraData:{Type:e.type}}):t.end({resultType:k.ResultTypeEnum.Failure,extraData:{Type:e.type}});e.showMore(!1)}};switch(e.type){case 0:i=this._loadSitesDataSource().then(function(t){return t.getFollowedSites(e.lastIndex,5).then(s,o)});break;case 1:i=this._loadSitesDataSource().then(function(t){return t.getRecentSites(e.lastIndex,5).then(s,o)});break;default:H.Verbose.logData({name:"FolderSelect.GetSites.InvalidSectionType",message:"Invalid section type:"+e.type.toString()})}return i};t.prototype._getInitialSitesData=function(e){var t=this;e.showMoreLoading(!0);return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(F.default.Subsites)}).then(function(n){var i=0;if(l.isFeatureEnabled(l.UseSitesLengthInMoveCopyPanel))i=n.content().items.length;else for(var s=n.content().groupings[0].itemGroups,o=0;o<s.length;o++)i+=s[o].count;e.lastIndex+=i;if(0===i&&0===e.lastIndex){e.showMoreInfo(p.default.noFollowedSites);e.showMoreLoading(!1);t._initialSitesQos.end({resultType:k.ResultTypeEnum.Success,extraData:{Length:i,Type:e.type}});t._initialSitesQosDone=!0;return null}for(var u=[],a={},f=0;f<i;f++){var c=t.peekUnwrapObservable(n.content().items[f]);if(c){var h=t._itemUrlHelper.getItemUrlParts(c.key),d=h.fullItemUrl&&h.fullItemUrl.replace(/\/$/,"");if(t._isOneDrive||d!==t._siteAbsoluteUrl){var v={title:c.name,key:h.fullItemUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:c.subsite.icon,color:c.subsite.color,acronym:c.subsite.acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:c.subsite.id,siteId:c.subsite.itemReference&&c.subsite.itemReference.SiteId};if(!a[h.fullItemUrl]){a[h.fullItemUrl]=!0;u.push(v)}}}}if(t._isOneDrive){u=u.slice(0,8);e.items(u);e.showMoreLoading(!1)}t._initialSitesQos.end({resultType:k.ResultTypeEnum.Success,extraData:{Length:i,Type:e.type}});t._initialSitesQosDone=!0;return u},function(n){N.default.isCanceled(n)?t._initialSitesQos.end({resultType:k.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}}):t._initialSitesQos.end({resultType:k.ResultTypeEnum.Failure,extraData:{Type:e.type}});t._initialSitesQosDone=!0;e.showMoreError(p.default.loadSitesFailure);e.showMoreLoading(!1);return null})};t.prototype._getCurrentSiteData=function(e){var t={title:this._siteTitle,key:this._siteAbsoluteUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:"_layouts/15/images/siteicon.png"===this._siteLogoUrl?"":this._siteLogoUrl},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!1,webId:this._webId,siteId:this._siteId};return this._acronymDataSource.getAcronymData(this._siteTitle).then(function(n){e.end({resultType:k.ResultTypeEnum.Success});t.siteIcon.color=n.color;t.siteIcon.acronym=n.acronym;return t},function(t){e.end({resultType:k.ResultTypeEnum.Failure});return null})};t.prototype._getHasMultipleDocumentLibraries=function(e){var t=this;return this._loadWebDataSource().then(function(n){return n.getDocumentLibraries(t._siteAbsoluteUrl).then(function(t){e.end({resultType:k.ResultTypeEnum.Success});return t.length>1})},function(t){e.end({resultType:k.ResultTypeEnum.Failure});return!0})};t.prototype._setCurrentItem=function(e,t){void 0===t&&(t=!1);var n;(n=this._itemOneUsedLast?this.itemTwo:this.itemOne).item(e);n.isActive(!0);this._addAnimationEvents(n,t)};t.prototype._setNextItem=function(e){var t,n,r=this;this._updateContextWithCurrentItem(e);if(this._itemOneUsedLast){t=this.itemOne;n=this.itemTwo}else{t=this.itemTwo;n=this.itemOne}this._itemOneUsedLast=!this._itemOneUsedLast;t.item(e);t.isActive(!0);n.isActive(!1);e.error||(t.isEntering=!0);this._addAnimationEvents(t);this.async.setTimeout(function(){r._setElementLeft(t.element(),0)},0)};t.prototype._setNextItemClass=function(e){this._itemOneUsedLast?this.itemOne.className(e):this.itemTwo.className(e)};t.prototype._setCurrentItemClass=function(e){this._itemOneUsedLast?this.itemTwo.className(e):this.itemOne.className(e)};t.prototype._setCurrentItemLeft=function(e){var t,n=(t=this._itemOneUsedLast?this.itemTwo.element():this.itemOne.element()).getBoundingClientRect().width+40;(e&&!x.default.isRightToLeft||!e&&x.default.isRightToLeft)&&(n=-n);this._setElementLeft(t,n)};t.prototype._setElementLeft=function(e,t){x.default.isRightToLeft?e.style.right=t+"px":e.style.left=t+"px"};t.prototype._exitCurrentItemLeft=function(){this._setCurrentItemLeft(!0)};t.prototype._exitCurrentItemRight=function(){this._setCurrentItemLeft(!1)};t.prototype._enterNextItem=function(e,t){t&&!x.default.isRightToLeft||!t&&x.default.isRightToLeft?this._setNextItemClass("od-FolderSelect-itemEnterLeft"):this._setNextItemClass("od-FolderSelect-itemEnterRight");this._setNextItem(e)};t.prototype._updateBreadcrumb=function(){this.hasBackToRootButton(this._breadCrumbItems().length>2);this.isParentBreadCrumbClickable()?this.parentBreadCrumbClass("od-FolderSelect-clickableCrumb"):this._isBreadCrumbRootClickable||this.parentBreadCrumbClass("")};t.prototype._updateContextWithCurrentItem=function(e){this.context().targetKey=this._getParentKey(e);this.context().targetId=e.key};t.prototype._getLocalLibraryTitle=function(e){var t=this._pageContext.isSiteAdmin&&this._isOneDrive;e&&(t=e===this._siteAbsoluteUrl);return this._isOneDrive?t?p.default.personalOneDriveRootfolder:D.format(p.default.oneDriveRootfolder,this._pageContext.webTitle):this._supportsCrossSite?p.default.siteCurrentLibrary:this._listTitle};t.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};t.prototype._isPackageSizeWithinLimit=function(){if(!this._moveCopyDataSource.getCapabilities().supportsThrottling||l.isFeatureEnabled(l.MoveCopyCrossSiteMaxSizeIncrease))return!0;for(var e=this.context().items.length,t=0,n=0;n<e;n++){var r=this.context().items[n];r.folder||!r.size?t+=r.totalSize:t+=r.size}return t<=524288e3};t.prototype._getParentKey=function(e){var t,n=e.key,r=e.listUrl,i=this._itemUrlHelper.getUrlParts({path:n,listUrl:r});return this._urlDataSource.getKey(((t={}).id=i.serverRelativeItemUrl,t.listurl=i.normalizedListUrl,t))};t.prototype._getSitesTitle=function(){var e=this.createObservable();this.trackPromise(this._suiteNavProvider.loadData().then(function(e){return e.CompanyDisplayName})).done(function(t){e(t)});return this.createPureComputed(function(){return e()||p.default.sites})};return t})(B.default);t.default=$});
define("odsp-next/actions/createFolder/odb/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","@ms/odsp-datasources/lib/Permissions","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/ItemParentHelper","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="CreateFolder";e.item?n._currentItem=e.item:n._currentItem=n.resources.consume(u.currentItem);n._itemParentHelper=n.resources.consume(a.resourceKey);n._isCreateShareableFolder=e.isCreateShareableFolder;return n}i.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"};i.prototype.getModuleFactory=function(){return function(){return r.default.resolve(new Promise(function(t,n){e(["./CreateFolderExecutor"],t,n)}))}};i.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),isCreateShareableFolder:this._isCreateShareableFolder}};i.prototype.onIsAvailable=function(){var e=this._currentItem();return c(e,this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")))&&this.itemCommandHelper.isCommandSupported(e,f.createFolder)};return i})(o.default);t.default=l;function c(e,t){return!!e&&e.queryType===i.default.Files&&(!t||t.list.allowCreateFolder&&!t.list.isExternal)&&s.PermissionMask.hasItemPermission(e,s.PermissionMask.insertListItems)}t.isSpoCreateFolderAvailable=c});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder",["require","exports","./InlineCreateFolder.html","./InlineCreateFolderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-inline-create-folder",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-InlineCreateFolder" data-bind="attr:{\'aria-label\':newFolderText},css:{\'is-focused\':focused},style:{height:height}">\x3c!--ko if:isFolderCreating--\x3e<span class="od-InlineCreateFolder-icon" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isFolderCreating--\x3e<i class="od-InlineCreateFolder-icon ms-Icon ms-Icon--FabricNewFolder" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:showAddFolderText--\x3e<span role="button" tabindex="0" class="od-InlineCreateFolder-addFolderText" data-bind="text:newFolderText,click:onClickAddFolder,keyboard:{allowInputEvents:true,mappings:{Enter:onEnterAddFolder,Space:onEnterAddFolder}},hasFocus:focused"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:showAddFolderText--\x3e<input class="od-InlineCreateFolder-textInput" type="text" data-bind="value:newFolderName,textInput:newFolderName,keyboard:{allowInputEvents:true,mappings:{Enter:onEnter,Esc:onEscape}},attr:{maxlength:255,placeholder:namePlaceholder,\'aria-label\':namePlaceholder,\'aria-busy\':isFolderCreating},hasFocus:inputFocused,automation:automationId,style:{height:inputHeight},enable:!isFolderCreating()"><button class="od-Button od-Button--primary od-InlineCreateFolder-createButton" data-bind="style:{visibility:newFolderName()?\'\':\'hidden\'},click:onExecuteClick,attr:{\'aria-label\':createLabel},css:{\'is-disabled\':isFolderCreating}"><span class="ms-Icon ms-Icon--CheckMark od-InlineCreateFolder-createButtonIcon" data-bind="icon:true"></span></button>\x3c!--/ko--\x3e</div>\x3c!--ko if:errorText--\x3e<div class="od-InlineCreateFolder-error" aria-live="assertive" data-bind="text:errorText"></div>\x3c!--/ko--\x3e\x3c!--ko if:successText--\x3e<div class="ms-accessible" aria-live="polite" data-bind="text:successText"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolderViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../providers/engagement/Engagement","../folderBuilder/FolderBuilder.resx","../../providers/item/ItemProvider","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=o.default.FolderNamePlaceholder;n.nameLabel=o.default.FolderNameLabel;n.createLabel=o.default.CreateFolderLabel;n.newFolderText=o.default.NewFolderText;n.loadingSpinnerTagName=c.default.tagName;n.height=(t.height||38).toString()+"px";n.inputHeight=(t.height||32).toString()+"px";n._newFolderItem=t.newFolderItem;n._newItemFocused=t.newItemFocused;n.focused=t.focused;n._item=t.item;n.newFolderName=r.observable("");n.isFolderCreating=r.observable(!1);n.showAddFolderText=r.observable(!0);n.inputFocused=r.observable(!1);n._createActionStatus=r.observable("");n.errorText=r.observable("");n.successText=r.observable("");n.addBindingHandlers({keyboard:a.default});n._itemProvider=n.resources.consume(u.resourceKey);n._actionMap=n.resources.consume(i.actionMap);n._engagement=n.resources.consume(s.resourceKey);if(t.isActive){var f=new(n.managed(n._actionMap.CreateFolderAction))({item:r.observable(n._item)});n.createComputed(function(){t.isActive(f.isAvailable())})}return n}t.prototype.onEnterAddFolder=function(){this._newItemFocused&&this._newItemFocused(!0);this.onClickAddFolder()};t.prototype.onClickAddFolder=function(){this._engagement.logData({name:"InlineCreateFolder.NewFolder.Click",isIntentional:!0});this.showAddFolderText(!1);this.inputFocused(!0)};t.prototype.onExecuteClick=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Click",isIntentional:!0});this.createNewFolder(t)};t.prototype.onEnter=function(e,t){if(0!==this.newFolderName().length){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Enter",isIntentional:!0});this.createNewFolder(t);return!1}};t.prototype.onEscape=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Dismiss",isIntentional:!0});this._resetControl();t.stopPropagation();return!1};t.prototype.createNewFolder=function(e){var t=this;this.isFolderCreating(!0);this.inputFocused(!1);this.errorText("");var n={parentKey:this._item.key},r={status:this._createActionStatus};new(this.managed(this._actionMap.CreateNewFolderAction))({parentItem:this._item,newFolderName:this.newFolderName,options:r}).execute(e).then(function(){if(t._createActionStatus()){t.errorText(t._createActionStatus());t.isFolderCreating(!1)}else{t.successText(f.format(o.default.CreateFolderSuccess,t.newFolderName.peek()));if(t._newFolderItem)t._itemProvider.getItem(n).then(function(e){for(var n=e.content().items,r=0;r<n.length;r++){var i=n[r]();if(i.displayName===t.newFolderName.peek()){t._resetControl();t._newFolderItem(i);t._itemProvider.invalidateItem(t._item.key)}}});else{t._resetControl();t._newFolderItem()}}});e.stopPropagation();return!1};t.prototype._resetControl=function(){this.showAddFolderText(!0);this.newFolderName("");this.isFolderCreating(!1);this.errorText("");this.focused(!1)};return t})(l.default);t.default=h});
define("odsp-next/controls/infoBar/InfoBar",["require","exports","./InfoBar.html","./InfoBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-infoBar",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/infoBar/InfoBar.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-InfoBar" data-bind="class:infoBarClass"><i class="od-InfoBar-icon ms-Icon" data-bind="class:iconClass"></i><span class="od-InfoBar-text" data-bind="bindableHtml:infoText"></span></div>'});
define("odsp-next/controls/infoBar/InfoBarViewModel",["require","exports","tslib","../../bindings/html/BindableHtmlBinding","knockout","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.infoText=t.infoText;n.clickHandler=t.clickHandler;n._initInfoBarClasses();n.iconClass=i.observable("");n.infoBarClass=i.observable("");n.createComputed(function(){n.infoBarClass(n._infoBarClasses[t.type()].infoBarClass);n.iconClass(n._infoBarClasses[t.type()].iconClass)});t.linkText&&t.linkUrl;n.addBindingHandlers({bindableHtml:r.default});return n}t.prototype._initInfoBarClasses=function(){var e;this._infoBarClasses=((e={})[0]={iconClass:o.getIconClassName("Info"),infoBarClass:"ms-bgColor-info"},e[1]={iconClass:o.getIconClassName("Info"),infoBarClass:""},e[2]={iconClass:"od-InfoBar-iconPlaceholder",infoBarClass:"ms-bgColor-success"},e[3]={iconClass:o.getIconClassName("Warning")+" ms-fontColor-alert",infoBarClass:"od-InfoBar-alert"},e[4]={iconClass:o.getIconClassName("DRM")+" ms-fontColor-error",infoBarClass:"ms-bgColor-error"},e[5]={iconClass:o.getIconClassName("ErrorBadge")+" ms-fontColor-error",infoBarClass:"ms-bgColor-info"},e)};return t})(s.default);t.default=u});
define("odsp-next/dataSources/web/odb/WebDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WebDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/bindings/stickyFooter/StickyFooterBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=i.unwrap(n.valueAccessor());n._scrollContainer=r.scrollableElement();n._forceResize=r.forceResize;n._forceResize(!1);n.events.on(window,"resize",n._sizeContainer);n.subscribe(n._forceResize,n._forceResizeContainer);n._sizeContainer();return n}t.prototype._forceResizeContainer=function(){if(this._forceResize()){this._sizeContainer();this._forceResize(!1)}};t.prototype._sizeContainer=function(){var e=window.innerHeight,t=this._scrollContainer.getBoundingClientRect(),n=this.element.offsetHeight,r=e-t.top-n;this._scrollContainer.style.maxHeight=r.toString()+"px"};return t})(r.default);t.default=s});
define("odsp-next/controls/stillSpinning/StillSpinning",["require","exports","./StillSpinning.html","./StillSpinningViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-stillSpinning",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/stillSpinning/StillSpinning.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div data-bind="if:showControl()"><div data-bind="component:{name:spinnerTagName,params:spinnerParams},visibility:showSpinner()"></div>\x3c!--ko if:showStillWaiting()--\x3e<div class="od-StillSpinning-text" aria-live="polite" data-bind="text:resx.StillWaiting"></div>\x3c!--/ko--\x3e\x3c!--ko if:showError()--\x3e<div class="od-StillSpinning-error"><img class="od-StillSpinning-imgError" role="presentation" data-bind="attr:{src:errorImgUrl}"><div class="ms-fontWeight-semibold ms-font-l ms-fontColor-neutralSecondary" data-bind="text:resx.Error"></div><div class="ms-font-s ms-fontColor-neutralSecondary" data-bind="text:resx.Refresh"></div></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/stillSpinning/StillSpinningViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./StillSpinning.resx","../../bindings/css/VisibilityBinding","../progressSpinnerFlat/ProgressSpinnerFlat","../../controls/loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(n){var i=e.call(this,n)||this;i.addBindingHandlers({visibility:o.default});i.params=n;i.resx=s.default;i.showControl=i.params.showControl||r.observable(!0);i.showSpinner=r.observable(!1);i.showStillWaiting=r.observable(!1);i.showError=r.observable(!1);i.errorImgUrl=window.require.toUrl("odsp-media/images/sitehub/error_icecream.png");i.spinnerTagName=0===i.params.spinnerType?a.default.tagName:u.default.tagName;i.spinnerParams=0===i.params.spinnerType?{loadingText:""}:{};i._spinnerTimeoutId=i.async.setTimeout(function(){i.showSpinner(!0);var e=i.params.stillWaitingTimeout;e?i._stillWaitingTimeoutId=i.async.setTimeout(function(){i.showStillWaiting(!0);i._startErrorTimeout()},e):i._startErrorTimeout()},i.params.spinnerTimeout||t.SPINNER_TIMEOUT);i.params.promise.then(function(e){i.showControl(!1);i._clearDataSourceTimeouts()},function(e){if(e&&e.retry){i.showControl(!1);i._clearDataSourceTimeouts()}else{i.showSpinner(!1);i.showStillWaiting(!1);i.showError(!0);i._clearDataSourceTimeouts()}});return i}t.prototype._startErrorTimeout=function(){var e=this;this.params.errorTimeout&&(this._errorTimeoutId=this.async.setTimeout(function(){e.showSpinner(!1);e.showStillWaiting(!1);e.showError(!0)},this.params.errorTimeout))};t.prototype._clearDataSourceTimeouts=function(){this._spinnerTimeoutId&&this.async.clearTimeout(this._spinnerTimeoutId);this._stillWaitingTimeoutId&&this.async.clearTimeout(this._stillWaitingTimeoutId);this._errorTimeoutId&&this.async.clearTimeout(this._errorTimeoutId)};t.SPINNER_TIMEOUT=1e3;return t})(i.default);t.default=f});
define("@ms/odsp-utilities/lib/logging/events/Verbose.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/Verbose.event","@ms/telemetry-manager/lib/events/Verbose.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.Verbose});
define("@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource",["require","exports","tslib","../../interfaces/ISpPageContext","../base/CachedDataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed"})(t.PersonaInitialsColor||(t.PersonaInitialsColor={}));t.COLOR_SERVICE_POSSIBLE_COLORS=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"];var u=(function(e){n.__extends(i,e);function i(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors",cacheTimeoutTime:864e5},{pageContext:t})||this}i.decodeAcronymColor=function(e){return t.COLOR_SERVICE_POSSIBLE_COLORS.indexOf(e)+1};i.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})};i.prototype.getAcronyms=function(e,t){var n=this;void 0===t&&(t={});if(this._pageContext.webServerRelativeUrl){var i=t.qosName,u=void 0===i?"GetSiteHeaderLogoAcronym":i;return this.getDataUtilizingCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+o.default.encodeURIComponent('"'+e+'"')+"}"}).join(",");return r.getSafeWebServerRelativeUrl(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:u})}return s.default.reject(new Error("No web URL specified for request."))};return i})(i.CachedDataSource);t.AcronymAndColorDataSource=u;t.default=u});
define("@ms/odsp-datasources/lib/dataSources/base/CachedDataSource",["require","exports","tslib","./DataSource","./RequestCache"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=n.pageContext,o=n.requestCacheType,u=void 0===o?i.RequestCache:o;r._requestCache=new u(t,{pageContext:s});return r}t.prototype.getDataUtilizingCache=function(e){var t=this,r=e,i=r.getUrl,s=r.getAdditionalPostData,o=r.cacheRequestKey,u=r.useStale,a=void 0!==u&&u,f=r.bypassCache,l=void 0!==f&&f,c=r.onlyCache,h=void 0!==c&&c,p=r.checkForInvalidation,d=void 0!==p&&p,v=r.setInvalidated,m=void 0!==v&&v,g=n.__rest(r,["getUrl","getAdditionalPostData","cacheRequestKey","useStale","bypassCache","onlyCache","checkForInvalidation","setInvalidated"]);(g=n.__assign({url:i&&i(),additionalPostData:s&&s(),method:"POST"},g)).url=g.url||i&&i();"needsRequestDigest"in g||(g.needsRequestDigest=this.needsRequestDigest(g.url));g.additionalPostData=g.additionalPostData||s&&s();o=o||this.getRequestKey(g.url,g.method,g.additionalPostData);return this._requestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:a,bypassCache:l,onlyCache:h,checkForInvalidation:d,setInvalidated:m,getData:function(){return t.dataRequestor.getData(g)}})};t.prototype.isCachedDataInvalidated=function(e){return this._requestCache.isCachedDataInvalidated&&this._requestCache.isCachedDataInvalidated(e)};t.prototype.getRequestKey=function(e,t,n){return this._requestCache.getRequestKey(e,t,n)};Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._requestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._requestCache.cacheVersionId},enumerable:!0,configurable:!0});t.prototype.flushCache=function(e){this._requestCache.flushCache(e)};return t})(r.default);t.CachedDataSource=s;t.default=s});
define("@ms/odsp-datasources/lib/dataSources/base/RequestCache",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","./IRequestCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=e.id,o=e.cacheType,u=void 0===o?i.default.session:o,a=e.cacheTimeoutTime,f=void 0===a?s.DEFAULT_CACHE_TIMEOUT_TIME:a,l=t.cacheIdPrefix,c=void 0===l?s.DEFAULT_CACHE_ID_PREFIX:l,h=t.pageContext;this._cacheTimeoutTime=f;this._id=n;this._version=h?h.siteClientTag+"_"+h.userDisplayName:"";this._store=new r.default(c,u);this._storeDefaultCacheType=u;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var t=this,r=e.cacheRequestKey,s=e.useStale,o=void 0!==s&&s,u=e.bypassCache,a=void 0!==u&&u,f=e.onlyCache,l=void 0!==f&&f,c=e.checkForInvalidation,h=e.setInvalidated,p=e.getData,d=this._cache,v=d[r];if(l)return v?n.default.resolve(v._value):n.default.resolve(void 0);c=c&&!a&&this._storeDefaultCacheType!==i.default.local;var m=v&&this._isCacheExpired(v,r,c);return a||!v||m&&!o?p().then(function(e){var n=(new Date).valueOf();d[r]={_fetched:n,_value:e};h&&t._store.setValue(r,n-1,i.default.local);t._updateCache();return e}):n.default.resolve(v._value)};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){if(e){delete this._cache[e];this._updateCache()}else this._clearCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,n){if(n&&this._isCachedDataInvalidated(e,t))return!0;var r=(new Date).valueOf()-this._cacheTimeoutTime;return e._fetched<=r};e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,i.default.local));return!!(e&&n&&e._fetched<n)};return e})();t.RequestCache=o;t.default=o});
define("@ms/odsp-datasources/lib/dataSources/base/IRequestCache",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_CACHE_TIMEOUT_TIME=3e5;t.DEFAULT_CACHE_ID_PREFIX="odsp-ds-"});
define("odsp-next/dataSources/url/odb/ItemUrlHelper",["require","exports","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUrlHelper=r.ItemUrlHelper;t.SiteRelation=r.SiteRelation;t.GeoRelation=r.GeoRelation;t.resourceKey=i.createResolvedResourceKey(e("module").id,r.ItemUrlHelper,{pageContext:n.pageContext});t.default=r.ItemUrlHelper});
define("odsp-next/controls/keepSharing/KeepSharing",["require","exports","tslib","react","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/components/ActivityItem/index","./KeepSharing.resx","../../models/peoplePicker/IPerson","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckboxChange=function(e,t){n.setState({isChecked:t});n.props.onChangeShouldKeepSharing(t)};n.state={isChecked:t.shouldKeepSharing};return n}t.prototype.render=function(){var e=this.state.isChecked,t=this.props.personaList;return r.createElement("div",{className:"od-keepSharing"},r.createElement(i.Checkbox,{className:"od-keepSharing-checkBox",checked:e,onChange:this._onCheckboxChange}),t&&t.length>0&&r.createElement(u.ActivityItem,{isCompact:!0,activityPersonas:t.slice(0,3).map(function(e){return{imageInitials:f.getInitials(e.name||""),imageUrl:e.image||""}})}),r.createElement("span",{className:"od-keepSharing-checkBox-label"},a.default.keepSharingDescription),r.createElement(o.TooltipHost,{content:a.default.keepSharingMoreInfo,directionalHint:o.DirectionalHint.bottomCenter},r.createElement(s.Icon,{className:"od-od-keepSharing-learnMore",iconName:"Info","aria-describedby":a.default.keepSharingMoreInfo})))};return t})(r.Component);t.default=l});
define("odsp-next/models/peoplePicker/IPerson",["require","exports","@ms/odsp-datasources/lib/dataSources/peoplePicker/IPerson"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getInitials=function(e){var t=e.match(/\b\w/g)||[];return((t.shift()||"")+(t.pop()||"")).toUpperCase()}});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPerson",["require","exports","../roleAssignments/PrincipalType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrincipalType=n.default;(function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application";e[e.linkedinUser=4]="linkedinUser"})(t.EntityType||(t.EntityType={}))});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionHelper",["require","exports","tslib","../../../../providers/engagement/Engagement","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features","../../InfoPane.resx","../../../../providers/sharing/SharingProvider","knockout","@ms/odsp-utilities/lib/async/Promise","../../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/utilities/path/Path","../../../../models/item/ItemType","../../../confirmation/Confirmation","../../../../utilities/icons/Icon","../../../../controls/itemLink/ItemLink","../../../../dataSources/url/QueryType","./SharingSectionKeyboardNav","@ms/odsp-datasources/lib/PeoplePicker"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.sharingApiErrorMessage=n.createObservable("");n._people=n.createObservable(Array());n.keyNav=new w.default;n.personaTileCollection=n._getPersonaTileCollection();n.personaTileByUser=n._getPersonaTileByUser();n.principalKeepSharing=n._getPrincipalKeepSharing();n.keyNav.focusableTiles=n.personaTileCollection;n.isNewSharingFlowEnabled=s.isFeatureEnabled(s.SharingDialogRedux);n.isLoading=a.observable(!1);n.scopes=a.observableArray();n.links=a.observableArray();n._scopesLinks=n.observables.createArray();n.hasFocus=t.hasFocus;n.personaSize=4;n.hasSettings=a.observable(!1);n.advancedUrl=a.observable("");n.canUnshare=a.observable(!1);n.showEmailLink=a.observable(!1);n.readPermissionsUpdated=n.createObservable(!1);n.updateComplete=n.createObservable("");n.canManagePermissions=n.createObservable(!1);n.hasInheritedLink=n.createObservable(!1);var o=n.resources.consume(i.actionMap);n.privateDescription=n.createPureComputed(n._computeShareStatus);n._engagement=n.resources.consume(r.resourceKey);n._currentItemShareAction=n.isNewSharingFlowEnabled?new(n.managed(o.ShareByLinkAction)):new(n.managed(o.ShareAction));n._sharingProvider=n.resources.consume(u.resourceKey);n._item=t.item;n.isShareLinkVisible=n.createComputed(n._computeIsShareLinkVisible);n.fileItem=n._item();n.createComputed(function(){var e=n._item();n._onItemChanged(e)});n.totalNumberOfLinks=n.createPureComputed(n._computeTotalNumberOfLinks);n.statusText=n.createComputed(n._computeStatusText);n.fileName=n.createObservable("");n.personaTileKeepSharing=n.createComputed(n._getPersonaKeepSharing);n.keepSharingHasAccess=n.createComputed(n._getkeepSharingHasAccess);n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e,t="mailto:",r=[],i=0,s=n.scopes();i<s.length;i++)for(var o=0,u=s[i].people;o<u.length;o++){var a=u[o];a.email&&r.push(a.email)}n.showEmailLink(r.length>0&&r.length<30);t+=h.default.encodeURIComponent(r.join(";"));t+="?subject="+h.default.encodeURIComponent(n._settings.itemName);e=d.canonicalizeDecodedUrl(n._settings.itemUrl);t+="&body="+h.default.encodeURIComponent(n._normalizeUrl(e));n.fileName(n._settings.itemName);n.canManagePermissions(n._settings.canManagePermissions);n.hasInheritedLink(n._settings.hasInheritedLink);n.sharingApiErrorMessage(n._settings.sharingApiErrorMessage);return t});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};t.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};t.prototype.onScopeClick=function(e){this._executeShare(e);return!1};t.prototype.notifyPermissionsUpdated=function(){this.updateComplete(o.default.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};t.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype.onShareClick=function(){this._executeShare(this._item.peek());return!1};t.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};t.prototype.convertPersonToPersonaTile=function(e,t,n){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:n,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};t.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};t.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};t.prototype._stopSharingConfirm=function(e){var t=this,n=this.resources.consume(l.resourceKey),r=this._engagement,i=a.observable(!0);n.requestDialog({title:o.default.stopSharingConfirmationTitle,size:"Medium",component:{name:m.default.tagName,params:{message:o.default.stopSharingConfirmationMessage}},actions:[{name:o.default.stopSharingConfirmationButton,execute:function(){r.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});i(!1);return t._stopSharing().then(function(n){t._item.peek().queryType===b.default.SharedByMe&&e();return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new g.default("Save"),automationId:"UnshareConfirm"},{name:o.default.stopSharingCancelButton,execute:function(){r.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return f.default.wrap(3)},isDefault:!1,icon:new g.default("Cancel"),automationId:"UnshareCancel"}],focusOnPrimaryAction:!0,dismissOnEsc:!0,shouldPreserveFocus:!0,executeDefaultAction:!1})};t.prototype._executeShare=function(e,t){void 0===t&&(t=this.resources);var n=this.resources.consume(i.actionMap);(this.isNewSharingFlowEnabled?this.addDisposable(new(t.injected(n.ShareByLinkAction))):this.addDisposable(new(t.injected(n.ShareAction))({item:a.observable(e),startState:3}))).execute(null)};t.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),n="",r=this.scopes();this._hasError&&(n=this._errorText);t?n=o.default.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(r)||(n=e.type===v.default.Folder?o.default.sharingUnsharedFolderStatus:o.default.sharingUnsharedFileStatus);return n};t.prototype._hasNonOwnerScopes=function(e){var t=!0,n=!1;e&&0!==e.length||(t=!1);if(t)for(var r=0;r<e.length&&!n;r++)for(var i=e[r].people,s=0;s<i.length&&!n;s++){0!==i[s].sharingInfo.role&&(n=!0)}return t&&n};t.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var n=e[0].people[0];t=1===e[0].people.length&&2===n.entityType?c.format(o.default.sharingUnsharedOwnedByGroup,n.name):o.default.sharingUnsharedNotShared}}else t=o.default.sharingUnsharedNotShared;return t};t.prototype._areAllOwners=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.sharingInfo&&0!==r.sharingInfo.role)return!1}return!0};t.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};t.prototype._onItemChanged=function(e){var t=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(e&&e.key!==this._itemKey){this._itemKey=e.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(e){this._sharingData=this._sharingProvider.getSharingData(e);this._sharingData.getSettings().then(function(e){t._settings=e;t.advancedUrl(e.advancedUrl);t.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(n){t.isLoading(!1);t.scopes(t._processScopes(e,n))},function(e){e&&403===e.status?t._errorText=o.default.accessDenied:e&&e.code&&e.code.indexOf("-2130575139")>-1?t._errorText=o.default.noscriptErrorStatus:t._errorText=o.default.serverError;t._hasError=!0;t.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&t.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=e}};t.prototype._processScopes=function(e,t){var r=this,i=[];t.length>0&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var s=0;s<t.length;s++){var u=t[s];if(u&&u.people.length){var a=n.__assign(n.__assign({},u),{headerHtml:"",sharingPeople:[]});if(u.item&&u.item.key!==this._item.peek().key){var f;f="<span data-bind=\"component: { name: '"+y.default.tagName+"', params: { item: scope.item } }\"></span>";a.headerHtml=c.format(o.default.sharingScopeHeaderFormat,f)}u.people.forEach(function(e){e.sharingInfo.link&&r._scopesLinks.push(e.sharingInfo.link);a.sharingPeople.push({personInfo:e,sharingItem:u.item})});i.push(a)}}for(var l=new Array,h=0;h<i.length;h++)l=l.concat(i[h].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(l);return i};t.prototype._getkeepSharingHasAccess=function(){var e=this.personaTileKeepSharing(),t=this.totalNumberOfLinks();return e.length>0||t>0};t.prototype._getPersonaKeepSharing=function(){for(var e=this.principalKeepSharing(),t={},n=0,r=e;n<r.length;n++){t[(c=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f=a[u],l=f.userId,c=this.convertPersonToPersonaTile(this.createObservable(f),f.userId);if(!t[l]){t[l]=!0;e.push(c)}}}return e};t.prototype._getPrincipalKeepSharing=function(){return this._getPersonaTileHelper(!0)};t.prototype._getPersonaTileCollection=function(){return this._getPersonaTileHelper()};t.prototype._getPersonaTileHelper=function(e){var t=this,r=this.createPureComputed(e?this._getPeopleKeepSharing:this._getPeopleByUserId),i=this.observables.createArray();this.createBackgroundComputed(function(){i.splice.apply(i,n.__spreadArrays([0,i.peek().length],t._people().map(function(e){return e.personInfo.userId})))});return i.filter(function(e){return e in r()}).map({mappingWithDisposeCallback:function(e){var n=t.createObservable(),i=t.createComputed(function(){n(r()[e].personInfo||n.peek())});return{mappedValue:t.convertPersonToPersonaTile(n,e,r()[e].sharingItem),dispose:function(){i.dispose()}}}})};t.prototype._getPeopleKeepSharing=function(){return this._getPeopleByUserId(!1,!0)};t.prototype._getPeopleByUserId=function(e,t){for(var n={},r=0,i=this._people();r<i.length;r++){var s=i[r],o=s.personInfo,u=o&&o.sharingInfo;u&&3===u.type||(e&&o.principalType===E.PrincipalType.sharePointGroup||t&&o&&o.sharingInfo&&0===o.sharingInfo.role||(n[o.userId]=s))}return n};t.prototype._getPersonaTileByUser=function(){var e=this;return this.createComputed(function(){for(var t={},n=0,r=e.personaTileCollection();n<r.length;n++){var i=r[n];t[i.key]=i}return t})};t.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return t})(p.default);t.default=S});
define("odsp-next/controls/confirmation/Confirmation",["require","exports","./Confirmation.html","./ConfirmationViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-confirmation",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/confirmation/Confirmation.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>'});
define("odsp-next/controls/confirmation/ConfirmationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t})(r.default);t.default=i});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Enter:t.onKeyEnter}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyEnter=function(e,t){var n=e.keyNav.focusedTile();if(n){n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return t})(r.default);t.default=i});
define("@ms/odsp-datasources/lib/PeoplePicker",["require","exports","tslib","./dataSources/peoplePicker/spo/PeoplePickerDataSource","./dataSources/peoplePicker/IPerson","./dataSources/peoplePicker/IPresenceType","./providers/peoplePicker/odb/PeoplePickerProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t)});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/spo/PeoplePickerDataSource",["require","exports","tslib","../../../interfaces/ISpPageContext","../../base/DataSource","../../roleAssignments/PrincipalType","@ms/odsp-utilities/lib/async/Promise","../../../utilities/peoplePicker/SubstratePeoplePickerHelper","../../../utilities/url/ApiUrlHelper","../../../utilities/url/ItemUrlHelper","@ms/odsp-utilities/lib/alternativeUrls/SPAlternativeUrls","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor","@ms/odsp-graph/lib/models/error/Error","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/string/EmailAddressParser","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var r=this,i=g(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=g(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new a.ApiUrlHelper({},{itemUrlHelper:new f.ItemUrlHelper({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},i=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(i.Primary),managerChain:i.ManagerChain.results.map(n),directReports:i.DirectReports.results.map(n)};s.personDetails.profilePage=r.getServerUrl(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===s.default.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),o=[];o[0]=i;p.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(o[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=i.Key);var u=(o=n._transformData(o,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&1===u.entityType){u.isResolved=!1;u.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=2;u.principalType=s.default.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,o=void 0===i||i,u=t.filterExternalUsers,a=t.forceResolve,f=JSON.parse(r),l=JSON.parse(f.d.ClientPeoplePickerSearchUser),c=n._transformData(l,u);u&&(c=c.filter(function(e){return 1!==e.entityType}));var h=!c.length;c=c.filter(function(e){return e.principalType===s.default.sharePointGroup?o:e.principalType===s.default.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(p.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))a&&h&&c.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===c.length&&n._isValidEmail(e,!1)){var d={Key:e,IsResolved:!1};c.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:d,rawPersonData:d,isExternal:!0})}return c}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,t){var n=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=new v.default("https://graph.microsoft.com/v1.0/me/people");if(e){i.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});!1!==t.filterPublicDistributionList&&i.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'")}return n._dataRequestor.send({apiName:"Graph.PeopleSearch",path:i.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);if(!(p.Killswitch.isActivated("942c7a40-2a9b-42ec-accf-2e7bd0d06d90","11/15/2019","KillSwtich: Graph.PeopleSearch - Fall back to SPO when result is empty")||r&&r.value&&0!==r.value.length))return n.sharePointSearch(e,t);var i=r.value,o=[];i.forEach(function(e){var r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&n._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,c="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,h="PublicDistributionList"===e.personType.subclass,p=l.getUserPhotoUrl(r),d={department:e.department,email:r,image:a?void 0:p,job:!1===t.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){d.entityType=0;d.principalType=s.default.user;d.isResolved=!0}else if(c){d.entityType=2;d.principalType=s.default.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=h?s.default.distributionList:s.default.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&o.push(d)});if(!1!==t.resolveEmailIfNoResults&&0===o.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(r){if(h.isGraphError(r))switch(r.status){case 400:case 401:case 403:case 404:n._graphPeoplePickerHelper.disableGraphCallsForPicker();return n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==r.name&&n._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===r.name?null:n.sharePointSearch(e,t)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var o=["Directory"];p.Killswitch.isActivated("9403ac4d-b51a-48b3-a4c0-9007477f73ea","02/18/2020","Mailbox Searching in Substrate People Suggestions.")||o.splice(0,0,"Mailbox");return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.SUBSTRATE_SEARCH_URL+"/api/v1/suggestions",headers:{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r},needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],o=[];i.forEach(function(e){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,u={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,c="LinkedIn"===e.PeopleSubtype,h="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=l.getUserPhotoUrl(r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:u,rawPersonData:u,isExternal:!f};if(f){v.entityType=0;v.principalType=s.default.user;v.isResolved=!0}else if(h){v.entityType=2;v.principalType=s.default.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(c)v.entityType=4;else{v.principalType=p?s.default.distributionList:s.default.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&o.push(v)});if(!1!==t.resolveEmailIfNoResults&&0===o.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&d.default.isValidEmailSyntax(e,!1):!t};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var o=i.email;i.isResolved&&(i.image=o?l.getUserPhotoUrl(o):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=s.default.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===u?s.default.sharePointGroup:s.default.securityGroup;break;default:i.entityType=0;i.principalType=s.default.user}return i})};return t})(i.default);t.PeoplePickerDataSource=m;function g(e){return!!e.webAbsoluteUrl}});
define("@ms/odsp-datasources/lib/utilities/peoplePicker/SubstratePeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/features/FeatureOverrides"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUBSTRATE_SEARCH_URL="https://outlook.office.com/search";t.PeoplePickerSubstrate={ODB:1286};var a=(function(){function e(e,t){this._dataRequestor=new i.DataRequestor({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&u.default.isFeatureEnabled(t.PeoplePickerSubstrate)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",o.default.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,o.default.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return n.default.resolve(this._substrateToken);if(this._oAuthTokenProvider){var i=new r.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(t.SUBSTRATE_SEARCH_URL).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(t){if(n.default.isCanceled(t)){i.end({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(t)}i.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.ResultTypeEnum.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var n=t.SUBSTRATE_SEARCH_URL+"/api/v1/init?scenario=documentshare";this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:n,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e})();t.SubstratePeoplePickerHelper=a});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPresenceType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Unknown=0]="Unknown";e[e.Online=1]="Online";e[e.Busy=2]="Busy";e[e.DoNotDisturb=3]="DoNotDisturb";e[e.BeRightBack=4]="BeRightBack";e[e.Away=5]="Away";e[e.Offline=6]="Offline";e[e.Hidden=7]="Hidden"})(t.PresenceType||(t.PresenceType={}))});
define("@ms/odsp-datasources/lib/providers/peoplePicker/odb/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/peoplePicker/spo/PeoplePickerDataSource","../../../models/store/PeopleStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new r.PeoplePickerDataSource({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new i.PeopleStore;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var r,i,s=this,o={cached:null,promise:null};this._mruCache&&!t.groupID&&(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new n.default(function(n,o){r=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});n(e.filter(function(e){return t.indexOf(e.userId)<0}))}else n(e)},function(e){o(e)})},function(){r&&r.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var s=n.indexOf(t.userId);if(s>-1){var o=e[s];i.PeopleStore.isCacheEntryFresh(o,t)&&r.push(o)}});return r};return e})();t.PeoplePickerProvider=s});
define("@ms/odsp-datasources/lib/models/store/PeopleStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=5;n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer();n._data={};if(Date.now()<n._buffer.lastCachePrune+6048e5||s.Killswitch.isActivated("e96e6a47-9f55-4ea4-8395-c9f48a655b2a","8/07/2018","PeopleStorePruning"))for(var r=0;r<n._buffer.dataArray.length;r++)n._data[n._buffer.dataArray[r].email]=n._buffer.dataArray[r];else{n.initializeBuffer();n.setValue(t._StorageKey,n._buffer)}return n}t.clear=function(){new r.default(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return Boolean(this._data[e.email])};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=i.default.local;return t})(r.default);t.PeopleStore=o});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon",["require","exports","./FileNameWithIcon.html","./FileNameWithIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-fileName-with-icon",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<span><span class="od-FileNameWithIcon-icon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconParams}"></span><span class="od-FileNameWithIcon-fileName" data-bind="text:fileName"></span></span>'});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIconViewModel",["require","exports","tslib","../fieldRender/iconField/IconFieldViewModel","@ms/odsp-shared/lib/base/ViewModel","../fileTypeIcon/FileTypeIcon","../../utilities/accessibility/AriaHelper","../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.oneDriveItem;n.fileName=i.name;n.fileTypeIconTagName=s.default.tagName;var a=n.createObservable(i);n._isFluentEnabled=n.resources.consume(u.resourceKey);n.fileTypeIconParams={iconName:i.iconName,iconUrl:i.iconUrl,extension:i.extension,desiredSize:n._isFluentEnabled?20:16,overlayType:r.default.getOverlayType(a),iconFieldAriaLabel:o.getIconFieldAriaLabelForItem(i)||"",hoverText:r.default.getHoverText(a)};return n}return t})(i.default);t.default=a});
define("odsp-next/controls/folderTree/FolderTree",["require","exports","./FolderTree.html","./FolderTreeRow.html","./FolderTreeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../inlineFolderBuilder/InlineFolderBuilder","ODCExecutors_css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.registerComponent({tagName:"ms-folder-tree",template:n.default,viewModel:i.default,synchronous:!0});s.registerTemplate("od-folder-tree-row",r.default);t.default=o});
define("odsp-next/controls/folderTree/FolderTree.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:hasData--\x3e<div class="od-FolderTree-commandBar od--hasSelection" data-bind="control:commandBarSpecification"></div><div class="od-FolderTree-contentContainer"><div class="od-FolderTree-sharingInfo ms-font-m" data-bind="visible:showStatusInfo,text:statusInfoText"></div><div class="od-Panel--hasPadding od-FolderTree-padding"><div class="od-FolderTree-title" data-bind="text:title,css:{\'ms-fontWeight-semibold\':isFluentEnabled,\'ms-fontWeight-semilight\':!isFluentEnabled,\'ms-font-xl\':!isFluentEnabled}"></div>\x3c!--ko if:showSharedRoot&&sharedFolderItem()--\x3e<div class="od-FolderTree" role="tree" data-bind="template:{name:\'od-folder-tree-row\',data:sharedFolderItem},keyboard:keyboardOptions,selection:{data:itemArrayForSelection,mode:\'single\',direction:\'vertical\',key:sharedFolderItem().key,focused:focusedItem,selected:selectedItems,clearSelectionOnRemoval:false,selectFirstItemOnActivate:false,selectionModel:selectionModel}"></div>\x3c!--/ko--\x3e<div class="od-FolderTree" role="tree" data-bind="template:{name:\'od-folder-tree-row\',data:rootFolderItem},keyboard:keyboardOptions,selection:{data:itemArrayForSelection,mode:\'single\',direction:\'vertical\',key:rootFolderItem().key,focused:focusedItem,selected:selectedItems,clearSelectionOnRemoval:false,selectFirstItemOnActivate:false,selectionModel:selectionModel}"></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:hasData--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:loadingText}}"></span>\x3c!--/ko--\x3e'});
define("odsp-next/controls/folderTree/FolderTreeRow.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="<div class=\"od-FolderTree-row\" role=\"treeitem\" data-bind=\"css:{'is-selected':selected,'is-focused':focused,'icon-visible':iconVisible},style:{padding:$component.isFluentEnabled?$component.getFluentRowPadding($data):undefined},click:$component.onClick.bind($data,$component),attr:{'aria-expanded':isOpen()?'true':'false','aria-selected':selected(),'aria-label':name,tabindex:selected()||focused()?0:-1},delayedHasFocus:{hasFocus:focused,timeout:300}\"><i class=\"ms-Icon ms-Icon--ChevronDown\" data-bind=\"icon:true,style:{display:!isLoading()&&isOpen()?'inline-block':'none'}\"></i><i class=\"ms-Icon\" data-bind=\"icon:true,style:{display:!isLoading()&&!isOpen()?'inline-block':'none'},css:{'ms-Icon--ChevronRight':!$component.isRtl,'ms-Icon--ChevronLeft':$component.isRtl}\"></i><img class=\"od-FolderTree-loadingGif\" data-bind=\"attr:{src:$component.loadingImageUrl},style:{display:isLoading()?'inline-block':'none'}\"><i class=\"ms-Icon ms-Icon--OneDrive\" data-bind=\"icon:true,style:{display:isRoot?'inline-block':'none'}\"></i><span class=\"od-FolderTree-folderIcon\" data-bind=\"component:{name:'ms-file-type-icon',params:{iconName:iconName,desiredSize:16,item:oneDriveItem()}},style:{display:isRoot?'none':'inline-block'}\"></span><span class=\"od-FolderTree-folderName ms-font-m\" data-bind=\"text:name\"></span></div><div class=\"od-FolderTree-inlineFolderBuilder\" data-bind=\"visible:showNewFolderInput,component:{name:'ms-inline-folder-builder',params:{newFolderName:$component.newFolderName,iconName:iconName,width:$component.getWidth($component,$data),itemKey:key,optionalParams:{dataUpdated:$component.dataUpdated,showNewFolderInput:showNewFolderInput,hasFocus:focusNewFolderInput,needsRefocus:$component.needsRefocus}}}\"></div><ul class=\"od-FolderTree-children\" role=\"group\" data-bind=\"template:{name:'od-folder-tree-row',foreach:children},style:{display:isOpen()?'block':'none'}\"></ul>"});
define("odsp-next/controls/folderTree/FolderTreeViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../providers/item/ItemProvider","./FolderTreeUtility","../../bindings/selection/SelectionBinding","../../bindings/keyboard/KeyboardBinding","../../models/selection/SelectionModel","../../resources/DataSourceResourceKeys","./FolderTreeCommandSet","@ms/odsp-utilities/lib/async/Promise","./FolderTree.resx","../../dataSources/url/QueryType","../../providers/sharing/SharingProvider","../../models/item/IItemTypeFilter","../../utilities/features/Features","../../utilities/sharing/SharingHelper","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../loadingSpinner/LoadingSpinner","../../bindings/focus/DelayedHasFocusBinding","../commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../actions/vault/VaultActionType","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._folderTreeWidth=260;n._folderTreeIndent=20;n.loadingSpinnerTagName=S.default.tagName;n.context=t.context;n.onComplete=t.onComplete;n.title=t.title;n.dataUpdated=r.observable(!1);n.isDisabled=r.observable(!1);n.isNewFolderDisabled=r.observable(!1);n.hasData=r.observable(!1);n.height=document.body.clientHeight+"px";n._platform=n.resources.consume(E.platformDetection);n.isMobile=n._platform.isMobile;n.rootFolderItem=r.observable();n.sharedFolderItem=r.observable();n.focusedItem=r.observable();n.selectedItems=r.observableArray();n.selectionModel=new l.default;n.itemArrayForSelection=r.observableArray();n.isRtl=w.default.isRightToLeft;n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");n._urlDataSource=n.resources.consume(c.url);n._moveCopyDataSource=n.resources.consume(c.copy);n.newFolderName=r.observable("");n.needsRefocus=r.observable(!1);n.loadingText=d.default.loadingText;n.addBindingHandlers({selection:a.default,delayedHasFocus:x.default,control:N.default,keyboard:f.default});n.keyboardOptions=[{target:null,useRtlMappings:!0,mappings:{Down:n.keyDown,Up:n.keyUp,Left:n.keyLeft,Right:n.keyRight,Enter:n.onEnter}},{useRtlMappings:!0,target:window,mappings:{}}];n.subscribe(n.dataUpdated,n._updateItemSet);n.subscribe(n.needsRefocus,n._setFocus);n._itemProvider=n.resources.consume(o.resourceKey);n._actionMap=n.resources.consume(s.actionMap);n._currentSet=n.resources.consume(s.currentItemSet);n._itemSet=r.observable(null);n._sharedItemSet=r.observable(null);n._sharingProvider=n.resources.consume(m.resourceKey);n.showStatusInfo=r.observable(!1);n.statusInfoText=r.observable("");n.isFluentEnabled=n.resources.consume(k.resourceKey);var i=n._currentSet().item();n.showSharedRoot=n._moveCopyDataSource.getCapabilities().supportsMoveCopyOnShared&&0!==i.sharingRole&&i.queryType!==v.default.SharedWithMe;n._fetchParentItem(i);n.commandBarSpecification=N.toSpecification(T.resourceKey,{commandSet:new(n.managed(h.default))({componentViewModel:n})});return n}t.prototype.getWidth=function(e,t,n){return e._folderTreeWidth-e._folderTreeIndent*t.level};t.prototype.onClick=function(e,t,n){e.focusedItem()&&e.focusedItem().showNewFolderInput(!1);e._selectFolder(t);if(t.isOpen()){e._closeChildren(t);e._updateSelectionArray()}else{t.isLoading(!0);e._showChildren(t)}};t.prototype.getFluentRowPadding=function(e){return this.isRtl?"0 "+(17+30*e.level)+"px 0 0 ":"0 0 0 "+(17+30*e.level)+"px"};t.prototype.onStatusActionClick=function(){var e=this;new(this.managed(this._actionMap.VaultAction))({actionType:C.default.Unlock}).execute(null).then(function(){e._showChildren(e.focusedItem(),!0)})};t.prototype.keyLeft=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){e._closeChildren(this.focusedItem());e._updateSelectionArray()}else if(this.focusedItem().parent){var n=this.focusedItem().parent;e._changeSelection(n);e._selectFolder(n)}t.stopPropagation();return!0};t.prototype.keyRight=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){if(this.focusedItem().children().length>0){var n=this.focusedItem().children()[0]();e._changeSelection(n);e._selectFolder(n)}}else{e.focusedItem().isLoading(!0);e._showChildren(this.focusedItem())}t.stopPropagation();return!0};t.prototype.keyUp=function(e,t){this.focusedItem().showNewFolderInput(!1);var n=this.itemArrayForSelection.indexOf(this.focusedItem());0!==n&&e._selectFolder(this.itemArrayForSelection()[n-1]);return!0};t.prototype.keyDown=function(e,t){this.focusedItem().showNewFolderInput(!1);var n=this.itemArrayForSelection.indexOf(this.focusedItem());n!==this.itemArrayForSelection().length-1&&e._selectFolder(this.itemArrayForSelection()[n+1]);return!0};t.prototype.onEnter=function(e,t){this.isDisabled(!0);this.isNewFolderDisabled(!0);var n={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove};new(this.managed(this._actionMap.MoveCopyAction))(n).execute(t);t.stopPropagation();return!1};t.prototype._selectFolder=function(e){var t=this._urlDataSource.getKeyParams(e.key),n=this._urlDataSource.saveItemTypeFilter({filters:[g.ItemTypeFilter.folder]});for(var r in n)delete t[r];var i=this._urlDataSource.getKey(t);this.context().targetId=e.id;this.context().targetKey=i;this.context().cid=this._urlDataSource.getOwnerId(i);this.isNewFolderDisabled(!1);y.isFeatureEnabled(y.FileMoveSharingHint)&&this._showSharingInformation(e)};t.prototype._changeSelection=function(e){this.selectionModel.selectItem(e)};t.prototype._setFocus=function(){if(this.needsRefocus()){this.focusedItem().focused(!0);this.isNewFolderDisabled(!1);this.needsRefocus(!1)}};t.prototype._updateItemSet=function(){this.focusedItem().isLoading(!0);this._showChildren(this.focusedItem())};t.prototype._showChildren=function(e,t){var n=this;void 0===t&&(t=!1);var r=e.oneDriveItem&&e.oneDriveItem.peek();if(e.retrievedChildren()&&!this.dataUpdated()){e.isLoading(!1);e.children().length>0?e.isOpen(!0):e.isOpen(!1);this._updateSelectionArray()}else if(r&&r.vault&&r.vault.isLocked&&!t)this.onStatusActionClick();else{var i={parentKey:e.key,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e.key),skipCache:!0,filters:this._getFilters()};this._itemProvider.getItem(i).then(function(t){n._itemSet(t);e.children(u.default.convertChildren(e,n._itemSet().content().items));e.retrievedChildren(!0);e.isLoading(!1);e.children().length>0?e.isOpen(!0):e.isOpen(!1);0===e.children().length?e.iconVisible(!1):e.iconVisible(!0);if(n.dataUpdated()){for(var r=0;r<e.children().length;r++)if(e.children()[r]().name===n.newFolderName()){n._changeSelection(e.children()[r]());n._selectFolder(e.children()[r]())}n.isNewFolderDisabled(!1);n.dataUpdated(!1)}n._updateSelectionArray()})}};t.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};t.prototype._closeChildren=function(e){e.isOpen(!1);for(var t=0;t<e.children().length;t++)this._closeChildren(e.children()[t]())};t.prototype._fetchParentItem=function(e){var t=this,n=this._urlDataSource.saveItemTypeFilter({filters:[g.ItemTypeFilter.folder]}),r=this._urlDataSource.getKey(n),i={parentKey:r,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(r),filters:this._getFilters()},s=this._itemProvider.getItem(i).then(function(e){t._itemSet(e)}),o=p.default.wrap();if(this.showSharedRoot){var u=null;if(e.parent){for(var a=e;a.parent&&!a.parent.isStub&&a.parent.parent;)a=a.parent;u=a}else u=e;i={parentKey:u.key,ownerId:u.ownerId};o=this._itemProvider.getItem(i).then(function(e){t._sharedItemSet(e)},function(e){t.showSharedRoot=!1})}p.default.all([s,o]).done(this._createFolderItems.bind(this),this._createFolderItems.bind(this))};t.prototype._createFolderItems=function(){var e=null;if(this._sharedItemSet()){var t=this._getFolderItem(this._sharedItemSet());e=t;this.sharedFolderItem(t)}if(this._itemSet()){var n=this._getFolderItem(this._itemSet());n.isRoot=!0;e||(e=n);this.rootFolderItem(n);this._selectFolder(e);this._changeSelection(e);this._updateSelectionArray();this.hasData(!0)}};t.prototype._getFolderItem=function(e){var t=u.default.convertItem(null,e.item);t.children(u.default.convertChildren(t,e.content().items));t.isOpen(!0);t.retrievedChildren(!0);t.focused(!0);0===t.children().length&&t.iconVisible(!1);return t};t.prototype._updateSelectionArray=function(){var e=this._updateSelectionArrayHelper(this.rootFolderItem(),!0),t=this.sharedFolderItem()?this._updateSelectionArrayHelper(this.sharedFolderItem(),!0):[];this.itemArrayForSelection(t.concat(e))};t.prototype._updateSelectionArrayHelper=function(e,t){var n=[];t&&n.push(e);if(e.children().length>0)for(var r=0;r<e.children().length;r++)n=n.concat(this._updateSelectionArrayHelper(e.children()[r](),e.isOpen()));return n};t.prototype._showSharingInformation=function(e){var t=this;if(e.retrievedSharingPermissions){this.showStatusInfo(!!e.sharingInfoText);this.statusInfoText(e.sharingInfoText)}else{this.showStatusInfo(!1);this._sharingProvider.getSharingData({key:"",openUrl:e.id}).getPermissions().then(function(n){var r=n[0];e.retrievedSharingPermissions=!0;e.sharingPermissions=r;e.sharingInfoText=b.getSharingStatusText(r,e.name);if(e.selected()){t.showStatusInfo(!!e.sharingInfoText);t.statusInfoText(e.sharingInfoText)}},function(e){})}};return t})(i.default);t.default=L});
define("odsp-next/controls/folderTree/FolderTreeUtility",["require","exports","knockout","../../models/item/ItemType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}e.convertItem=function(e,t){var r=t.peek();return{name:r.name,key:r.key,type:r.type,id:r.id,iconName:r.iconName,focused:n.observable(!1),isSelectable:!0,selected:n.observable(!1),children:n.observableArray(),isOpen:n.observable(!1),retrievedChildren:n.observable(!1),iconVisible:n.observable(!0),isRoot:!1,isLoading:n.observable(!1),level:0,parent:e,showNewFolderInput:n.observable(!1),focusNewFolderInput:n.observable(!1),retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,oneDriveItem:t}};e.convertChildren=function(t,i){for(var s=[],o=0;o<i.length;o++){var u=i[o],a=u&&u.peek();if(a&&(a.type===r.default.Folder||a.type===r.default.Error&&a.folder)){var f=n.observable(e.convertItem(t,u));f().level=t.level+1;s.push(f)}}return s};return e})();t.default=i});
define("odsp-next/controls/folderTree/FolderTreeCommandSet",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../commands/Commands.resx","../../resources/ControlResourceKeys","../commands/CommandViewModel","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.commands=r.observableArray();n._actionMap=n.resources.consume(u.actionMap);n.componentViewModel=t.componentViewModel;n.context=t.componentViewModel.context;n.onComplete=t.componentViewModel.onComplete;n.isDisabled=t.componentViewModel.isDisabled;n.isNewFolderDisabled=t.componentViewModel.isNewFolderDisabled;n.isNewFolderHidden=r.observable(!0);n.createComputed(function(){if((!n._focusedItem||n._focusedItem()!==n.componentViewModel.focusedItem())&&n.componentViewModel.focusedItem()){n._focusedItem=n.componentViewModel.focusedItem;var e=n._focusedItem().oneDriveItem;n._createFolderAction=new(n.managed(n._actionMap.CreateFolderAction))({item:e})}n._createFolderAction&&n.isNewFolderHidden(!n._createFolderAction.isAvailable())});n.isFluentEnabled=n.resources.consume(f.resourceKey);var s={context:n.context,onComplete:n.onComplete,isMove:!0},l={context:n.context,onComplete:n.onComplete,isMove:!1};n.commands=r.observableArray([new a.default({text:o.default.moveConfirmButton,isDisabled:n.isDisabled,icon:n.isFluentEnabled?void 0:new i.default("CheckMark"),automationId:"folderTree-move",action:new(n.managed(n._actionMap.MoveCopyAction))(s),engagementName:"Move.FolderPanelTopMenu",classSuffix:"PrimaryButton"}),new a.default({text:o.default.copyConfirmButton,isDisabled:n.isDisabled,icon:n.isFluentEnabled?void 0:new i.default("CheckMark"),automationId:"folderTree-copy",action:new(n.managed(n._actionMap.MoveCopyAction))(l),engagementName:"Copy.FolderPanelTopMenu",classSuffix:"PrimaryButton"}),new(n.managed(a.default))({text:o.default.CreateFolderCommand,isHidden:n.isNewFolderHidden,isDisabled:n.isNewFolderDisabled,icon:n.isFluentEnabled?new i.default("Add"):new i.default("CirclePlus"),callback:function(){n.componentViewModel.focusedItem().showNewFolderInput(!0);n.componentViewModel.focusedItem().focusNewFolderInput(!0);n.isNewFolderDisabled(!0)},engagementName:"NewFolder.FolderPanelTopMenu"})]);return n}return t})(s.default);t.default=l});
define("odsp-next/utilities/sharing/SharingHelper",["require","exports","knockout","./SharingHelper.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../controls/confirmation/Confirmation","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","../../controls/textContainer/TextContainer","../../controls/commands/Commands.resx","../../controls/sharing/shareByEmail/Sharing.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/features/Features","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disableLinkConfirm=function(e,t,a,f){var l=n.observable(!0);return a.requestDialog({title:r.default.DisableLinkConfirmationTitle,size:"Medium",component:{name:s.default.tagName,params:{message:r.default.DisableLinkConfirmationMessage}},actions:[{name:r.default.DisableLinkConfirmationButton,execute:function(){i.Engagement.logData({name:"Confirm.DisableLink."+f+".Click",isIntentional:!0});l(!1);var n=e().then(function(e){return o.default.wrap(e?2:3)});t(n);return n},isDefault:!0,isAvailable:l,icon:new u.default("Save"),automationId:"UnshareConfirm"},{name:r.default.KeepExistingLinkButton,execute:function(){i.Engagement.logData({name:"KeepExisting.DisableLink."+f+".Click",isIntentional:!0});return o.default.wrap(3)},isDefault:!1,icon:new u.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.displayMessage=function(e,t,r){return r.requestDialog({title:t,size:"Small",component:{name:a.default.tagName,params:{text:e}},actions:[{name:f.default.Close,execute:function(){return o.default.wrap(2)},isAvailable:n.observable(!0),icon:new u.default("Save"),isDefault:!0}],executeDefaultAction:!1}).wait()};t.getSharingStatusText=function(e,t){for(var n=0,r=0,i=!1,s=0,o=e.people;s<o.length;s++){var u=o[s];if(2===u.entityType)r++;else if(0!==u.sharingInfo.role){n++;1===u.entityType&&(i=!0)}}var a="";r>0&&n>0?a=r>1?c.format(i?l.default.SharedWithPeopleGroupsAndExternalUsers:l.default.SharedWithPeopleAndGroups,t,r,n):c.format(i?l.default.SharedWithPeopleGroupAndExternalUsers:l.default.SharedWithPeopleAndGroup,t,n):1===r?a=c.format(l.default.SharedWithGroup,t):r>1?a=c.format(l.default.SharedWithGroups,t,r):n>0&&i?a=c.format(l.default.SharedWithPeopleAndExternalUsers,t,n):n>1?a=c.format(l.default.SharedWithPeople,t,n):1===n&&(a=c.format(l.default.SharedWithPerson,t));return a};t.getNumberOfDaysUntilExpiry=function(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)};t.isShareByWithYouEnabled=function(){var e=!1;if(h.isFeatureEnabled(h.EnableShareWithAndByStringsFeature)){e=new p.ABExperiment({name:"EnableShareWithAndByStringsExperiment",startDate:"4/22/2019",version:p.ABExpHash.v2},h.EnableShareWithAndByStringsExperiment).IsExperimentOn()}return e}});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder",["require","exports","./InlineFolderBuilder.html","./InlineFolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-inline-folder-builder",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-InlineFolderBuilder" data-bind="style:{width:width},keyboard:{allowInputEvents:true,mappings:{Enter:onEnter.bind($component),Esc:onEscape.bind($component)}}"><span><span class="od-InlineFolderBuilder-folderIcon" data-bind="component:{name:\'ms-file-type-icon\',params:{iconName:iconName,desiredSize:16}}"></span><input class="od-InlineFolderBuilder-textInput od-TextField-field" type="text" data-bind="value:newFolderName,textInput:newFolderName,click:onClickTextField.bind($component),hasFocus:optionalParams.hasFocus,style:{width:inputWidth},attr:{maxlength:255,placeholder:namePlaceholder,\'aria-label\':nameLabel},automation:automationId,enable:optionalParams.isEnabled"></span><div class="od-InlineFolderBuilder-status" aria-live="assertive" data-bind="text:optionalParams.status,css:{\'od-InlineFolderBuilder-status--error\':optionalParams.hasError}"></div><div><button class="od-Button od-Button--primary od-InlineFolderBuilder-createButton" data-bind="visible:newFolderName()&&optionalParams.isEnabled(),click:onClick.bind($component),attr:{\'aria-label\':createLabel}"><span class="od-Button-label" data-bind="text:buttonText"></span></button></div></div>'});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilderViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../providers/item/ItemProvider","../folderBuilder/FolderBuilder.resx","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=o.default.FolderNamePlaceholder;n.nameLabel=o.default.FolderNameLabel;n.createLabel=o.default.CreateFolderLabel;n.iconName=t.iconName;n.width=(t.width-57).toString()+"px";n.inputWidth=(t.width-89).toString()+"px";n.newFolderName=t.newFolderName||r.observable("");n.newFolderName("");n.buttonText=o.default.CreateFolderLabel;n.itemKey=t.itemKey;n.isActive=r.observable(!0);var i=t.optionalParams;n.optionalParams={dataUpdated:i&&i.dataUpdated?i.dataUpdated:r.observable(!1),showNewFolderInput:i&&i.showNewFolderInput?i.showNewFolderInput:r.observable(!0),hasError:i&&i.hasError?i.hasError:r.observable(!1),status:i&&i.status?i.status:r.observable(""),hasFocus:i&&i.hasFocus?i.hasFocus:r.observable(!0),isEnabled:i&&i.isEnabled?i.isEnabled:r.observable(!0),needsRefocus:i&&i.needsRefocus?i.needsRefocus:r.observable(!1)};n.addBindingHandlers({keyboard:a.default});n._itemProvider=n.resources.consume(s.resourceKey);n._actionMap=n.resources.consume(u.actionMap);return n}t.prototype.onClick=function(e,t){e.createNewFolder(t)};t.prototype.onEnter=function(e,t){e.createNewFolder(t);return!0};t.prototype.onClickTextField=function(e,t){t.stopPropagation()};t.prototype.onEscape=function(e,t){this.optionalParams.showNewFolderInput(!1);this.newFolderName("");this.optionalParams.status("");this.optionalParams.isEnabled(!0);this.optionalParams.needsRefocus(!0);t.stopPropagation();return!1};t.prototype.createNewFolder=function(e){var t=this,n={parentKey:this.itemKey};this._itemProvider.getItem(n).then(function(n){var r=n.item();new(t.managed(t._actionMap.CreateNewFolderAction))({parentItem:r,newFolderName:t.newFolderName,options:t.optionalParams}).execute(e)});e.stopPropagation()};return t})(i.default);t.default=f});
define("odsp-next/actions/userActivity/odc/UserActivityExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/userActivity/UserActivity","../../../controls/userActivity/UserActivity.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._panelProvider=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e;return(e=this._panelProvider.requestPanel({title:u.default.ActivityFeedTitle,component:{name:o.default.tagName,params:{onActivityClick:function(){e.state(1)}}}})).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t})(r.default);t.default=a});
define("odsp-next/controls/userActivity/UserActivity",["require","exports","./UserActivity.html","./UserActivityViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","./UserActivityTile"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-userActivity-feed",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/userActivity/UserActivity.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-UserActivity-Feed">\x3c!--ko if:isLoading()--\x3e<div class="od-UserActivity-Feed-Status" data-bind="text:statusText()"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<div class="od-UserActivity-Feed-List"><div data-bind="foreach:{data:activities,as:\'activity\'}">\x3c!--ko component:{name:\'ms-userActivity-tile\',params:{activity:activity,onActivityClick:$component.onActivityClick.bind($component)}}--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/userActivity/UserActivityViewModel",["require","exports","tslib","knockout","../infoPane/InfoPane.resx","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.statusText=r.observable(i.default.sharingLoadingStatus);n.isLoading=r.observable(!0);n.activities=r.observableArray([]);n.onActivityClick=t.onActivityClick;n._activityProvider=n.resources.consume(s.userActivity);n._activityProvider.getActivities().done(function(e){var t=e.activities.slice();n.activities(t);n.isLoading(!1);n.statusText("")},function(e){n.statusText(i.default.serverError)});return n}return t})(o.default);t.default=u});
define("odsp-next/controls/userActivity/UserActivityTile",["require","exports","./UserActivityTile.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserActivityTileViewModel","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-userActivity-tile",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/userActivity/UserActivityTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-UserActivityTile"><a data-bind="attr:{href:itemUrl,target:itemUrlTarget},click:onClick"><div class="od-UserActivityTile-ActorPhoto" data-bind="component:{name:\'od-persona\',params:{person:activity.actors[0],personaSize:$component.personaSize,showPresence:true,showName:false,iconType:\'Contact\'}}"></div><div class="od-UserActivityTile-Text"><div class="od-UserActivityTile-Message" data-bind="text:activity.message"></div><div class="od-UserActivityTile-Timestamp" data-bind="text:timestamp"></div></div></a></div>'});
define("odsp-next/controls/userActivity/UserActivityTileViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../../models/item/ItemType","../../dataSources/url/odc/UrlDataSource","../../resources/ODCResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../dataSources/url/PageType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n,u=e.call(this,t)||this;u._urlDataSource=u.resources.consume(o.urlDataSource);u.activity=t.activity;u.onActivityClick=t.onActivityClick;u.timestamp=r.getRelativeDateTimeStringPast(u.activity.timestamp);u.personaSize=4;u.actorImageUrl=u.activity.actors[0].image;if(u.activity.item.itemType===i.default.File){u.itemUrl=s.default.getResourceRedirectUrl(u.activity.item.id);u.itemUrlTarget="_blank"}else{u.itemUrl=u._urlDataSource.getItemUrl(u._urlDataSource.getKey(((n={}).id=u.activity.item.id,n)),{page:a.default.Files});u.itemUrlTarget="_top"}return u}t.prototype.onClick=function(e,t){this.onActivityClick();return!0};return t})(u.default);t.default=f});
define("odsp-next/actions/rename/odc/RenameExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../RenameHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._renameHelper=new(n.managed(s.default));n._itemReedemer=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){return e._renameHelper.renameItem(t,!1)})})};return t})(r.default);t.default=o});
define("odsp-next/actions/rename/RenameHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","./RenameItemOperator","../../resources/ControlResourceKeys","../../controls/itemNameEditor/ItemNameEditor","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dialogProvider=n.resources.consume(a.resourceKey);n._urlDataSource=n.resources.consume(h.url);n._parentItem=n.resources.consume(l.currentItem);return n}t.prototype.renameItem=function(e,t){var n=this,s=e.properties.FileName||e.name,a=e.extension;if(t){s+=e.extension;a=null}var l=this.observables.create(s),h=this.observables.create(""),p=this.observables.create(!1),d=this.observables.create(!0),v=this.observables.create(!0);return this._dialogProvider.requestDialog({title:u.default.Rename,component:{name:c.default.tagName,params:{name:l,extension:a,status:h,hasError:p,isEnabled:d,hasFocus:v}},actions:[{name:u.default.RenameCommit,execute:function(){var i=n.unwrapObservable(l);if(i===s)return r.default.wrap(2);if(i&&""===i.trim())return r.default.wrap(1);v(!1);d(!1);p(!1);return n.resources.consumeAsync(f.typeResourceKey).then(function(r){var s=new r({parentKey:n._parentItem().key,newName:i,nameHasExtension:t,item:e,ownerId:n._urlDataSource?n._urlDataSource.getOwnerId():""});return n.trackPromise(s.start())}).then(function(){return 2},function(e){p(!0);d(!0);v(!0);h(e.message);return 1})},isDefault:!0,isAvailable:this.observables.pureCompute(function(){return!!l().trim()&&d()}),automationId:"renameDialogCommit",icon:new i.default("Save")}]}).wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})};return t})(s.default);t.default=p});
define("odsp-next/actions/rename/RenameItemOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._fileSystemProvider=n.fileSystemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.renameItems;n.name=r.name;n.iconName=r.iconName;n.payloads.renameItems={item:r,parent:r.parent};n.visibility=2;return n};t.prototype.onStart=function(e){return this._fileSystemProvider.renameItem(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{fileSystemProvider:i.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._photoProvider=t.photoProvider;n._itemProvider=t.itemProvider;n._urlDataSource=t.urlDataSource;n._rootId=t.rootId;return n}t.prototype.execute=function(e){var t=this;return this._findFolderId(this._rootId).then(function(e){return t._photoProvider.setAllPhotosSettings({cid:s.default.viewerId,allPhotosFolderId:e,allPhotosSortDirection:"2",rset:"odweb",id:"root"}).then(function(e){t._photoProvider.getAllPhotosSettings(!0);return{resultType:o.ResultTypeEnum.Success}},function(e){return{resultType:o.ResultTypeEnum.Failure}})})};t.prototype._findFolderId=function(e){if("ROOT"===this._rootId)return i.default.wrap("root");if("ALLPHOTOSFOLDER"===this._rootId){var t=this._getContextForPhoto();this._itemProvider.getItemSync(t);return this._itemProvider.getItem(t).then(function(e){return e.item&&e.item.peek().id},function(e){return i.default.resolve("root")})}if(u.isFeatureEnabled(u.SamsungGalleryFilter)&&"SAMSUNGFOLDER"===this._rootId){t=this._getContextForSpecial();this._itemProvider.getItemSync(t);return this._itemProvider.getItem(t).then(function(e){return e.item&&e.item.peek().id},function(e){return i.default.resolve("root")})}return i.default.wrap("root")};t.prototype._getContextForPhoto=function(){var e;return{parentKey:this._urlDataSource.getKey((e={},e.id="photos",e)),skipCache:!0,skipInMemoryCache:!0,pageSize:1}};t.prototype._getContextForSpecial=function(){var e;return{parentKey:this._urlDataSource.getKey((e={},e.id="samsungGallery",e)),skipCache:!0,skipInMemoryCache:!0,pageSize:1}};return t})(r.default);t.default=a});
define("odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../controls/reportAbuseDialog/ReportAbuseDialog","../../../controls/reportAbuseDialog/ReportAbuseDialog.resx","../../../models/item/AbuseType","../../../providers/item/ItemProvider","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._showNewReportAbuseDialog=h.isFeatureEnabled(h.UseNewReportAbuseDialog);n._abuseText=n.observables.create(null);n._abuseType=n.observables.create(null);n._selectionHelper=t.selectionHelper;n._provider=n.resources.consume(c.resourceKey);n._dialogProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){return this._executeReportAbuse()};t.prototype._executeReportAbuse=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._getReportAbuseDialog().then(function(){return e._provider.reportAbuse({item:t,rao:e._abuseType.peek(),desc:e._abuseText.peek()}).then(function(){return{resultType:o.ResultTypeEnum.Success}})})})};t.prototype._getReportAbuseDialog=function(){var e=this;return this._dialogProvider.requestDialog({title:this._showNewReportAbuseDialog?"":f.default.title,component:{name:a.default.tagName,params:{abuseType:this._abuseType,abuseText:this._abuseText,selectionHelper:this._selectionHelper,dialogProvider:this._dialogProvider}},customCssClasses:this._showNewReportAbuseDialog?"od-create-reportAbuse-newFlow":"",dismissOnEsc:!!this._showNewReportAbuseDialog,actions:this._showNewReportAbuseDialog?[]:[{name:f.default.title,execute:function(){return r.default.wrap(2)},isAvailable:this.createComputed(function(){return e._abuseType&&(e._abuseType()||0===e._abuseType())&&e._abuseType()!==l.default.copyrightInfringement}),isDefault:!0,icon:new i.default("EditNote"),automationId:"reportAbuseConfirm"}]}).wait()};return t})(s.default);t.default=p});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog",["require","exports","./ReportAbuseDialog.html","./ReportAbuseDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-report-abuse",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showNewReportAbuseDialog--\x3e<div class="ms-newReportAbuseDialog" data-bind="react:{componentType:reportAbuseComponent,props:reportAbuseProps}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:showNewReportAbuseDialog--\x3e<div class="ReportAbuseDialog"><div><span data-bind="text:strings.headerPart1"></span><a target="_blank" data-bind="text:strings.headerPart2,attr:{href:codeOfConductUrl}" a></a></div><div class="ms-reportAbuseDialog-option"><input type="radio" name="abuseType" id="abuseTypeSpam" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.spam"><a target="_blank" data-bind="text:strings.spam,attr:{href:spamUrl}"></a></div><div class="ms-reportAbuseDialog-option"><input type="radio" id="abuseTypeNudityOrPornography" name="abuseType" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.nudityOrPornography"><label for="abuseTypeNudityOrPornography" data-bind="text:strings.nudityOrPornography"></label></div><div class="ms-reportAbuseDialog-option"><input type="radio" name="abuseType" id="abuseTypeHarassmentOrThreatening" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.harassmentOrThreatening"><label for="abuseTypeHarassmentOrThreatening" data-bind="text:strings.harassmentOrThreatening"></label></div><div class="ms-reportAbuseDialog-option"><input type="radio" name="abuseType" id="abuseTypechildEndangermentOrExploitation" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.childEndangermentOrExploitation"><label for="abuseTypechildEndangermentOrExploitation" data-bind="text:strings.childEndangermentOrExploitation"></label></div><div class="ms-reportAbuseDialog-option"><input type="radio" name="abuseType" id="abuseTypeCopyrightInfringement" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.copyrightInfringement"><span>\x3c!--ko if:abuseType()!==abuseTypeEnum.copyrightInfringement--\x3e<label for="abuseTypeCopyrightInfringement" data-bind="text:strings.copyrightInfringementShort">&nbsp;</label>\x3c!--/ko--\x3e\x3c!--ko if:abuseType()===abuseTypeEnum.copyrightInfringement--\x3e<label for="abuseTypeCopyrightInfringement" data-bind="text:strings.copyrightInfringementLong1"></label><a target="_blank" data-bind="text:strings.copyrightInfringementLong2,attr:{href:copyrightUrl}"></a>\x3c!--/ko--\x3e</span></div><div class="ms-reportAbuseDialog-option"><input type="radio" name="abuseType" id="abuseTypeOther" data-bind="checked:abuseType,checkedValue:abuseTypeEnum.other"><label for="abuseTypeOther" data-bind="text:strings.other"></label></div><div class="ms-reportAbuseDialog-text-header"><span data-bind="text:strings.detailsTextHeader"></span></div><textarea class="ms-reportAbuseDialog-text-area" data-bind="enable:abuseType()!==abuseTypeEnum.copyrightInfringement&&abuseType()!==abuseTypeEnum.spam,value:abuseText"></textarea><div class="ms-reportAbuseDialog-privacy"><a id="privLnk" target="_blank" data-bind="text:strings.privacyStatement,attr:{href:privacyUrl}" a></a></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/AbuseType","./ReportAbuse","../../bindings/react/ReactBinding","../../utilities/features/Features","./ReportAbuseDialog.resx"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.abuseTypeEnum=i.default;n.strings=a.default;n.spamUrl="https://go.microsoft.com/fwlink/?LinkId=117951";n.privacyUrl="https://go.microsoft.com/fwlink/?LinkId=521839";n.copyrightUrl="https://www.microsoft.com/info/cpyrtInfrg.aspx";n.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=521839";n.showNewReportAbuseDialog=u.isFeatureEnabled(u.UseNewReportAbuseDialog);n.addBindingHandlers({react:o.default});n.reportAbuseComponent=s.default;n.reportAbuseProps={resources:n.resources,selectionHelper:t.selectionHelper,dialogProvider:t.dialogProvider};n.abuseType=t.abuseType;n.abuseText=t.abuseText;return n}return t})(r.default);t.default=f});
define("odsp-next/models/item/AbuseType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.spam=0]="spam";e[e.nudityOrPornography=1]="nudityOrPornography";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation";e[e.other=4]="other";e[e.copyrightInfringement=5]="copyrightInfringement"})(n||(n={}));(function(e){e[e.malwareOrViruses=0]="malwareOrViruses";e[e.sexuallyInappropriate=1]="sexuallyInappropriate";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childSexualExploitation=3]="childSexualExploitation";e[e.other=4]="other";e[e.terroristContent=5]="terroristContent";e[e.fraudOrSpam=6]="fraudOrSpam";e[e.hateSpeech=7]="hateSpeech";e[e.imminentHarm=8]="imminentHarm";e[e.copyrightInfringement=9]="copyrightInfringement"})(t.ReportAbuseType||(t.ReportAbuseType={}));t.default=n});
define("odsp-next/controls/reportAbuseDialog/ReportAbuse",["require","exports","tslib","react","prop-types","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/shared-react-report-abuse/lib/components/ReportAbuse/ReportAbuse","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/DataSourceResourceKeys","../../models/item/AbuseType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._clientId="odweb";n.state={mode:o.Mode.default};n._headerProps={imageUrl:window.require.toUrl("odsp-media/images/reportconcern/reportconcerninitial.png"),close:function(){n._executeCloseAction()}};n._reportAbuseMainProps={reportAction:function(e,t){n._executeReportAction(e,t)}};n._reportAbuseSentProps={close:function(){n._executeCloseAction()}};n._errorBarProps={clickErrorCancel:function(){n._updateState(o.Mode.default)}};n._selectionHelper=n.props.selectionHelper;n._dialogProvider=n.props.dialogProvider;return n}t.prototype.getChildContext=function(){return{reportAbuseClickTime:window._ReportAbuseStartTime||Date.now()}};t.prototype.render=function(){return r.createElement(o.ReportAbuse,{headerProps:this._headerProps,reportAbuseMainProps:this._reportAbuseMainProps,reportAbuseSentProps:this._reportAbuseSentProps,erroBarProps:this._errorBarProps,mode:this.state.mode,clientId:this._clientId})};t.prototype._executeCloseAction=function(){var e=this._dialogProvider.currentDialog.peek();e&&e.dismiss()};t.prototype._executeReportAction=function(e,t){var n=this;s.Engagement.logData({name:"ReportAbuseV2.Report.Click",isIntentional:!0,extraData:{clientId:this._clientId,reportAbuseCategory:e,reportAbuseDescription:t}});var r=new u.Qos({name:"ReportAbuseV2.Report.Submit",extraData:{clientId:this._clientId}});this._updateState(o.Mode.spinner);return this._selectionHelper.resolveFirst().then(function(i){return n._getItemDataSource().then(function(s){return s.reportAbuse({item:i,rao:f.ReportAbuseType[e],desc:t}).then(function(){r.end({resultType:u.ResultTypeEnum.Success});n._headerProps={imageUrl:window.require.toUrl("odsp-media/images/reportconcern/reportconcernsuccess.png"),close:function(){n._executeCloseAction()}};n._updateState(o.Mode.success);return{resultType:u.ResultTypeEnum.Success}},function(e){r.end({resultType:u.ResultTypeEnum.Failure});n._updateState(o.Mode.error)})})})};t.prototype._getItemDataSource=function(){return this.props.resources.consumeAsync(a.items)};t.prototype._updateState=function(e){this.setState({mode:e})};t.childContextTypes={reportAbuseClickTime:i.number};return t})(r.Component);t.default=l});
define("@ms/shared-react-report-abuse/lib/components/ReportAbuse/ReportAbuse",["require","exports","tslib","react","prop-types","@ms/odsp-utilities/lib/logging/events/Qos.event","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Fabric","office-ui-fabric-react/lib/Styling","office-ui-fabric-react/lib/FocusTrapZone","../../utilities/EngagementHelper","../Header/Header","../ReportAbuseMain/ReportAbuseMain","../ReportActivityIndicator/ReportActivityIndicator","../ReportAbuseSent/ReportAbuseSent","../../utilities/ReportAbuseCommunicationManager","../../utilities/ReportAbuseHelper","../ErrorBar/ErrorBar","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";y=y.ReportAbuse_1;Object.defineProperty(t,"__esModule",{value:!0});var b;(function(e){e[e.default=0]="default";e[e.spinner=1]="spinner";e[e.success=2]="success";e[e.error=3]="error"})(b=t.Mode||(t.Mode={}));var w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onReportClick=function(e,t){r._engagementHelper.reportButtonClicked({clientId:r.props.clientId,reportAbuseCategory:e,reportAbuseDescription:t});r._qos=new s.default({name:"ReportAbuseV2.Report.Submit",extraData:{clientId:r.props.clientId}});r._updateState(b.spinner);v.reportButtonClicked(e,t)};r._listenForMessages=function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}var n=t.name;"reportAbuse_success"===n?r._updateState(b.success):"reportAbuse_failure"===n&&r._updateState(b.error);if(r._qos){r._qos.end({resultType:"reportAbuse_success"===n?s.ResultTypeEnum.Success:s.ResultTypeEnum.Failure});r._qos=void 0}};r._onCloseClick=function(){v.dismiss()};r._onClickErrorCancel=function(){r._updateState(b.default)};r._updateState=function(e){r.setState({mode:e})};r._reportAbuseClickTime=n.reportAbuseClickTime;r._engagementHelper=new l.EngagementHelper;r._focusClassName="ms-ChoiceField-input";r.state={mode:b.default};t.isDarkMode&&r._loadTheme(m.DarkThemeSpec);return r}t.prototype.componentDidMount=function(){this._engagementHelper.opened({clientId:this.props.clientId});v.pageFinishedLoading(this._reportAbuseClickTime,this.props.clientId);window.addEventListener("message",this._listenForMessages,!1)};t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this._listenForMessages,!1)};t.prototype.render=function(){var e,t=this.props,n=t.headerProps,i=t.reportAbuseMainProps,s=t.reportAbuseSentProps,a=t.erroBarProps,l=t.isHosted,m=t.initialImageUrl,w=t.successImageUrl,E=l?this.state.mode:this.props.mode;if(E===b.success){v.resize(339,400);e=r.createElement(f.FocusTrapZone,{isClickableOutsideFocusTrap:!0},r.createElement("div",{className:y.reportAbuseSentDialog},r.createElement(c.Header,{imageUrl:l?w:n.imageUrl,imageHeight:132,imageWidth:400,close:l?this._onCloseClick:n.close}),r.createElement(d.ReportAbuseSent,{close:l?this._onCloseClick:s.close})))}else{var S=E===b.spinner?y.blocker:"",x=E===b.error?y.reportAbuseErrorDialog:o.css(y.reportAbuseDialog,S),T=E===b.error?743:695;v.resize(T,400);e=r.createElement(f.FocusTrapZone,{firstFocusableSelector:this._focusClassName,isClickableOutsideFocusTrap:!0},r.createElement("div",{className:x},r.createElement(c.Header,{imageUrl:l?m:n.imageUrl,imageHeight:112,imageWidth:400,close:l?this._onCloseClick:n.close}),E===b.error&&r.createElement(g.default,{clickErrorCancel:l?this._onClickErrorCancel:a.clickErrorCancel}),r.createElement(h.ReportAbuseMain,{reportAction:l?this._onReportClick:i.reportAction}),E===b.spinner&&r.createElement(p.default,null)))}return r.createElement(u.Fabric,null,r.createElement("div",{className:l?y.reportAbuseClass:""},e))};t.prototype._loadTheme=function(e){try{var t=e;a.loadTheme(t)}catch(e){}};t.contextTypes={reportAbuseClickTime:i.number};return t})(r.Component);t.ReportAbuse=w});
define("@ms/shared-react-report-abuse/lib/utilities/EngagementHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this;this.opened=function(t){e.log("Opened",t)};this.reportButtonClicked=function(t){e.log("Report.Click",t)};this.log=function(e,t){var i={name:"ReportAbuseV2."+e,extraData:n.__assign(n.__assign({},t),{clientId:t&&t.clientId,reportAbuseCategory:t&&t.reportAbuseCategory,reportAbuseDescription:t&&t.reportAbuseDescription})};r.Engagement.logData(i)}};t.EngagementHelper=i});
define("@ms/shared-react-report-abuse/lib/components/Header/Header",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Image","office-ui-fabric-react/lib/Button","../../utilities/ReportAbuseHelper","../ReportAbuse.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";f=f.Header_7;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._platformDetection=n.platformDetection;r._clientId=n.clientId;return r}t.prototype.render=function(){var e=this.props,t=e.imageUrl,n=e.imageHeight,i=e.imageWidth,l=e.close,c=u.isMobile(this._platformDetection,this._clientId)?f.reportAbuseCloseButtonMobile:f.reportAbuseCloseButtonWeb;return r.createElement("div",{className:f.reportAbuseHeader},r.createElement(s.Image,{alt:a.default.reportAbuseImgAlt,src:t,height:n,width:i,shouldStartVisible:!0,role:"presentation"}),r.createElement(o.IconButton,{ariaLabel:a.default.cancelAriaLabel,className:c,onClick:l,iconProps:{iconName:"Cancel"}}))};t.contextTypes={platformDetection:i.object.isRequired,clientId:i.string};return t})(r.Component);t.Header=l});
define("@ms/shared-react-report-abuse/lib/utilities/ReportAbuseHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DarkPalette={themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"rgba(255, 255, 255, 0.22)",neutralLight:"rgba(255, 255, 255, 0.10)",neutralQuaternaryAlt:"#6f6f6f",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#2B2B2B",primaryBackground:"#f9f8f7",primaryText:"#2B2B2B",bodyBackground:"#2B2B2B",bodyText:"#2B2B2B",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"};t.DarkSemanticColors={menuBackground:"#1F1F1F",pauseIconHover:"#2d2d2d",overflowIconHover:"#2B2B2B",accountItemHover:"#2d2d2d",separatorFill:"#D3D3D3",overflowIconDoubleHover:"#21201f",activityItemBackground:"#2B2B2B",activityItemMenuBackground:"#9AA9B2",activityItemProgressBadge:"#191919",activityItemProgressBar:"#0e95ff",activityItemDescLink:"#3285c6",activityItemMenuBorder:"#333333",overflowIconColor:"#F3F2F1",accountStatusError:"#FFCCCC",accountStatusWarning:"#FFF4CE",issueBarText:"#000",issueBarBorderFill:"#d7abab",overflowContainerBackground:"#4d4d4d",navPaneBackgroundColor:"#1F1F1F",navTrayIconCheckedBackgroundColor:"#3b3a39",navTrayIconHoverBackgroundColor:"#323130",navTrayBackgroundColor:"rgba(0, 0, 0, 0.25)",accentColor:"#0078D4",syncCalloutBackground:"#2d2d2d",accountStatusButtonBackground:"rgba(255, 255, 255, 0.15)",accountStatusButtonBackgroundHover:"#3D3D3D"};t.DarkThemeSpec={palette:t.DarkPalette,semanticColors:t.DarkSemanticColors};function n(e,t){return e&&e.isIOS||!!t&&t.toLowerCase().endsWith("ios")}t.isIOS=n;function r(e,t){return e&&e.isAndroid||!!t&&t.toLowerCase().endsWith("android")}t.isAndroid=r;t.isMobile=function(e,t){return n(e,t)||r(e,t)}});
define("@ms/shared-react-report-abuse/lib/components/ReportAbuseMain/ReportAbuseMain",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/ChoiceGroup","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","../../utilities/ReportAbuseHelper","../ReportAbuse.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";h=h.ReportAbuseMain_9;Object.defineProperty(t,"__esModule",{value:!0});var p={sexuallyInappropriate:c.default.sexuallyInappropriate,terroristContent:c.default.terroristContent,childSexualExploitation:c.default.childSexualExploitation,imminentHarm:c.default.imminentHarm,hateSpeech:c.default.hateSpeech,malwareOrViruses:c.default.malwareOrViruses,fraudOrSpam:c.default.fraudOrSpam,copyrightInfringement:c.default.copyrightInfringement,other:c.default.other},d=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i._onRenderField=function(e,t){return r.createElement(r.Fragment,null,t&&t(e),e&&e.checked&&r.createElement(v,{setTextFieldValue:i.setTextFieldValue,platformDetection:i._platformDetection,clientId:i._clientId}))};i._onRenderCopyright=function(e,t){return r.createElement(r.Fragment,null,t&&t(e),e&&e.checked&&r.createElement("div",{className:h.reportAbuseCopyRightText},c.default.detailsCopyrightInfringementText,r.createElement(s.Link,{className:h.reportAbuseCopyRightLink,href:"https://www.microsoft.com/info/cpyrtInfrg.aspx",target:"_blank"},c.default.detailsCopyrightInfringementLink)))};i._onChange=function(e,t){i.setState({isChecked:"copyrightInfringement"!==t.key,selectedKey:t.key})};i._onClickReport=function(){i.props.reportAction&&i.props.reportAction(i.state.selectedKey,i._textValue)};i.setTextFieldValue=function(e){i._textValue=e};i._platformDetection=n.platformDetection;i._clientId=n.clientId;i.state={isChecked:!1,selectedKey:void 0};return i}t.prototype.render=function(){var e=this,t=l.isAndroid(this._platformDetection,this._clientId)?h.reportAbuseReportButtonAndroid:l.isIOS(this._platformDetection,this._clientId)?h.reportAbuseReportButtoniOS:h.reportAbuseReportButtonWeb;return r.createElement("div",{className:h.reportAbuseDescription},r.createElement("h1",{className:h.reportAbuseHeaderLabel},c.default.reportAbuseHeader),r.createElement("div",{className:h.reportAbuseHeader},r.createElement(o.Label,{className:h.reportAbuseHeaderText},c.default.tellConcernText,c.default.forReference),r.createElement(s.Link,{"aria-label":c.default.CodeOfConduct,className:h.codeOfConductLink,href:"https://go.microsoft.com/fwlink/?linkid=2112224",target:"_blank"},c.default.CodeOfConduct)),r.createElement("div",{className:this.state.selectedKey?"copyrightInfringement"===this.state.selectedKey?h.choiceGroupCopyrightSelected:h.choiceGroupSelected:h.choiceGroupNotSelected},r.createElement(u.ChoiceGroup,{autoFocus:!0,selectedKey:this.state.selectedKey,options:Object.keys(p).map(function(t){return{key:t,text:p[t],onRenderField:"copyrightInfringement"===t?e._onRenderCopyright:e._onRenderField,ariaLabel:e.state.selectedKey?p[t]:c.default.choiceGroupAriaLabel+p[t]}}),onChange:this._onChange})),r.createElement("div",{className:h.reportAbuseFooter},r.createElement(o.Label,{className:h.reportAbuseFooterLabel},c.default.privacyStatementHeader,r.createElement(s.Link,{className:h.privacyStatementLink,href:"https://go.microsoft.com/fwlink/?LinkId=521839",target:"_blank"},c.default.privacyStatementLink))),r.createElement(f.PrimaryButton,{className:t,onClick:this._onClickReport,disabled:!this.state.isChecked},c.default.reportButton))};t.contextTypes={platformDetection:i.object.isRequired,clientId:i.string};return t})(r.Component);t.ReportAbuseMain=d;var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onTextFieldChange=function(e,t){n.setState({textFieldValue:t});n.props.setTextFieldValue(t)};n.state={textFieldValue:void 0};return n}t.prototype.render=function(){var e=l.isAndroid(this.props.platformDetection,this.props.clientId)?h.reportAbuseTextFieldAndroid:l.isIOS(this.props.platformDetection,this.props.clientId)?h.reportAbuseTextFieldiOS:h.reportAbuseTextFieldWeb;return r.createElement(a.TextField,{className:e,placeholder:c.default.detailsPlaceholderText,value:this.state.textFieldValue,onChange:this._onTextFieldChange,multiline:!0,resizable:!1,ariaLabel:c.default.textFieldName})};return t})(r.Component)});
define("@ms/shared-react-report-abuse/lib/components/ReportActivityIndicator/ReportActivityIndicator",["require","exports","react","office-ui-fabric-react/lib/Spinner","../ReportAbuse.resx","ODCExecutors_css"],function(e,t,n,r,i,s){"use strict";s=s.ReportActivityIndicator_9;Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){return n.createElement(r.Spinner,{className:s.reportAbuseActivityIndicator,label:i.default.reportActivityIndicatorLabel,size:r.SpinnerSize.large,"aria-live":"assertive"})}});
define("@ms/shared-react-report-abuse/lib/components/ReportAbuseSent/ReportAbuseSent",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Button","../../utilities/ReportAbuseHelper","../ReportAbuse.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";l=l.ReportAbuseSent_1;Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._platformDetection=n.platformDetection;r._clientId=n.clientId;return r}t.prototype.render=function(){var e=a.isAndroid(this._platformDetection,this._clientId)?l.reportAbuseSentHeaderLabelAndroid:a.isIOS(this._platformDetection,this._clientId)?l.reportAbuseSentHeaderLabeliOS:l.reportAbuseSentHeaderLabelWeb,t=a.isAndroid(this._platformDetection,this._clientId)?l.reportAbuseSentReportButtonAndroid:a.isIOS(this._platformDetection,this._clientId)?l.reportAbuseSentReportButtoniOS:l.reportAbuseSentReportButtonWeb;return r.createElement("div",{className:l.reportAbuseSentDescription},r.createElement("h1",{id:"reportAbuseSentHeaderLabel",className:e},f.default.reportAbuseSentHeader),r.createElement(o.Label,{id:"reportAbuseSentTextLabel",className:l.reportAbuseSentTextLabel},f.default.reportSentText,r.createElement(s.Link,{"aria-label":f.default.CodeOfConduct,className:l.codeOfConductLink,href:"https://go.microsoft.com/fwlink/?linkid=2112224",target:"_blank"},f.default.CodeOfConduct)),r.createElement(u.PrimaryButton,{id:"reportButton",autoFocus:!0,"aria-labelledby":"reportAbuseSentHeaderLabel reportAbuseSentTextLabel reportButton",className:t,onClick:this.props.close},f.default.reportSentButton))};t.contextTypes={platformDetection:i.object.isRequired,clientId:i.string};return t})(r.Component);t.ReportAbuseSent=c});
define("@ms/shared-react-report-abuse/lib/utilities/ReportAbuseCommunicationManager",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1;t.reportButtonClicked=function(e,t){try{window.external.ReportClicked(e,t)}catch(r){var n={name:"reportAbuse_reportClicked",reportAbuseType:e,reportAbuseText:t};window.parent.postMessage(JSON.stringify(n),"*")}};t.dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"reportAbuse_dismiss"}),"*")}};t.resize=function(e,t){try{window.external.Resize(e,t)}catch(r){var n={name:"reportAbuse_resize",height:e,width:t};window.parent.postMessage(JSON.stringify(n),"*")}};t.pageFinishedLoading=function(e,t){(function(e,t){if(!r){r=!0;if(e){new n.default({name:"ReportAbuseV2.PageLoaded",startTimeOverride:e,extraData:{clientId:t}}).end({resultType:n.ResultTypeEnum.Success})}}})(e,t);try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"reportAbuse_ready"}),"*")}}});
define("@ms/shared-react-report-abuse/lib/components/ErrorBar/ErrorBar",["require","exports","react","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Icon","../ReportAbuse.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o){"use strict";o=o.ErrorBar_5;Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){return n.createElement("div",{className:o.reportAbuseErrorBar},n.createElement(i.Icon,{iconName:"ErrorBadge",className:o.reportAbuseErrorIcon}),n.createElement(r.Label,{id:"reportAbuseErrorText",className:o.reportAbuseErrorText},s.default.reportSentErrorText))}});
define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/removeFromSharedList/RemoveFromSharedList","../../../controls/removeFromSharedList/RemoveFromSharedList.resx","../../../models/item/ItemType","../../../utilities/icons/Icon","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._itemProvider=n.resources.consume(l.resourceKey);n._dialogProvider=n.resources.consume(c.resourceKey);n._currentItem=t.currentItem;return n}t.prototype.execute=function(){var e=this,t=this.observables.create(!1),n=this.observables.create(""),i=this.observables.create(!1),l=this._currentItem&&this._currentItem.key;return this._selectionHelper.resolveSelection().then(function(c){return e._dialogProvider.requestDialog({title:c.length>1?u.default.itemsTitle:c[0].type===a.default.File?u.default.fileTitle:u.default.folderTitle,component:{name:o.default.tagName,params:{isSpam:t,selection:c,removeAccess:!0,hasError:i,status:n}},actions:[{name:u.default.actionText,execute:function(){return r.default.wrap(2)},isAvailable:e.observables.create(!0),isDefault:!0,icon:new f.default("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait().then(function(){return e._itemProvider.removeFromSharedList({items:c,markAsSpam:t(),parentKey:l}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t})(i.default);t.default=h});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList",["require","exports","./RemoveFromSharedList.html","./RemoveFromSharedListViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-remove-from-sharedlist",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-RemoveFromSharedList"><div class="od-RemoveFromSharedList-SubText" data-bind="text:subText"></div><span data-bind="if:allowSpam"><input id="RemoveFromSharedList-isSpam" type="checkbox" name="isSpam" class="od-isSpam" data-bind="checked:isSpam"><label for="RemoveFromSharedList-isSpam" class="spamText" data-bind="text:spamText"></label></span><div class="od-RemoveFromSharedList-Status" data-bind="text:status,css:{\'od-RemoveFromSharedList-Status--error\':hasError}"></div></div>'});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RemoveFromSharedList.resx","../../models/item/ItemType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n.allowSpam=!!t.isSpam;n.isSpam=t.isSpam;n.status=t.status;n.hasError=t.hasError;var r=t.selection;t.hasError()?n.subText="":t.removeAccess?n.subText=r.length>1?i.default.itemsSubText:r[0].type===s.default.File?i.default.fileSubText:i.default.folderSubText:n.subText=r.length>1?i.default.itemsSubTextWithAccess:r[0].type===s.default.File?i.default.fileSubTextWithAccess:i.default.folderSubTextWithAccess;n.spamText=r.length>1?i.default.itemsSpamText:r[0].type===s.default.File?i.default.fileSpamText:i.default.folderSpamText;return n}return t})(r.default);t.default=o});
define("odsp-next/actions/requestReview/odc/RequestReviewExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/requestReviewDialog/RequestReviewDialog","../../../controls/requestReviewDialog/RequestReviewDialog.resx","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._itemProvider=n.resources.consume(f.resourceKey);n._dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._dialogProvider.requestDialog({title:a.default.title,component:{name:u.default.tagName,params:{items:t}},actions:[{name:a.default.actionButtonText,execute:function(){return r.default.wrap(2)},isAvailable:e.observables.create(!0),isDefault:!0,icon:new o.default("EditNote"),automationId:"requestReviewConfirm"}]}).wait().then(function(){return e._itemProvider.requestReview({items:t}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t})(i.default);t.default=c});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialog",["require","exports","./RequestReviewDialog.html","./RequestReviewDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-requestreview-dialog",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialog.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div><span data-bind="text:confirmPart1"></span><a target="_blank" data-bind="text:strings.confirmPart2,attr:{href:codeOfConductUrl}"></a><span data-bind="text:contactString"></span></div>'});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialogViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./RequestReviewDialog.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.strings=s.default;n.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=117951";n.contactString=r.observable(null);n.contactString(o.format(n.strings.reviewContact,$Config.email));n.confirmPart1=o.pluralSelect(t.items.length,n.strings.confirmPart1Single,n.strings.confirmPart1Multiple);return n}return t})(i.default);t.default=u});
define("odsp-next/actions/restoreAll/odc/RestoreAllExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/commands/Commands.resx","../../../providers/fileSystem/FileSystemProvider","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._currentItem=t.currentItem;n._fileSystemProvider=n.resources.consume(a.resourceKey);n._dialogProvider=n.resources.consume(f.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._dialogProvider.requestDialog({title:u.default.recycleBinRestoreAllConfirmText,component:{name:l.default.tagName,params:{text:u.default.recycleBinRestoreAllSubText}},actions:[{name:u.default.restore,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new o.default("RevToggleKey"),isDefault:!0}]}).wait().then(function(){return e._fileSystemProvider.restoreAll({parentKey:e._currentItem.peek().key}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})};return t})(i.default);t.default=c});
define("odsp-next/actions/save/SaveExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/operator/SaveOperator","../../providers/item/ItemContentProvider","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._currentItem=t.currentItem;n._itemContentsProvider=n.resources.consume(o.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){var n=e._itemContentsProvider.getItemContent(t),r=n.memoryContent.peek(),o=e.getFullFileName(t),a=new Blob([r.text],{type:t.textEditorMimeType});a.name=o;a.eTag=n.correspondingETag;return e.resources.consumeAsync(s.typeResourceKey).then(function(n){var r=new n({files:[a],parentItem:e._currentItem,wasDragAndDropped:!1,type:u.UploadProcessorType.Html5file,item:t});e.trackPromise(r.start());return r.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure,error:e?e.message||e:"Unkown error occurred whil trying to save a file"}})})};t.prototype.getFullFileName=function(e){return e.name+e.extension};return t})(r.default);t.default=a});
define("odsp-next/providers/operator/SaveOperator",["require","exports","tslib","./UploadOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","../../providers/item/ItemContentProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=this;t.behavior=1;t.scenario="SaveFile";r=e.call(this,t,n)||this;var i=n.itemContentProvider;r._itemContentsProvider=i;r.registerActions({restart:null,compare:r._onCompare,overwrite:r._onReplace});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=i.default.saveItem;n.name=r.fileName.peek();n.iconName=r.iconName.peek();n.payloads.uploadItems={parent:this._context.parentItem,name:r.fileName.peek()};0===r.state.peek()&&(n.state=s.default.created);n.progress.maximum=r.totalBytes.peek();n.progress.current=r.uploadedBytes.peek();switch(t.status){case 0:this._handleStart(n);break;case 1:this._handleSucceeded(n);break;case 2:this._handleFailed(n,t.error)}return n};t.prototype.onCancel=function(t,n){if(this._context.item){var r=this._itemContentsProvider.getItemContent(this._context.item);r.saveSucceded();for(var i=0,s=t;i<s.length;i++){0===s[i].status&&r.saveFailed()}}return e.prototype.onCancel.call(this,t,n)};t.prototype._handleStart=function(e){e.actions.push(this.onCancel);if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).startingSave()}};t.prototype._handleSucceeded=function(e){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveSucceded()}};t.prototype._handleFailed=function(e,t){t&&(e.error.payloads.upload={error:t});if(t&&t.errorType===o.UploadErrorType.versionMismatch){e.actions.push(this._onCompare);e.actions.push(this._onReplace)}if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveFailed()}};t.prototype._onReplace=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(3);i.input.restart()}return u.default.wrap()};t.prototype._onCompare=function(e,t){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).outDated(!0);this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}return this.onCancel(e,t)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemContentProvider:a.resourceKey});return t})(r.default);t.default=l;t.typeResourceKey=f.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/providers/operator/UploadOperator",["require","exports","tslib","./BaseUploadOperator","knockout","../../providers/item/ItemProvider","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.itemProvider,s=n.didUserUploadOrCreateFile,o=n.isItemsScopeEnabled;r.itemProvider=i;r._isItemsScopeEnabled=o();r._invalidateItem=r.createBackgroundComputed(r._computeInvalidateItem).extend({rateLimit:{timeout:4e3}});r._shouldInvalidate=!t.skipInvalidation||r._isItemsScopeEnabled;r._context.itemSet&&(r._currentItem=r._context.itemSet.item.peek());r._didUserUploadOrCreateFile=s;r._context.onItemUploaded&&(r._onItemUploadedCallback=r._context.onItemUploaded);return r}t.prototype.dispose=function(){this._shouldInvalidate&&this._invalidateItem();e.prototype.dispose.call(this)};t.prototype.onItemUploaded=function(e){if(this._currentItem||this._context.ignoreCurrentItem){this._didUserUploadOrCreateFile&&this._didUserUploadOrCreateFile(!0);this._onItemUploadedCallback&&this._onItemUploadedCallback(e)}};t.prototype.onOperationFinished=function(t){this._shouldInvalidate&&this._invalidateItem();e.prototype.onOperationFinished.call(this,t)};t.prototype._computeInvalidateItem=function(){var e=this;this._lastUploadedItem();if(!i.computedContext.isInitial()&&this._shouldInvalidate){this.itemProvider.invalidateItem(this._context.parentItem.key,{triggerFetch:!0});this._context.item&&this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0});this._isItemsScopeEnabled&&this.resources.consumeAsync(a.itemInvalidator).then(function(t){t.invalidateItems(e._context.parentItem.key)})}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{itemProvider:s.resourceKey,didUserUploadOrCreateFile:o.didUserUploadOrCreateFile.optional,isItemsScopeEnabled:f.isItemsScopeEnabledResourceKey.lazy});return t})(r.default);t.default=l;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/providers/operator/BaseUploadOperator",["require","exports","tslib","./BaseOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event","@ms/odsp-utilities/lib/path/Path","../quota/UserStateProvider.key","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../actions/vault/VaultActionType","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/PLTFeatures"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._context=t;r._uploader=new(r.scope.attached(n.batchUploaderType))(t);r._updateQuota=n.updateQuota;r._actionMap=n.actionMap;g.isFeatureEnabled(g.EnableNewConflictUploadErrorStrings)?r.registerActions({cancel:r.onCancel,addNewVersion:r._onAddNewVersion,overwrite:r._onOverwrite,rename:r._onRename,restart:r._onRestart,unlockVault:r._onUnlockVault}):r.registerActions({cancel:r.onCancel,overwrite:r._onOverwrite,rename:r._onRename,restart:r._onRestart,unlockVault:r._onUnlockVault});r._lastUploadedItem=r.createObservable();return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input,u=t.error;n.type=i.default.uploadItems;n.name=r.fileName.peek();n.iconName=r.iconName.peek();n.payloads.uploadItems={parent:this._context.parentItem,name:t.output.name,item:t.input.item};0===t.output.state&&(n.state=s.default.created);0===t.status&&t.output.uploadedBytes<t.output.totalBytes&&n.actions.push(this.onCancel);n.progress.maximum=t.output.totalBytes;n.progress.current=t.output.uploadedBytes;if(2===t.status){u&&(n.error.payloads.upload={error:u});if(!r.nameConflictBehavior.peek()&&u&&u.errorType===o.UploadErrorType.conflict){g.isFeatureEnabled(g.EnableNewConflictUploadErrorStrings)&&r.supportsVersioning?n.actions.push(this._onAddNewVersion):n.actions.push(this._onOverwrite);r.allowRename&&n.actions.push(this._onRename)}u.errorType===o.UploadErrorType.unlockRequired&&n.actions.push(this._onUnlockVault)}2!==t.status||u&&u.errorType!==o.UploadErrorType.general||n.actions.push(this._onRestart);return n};t.prototype.onStart=function(e){this._event=new l.UploadOperation({name:"UploadOperation",dragAndDrop:this._context.wasDragAndDropped,uploadType:f.UploadProcessorType[this._context.type]});this._processUploader(this._uploader,e);return this._uploader.start()};t.prototype.onCancel=function(e,t){for(var n=0,r=e;n<r.length;n++){r[n].input.abort()}return u.default.wrap()};t.prototype.onOperationFinished=function(e){var t,n,r,i=e.state.peek(),u=e.states.peek(),l=e.operations.peek(),h=e.error.peek();if(i===s.default.completed){t=a.ResultTypeEnum.Success;this._updateQuota(!0)}else t=i===s.default.canceled?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure;n=1===l.length?c.getFileExtension(e.payloads.peek().uploadItems.name):"";r=h?h.payloads.upload?h.payloads.upload.error.errorType:o.UploadErrorType.other:o.UploadErrorType.none;this._event&&this._event.end({size:e.progress.maximum.peek(),count:l.length,failCount:u.failed,successCount:u.completed,abortCount:u.canceled,resultType:t,dragAndDrop:this._context.wasDragAndDropped,uploadType:f.UploadProcessorType[this._context.type],extension:n,extraData:{uploadOperation_ErrorType:o.UploadErrorType[r]}})};t.prototype.onItemUploaded=function(e){};t.prototype._updateTaskOutput=function(e,t){return t};t.prototype._processUploader=function(e,t){var n=this;this.addDisposable(e);var r=function(e){t.update([e])},i=0;this.addDisposable(e.filesUploading.map({mappingWithDisposeCallback:function(e){var t="&u="+ ++i,s=n._createUploaderTaskSubscription(e,t,r);return{mappedValue:t,dispose:function(){s.dispose();var i=n._computeTask(e,t);0===i.status&&(i=i.cancel());r(i)}}}}))};t.prototype._onRestart=function(e,t){for(var n=0,r=e;n<r.length;n++){r[n].input.restart()}return u.default.wrap()};t.prototype._onOverwrite=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(1);i.input.restart()}return u.default.wrap()};t.prototype._onAddNewVersion=function(e,t){return this._onOverwrite(e,t)};t.prototype._onRename=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(2);i.input.restart()}return u.default.wrap()};t.prototype._onUnlockVault=function(e,t){for(var n=function(e){if(e.input.error.peek().fixItUrl){return{value:new(r.managed(r._actionMap.VaultAction))({actionType:v.default.Unlock,item:e.input.item}).execute({}).then(function(t){t.resultType===a.ResultTypeEnum.Success&&e.input.restart()})}}},r=this,i=0,s=e;i<s.length;i++){var o=n(s[i]);if("object"==typeof o)return o.value}return u.default.wrap()};t.prototype._createUploaderTaskSubscription=function(e,t,n){var r=this,i=!1,s=this.createComputed(function(){var o=r._computeTask(e,t);i=1===o.status||3===o.status;if(1===o.status){var u=r.unwrapObservable(e.item);u&&r.onItemUploaded(u);r._lastUploadedItem(u)}n(o);i&&s&&s.dispose()}).extend({rateLimit:{timeout:0}});i&&s.dispose();return s};t.prototype._computeTask=function(e,t){var n=new r.Task(t,e),i=e.state(),s=e.error(),o=e.totalBytes(),u=e.uploadedBytes();3===i?n=n.cancel():4===i?n=n.fail(s):2===i&&(n=n.succeed());n=n.changeOutput(function(t){return{state:i,totalBytes:o,uploadedBytes:u,name:e.fileName()}});return n=this._updateTaskOutput(e,n)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{updateQuota:h.resourceKey,batchUploaderType:d.batchUploaderType,actionMap:p.actionMap});return t})(r.default);t.default=y;t.typeResourceKey=m.createResolvedTypeResourceKey(e("module").id,y)});
define("@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.UploadOperation=n.createPairedEvent({eventName:"UploadOperation,Qos,",shortEventName:"UploadOperation"},{dragAndDrop:3,size:2,count:2,failCount:2,abortCount:2,successCount:2,extension:1,uploadType:1,errorType:1},r.Qos);t.default=t.UploadOperation});
define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../SetAlbumCoverPhotoOperator","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.itemSelectionHelper,i=t.currentItem;n._itemSelectionHelper=r;n._currentItem=i;return n}t.prototype.execute=function(e){var t=this,n=this._currentItem;return this._itemSelectionHelper.resolveSelection().then(function(e){return t.resources.consumeAsync(i.typeResourceKey).then(function(r){var i=new r({album:n,items:e});return t.trackPromise(i.start())}).then(function(){return{resultType:s.ResultTypeEnum.Success}},function(e){return{resultType:s.ResultTypeEnum.Failure}})})};return t})(r.default);t.default=o});
define("odsp-next/actions/setAlbumCoverPhoto/SetAlbumCoverPhotoOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/album/AlbumProvider.key","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._albumProvider=n.albumProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=s.default.setAlbumCoverPhoto;n.name=this._context.album.name;n.payloads.setAlbumCoverPhoto={album:this._context.album,item:this._context.items[0]};n.visibility=0;return n};t.prototype.onStart=function(e){return this._albumProvider.setCoverPhoto(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{albumProvider:i.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/showOperations/ShowOperationsExecutor",["require","exports","./ShowOperationsExecutor.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowOperationsExecutorViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-show-operations-executor",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/actions/showOperations/ShowOperationsExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko component:{name:panelOverlayTagName,params:{onClose:$component.onClosePanel.bind($component),title:panelTitle}}--\x3e\x3c!--ko control:operationMonitorSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/showOperations/ShowOperationsExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../providers/operation/OperationProvider","../../controls/operation/monitor/OperationMonitor.resx","../../controls/operation/monitor/OperationMonitor","../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({control:a.default});n.panelOverlayTagName=i.default.tagName;n.operationMonitorSpecification=a.toSpecification(u.resourceKey,{onExecuteAction:n._onExecuteAction.bind(n)});n.panelTitle=o.default.title;n._operationProvider=n.resources.consume(s.resourceKey);n.addDisposable(n._operationProvider.lock());return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._onExecuteAction=function(e){e&&e.closeHostOnExecute&&this.onClosePanel()};return t})(r.default);t.default=f});
define("odsp-next/controls/overlays/panel/PanelOverlay",["require","exports","./PanelOverlay.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PanelOverlayViewModel","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-panel-overlay",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/overlays/panel/PanelOverlay.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500,isOpen:isOpen},alignToParent:false,virtualParentElement:virtualParentElement}}--\x3e<div class="od-Panel-container" data-bind="focusTrap:{},css:{\'od-Panel--hidden\':!isPanelOpen($host.isOpen)}"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:isPanelOpen($host.isOpen)},scrollContainer,dismiss:{isOpen:isOpen||$host.isOpen,close:$component.onDismiss.bind($component),useLocalEvents:true},class:widthClass(),attr:{\'aria-label\':ariaLabel},style:style,element:$component.contentElement">\x3c!--ko if:title--\x3e<div class="od-Panel-title" role="heading" aria-level="1" data-bind="text:title,css:{\'ms-fontWeight-semilight\':!$component.isFluentFlight,\'ms-fontWeight-semibold\':$component.isFluentFlight,\'ms-font-xl\':!$component.isFluentFlight}"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="host:{}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click:$component.onClose.bind($component),attr:{\'aria-label\':$component.closePanelLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/overlays/panel/PanelOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../Overlay","../../../bindings/dismiss/DismissBinding","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/element/ElementBinding","../../../utilities/browser/ResponsiveUI","../../panelHost/PanelHost.resx","../../fluentStyling/FluentStyling.key","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={},y=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=i.default.tagName;n.closePanelLabel=d.default.closePanelLabel;n.addBindingHandlers({dismiss:s.default,element:h.default,host:o.default,interactionScope:u.default,focusTrap:f.default,recoverFocus:c.default,preserveFocus:l.default,scrollContainer:a.default});var r=t.size,p=void 0===r?"Small":r,y=t.title,b=void 0===y?"":y,w=t.onClose,E=t.ariaLabel,S=void 0===E?"":E,x=t.showCloseButton,T=void 0===x||x,N=t.isOpen,C=t.width,k=void 0===C?"":C,L=t.virtualParentElement;n._size=p;n._onClose=w;n.contentElement=n.createObservable();n.title=n.wrapObservable(b);n._ariaLabel=n.wrapObservable(S);n.showCloseButton=n.createObservable(!!n._onClose&&T);n.isOpen=N;n.widthClass=n.createPureComputed(n._computeWidthClass,{deferEvaluation:!0});if(m.default.isActivated("C3730302-A954-442E-9AAC-14817C780D44","06/18/2020","make panel width responsive to changes dynamically"))n.style=k?{width:k+"px"}:g;else{var A=n.wrapObservable(k);n.style=n.createPureComputed(function(){return A()?{width:A()+"px"}:g})}n.ariaLabel=n.createPureComputed(n._computeAriaLabel);n.virtualParentElement=L;n.isFluentFlight=n.resources.consume(v.resourceKey);return n}t.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()};t.prototype._computeWidthClass=function(){return this.unwrapObservable(this.style)===g?"od-Panel--"+p.default.determineCssClass(this._size):""};t.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)};return t})(r.default);t.default=y});
define("odsp-next/controls/operation/monitor/OperationMonitor",["require","exports","./OperationMonitor.html","./OperationMonitorViewModel","../../../bindings/component/ControlBinding","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-operation-monitor",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/operation/monitor/OperationMonitor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="OperationMonitor" data-bind="preRender">\x3c!--ko ifnot:showNotifyExperiment()--\x3e\x3c!--ko if:groups().length--\x3e<div class="OperationMonitor-groups" data-bind="foreach:groups"><div class="OperationMonitor-group"><div class="OperationMonitor-item" data-bind="class:css()">\x3c!--ko if:iconActions().length--\x3e<div class="OperationMonitor-itemIconActions" data-bind="foreach:iconActions"><button class="OperationMonitor-itemIconAction" data-bind="click:execute,attr:{title:title,\'aria-label\':title},class:key"><i data-bind="css:iconCss"></i></button></div>\x3c!--/ko--\x3e<div class="OperationMonitor-itemName" data-bind="bindableHtml:title"></div>\x3c!--ko if:showProgress--\x3e<div class="OperationMonitor-itemProgress" data-bind="component:{name:$component.progressBarTagName,params:{progress:progress,description:description}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showDescription--\x3e<div class="OperationMonitor-itemDescription" data-bind="text:description" role="status" aria-live="assertive"></div>\x3c!--/ko--\x3e\x3c!--ko if:buttonActions().length--\x3e<div class="OperationMonitor-itemButtonActions" data-bind="foreach:buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click:execute"><span class="od-Button-label" data-bind="text:title"></span></button></div>\x3c!--/ko--\x3e<div class="od-Share-Link" data-bind="control:shareAfterUpload,visible:showShareButton()"></div></div>\x3c!--ko if:operations().length--\x3e<hr aria-hidden="true"><div class="OperationMonitor-items" data-bind="foreach:operations"><div class="OperationMonitor-item" data-bind="class:css(),css:{\'OperationMonitor-item--icon\':!!iconName,\'OperationMonitor-item-DescOnly\':!title.length&&!buttonActions().length}">\x3c!--ko if:iconActions().length--\x3e<div class="OperationMonitor-itemIconActions" data-bind="foreach:iconActions"><button class="OperationMonitor-itemIconAction" data-bind="click:execute,attr:{title:title,\'aria-label\':title},class:key"><i data-bind="css:iconCss"></i></button></div>\x3c!--/ko--\x3e<div class="OperationMonitor-itemType" data-bind="component:{name:$component.fileTypeIconTagName,params:{desiredSize:$component.isFluentFlight?32:48,iconName:iconName}}"></div><div class="OperationMonitor-itemName" data-bind="text:title"></div>\x3c!--ko if:showProgress--\x3e<div class="OperationMonitor-itemProgress" data-bind="component:{name:$component.progressBarTagName,params:{progress:progress,description:description}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:warning()--\x3e<div class="OperationMonitor-itemWarning"><i class="ms-Icon ms-Icon--Info" data-bind="icon:true"></i><div class="OperationMonitor-itemWarning-text" data-bind="text:warning"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:!warning()--\x3e<div class="OperationMonitor-itemDescription" data-bind="text:description"></div>\x3c!--/ko--\x3e\x3c!--ko if:buttonActions().length--\x3e<div class="OperationMonitor-itemButtonActions" data-bind="foreach:buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click:execute"><span class="od-Button-label" data-bind="text:title"></span></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showViewAll--\x3e<button class="od-OperationMonitor-viewAll" data-bind="click:onClickViewAll,text:viewAllText"></button>\x3c!--/ko--\x3e<span class="ms-accessible" data-bind="text:showActionDetailsAccessibleHintText"></span>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:groups().length--\x3e<p role="alert" class="od-OperationMonitor-empty" data-bind="text:noOperationsText"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:hideNotifyExperimentInProgressPane--\x3e<div class="od-notify-experiment" data-bind="control:notifyExperimentSpecification,visible:showNotifyExperiment()"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/operation/monitor/OperationMonitorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/operation/OperationProvider","./OperationGroupViewModel","../../../bindings/preRender/PreRenderBinding","../../progress/bar/ProgressBar","../../fileTypeIcon/FileTypeIcon","./OperationMonitor.resx","../../notifyExperiment/NotifyExperiment","../../../bindings/component/ControlBinding","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../fluentStyling/FluentStyling.key","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.noOperationsText=f.default.noOperationsText;r.progressBarTagName=u.default.tagName;r.fileTypeIconTagName=a.default.tagName;var i=n.operationProvider,p=n.useFluentStyling,d=t.expandGroups,v=void 0===d||d,m=t.groups,g=void 0===m?i.groups:m,y=t.onViewAll,b=t.onExecuteAction,w=t.showCloseAction;r.addBindingHandlers({preRender:o.default,control:c.default});r._groupOperations=g;r.groups=r.addDisposable(g.map({mappingWithDisposeCallback:function(e){var t=new(r.managed(s.default))({group:e,showIndividualOperations:v,onViewAll:y,onExecuteAction:b,showCloseAction:w});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.isFluentFlight=p;r.showNotifyExperiment=r.observables.createCallback(h.forSingleValue(!1));r.hideNotifyExperimentInProgressPane=v;r.notifyExperimentSpecification=c.toSpecification(l.resourceKey,{groups:r._groupOperations,showNotifyExperiment:r.showNotifyExperiment,onExecuteAction:b});return r}t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{operationProvider:i.resourceKey,useFluentStyling:p.resourceKey});return t})(r.default);t.default=d});
define("odsp-next/controls/operation/monitor/OperationGroupViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","./OperationViewModel","./OperationActionViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","../strings/OperationStringMappings","../../../providers/operation/OperationProvider","../../../bindings/html/BindableHtmlBinding","./OperationMonitor.resx","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../shareAfterUpload/ShareAfterUpload","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.viewAllText=h.default.viewAllText;n.showActionDetailsAccessibleHintText=h.default.showActionDetailsAccessibleHintText;n.addBindingHandlers({bindableHtml:c.default,control:v.default});n._group=t.group;n._showIndividualOperations=t.showIndividualOperations;n._showOneOperation=t.showOneOperation;n._onExecuteAction=t.onExecuteAction;n._onViewAll=t.onViewAll;n._disallowedActions={};n._allowCloseAction=t.showCloseAction;n.progress=n._group.progress;n.context={count:n._group.count,states:n._group.states,progress:n._group.progress,payloads:n._group.payloads,error:n._group.error};t.stringMappings?n._stringMappings=t.stringMappings:n._stringMappings=f.default;n._operationProvider=n.resources.consume(l.resourceKey);n._showCloseAction=n.createPureComputed(n._computeShowCloseAction);n._operations=n._getOperations();var r=n._getActions(),i=r.buttonActions,s=r.iconActions;n.buttonActions=i;n.iconActions=s;var o=n._getOperationViewModels(),u=o.operations,a=o.showViewAll;n.operations=u;n.showViewAll=a;n.title=n.createComputed(n._computeTitle);n.description=n.createComputed(n._computeDescription);n.showProgress=n.createPureComputed(n._computeShowProgress);n.showDescription=n.createPureComputed(n._computeShowDescription);n.css=n.createComputed(n._computeCss);n.showShareButton=n.observables.createCallback(p.forSingleValue(!1));n.shareAfterUpload=v.toSpecification(d.resourceKey,{group:n._group,showShareButton:n.showShareButton,onExecuteAction:n._onExecuteAction});return n}t.prototype.onClickViewAll=function(e,t){if(this._onViewAll){this._onViewAll();t.stopPropagation();t.preventDefault()}};t.prototype._computeTitle=function(){var e=u.default[this._group.state()],t=a.default[a.default.multiple],n=this._getMappingForType(),r=n.states[e],i=f.default.types[t],s=i.states[e],o=r&&r.title||n.title||s&&s.title||i.title;return f.resolveEntry(o,this.context)};t.prototype._computeDescription=function(){var e=u.default[this._group.state()],t=a.default[a.default.multiple],n=this._getMappingForType().states[e],r=f.default.types[t].states[e],i=n&&n.description||r&&r.description;return f.resolveEntry(i,this.context)};t.prototype._computeShowProgress=function(){var e=this._getMappingForType().showProgress;if(e)return f.resolveEntry(e,this.context);var t=this._group;return this._showIndividualOperations&&(t.state()===u.default.started||t.progress.current()>t.progress.minimum())};t.prototype._computeShowDescription=function(){var e=this._getMappingForType().showDescription;return e?f.resolveEntry(e,this.context):this._showIndividualOperations&&(this._group.state()!==u.default.failed||!!this.buttonActions().length)};t.prototype._computeShowCloseAction=function(){var e=this._group.state();if(!1===this._allowCloseAction)return!1;if(e!==u.default.canceled&&e!==u.default.completed&&e!==u.default.failed)return!1;var t=this._group.actions().cancel;return!t||!1===t.isAvailable()};t.prototype._computeCss=function(){return"OperationMonitor-item--"+u.default[this._group.state()]};t.prototype._getMappingForType=function(){var e=this._stringMappings.types,t=a.default[this._group.type()];return e[t+"Group"]||e[t]};t.prototype._getActions=function(){var e=this,t=this.observables.createArray(),n=this._group,r={key:"close",count:n.count,isAvailable:this._showCloseAction,execute:function(){return i.default.wrap().then(function(){e._operationProvider.deleteGroupOperation(n)})}};this._group.actions().close=r;this.createComputed(function(){t(Object.keys(n.actions()).map(function(e){return n.actions.peek()[e]}))});var s=this._disallowedActions,l=this.addDisposable(t.filter(function(t){var r=a.default[n.type()],i=e._stringMappings.types[r].actions,o=i&&i[t.key],l=f.default.actions[t.key],c=o&&o.mode||l.mode||0,h=1!==c&&t.count()>3||1===c,p=!e._showIndividualOperations&&e._group.state()!==u.default.failed||!!l.icon||h,d=!h||3===c;s[t.key]?s[t.key](!d):s[t.key]=e.createObservable(!d);return p&&t.isAvailable()})),c=this.addDisposable(l.map({mappingWithDisposeCallback:function(t){var n=new(e.managed(o.default))({action:t,onExecuteAction:e._onExecuteAction,actionMapping:e._stringMappings.actions,operationType:e._group.type});return{mappedValue:n,dispose:function(){n.dispose()}}}}));return{buttonActions:this.addDisposable(c.filter(function(e){return!e.icon})),iconActions:this.addDisposable(c.filter(function(e){return!!e.icon}))}};t.prototype._getOperations=function(){var e=this,t=this._group,n=this.createPureComputed(function(){return 1===t.operations().length}),r=this.createPureComputed(function(){return t.operations().length>10}),i=this.createPureComputed(function(){return t.states().started<10}),s=this.createPureComputed(function(){return t.states().created+t.states().started<10});return this.addDisposable(t.operations.filter(function(t){var o=t.error();return!(!e._showIndividualOperations&&!n()&&t.state()!==u.default.failed)&&(!(!e._showOneOperation&&n()&&t.state()!==u.default.failed&&!o)&&(!(r()&&t.state()!==u.default.failed&&!o)||(!(!s()||t.state()!==u.default.created)||!(!i()||t.state()!==u.default.started))))}))};t.prototype._getOperationViewModels=function(){var e,t=this,r=this.observables;if(this._showIndividualOperations)e=this._operations;else{e=r.createArray();r.compute(function(){e.splice.apply(e,n.__spreadArrays([0,1/0],t._operations().slice(0,1)))})}return{operations:this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var n=new(t.managed(s.default))({operation:e,onExecuteAction:t._onExecuteAction,disallowedActions:t._disallowedActions,stringMapping:t._stringMappings});return{mappedValue:n,dispose:function(){n.dispose()}}}})),showViewAll:r.pureCompute(function(){return!!t._onViewAll&&e().length<t._operations().length})}};return t})(r.default);t.default=m});
define("odsp-next/controls/operation/monitor/OperationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","./OperationActionViewModel","../strings/OperationStringMappings","../../../bindings/html/BindableHtmlBinding","knockout"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:a.default});n._operation=t.operation;n._onExecuteAction=t.onExecuteAction;n._disallowedActions=t.disallowedActions||{};t.stringMapping?n._stringMappings=t.stringMapping:n._stringMappings=u.default;n.context={count:n._operation.count,states:n.createComputed(n._computeStates),progress:n._operation.progress,payloads:n._operation.payloads,error:n._operation.error};n.warning=n.createComputed(n._computeWarning);n.progress=n._operation.progress;n.iconName=n._operation.iconName;n._initializeActions();n.title=n.createComputed(n._computeTitle);n.description=n.createComputed(n._computeDescription);n.css=n.createPureComputed(n._computeCss);n.showProgress=n.createPureComputed(n._computeShowProgress);return n}t.prototype._computeStates=function(){var e={created:0,started:0,completed:0,failed:0,canceled:0,expired:0};e[i.default[this._operation.state()]]=1;return e};t.prototype._computeWarning=function(){var e=this._operation.error();return u.getOperationWarning(e&&e.errorType)};t.prototype._computeTitle=function(){return this._operation.name};t.prototype._computeDescription=function(){var e=i.default[this._operation.state()],t=s.default[this._operation.type()],n=s.default[s.default.multiple],r=this._stringMappings.types[t].states[e],o=u.default.types[n].states[e],a=r&&r.description||o&&o.description;return this._evaluateOperationEntry(a)};t.prototype._initializeActions=function(){var e=this,t=f.observableArray();this.createComputed(function(){t(Object.keys(e._operation.actions()).map(function(t){return e._operation.actions.peek()[t]}))});var n=this.addDisposable(t.filter(function(t){return(!e._disallowedActions[t.key]||!e._disallowedActions[t.key]())&&t.isAvailable()})),r=this.addDisposable(n.map({mappingWithDisposeCallback:function(t){var n=new(e.managed(o.default))({action:t,onExecuteAction:e._onExecuteAction,actionMapping:e._stringMappings.actions,operationType:e._operation.type});return{mappedValue:n,dispose:function(){n.dispose()}}}}));this.buttonActions=this.addDisposable(r.filter(function(e){return!e.icon}));this.iconActions=this.addDisposable(r.filter(function(e){return!!e.icon}))};t.prototype._computeCss=function(){return"OperationMonitor-item--"+i.default[this._operation.state()]};t.prototype._computeShowProgress=function(){var e=this._operation;return e.state()!==i.default.created&&e.progress.current()>e.progress.minimum()||this._evaluateOperationEntry(this._stringMappings.types[s.default[e.type.peek()]].showProgress)};t.prototype._evaluateOperationEntry=function(e){return"function"==typeof e?e(this.context):e};return t})(r.default);t.default=l});
define("odsp-next/controls/operation/monitor/OperationActionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../models/operation/OperationType","../strings/OperationStringMappings","@ms/odsp-utilities/lib/async/Promise","../../../providers/engagement/Engagement","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._action=t.action;n._onExecuteAction=t.onExecuteAction;n._engagement=n.resources.consume(u.resourceKey);n._context={count:n._action.count,states:n.createObservable({}),payloads:n.createObservable({}),progress:null,error:n.createObservable()};n._operationType=t.operationType;n.key=n._action.key;var r=t.actionMapping,i=void 0===r?s.default.actions:r;n._actionMapping=i[n.key];n.icon=n._actionMapping.icon;n.title=n.createPureComputed(n._computeTitle);n.iconCss=n.createPureComputed(n._computeIconCss);return n}t.prototype.execute=function(){var e=this;this._engagement.logData({name:""+a.capitalize(i.default[this._operationType.peek()])+a.capitalize(this._action.key)+".OperationAction.Click",isIntentional:!0});o.default.wrap().then(function(){return e._action.execute()}).done();this._onExecuteAction&&this._onExecuteAction(this._action)};t.prototype._computeTitle=function(){return s.resolveEntry(this._actionMapping.name,this._context)};t.prototype._computeIconCss=function(){return this.icon&&this.icon.getClass()||""};return t})(r.default);t.default=f});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload",["require","exports","./ShareAfterUpload.html","./ShareAfterUploadViewModel","../../bindings/component/ControlBinding","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-share-link",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:useItemsScopeShareAfterUpload--\x3e\x3c!--ko control:shareAfterUploadSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:useItemsScopeShareAfterUpload--\x3e<div class="od-operationMonitor-ShareLink"><button class="od-Button od-Button--primary od-operationMonitor-ShareLinkButton" data-bind="text:shareButtonText,click:onClickShareButton"></button></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/shareAfterUpload/ShareAfterUploadViewModel",["require","exports","tslib","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-shared/lib/base/ViewModel","../../utilities/features/Features","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","../../controls/sharing/share/commands/ShareCommandKeys","../../models/item/ItemType","./ShareAfterUpload.resx","../../bindings/component/ControlBinding","../../resources/DataSourceResourceKeys","../../pages/files/UseItemsScope.key","./ShareAfterUpload.key","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._group=t.group;r._showShareButton=r.observables.pureCompute(r._computeShowShareButton);r.scope.attach(t.showShareButton.register(r._showShareButton));r._pageContext=n.pageContext;r._actionMap=n.actionMap;r._urlDataSource=r.resources.consume(p.url);r.addBindingHandlers({control:h.default});r.shareButtonText=c.default.shareActionText;r.useItemsScope=r.resources.consume(d.resourceKey).peek();var i=r._group.payloads.peek().uploadItems,s=i&&i.item&&i.item.peek(),o=!!s;r.useItemsScopeShareAfterUpload=r.useItemsScope&&o;r.useItemsScopeShareAfterUpload&&(r.shareAfterUploadSpecification=h.toSpecification(v.resourceKey,{props:{storeKey:s.key,urlDataSource:r._urlDataSource}}));return r}t.prototype.onClickShareButton=function(e){new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:f.shareFocusItemResourceKey,overrideItem:this._group.payloads().uploadItems.item(),scenarioId:"ShareAfterUpload"}).execute(e)};t.prototype._computeShowShareButton=function(){var e=!1;if(o.isFeatureEnabled(o.EnableShareLinkAfterUpload)&&this._group.state()===r.default.completed&&this._group.type()===i.default.uploadItems&&1===this._group.count()&&this._group.payloads().uploadItems){var t=this._group.payloads().uploadItems.item(),n=new RegExp(this._pageContext.listUrl+"/Forms/"),s=t.id&&t.id.match(n);Number(this._pageContext.webTemplate)===m.default.mySite&&t.type===l.default.File&&!s&&(e=!0)}return e};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{pageContext:u.pageContext.optional,actionMap:a.actionMap});return t})(s.default);t.default=g});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./react/ShareAfterUpload"],t,n)}).then(function(e){return e.knockoutResourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/bindings/preRender/PreRenderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){for(var n=e.call(this,t)||this,r=[],s=0,o=i.virtualElements.childNodes(n.element);s<o.length;s++){var u=o[s];r.push(u)}i.virtualElements.emptyNode(n.element);var a=document.createElement(n.element.tagName);i.applyBindingsToNode(a,{template:{nodes:r}},n.bindingContext);n.element.appendChild(a);n.controlsDescendantBindings=!0;return n}return t})(r.default);t.default=s});
define("odsp-next/controls/notifyExperiment/NotifyExperiment",["require","exports","./NotifyExperiment.html","./NotifyExperimentViewModel","../../bindings/component/ControlBinding","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-notify-experiment",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/notifyExperiment/NotifyExperiment.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showNotifyExperiment--\x3e\x3c!--ko autoFocus--\x3e\x3c!--ko focusTrap--\x3e<div class="od-Notify-callout" data-bind="react:{componentType:shareComponent,props:shareComponentProps}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/notifyExperiment/NotifyExperimentViewModel",["require","exports","tslib","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-shared-sharing/lib/Share","@ms/odsp-utilities/lib/icons/ItemType","../sharing/share/react/Share","../../bindings/react/ReactBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/AutoFocusBinding","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../providers/sharing/react/SharingStore"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=d.ClientId.sharePoint,x=d.Mode.notify,T=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismiss=function(){var e=r._itemToShare(),t={name:"Notify.Dismissed",clientId:S,mode:x,appMap:e.appMap};w.Engagement.logData(t);r._onExecuteAction()};r.addBindingHandlers({react:g.default,focusTrap:y.default,autoFocus:b.default});var i=t.groups,s=t.onExecuteAction;r._pageContext=n.pageContext;r._actionMap=n.actionMap;r._peoplePickerProvider=n.peoplePickerProvider;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._sharingProvider=n.sharingProvider;r._suiteNavProvider=n.suiteNavProvider;r._policyTipProvider=n.policyTipProvider;r._groupOperations=i;r._onExecuteAction=s;r.element=r.observables.create(null);r._itemToShare=t.item?r.observables.create(t.item):r.observables.pureCompute(r._computeItemToShare);r.showNotifyExperiment=r.observables.pureCompute(r._computeShowNotifyExperiment);r.scope.attach(t.showNotifyExperiment.register(r.showNotifyExperiment));r.shareComponent=m.default;r.shareComponentProps=r.createPureComputed(r._computeShareProps);return r}t.prototype._computeShowNotifyExperiment=function(){if(!this._policyTipProvider||!this._pageContext||!this._graphPeoplePickerHelper)return!1;var e=Number(this._pageContext.webTemplate);if(e===p.default.teamSite||e===p.default.group){var t=this._itemToShare();if(t){var n=new RegExp(this._pageContext.listUrl+"/Forms/"),r=t.id&&t.id.match(n);return t.type!==v.ItemType.Folder&&!!t.properties.uniqueId&&!r}}return!1};t.prototype._computeShareProps=function(){var e=this._itemToShare(),t=new E.default({item:e,accessChecked:!1,sharingInformation:null,defaultRecipients:null,mode:x,sharingContextInformation:null},{sharingProvider:this._sharingProvider,suiteNavProvider:this._suiteNavProvider,peoplePickerProvider:this._peoplePickerProvider,policyTipProvider:this._policyTipProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper});return{clientId:S,actionMap:this._actionMap,item:e,onDismiss:this._onDismiss,peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper,resources:this.resources,sharingProvider:this._sharingProvider,policyTipProvider:this._policyTipProvider,mode:x,sharingStore:t}};t.prototype._computeItemToShare=function(){var e=this._groupOperations();if(1===e.length){var t=e[0].operations();if(1===t.length){var n=t[0];if(n.state()===c.default.completed&&n.type()===h.default.uploadItems){var r=n.payloads().uploadItems;if(r)return r.item()}}}};t.dependencies=n.__assign(n.__assign({},l.default.dependencies),{pageContext:a.pageContext.optional,actionMap:f.actionMap,peoplePickerProvider:r.resourceKey,graphPeoplePickerHelper:i.resourceKey.optional,sharingProvider:s.resourceKey,suiteNavProvider:o.resourceKey,policyTipProvider:u.resourceKey.optional});return t})(l.default);t.default=T});
define("odsp-next/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);t.resourceKey=i.createResolvedResourceKey(e("module").id,s.GraphPeoplePickerHelper,{oAuthTokenProvider:o.resourceKey,pageContext:r.pageContext,sharingContextInformation:r.sharingContextInformation.optional})});
define("@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var u=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&r.default.isFeatureEnabled(t.PeoplePickerGraph);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",o.default.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,o.default.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return n.default.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new i.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){t.end({resultType:i.ResultTypeEnum.Success});return e},function(r){if(n.default.isCanceled(r)){t.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(r)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:i.ResultTypeEnum.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e})();t.GraphPeoplePickerHelper=u});
define("odsp-next/providers/policyTip/PolicyTipProvider",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.policyTipDataSource;return r}t.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};t.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};t.dependencies=n.__assign(n.__assign({},s.default.dependencies),{policyTipDataSource:i.policyTip});return t})(s.default);t.default=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o)});
define("@ms/odsp-shared-sharing/lib/Share",["require","exports","tslib","./components/Share/index","./components/Share/index","./components/ShareNotification/ShareNotification","./interfaces/enums/AccessStatus","./interfaces/SharingInterfaces","./interfaces/enums/OutlookAvailability","./interfaces/enums/SharingCapabilityDisabledReason"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.Share;t.ShareNotification=s.ShareNotification;t.AccessStatus=o.default;t.Error=u.Error;t.Category=u.Category;t.Mode=u.Mode;t.SharePermission=u.SharePermission;t.SharingAudience=u.SharingAudience;t.SharingLinkKind=u.SharingLinkKind;t.SharingRole=u.SharingRole;t.ClientId=u.ClientId;t.OutlookAvailability=a.default;t.SharingCapabilityDisabledReason=f.default});
define("@ms/odsp-shared-sharing/lib/components/Share/index",["require","exports","tslib","./Share"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-sharing/lib/components/Share/Share",["require","exports","tslib","../CopyLink/CopyLink","../Header/Header","../../interfaces/SharingInterfaces","../ModifyPermissions/ModifyPermissions","../PermissionsList/PermissionsList","../ShareMain/ShareMain","../ShareNotification/ShareNotification","../SharePolicyDetails/SharePolicyDetails","office-ui-fabric-react/lib/Spinner","react","react","prop-types","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Fabric","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Button","../AtMention/AtMention","../Notify/Notify","../../utilities/ShareHelper","@ms/odsp-utilities/lib/uri/Uri","../Share.resx","../../utilities/SharingAbilitiesHelper","../../utilities/ShareCommunicationManager","@ms/odsp-utilities/lib/events/EventGroup","../AddPeople/AddPeople","../Error/Error","office-ui-fabric-react/lib/Styling","../../utilities/ShareHelper","../PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/Features","../../utilities/UiUtils","../../interfaces/IPersonEx","office-ui-fabric-react/lib/Utilities","../../utilities/EngagementHelper","../../utilities/SharingFeatures","../../utilities/ResizeTracker","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R=D.Killswitch.isActivated("9a03785c-3417-4e8f-b485-706c188d97ab","04/23/2020","Optimize sharing engagement events")||P.default.isFeatureEnabled({ODC:"SharingLoggingODCKillswitch"});(function(e){e[e.default=0]="default";e[e.shareShimmer=1]="shareShimmer";e[e.modifyPermissions=2]="modifyPermissions";e[e.permissionsList=3]="permissionsList";e[e.linkSuccess=4]="linkSuccess";e[e.grantPermissions=5]="grantPermissions";e[e.policyDetails=6]="policyDetails";e[e.error=7]="error";e[e.linkSettings=8]="linkSettings";e[e.notify=9]="notify";e[e.addPeople=10]="addPeople";e[e.linksFromTemplateList=12]="linksFromTemplateList";e[e.atMention=13]="atMention";e[e.spinner=14]="spinner"})(t.ShareViewState||(t.ShareViewState={}));var U=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._viewStates=[];i._shareMainControl=p.createRef();i._topLevelDivRef=h.createRef();i._copyLinkOnCancelClicked=function(){i._renderStatesSimplificationEnabled?i._returnToPreviousView():i.setState({viewState:4},function(){i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)})};i._copyLinkOnApplyClicked=function(e){i.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onCopyLinkClicked(!0)})};i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})};i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})};i.onEditChange=function(e){var t=i.state.currentSettings,r=S.getLinkKind(t.audience,2===e);i.setState(n.__assign(n.__assign({},i.state),{currentSettings:n.__assign(n.__assign({},t),{sharingRole:e,isEdit:2===e,sharingLinkKind:r})}))};i._onShareTargetClicked=function(e){if(e===s.ShareType.copy){C.copyLinkShareTargetClicked();i._onCopyLinkClicked()}else e===s.ShareType.outlook?i._onOutlookClicked():e===s.ShareType.nonOutlook?i._onNonOutlookClicked():e===s.ShareType.teams?i._onTeamsClicked():e===s.ShareType.moreApps&&i._onMoreAppsClicked()};i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onSelectedPermissionsChange(e);i.props.mode===s.Mode.linkSettings&&i.setState({shareType:s.ShareType.share,applyLinkSettingsClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onLinkPermissionsCancelClicked=function(){i.props.mode===s.Mode.linkSettings&&C.dismiss();i._renderStatesSimplificationEnabled?i._returnToPreviousView():i.setState({viewState:0},function(){i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)})};i._returnToPreviousView=function(){if(i._viewStates&&i._viewStates.length){i.setState({viewState:i._viewStates.pop()});i._renderStatesSimplificationEnabled&&2===i.state.viewState&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)}};i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)};i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===s.SharingAudience.existing&&i._store.checkPermissions(e);i._store.resetPeoplePickerError();i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.getEngagementHelper().peoplePickerLinkedinSuggestionSelected(i._engagementExtraData,e);i._store.fetchGroupsMemberCount(e)})};i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients;i.setState({shareType:s.ShareType.share,recipientsCount:n.length,externalRecipientsCount:v.getExternalPeopleCount(n),linkedinRecipientsCount:v.getLinkedInPeopleCount(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){C.sendLinkClicked();i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})};i._onViewPolicyTipClicked=function(){i._renderStatesSimplificationEnabled&&i._viewStates.push(i.state.viewState);i.setState({viewState:6})};i._onSendLinkMessageChange=function(e){i.setState({messageText:e})};i._onSendLinkSubjectChange=function(e){i.setState({subjectText:e})};i._onShareTargetsRendered=function(e){if(R){var t=n.__assign(n.__assign({},i._engagementExtraData),{shareTargets:e});i._store.getEngagementHelper().shareTargets(t)}};i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData);i.setState({shareType:s.ShareType.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData);i.setState({shareType:s.ShareType.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})};i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData);i.setState({showCopyLinkInterrupt:!1});i._shareMainControl.current.shouldShowActivityIndicator(!1)};i._showModifyPermissions=function(e){i._renderStatesSimplificationEnabled&&i._viewStates.push(i.state.viewState);i.setState({viewState:2},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData)})};i._showPermissionsList=function(){i._renderStatesSimplificationEnabled&&i._viewStates.push(i.state.viewState);i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,r=n&&!t;t?C.invokeManageAccess():r?n():i.setState({viewState:3})};i._dismiss=r.onDismiss;i._resize=r.resize;i._store=r.sharingStore;i._shareClickTime=r.shareClickTime;i._isPeopleSharingLinksEnabled=!1;i._renderStatesSimplificationEnabled=I.genericShareViewStatesEnabled();i._grantAccessToManageAccessEnabled=I.grantAccessToManageAccess();var o=C.isDarkMode();(t.theme||o)&&i._loadTheme(o?S.getDarkTheme():t.theme);i._sizeConstraints={maxHeight:m.isMobile(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none"};var u={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:s.ShareType.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1};i._renderStatesSimplificationEnabled&&(u.viewState=t.mode===s.Mode.share?1:14);i.state=u;i._engagementExtraData={clientId:t.clientId,scenarioId:t.scenarioId,correlationId:t.correlationId||"",hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?s.Mode.copy:s.Mode.share)};I.genericResizeTracker()&&(i._resizeTracker=new q.ResizeTracker(r.resize));return i}t.prototype.componentDidMount=function(){var e=this;this._store.getEngagementHelper().log(R?F.SharingEngagementEvents.Opened:F.SharingEngagementEvents.Opening,this._engagementExtraData);var t=this._store;new k.default(this).on(window,"keydown",function(t){t&&t.keyCode===j.KeyCodes.escape&&e._handleEscKeyPress(t)});t.addListener(function(){var r=t.getSharingInformation(),i=t.getSharingLinkCreated(),o=t.getCompanyName(),u=t.getGroupsMemberCount(),a=t.getPolicyTipInformation(),f=t.getPermissionsMap(),l=t.getDefaultRecipients();e._outlookAvailability=t.getOutlookAvailability();e._isPeopleSharingLinksEnabled=t.isPeopleSharingLinksEnabled();if(r){r.webTemplateId&&(e._engagementExtraData.webTemplateId=r.webTemplateId);r.itemUniqueId&&(e._engagementExtraData.itemUniqueId=r.itemUniqueId);if(!D.Killswitch.isActivated("50a0fc3c-2c88-4b62-a7e7-ab31de56b9df","12/30/2019","Item type telemetry for share dialog")&&!P.default.isFeatureEnabled({ODC:"SharingItemTypeLoggingKillSwitch"})){var c=e._store.getItemInformationForLogging(),h=c.itemType,p=c.extension;e._engagementExtraData.itemType=h;e._engagementExtraData.extension=p}var d=e._getSettings(r),v=n.__assign({},e.state);!e._renderStatesSimplificationEnabled||1!==e.state.viewState&&14!==e.state.viewState||(v.viewState=e._getInitialViewState(r,d,i));if(e._renderStatesSimplificationEnabled&&r&&r.error){C.pageError(e._shareClickTime,e.props.clientId,e.props.mode,e.props.scenarioId,r);v.viewState=7;v.sharingInformation=r}else if(i&&(e.state.shareTargetClicked||e.props.copyLinkShortcut||e.state.applyLinkSettingsClicked)){e._modifiedSharingLinkUrl=e._trackClickThru(i,d,r);var g=e.state.shareType,y=e.state.currentSettings,b=y?y.isEdit:d.isEdit,w=y?y.isReview:d.isReview,E=y?y.preventDownload:d.preventDownload,x=y?y.audience:d.audience,T=N.isOfficeReviewModeAllowed(x,r.sharingAbilities,r.fileExtension),k=N.isReviewingAllowed(x,r.sharingAbilities,r.fileExtension),L=n.__assign(n.__assign({},e._engagementExtraData),{shareType:g,audience:i.audience,isEdit:b,isReview:k&&w,recipientsCount:e.state.recipientsCount,externalRecipientsCount:e.state.externalRecipientsCount,linkedinRecipientsCount:e.state.linkedinRecipientsCount,hasMessage:e.state.hasMessage,hasSubject:e.state.hasSubject,messageLength:e.state.messageLength,daysUntilExpiry:e._getNumberOfDaysUntilExpiry(i),isDefaultLink:r.defaultSharingLink.sharingLinkKind===i.sharingLinkKind,linkBlocksDownload:!!E,linkWithOfficeReviewMode:T&&w,groupRecipientCount:e.state.linkRecipients.filter(function(e){return 2===e.entityType&&null==e.familySharingTargetType}).length});if(P.default.isFeatureEnabled({ODC:"FamilySharing"})&&m.supportsFamily(e.props.clientId)){L.sharedToFamilyGroup=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===B.FamilySharingTargetType.Family});L.sharedToFamilyMember=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===B.FamilySharingTargetType.FamilyMember})}e._store.getEngagementHelper().shareCompleted(L);var A=S.getVroomScopeFromSharingLinkKind(i.sharingLinkKind);C.shareCompleted(e.state.shareType,A);if(g===s.ShareType.outlook||g===s.ShareType.nonOutlook)if(m.showOWAShareTarget(e.props.clientId)){e._store.navigateToOwa(e._getRecipientEmails(e.state.linkRecipients),e._modifiedSharingLinkUrl);C.outlookClicked();e._dismiss()}else try{window.external.SendViaOutlookWithContext(e._getRecipientEmails(e.state.linkRecipients),e.state.linkRecipients.length,e.state.messageText,e._modifiedSharingLinkUrl)}catch(e){}else if(g===s.ShareType.teams){e._dismiss();C.teamsClicked(i,e._getRecipientEmails(e.state.linkRecipients),e.state.messageText)}else if(g===s.ShareType.moreApps)try{v=n.__assign(n.__assign({},v),{viewState:4,companyName:o,sharingLinkCreated:i,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(i.url)}catch(e){}else e.props.mode===s.Mode.linkSettings?C.linkSettingsCompleted(i,o,e.props.customLabeledAudienceConfig,e.props.clientId):v=n.__assign(n.__assign({},v),{viewState:4,sharingLinkCreated:i,companyName:o,showActivityIndicator:!1,sharingInformation:r,currentSettings:e._getSettings(r)})}else{if(e.props.copyLinkShortcut&&r&&!e.props.shareId&&!r.error&&!e._copyLinkShortcutInvoked){e._copyLinkShortcutInvoked=!0;e._onCopyLinkClicked(!0,d)}v=n.__assign(n.__assign({},v),{sharingInformation:r,companyName:o,groupsMemberCount:u,currentSettings:d,policyTipInformation:a,isLoadingDefaultRecipients:t.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:f});if(l&&!l.isConsumed){v.linkRecipients=l.recipients;e._store.consumeDefaultRecipients()}}if(!e._isOpenEventLogged&&!R){e._store.getEngagementHelper().log(F.SharingEngagementEvents.Opened,e._engagementExtraData);e._isOpenEventLogged=!0}e.setState(v)}});t.fetchSuiteNavInformation();t.fetchSharingInformation(this.props.copyLinkShortcut||this.props.mode===s.Mode.linkSettings||this.props.mode===s.Mode.manageAccess||this.props.mode===s.Mode.notify,this.props.mode===s.Mode.manageAccess);t.fetchPolicyTipInformation();if(this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===s.Mode.copy&&!this.props.shareId&&m.isTeams(this.props.clientId)){this._copyLinkShortcutInvoked=!0;this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0});this.setState({shareType:s.ShareType.copy,shareTargetClicked:!0})}I.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case s.Mode.share:if(e&&t)return 0;break;case s.Mode.atMention:if(e&&t)return 13;break;case s.Mode.linkSettings:if(t)return 8;break;case s.Mode.manageAccess:if(t)return 3;break;case s.Mode.copy:if(e&&t&&n)return 4;break;case s.Mode.notify:if(e)return 9;break;case s.Mode.addPeople:if(e)return 10;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return this.props.mode===s.Mode.share?1:14};t.prototype.componentDidUpdate=function(){I.genericResizeTracker()?this._resizeIfNeeded():this._resize()};t.prototype.render=function(){if(this._renderStatesSimplificationEnabled)return this.renderBasedOnViewState();var e,t=T.default,o=this.props,u=o.copyLinkShortcut,a=o.clientId,f=o.showExistingAccessOption,l=o.mode,p=this.state,d=p.sharingInformation,v=p.currentSettings,y=p.showActivityIndicator,b=p.companyName,S=p.sharingLinkCreated,x=p.viewState,N=p.groupsMemberCount,k=p.linkRecipients;if(d&&d.error){C.pageError(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,d);e=h.createElement("div",{className:"od-Share"},h.createElement(i.Header,{viewState:7}),h.createElement(A.Error,{sharingInformation:d,showReportProblem:this._store.isReportProblemSupported()}))}else if(d&&v&&!u&&l===s.Mode.share){var L=y?" od-Share--hasActivity":"";e=h.createElement("div",{className:"od-Share"+L,style:this._sizeConstraints},this._renderBackButtonForPolicyDetails(),this._renderViews(),this._renderActivityIndicator())}else if(d&&v&&u&&S)e=h.createElement("div",{className:"od-Share",style:this._sizeConstraints},h.createElement(r.CopyLink,{clientId:a,shareId:this.props.shareId,mode:this.props.mode,scenarioId:this.props.scenarioId,companyName:b,currentSettings:v,item:d.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(S.createdViaCopyLinkCommand),sharingInformation:d,showExistingAccessOption:f,viewState:x,groupsMemberCount:N,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}));else if(d&&v&&l===s.Mode.atMention){var O=I.atMentionCallbackEnabled()&&this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;e=h.createElement("div",null,h.createElement(w.AtMention,{clientId:a,scenarioId:this.props.scenarioId,currentSettings:v,sharingInformation:d,recipients:k,onComplete:O}))}else if(v&&l===s.Mode.linkSettings){L=y?" od-Share--hasActivity":"";e=h.createElement("div",{className:"od-Share"+L,style:this._sizeConstraints},this._renderModifyPermissions(8),this._renderActivityIndicator())}else if(v&&l===s.Mode.manageAccess)e=h.createElement("div",{className:"od-Share",style:this._sizeConstraints},this._renderPermissionsList());else if(l===s.Mode.share){e=h.createElement("div",{className:"od-Share od-Share--hasShimmer",style:this._sizeConstraints},this._renderShareMainShimmer());this._viewStates.push(1)}else if(d&&l===s.Mode.notify){v.sharingLinkKind=1;v.audience=s.SharingAudience.existing;this._engagementExtraData=n.__assign(n.__assign({},this._engagementExtraData),{appMap:d.item.appmap});e=h.createElement(E.Notify,{clientId:a,scenarioId:this.props.scenarioId,currentSettings:v,sharingInformation:d,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})}else e=d&&l===s.Mode.addPeople?h.createElement("div",{className:"od-Share",style:this._sizeConstraints},this._renderAddPeople()):h.createElement("div",{className:"od-Share"},h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(c.Spinner,{className:"od-Share-spinner",label:t.componentLoading,size:c.SpinnerSize.large})));var M=m.isTeams(this.props.clientId)?" teams":"";return h.createElement(g.Fabric,null,h.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:M+(this._shouldUseFluent()?" isFluent":"")},e))};t.prototype.renderBasedOnViewState=function(){var e,t,r=T.default,i=this.props,o=i.clientId,u=i.copyLinkShortcut,a=this.state,f=a.sharingInformation,l=a.currentSettings,p=a.showActivityIndicator,d=a.sharingLinkCreated,v="od-Share",y=!1;if(f&&l&&u&&d&&7!==this.state.viewState){y=!0;e=this._renderPostCopyShortcutView()}else switch(this.state.viewState){case 7:e=this._renderError(f);break;case 0:v+=p?" od-Share--hasActivity":"";y=!0;e=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case 2:e=h.createElement(h.Fragment,null,this._renderModifyPermissions(2),this._renderActivityIndicator());break;case 8:e=h.createElement(h.Fragment,null,this._renderModifyPermissions(8),this._renderActivityIndicator());break;case 4:e=this._renderNotification();break;case 3:y=!0;e=this._renderPermissionsList();break;case 6:e=h.createElement(h.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case 13:v="";e=this._renderAtMention();break;case 8:v+=p?" od-Share--hasActivity":"";y=!0;e=h.createElement(h.Fragment,null,this._renderModifyPermissions(8));break;case 1:v+=" od-Share--hasShimmer";y=!0;e=this._renderShareMainShimmer();break;case 9:l.sharingLinkKind=1;l.audience=s.SharingAudience.existing;this._engagementExtraData=n.__assign(n.__assign({},this._engagementExtraData),{appMap:f.item.appmap});v="";e=h.createElement(E.Notify,{clientId:o,scenarioId:this.props.scenarioId,currentSettings:l,sharingInformation:f,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig});break;case 10:y=!0;e=this._renderAddPeople();break;case 14:e=h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(c.Spinner,{className:"od-Share-spinner",label:r.componentLoading,size:c.SpinnerSize.large}))}t=y||v?h.createElement("div",{className:v,style:y?this._sizeConstraints:void 0},e):e;var b=m.isTeams(this.props.clientId)?" teams":"";return h.createElement(g.Fabric,null,h.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:b+(this._shouldUseFluent()?" isFluent":"")},t))};t.prototype._shouldUseFluent=function(){return P.default.isFeatureEnabled({ODB:1248})&&this.props.clientId===s.ClientId.odb||I.fluentSharepoint()&&(this.props.clientId===s.ClientId.sharePoint||this.props.clientId===s.ClientId.listPart)||this.props.clientId===s.ClientId.listsHome};t.prototype._renderAtMention=function(){var e=I.atMentionCallbackEnabled()&&this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return h.createElement(w.AtMention,{clientId:this.props.clientId,scenarioId:this.props.scenarioId,currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,onComplete:e})};t.prototype._renderPostCopyShortcutView=function(){var e=this.props,t=e.clientId,n=e.showExistingAccessOption,i=this.state,s=i.sharingInformation,o=i.currentSettings,u=i.companyName,a=i.sharingLinkCreated,f=i.viewState,l=i.groupsMemberCount;return h.createElement(r.CopyLink,{clientId:t,shareId:this.props.shareId,mode:this.props.mode,scenarioId:this.props.scenarioId,companyName:u,currentSettings:o,item:s.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(a.createdViaCopyLinkCommand),sharingInformation:s,showExistingAccessOption:n,viewState:f,groupsMemberCount:l,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience})};t.prototype._renderError=function(e){return h.createElement(h.Fragment,null,h.createElement(i.Header,{viewState:7}),h.createElement(A.Error,{sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()}))};t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,r=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,s=N.getSharingLinksFromTemplateForRedeemedUser(e.sharingAbilities,e.sharingLinkTemplates);if(!n&&!r){var o=e.defaultSharingLink;if(i){(u=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0])&&(o=u)}if(void 0!==s&&s.length>0){var u;o=(u=s.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0])||((u=s.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0])||s[0])}n=this._initializeCurrentSettings(o,e,this.props.copyLinkShortcut);if(s.length>0){n.shareId=o.shareId;n.fetchLinkOnly=!0;n.audience=o.audience;n.expiration=o.expiration;n.isEdit=o.isEdit;n.isReview=o.isReview;n.sharingRole=o.isEdit?2:o.isReview?6:1;n.preventDownload=o.blockDownload;n.sharingLinkKind=o.sharingLinkKind;this._engagementExtraData.isRedeemedUserResharing=!0;this._engagementExtraData.redeemedLinksCount=s.length}}return n};t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n].email;i&&t.push(i)}return t};t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var r=(t.getTime()-n.getTime())/864e5;return Math.floor(r)}};t.prototype._handleEscKeyPress=function(e){if(this._renderStatesSimplificationEnabled)this._viewStates.length>0?this._returnToPreviousView():this._dismiss();else{var t=this.state.viewState,n=2===t,r=3===t,i=this.props.mode===s.Mode.share;i&&n?this._onLinkPermissionsCancelClicked():i&&r?this._returnToPreviousView():this._dismiss()}e.stopPropagation()};t.prototype._initializeCurrentSettings=function(e,t,n){if(P.default.isFeatureEnabled({ODC:"ODCRequestAccess"})&&this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:s.SharingAudience.existing,expiration:null,isEdit:!0,sharingRole:2,sharingLinkKind:1,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===s.SharingAudience.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=s.SharingAudience.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:s.SharingAudience.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:2,sharingLinkKind:6,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""};if(e.audience===s.SharingAudience.specificPeopleFlex&&n){e.audience=s.SharingAudience.existing;e.sharingLinkKind=1}var r=e.sharingLinkKind,i=5===r||3===r||1===r||6===r,o=e.isEdit&&2===t.defaultShareLinkPermission,u=[];this.props.shareId&&e.principals&&(u=M.getLinkParticipants(e));return{allowEditing:i,audience:this.props.preferCustomLabeledAudience&&e.audience===s.SharingAudience.specificPeopleFlex?s.SharingAudience.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:o,sharingRole:o?2:1,sharingLinkKind:e.sharingLinkKind,specificPeople:u,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:""}};t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var r=t.sharingAbilities,i="00000000-0000-0000-0000-000000000000"===this.props.shareId,o=i?1:t.defaultSharingLink.sharingLinkKind,u=(this._store.isValidatingDefaultRecipients()||this.state.linkRecipients.length,M.isCustomLabeledSpecificPeopleSupported(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?s.SharingAudience.customLabeledSpecificPeople:s.SharingAudience.specificPeople);if(t.defaultShareLinkToExistingAccess){u=s.SharingAudience.existing;o=1}else switch(o){case 5:case 4:u=s.SharingAudience.anyone;break;case 3:case 2:u=s.SharingAudience.organization;break;case 1:default:if(i||!t.canManagePermissions||t.blockPeoplePickerAndSharing)u=s.SharingAudience.existing;else if(this._isPeopleSharingLinksEnabled){u!==s.SharingAudience.customLabeledSpecificPeople&&(u=s.SharingAudience.specificPeopleFlex);D.Killswitch.isActivated("78387c02-96db-42f2-87ff-2b40f18d8f00","05/08/2019","Update defaultLinkKind from direct to flexible based on audience")||(o=6)}else u=s.SharingAudience.existing}if(u===s.SharingAudience.specificPeopleFlex&&n){u=s.SharingAudience.existing;o=1}var a=null,f=N.getSharingAbilitiesByAudience(u,r).linkExpiration;(f?f.defaultExpirationInDays:null)>0&&(a=new Date((new Date).toDateString())).setDate(a.getDate()+f.defaultExpirationInDays);var l=N.isEditingAllowed(u,r),c=l&&2===t.defaultShareLinkPermission;return{allowEditing:l,audience:u,expiration:a,isEdit:c,sharingRole:c?2:1,isReview:!1,sharingLinkKind:o,specificPeople:[],updatePassword:!1,password:"",shareId:""}};t.prototype._loadTheme=function(e){try{var t=e;O.loadTheme(t)}catch(e){}};t.prototype._onCopyLinkClicked=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i=this;return n.__generator(this,function(o){switch(o.label){case 0:r=n.__assign(n.__assign({sendInvitation:!1},t),this.state.currentSettings);return[4,this._store.shouldInterruptCopyLink(r.isEdit)];case 1:if(o.sent()){this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData);this.setState({showCopyLinkInterrupt:!0})}else this.setState({shareType:s.ShareType.copy,shareTargetClicked:!0},function(){i._store.shareLink({settings:r,recipients:i.state.linkRecipients,copyLinkCommand:e})});return[2]}})})};t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:s.ShareType.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:s.ShareType.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:s.ShareType.teams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:s.ShareType.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===s.SharingAudience.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=0;this._renderStatesSimplificationEnabled&&this.props.mode===s.Mode.linkSettings&&(n=this.state.viewState);this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===s.SharingAudience.specificPeople},permissionsMap:t})};t.prototype._renderBackButtonForPolicyDetails=function(){if(6===this.state.viewState)return H.renderWithToolTip(h.createElement(b.IconButton,{className:"od-Share-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:T.default.backButtonLabel}),T.default.backButtonLabel)};t.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 4:return this._renderNotification();case 3:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};t.prototype._renderShareMain=function(e,t){this._renderStatesSimplificationEnabled||this._viewStates.push(0);return h.createElement("div",null,h.createElement(a.ShareMain,{key:"share",ref:this._shareMainControl,clientId:this.props.clientId,scenarioId:this.props.scenarioId,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this._onShareTargetsRendered,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onEditChange:this.onEditChange}),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}))};t.prototype._renderPolicyDetails=function(){return h.createElement(l.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return h.createElement(_.ConfirmationDialog,{confirmationCode:t?_.ConfirmationCode.copyInterruptUpdate:_.ConfirmationCode.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})};t.prototype._renderModifyPermissions=function(e){this._renderStatesSimplificationEnabled||this._viewStates.push(e);return h.createElement(o.ModifyPermissions,{clientId:this.props.clientId,shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:!1,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience})};t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,r={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===s.ShareType.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return h.createElement(f.ShareNotification,{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,clientId:this.props.clientId,sharingHintProps:r,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})};t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:s.SharingAudience.existing,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,canRequestAccessForGrantAccess:!1,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},fileExtension:"",sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:0,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0};return this._renderShareMain(t,e)};t.prototype._renderPermissionsList=function(){this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);return h.createElement(u.PermissionsList,{clientId:this.props.clientId,scenarioId:this.props.scenarioId,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,shareCommandsExperiment:!!this.props.shareCommandsExperiment})};t.prototype._renderAddPeople=function(){var e=this,t=this._grantAccessToManageAccessEnabled&&!this.props.hideShareDialogOverflowButton;return h.createElement(h.Fragment,null,h.createElement(L.AddPeople,{onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,clientId:this.props.clientId,onViewPolicyTipClicked:this._onViewPolicyTipClicked}))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(y.ActivityIndicator,{message:T.default.applyingLinkSettings})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._trackClickThru=function(e,t,n){var r=this.state.shareType,i=e.url;if(r!==s.ShareType.copy&&r!==s.ShareType.outlook)return i;var o=this._getBase62Id();R&&this._logClickThru(o,e,t,n);var u=new x.default(i);u.setQueryParameter("e",o);var a=this._store.getNavId();a&&u.setQueryParameter("nav",a);return u.toString()};t.prototype._logClickThru=function(e,t,r,i){var o=this.state,u=n.__assign(n.__assign({},this._engagementExtraData),{shareType:o.shareType,audience:t.audience,isEdit:r.isEdit,recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,linkedinRecipientsCount:this.state.linkedinRecipientsCount,hasMessage:this.state.hasMessage,hasSubject:this.state.hasSubject,messageLength:this.state.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(t),isDefaultLink:i.defaultSharingLink.sharingLinkKind===t.sharingLinkKind,clickThruId:e,clickThruScenario:s.ShareType[o.shareType]});this._store.getEngagementHelper().trackClickThru(u)};t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")};t.contextTypes={resize:d.func.isRequired,onDismiss:d.func.isRequired,sharingStore:d.object.isRequired,shareClickTime:d.number};return t})(h.Component);t.Share=U});
define("@ms/odsp-shared-sharing/lib/components/CopyLink/CopyLink",["require","exports","tslib","../../interfaces/SharingInterfaces","../ModifyPermissions/ModifyPermissions","../ShareNotification/ShareNotification","../Share.resx","office-ui-fabric-react/lib/Spinner","react","../../utilities/ShareCommunicationManager","prop-types"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._initialLinkShown=!1;r._onLinkSettingsCancelClick=function(){r.setState({shouldCopyLinkToClipboard:!1},function(){r.props.onLinkPermissionsCancelClicked()})};r._onLinkSettingsApplyClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e)})};r._shareClickTime=n.shareClickTime;r.state={shouldCopyLinkToClipboard:!0};return r}t.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 4:var n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};if(!this._initialLinkShown){f.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.copy,this.props.scenarioId);this._initialLinkShown=!0}return a.createElement(s.ShareNotification,{shareType:r.ShareType.copy,itemName:t.item.name,linkUrl:e.displayUrl,clientId:e.clientId,sharingHintProps:n,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig});case 2:return a.createElement(i.ModifyPermissions,{clientId:e.clientId,shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onSelectedPeopleChange:function(){}});default:return a.createElement("div",{className:"od-Share-spinnerHolder"},a.createElement(u.Spinner,{className:"od-Share-spinner",label:o.default.componentLoading,type:u.SpinnerType.large}))}};t.contextTypes={shareClickTime:l.number};return t})(a.Component);t.CopyLink=c});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ModifyPermissions",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","../PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog","../Header/Header","./PermissionsSettings/PermissionsSettings","office-ui-fabric-react/lib/Button","../../utilities/ShareHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../Share.resx","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","react","prop-types","../../utilities/SharingAbilitiesHelper","../../utilities/ShareHelper","@ms/odsp-utilities/lib/killswitch/Killswitch","../../utilities/ShareCommunicationManager","../../utilities/ResizeTracker","../../utilities/SharingFeatures","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._currentPassword="";r._matchingTemplate=null;r._peoplePickerHasUnresolvedText=!1;r._topLevelDivRef=d.createRef();r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._currentPassword="";r.state=r._initializeState();r._preventDownloadToggle=!!r.state.selectedPermissions.preventDownload;r._officeReviewModeToggle=!!r.state.selectedPermissions.isReview;r._initializeState=r._initializeState.bind(r);r._onApplyClicked=r._onApplyClicked.bind(r);r._onCancel=r._onCancel.bind(r);r._onPeoplePickerChange=r._onPeoplePickerChange.bind(r);r._updateExpirationErrorCode=r._updateExpirationErrorCode.bind(r);r.onAudienceChange=r.onAudienceChange.bind(r);r.onLinkTemplateChange=r.onLinkTemplateChange.bind(r);r.onEditChange=r.onEditChange.bind(r);r.onRoleChange=r.onRoleChange.bind(r);r.onExpirationChange=r.onExpirationChange.bind(r);r._getShareLinkTemplate=r._getShareLinkTemplate.bind(r);r._findMatchingShareLinkTemplate=r._findMatchingShareLinkTemplate.bind(r);r._calculateRole=r._calculateRole.bind(r);r._onPasswordChange=r._onPasswordChange.bind(r);r._resetPasswordVariables=r._resetPasswordVariables.bind(r);r._onPreventDownloadToggleChange=r._onPreventDownloadToggleChange.bind(r);r._onOfficeReviewModeToggleChange=r._onOfficeReviewModeToggleChange.bind(r);r._onConfirmationUseExisting=r._onConfirmationUseExisting.bind(r);r._onConfirmationUseNew=r._onConfirmationUseNew.bind(r);r._shareClickTime=n.shareClickTime;E.genericResizeTracker()&&(r._resizeTracker=new w.ResizeTracker(n.resize));return r}t.prototype.componentDidMount=function(){b.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.linkSettings,"");E.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){E.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=p.invertPermissionsButtonsOrder(this.props.clientId),n=m.getSharingLinksFromTemplateForRedeemedUser(this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.sharingLinkTemplates),r="od-ModifyPermissions-section";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(r+=" od-ModifyPermissions-section-noAudienceMod");return d.createElement("div",{ref:this._topLevelDivRef,className:"od-ModifyPermissions"+e},d.createElement(o.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:n.length>0?12:2,mode:this.props.mode}),d.createElement("div",{className:r},d.createElement(u.PermissionsSettings,{mode:this.props.mode,shareId:this.props.shareId,companyName:g.truncateOrganizationName(this.props.companyName),clientId:this.props.clientId,currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onLinkTemplateChange:this.onLinkTemplateChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onPreventDownloadToggleChange,onOfficeReviewModeToggleChange:this._onOfficeReviewModeToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onPeoplePickerInputChange:this._onPeoplePickerInputChange})),t?d.createElement("div",{className:"od-ModifyPermissions-actions",id:"od-ModifyPermissions-actions-id"},this._renderDefaultButton(),this._renderPrimaryButton()):d.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype.onLinkTemplateChange=function(e){var t=this.props.sharingInformation.sharingLinkTemplates.find(function(t){return!!t.linkDetails&&t.linkDetails.shareId===e}),i={allowEditing:!0,audience:r.SharingAudience.existing,expiration:null,isEdit:!1,isReview:!1,sharingRole:1,preventDownload:!1,sharingLinkKind:1,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};if(t){var s=t.linkDetails;i.shareId=s.shareId;i.fetchLinkOnly=!0;i.audience=s.audience;i.expiration=s.expiration;i.isEdit=s.isEdit;i.isReview=s.isReview;i.hasPassword=s.hasPassword;i.sharingRole=s.isEdit?2:s.isReview?6:1;i.preventDownload=s.blockDownload;i.sharingLinkKind=s.sharingLinkKind}else e===r.SharingAudience.existing.toString()?i.audience=r.SharingAudience.existing:e===r.SharingAudience.specificPeople.toString()&&(i.audience=r.SharingAudience.specificPeople);this.setState(n.__assign(n.__assign({},this.state),{peoplePickerError:null,selectedPermissions:i}))};t.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions,i=this._isAllowEditingEnabled(e),s=t.isEdit&&i,o=t.isReview&&(m.isReviewingAllowed(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)||m.isOfficeReviewModeAllowed(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),u=o?6:f.getLinkKind(e,s),a=1;o?a=6:s&&(a=2);var l={allowEditing:i,audience:e,expiration:e===r.SharingAudience.anyone||e===r.SharingAudience.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),isEdit:s,isReview:o,sharingRole:a,preventDownload:t.preventDownload&&!s&&!o,sharingLinkKind:u,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};this.setState(n.__assign(n.__assign({},this.state),{peoplePickerError:null,selectedPermissions:l}))};t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,r=f.getLinkKind(t.audience,e),i=1;e&&(i=t.isReview?6:2);this._resetPasswordVariables();this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},t),{isEdit:e,isReview:6===i,sharingRole:i,sharingLinkKind:r,preventDownload:!1}),preventDownloadDisabled:e,officeReviewModeDisabled:!!e}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,r=6==e,i=r?6:f.getLinkKind(t.audience,2===e),s=f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},t),{sharingRole:e,isEdit:2===e,isReview:r,expiration:s,sharingLinkKind:i,preventDownload:!1}),preventDownloadDisabled:1!==e}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onExpirationChange=function(e){e||(e=f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},this.state.selectedPermissions),{expiration:e})}))};t.prototype._renderDefaultButton=function(){return d.createElement(a.DefaultButton,{onClick:this._onCancel},c.default.cancelButtonText)};t.prototype._renderPrimaryButton=function(){return d.createElement(a.PrimaryButton,{className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked},c.default.applyButtonText)};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return d.createElement(i.ActivityIndicator,{message:c.default.activityMessageCreatingLink})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,r=t.isReview&&(m.isReviewingAllowed(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)||m.isOfficeReviewModeAllowed(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)),i=h.renderPickerError({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:f.ExpirationErrorCode.none,peoplePickerError:i,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),audience:t.audience,isEdit:t.isEdit,isReview:r,sharingRole:t.sharingRole,expiration:t.expiration||f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId,fetchLinkOnly:t.fetchLinkOnly},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),officeReviewModeDisabled:!!this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}};t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==f.ExpirationErrorCode.none||!!this.state.peoplePickerError};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(n.__assign(n.__assign({},this.state),{expirationErrorCode:e}))};t.prototype._onCancel=function(){this.props.onCancel()};t.prototype._onApplyClicked=function(){var e=this,t=this.state.selectedPermissions;if(this._peoplePickerHasUnresolvedText)this.setState(n.__assign(n.__assign({},this.state),{peoplePickerError:d.createElement("span",null,c.default.unresolvedTextError)}));else if(t.audience!==r.SharingAudience.specificPeopleFlex||0!==t.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==r.Mode.linkSettings){var i=this.props.doesCreate;if(t.fetchLinkOnly)this.setState(n.__assign(n.__assign({},this.state),{showActivityIndicator:i,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)});else{var s=t.audience===r.SharingAudience.anyone||t.audience===r.SharingAudience.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:null;if(this._determineMatchingTemplateAndSettingChange(s)){var o=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},t),{expiration:s,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,shareId:this._existingPasswordLinkShareId,hasPassword:o}),showActivityIndicator:i,showConfirmationDialog:!0}))}else this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},t),{expiration:s,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,hasPassword:!!this._currentPassword,shareId:""}),showActivityIndicator:i,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}}else this.setState(n.__assign(n.__assign({},this.state),{peoplePickerError:d.createElement("span",null,c.default.recipientsRequiredError)}))};t.prototype._determineMatchingTemplateAndSettingChange=function(e){if(this.state.selectedPermissions.audience!==r.SharingAudience.anyone)return!1;this._matchingTemplate=this._getShareLinkTemplate();if(!this._matchingTemplate||!this._matchingTemplate.linkDetails)return!1;if(this._currentPassword&&this._matchingTemplate.passwordProtected)return!0;var t=this._matchingTemplate.linkDetails.expiration;return null!==e&&null!==t&&(e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())};t.prototype._onPeoplePickerChange=function(e){var t=h.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===r.SharingAudience.specificPeople){for(var i=!1,s=!1,o=0,u=e;o<u.length;o++){var a=u[o];i||(i=a.isExternal&&!a.providerName);s||(s=!a.isExternal||a.isExternal&&!!a.providerName)}i&&s&&(t=d.createElement("span",null,c.default.mixedRecipientErrorMessage))}this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e);this.setState(n.__assign(n.__assign({},this.state),{peoplePickerError:t,selectedPermissions:n.__assign(n.__assign({},this.state.selectedPermissions),{specificPeople:e})}))};t.prototype._getShareLinkTemplate=function(){var e=this._findMatchingShareLinkTemplate();e&&(e.passwordProtected&&e.linkDetails?this._existingPasswordLinkShareId=e.linkDetails.shareId:this._existingPasswordLinkShareId="");return e};t.prototype._findMatchingShareLinkTemplate=function(){var e,t,n=!!this._currentPassword,r=this.props.sharingInformation.sharingLinkTemplates;if(!r||0===r.length)return null;for(var i=this._calculateRole(),s=0,o=r;s<o.length;s++){var u=o[s];if(u.role===i&&0===u.scope){if(n&&u.passwordProtected)return u;u.passwordProtected?e=u:t=u}}return e&&e.linkDetails&&!this._deletedPassword&&n?e:t};t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?7:this.state.selectedPermissions.isReview?6:this.state.selectedPermissions.isEdit?2:1};t.prototype._onPasswordChange=function(e){this._currentPassword=e;this._deletedPassword=0===e.length};t.prototype._resetPasswordVariables=function(){if(y.Killswitch.isActivated("52d2d6a6-5610-4d11-83d0-a889fd6732bb","01/21/2020","Do not reset password when role changes")){this._currentPassword="";this._deletedPassword=!1;this._existingPasswordLinkShareId=""}};t.prototype._onPreventDownloadToggleChange=function(e){this._preventDownloadToggle=e;this._resetPasswordVariables();this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},this.state.selectedPermissions),{preventDownload:e})}))};t.prototype._onOfficeReviewModeToggleChange=function(e){this._officeReviewModeToggle=e;var t=e?6:this.state.selectedPermissions.isEdit?2:1;this._resetPasswordVariables();this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},this.state.selectedPermissions),{sharingRole:t,isReview:e,sharingLinkKind:e?6:f.getLinkKind(this.state.selectedPermissions.audience,this.state.selectedPermissions.isEdit)})}))};t.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;return m.isEditingAllowed(e,t)};t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,r=t.linkDetails.expiration,i=e&&t.passwordProtected,o=null!==n&&null!==r&&(n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate());return i&&o?s.ConfirmationCode.shareDialogPasswordAndExpiration:i?s.ConfirmationCode.shareDialogPasswordOnly:s.ConfirmationCode.shareDialogExpirationOnly};t.prototype._renderConfirmationDialog=function(){var e=!!this._currentPassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),r=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?l.getShortDisplayDate(t.linkDetails.expiration):"";return d.createElement(s.ConfirmationDialog,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:r,linkExpiration:i})};t.prototype._onConfirmationUseNew=function(){var e=this;this.setState(n.__assign(n.__assign({},this.state),{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,r=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState(n.__assign(n.__assign({},this.state),{selectedPermissions:n.__assign(n.__assign({},t),{expiration:r,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.contextTypes={shareClickTime:v.number,sharingStore:v.object.isRequired,resize:v.func.isRequired};return t})(d.Component);t.ModifyPermissions=S});
define("@ms/odsp-shared-sharing/lib/components/ActivityIndicator/ActivityIndicator",["require","exports","tslib","react","office-ui-fabric-react/lib/Spinner","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:"od-ActivityIndicator","aria-live":"assertive"},r.createElement("div",null,r.createElement(i.Spinner,{type:i.SpinnerType.large})),r.createElement("span",{role:"alert"},this.props.message))};return t})(r.Component);t.ActivityIndicator=s});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../../../Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;(function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.participant=2]="participant";e[e.linkSettings=3]="linkSettings";e[e.back=4]="back";e[e.shareDialogPasswordOnly=5]="shareDialogPasswordOnly";e[e.shareDialogExpirationOnly=6]="shareDialogExpirationOnly";e[e.shareDialogPasswordAndExpiration=7]="shareDialogPasswordAndExpiration";e[e.copyInterruptUpdate=8]="copyInterruptUpdate";e[e.copyInterruptRemove=9]="copyInterruptRemove";e[e.addressBarLinkOff=10]="addressBarLinkOff"})(a=t.ConfirmationCode||(t.ConfirmationCode={}));var f=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){var e,t,n,f=this.props,l=f.confirmationCode,c=f.participant,h="od-confirmationDialog";switch(l){case a.link:e=u.default.deleteLinkDialogTitle;t=u.default.deleteLinkButtonText;n=u.default.cancelButtonText;break;case a.linkSettings:e=u.default.changeLinkSettingsDialogTitle;t=u.default.changeItButtonText;n=u.default.cancelButtonText;break;case a.participant:e=o.format(u.default.deleteLinkParticipantDialogTitle,c.name);t=u.default.removeButtonText;n=u.default.cancelButtonText;break;case a.back:e=u.default.leaveLinkSettingsDialogTitle;t=u.default.saveButtonText;n=u.default.cancelButtonText;break;case a.shareDialogPasswordOnly:e=u.default.updateLinkDialogTitle;t=u.default.useNewPasswordText;n=u.default.useExistingPasswordText;h+=" shareDialog";break;case a.shareDialogExpirationOnly:e=u.default.updateLinkDialogTitle;t=u.default.useNewExpirationText;n=u.default.useExistingExpirationText;h+=" shareDialog";break;case a.shareDialogPasswordAndExpiration:e=u.default.updateLinkDialogTitle;t=u.default.useNewSettingsText;n=u.default.useExistingSettingsText;h+=" shareDialog";break;case a.copyInterruptUpdate:e=u.default.copyInterruptUpdateTitle;t=u.default.copyInterruptContinue;n=u.default.copyInterruptOldPassword;h+=" shareDialog";break;case a.copyInterruptRemove:e=u.default.copyInterruptRemoveTitle;t=u.default.copyInterruptContinue;n=u.default.copyInterruptRemovePassword;h+=" shareDialog";break;case a.addressBarLinkOff:e=this.props.companyName?o.format(u.default.stopSharingAddressBarLinkTitleCompany,this.props.companyName):u.default.stopSharingAddressBarLinkTitle;t=u.default.stopSharing;n=u.default.cancelButtonText}return r.createElement("div",null,r.createElement(i.Dialog,{hidden:!1,className:h,onDismiss:this.props.onCancel,dialogContentProps:{type:i.DialogType.close,title:e},modalProps:{isDarkOverlay:!0,isBlocking:!0}},this._getDialogSubText(),l===a.back?r.createElement(i.DialogFooter,{className:"od-confirmationDialog-footer"},r.createElement(s.DefaultButton,{className:"od-confirmationDialog-discard",onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:u.default.discardButtonText}),r.createElement("div",{className:"od-confirmationDialog-saveCancel"},r.createElement(s.PrimaryButton,{onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{onClick:this.props.onCancel,text:n}))):l===a.copyInterruptUpdate||l===a.copyInterruptRemove?r.createElement(i.DialogFooter,null,r.createElement(s.PrimaryButton,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:n})):r.createElement(i.DialogFooter,null,r.createElement(s.PrimaryButton,{onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{onClick:this.props.onCancel,text:n}))))};t.prototype._getDialogSubText=function(){var e="";switch(this.props.confirmationCode){case a.link:return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,r.createElement("strong",null,u.default.deleteLinkLeadText)),r.createElement("span",null,u.default.deleteLinkEndText));case a.linkSettings:return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,u.default.applyLinkSettingsText));case a.participant:return;case a.shareDialogPasswordOnly:e=o.format(u.default.overwritePasswordText,this.props.linkPasswordSetBy);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.shareDialogExpirationOnly:e=o.format(u.default.overwriteExpirationText,this.props.linkExpiration);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.shareDialogPasswordAndExpiration:e=o.format(u.default.overwriteSettingsText,this.props.linkExpiration,this.props.linkPasswordSetBy);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.copyInterruptUpdate:e=u.default.copyInterruptUpdateContent;return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.copyInterruptRemove:e=u.default.copyInterruptRemoveContent;return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.addressBarLinkOff:e=u.default.stopSharingAddressBarLinkSubText;return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e))}};return t})(r.Component);t.ConfirmationDialog=f});
define("@ms/odsp-shared-sharing/lib/components/Header/Header",["require","exports","tslib","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","../../interfaces/SharingInterfaces","react","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareHelper","../Share.resx","@ms/odsp-utilities/lib/browser/ResponsiveUI","office-ui-fabric-react/lib/Tooltip","../../utilities/UiUtils","../../utilities/SharingFeatures","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButtonRefOld=a.createRef();r._closeButtonRef=a.createRef();r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={showContextualMenu:!1,target:null};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._breakpoint=n.breakpoint;r._store=n.sharingStore;r._onDismissMoreContextualMenu=r._onDismissMoreContextualMenu.bind(r);r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);r._onMoreClick=r._onMoreClick.bind(r);r._useFabricButtons=g.fabricButtonsForHeader();return r}t.prototype.render=function(){var e=this.props;if(e.mode===o.Mode.linkSettings)return u.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName(),u.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderCloseButton()));var t=4===e.viewState||7===e.viewState||9===e.viewState,n=c.isMobile(this.props.clientId)||this._platformDetection.isMobile,r=n&&this._breakpoint>=d.default.DEFAULT_BREAKPOINTS.Large,i=t?"":" od-ShareHeader-backgroundColor",s=g.fluentShareHeader()&&this.props.hasBackButton?" od-ShareHeader-withBackButton":"",a=t?"":u.createElement("div",{className:"od-ShareHeader"+i+s},u.createElement("div",{className:"od-ShareHeader-title"},u.createElement("h1",{className:"od-ShareHeader-viewName"},this.props.title||this._getViewName()),this._renderItemName())),f=n?u.createElement("div",{className:"od-ShareHeader-buttons-left"+(this._useFabricButtons?" od-ShareHeader-buttons-fabric":"")},this._renderCloseButton()):"";return u.createElement("div",null,f,a,this._renderRightHeaderButtons(n,r,t,e.viewState),this._renderContextualMenu())};t.prototype._renderMoreButton=function(){if(!(0!==this.props.viewState&&10!==this.props.viewState||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){if(this._useFabricButtons){var e={items:[{key:"manageaccess",text:p.default.manageExistingAccessLabel,ariaLabel:p.default.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick}]};return m.renderWithToolTip(u.createElement(i.IconButton,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",role:"menu",ariaLabel:p.default.moreOptionsLabel,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e}),p.default.moreOptionsLabel,{position:v.DirectionalHint.bottomRightEdge})}return m.renderWithToolTip(u.createElement("button",{className:"od-ShareHeader-button","aria-label":p.default.moreOptionsLabel,onClick:this._onMoreClick,"aria-haspopup":!0,"aria-expanded":this.state.showContextualMenu,role:"button"},u.createElement(r.Icon,{iconName:"More"})),p.default.moreOptionsLabel,{position:v.DirectionalHint.bottomRightEdge})}};t.prototype._renderCloseButton=function(){if(this._onDismiss&&c.showCloseButton(this.props.clientId)&&3!==this.props.viewState)return this._useFabricButtons?u.createElement(i.IconButton,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.default.closeButtonLabel,onClick:this._dismissComponent,iconProps:{iconName:"Cancel"}}):u.createElement("button",{className:"od-ShareHeader-button","aria-label":p.default.closeButtonLabel,onClick:this._dismissComponent,ref:this._closeButtonRefOld,onBlur:this.props.closeButtonOnBlur},u.createElement(r.Icon,{iconName:"Cancel"}))};t.prototype._renderRightHeaderButtons=function(e,t,n,r){var i="od-ShareHeader-buttons-right"+(this._useFabricButtons?" od-ShareHeader-buttons-fabric":"");return e&&!n&&0===r?u.createElement("div",{className:i},this._renderMoreButton()):e&&(n||0!==r)?"":u.createElement("div",{className:i},this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(){var e=this.props.item;if(e){var t=e.childCount>1?" ("+l.format(p.default.folderHeader,e.childCount)+")":"";return u.createElement("div",{className:"od-ShareHeader-itemName"},h.truncateItemNameForHeader(e.name+" "+t))}};t.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:p.default.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return u.createElement(s.ContextualMenu,{ariaLabel:p.default.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};t.prototype._onDismissMoreContextualMenu=function(){this.setState(n.__assign(n.__assign({},this.state),{showContextualMenu:!1}))};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()};t.prototype._getViewName=function(){var e=p.default;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 12:return e.modifylinksFromTemplateHeader;case 3:return e.manageExistingAccessLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;case 10:return e.addPeopleLabel;default:return e.shareLinkHeader}};t.prototype.focusCloseButton=function(){if(this._closeButtonRefOld.current){this._closeButtonRefOld.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}if(this._closeButtonRef.current){this._closeButtonRef.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:f.func,platformDetection:f.object.isRequired,breakpoint:f.object.isRequired,sharingStore:f.object.isRequired};return t})(u.Component);t.Header=y});
define("@ms/odsp-shared-sharing/lib/utilities/ClientIdHelper",["require","exports","../interfaces/SharingInterfaces"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isOfficeProduct=function(e){return u(e)||f(e)||a(e)||l(e)||c(e)||p(e)};function r(e){return e===n.ClientId.odb||e===n.ClientId.sharePoint||e===n.ClientId.odc}t.isODSP=r;t.isOutlook=function(e){return e===n.ClientId.outlookWeb||e===n.ClientId.outlookWindows||e===n.ClientId.outlookMac};function i(e){return e===n.ClientId.odIos||e===n.ClientId.wordIos||e===n.ClientId.excelIos||e===n.ClientId.visioIos||e===n.ClientId.onenoteIos||e===n.ClientId.powerpointIos||e===n.ClientId.teamsIos||e===n.ClientId.officemobileIos||e===n.ClientId.listsIos}t.isIos=i;function s(e){return e===n.ClientId.odAndroid||e===n.ClientId.wordAndroid||e===n.ClientId.excelAndroid||e===n.ClientId.visioAndroid||e===n.ClientId.onenoteAndroid||e===n.ClientId.powerpointAndroid||e===n.ClientId.teamsAndroid||e===n.ClientId.officemobileAndroid}t.isAndroid=s;function o(e){return i(e)||s(e)}t.isMobile=o;t.showCloseButton=function(e){return r(e)||e===n.ClientId.onenoteWeb||e===n.ClientId.outlookWeb||e===n.ClientId.officecom||e===n.ClientId.teams||e===n.ClientId.sample||e===n.ClientId.outlookGroupsWeb||e===n.ClientId.fluid||e===n.ClientId.odcWac||e===n.ClientId.wac||e===n.ClientId.listPart||e===n.ClientId.listsHome||o(e)};t.showOWAShareTarget=function(e){return r(e)||e===n.ClientId.officecom||e===n.ClientId.wac};t.invertPermissionsButtonsOrder=function(e){return o(e)||h(e)};function u(e){return e===n.ClientId.word||e===n.ClientId.wordAndroid||e===n.ClientId.wordIos}t.isWord=u;function a(e){return e===n.ClientId.excel||e===n.ClientId.excelAndroid||e===n.ClientId.excelIos}t.isExcel=a;function f(e){return e===n.ClientId.powerpoint||e===n.ClientId.powerpointAndroid||e===n.ClientId.powerpointIos}t.isPowerPoint=f;function l(e){return e===n.ClientId.visio||e===n.ClientId.visioIos||e===n.ClientId.visioAndroid}t.isVisio=l;function c(e){return e===n.ClientId.onenote||e===n.ClientId.onenoteWeb||e===n.ClientId.onenoteUWP||e===n.ClientId.onenoteIos||e===n.ClientId.onenoteAndroid}t.isOneNote=c;function h(e){return e===n.ClientId.teams||e===n.ClientId.teamsIos||e===n.ClientId.teamsAndroid}t.isTeams=h;function p(e){return e===n.ClientId.officemobileIos||e===n.ClientId.officemobileAndroid}t.isUnionApp=p;t.supportsPeopleApi=function(e){return e===n.ClientId.odc};t.supportsFamily=function(e){return e===n.ClientId.odc};t.mayUseEmbeddedIEWebView=function(e){return e===n.ClientId.word||e===n.ClientId.excel||e===n.ClientId.powerpoint||e===n.ClientId.ngsc||e===n.ClientId.visio}});
define("@ms/odsp-shared-sharing/lib/utilities/ShareHelper",["require","exports","tslib","../interfaces/SharingInterfaces","@ms/odsp-utilities/lib/string/StringHelper","../components/Share.resx","../utilities/ClientIdHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.days=[s.default.sunday,s.default.monday,s.default.tuesday,s.default.wednesday,s.default.thursday,s.default.friday,s.default.saturday];t.shortDays=[s.default.shortSunday,s.default.shortMonday,s.default.shortTuesday,s.default.shortWednesday,s.default.shortThursday,s.default.shortFriday,s.default.shortSaturday];t.shortMonths=[s.default.shortJanuary,s.default.shortFebruary,s.default.shortMarch,s.default.shortApril,s.default.shortMay,s.default.shortJune,s.default.shortJuly,s.default.shortAugust,s.default.shortSeptember,s.default.shortOctober,s.default.shortNovember,s.default.shortDecember];t.months=[s.default.january,s.default.february,s.default.march,s.default.april,s.default.may,s.default.june,s.default.july,s.default.august,s.default.september,s.default.october,s.default.november,s.default.december];t.MAX_DAYS_FOR_EXPIRING_LINK=730;var a;(function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"})(a=t.ExpirationErrorCode||(t.ExpirationErrorCode={}));t.truncateItemNameForHeader=function(e){return f(e,26)};t.truncateOrganizationName=function(e,t){return f(e,t=t||25)};t.truncateItemNameForShareNotification=function(e,t){return f(e,t=t||20)};function f(e,t){if(!e)return"";var n=t,r=n/2;return e.length<=n?e:e.slice(0,r)+"..."+e.slice(e.length-r)}t.isLoadingData=function(e){return 0===e.userRole&&0===e.defaultLinkKind};t.getSharingLinkKindFromVroomScope=function(e,t){switch(e){case"anonymous":return t?5:4;case"organization":return t?3:2;case"users":return 6;default:return 1}};t.getSharingAudienceFromVroomScope=function(e){switch(e){case"anonymous":return r.SharingAudience.anyone;case"organization":return r.SharingAudience.organization;case"users":return r.SharingAudience.specificPeople;default:return r.SharingAudience.existing}};t.getVroomScopeFromSharingLinkKind=function(e){switch(e){case 5:case 4:return"anonymous";case 3:case 2:return"organization";case 6:return"users";default:return"existingAccess"}};t.getLinkIconUrl=function(e,t,n){var i=t.sharingLinkKind,s=t.audience,u="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing",a=o.isOutlook(e)?"directrecipients.svg":"peopleinchat.svg";switch(i){case 2:case 3:return u+"/companyonly.svg";case 4:case 5:return u+"/anyone.svg";case 6:return t.audience===r.SharingAudience.customLabeledSpecificPeople?n&&n.iconUrl||u+"/"+a:u+"/specificpeople.svg";default:return s===r.SharingAudience.customLabeledSpecificPeople?n&&n.iconUrl||u+"/"+a:u+"/existingaccess.svg?v2"}};t.getLinkIconName=function(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return e.audience===r.SharingAudience.anyone?"Globe":e.audience===r.SharingAudience.organization?"Work":"PeopleAdd";default:return"Link"}};t.getDarkTheme=function(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}};function l(e,t,n,r){var i=o.isOutlook(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return s.default.peopleInChannelEditLabel;case"review":return u.OfficeIconFileTypeMap[r]?s.default.peopleInChannelOfficeReviewLabel:s.default.peopleInChannelReviewLabel;default:return s.default.peopleInChannelViewLabel}break;case"team":switch(t){case"edit":return s.default.peopleInTeamEditLabel;case"review":return u.OfficeIconFileTypeMap[r]?s.default.peopleInTeamOfficeReviewLabel:s.default.peopleInTeamReviewLabel;default:return s.default.peopleInTeamViewLabel}break;case"recipient":switch(t){case"edit":return s.default.recipientsCanEditLabel;case"review":return u.OfficeIconFileTypeMap[r]?s.default.recipientsCanOfficeReviewLabel:s.default.recipientsCanReviewLabel;default:return s.default.recipientsCanViewLabel}break;default:switch(t){case"edit":return s.default.peopleInChatEditLabel;case"review":return u.OfficeIconFileTypeMap[r]?s.default.peopleInChatOfficeReviewLabel:s.default.peopleInChatReviewLabel;default:return s.default.peopleInChatViewLabel}}}t.getCustomLinkLabel=l;t.getLinkLabel=function(e,t,n,o,a){var f=e.sharingLinkKind,c=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?i.format(s.default.fileRequestCSLDescription,t):s.default.fileRequestDescription;switch(f){case 2:return i.format(s.default.cslViewDescription,t);case 3:return i.format(s.default.cslEditDescription,t);case 4:return s.default.anonViewDescription;case 5:return s.default.anonEditDescription;case 1:return c===r.SharingAudience.customLabeledSpecificPeople?e.isReview?o&&o.entityName?i.format(s.default.customLabeledReviewLabel,o.entityName):l(n,"review",o,a):e.isEdit?o&&o.entityName?i.format(s.default.customLabeledEditLabel,o.entityName):l(n,"edit",o):o&&o.entityName?i.format(s.default.customLabeledViewLabel,o.entityName):l(n,"view",o):s.default.existingPeopleDescription;case 6:return c===r.SharingAudience.existing?s.default.existingPeopleDescription:c===r.SharingAudience.anyone?e.blockDownload?e.hasPassword?s.default.anonymousViewOnlyWithPassword:s.default.anonymousViewOnlyHint:e.hasPassword?e.isReview?u.OfficeIconFileTypeMap[a]?s.default.anonPasswordOfficeReviewDescription:s.default.anonPasswordReviewDescription:e.isEdit?s.default.anonPasswordEditDescription:s.default.anonPasswordViewDescription:e.isReview?u.OfficeIconFileTypeMap[a]?s.default.anonOfficeReviewDescription:s.default.anonReviewDescription:e.isEdit?s.default.anonEditDescription:s.default.anonViewDescription:c===r.SharingAudience.customLabeledSpecificPeople?e.isReview?o&&o.entityName?i.format(s.default.customLabeledReviewLabel,o.entityName):l(n,"review",o,a):e.isEdit?o&&o.entityName?i.format(s.default.customLabeledEditLabel,o.entityName):l(n,"edit",o):o&&o.entityName?i.format(s.default.customLabeledViewLabel,o.entityName):l(n,"view",o):e.audience===r.SharingAudience.organization?e.blockDownload?i.format(s.default.cslViewOnlyHint,t):e.isReview?u.OfficeIconFileTypeMap[a]?i.format(s.default.cslOfficeReviewDescription,t):i.format(s.default.cslReviewDescription,t):e.isEdit?i.format(s.default.cslEditDescription,t):i.format(s.default.cslViewDescription,t):e.blockDownload?s.default.specificPeopleViewOnlyHint:e.isReview?u.OfficeIconFileTypeMap[a]?s.default.pslOfficeReviewLabel:s.default.pslReviewLabel:e.isEdit?s.default.pslEditLabel:s.default.pslViewLabel;default:return""}};t.getLinkParticipants=function(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push({id:o.id,name:o.primaryText,image:o.imageUrl,isResolved:!0,principalName:o.loginName,userId:o.loginName,email:o.email,job:o.secondaryText,isExternal:o.isExternal,loginName:o.loginName,principalType:o.type})}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push({id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type})},a=0,f=r;a<f.length;a++){u(f[a])}return t};t.getEncodedMessageLength=function(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t};t.getFileShareTypeFromAudience=function(e){return e===r.SharingAudience.anyone?0:e===r.SharingAudience.organization?1:e===r.SharingAudience.existing?4:2};t.getRoleIconNameAndTitle=function(e){var t,n;switch(e){case 2:t="Edit";n=s.default.canEditRole;break;case 1:t="Uneditable2";n=s.default.canViewRole;break;case 6:t="Feedback";n=s.default.canReviewRole;break;case 3:t="Signin";n=s.default.fullControlRole}return{name:t,title:n}};t.getExpirationErrorCode=function(e,n){var r=a.none,i=n;if(!e||e.getTime()===new Date(0).getTime())return r;var s=new Date;s.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-s.getTime())/864e5);o<1?r=a.pastDate:o>t.MAX_DAYS_FOR_EXPIRING_LINK?r=a.overMax:o>i&&-1!==i&&(r=a.adminPolicy);return r};t.getLinkKind=function(e,t){return e===r.SharingAudience.anyone?t?5:4:e===r.SharingAudience.organization?t?3:2:e===r.SharingAudience.specificPeople||e===r.SharingAudience.existing?1:6};t.getExpirationDatePickerErrorMessage=function(e,n){var r=s.default;switch(e){case a.pastDate:return r.pastDateExpirationError;case a.adminPolicy:return i.format(r.adminExpirationError,n);case a.overMax:return i.format(r.maxExpirationError,t.MAX_DAYS_FOR_EXPIRING_LINK);case a.adminRequired:return s.default.requireExpirationError;default:return""}};t.canAddPeople=function(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal};t.canManageAddressBarLink=function(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled};t.isCustomLabeledSpecificPeopleSupported=function(e,t,n){return o.isOutlook(e)||t===r.Mode.linkSettings&&o.isTeams(e)&&n&&(!!n.entityName||!!n.audienceType)};t.getDefaultExpirationDateValue=function(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n};t.copySharingLinkToClipboard=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,u;return n.__generator(this,function(n){switch(n.label){case 0:i=!1;if(o.isMobile(e))return[3,4];try{t.focus();t.setSelectionRange(0,t.value.length);i=document.execCommand("copy")}catch(e){}if(i||!window.navigator||!window.navigator.clipboard)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(t.value)];case 2:n.sent();i=!0;return[3,4];case 3:n.sent();return[3,4];case 4:try{s=window.external;u=s.CopyToClipboard(r);i=u||void 0===u}catch(e){}return[2,i]}})})}});
define("@ms/odsp-utilities/lib/browser/ResponsiveUI",["require","exports","../events/EventGroup","../scope/Scope"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResponsiveUIEvents={formFactorChange:"formFactorChange",hamburgerVisibilityChange:"hamburgerVisibilityChange",showLabelsChange:"showCommandLabelsChange"};var i={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},s={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},o=(function(){function e(e,t){this._scope=new r.default;this._events=new(this._scope.attached(n.default))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var i=t.breakpoints;this._breakpoints="function"==typeof i?i:function(){return i};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=s);if(0===e)return"Medium";for(var n in s)if(e<t[n])return n};e.determineCssClass=function(e){return i[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var n=document.body,r=document.documentElement,i=this._windowHeight=r.clientWidth||n.clientWidth;this._windowWidth=r.clientHeight||n.clientHeight;var o=this._formFactorSize,u=this._formFactorSize=e.determineWindowSize(i,this._breakpoints());this._cssClass=e.determineCssClass(u);var a=this._isHamburgerVisible;this._isHamburgerVisible=i<s.Large;var f=this._showLabels;this._showLabels=this.compareSize(u,"Medium")>0;o&&u!==o&&this._events.raise(t.ResponsiveUIEvents.formFactorChange);"boolean"==typeof a&&a!==this._isHamburgerVisible&&this._events.raise(t.ResponsiveUIEvents.hamburgerVisibilityChange);"boolean"==typeof f&&f!==this._showLabels&&this._events.raise(t.ResponsiveUIEvents.showLabelsChange);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=s;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.ResponsiveUI=o;t.default=o});
define("@ms/odsp-shared-sharing/lib/utilities/UiUtils",["require","exports","tslib","office-ui-fabric-react/lib/Tooltip","react"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={gapSpace:0},o={maxWidth:"300px"},u=0;t.renderWithToolTip=function(e,t,a){var f=(a=a||{}).tooltipId?a.tooltipId:"od-Share-tooltip-"+u;u++;var l=a.targetElementId?n.__assign(n.__assign({},s),{target:"#"+a.targetElementId}):s;return i.createElement(r.TooltipHost,{id:f,content:t,directionalHint:void 0===a.position?r.DirectionalHint.topCenter:a.position,calloutProps:l,tooltipProps:o},e)};t.renderScreenReaderOnlyAlert=function(e,t,n){return i.createElement("span",{className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}});
define("@ms/odsp-shared-sharing/lib/utilities/SharingFeatures",["require","exports","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/Features"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.genericResizeTracker=function(){return!n.Killswitch.isActivated("340bf70f-df65-48f1-bcab-d7f251fe3bf6","05/13/2020","Introduce generic resize tracker that watches bounding rect.")};t.genericShareViewStatesEnabled=function(){return!n.Killswitch.isActivated("257f933a-2681-43aa-915b-a756ff4b7f78","04/10/2020","Simplify render function/flatten view states in Share.tsx")};t.grantAccessToManageAccess=function(){return!n.Killswitch.isActivated("9a68535c-0542-4ab9-87cb-1c306ea8d882","04/14/2020","Allow navigation from Grant Access to Manage Access via ... menu")};t.fullControlRoleForSharingLists=function(){return!n.Killswitch.isActivated("8ef49cb9-8e33-4261-acb3-11cec6bf929a","05/27/2020","Allow full control role while granting access to lists")};t.requestAccessChangesInAddPeopleMode=function(){return!n.Killswitch.isActivated("89fb0a3a-d972-49b6-9d66-4e9426c7ea87","05/28/2020","show detail message in Add People (grant access) view when access needs to be requested")};t.fluentSharepoint=function(){return!n.Killswitch.isActivated("dc0d2554-cc99-4c76-a9c0-9051db7fff0e","06/01/2020","Make the share dialog fluent on Sharepoint website")};t.atMentionCallbackEnabled=function(){return!n.Killswitch.isActivated("4871dfa3-5de8-46d7-995c-5eaa87cbecdd","06/02/2020","Enable callback for at-mention result")&&!r.default.isFeatureEnabled({ODC:"AtMentionCallbackKillswitch"})};t.fluentShareHeader=function(){return!n.Killswitch.isActivated("c2c7f33a-3c0d-45b1-84e2-479261473ea9","06/10/2020","Make the share dialog header fluent compatible")};t.fabricButtonsForHeader=function(){return!n.Killswitch.isActivated("3d64ebe6-5587-4363-8a44-23024269e287","06/11/2020","Use Fabric buttons in share dialog header")&&!r.default.isFeatureEnabled({ODC:"FabricButtonsForHeaderKillswitch"})}});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PermissionsSettings/PermissionsSettings",["require","exports","tslib","../AudienceChoiceGroup/AudienceChoiceGroup","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Checkbox","../ExpirationDatePicker/ExpirationDatePicker","../PasswordField/PasswordField","../../../utilities/ShareHelper","../../../data/Icons/FileShareIconMap","../../../interfaces/SharingInterfaces","../../PermissionsList/ShareLink/ChangePermission/ChangePermission","../../../utilities/PeoplePickerHelper","react","react","prop-types","../../../utilities/SharingAbilitiesHelper","@ms/odsp-utilities/lib/string/StringHelper","../../PeoplePickerWrapper/PeoplePickerWrapper","../../Share.resx","../PreventDownload/PreventDownload","../../../utilities/ClientIdHelper","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/Icon","@ms/odsp-utilities/lib/previews/BlockDownloadSupport","../OfficeReviewMode/OfficeReviewMode","../AudienceChoiceGroup/LinkTemplateChoiceGroup","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._allowEditCheckbox=d.createRef();i._pickerUpsellDiv=d.createRef();i._passwordUpsellDiv=d.createRef();i._learnMoreClicked=function(){i.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(i.props.engagementExtraData)};i._onPeoplePickerChange=function(e){i.setState(n.__assign(n.__assign({},i.state),{externalRecipientWarning:h.getOversharingExternalsWarning(e),groupRecipientWarning:h.getOversharingGroupsWarning(e,i.props.groupsMemberCount)}),function(){i.props.onPeoplePickerChange(e)})};i._setSpecificPeopleReadOnlyExpanded=function(){i.setState({isSpecificPeopleReadOnlyExpanded:!0})};i._onAllowRoleChange=function(e){var t=!1,r=!1;2===e&&(t=!0);6===e&&(r=!0);i.setState(n.__assign(n.__assign({},i.state),{preventDownloadDisabled:t||r}),function(){i.props.onRoleChange(e)})};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._resize=r.resize;var s=t.selectedPermissions.specificPeople;i.state={expirationErrorCode:a.ExpirationErrorCode.none,externalRecipientWarning:h.getOversharingExternalsWarning(s),groupRecipientWarning:h.getOversharingGroupsWarning(s,t.groupsMemberCount),preventDownloadDisabled:i.props.selectedPermissions.isEdit||i.props.selectedPermissions.isReview,officeReviewModeDisabled:!1===i.props.selectedPermissions.isEdit&&!1===i.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1};i._onAllowEditChange=i._onAllowEditChange.bind(i);i._onChoiceGroupChange=i._onChoiceGroupChange.bind(i);i._onLinkTemplateChoiceChange=i._onLinkTemplateChoiceChange.bind(i);i._onSelectDate=i._onSelectDate.bind(i);i._renderExpirationDatePicker=i._renderExpirationDatePicker.bind(i);i._renderExpirationDatePickerErrorMessage=i._renderExpirationDatePickerErrorMessage.bind(i);i._renderPeoplePicker=i._renderPeoplePicker.bind(i);i._permissionsOptions=i._getAudienceChoiceGroupOptions();i._linkTemplateOptions=i._getLinkTemplateOptions();i._supportedAudienceOptions=r.sharingStore.getSupportedAudienceOptions();return i}t.prototype.componentDidMount=function(){var e=this;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();if(this._disablePremiumFeatures){if(this._pickerUpsellDiv.current){this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()});this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==i.KeyCodes.enter&&t.keyCode!==i.KeyCodes.space||e._togglePickerTeachingBubble()})}if(this._passwordUpsellDiv.current){this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()});this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==i.KeyCodes.enter&&t.keyCode!==i.KeyCodes.space||e._togglePasswordTeachingBubble()})}}var t,n,r=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];if(r){t=r.getElementsByClassName("ms-Checkbox-text")[0];n=r.children[0]}t&&t.setAttribute("aria-hidden","true");if(n){n.setAttribute("aria-label",b.default.allowEditLabel);this.context.sharingStore.isPremiumExperienceAllowed()||n.focus()}};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype.render=function(){var e=this.props;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();return this._getLinkTemplateOptions().length>0?p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},p.createElement("span",{className:"od-PermissionsSettings-linksFromTemplateHeader"},b.default.linksFromTemplateHeader)),p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),p.createElement(C.LinkTemplateChoiceGroup,{items:this._getLinkTemplateOptions(),onChange:this._onLinkTemplateChoiceChange,onLinkTemplateChange:e.onLinkTemplateChange,companyName:e.companyName,clientId:e.clientId,sharingInformation:e.sharingInformation}),this._renderPeoplePicker())):this._getAudienceOptions().length>1?p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},p.createElement("span",{className:"od-PermissionsSettings-prompt"},b.default.permissionsSettingsHeader),this.context.sharingStore.showAudienceLearnMore()&&p.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-label":b.default.learnMoreLabel+": "+b.default.permissionsSettingsHeader,href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked},b.default.learnMoreLabel)),p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),p.createElement(r.AudienceChoiceGroup,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId}),this._renderPeoplePicker()),this._renderOtherSettings()):p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"})),this._renderOtherSettings())};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,r=e.selectedPermissions,i=r.specificPeople;0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients);this.setState(n.__assign(n.__assign({},this.state),{expirationErrorCode:a.getExpirationErrorCode(r.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:h.getOversharingExternalsWarning(i),groupRecipientWarning:h.getOversharingGroupsWarning(i,e.groupsMemberCount),preventDownloadDisabled:r.isEdit||r.isReview,officeReviewModeDisabled:!r.isEdit&&!r.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})};t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})};t.prototype._renderOtherSettings=function(){if(this.props.selectedPermissions.audience!==l.SharingAudience.existing&&!this.props.sharingInformation.requiresAccessApproval)return p.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},p.createElement("div",{className:"od-PermissionsSettings-description"},b.default.otherSettings),p.createElement("div",{role:"group","aria-label":b.default.otherSettings},p.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()))};t.prototype._getSpecificPeopleOption=function(){var e=this.props.sharingInformation.requiresAccessApproval,t=e?b.default.permissionsRequestAccessString:b.default.permissionsSpecificPeopleString,n=!this.props.createPeopleSharingLinks||e?[1]:[6],r=this.props.createPeopleSharingLinks?l.SharingAudience.specificPeopleFlex:l.SharingAudience.specificPeople;return{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:r,label:t,linkKinds:n,permissionsType:2}};t.prototype._getAudienceChoiceGroupOptions=function(){var e=[{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:l.SharingAudience.anyone,label:b.default.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0},{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.organization,label:g.format(b.default.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var t={icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.existing,label:b.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};e.splice(2,0,t)}return e};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return e.selectedPermissions.audience!==l.SharingAudience.specificPeople&&e.selectedPermissions.audience!==l.SharingAudience.specificPeopleFlex||!e.copyLinkShortcut&&e.mode!==l.Mode.linkSettings?void 0:E.isOutlook(this.props.clientId)?p.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},e.currentSettings.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0):p.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},p.createElement(y.default,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null}))};t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,r=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var s=r>0&&!this.state.isSpecificPeopleReadOnlyExpanded?p.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+r):void 0;return p.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,s)};t.prototype._renderRolesDropDown=function(){var e=this.props,t=m.isReviewingAllowed(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension);return t?p.createElement("div",{className:"od-PermissionsSettings-changePermission"},p.createElement(c.ChangePermission,{selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,item:e.sharingInformation.item,canChangePermission:!1,showReview:t})):p.createElement(s.Checkbox,{className:"od-PermissionsSettings-allowEdit",label:b.default.allowEditLabel,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing,componentRef:this._allowEditCheckbox})};t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return this.context.sharingStore.isExpirationDateModificationAllowed()&&(t.audience===l.SharingAudience.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===l.SharingAudience.specificPeople)?this._disablePremiumFeatures?p.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},p.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-datePicker"},p.createElement(o.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),p.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-datePicker"},p.createElement(o.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),p.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())):void 0};t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:b.default.expirationTeachingBubbleHeadline,mainText:b.default.expirationTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return a.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;return t&&n.audience===l.SharingAudience.anyone?this._disablePremiumFeatures?p.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},p.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement(u.PasswordField,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1}),this._renderPasswordTeachingBubble()))):p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement(u.PasswordField,{onPasswordChange:this.props.onPasswordChange})):void 0};t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:b.default.passwordTeachingBubbleHeader,mainText:b.default.passwordTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._getLinkTemplateOptions=function(){var e=[],t=this.props.sharingInformation,n=t.sharingLinkTemplates,r=t.sharingAbilities,i=m.getSharingLinksFromTemplateForRedeemedUser(r,n);if(i.length>0){for(var s=0,o=i;s<o.length;s++){var u=o[s];e.push(this._getLinkTemplateOption(u))}var a={icon:f.FileShareIconMap[1],isChecked:this.props.currentSettings.audience===l.SharingAudience.existing,isDisabled:!1,key:l.SharingAudience.existing.toString(),label:b.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};e.push(a);var c=this.props.sharingInformation.requiresAccessApproval?b.default.permissionsRequestAccessString:b.default.permissionsSpecificPeopleString,h={icon:f.FileShareIconMap[2],isChecked:this.props.currentSettings.audience===l.SharingAudience.specificPeople,isDisabled:!1,key:l.SharingAudience.specificPeople.toString(),label:c,linkKinds:[1],permissionsType:2};e.push(h)}return e};t.prototype._getLinkTemplateOption=function(e){var t={icon:f.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[4,5],permissionsType:0,link:e},n={icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[2,3],permissionsType:1,link:e};switch(e.audience){case l.SharingAudience.anyone:t.key=e.shareId;t.label=a.getLinkLabel(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return t;case l.SharingAudience.organization:n.key=e.shareId;n.label=a.getLinkLabel(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return n}};t.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation,n=[],r=this.props.currentSettings,i=void 0;for(var s in e)if(e.hasOwnProperty(s)){var o=e[s],u=m.getSharingAbilitiesAudience(s);if(!u)continue;if(u===l.SharingAudience.specificPeopleFlex&&!this.props.createPeopleSharingLinks){i=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?i.isChecked=i.key===r.audience||l.SharingAudience.specificPeopleFlex===r.audience:i.isDisabled=!0;this._supportedAudienceOptions.indexOf(l.SharingAudience.specificPeople)>-1&&n.push(i);continue}var c=this._getAudienceOption(u);if(c){c.isDisabled=!(o.canManageEditLink.enabled||o.canManageReadLink.enabled);c.isChecked=c.key===r.audience;n.push(c)}}var h={icon:f.FileShareIconMap[1],isChecked:r.audience===l.SharingAudience.existing,isDisabled:!1,key:l.SharingAudience.existing,label:b.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};this._supportedAudienceOptions.indexOf(l.SharingAudience.existing)>-1&&n.splice(2,0,h);var p=n.filter(function(e){return e.key===l.SharingAudience.specificPeople&&!e.isDisabled||e.key===l.SharingAudience.specificPeopleFlex&&!e.isDisabled?e:null}).length>0,d=!this.props.omitCustomLabeledAudience&&a.isCustomLabeledSpecificPeopleSupported(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig);if(p&&d){var v=this._getAudienceOption(l.SharingAudience.customLabeledSpecificPeople);n.splice(2,0,v);v.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal);v.isChecked=r.audience===l.SharingAudience.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&r.audience===l.SharingAudience.specificPeopleFlex}this.props.mode!==l.Mode.linkSettings||!E.isOutlook(this.props.clientId)||this.props.shareId&&r.audience===l.SharingAudience.specificPeopleFlex||!p||n.splice(n.indexOf(p),1);return n};t.prototype._renderPreventDownloadToggle=function(){var e=this.props.selectedPermissions,t=!!e.preventDownload,n=this.context.sharingStore.isPreventDownloadAllowed();return!!!this.context.sharingStore.getNavId()&&n&&m.supportsRestrictedView(e.audience,this.props.sharingInformation.sharingAbilities)&&T.isBlockDownloadSupported(this.props.sharingInformation.fileExtension,1)?p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},p.createElement(w.PreventDownload,{onToggleChange:this.props.onToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isRolesDropDown:e.isReview}))):void 0};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props.selectedPermissions,t=!!e.isReview;return m.isOfficeReviewModeAllowed(e.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)?p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode"},p.createElement(N.OfficeReviewMode,{onToggleChange:this.props.onOfficeReviewModeToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disableOfficeReviewMode:this.state.officeReviewModeDisabled}))):void 0};t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var r=window.external;r.IsGoPremiumAvailable()&&(n=function(){try{r.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:b.default.teachingBubbleLearnMoreButton,onClick:this.context.premiumLearnMore};else try{var i=window.external;if(i.IsPremiumLearnMoreAvailable()){t={children:b.default.teachingBubbleLearnMoreButton,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}}}}catch(e){}return p.createElement(S.TeachingBubble,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,headline:e.headline,primaryButtonProps:{children:b.default.teachingBubbleUpgradeButton,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0},p.createElement(x.Icon,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)};t.prototype._getAudienceOption=function(e){var t=b.default;if(e===l.SharingAudience.anyone&&this._supportedAudienceOptions.indexOf(l.SharingAudience.anyone)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:l.SharingAudience.anyone,label:b.default.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0};if(e===l.SharingAudience.organization&&this._supportedAudienceOptions.indexOf(l.SharingAudience.organization)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.organization,label:g.format(b.default.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(e===l.SharingAudience.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(l.SharingAudience.specificPeopleFlex)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:l.SharingAudience.specificPeopleFlex,label:t.permissionsSpecificPeopleString,linkKinds:[6],permissionsType:2};if(e===l.SharingAudience.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(l.SharingAudience.customLabeledSpecificPeople)>-1){var n=E.isOutlook(this.props.clientId),r=n?6:5,i="",s=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;i=n||"recipient"===s?t.permissionsRecipientsOfThisMessageString:"channel"===s?t.permissionsPeopleInChannelString:"team"===s?t.permissionsPeopleinTeamString:t.permissionsPeopleInChatString;return{disabledText:b.default.disabledAudienceChoiceLabel2,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&f.FileShareIconMap[r],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:l.SharingAudience.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?g.format(t.permissionsOnlyCustomLabeledString,this.props.customLabeledAudienceConfig.entityName):i,linkKinds:[6],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&r}}};t.prototype._onChoiceGroupChange=function(e){for(var t=0,n=this._permissionsOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onLinkTemplateChoiceChange=function(e){for(var t=0,n=this._linkTemplateOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onSelectDate=function(e){var t=this,r=a.getExpirationErrorCode(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(n.__assign(n.__assign({},this.state),{expirationErrorCode:r}),function(){t.props.updateExpirationErrorCode(r);t.props.onExpirationChange(e)})};t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t);this.setState(n.__assign(n.__assign({},this.state),{preventDownloadDisabled:t,officeReviewModeDisabled:!!t}))};t.contextTypes={resize:v.func.isRequired,sharingStore:v.object.isRequired,goPremium:v.func,premiumLearnMore:v.func};return t})(p.Component);t.PermissionsSettings=k});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup",["require","exports","tslib","office-ui-fabric-react/lib/FocusZone","../../ShareLinkDescription/ShareLinkDescription","react","prop-types","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/ClientIdHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!f.isMobile(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||r._onRowClick(t,null)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return s.createElement("div",{"aria-label":u.default.permissionsSettingsHeader,role:"radiogroup"},s.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,defaultActiveElement:".od-AudienceChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};t.prototype._renderItem=function(e){var t=e.key,n=!this._platformDetection.isFirefox,r=e.isDisabled&&e.disabledText?e.disabledText:"",o=this.state.selectedKey===t;return s.createElement("div",{key:t},s.createElement("button",{role:"radio","aria-checked":o,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:o,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+r,"data-key":t},s.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":o?a.format(u.default.audienceSelectedStatus,e.label):"",className:"od-Share-screenReaderOnly"},o?a.format(u.default.audienceSelectedStatus,e.label):""),s.createElement("div",{className:"od-AudienceChoiceGroup-description"},s.createElement(i.ShareLinkDescription,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:n?r:""})),s.createElement("div",{className:"tickIcon","aria-hidden":!0})),s.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e});n.onChange(e);n.onAudienceChange(e)};t.contextTypes={platformDetection:o.object.isRequired};return t})(s.Component);t.AudienceChoiceGroup=l});
define("@ms/odsp-shared-sharing/lib/components/ShareLinkDescription/ShareLinkDescription",["require","exports","tslib","../../data/Icons/FileShareIconMap","../ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton","office-ui-fabric-react/lib/Icon","react","ODCExecutors_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=r.FileShareIconMap[this.props.permissionsType],t=this.props.iconUrl?o.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):o.createElement(s.Icon,{"aria-hidden":"true",iconName:e});return o.createElement("div",{className:"od-ShareLinkDescription"},o.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e,"aria-hidden":"true"},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?o.createElement(i.InfoButton,{message:e}):"";if(this.props.showLabel)return o.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t)};return t})(o.Component);t.ShareLinkDescription=u});
define("@ms/odsp-shared-sharing/lib/data/Icons/FileShareIconMap",["require","exports"],function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});t.FileShareIconMap=((n={})[0]="Globe",n[3]="Lock",n[2]="PeopleAdd",n[1]="Work",n[4]="SecurityGroup",n[5]="Chat",n[6]="Mail",n)});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","react","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(n.__assign(n.__assign({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(n.__assign(n.__assign({},i.state),{isCalloutVisible:!1}))};i._onInfoButton=function(e){i._infoButton=e};i.state={isCalloutVisible:!1};return i}t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",null,s.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},s.createElement(i.Icon,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout})),t.isCalloutVisible&&s.createElement(r.Callout,{directionalHint:r.DirectionalHint.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))};t.contextTypes={strings:o.object.isRequired};return t})(s.Component);t.InfoButton=u});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/DatePicker","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","../../Share.resx","react","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","../../../utilities/ClientIdHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=i.DatePicker,d=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSelectDateForExpirationPicker=function(e){r._expirationDateRemoved=!1;var t=e<new Date(Date.now());r._platformDetection.isIE||r._datePicker.focus();r.setState({hasExpired:t,selectedDate:e});r.props.onSelectDate(e)};r._onDeleteDate=function(){r._expirationDateRemoved=!0;r.setState({selectedDate:null},function(){r.props.onSelectDate(null)})};r._formatDate=function(e){if(e){var t=e.getDay(),n=e.getMonth();return r._datePickerStrings.days[t]+" "+r._datePickerStrings.shortMonths[n]+" "+e.getDate()+" "+e.getFullYear()}return""};var i=r.props.value<new Date(Date.now());r.state={hasExpired:i,selectedDate:null};r._platformDetection=n.platformDetection;var s=new Date(Date.now());r._minDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());t.expiryRestriction>0?r._maxDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+t.expiryRestriction,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()):r._maxDate=new Date(s.getFullYear()+2,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());r._isMobile=r._platformDetection.isMobile||h.isMobile(r.props.clientId);r._datePickerStrings={months:o.months,shortMonths:o.shortMonths,days:o.days,shortDays:o.shortDays,goToToday:u.default.goToToday,setExpirationDate:u.default.setExpirationDate,nextMonthAriaLabel:u.default.nextMonthAriaLabel,prevMonthAriaLabel:u.default.prevMonthAriaLabel,ariaLabel:r._formattedExpirationDateAriaLabel(),pickerAriaLabel:u.default.expirationDatePickerAriaLabel,closeButtonAriaLabel:r._isMobile&&u.default.calendarCloseButton||""};return r}t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired;this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel();return a.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},a.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},a.createElement(s.Icon,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"}),a.createElement("div",{className:"od-ExpirationDatePicker-hidden","aria-label":u.default.datePickerIconAlt},u.default.datePickerIconAlt)),a.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":"")},this._renderExpiresLabel(),a.createElement(p,{componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex}),this._renderRemoveDateButton()),this._renderPremiumGleam())};t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return a.createElement("span",{className:e,role:"alert","aria-live":"assertive"},this.state.hasExpired?u.default.expired:u.default.expires)}};t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=l.format(u.default.expirationDateToolTip,this.props.expiryRestriction);return a.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},a.createElement(f.TooltipHost,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",content:t,directionalHint:f.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},a.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},a.createElement(s.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}return a.createElement(f.TooltipHost,{content:u.default.removeExpirationLabel,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},a.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":u.default.removeExpirationLabel},a.createElement(s.Icon,{iconName:"Cancel",role:"alert","aria-live":"assertive","aria-label":this._expirationDateRemoved?u.default.expirationDateRemoved:u.default.removeExpirationLabel})))}};t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?l.format(u.default.expirationDateValueAriaLabel,""):this._platformDetection.isIOS?u.default.setExpirationDate:""};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?a.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-ExpirationDatePicker-premiumGleam"}):void 0};t.contextTypes={platformDetection:c.object.isRequired};return t})(r.BaseComponent);t.ExpirationDatePicker=d});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordField/PasswordField",["require","exports","tslib","../PasswordStrengthMeter/PasswordStrengthMeter","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","react","prop-types","../../../utilities/ResizeTracker","../../../utilities/SharingFeatures","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._currentStrengthMeterValue="";i._topLevelDiv=a.createRef();i._onUpdatePassword=function(e,t){void 0===t&&(t="");var r=t.length>0;i.setState(n.__assign(n.__assign({},i.state),{currentPassword:t,displayRemovePasswordButton:r&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})};if(i.props.detailsPane){i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}}else i.state=n.__assign(n.__assign({},i.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1});i._renderShareReminder=i._renderShareReminder.bind(i);i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i);i._onFocusPasswordField=i._onFocusPasswordField.bind(i);i._onBlurPasswordField=i._onBlurPasswordField.bind(i);i._onDeletePassword=i._onDeletePassword.bind(i);i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i);i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i);c.genericResizeTracker()&&(i._resizeTracker=new l.ResizeTracker(r.resize));return i}t.prototype.componentDidUpdate=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDiv)};t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel(),n=this.state.displayRemovePasswordButton?{iconName:"Cancel",onClick:this._onDeletePassword,className:"od-PasswordField-delete",ariaLabel:o.default.removePassword,tabIndex:0}:void 0;return a.createElement("div",{ref:this._topLevelDiv,className:"od-PasswordField"},a.createElement("div",{className:"od-PasswordField-passwordFieldLine"},a.createElement("div",{className:"od-PasswordField-label"},a.createElement(s.Icon,{iconName:"Lock"})),a.createElement("div",{className:"od-ShareLink-passwordFieldContent"},a.createElement(i.TextField,{type:"password",autoComplete:"off",disabled:this.state.disablePasswordField,placeholder:o.default.setPasswordFieldText,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,iconProps:n,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText"})),this._renderPremiumGleam()),this._renderShareReminder())};t.prototype._renderShareReminder=function(){var e,t="od-PasswordField-shareReminder";this.props.detailsPane&&(t+="-detailsPane");this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane&&(e=a.createElement("div",{className:"odPasswordField-lastModifiedBy"},o.default.passwordFieldPasswordSetBy+this.props.lastModifiedBy)):e=this.state.currentPassword.length>0?a.createElement(r.PasswordStrengthMeter,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue}):a.createElement("div",null,o.default.passwordFieldShareReminder):e=a.createElement("div",null,"");return a.createElement("div",{className:t,id:"shareReminderText"},e)};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?a.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-PasswordField-premiumGleam"}):void 0};t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState(n.__assign(n.__assign({},this.state),{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._onFocusPasswordField=function(){this.setState(n.__assign(n.__assign({},this.state),{displayNotificationText:!0}))};t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState(n.__assign(n.__assign({},this.state),{displayNotificationText:!1}))};t.prototype._onDeletePassword=function(){var e=this;this.setState(n.__assign(n.__assign({},this.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._getPasswordFieldAriaLabel=function(){return this.state.currentPassword.length>0?u.format(o.default.currentStrength,this._currentStrengthMeterValue):o.default.passwordFieldName};t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e};t.contextTypes={resize:f.func.isRequired};return t})(a.Component);t.PasswordField=h});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordStrengthMeter/PasswordStrengthMeter",["require","exports","tslib","react","office-ui-fabric-react/lib/ProgressIndicator","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","../../Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[u.default.passwordStrengthMeterStrengthLevel0,u.default.passwordStrengthMeterStrengthLevel1,u.default.passwordStrengthMeterStrengthLevel2,u.default.passwordStrengthMeterStrengthLevel3,u.default.passwordStrengthMeterStrengthLevel4],f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n);n._renderStrengthText=n._renderStrengthText.bind(n);n._renderStrengthBar=n._renderStrengthBar.bind(n);return n}t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=o.format(u.default.currentStrength,a[e]);this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(a[e]);return r.createElement("div",{className:"od-PasswordStrengthMeter"},r.createElement(s.TooltipHost,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return r.createElement("div",null,r.createElement("ul",{style:{margin:0,padding:0}},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},u.default.passwordStrengthMeterStrengthExplanation1," ",r.createElement("br",null)),u.default.passwordStrengthMeterStrengthExplanation2," ",r.createElement("br",null),u.default.passwordStrengthMeterStrengthExplanation3," ",r.createElement("br",null),u.default.passwordStrengthMeterStrengthExplanation4))}}},r.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))};t.prototype._renderStrengthText=function(e){var t=a[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText"},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},u.default.passwordStrengthMeterStrengthBarText),r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))};t.prototype._renderStrengthBar=function(e){var t=a[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},r.createElement(i.ProgressIndicator,{percentComplete:.25*e,barHeight:4}))};t.prototype._calculatePasswordStrength=function(e){var t=0;e.length>8&&t++;/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++;/\d/.test(e)&&t++;/[^A-Za-z0-9]/g.test(e)&&t++;return t};return t})(r.Component);t.PasswordStrengthMeter=f});
define("@ms/odsp-shared-sharing/lib/utilities/ResizeTracker",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0};this._resizeCallback=e;this._callbackDelayMilliseconds=20}e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)};e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback());this._cachedRect=n}};return e})();t.ResizeTracker=n});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ChangePermission/ChangePermission",["require","exports","tslib","react","../../../RoleSelector/RoleSelector","../../../Share.resx","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onAllowRoleChange=function(e){r.setState({selectedKey:e},function(){r.props.onRoleChange(e)})};r.state={selectedKey:r._getSelectedKey(t)};return r}t.prototype.render=function(){var e=this.props;return r.createElement(i.RoleSelector,{disabled:e.canChangePermission,role:this.state.selectedKey,onRoleChange:this._onAllowRoleChange,item:e.item,showReview:e.showReview},e.canChangePermission&&this._renderInfoIcon())};t.prototype._getSelectedKey=function(e){return e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?2:1};t.prototype._renderInfoIcon=function(){return r.createElement("div",{className:"od-changePermissions--info","aria-label":s.default.createNewLinkTooltip,"aria-haspopup":!0},r.createElement(u.TooltipHost,{id:"od-changePermissions--tooltip",content:s.default.createNewLinkTooltip,directionalHint:u.DirectionalHint.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"320px"}},r.createElement(o.Icon,{iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))};return t})(r.Component);t.ChangePermission=a});
define("@ms/odsp-shared-sharing/lib/components/RoleSelector/RoleSelector",["require","exports","tslib","react","office-ui-fabric-react/lib/Dropdown","office-ui-fabric-react/lib/Icon","../../utilities/ShareHelper","../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","office-ui-fabric-react/lib/Tooltip","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i._onRenderTitle=function(e){var t=o.getRoleIconNameAndTitle(e[0].key);return r.createElement("div",{className:"od-RoleSelector-roleDropdownOptionMainContent"},r.createElement(s.Icon,{iconName:t.name,"aria-hidden":"true",title:t.name,className:"od-RoleSelector-settingIcon"}),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionText"}," ",e[0].text," "))};i._onRenderOption=function(e){var t=o.getRoleIconNameAndTitle(e.key);return r.createElement("div",{className:"od-RoleSelector-roleDropdownOption"},r.createElement(l.TooltipHost,{content:t.title,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:t.name})),r.createElement("div",{className:"od-RoleSelector-roleDropdownOptionMainContent"},r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionText"}," ",e.text," "),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionSubtext"},e.data)))};i._onAllowRoleChange=function(e,t){i.props.onRoleChange(t.key)};return i}t.prototype.render=function(){var e=this.props,n=o.getRoleIconNameAndTitle(e.role),u=!!this.props.showReview,a=e.role;6===a&&!1===u&&(a=2);3!==a||e.showFullControl||(a=2);var c=[];e.showFullControl&&c.push(this.props.isListSharing?t._fullControlDropdownOptionForLists:t._fullControlDropdownOption);c.push(this.props.isListSharing?t._editDropDownOptionForLists:t._editDropDownOption);u&&c.push(t._reviewDropdownOption);c.push(this.props.isListSharing?t._viewDropdownOptionForLists:t._viewDropdownOption);return r.createElement("div",{className:"od-RoleSelector-wrapper"},r.createElement(l.TooltipHost,{content:n.title,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:n.name})),r.createElement(i.Dropdown,{className:"od-RoleSelector-rolesDropdown",disabled:!!this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChange:this._onAllowRoleChange,defaultSelectedKey:a,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:f.ResponsiveMode.large,options:c,ariaLabel:this.props.ariaLabel}),this.props.children)};t._editDropDownOption={key:2,text:u.default.canEditRole,data:u.default.canEditRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canEditRole,u.default.canEditRoleSubText)};t._editDropDownOptionForLists=n.__assign(n.__assign({},t._editDropDownOption),{data:u.default.canEditRoleSubTextForLists});t._reviewDropdownOption={key:6,text:u.default.canReviewRole,data:u.default.canReviewRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canReviewRole,u.default.canReviewRoleSubText)};t._viewDropdownOption={key:1,text:u.default.canViewRole,data:u.default.canViewRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canViewRole,u.default.canViewRoleSubText)};t._viewDropdownOptionForLists=n.__assign(n.__assign({},t._viewDropdownOption),{data:u.default.canViewRoleSubTextForLists});t._fullControlDropdownOption={key:3,text:u.default.fullControlRole,data:u.default.fullControlRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.fullControlRole,u.default.fullControlRoleSubText)};t._fullControlDropdownOptionForLists=n.__assign(n.__assign({},t._fullControlDropdownOption),{data:u.default.fullControlRoleSubTextForLists});return t})(r.Component);t.RoleSelector=c});
define("@ms/odsp-shared-sharing/lib/utilities/PeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/string/StringHelper","react","office-ui-fabric-react/lib/Link","../components/Share.resx","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","../components/Share.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isUnvalidatedEmailAddress=function(e){return!!e&&!!e.rawPersonData&&!!e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType};t.getExternalPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0};t.getLinkedInPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 4===e.entityType}).length:0};t.getOversharingExternalsWarning=function(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(o=r.join(", ")).lastIndexOf(",");return o.substring(0,i)+" "+s.default.and+" "+o.substring(i+1)+" "+s.default.outsideOfYourOrgPlural}if(n>2){var o;i=(o=r.join(", ")).lastIndexOf(",");return o.substring(0,i+1)+" "+s.default.and+" "+o.substring(i+1)+" "+s.default.outsideOfYourOrgPlural}return 1===n?r[0]+" "+s.default.outsideOfYourOrgSingular:""};t.getOversharingGroupsWarning=function(e,t){var r=e.filter(function(e){return 2===e.entityType}).length,i="";1===r?i=s.default.oneGroupInvited:r>1&&(i=n.format(s.default.multipleGroupsInvited,r));t>=1e3?i+=" "+s.default.groupsMemberCountLargeLabel:t>=25&&(i+=" "+n.format(s.default.groupsMemberCountLabel,t));return i};t.renderPickerError=function(e){for(var t=e.selectedItems,n=e.sharingLinkKind,f=e.canAddExternalPrincipal,l=e.sharingInformation,c=e.viewPolicyTipCallback,h=e.permissionsMap,p=r.createElement("div",null,r.createElement("span",null,s.default.ptErrorMessage," "),r.createElement(i.Link,{onClick:c},s.default.ptViewPolicyTipLabel)),d=l.item.hasDlpPolicy||l.sharingAbilities&&7===l.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,v=0,m=t;v<m.length;v++){var g=m[v];if(!g.isResolved)return d&&!f?p:g.rawData?a(g.rawData,l.customizedExternalSharingServiceUrl):r.createElement("span",null,s.default.noExactMatch);if(g.isExternal&&d&&!f)return p;if(g.isExternal&&g.principalType===o.default.distributionList&&2===g.entityType)return r.createElement("span",null,u.default.peoplePickerErrorDLNotSupported);var y=3===n||2===n;if(g.isExternal&&y)return r.createElement("span",null,s.default.peoplePickerErrorCsl)}if(h&&1===n){var b=0;for(var w in h)1===h[w]&&b++;var E="";1===b?E=s.default.insufficientPermissionsError:b>1&&(E=s.default.insufficientPermissionsErrorPlural);var S=e.onShareHintClick?r.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:e.onShareHintClick,href:"javascript:void(0)"},s.default.changeLinkType):void 0;if(E)return r.createElement("div",null,r.createElement("span",null,E),S)}return l.peoplePickerError?r.createElement("span",null,l.peoplePickerError):null};function a(e,t){var i=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===i?r.createElement("span",null,e.Description):i>=401&&i<=404?t?r.createElement("div",null,n.formatToArray(s.default.externalSharingAllowDenyListWithLink,i,r.createElement("a",{href:t,target:"_blank"},s.default.noExternalSharingLearnMoreHere))):r.createElement("span",null,n.format(s.default.externalSharingAllowDenyList,i)):i>=200&&i<=209||i>=301&&i<=305?t?r.createElement("div",null,n.formatToArray(s.default.externalSharingDisabledWithLink,i,r.createElement("a",{href:t,target:"_blank"},s.default.noExternalSharingLearnMoreHere))):r.createElement("span",null,n.format(s.default.externalSharingDisabled,i)):void 0}});
define("@ms/odsp-shared-sharing/lib/utilities/SharingAbilitiesHelper",["require","exports","../interfaces/SharingInterfaces","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={ODB:772},u={ODB:1765},a={ODB:1935};t.getSharingAbilitiesAudience=function(e){return"anonymousLinkAbilities"===e?n.SharingAudience.anyone:"organizationLinkAbilities"===e?n.SharingAudience.organization:"peopleSharingLinkAbilities"===e?n.SharingAudience.specificPeopleFlex:void 0};function f(e,t){return e===n.SharingAudience.anyone?t.anonymousLinkAbilities:e===n.SharingAudience.organization?t.organizationLinkAbilities:e===n.SharingAudience.specificPeopleFlex||e===n.SharingAudience.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}t.getSharingAbilitiesByAudience=f;t.isEditingAllowed=function(e,t){var n=f(e,t);return n.canManageEditLink?n.canManageEditLink.enabled:!!n.canAddInternalPrincipal&&n.canAddInternalPrincipal.enabled};t.isReviewingAllowed=function(e,t,n){if(r.default.isFeatureEnabled(o)&&!i.OfficeIconFileTypeMap[n]){var s=f(e,t);return s.canManageReviewLink?s.canManageReviewLink.enabled:!!s.supportsReviewPermission&&s.supportsReviewPermission.enabled}return!1};t.isOfficeReviewModeAllowed=function(e,t,n){if(r.default.isFeatureEnabled(u)&&i.wordType===i.OfficeIconFileTypeMap[n]){var s=f(e,t);return s.canManageReviewLink?s.canManageReviewLink.enabled:!!s.supportsReviewPermission&&s.supportsReviewPermission.enabled}return!1};t.supportsRestrictedView=function(e,t){var n=f(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled};t.getSharingLinksFromTemplateForRedeemedUser=function(e,t){var n=[],i=new s.ABExperiment({name:"RedeemedUserShareUI",startDate:"05/05/2020",version:s.ABExpHash.v2});if(r.default.isFeatureEnabled(a)&&i.IsExperimentOn())for(var o=0,u=t;o<u.length;o++){var l=u[o];if(l.linkDetails&&l.linkDetails.shareId){var c=f(l.linkDetails.audience,e);if(!(!!c.canManageEditLink&&c.canManageEditLink.enabled||!!c.canManageReviewLink&&c.canManageReviewLink.enabled||!!c.canManageReadLink&&c.canManageReadLink.enabled)){!!(l.linkDetails.expiration&&l.linkDetails.expiration<new Date(Date.now()))||n.push(l.linkDetails)}}}return n}});
define("@ms/odsp-shared-sharing/lib/components/PeoplePickerWrapper/PeoplePickerWrapper",["require","exports","tslib","react","../LivePeoplePicker/LivePeoplePicker","../PeoplePicker/PeoplePicker","prop-types"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._peoplePickerProvider=n.peoplePickerProvider;return r}t.prototype.render=function(){return!!this._peoplePickerProvider.getLivePersonaPickerHelper&&!!this._peoplePickerProvider.getLivePersonaPickerHelper()?r.createElement(i.default,n.__assign({},this.props,{selectionLimit:100})):r.createElement(s.default,n.__assign({},this.props,{selectionLimit:100}))};t.contextTypes={peoplePickerProvider:o.object.isRequired};return t})(r.Component);t.default=u});
define("@ms/odsp-shared-sharing/lib/components/LivePeoplePicker/LivePeoplePicker",["require","exports","tslib","@ms/odsp-datasources/lib/PeoplePicker","@ms/odsp-utilities/lib/string/EmailAddressParser","office-ui-fabric-react/lib/MessageBar","prop-types","react","react","../LivePersonaPickerAdapter/LivePersonaPickerAdapter","office-ui-fabric-react/lib/Spinner","../../utilities/ClientIdHelper","../Share.resx","../../utilities/ResizeTracker","../../utilities/SharingFeatures","./LivePeoplePicker"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m;(function(e){e.Person="Person";e.Group="Group"})(v||(v={}));(function(e){e.OrganizationUser="OrganizationUser";e.LinkedIn="LinkedIn";e.UnifiedGroup="UnifiedGroup";e.PublicDistributionList="PublicDistributionList"})(m||(m={}));var g=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._lppAdapterRef=a.createRef();i._wrapperDivRef=a.createRef();i._getHostAppSuggestions=function(e){return n.__awaiter(i,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:t=this.props.pickerSettings;r={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.sharePointSearch(e,r)];case 1:i=n.sent();return[2,i.map(function(e){return{Id:e.userId,Name:e.name,UserPrincipalName:e.rawPersonData.userPrincipalName||e.email,SuggestionType:e.name,SuggestionSubtype:e.name,EmailAddresses:[e.email||""],HostAppSuggestion:e}})]}})})};i._onSelectedPersonasChanged=function(){var e=i.state.selectedPersonas.map(function(e){return i._personaPillListItemToIPerson(e)});i.props.onChange(e)};i._onRemovePersona=function(e){i.setState(function(t,r){var s=i.state.selectedPersonas.filter(function(t){return t.Id!==e.Id});return n.__assign(n.__assign({},t),{selectedPersonas:s})},i._onSelectedPersonasChanged)};i._onSuggestionSelected=function(e){var t=n.__assign(n.__assign({},e),{validationState:"Pending"});i.setState(function(e){return n.__assign(n.__assign({},e),{selectedPersonas:n.__spreadArrays(e.selectedPersonas,[t])})});i._validateSuggestion(e).then(function(e){return i._onPersonaValidated(e)})};i._onKeyDown=function(e){"Backspace"===e.key&&i._lppAdapterRef.current&&""===i._lppAdapterRef.current.getCurrentText()&&i.setState(function(e,t){return n.__assign(n.__assign({},e),{selectedPersonas:e.selectedPersonas.slice(0,-1)})},i._onSelectedPersonasChanged)};i._validateSuggestion=function(e){return n.__awaiter(i,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(s){switch(s.label){case 0:if(e.SuggestionSubtype===m.OrganizationUser)return[2,n.__assign(n.__assign({},e),{validationState:"Valid"})];t=this.props.pickerSettings;r={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.resolve(e.UserPrincipalName,r).then(function(e){!e.email&&e.rawData&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);!e.name&&e.rawData&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})];case 1:i=s.sent();e.HostAppSuggestion=i;return[2,n.__assign(n.__assign({},e),{validationState:this._shouldShowErrorOnItem(i)?"Error":"Valid"})]}})})};i._peoplePickerProvider=r.peoplePickerProvider;i._resize=r.resize;i._platformDetection=r.platformDetection;i._hasTakenErrorFocus=!1;i._peoplePickerProvider=r.peoplePickerProvider;var s=t.defaultSelectedItems.map(function(e){return{Id:e.email,Name:e.name,UserPrincipalName:e.principalName,EmailAddresses:[e.email],SuggestionType:v.Person,SuggestionSubtype:m.OrganizationUser,HostAppSuggestion:e,Source:"HostApp",validationState:"Valid",SuggestionSource:"HostApp",SuggestionOrigin:"ZeroTerm"}});i.state={selectedPersonas:s};i._livePeoplePickerHelper=i._peoplePickerProvider._dataSource.getLivePersonaPickerHelper();d.genericResizeTracker()&&(i._resizeTracker=new p.ResizeTracker(r.resize));return i}t.prototype.render=function(){var e={emptyResults:h.default.noResultsLabel,loading:h.default.loadingLabel,error:h.default.LPPPeoplePickerSearchError,allResults:h.default.LPPAllResultsPeoplePicker,limitedResults:h.default.LPPLimitedResultsPeoplePicker,suggestionsCalloutAccessibilityOnShow:h.default.fabricPickerSuggestionsAvailable,useThisAddress:h.default.LPPUseThisAddress,pickerModePlaceholderText:this._computePlaceholderText()};if(!(this.props.pickerSettings&&0!==Object.keys(this.props.pickerSettings).length))return u.createElement("div",{className:"od-Share-LivePeoplePicker-lpp"});var t=n.__assign(n.__assign({},this._livePeoplePickerHelper.getLppOptions()),{getHostAppSuggestions:this._getHostAppSuggestions}),r=this._livePeoplePickerHelper.getUserPrincipalName();return u.createElement("div",{className:"od-Share-LivePeoplePicker-lpp",ref:this._wrapperDivRef,onKeyDown:this._onKeyDown},u.createElement(f.LivePersonaPickerAdapter,{ref:this._lppAdapterRef,userPrincipalName:r,options:t,strings:e,entryDisabled:!1,selectedPersonas:this.state.selectedPersonas,onSuggestionSelected:this._onSuggestionSelected,onRemovePersona:this._onRemovePersona,fallback:u.createElement(l.Spinner,{size:l.SpinnerSize.small})}),this._renderError(),this._renderWarnings())};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isValidateInProgress()){if(!c.isMobile(this.props.clientId)&&!this._hasTakenErrorFocus){this._focusInput();this._hasTakenErrorFocus=!0}return u.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){this.state.selectedPersonas.length>=this.props.selectionLimit&&n.push(u.createElement(s.MessageBar,{key:"peoplePickerLimitMessage",ariaLabel:h.default.peoplePickerLimitMessage},h.default.peoplePickerLimitMessage));e&&n.push(u.createElement(s.MessageBar,{key:"oversharingExternalsWarning",ariaLabel:e},e));t&&n.push(u.createElement(s.MessageBar,{key:"oversharingGroupsWarning",ariaLabel:t},t));return n.length>0?u.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype.componentDidUpdate=function(e,t){this._resizeTracker?this._resizeTracker.checkSizeChangeForRef(this._wrapperDivRef):null!==this.props.error&&null===e.error&&this._resize();var n=t.selectedPersonas.length>=this.props.selectionLimit&&this.state.selectedPersonas.length<this.props.selectionLimit;this._hasInitialFocus&&!n||this._focusInput()};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;c.isMobile(this.props.clientId)||e||this._focusInput()};t.prototype._focusInput=function(){if(this._lppAdapterRef.current){this._lppAdapterRef.current.focus();this._hasInitialFocus=!0}};t.prototype._shouldShowErrorOnItem=function(e){var t=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal),n=this.props.permissionsMap;return e.isExternal&&!t||1===this.props.sharingLinkKind&&n&&(1===n[e.email]||1===n[e.userId])||!e.isResolved&&!e.isResolving};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._onPersonaValidated=function(e){this.setState(function(t,r){var i=t.selectedPersonas.filter(function(t){return t.Id!==e.Id});i.push(e);return n.__assign(n.__assign({},t),{selectedPersonas:i})},this._onSelectedPersonasChanged)};t.prototype._convertPrincipalType=function(e){if(!e)return r.PrincipalType.none;for(var t=r.PrincipalType.none,n=0,i=e.split(",");n<i.length;n++){var s=i[n];"User"===s&&(t|=r.PrincipalType.user);"DL"===s&&(t|=r.PrincipalType.distributionList);"SecGroup"===s&&(t|=r.PrincipalType.securityGroup);"SPGroup"===s&&(t|=r.PrincipalType.sharePointGroup)}return t};t.prototype._lppSuggestionToIPerson=function(e){if(e.HostAppSuggestion&&e.HostAppSuggestion.hasOwnProperty("userId"))return e.HostAppSuggestion;var t=e.EmailAddresses[0],n=e.UserPrincipalName&&i.default.isValidEmailSyntax(e.UserPrincipalName,!1)?e.UserPrincipalName:t,s={Key:n,IsResolved:!1},o=e.SuggestionSubtype===m.OrganizationUser,u=e.SuggestionSubtype===m.LinkedIn,a=e.SuggestionType===v.Group&&e.SuggestionSubtype===m.UnifiedGroup,f=e.SuggestionSubtype===m.PublicDistributionList,l={rawData:s,rawPersonData:s,userId:n,name:e.Name,email:t,isExternal:!o,isResolved:!0};if(o){l.entityType=0;l.principalType=r.PrincipalType.user}else if(a){l.entityType=2;l.principalType=r.PrincipalType.securityGroup}else if(u)l.entityType=4;else{l.principalType=f?r.PrincipalType.distributionList:r.PrincipalType.none;l.entityType=e.SuggestionType===v.Group?2:1;l.providerName=void 0}return l};t.prototype._personaPillListItemToIPerson=function(e){return n.__assign(n.__assign({},this._lppSuggestionToIPerson(e)),{isResolved:"Pending"!==e.validationState})};t.prototype._isValidateInProgress=function(){for(var e=0,t=this.state.selectedPersonas;e<t.length;e++){if("Pending"===t[e].validationState)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?h.default.peoplePickerPlaceholder:h.default.peoplePickerPlaceholderWithSelection};t.contextTypes={peoplePickerProvider:o.object.isRequired,resize:o.func.isRequired,platformDetection:o.object.isRequired};return t})(u.Component);t.default=g});
define("@ms/odsp-shared-sharing/lib/components/LivePersonaPickerAdapter/LivePersonaPickerAdapter",["require","exports","react","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!1;t.LivePersonaPickerAdapter=n.forwardRef(function(t,s){var o=r.useState(null),u=o[0],a=o[1];r.useEffect(function(){u||new Promise(function(t,n){e(["@msfast/lpp-hostapp-share-dialog/dist/livepersonapicker"],t,n)}).then(function(e){if(!i){e.initializeLivePersonaPicker(t.userPrincipalName,t.options);i=!0}a({LivePersonaPicker:e.getLivePersonaPickerWithRichTextInput(t.userPrincipalName),PersonaPillList:e.PersonaPillList})})},[u]);var f=r.useState(null),l=f[0],c=f[1],h=r.useState(!1),p=h[0],d=h[1];r.useEffect(function(){if(p&&l){l.focus();d(!1)}},[l,p]);r.useImperativeHandle(s,function(){return{focus:function(){d(!0)},getCurrentText:function(){return l.getCurrentText()}}});if(!u)return t.fallback||null;var v=u.LivePersonaPicker,m=u.PersonaPillList;return n.createElement("div",null,n.createElement(m,{personaItems:t.selectedPersonas,onRemoveItem:t.onRemovePersona}),t.entryDisabled||n.createElement(v,{componentRef:function(e){c(e)},strings:t.strings,maxHeight:200,maxWidth:300,onSuggestionSelected:t.onSuggestionSelected,selectedSuggestions:t.selectedPersonas}))})});
define("@ms/odsp-shared-sharing/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/MessageBar","@ms/odsp-shared-react/lib/PeoplePicker","../../interfaces/SharingInterfaces","react","prop-types","../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Spinner","@ms/odsp-utilities/lib/guid/Guid","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Icon","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/killswitch/Killswitch","../../utilities/PeoplePickerHelper","../../utilities/ResizeTracker","../../utilities/SharingFeatures","../../utilities/UiUtils","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var x;(function(e){e[e.None=0]="None";e[e.Family=1]="Family";e[e.FamilyMember=2]="FamilyMember"})(x||(x={}));var T=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onItemsChange=function(e){var t=i.state.selectedItems.concat(e);i.setState({selectedItems:t},function(){i.props.onChange(t)});e.forEach(function(e){i._onAutoResolve(e)})};i._onInputChange=function(e){i._hasTakenErrorFocus=!1;if(e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);t&&t[0]&&(e=t[0].substring(1,t[0].length-1));if(e=e.trim())return i._createGenericPerson(e)}).filter(function(e){return e});i._onItemsChange(t);i.props.onInputChange&&i.props.onInputChange("");return""}var n=/['"].*['"]/g.exec(e);if(n&&n[0])return n[0].substring(1,n[0].length-1);i.props.onInputChange&&i.props.onInputChange(e);return e};i._onGetMoreResults=function(e){var t=i.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:i._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!i.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:i.props.sharingInformation.siteIBSegmentIDs};return i._peoplePickerProvider.sharePointSearch(e,n)};i._onSuggestionSelected=function(e){var t=i.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:i._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(g.default.isFeatureEnabled({ODC:"FamilySharing"})&&c.supportsFamily(i.props.clientId)){var r=i._store.getFamily(),s=i._store.getFamilyMembers();e.userId===r.userId?i._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:i.props.clientId,scenarioId:"",familySuggestionType:x[i.state.familyType],mode:o.Mode.share}):s.some(function(t){return t.userId===e.userId})&&i._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:i.props.clientId,scenarioId:"",familySuggestionType:x[i.state.familyType],mode:o.Mode.share})}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===o.PrincipalType.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0}var u=!y.Killswitch.isActivated("6a4e06ce-21cb-40a0-b7f2-53ea3d93c1f2","04/02/2020","Calling resolve API for unvalidated external users in share dialog")&&b.isUnvalidatedEmailAddress(e);return!e.isResolved||u?i._peoplePickerProvider.resolve(e.userId,n).then(function(t){!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails);4===e.entityType&&(t.entityType=e.entityType);return t}):e};i._onRenderItem=function(e){var t=i.props.permissionsMap,r=i._computeAllowExternalUsers(i.props.sharingLinkKind,i.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!r||1===i.props.sharingLinkKind&&t&&(void 0!==t[e.item.email]&&1===t[e.item.email]||void 0!==t[e.item.userId]&&1===t[e.item.userId])||!e.item.isResolved&&!e.item.isResolving,a=e.item.name;e.removeButtonAriaLabel=l.format(f.default.removePersonLabel,a);e.item.imageAlt=l.format(f.default.userPhotoAriaLabel,a);return o?u.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},u.createElement(s.SelectedItemDefault,n.__assign({},e))):e.item.isResolving?u.createElement(p.Spinner,{className:"od-Share-PeoplePicker-resolve-spinner"}):u.createElement(s.SelectedItemDefault,n.__assign({},e))};i._onToggleGetMoreResults=function(e){i.state&&(e&&!i.state.searchForMoreText||!e&&i.state.searchForMoreText)&&i.setState({searchForMoreText:i._getSearchForMoreText(e)})};i._peoplePickerProvider=r.peoplePickerProvider;i._resize=r.resize;i._platformDetection=r.platformDetection;i._hasTakenErrorFocus=!1;i._store=r.sharingStore;i.state={selectedItems:t.defaultSelectedItems,searchForMoreText:i._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:x.None,familyResolveEventFired:!1};E.genericResizeTracker()&&(i._resizeTracker=new w.ResizeTracker(r.resize));return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,r=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&r.push(n[0].name)});this.setState({selectedItems:t,addedUsers:r})};t.prototype.componentDidUpdate=function(e,t){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var n=t.addedUsers,r=this.state.addedUsers,i=this.state.removedUsers;this._resizeTracker?this._resizeTracker.checkSizeChange(this._peoplePicker):null!==this.props.error&&null===e.error&&this._resize();if(n.length>r.length){i=n.filter(function(e){return-1===r.indexOf(e)});this.setState({removedUsers:i})}else n.length!==r.length&&i.length>0&&this.setState({removedUsers:[]})};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;!this._peoplePickerControl||c.isMobile(this.props.clientId)||e||this._peoplePickerControl.focusInput()};t.prototype.render=function(){var e=this,t={placeholder:this._computePlaceholderText(),onFocus:function(t){e._onFocus()},"aria-label":this._computeAddAnotherAriaLabel()},n=this.props.pickerSettings,r={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!y.Killswitch.isActivated("ecb0e267-7a2f-499b-b0bd-1cb4e6476c62","07/01/2020","Use substrate in people search.")&&n.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:!!this.props.sharingInformation.enforceIBSegmentFiltering,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:d.default.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs},i=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker",o=c.isMobile(this.props.clientId)||this._platformDetection.isMobile,a={preventDismissOnScroll:o,preventDismissOnResize:!0},l=o?f.default.fabricPickerSuggestionsAvailableMobile:f.default.fabricPickerSuggestionsAvailable;return u.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",className:"od-Share-PeoplePicker-wrapper",role:"presentation",ref:function(t){e._peoplePicker=t}},S.renderScreenReaderOnlyAlert(this._computePeopleAddOrRemoveMessage(),"assertive","alert"),u.createElement(s.PeoplePicker,{componentRef:this._resolveRef("_peoplePickerControl"),className:i,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:t,loadingText:f.default.loadingLabel,noResultsFoundText:f.default.noResultsLabel,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:r,suggestionsClassName:"od-Share-PeoplePicker-Suggestions"+(this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""),onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:l,enableSelectedSuggestionAlert:this._platformDetection.isIE,role:"presentation",pickerCalloutProps:a}),this._renderError(),this._renderWarnings())};t.prototype._onResolvedSuggestions=function(e,t){if(g.default.isFeatureEnabled({ODC:"FamilySharing"})&&c.supportsFamily(this.props.clientId)){var n=this._store.getFamily(),r=this._store.getFamilyMembers();if(n&&t.length>1){var i=0===f.default.family.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),s=!1,u=x.None;if(i){u=x.Family;s=!0;e=[n].concat(r,e)}else{e.forEach(function(t,i){r.forEach(function(r){if(!s&&t.userId===r.userId||t.email===r.email){e.splice(i+1,0,n);s=!0}})});s&&(u=x.FamilyMember)}this.setState({familyType:u});if(s&&!this.state.familyResolveEventFired){this.setState({familyResolveEventFired:!0});this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:o.Mode.share,familySuggestionType:x[u]})}}}var a=[],l=[this._store.getCurrentUserId()],h=[];e.forEach(function(e){if(-1===l.indexOf(e.userId)&&-1===a.indexOf(e.email)){h.push(e);e.userId&&l.push(e.userId);e.email&&a.push(e.email)}});try{return this.props.onResolvedSuggestions(h)}catch(e){return h}};t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}};t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email?e.email:"",imageInitials:"",imageAlt:e.imageAlt};return u.createElement("div",{className:"ms-PeoplePicker-personaContent"},u.createElement(v.Persona,n.__assign({},t,{presence:v.PersonaPresence.none,size:v.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&u.createElement(m.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.prototype._onAutoResolve=function(e){var t=this,r=this.props.pickerSettings,i={principalSource:r.PrincipalSource,principalType:this._convertPrincipalType(r.PrincipalAccountType),querySettings:r.QuerySettings,allowEmailAddresses:r.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails);!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var r=[];t.state.selectedItems.forEach(function(t){t.email===e.email?r.push(n):r.push(t)});t.setState({selectedItems:r},function(){t.props.onChange(r)})}).catch(function(){var r=n.__assign(n.__assign({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(r):i.push(t)});t.setState({selectedItems:i},function(){t.props.onChange(i)})})};t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++){if(t[e].isResolving)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?f.default.peoplePickerPlaceholder:f.default.peoplePickerPlaceholderWithSelection};t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,r=[];t.length>0&&(r=r.concat(t.map(function(e){return l.format(f.default.peoplePickerPersonAddedAlert,e)})));n.length>0&&(r=r.concat(n.map(function(e){return l.format(f.default.peoplePickerPersonRemovedAlert,e)})));return r.length>0?r.toString():""};t.prototype._convertPrincipalType=function(e){if(!e)return o.PrincipalType.none;for(var t=o.PrincipalType.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=o.PrincipalType.user);"DL"===i&&(t|=o.PrincipalType.distributionList);"SecGroup"===i&&(t|=o.PrincipalType.securityGroup);"SPGroup"===i&&(t|=o.PrincipalType.sharePointGroup)}return t};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isResolveInProgress()){if(this._peoplePickerControl&&!c.isMobile(this.props.clientId)&&!this._hasTakenErrorFocus){this._peoplePickerControl.focusInput();this._hasTakenErrorFocus=!0}return u.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){this.state.selectedItems.length===this.props.selectionLimit&&n.push(u.createElement(i.MessageBar,{ariaLabel:f.default.peoplePickerLimitMessage},f.default.peoplePickerLimitMessage));e&&n.push(u.createElement(i.MessageBar,{ariaLabel:e},e));t&&n.push(u.createElement(i.MessageBar,{ariaLabel:t},t));return n.length>0?u.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype._getSearchForMoreText=function(e){return e?f.default.searchForMoreText:void 0};t.prototype._onFocus=function(){h.peoplePickerFocused()};t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?f.default.selectedItemListLabel:f.default.selectedItemAddAnotherAriaLabel};t.contextTypes={peoplePickerProvider:a.object.isRequired,resize:a.func.isRequired,platformDetection:a.object.isRequired,sharingStore:a.object.isRequired};return t})(r.BaseComponent);t.default=T});
define("@ms/odsp-shared-react/lib/PeoplePicker",["require","exports","tslib","./components/PeoplePicker/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/index",["require","exports","tslib","./PeoplePicker","./PeoplePicker.Props","./PeoplePickerDefaultItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePicker","@ms/shared-react-people-picker/lib/PeoplePicker"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.PeoplePicker});
define("@ms/shared-react-people-picker/lib/PeoplePicker",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Pickers","@ms/odsp-datasources/lib/PeoplePicker","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","./PeoplePickerDefaultItems","./PeoplePicker.Props","./PeoplePicker.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.BasePicker,h=s.BasePickerListBelow,p=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onResolveSuggestions=function(e){if(r._peoplePickerSearchPromise){r._peoplePickerSearchPromise.cancel();r._peoplePickerSearchPromise=void 0}if((e=e.trim()).length<2)return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions([],e):[];var t=r._dataProvider.search(e.trim(),r._getPeoplePickerQueryParams());if(!t)return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions([],e):[];var n=t.cached?t.cached:[];r._peoplePickerSearchPromise=t.promise;return r._peoplePickerSearchPromise.then(function(e){r._peoplePickerSearchPromise=void 0;return e?n.concat(e):[]}).then(function(t){return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions(t,e):t})};r._onGetMoreResults=function(e){var t;if(r.props.peoplePickerQueryParams){(t=n.__assign({},r.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return r._dataProvider&&r._dataProvider.sharePointSearch&&t?r._dataProvider.sharePointSearch(e,t):[]};if(t.dataProvider)r._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");r._dataProvider=new o.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource})}r._handleGetMoreResultsInBaseClass=!!(r._dataProvider.canUseGraph&&r.props.peoplePickerQueryParams&&r._dataProvider.canUseGraph(r.props.peoplePickerQueryParams))&&!r.props.onGetMoreResults;r.state={hasUnresolvedText:!1,searchForMoreText:r._getSearchForMoreText(r._handleGetMoreResultsInBaseClass)};return r}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.props,t=e.className,i=e.onRenderItem,s=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,u=e.onSelectedPersonasChange,l=e.suggestionsHeaderText,p=e.suggestionsClassName,d=e.noResultsFoundText,v=e.loadingText,m=e.inputProps,g=e.onSuggestionSelected,y=e.suggestionsAvailableAlertText,b=e.enableSelectedSuggestionAlert,w=e.selectedItems,E=e.itemLimit,S=e.onInputChange,x=e.onGetMoreResults,T=e.searchForMoreText,N=e.pickerCalloutProps,C={className:t,onRenderSuggestionsItem:s||a.SuggestionItemDefault,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:w,onChange:u,inputProps:m,enableSelectedSuggestionAlert:b,pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:v,noResultsFoundText:d,className:p,suggestionsAvailableAlertText:y,searchForMoreText:T||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0)},onItemSelected:g,itemLimit:E,onInputChange:S,onGetMoreResults:x||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:N};switch(this.props.peoplePickerType){case f.PeoplePickerType.listBelow:C.onRenderItem=i||a.SelectedItemBelowDefault;return r.createElement(h,n.__assign({},C,{componentRef:this._resolveRef("_peoplePicker")}));default:C.onRenderItem=i||a.SelectedItemDefault;return r.createElement(c,n.__assign({},C,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:u.default.user|u.default.securityGroup|u.default.sharePointGroup}};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?l.default.searchForMoreText:void 0};return t})(i.BaseComponent);t.PeoplePicker=p;t.default=p});
define("@ms/shared-react-people-picker/lib/PeoplePickerDefaultItems",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","@ms/odsp-utilities/lib/killswitch/Killswitch","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/string/StringHelper","ODCExecutors_css","./PeoplePicker.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";l=l.PickerItem_1;Object.defineProperty(t,"__esModule",{value:!0});var h={details:{paddingLeft:4,paddingRight:0}},p={icon:{fontSize:12,marginRight:0}};function d(e){return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt}}t.SuggestionItemDefault=function(e){var t=d(e);return r.createElement("div",{className:"ms-PeoplePicker-personaContent"},r.createElement(i.Persona,n.__assign({},t,{presence:i.PersonaPresence.none,size:i.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&r.createElement(u.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.SelectedItemDefault=function(e){var t=e.item,s=e.onRemoveItem,u=e.index,f=e.selected,c=e.removeButtonAriaLabel,h=d(t);return r.createElement("div",{className:a.css("ms-PickerPersona-container",{"is-selected":!!f}),"data-is-focusable":!0,"data-selection-index":u,key:u,role:"listitem"},r.createElement("div",{className:a.css("ms-PickerItem-content",!v()&&l.itemContent)},r.createElement(i.Persona,n.__assign({},h,{presence:i.PersonaPresence.none,size:i.PersonaSize.extraSmall}))),r.createElement(o.IconButton,{onClick:s,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:c}))};t.SelectedItemBelowDefault=function(e){var t=e.item,s=e.onRemoveItem,u=e.index,h=e.selected,p=d(t),m="PickerPersonaId"+Math.floor(1e4*Math.random()),g=f.format(c.default.removeButtonDefaultArialLabel,t.name);return r.createElement("div",{className:a.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!h}),"data-is-focusable":!0,"data-selection-index":u,key:u,"aria-labelledby":m},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({id:m},p,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}))),r.createElement("div",{className:a.css("ms-PickerItem-content",!v()&&l.itemContent)},r.createElement(o.IconButton,{onClick:s,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:g})))};t.SelectedItemBelowCustomMenu=function(e,t){var s=e.item,u=e.onRemoveItem,f=e.index,l=e.selected,c=d(s);return r.createElement("div",{className:a.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!l}),"data-is-focusable":!0,"data-selection-index":f,key:f},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({},c,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}),t||null)),r.createElement("div",{className:"ms-PickerItem-sideContent"},r.createElement(o.IconButton,{onClick:u,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))};t.SelectedItemWithPills=function(e){var t=e.item,s=e.onRemoveItem,u=e.index,a=t.email?"/_layouts/15/userphoto.aspx?accountname="+t.email:"",d={text:t.name||"",imageUrl:t.image||a},v="PickerPersonaId"+Math.floor(1e4*Math.random()),m=f.format(c.default.removeButtonDefaultArialLabel,t.name);return r.createElement("div",{className:l.peoplePickerPill,"data-is-focusable":!1,"data-selection-index":u,key:u,"aria-labelledby":v},r.createElement(i.Persona,n.__assign({id:v},d,{presence:i.PersonaPresence.none,size:i.PersonaSize.size24,styles:h})),r.createElement(o.IconButton,{onClick:s,iconProps:{iconName:"Cancel"},className:l.peoplePickerClose,"data-is-focusable":!0,ariaLabel:m,styles:p}))};function v(){return s.Killswitch.isActivated("d25aeb74-d40d-430c-a8fd-7a5f3706ba44","2020/03/06","FixPickerItemContentStyle")}});
define("@ms/shared-react-people-picker/lib/PeoplePicker.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"})(t.PeoplePickerType||(t.PeoplePickerType={}))});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker.Props",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePicker.Props"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePickerDefaultItems",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePickerDefaultItems"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-sharing/lib/utilities/ShareCommunicationManager",["require","exports","tslib","../interfaces/SharingInterfaces","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/ShareHelper","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=!1;t.copyLinkShareTargetClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")};t.dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};t.shareCompleted=function(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}};t.teamsClicked=function(e,t,n){var r=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,r,n)}catch(i){var s={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:r,body:n};window.parent.postMessage(JSON.stringify(s),"*")}};t.grantAccessCompleted=function(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}};t.pageError=function(e,t,n,r,i){a(e,t,n,r,i.errorMessage||"unknown error");try{window.external.PageError(i.error,i.errorCategory,i.errorMessage,i.debugErrorMessage)}catch(e){var s={name:"share_error",error:i.error,errorCategory:i.errorCategory,errorMessage:i.errorMessage,debugErrorMessage:i.debugErrorMessage};window.parent.postMessage(JSON.stringify(s),"*")}};t.outlookClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")};function a(e,t,n,s,o){if(e){new i.default({name:"ShareV3."+r.Mode[n]+"."+(r.ClientId[t]||"unknown")+".PageLoaded",startTimeOverride:e}).end({resultType:i.ResultTypeEnum.Success,extraData:{clientId:t,scenarioId:s,isError:!!o}})}}t.pageFinishedLoading=function(e,t,n,r){if(!u){a(e,t,n,r);try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*")}u=!0}};t.readyForRecipients=function(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")};t.sendLinkClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")};t.peoplePickerFocused=function(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}};t.linkSettingsCompleted=function(e,t,n,i){var o=s.getLinkIconUrl(i,e,n),u=s.getLinkLabel(e,t,i,n),a=s.getVroomScopeFromSharingLinkKind(e.sharingLinkKind),f=e.audience===r.SharingAudience.existing?"00000000-0000-0000-0000-000000000000":e.shareId,l=!1;try{(c=window.external).LinkSettingsCompleted(f,e.url,o,u,a);l=!0}catch(e){}try{var c=window.external,h=JSON.stringify({id:f,hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:a,customLabeledAudience:e.audience===r.SharingAudience.customLabeledSpecificPeople}});c.LinkSettingsCompletedV2(h);l=!0}catch(e){}if(!l){var p={name:"share_linkSettingsCompleted",shareId:f,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:a,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===r.SharingAudience.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(p),"*")}};t.isDarkMode=function(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e};t.invokeManageAccess=function(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")};t.askParentForAuthToken=function(e){return new o.default(function(t,r){var i=function(e){if(e.data&&"string"==typeof e.data){var n;try{n=JSON.parse(e.data)}catch(e){return}var s=!1;switch(n.name){case"share_newToken":s=!0;var o=n;if(o.error){r(o.error);break}if(!o.token){r("invalid_token");break}t(o.token)}s&&window.removeEventListener("message",i)}};window.addEventListener("message",i,!1);var s=n.__assign(n.__assign({},e),{name:"share_getToken"});window.parent.postMessage(JSON.stringify(s),"*")})}});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PreventDownload/PreventDownload",["require","exports","tslib","react","office-ui-fabric-react/lib/Toggle","office-ui-fabric-react/lib/Icon","../../Share.resx","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={preventDownloadToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled,f=!this.props.detailsPane&&this.props.disablePreventDownload,l=f?this.props.isRolesDropDown?a.format(o.default.preventDownloadInfoIconRoleDropDown,o.default.canViewRole):a.format(o.default.preventDownloadInfoIcon,o.default.allowEditLabel):o.default.preventDownloadLabel;this.props.detailsPane&&(t=!0);return r.createElement("div",{className:"od-PreventDownloadToggle"},r.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},r.createElement(s.Icon,n.__assign({iconName:"Blocked2"},{alt:o.default.imageAltPreventDownloadIcon}))),r.createElement(i.Toggle,{checked:t,disabled:e,"aria-disabled":e,label:o.default.preventDownloadLabel,ariaLabel:l,onChanged:this._onChanged,className:t?"isToggled":"",role:"checkbox"}),f&&r.createElement("div",{className:"od-PreventDownloadToggle--info"},r.createElement(u.TooltipHost,{hostClassName:"od-preventDownload-tooltip",content:l,directionalHint:u.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement("div",{tabIndex:0,className:"od-preventDownload-tooltipWrapper"},r.createElement("div",{className:"od-preventDownload-hidden"},l),r.createElement(s.Icon,{"aria-hidden":"true",iconName:"Info",className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:f.object.isRequired};return t})(r.Component);t.PreventDownload=l});
define("@ms/odsp-utilities/lib/previews/BlockDownloadSupport",["require","exports","./PolicyLevelsByExtension","./PolicyLevelsByExtensionB","../killswitch/Killswitch"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.None=0]="None";e[e.AllowMediaTA=1]="AllowMediaTA";e[e.OfficeOnly=2]="OfficeOnly"})(t.EnforcementLevel||(t.EnforcementLevel={}));t.isBlockDownloadSupported=function(e,t){if(!e)return!1;e=("."===e[0]?e.slice(1):e).toLowerCase();return i.Killswitch.isActivated("0A68E09A-581A-4BDB-BD4E-00CE6D935430","04/23/2020","Exclude Video Files from BlockDownloadSupported")?n.LEVEL_BY_EXTENSION[e]>=t:r.LEVEL_BY_EXTENSION_V1[e]>=t}});
define("@ms/odsp-utilities/lib/previews/PolicyLevelsByExtension",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LEVEL_BY_EXTENSION={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,"7z":1,"7zip":1,ai:1,ari:1,arw:1,asf:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heif:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,rar:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sevenzip:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1,zip:1}});
define("@ms/odsp-utilities/lib/previews/PolicyLevelsByExtensionB",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LEVEL_BY_EXTENSION_V1={"3fr":1,"3mf":1,ai:1,ari:1,arw:1,avci:1,avcs:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m4a:1,mat:1,mef:1,mos:1,mp3:1,mrw:1,msg:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webp:1,wma:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1}});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/OfficeReviewMode/OfficeReviewMode",["require","exports","tslib","react","office-ui-fabric-react/lib/Toggle","office-ui-fabric-react/lib/Icon","../../Share.resx","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={OfficeReviewModeToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disableOfficeReviewMode,t=this.props.isToggled,f=!this.props.detailsPane&&this.props.disableOfficeReviewMode,l=f?a.format(o.default.officeReviewModeInfoIcon,o.default.allowEditLabel):o.default.officeReviewModeLabel;return r.createElement("div",{className:"od-OfficeReviewModeToggle"},r.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode-Icon"},r.createElement(s.Icon,n.__assign({iconName:"Feedback"},{alt:o.default.imageAltOfficeReviewModeIcon}))),r.createElement(i.Toggle,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:r.createElement(r.Fragment,null,o.default.officeReviewModeLabel," ",!f&&r.createElement(u.TooltipHost,{content:r.createElement(r.Fragment,null,o.default.officeReviewModeHint," "," ",r.createElement("a",{className:"od-OfficeReviewModeToggle-learnMore","aria-label":o.default.learnMoreLabel+": "+o.default.officeReviewModeLabel,href:"https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07",target:"_blank"},o.default.learnMoreLabel))},r.createElement(s.Icon,{iconName:"Info","aria-label":o.default.officeReviewModeHint}))),ariaLabel:l,onChanged:this._onChanged}),f&&r.createElement("div",{className:"od-OfficeReviewModeToggle--info","aria-label":l},r.createElement(u.TooltipHost,{hostClassName:"od-OfficeReviewMode-tooltip",content:l,directionalHint:u.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement("div",{tabIndex:0,className:"od-OfficeReviewMode-tooltipWrapper"},r.createElement("div",{className:"od-OfficeReviewMode-hidden","aria-label":l},l),r.createElement(s.Icon,{"aria-hidden":"true",iconName:"Info",className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("OfficeReviewMode.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({OfficeReviewModeToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:f.object.isRequired};return t})(r.Component);t.OfficeReviewMode=l});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/LinkTemplateChoiceGroup",["require","exports","tslib","../../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/FocusZone","react","prop-types","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/ClientIdHelper","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","../../../data/Icons/FileShareIconMap","./InfoButton/InfoButton","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!f.isMobile(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=e.getAttribute("data-key");"true"===e.getAttribute("aria-disabled")||r._onRowClick(t,null)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}return null};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return s.createElement("div",{"aria-label":u.default.permissionsSettingsHeader,role:"radiogroup"},s.createElement(i.FocusZone,{direction:i.FocusZoneDirection.vertical,defaultActiveElement:".od-LinkTemplateChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};t.prototype._renderItem=function(e){var t=e.key,n=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===t,i=p.FileShareIconMap[e.permissionsType],o=e.iconUrl?s.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:e.iconUrl,alt:e.label}):s.createElement(c.Icon,{"aria-hidden":"true",iconName:i});return s.createElement("div",{key:t},s.createElement("button",{role:"radio","aria-checked":r,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:r,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+n,"data-key":t},s.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":r?a.format(u.default.audienceSelectedStatus,e.label):"",className:"od-Share-screenReaderOnly"},r?a.format(u.default.audienceSelectedStatus,e.label):""),s.createElement("div",{className:"od-LinkTemplateChoiceGroup-description"},s.createElement("div",{className:"od-ShareLinkDescription"},s.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+i,"aria-hidden":"true"},o),this._renderLabel(e))),s.createElement("div",{className:"tickIcon","aria-hidden":!0})),s.createElement("div",{className:"od-LinkTemplateChoiceGroup-bottomBorder"}))};t.prototype._renderLabel=function(e){var t=e.isDisabled&&e.disabledText?e.disabledText:"";t&&s.createElement(d.InfoButton,{message:t});return s.createElement("div",{className:"od-ShareHintDetail"},s.createElement("div",{className:"od-ShareHintDetail-description"},s.createElement("div",{className:"od-ShareHintDetail-status"},s.createElement("span",{className:"od-ShareHintDetail-statusText"},e.label),this._renderStatusIcons(e.link))))};t.prototype._renderStatusIcons=function(e){if(e){var t=e.expiration,n=e.hasPassword,i=e.blockDownload,o=[];t&&t.getTime()!==new Date(0).getTime()&&o.push({icon:"Calendar",tooltip:""+a.format(u.default.expiresIn2,l.getShortDisplayDate(t))});n&&o.push({icon:"Lock",tooltip:u.default.sharePasswordReminderText});i&&o.push({icon:"Blocked2",tooltip:u.default.preventDownloadHint});e.audience!==r.SharingAudience.existing&&e.isReview&&v.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]&&o.push({icon:"Feedback",tooltip:u.default.officeReviewModeHint});var f=o.map(function(e,t){return s.createElement("i",{className:"od-ShareHintDetail-item"},s.createElement(h.TooltipHost,{content:e.tooltip,id:e.icon},s.createElement(c.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return s.createElement("div",{className:"od-ShareHintDetail-iconsList"},f)}};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-LinkTemplateChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e});n.onChange(e);n.onLinkTemplateChange(e)};t.contextTypes={platformDetection:o.object.isRequired};return t})(s.Component);t.LinkTemplateChoiceGroup=m});
define("@ms/odsp-shared-sharing/lib/components/ShareNotification/ShareNotification",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","../ShareHint/ShareHint","office-ui-fabric-react/lib/TextField","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","../Share.resx","../../utilities/ClientIdHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowNameTooltip=function(){i.setState(n.__assign(n.__assign({},i.state),{isNameTooltipVisible:!0}))};i._onHideNameTooltip=function(){i.setState(n.__assign(n.__assign({},i.state),{isNameTooltipVisible:!1}))};i._copySharingLinkToClipboard=function(){return n.__awaiter(i,void 0,void 0,function(){var e=this;return n.__generator(this,function(t){l.copySharingLinkToClipboard(this.props.clientId,this._textField,this.props.linkUrl).then(function(t){e.setState(n.__assign(n.__assign({},e.state),{successfullyCopied:t}))});return[2]})})};i._onNotificationLabel=function(e){i._notificationLabel=e};i.state={successfullyCopied:!1,isNameTooltipVisible:!1};i._resize=r.resize;i._sharingStore=r.sharingStore;i._platformDetection=r.platformDetection;return i}t.prototype.componentDidMount=function(){var e=this,t=this._platformDetection,n=t.isEdge,r=t.isIE,s=this.props.shareType===i.ShareType.copy&&this.props.shouldCopyLinkToClipboard,o=r&&!v.mayUseEmbeddedIEWebView(this.props.clientId);s&&!o&&this._copySharingLinkToClipboard();(n||o)&&setTimeout(function(){e._textField.focus()},500)};t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=this._getNotificationLabel(!0),s=this._getNotificationAriaLabel(),a=this.props.shareType===i.ShareType.copy,f=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),l=this.props.shareType,v=l===i.ShareType.share||l===i.ShareType.moreApps||l===i.ShareType.copy&&this.state.successfullyCopied,m=v?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return f?u.createElement("div",{className:"od-ShareNotification"},u.createElement(r.Header,{viewState:4,clientId:this.props.clientId}),u.createElement("div",{className:"od-ShareNotification-content ms-font-su"},u.createElement(p.Icon,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon"}),u.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},d.default.accessRequestNotificationHeader),u.createElement("div",{className:"od-ShareNotification-accessRequestBody"},d.default.accessRequestNotificationBody))):u.createElement("div",{className:"od-ShareNotification "+m},u.createElement(r.Header,{viewState:4,clientId:this.props.clientId}),this._renderCheckMark(v),u.createElement("div",{className:"od-ShareNotification-content"},u.createElement("div",{className:"ms-font-l",ref:this._onNotificationLabel,onMouseOver:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip},t),this.state.isNameTooltipVisible&&t!==n&&u.createElement(h.Callout,{directionalHint:h.DirectionalHint.topCenter,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300},u.createElement("div",{className:"od-ShareNotification-content-tooltip"},n)),a&&this._renderCopyCta(),a&&u.createElement("div",{className:"od-ShareNotification-urlText"},u.createElement(o.TextField,{autoFocus:!0,"aria-live":"polite",ariaLabel:s,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",defaultValue:this.props.linkUrl,className:"od-ShareNotification-urlTextField"}),u.createElement(c.PrimaryButton,{className:"od-ShareNotification-copyButton",text:d.default.copyButtonLabel,onClick:this._copySharingLinkToClipboard}))),a&&this._renderShareHint())};t.prototype._renderCheckMark=function(e){if(e)return u.createElement("div",{className:"od-ShareNotification-icon"},u.createElement(p.Icon,{iconName:"CheckMark"}))};t.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===i.ShareType.copy&&!t.successfullyCopied)return u.createElement("span",{className:"od-ShareNotification-copyCta"},d.default.notificationCopyFailedCta)};t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?u.createElement("div",{className:"od-ShareNotification-footer"},u.createElement(s.ShareHint,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig})):null};t.prototype._getNotificationLabel=function(e){var t=d.default,n=e?this.props.itemName:l.truncateItemNameForShareNotification(this.props.itemName),r=this.props.shareType,s=n?f.format(t.notificationCopied,n):d.default.notificationCopiedLabel,o=n?f.format(t.notificationCopyFailed,n):d.default.notificationCopyFailedLabel,u=n?f.format(t.notificationSent,n):d.default.notificationSentLabel;return r===i.ShareType.copy?this.state.successfullyCopied?s:o:r===i.ShareType.share?u:r===i.ShareType.moreApps?o:""};t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===i.ShareType.copy?this.state.successfullyCopied?d.default.notificationCopiedLabel:d.default.notificationCopyFailedLabel:e===i.ShareType.share?d.default.notificationSentLabel:e===i.ShareType.moreApps?d.default.notificationCopyFailedLabel:""};t.contextTypes={resize:a.func.isRequired,sharingStore:a.object.isRequired,platformDetection:a.object.isRequired};return t})(u.Component);t.ShareNotification=m});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHint",["require","exports","tslib","./ShareHintDetail/ShareHintDetail","../ShareLinkDescription/ShareLinkDescription","../../interfaces/SharingInterfaces","react","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/locale/Locale","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Coachmark","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/common/DirectionalHint","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/ABExperiment","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b={ODB:1176},w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._targetButton=u.createRef();r._odShareHintchevron=u.createRef();r._onDismiss=function(){r.setState({isCoachmarkVisible:!1})};r._platformDetection=n.platformDetection;r._isOnExperiment=!1;if(m.default.isFeatureEnabled(b)){var i=new g.ABExperiment({name:"CoachMark",startDate:"08/2/2018",version:g.ABExpHash.v2});r._isOnExperiment=i.IsExperimentOn()}r.state={isCoachmarkVisible:r._isOnExperiment};return r}t.prototype.componentDidMount=function(){this._platformDetection.isIE&&this._targetButton.current&&this._targetButton.current.focus()};t.prototype.render=function(){var e,t,u=this.props,h=!!this.props.onShareHintClick,m="od-ShareHint "+(c.isLoadingData(u.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),g="od-ShareHint-data "+(h?"od-ShareHint--clickable":"")+" "+(u.useDarkBorder?"od-ShareHint-darkBorder":"");e=o.createElement("div",{className:"od-ShareHint-shimmer"},o.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},o.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},o.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),o.createElement("div",{className:"od-ShareHint-text-shimmer"}));if(u.isAddressBarLinkHint){var y=this.props.sharingInformation.addressBarLinkSettings,b=this.props.sharingInformation.sharingAbilities,w=4===(E=y.linkDisabled||!c.canManageAddressBarLink(b)?4:1)?l.default.permissionsExistingPeopleString:a.format(l.default.permissionsCompanyString,this.props.companyName);t=o.createElement("button",{className:g,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},o.createElement("div",{className:"od-ShareHint-iconHolder"},o.createElement(i.ShareLinkDescription,{label:w,permissionsType:E,showLabel:!1})),o.createElement(r.ShareHintDetail,{clientId:u.clientId,companyName:u.companyName,currentSettings:null,sharingInformation:u.sharingInformation,linkRecipients:u.linkRecipients,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:u.addressBarLink}),this._renderChevron(h))}else{var E=this._getFileShareTypeFromAudience(),S=(w=this._getLabelFromPermissionsType(E),this.props.currentSettings.audience===s.SharingAudience.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl);t=u.onShareHintClick?o.createElement("button",{className:g,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},o.createElement("div",{className:"od-ShareHint-iconHolder"},o.createElement(i.ShareLinkDescription,{label:w,permissionsType:E,iconUrl:S,showLabel:!1})),o.createElement(r.ShareHintDetail,{clientId:u.clientId,companyName:u.companyName,currentSettings:u.currentSettings,sharingInformation:u.sharingInformation,linkRecipients:u.linkRecipients,customLabeledAudienceConfig:u.customLabeledAudienceConfig}),this._renderChevron(h)):o.createElement("div",n.__assign({className:g},{autoFocus:!0}),o.createElement("div",{className:"od-ShareHint-iconHolder"},o.createElement(i.ShareLinkDescription,{label:w,permissionsType:E,iconUrl:S,showLabel:!1})),o.createElement(r.ShareHintDetail,{clientId:u.clientId,companyName:u.companyName,currentSettings:u.currentSettings,sharingInformation:u.sharingInformation,linkRecipients:u.linkRecipients,customLabeledAudienceConfig:u.customLabeledAudienceConfig}),this._renderChevron(h))}return o.createElement("div",{"aria-label":l.default.modifyPermissionsHeader,className:m},t,e,this.state.isCoachmarkVisible&&o.createElement(p.Coachmark,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:f.default.isRightToLeft?v.DirectionalHint.bottomLeftEdge:v.DirectionalHint.bottomRightEdge}},o.createElement(d.TeachingBubbleContent,{calloutProps:{directionalHint:f.default.isRightToLeft?v.DirectionalHint.bottomLeftEdge:v.DirectionalHint.bottomRightEdge,gapSpace:0},headline:l.default.modifyPermissionsHeader,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:l.default.closeButtonLabel,onDismiss:this._onDismiss},l.default.linkSettingsExplanation1,o.createElement("br",null),l.default.linkSettingsExplanation2)))};t.prototype._renderChevron=function(e){if(e)return o.createElement("div",{ref:this._odShareHintchevron},o.createElement(h.Icon,{iconName:f.default.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron"}))};t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===s.SharingAudience.anyone?0:e===s.SharingAudience.organization?1:e===s.SharingAudience.existing?4:e===s.SharingAudience.customLabeledSpecificPeople?5:2};t.prototype._getLabelFromPermissionsType=function(e){var t=l.default;return 0===e?t.permissionsAnyoneString:1===e?a.format(t.permissionsCompanyString,this.props.companyName):4===e?t.permissionsExistingPeopleString:2===e?t.permissionsSpecificPeopleString:void 0};t.contextTypes={platformDetection:y.object.isRequired};return t})(o.Component);t.ShareHint=w});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHintDetail/ShareHintDetail",["require","exports","tslib","office-ui-fabric-react/lib/Icon","../../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/Tooltip","react","@ms/odsp-utilities/lib/string/StringHelper","../../Share.resx","@ms/odsp-utilities/lib/dateTime/DateTime","../../../utilities/ShareHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._renderStatusIcons=r._renderStatusIcons.bind(r);return r}t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return o.createElement("div",{className:"od-ShareHintDetail"},o.createElement("div",{className:"od-ShareHintDetail-description"},o.createElement("div",{className:"od-ShareHintDetail-status"},o.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,l=[];e&&e.getTime()!==new Date(0).getTime()&&l.push({icon:"Calendar",tooltip:""+u.format(a.default.expiresIn2,f.getShortDisplayDate(e))});t&&l.push({icon:"Lock",tooltip:a.default.sharePasswordReminderText});n&&l.push({icon:"Blocked2",tooltip:a.default.preventDownloadHint});this.props.currentSettings.audience!==i.SharingAudience.existing&&this.props.currentSettings.isReview&&c.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]&&l.push({icon:"Feedback",tooltip:a.default.officeReviewModeHint});var h=l.map(function(e,t){return o.createElement("i",{className:"od-ShareHintDetail-item"},o.createElement(s.TooltipHost,{content:e.tooltip,id:e.icon},o.createElement(r.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return o.createElement("div",{className:"od-ShareHintDetail-iconsList"},h)}};t.prototype._getLabel=function(e){var t=a.default,n=this.props.companyName,r=this.props.sharingInformation.addressBarLinkSettings,s=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&r)return r.linkDisabled||!l.canManageAddressBarLink(s)?t.permissionsExistingPeopleString:u.format(t.cslViewDescription,n);if(!e)return"";if(e.preventDownload){if(e.audience===i.SharingAudience.anyone)return t.anonymousViewOnlyHint;if(e.audience===i.SharingAudience.organization)return u.format(t.cslViewOnlyHint,n);if(e.audience===i.SharingAudience.specificPeopleFlex)return t.specificPeopleViewOnlyHint}switch(e.sharingLinkKind){case 1:return e.audience===i.SharingAudience.specificPeople?this.props.sharingInformation.requiresAccessApproval?a.default.requestAccessDescription:e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?c.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]?a.default.specificPeopleOfficeReviewHint:a.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:t.existingPeopleDescription;case 2:return u.format(t.cslViewDescription,n);case 3:return u.format(t.cslEditDescription,n);case 4:return t.anonViewDescription;case 5:return t.anonEditDescription;case 6:return e.audience===i.SharingAudience.existing?t.existingPeopleDescription:e.audience===i.SharingAudience.specificPeopleFlex?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?c.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]?a.default.specificPeopleOfficeReviewHint:a.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:e.audience===i.SharingAudience.customLabeledSpecificPeople?6===e.sharingRole?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledReviewLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledEditLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledViewLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===i.SharingAudience.organization?6===e.sharingRole?c.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]?u.format(t.cslOfficeReviewDescription,n):u.format(t.cslReviewDescription,n):e.isEdit?u.format(t.cslEditDescription,n):u.format(t.cslViewDescription,n):e.audience===i.SharingAudience.anyone?6===e.sharingRole?c.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]?a.default.anonOfficeReviewDescription:a.default.anonReviewDescription:e.isEdit?a.default.anonEditDescription:a.default.anonViewDescription:"";default:return""}};return t})(o.Component);t.ShareHintDetail=h});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/PermissionsList",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","./ShareLink/ShareLink","./SharePrincipal/SharePrincipal","./SharePrincipal/SharePrincipal2","../ShareHint/ShareHint","../Share/Share","../../utilities/ClientIdHelper","react","../Share.resx","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/FocusZone","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/MessageBar","prop-types","@ms/odsp-utilities/lib/icons/ItemType","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/FocusTrapZone","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/Features","../../utilities/ShareHelper","../../utilities/UiUtils","@ms/odsp-datasources/lib/interfaces/sharing/enums/SPSharedObjectType","../../utilities/FileExtensionHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _={ODB:1466},D=(function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t)||this;s._focusAnchorRef=c.createRef();s._showPermissionsList=function(){s.setState({showLinkDetails:!1,showAddressBarLinkDetails:!1})};s._onRemoveLink=function(){s.setState({linkRemovedText:h.default.linkRemovedText});setTimeout(function(){s.setState({linkRemovedText:""})},3e3)};s._onLinkSelected=function(e){s.setState({currentSharingLink:e,showLinkDetails:!0})};s._onShareClick=function(e){s._targetElement=e.target;s._mode=i.Mode.share;s.setState({showShare:!0})};s._onGrantAccessClick=function(e){s._targetElement=e.target;s._mode=i.Mode.addPeople;s.setState({showGrantAccess:!0})};s._onDismiss=function(){s._mode===i.Mode.share?s.setState({showShare:!1}):s.setState({showGrantAccess:!1})};s._onAddressBarLinkClicked=function(){s.setState(function(){return n.__assign(n.__assign({},s.state),{showAddressBarLinkDetails:!0})})};s._shareClickTime=r.shareClickTime;s._sharingStore=r.sharingStore;s._resize=r.resize;s._mode=s.props.mode;s._addressBarLink=null;s.state={showLinkDetails:!1,showAddressBarLinkDetails:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1,selectedKey:i.SharingAudience.existing};s._isShareCommandsExperimentOn=l.isODSP(s.props.clientId)&&s.props.shareCommandsExperiment;s._isLinkSettingsEditPanelEnabled=s._sharingStore.showManageAccess()&&(s.props.mode===i.Mode.manageAccess||s.props.mode===i.Mode.share||s.props.mode===i.Mode.addPeople);if(k.default.isFeatureEnabled(_)){var o=s.props.sharingInformation.sharingLinks?s.props.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink}):[];o.length>0&&(s._addressBarLink=o[0])}s._hasBackButton=s.props.mode!==i.Mode.manageAccess;return s}t.prototype.componentDidMount=function(){if(this._focusAnchorRef&&this._focusAnchorRef.current){this._focusAnchorRef.current.focus();this._focusAnchorRef.current.blur()}g.pageFinishedLoading(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId)};t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails);C.Killswitch.isActivated("0c40b3c2-4638-4643-8284-44108486c2d8","09/26/2019","Resize manage access")||this._resize()};t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}};t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;e=t.hasPermissionsInformation?t.isShared?t.sharedObjectType===O.SPSharedObjectType.list?c.createElement("div",{className:"od-PermissionsList-content"},c.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n))):c.createElement("div",{className:"od-PermissionsList-content"},c.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),c.createElement("div",{className:"od-PermissionsList-addressbar"},this._renderAddressBarAccess()," "),c.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n))):c.createElement("div",null,h.default.notShared):c.createElement("div",{className:"od-Share-spinnerHolder"},c.createElement(p.Spinner,{className:"od-Share-spinner",label:h.default.componentLoading,type:p.SpinnerType.large}));var r=t.hasInheritedLinks,i=!l.isODSP(this.props.clientId)&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails;return c.createElement("div",{tabIndex:-1,ref:this._focusAnchorRef,className:"od-PermissionsList"},A.renderScreenReaderOnlyAlert(h.default.manageExistingAccessLabel,"assertive","alert"),i&&this._renderHeader(),r&&this._renderInheritance(n),this.state.showLinkDetails||this.state.showAddressBarLinkDetails?this._renderLinkDetails():e)};t.prototype._renderHeader=function(){return c.createElement("div",{className:"od-PermissionsList-header"},this._hasBackButton&&A.renderWithToolTip(c.createElement(b.IconButton,{className:"od-Share-backButton",id:"od-PermissionsList-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:h.default.backButtonLabel}),h.default.backButtonLabel,{position:v.DirectionalHint.bottomLeftEdge,targetElementId:"od-PermissionsList-backButton"}),c.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:3,"data-is-focusable":!0,mode:this.props.mode,hasBackButton:this._hasBackButton}))};t.prototype._renderInheritance=function(e){var t,n;this.props.sharingInformation.item.itemType===S.default.Folder?n=h.default.inheritedLinksFolder:this.props.sharingInformation.item&&(n=h.default.inheritedLinksFile);t=e?x.format(h.default.activeAndInheritedLinks,n):x.format(h.default.onlyInheritedLinks,n);return c.createElement("div",{className:"od-PermissionsList-inheritance"},c.createElement(w.MessageBar,null,t))};t.prototype._renderLinkDetails=function(){if(this.state.showAddressBarLinkDetails){var e=this.props.sharingInformation.addressBarLinkSettings;return c.createElement(s.ShareLink,{companyName:this.props.companyName,link:this._addressBarLink,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,showPermissionsList:this._showPermissionsList,enableLinkSettings:!0,isAddressBarLink:!0,addressBarLinkSettings:e})}return c.createElement(s.ShareLink,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink})};t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return c.createElement("div",{className:"od-PermissionsList-linksListHolder","aria-label":h.default.linksListHeaderTooltip},this._isLinkSettingsEditPanelEnabled&&c.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},c.createElement(d.Icon,{iconName:"Link",ariaLabel:h.default.linksListHeader,className:"ms-Icon ms-Icon--Link"}),h.default.linksListHeader,A.renderWithToolTip(c.createElement("span",{tabIndex:0},c.createElement(d.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-labelledby":"od-ShareLinkDetails-tooltip-links"})),h.default.linksListHeaderTooltip,{tooltipId:"od-ShareLinkDetails-tooltip-links",position:v.DirectionalHint.bottomCenter}),this._isShareCommandsExperimentOn&&c.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},c.createElement(b.CommandBarButton,{iconProps:{iconName:"Share"},"aria-label":h.default.share,onClick:this._onShareClick,"aria-haspopup":!0},c.createElement("span",null,h.default.share)),this.state.showShare&&this._renderShare())),c.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,r){if(t.audience!==i.SharingAudience.specificPeople&&t.isActive&&!t.isAddressBarLink){n=!0;return c.createElement("li",{key:t.shareId,role:"presentation"},c.createElement(s.ShareLink,{key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList}))}}),this._isLinkSettingsEditPanelEnabled&&c.createElement("div",null,A.renderScreenReaderOnlyAlert(n?"":h.default.noLinksGivingAccess,"polite"),A.renderScreenReaderOnlyAlert(this.state.linkRemovedText,"assertive","alert")),!n&&this._renderNoSharingLinks()))};t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return c.createElement("div",{className:"od-PermissionsList-emptyLinks"},h.default.noLinksGivingAccess)};t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,r=n.sharingPrincipals.slice();return this._isLinkSettingsEditPanelEnabled?c.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&c.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},c.createElement(d.Icon,{iconName:"PlayerSettings",ariaLabel:h.default.principalsListHeader,className:"ms-Icon ms-Icon--PlayerSettings"}),h.default.principalsListHeader,A.renderWithToolTip(c.createElement("span",{tabIndex:0},c.createElement(d.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-labelledby":"od-ShareLinkDetails-tooltip-principals"})),h.default.principalsListHeaderTooltip,{tooltipId:"od-ShareLinkDetails-tooltip-principals"}),this._isShareCommandsExperimentOn&&c.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},A.renderWithToolTip(c.createElement(b.IconButton,{iconProps:{iconName:"Add"},"aria-label":h.default.addPeopleLabel,onClick:this._onGrantAccessClick,"aria-haspopup":!0}),h.default.addPeopleLabel),this.state.showGrantAccess&&this._renderShare())),c.createElement("ul",{className:"od-PermissionsList-entities","aria-label":h.default.permissionsListPrincipalsAriaLabel},c.createElement(m.FocusZone,{direction:m.FocusZoneDirection.vertical,isInnerZoneKeystroke:function(e){return e.which===y.getRTLSafeKeyCode(y.KeyCodes.right)}},r.map(function(e,r){return c.createElement("li",{key:e.id},c.createElement(u.SharePrincipal2,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))})))):c.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":h.default.permissionsListPrincipalsAriaLabel},r.map(function(r,i){return c.createElement("li",{key:r.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},c.createElement(o.SharePrincipal,{principal:r,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))}))};t.prototype._renderShare=function(){return c.createElement(T.Callout,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:v.DirectionalHint.bottomCenter,onDismiss:this._onDismiss},c.createElement(N.FocusTrapZone,{isClickableOutsideFocusTrap:!0},c.createElement(f.Share,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId,maxWidth:340})))};t.prototype._renderAddressBarAccess=function(){if(k.default.isFeatureEnabled(_)){var e=this.props.sharingInformation.addressBarLinkSettings,t=M.getCategoryFromExtension(this.props.sharingInformation.fileExtension),n="word"===t||"excel"===t||"powerpoint"===t;if(!!e&&(0!==e.linkPermission&&n||!!this._addressBarLink))return c.createElement("div",{className:"od-PermissionsList-addressBarAccess","aria-label":h.default.addressBarLinkDescription},c.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},h.default.addressBarAccess),c.createElement("div",{className:"od-PermissionsList-addressBarDescription"},h.default.addressBarLinkDescription),c.createElement("div",{className:"od-AddressBarLinkHint"},c.createElement(a.ShareHint,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:null,onShareHintClick:this._onAddressBarLinkClicked,sharingInformation:this.props.sharingInformation,linkRecipients:this.state.currentSharingLink?L.getLinkParticipants(this.state.currentSharingLink):[],customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:this._addressBarLink})))}};t.contextTypes={shareClickTime:E.number,sharingStore:E.object.isRequired,resize:E.func.isRequired};t.childContextTypes={onDismiss:E.func};return t})(c.Component);t.PermissionsList=D});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ShareLink",["require","exports","tslib","react","prop-types","../../Share.resx","../../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","./LinkMember/LinkMember","../../../utilities/ShareHelper","../ShareLinkParticipants/ShareLinkParticipants","office-ui-fabric-react/lib/Facepile","../ShareLinkDetails/ShareLinkDetails","office-ui-fabric-react/lib/Persona","../ShareLink/ConfirmationDialog/ConfirmationDialog","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/FocusZone","@ms/odsp-utilities/lib/killswitch/Killswitch","../../../utilities/SharingAbilitiesHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../../utilities/UiUtils","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onOptionChange=function(e){i.setState(function(){return n.__assign(n.__assign({},i.state),{hasSettingsChange:!0})})};i._onChevronClick=function(){i.setState({linkMemberExpanded:!i.state.linkMemberExpanded})};i._onCancel=function(){i.setState(function(){return n.__assign(n.__assign({},i.state),{showConfirmationDialog:!1,participants:i._link?c.getLinkParticipants(i._link):[],expirationErrorCode:c.ExpirationErrorCode.none,selectedPermissions:i._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})});i.state.hasSettingsChange||i.state.hasPeopleChange||i._showPermissionsList()};i._showPermissionsList=function(){i.setState(function(){return n.__assign(n.__assign({},i.state),{hasSettingsChange:!1,hasPeopleChange:!1,addressBarDetailsView:!1})});var e=i.props.showPermissionsList;e&&e()};i._onConfirmationDeleteLink=function(){if(i.state.confirmationCode===m.ConfirmationCode.link){i._onShareLinkDelete();i.setState({showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none,hasSettingsChange:!1,linkDetailsView:!1})}i._showPermissionsList()};i._showLinkDetails=function(){var e=i.props.onShowLinkDetailsClicked;e&&e(i._link)};i._onShareLinkDelete=function(){var e=i._link;i.props.onRemoveLink&&i.props.onRemoveLink();i._store.unshareLink(e.sharingLinkKind,e.shareId)};i._onLinkClicked=function(e){try{var t=e.target;t.focus();t.setSelectionRange(0,t.value.length)}catch(e){}};i._copySharingLinkToClipboard=function(){var e=i.props.clientId,t=i._link.url,n=i._textField;c.copySharingLinkToClipboard(e,n,t).then(function(e){i.setState({copyLinkToClipboardSuccess:e,copyLinkAlert:s.default.notificationCopiedLabel});i._copyButton.focus();e&&setTimeout(function(){i.setState({copyLinkToClipboardSuccess:!1,copyLinkAlert:""})},2e3)})};i._updateLinkSettings=function(e){var t=[],r=[],u=i.state.participants;if(e){var a=i._link.invitees.filter(function(t){return!E.Killswitch.isActivated("ef5f3998-f6a0-48b0-8847-931de0af354e","01/09/2020","bug fix for removing user on link")&&e.principalName&&t.loginName===e.principalName||t.email===e.email?t:void 0});if(a.length>0){t.push(n.__assign(n.__assign({},a[0]),{type:a[0].type}));i.setState({participantRemovedText:g.format(s.default.removedPersonText,a[0].primaryText)});i._chevronButton&&i._chevronButton.focus()}}else{for(var f=function(e){0===(!0===e.isExternal?u.filter(function(t){return t.email===e.email}):u.filter(function(t){return t.userId===e.loginName})).length&&t.push(e)},l=0,h=i._link.invitees;l<h.length;l++){f(h[l])}for(var p=function(e){if(!0===e.isExternal&&i.state.selectedPermissions.audience===o.SharingAudience.organization)return"continue";0===(!0===e.isExternal?i._link.invitees.filter(function(t){return t.email===e.email}):i._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&r.push(e)},d=0,v=u;d<v.length;d++){p(v[d])}}if(t.length>0||r.length>0||i.state.hasSettingsChange){i._store.shareLink({settings:i.state.selectedPermissions,recipients:r,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:i._link.shareId,inviteesToRemove:t});i._store.addListener(function(){i.setState(function(){var e=i._store.getSharingInformation().sharingLinks.filter(function(e){return e.shareId===i._link.shareId});if(e&&e.length>0){i._link=e[0];return{link:i._link,participants:6===i._link.sharingLinkKind?c.getLinkParticipants(i._link):[]}}})})}};i._onPeoplePickerChange=function(e,t){i.setState(n.__assign(n.__assign({},i.state),{selectedPermissions:i.state.selectedPermissions,participants:0===e.length?i.state.participants.concat(t):i.state.participants,hasPeopleChange:0===e.length}))};i._onRoleChange=function(e){var t=i.state.selectedPermissions,r=c.getLinkKind(t.audience,2===e);i.setState(n.__assign(n.__assign({},i.state),{selectedPermissions:n.__assign(n.__assign({},t),{sharingRole:e,isEdit:2===e,sharingLinkKind:r}),hasSettingsChange:e!==i._getSharingRole()||i.state.hasSettingsChange}))};i._onExpirationChange=function(e){e||i._link.expiration||(e=c.getDefaultExpirationDateValue(i.props.sharingInformation.anonymousLinkExpirationRestrictionDays));i.setState(function(){return n.__assign(n.__assign({},i.state),{selectedPermissions:n.__assign(n.__assign({},i.state.selectedPermissions),{expiration:e,shareId:i._link.shareId}),hasSettingsChange:e!==i.state.selectedPermissions.expiration||i.state.hasSettingsChange})})};i._onPasswordChange=function(e){i.setState(function(){return n.__assign(n.__assign({},i.state),{selectedPermissions:n.__assign(n.__assign({},i.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:i._link.shareId}),hasSettingsChange:!0})})};i._getLinkSettings=function(){return i._link?{allowEditing:!0,audience:i._link.audience,expiration:i._link.expiration,isEdit:i._link.isEdit,isReview:i._link.isReview,isCreateOnlyLink:i._link.isCreateOnlyLink,sharingLinkKind:i._link.sharingLinkKind,specificPeople:c.getLinkParticipants(i._link),updatePassword:i._link.updatePassword,password:i._link.password,sharingRole:i._getSharingRoleFromLink(),preventDownload:i._link.blockDownload,hasPassword:i._link.hasPassword,description:i._link.description}:i.props.isAddressBarLink?{allowEditing:!0,audience:i.props.addressBarLinkSettings.linkDisabled?o.SharingAudience.existing:o.SharingAudience.organization,expiration:null,isEdit:2===i.props.addressBarLinkSettings.linkPermission,sharingLinkKind:6,specificPeople:i._link?c.getLinkParticipants(i._link):[],updatePassword:!1,password:""}:void 0};i._store=r.sharingStore;i._resize=r.resize;i._link=i.props.link;i.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,copyLinkAlert:"",link:i._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:i._link?c.getLinkParticipants(i._link):[],showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none,selectedPermissions:i._getLinkSettings(),expirationErrorCode:c.ExpirationErrorCode.none,linkDetailsView:i.props.linkDetailsView,addressBarDetailsView:!1,participantRemovedText:""};return i}t.prototype.render=function(){var e=this;if(this.props.enableLinkSettings&&(this.state.linkDetailsView||this.props.isAddressBarLink))return this._renderLinkDetails();var t=this.props.link,n=t.url,i=c.getLinkIconName(this.props.link),l=c.getLinkLabel(this.props.link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),h=t.principals&&t.principals.length>0||t.invitees&&t.invitees.length>0;return this.props.enableLinkSettings?r.createElement("div",null,this._renderShareLink(),T.renderScreenReaderOnlyAlert(this.state.copyLinkAlert,"assertive","alert"),!t.isUnhealthy&&this.props.showMoreOptions&&h&&r.createElement("div",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder","data-is-focusable":!0,"aria-expanded":this.state.linkMemberExpanded},r.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick},!this.state.linkMemberExpanded&&this._link.audience===o.SharingAudience.specificPeopleFlex&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&r.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},s.default.inviteesHolderLabel),this._link.audience===o.SharingAudience.specificPeopleFlex&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),T.renderScreenReaderOnlyAlert(this.state.participantRemovedText,"assertive","alert")),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):r.createElement("div",null,r.createElement("div",{className:"od-ShareLink flightOff"},r.createElement("div",{className:"od-ShareLink-main"},r.createElement("div",{className:"od-ShareLink-icon"},r.createElement(f.Icon,{iconName:i})),r.createElement("div",{className:"od-ShareLink-details","aria-live":"assertive","aria-relevant":"all"},r.createElement(a.TextField,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:l,componentRef:function(t){return e._textField=t}})),r.createElement(b.TooltipHost,{content:s.default.removeLinkText,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(u.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},ariaLabel:s.default.removeLinkText}))),r.createElement("div",{className:"od-ShareLink-description flightOff"},l)),h&&this._renderLinkMembers())};t.prototype.componentDidUpdate=function(){E.Killswitch.isActivated("0c40b3c2-4638-4643-8284-44108486c2d8","09/26/2019","Resize manage access")||this._resize()};t.prototype._renderLinkDetails=function(){return r.createElement(d.ShareLinkDetails,{companyName:this.props.companyName,link:this._link,participants:this.state.participants,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,mode:this.props.mode,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this._showPermissionsList,enableLinkSettings:this.props.enableLinkSettings,onRemoveLink:this.props.onRemoveLink,addressBarLinkDetails:this.props.isAddressBarLink,addressBarLinkSettings:this.props.addressBarLinkSettings,onOptionChange:this._onOptionChange})};t.prototype._renderParticipantsList=function(){return r.createElement(h.ShareLinkParticipants,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings})};t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return r.createElement(p.Facepile,{personas:e,personaSize:v.PersonaSize.size24,maxDisplayablePersonas:4,overflowButtonType:p.OverflowButtonType.descriptive,overflowButtonProps:{ariaLabel:s.default.overflowButtonFacepileAriaLabel}})};t.prototype._renderChevron=function(){var e=this;return r.createElement(b.TooltipHost,{content:s.default.inviteesHolderChevronAriaLabel,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(u.IconButton,{ariaLabel:s.default.inviteesHolderChevronAriaLabel,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}}))};t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(m.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===m.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none})}})};t.prototype._renderShareLink=function(){var e=this,t=this._link,n=t.url,i=this.state.copyLinkToClipboardSuccess,o=c.getLinkIconName(this.props.link),l=c.getLinkLabel(t,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),h=this._canManageLink(t);return r.createElement("div",{className:"od-ShareLink"},r.createElement("div",{className:"od-ShareLink-main"},r.createElement("div",{className:"od-ShareLink-icon2 icon-"+o},r.createElement(f.Icon,{iconName:o,"aria-hidden":!0})),r.createElement("div",{className:"od-ShareLink-details"},r.createElement(a.TextField,{"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:this._getAriaLabel(),componentRef:function(t){return e._textField=t}})),r.createElement(u.DefaultButton,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:i?s.default.notificationCopiedLabel:s.default.copyLinkLabel,componentRef:function(t){return e._copyButton=t}},i?s.default.copiedButtonLabel:s.default.copyButtonLabel),this.props.showMoreOptions&&h?r.createElement(b.TooltipHost,{content:s.default.moreOptionsLabel,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(u.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails,iconProps:{iconName:"More"},ariaLabel:s.default.moreOptionsLabel})):h?r.createElement(b.TooltipHost,{content:s.default.removeLinkText,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement(u.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:m.ConfirmationCode.link})},iconProps:{iconName:"Cancel"},ariaLabel:s.default.removeLinkText})):null),h?r.createElement("div",{className:"od-ShareLink-description",onClick:this._showLinkDetails},r.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?r.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},s.default.statusUnhealthyLinkDescription):r.createElement("span",{className:"od-ShareHintDetail-statusText"},l),this._renderStatusIcons())):r.createElement("div",{className:"od-ShareLink-description"},r.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?r.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},s.default.statusUnhealthyLinkDescription):r.createElement("span",{className:"od-ShareHintDetail-statusText"},l),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){if(!this._link.isUnhealthy){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,i=this._link.isCreateOnlyLink,o=[];e&&(e<new Date(Date.now())?o.push({icon:"EventDateMissed12",tooltip:""+g.format(s.default.expiredIn2,y.getShortDisplayDate(e))}):e.getTime()!==new Date(0).getTime()&&o.push({icon:"Calendar",tooltip:""+g.format(s.default.expiresIn2,y.getShortDisplayDate(e))}));t&&o.push({icon:"Lock",tooltip:s.default.sharePasswordReminderText});n&&!i&&o.push({icon:"Blocked2",tooltip:s.default.preventDownloadHint});this._link.isReview&&x.OfficeIconFileTypeMap[this.props.sharingInformation.fileExtension]&&o.push({icon:"Feedback",tooltip:s.default.officeReviewModeHint});var u=o.map(function(e,t){return r.createElement("i",{className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},r.createElement(b.TooltipHost,{content:e.tooltip,id:e.icon},r.createElement(f.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return r.createElement("div",{className:"od-ShareHintDetail-iconsList"},u)}};t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=c.getLinkLabel(this._link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);e&&(e<new Date(Date.now())?r+=" "+g.format(s.default.expiredIn2,y.getShortDisplayDate(e))+".":e.getTime()!==new Date(0).getTime()&&(r+=" "+g.format(s.default.expiresIn2,y.getShortDisplayDate(e))+"."));t&&(r+=" "+s.default.sharePasswordReminderText+".");n&&(r+=" "+s.default.preventDownloadHint+".");return r};t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}));return r.createElement(w.FocusZone,null,r.createElement("ul",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder flightOff","data-is-focusable":!0},e.map(function(e){return r.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},r.createElement(l.LinkMember,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))};t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isEdit?2:this.state.selectedPermissions.isReview?6:1};t.prototype._getSharingRoleFromLink=function(){return this._link.isEdit?2:this._link.isReview?6:1};t.prototype._canManageLink=function(e){if(this._store.isConsumer())return!0;var t=S.getSharingAbilitiesByAudience(e.audience,this.props.sharingInformation.sharingAbilities);return e.isEdit?!!t.canManageEditLink&&t.canManageEditLink.enabled:e.isReview?!!t.canManageReviewLink&&t.canManageReviewLink.enabled:!!t.canManageReadLink&&t.canManageReadLink.enabled};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(r.Component);t.ShareLink=N});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/LinkMember/LinkMember",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","ODCExecutors_css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(n.__assign(n.__assign({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(n.__assign(n.__assign({},i.state),{isCalloutVisible:!1}))};i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{className:"od-LinkMember"},s.createElement(i.Persona,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:i.PersonaInitialsColor.blue,size:i.PersonaSize.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&s.createElement(r.Callout,{directionalHint:r.DirectionalHint.topCenter,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},s.createElement("div",{className:"od-LinkMember-tooltip"},s.createElement("span",null,e.primaryText))))};return t})(s.Component);t.LinkMember=o});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkParticipants/ShareLinkParticipants",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onCancel=function(){i.setState(function(){return n.__assign(n.__assign({},i.state),{showDetailsPanel:!1,showConfirmationDialog:!1,participants:i.state.participants,hasPeopleChange:!1})})};i._onConfirmationDeleteParticipant=function(){if(i.state.confirmationCode===o.ConfirmationCode.participant){i._onLinkParticipantDelete();i.setState({showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none})}};i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none,hasPeopleChange:!1};return i}t.prototype.render=function(){var e=this;return r.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t){return r.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email},r.createElement(i.Persona,{imageUrl:t.image,primaryText:t.name,secondaryText:t.isExternal?u.default.externalUser:t.job,size:i.PersonaSize.size32,showSecondaryText:!(!t.job&&!t.isExternal)}),6===e.props.link.sharingLinkKind&&!e.props.link.isAddressBarLink&&r.createElement(s.IconButton,{"data-is-focusable":!0,ariaLabel:a.format(u.default.removePersonLabel,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:o.ConfirmationCode.participant,participant:t})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(o.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===o.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none})}})};t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];if(this.props.showDetailsPanel){t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email});this.setState(n.__assign(n.__assign({},this.state),{participants:t,hasPeopleChange:!0}));this.props.onRemoveParticipant(e,t)}else this.props.updateLinkSettings(e)};return t})(r.Component);t.ShareLinkParticipants=f});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkDetails/ShareLinkDetails",["require","exports","tslib","react","prop-types","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../interfaces/SharingInterfaces","../../../data/Icons/FileShareIconMap","../ShareLinkParticipants/ShareLinkParticipants","../../PeoplePickerWrapper/PeoplePickerWrapper","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Dropdown","office-ui-fabric-react/lib/Icon","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker","../ShareLink/ChangePermission/ChangePermission","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","../../ModifyPermissions/PreventDownload/PreventDownload","../../ModifyPermissions/PasswordField/PasswordField","../../ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup","../ShareLink/ShareLink","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","office-ui-fabric-react/lib/Tooltip","../../../utilities/ClientIdHelper","../../../utilities/SharingAbilitiesHelper","../../ModifyPermissions/OfficeReviewMode/OfficeReviewMode","../../../utilities/UiUtils","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onPeoplePickerChange=function(e){var t=c.renderPickerError({selectedItems:i.state.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),n=e[0],r=[];r=!0===n.isExternal?i.state.participants.filter(function(e){return e.email===n.email}):i.state.participants.filter(function(e){return e.userId===n.userId});i.setState({participants:0===r.length?i.state.participants.concat(e):i.state.participants,hasPeopleChange:0===r.length,peoplePickerError:t});i.props.onPeoplePickerChange(r,e)};i._onRemoveParticipant=function(e,t){i.setState({participants:t,participantRemovedText:o.format(s.default.removedPersonText,e.name)});i.props.updateLinkSettings(e)};i._onRoleChange=function(e){i.setState({hasSettingsChange:!0});i.props.onRoleChange(e)};i._onOptionChange=function(e){i.props.onOptionChange(e)};i._onAudienceChange=function(e){var t=e===u.SharingAudience.organization;i.setState(function(){return n.__assign(n.__assign({},i.state),{isAddressBarLinkEnabled:t,hasSettingsChange:e!==i._selectedAudience,currentAudience:e,confirmationCode:d.ConfirmationCode.addressBarLinkOff})})};i._onPasswordChange=function(e){i.setState(function(){return n.__assign(n.__assign({},i.state),{hasSettingsChange:e.length>0})});i.props.onPasswordChange(e)};i._onConfirmationSave=function(){if(i.props.addressBarLinkDetails){if(i.state.confirmationCode===d.ConfirmationCode.addressBarLinkOff){i._store.setAddressBarLinkCapability(!1);i._link&&i._store.unshareLink(i._link.sharingLinkKind,i._link.shareId)}else i._store.setAddressBarLinkCapability(!0);i.setState(function(){return n.__assign(n.__assign({},i.state),{isAddressBarLinkEnabled:!1,showConfirmationDialog:!1,hasSettingsChange:!1,confirmationCode:d.ConfirmationCode.none})})}else{i.props.updateLinkSettings(null);i.setState(n.__assign(n.__assign({},i.state),{showConfirmationDialog:!1,confirmationCode:d.ConfirmationCode.none,hasSettingsChange:!1,hasPeopleChange:!1}))}};i._onCancel=function(){i.setState(n.__assign(n.__assign({},i.state),{showConfirmationDialog:!1,confirmationCode:d.ConfirmationCode.none}));i.props.onCancel()};i._onSave=function(){if(i.state.hasSettingsChange){var e=i.props.addressBarLinkDetails&&i.state.currentAudience===u.SharingAudience.existing?d.ConfirmationCode.addressBarLinkOff:d.ConfirmationCode.linkSettings;i.setState(n.__assign(n.__assign({},i.state),{confirmationCode:e,showConfirmationDialog:!0}))}else if(i.state.hasPeopleChange){i.setState(n.__assign(n.__assign({},i.state),{hasPeopleChange:!1}));i.props.updateLinkSettings(null)}};i._onBack=function(){i.state.hasPeopleChange||i.state.hasSettingsChange?i.setState(n.__assign(n.__assign({},i.state),{showConfirmationDialog:!0,confirmationCode:d.ConfirmationCode.back})):i.props.onCancel()};i._onSelectDate=function(e){var t=i.props.sharingInformation.anonymousLinkExpirationRestrictionDays;i.setState(n.__assign(n.__assign({},i.state),{expirationErrorCode:g.getExpirationErrorCode(e,t)}),function(){i._updateExpirationErrorCode(g.getExpirationErrorCode(e,t))});i._onExpirationChange(e)};i._store=r.sharingStore;i._link=i.props.link;var a=i.props.sharingInformation.sharingAbilities;i._canManageAddressBarLink=g.canManageAddressBarLink(a);i.state={expirationErrorCode:g.ExpirationErrorCode.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:d.ConfirmationCode.none,participants:i.props.participants,participantRemovedText:"",selectedPermissions:i.props.selectedPermissions,currentAudience:i._getCurrentAudience(),peoplePickerError:c.renderPickerError({selectedItems:n.__assign({},i.props.participants),sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})};i._audienceOptions=i._getAudienceOptions();return i}t.prototype.render=function(){var e=N.isODSP(this.props.clientId)?" od-ShareLinkDetails--absolute":"";return r.createElement("div",{className:"od-ShareLinkDetails--div"+e},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())};t.prototype._renderDetailsPanelContent=function(){return this.props.addressBarLinkDetails?this._renderAddressBarLinkDetails():r.createElement("div",{className:"od-ShareLinkDetails--content"},this._renderShareLink(),r.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.modifyPermissionsHeader},s.default.modifyPermissionsHeader),r.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":s.default.modifyPermissionsHeader},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==u.SharingAudience.specificPeopleFlex&&this.state.participants.length>0&&r.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.notFlexibleLinkPeoplePickerHeader},s.default.notFlexibleLinkPeoplePickerHeader),this.props.selectedPermissions.audience===u.SharingAudience.specificPeopleFlex&&r.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.flexibleLinkPeoplePickerHeader},s.default.flexibleLinkPeoplePickerHeader),this._renderPeoplePicker(),this._renderParticipantsList(),L.renderScreenReaderOnlyAlert(this.state.participantRemovedText,"assertive","alert"),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderAddressBarLinkDetails=function(){return r.createElement("div",{className:"od-ShareLinkDetails--content"},r.createElement("span",{className:"od-ShareLinkDetails-addressBarChoiceGroupLabel"},s.default.chooseAddressBarLink),r.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},r.createElement(E.AudienceChoiceGroup,{items:this._audienceOptions,onChange:this._onOptionChange,onAudienceChange:this._onAudienceChange,companyName:this.props.companyName,clientId:this.props.clientId})),r.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.modifyPermissionsHeader},s.default.modifyPermissionsHeader),r.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":s.default.modifyPermissionsHeader},this._renderChangePermission()),this.state.participants.length>0&&r.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.notFlexibleLinkPeoplePickerHeader},s.default.notFlexibleLinkPeoplePickerHeader),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderShareLink=function(){return r.createElement(S.ShareLink,{link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink})};t.prototype._renderDetailsPanelHeader=function(){return r.createElement("div",{className:"od-ShareLinkDetails--header"},L.renderWithToolTip(r.createElement(y.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Back"},onClick:this._onBack,ariaLabel:s.default.backButtonLabel}),s.default.backButtonLabel,{position:T.DirectionalHint.bottomLeftEdge}),r.createElement("span",null,s.default.manageExistingAccessLabel))};t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange)||this.state.expirationErrorCode!==g.ExpirationErrorCode.none;return r.createElement("div",{className:"od-ShareLinkDetails--actions"},r.createElement(y.PrimaryButton,{id:"od-ShareLinkDetails-save",onClick:this._onSave,disabled:e},s.default.saveButtonText),r.createElement(y.DefaultButton,{onClick:this.props.showPermissionsList,disabled:e},s.default.discardButtonText))};t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?r.createElement(f.ShareLinkParticipants,{link:this._link,showDetailsPanel:!0,participants:this.state.participants,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant}):this._link.audience===u.SharingAudience.specificPeopleFlex?r.createElement("div",{className:"od-ShareLinkDetails--noParticipants"},s.default.noLinkParticipantsPSL):void 0};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=c.getOversharingExternalsWarning(t.participants),i=c.getOversharingGroupsWarning(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===u.SharingAudience.specificPeopleFlex)return r.createElement(l.default,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:s.default.peoplePickerPlaceholderSpecific,onResolvedSuggestions:null})};t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=t==u.SharingAudience.organization||t==u.SharingAudience.anyone||t===u.SharingAudience.existing;if(C.isOfficeReviewModeAllowed(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension))return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},r.createElement(m.ChangePermission,{selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,item:e.sharingInformation.item,canChangePermission:n,showReview:!1})));var i=C.isReviewingAllowed(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension);return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},r.createElement(m.ChangePermission,{selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,item:e.sharingInformation.item,canChangePermission:n,showReview:i})))};t.prototype._renderRequestFileEntry=function(){var e=[{key:s.default.canUploadText,text:s.default.canUploadText,data:s.default.canUploadText,ariaLabel:s.default.canUploadText}];return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},r.createElement("div",{className:"od-RoleSelector-wrapper"},L.renderWithToolTip(r.createElement(p.Icon,{className:"od-RoleSelector-settingIcon",iconName:"Upload"}),s.default.canUploadText),r.createElement(h.Dropdown,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:s.default.canUploadText,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:x.ResponsiveMode.large,ariaLabel:s.default.canUploadText,options:e}),this.props.children)))};t.prototype._getCurrentAudience=function(){var e=this.props.addressBarLinkSettings;return e&&e.linkDisabled||!this._canManageAddressBarLink?u.SharingAudience.existing:u.SharingAudience.organization};t.prototype._getAudienceOptions=function(){var e=[],t={icon:a.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:u.SharingAudience.existing,label:s.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4},n={disabledText:s.default.disabledAudienceChoiceLabel2,icon:a.FileShareIconMap[1],isChecked:!1,isDisabled:!this._canManageAddressBarLink,key:u.SharingAudience.organization,label:o.format(s.default.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(this._canManageAddressBarLink&&this.state.currentAudience!==u.SharingAudience.existing){n.isChecked=!0;t.isChecked=!1;this._selectedAudience=u.SharingAudience.organization}else{n.isChecked=!1;t.isChecked=!0;this._selectedAudience=u.SharingAudience.existing}e.push(n,t);return e};t.prototype._renderExpirationDatePicker=function(){var e=this.state.selectedPermissions;if(e.audience===u.SharingAudience.anyone)return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--datePicker"},r.createElement(v.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:e.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays})),r.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage()))};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return g.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;t&&(e=t.primaryText?t.primaryText:t.email?t.email:"");return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},r.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},r.createElement(w.PasswordField,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e}))))}};t.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},r.createElement(b.PreventDownload,{isToggled:e,disablePreventDownload:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props,t=e.selectedPermissions.audience;if(C.isOfficeReviewModeAllowed(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)){var n=e.selectedPermissions.isReview||6===e.selectedPermissions.sharingRole;return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--officeReviewModeToggle"},r.createElement(k.OfficeReviewMode,{isToggled:n,disableOfficeReviewMode:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))}};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(d.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,companyName:this.props.companyName,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===d.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:d.ConfirmationCode.none})},onDiscard:this.props.showPermissionsList})};t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return n.__assign(n.__assign({},t.state),{selectedPermissions:n.__assign(n.__assign({},t.state.selectedPermissions),{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})});this.props.onExpirationChange(e)};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(n.__assign(n.__assign({},this.state),{expirationErrorCode:e}))};t.contextTypes={sharingStore:i.object.isRequired};return t})(r.Component);t.ShareLinkDetails=A});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal",["require","exports","tslib","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","prop-types","office-ui-fabric-react/lib/Icon","../../../utilities/ClientIdHelper","../../Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onStopSharingClick=function(){r.setState({isUpdatingRole:!0});r._store.updatePermissions(r.props.principal,0)};r.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:r._computeInitialRoleText(t.principal)};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._onPermissionsClick=r._onPermissionsClick.bind(r);return r}t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!f.isMobile(this.props.clientId)&&this._focusElement.focus()};t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})};t.prototype.render=function(){var e=this,t=this.props.principal;return o.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},o.createElement(s.Persona,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:s.PersonaInitialsColor.blue,primaryText:t.primaryText,size:s.PersonaSize.regular,imageUrl:t.imageUrl}),o.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},o.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))};t.prototype._computeInitialRoleText=function(e){var t=l.default,n=this.props.principal.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case 2:return t.canEditLabel;case 6:return l.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?l.default.updatingPermissions:this.state.roleText};t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||3!==this.props.userRole||2!==t&&1!==t&&6!==t?o.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):o.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription"+e.id},o.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),o.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription"+e.id},"Set permissions for "+e.primaryText))};t.prototype._renderChevron=function(e){if(2===e||1===e||6===e)return o.createElement("div",{className:"od-SharePrincipal-permissions-icon"},o.createElement(a.Icon,{iconName:"ChevronDown"}))};t.prototype._renderContextualMenu=function(e){var t,n,s=this,u=l.default;switch(e){case 1:t=2;n=l.default.allowEdit;6;l.default.ReviewOnly;break;case 6:t=2;n=l.default.allowEdit;1;l.default.changeToViewOnly;break;case 2:t=1;n=l.default.changeToViewOnly;6;l.default.ReviewOnly}if(this.state.showContextualMenu)return o.createElement(r.ContextualMenu,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+u.stopSharing,onClick:this._onStopSharingClick}],onDismiss:function(){s.setState({showContextualMenu:!1})},directionalHint:i.DirectionalHint.bottomLeftEdge,isBeakVisible:!0,target:this.state.target})};t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText});this._store.updatePermissions(this.props.principal,e)};t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(2===t||1===t||6===t)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};t.contextTypes={sharingStore:u.object.isRequired};return t})(o.Component);t.SharePrincipal=c});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal2",["require","exports","tslib","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","../../../interfaces/SharingInterfaces","react","react","prop-types","office-ui-fabric-react/lib/Icon","../../Share.resx","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","../ShareLink/ConfirmationDialog/ConfirmationDialog","office-ui-fabric-react/lib/FocusZone","../../../utilities/SharingAbilitiesHelper","../../../utilities/SharingFeatures","@ms/odsp-datasources/lib/interfaces/sharing/enums/SPSharedObjectType","@ms/odsp-utilities/lib/killswitch/Killswitch","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._menuElement=a.createRef();r._showMenu=function(){var e=r.state.showMenu;r.setState({showMenu:!e})};r._hideMenu=function(){r.setState({showMenu:!1})};r._stopSharingConfirmation=function(){r.setState({showConfirmationDialog:!0})};r._onCancel=function(){r.setState({showConfirmationDialog:!1})};r._onStopSharingClick=function(){r._store.updatePermissions(r.props.principal,0)};r.state={showMenu:!1,showConfirmationDialog:!1};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);return r}t.prototype.render=function(){var e=this.props.principal,t=3===e.role,n=e.type===o.PrincipalType.sharePointGroup,r=!t,i=this.props.sharingInformation;i&&i.sharedObjectType===E.SPSharedObjectType.list&&w.fullControlRoleForSharingLists()&&(r=!n&&!e.isSiteAdmin||n&&!t);return u.createElement("div",{className:"od-ShareLink-personaItem od-SharePrincipal2","data-is-focusable":!0,"aria-label":this._computeAriaLabel(e,t),tabIndex:-1},u.createElement(y.FocusZone,{direction:y.FocusZoneDirection.horizontal},u.createElement(s.Persona,{className:"od-SharePrincipal-persona2",size:s.PersonaSize.size32,primaryText:e.primaryText,secondaryText:e.isExternal?c.default.externalUser:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}),u.createElement("div",{className:"od-SharePrincipal-permissions"},r?this._renderChangePermissions(e):u.createElement("span",{className:"od-SharePrincipal-ownerLabel","data-is-focusable":!0},c.default.ownerLabel))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderChangePermissions=function(e){var t=e.role;return 3===this.props.userRole&&(2===t||1===t||6===t||3===t&&w.fullControlRoleForSharingLists())?u.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e),this._renderChangePermissionDropdown()):u.createElement("div",{className:"od-SharePrincipal-permissionsRole"},this._renderRoleIcon(e))};t.prototype._renderRoleIcon=function(e){var t=h.getRoleIconNameAndTitle(e.role),n=this._computeRoleText(e);return u.createElement(d.TooltipHost,{id:e.id.toString(),content:n,calloutProps:{gapSpace:0}},u.createElement(l.Icon,{className:"od-SharePrincipal-roleIcon",iconName:t.name,"aria-describedby":"od-SharePrincipal-tooltip"}))};t.prototype._renderChangePermissionDropdown=function(){var e=m.getRTL();return u.createElement("div",{ref:this._menuElement},u.createElement(p.IconButton,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:v.format(c.default.permissionsLabelFor,this.props.principal.primaryText)}),this.state.showMenu&&u.createElement(r.ContextualMenu,{target:this._menuElement.current,items:S.Killswitch.isActivated("05d8eb3d-2efd-4c97-bc62-8b8d318b5d4a","5/5/2020","Share Principals dropdown refactoring")?this._getContextualMenuItems_deprecated():this._getContextualMenuItems(),directionalHint:e?i.DirectionalHint.bottomLeftEdge:i.DirectionalHint.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))};t.prototype._onChangeRoleClick=function(e){e!==this.props.principal.role&&this._store.updatePermissions(this.props.principal,e)};t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return u.createElement(g.ConfirmationDialog,{confirmationCode:g.ConfirmationCode.participant,participant:t,onApply:this._onStopSharingClick,onCancel:this._onCancel})};t.prototype._getContextualMenuItems_deprecated=function(){var e,t,n,r=this.props.principal.role;switch(r){case 1:n=c.default.canViewLabel;e=2;t=c.default.canEditLabel;6;c.default.canReviewRole;break;case 6:n=c.default.canReviewRole;e=2;t=c.default.canEditLabel;1;c.default.canViewLabel;break;case 2:n=c.default.canEditLabel;e=1;t=c.default.canViewLabel;6;c.default.canReviewRole}return[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,r),checked:!0,iconProps:{iconName:"CheckMark"}},{key:"editable2",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"stopSharing",name:""+c.default.stopSharing,onClick:this._stopSharingConfirmation}]};t.prototype._getContextualMenuItems=function(){var e=this,t=this.props.principal.role,n=b.isReviewingAllowed(o.SharingAudience.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),r=w.fullControlRoleForSharingLists()&&this.props.sharingInformation.sharedObjectType===E.SPSharedObjectType.list&&this.props.principal.type!==o.PrincipalType.sharePointGroup,i={key:"currentRole",name:h.getRoleIconNameAndTitle(t).title,onClick:function(){e._onChangeRoleClick(t)},checked:!0,iconProps:{iconName:"CheckMark"}},s={key:"fullControl",name:c.default.fullControlRole,onClick:function(){e._onChangeRoleClick(3)}},u={key:"editRole",name:c.default.canEditLabel,onClick:function(){e._onChangeRoleClick(2)}},a={key:"reviewRole",name:c.default.canReviewRole,onClick:function(){e._onChangeRoleClick(6)}},f={key:"viewRole",name:c.default.canViewLabel,onClick:function(){e._onChangeRoleClick(1)}},l={key:"stopSharing",name:""+c.default.stopSharing,onClick:this._stopSharingConfirmation},p=[i];r&&3!=t&&p.push(s);2!=t&&p.push(u);n&&6!=t&&p.push(a);1!=t&&p.push(f);p.push(l);return p};t.prototype._computeAriaLabel=function(e,t){var n=this._computeRoleText(e),r=e.primaryText+", "+n+".";t||(r+=" "+c.default.sharePrincipalInstruction);return r};t.prototype._computeRoleText=function(e){var t=c.default,n=e.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case 2:return t.canEditLabel;case 6:return c.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};t.contextTypes={sharingStore:f.object.isRequired};return t})(u.Component);t.SharePrincipal2=x});
define("@ms/odsp-datasources/lib/interfaces/sharing/enums/SPSharedObjectType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.folder=2]="folder";e[e.item=3]="item";e[e.list=4]="list";e[e.web=5]="web";e[e.max=6]="max"})(t.SPSharedObjectType||(t.SPSharedObjectType={}))});
define("@ms/odsp-shared-sharing/lib/utilities/FileExtensionHelper",["require","exports","@ms/odsp-utilities/lib/icons/ItemType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},i=void 0;t.getItemCategory=function(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==n.default.File?n.default[e.itemType].toLowerCase():s(e.extension):"none"};function s(e){if(!e)return"none";if(!i){i={};Object.keys(r).map(function(e){r[e].forEach(function(t){i[t]=e})})}var t=i[e.toLowerCase()];return t||"other"}t.getCategoryFromExtension=s});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareMain",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","../SendLink/SendLink","./ShareTargets/ShareTargets","../ShareHint/ShareHint","react","react","prop-types","../Share.resx","../../utilities/AttachAsCopyHelper","../../utilities/ClientIdHelper","../ActivityIndicator/ActivityIndicator","../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","../../utilities/ShareCommunicationManager","../../utilities/ShareHelper","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/features/FeatureOverrides","../../utilities/UiUtils","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={ODB:1637},T=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._headerControl=f.createRef();r._peoplePickerHasUnresolvedText=!1;r._onSelectedPeopleChange=function(e){var t=r.props,n=v.renderPickerError({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:b.canAddPeople(t.sharingInformation)?t.onShareHintClicked:void 0,permissionsMap:t.permissionsMap});if(n){for(var i=t.currentSettings.sharingLinkKind,s=3===i||2===i,o=!1,u=0,a=e;u<a.length;u++){if(a[u].isExternal&&s){o=!0;break}}o&&r.context.sharingStore.getEngagementHelper().externalSharingCslError(t.engagementExtraData)}r.setState({peoplePickerErrorMessage:n},function(){t.onSelectedPeopleChange(e)})};r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._onShareTargetClicked=function(e){!r._isPeoplePickerValid(e)&&(r.props.currentSettings.audience===i.SharingAudience.specificPeopleFlex||r.props.currentSettings.audience===i.SharingAudience.specificPeople||r.props.linkRecipients.length>0)||r.setState({showActivityIndicator:!0,shareType:e},function(){r.props.onShareTargetClicked(e)})};r._onSendLinkClicked=function(e,t){r._isPeoplePickerValid(i.ShareType.share)&&r.setState({showActivityIndicator:!0,shareType:i.ShareType.share},function(){r.props.onSendLinkClicked(e,t)})};r._onAttachAsCopyClicked=function(){var e=r.props.clientId;r.context.sharingStore.getEngagementHelper().sendACopyClicked(r.props.engagementExtraData);if(p.isOfficeProduct(e)){var t=!r.state.isAttachAsCopyContextualMenuVisible;r.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===i.ClientId.ngsc||p.isMobile(e))try{window.external.SendCopy()}catch(e){}};r._shareClickTime=n.shareClickTime;r._isRoleSelectorCompactExperimentOn=!1;if(E.default.isFeatureEnabled(x)){var s=new w.ABExperiment({name:"RoleSelectorCompact",startDate:"07/29/2019",version:w.ABExpHash.v2});r._isRoleSelectorCompactExperimentOn=s.IsExperimentOn()}r.state={isAttachAsCopyContextualMenuVisible:!1,shareType:i.ShareType.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return r}t.prototype.componentDidMount=function(){y.pageFinishedLoading(this._shareClickTime,this.props.clientId,i.Mode.share,this.props.scenarioId);this._updatePeoplePickerError(this.props);p.isMobile(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=this.props,i=this.state.showActivityIndicator?this._getActivityMessage():"",s=this.props.hideShareDialogOverflowButton||!1,o=this._renderFooter(),f=o?{className:"od-ShareMain-section-body"}:null;return a.createElement("div",{className:"od-ShareMain"+e},a.createElement(r.Header,{clientId:t.clientId,item:t.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:0,hideShareDialogOverflowButton:s,ref:this._headerControl,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus}),a.createElement("div",n.__assign({},f),a.createElement("div",{className:"od-ShareMain-section full-bleed"},a.createElement(u.ShareHint,{clientId:t.clientId,companyName:t.companyName,currentSettings:t.currentSettings,onShareHintClick:t.onShareHintClicked,sharingInformation:t.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:t.customLabeledAudienceConfig,useDarkBorder:this._isRoleSelectorCompactExperimentOn})),this._renderSendLink(),this._renderTargets()),o,this._renderActivityIndicator(),S.renderScreenReaderOnlyAlert(i,"assertive","alert"))};t.prototype._renderTargets=function(){return a.createElement("div",{className:"od-ShareMain-targets"},a.createElement(o.ShareTargets,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this.props.onShareTargetsRendered,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(p.isOfficeProduct(t)){var n=h.default.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this.props.engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return a.createElement("div",null,a.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},a.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},a.createElement(m.Icon,{iconName:"Copy"})),a.createElement("span",null,c.default.attachACopyInstead)));if(n.length>0)return a.createElement("div",null,a.createElement(g.DefaultButton,{className:"od-ShareMain-footer",text:c.default.attachACopyInstead,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n}}))}else if((t===i.ClientId.ngsc||p.isMobile(t))&&this._isSendCopyEnabled())return a.createElement("div",null,a.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},a.createElement("div",{className:"od-ShareMain-attachIcon"},a.createElement(m.Icon,{iconName:"Copy"})),a.createElement("span",null,c.default.attachACopyInstead)))};t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||b.isLoadingData(this.props.sharingInformation)){var e=this.props;return a.createElement("div",{className:this._isRoleSelectorCompactExperimentOn?"od-ShareMain-section od-ShareMain-section-experimental":"od-ShareMain-section"},a.createElement(s.SendLink,{ctaLabel:c.default.sendButtonLabel,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:500,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this.props.engagementExtraData,onShareHintClicked:this.props.onShareHintClicked,onEditChange:this.props.onEditChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,isRoleSelectorCompactExperimentOn:this._isRoleSelectorCompactExperimentOn}))}};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return a.createElement(d.ActivityIndicator,{message:this._getActivityMessage()})};t.prototype._getActivityMessage=function(){var e=c.default;switch(this.state.shareType){case i.ShareType.share:return e.activityMessageSendingMail;case i.ShareType.copy:case i.ShareType.outlook:case i.ShareType.nonOutlook:case i.ShareType.teams:case i.ShareType.moreApps:default:return e.activityMessageCreatingLink}};t.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==i.ShareType.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===i.SharingAudience.specificPeople){for(var t=!1,n=!1,r=0,s=this.props.linkRecipients;r<s.length;r++){var o=s[r];t||(t=o.isExternal&&!o.providerName);n||(n=!o.isExternal||o.isExternal&&!!o.providerName)}if(t&&n){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.mixedRecipientErrorMessage)});return!1}}var u=this.props.currentSettings.audience===i.SharingAudience.specificPeopleFlex||this.props.currentSettings.audience===i.SharingAudience.specificPeople||e===i.ShareType.share;if(this._peoplePickerHasUnresolvedText){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.unresolvedTextError)});return!1}if(0===this.props.linkRecipients.length&&u){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.recipientsRequiredError)});return!1}return!0}};t.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=v.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:b.canAddPeople(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState({peoplePickerErrorMessage:t,showActivityIndicator:!t&&this.state.showActivityIndicator})}};t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})};t.contextTypes={shareClickTime:l.number,sharingStore:l.object.isRequired};return t})(a.Component);t.ShareMain=T});
define("@ms/odsp-shared-sharing/lib/components/SendLink/SendLink",["require","exports","tslib","../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/TextField","../../utilities/PeoplePickerHelper","react","prop-types","../PeoplePickerWrapper/PeoplePickerWrapper","../SendButton/SendButton","../SendButton/SendButtonType","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Spinner","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/FeatureOverrides","../../utilities/SharingFeatures","../../utilities/ClientIdHelper","../../utilities/ResizeTracker","../RoleSelectorCompact/RoleSelectorCompact","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E={ODB:1175},S={ODB:-1175},x={ODB:1193},T=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._topLevelDivRef=o.createRef();i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=h.getEncodedMessageLength(e);i.setState(n.__assign(n.__assign({},i.state),{messageLength:t}));return""};i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=h.getEncodedMessageLength(e);i.setState(n.__assign(n.__assign({},i.state),{subjectLength:t}));return e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._platformDetection=r.platformDetection;i.state={messageLength:0,subjectLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._isOnExperiment=!1;i._isSubjectExperimentOn=!1;i._isRoleSelectorCompactExperimentOn=!1;if(m.default.isFeatureEnabled(E)&&!i._platformDetection.isIOS&&(!y.isOfficeProduct(i.props.clientId)||!i._platformDetection.isMac)&&!v.Killswitch.isActivated("08cded93-1718-48b0-9b7e-bfdcf6384ef3","7/17/2018","AddMessageBorder")){var s=new d.ABExperiment({name:"AddMessageBorder",startDate:"07/17/2018",version:d.ABExpHash.v2});i._isOnExperiment=s.IsExperimentOn()}if(m.default.isFeatureEnabled(x)){var u=new d.ABExperiment({name:"AddSubjectLine",startDate:"08/14/2018",version:d.ABExpHash.v2});i._isSubjectExperimentOn=u.IsExperimentOn()}i._isRoleSelectorCompactExperimentOn=t.isRoleSelectorCompactExperimentOn||!1;g.genericResizeTracker()&&(i._resizeTracker=new b.ResizeTracker(r.resize));return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){s.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:h.canAddPeople(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState(n.__assign({},this.state))};t.prototype.componentDidMount=function(){g.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){g.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.render=function(){var e=this._isOnExperiment||m.default.isFeatureEnabled(S),t=this.props,n=t.currentSettings,i=t.linkRecipients,u=s.getOversharingExternalsWarning(i),h=s.getOversharingGroupsWarning(i,t.groupsMemberCount),d=this._platformDetection.isIOS||y.isIos(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||y.isAndroid(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";d+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var v=e?"od-SendLink-message-border":"od-SendLink-message-no-border";v+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-message-roleSelector":"";var g=this.props.showSendButton?o.createElement("div",{className:d},o.createElement(f.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:l.default.button,sharingInformation:this.props.sharingInformation})):"",b=t.isLoadingDefaultRecipients?o.createElement("div",null,o.createElement(p.Spinner,{className:"od-SendLink-spinner",label:c.default.loadingRecipients,size:p.SpinnerSize.small})):o.createElement(a.default,{defaultSelectedItems:i,error:t.errorMessage,onChange:t.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:u,oversharingGroupsWarning:h,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:n.sharingLinkKind,sharingInformation:t.sharingInformation,permissionsMap:t.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:t.clientId,onInputChange:t.onPeoplePickerInputChange||null}),E=this._isRoleSelectorCompactExperimentOn?o.createElement("div",null,o.createElement(w.RoleSelectorCompact,{currentSettings:this.props.currentSettings,clientId:this.props.clientId,appmap:this.props.sharingInformation.item.appmap,ariaLabel:c.default.addPeopleRoleSelectorAriaLabel,onShareHintClicked:this.props.onShareHintClicked,onEditChange:this.props.onEditChange,mode:r.Mode.share,sharingInformation:this.props.sharingInformation})):"";return o.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},o.createElement("div",{className:"od-SendLink-email"},o.createElement("div",{className:"od-SendLink-permissions"},o.createElement("div",{className:"od-SendLink-peoplePicker"+(this._isRoleSelectorCompactExperimentOn?" od-SendLink-peoplePicker-experiment":"")},b),E),o.createElement("div",{className:"od-SendLink-message "+v,id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),g)))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};t.prototype._renderTextArea=function(){if(this.props.showTextArea)return o.createElement("div",null,this._isSubjectExperimentOn&&o.createElement(i.TextField,{borderless:!0,underlined:!0,placeholder:c.default.subjectPlaceholder,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),o.createElement(i.TextField,{borderless:!0,placeholder:c.default.messagePlaceholder,ariaLabel:c.default.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}))};t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t="od-SendLink-characterCounter "+(e>this.props.maximumMessageLength?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return o.createElement("div",{className:"od-SendLink-characterCounterWrapper"},o.createElement("span",{className:t},e,"/",this.props.maximumMessageLength))};t.contextTypes={platformDetection:u.object.isRequired,sharingStore:u.object.isRequired,resize:u.func.isRequired};return t})(o.Component);t.SendLink=T});
define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButton",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","../../interfaces/SharingInterfaces","./SendButtonType","../../utilities/ShareHelper","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSendLinkClicked=function(){r.props.onSendLinkClicked(r.props.messageText,r.props.subjectText)};r._platformDetection=n.platformDetection;return r}t.prototype.render=function(){var e=!1;if(this.props.currentSettings.audience===o.SharingAudience.existing)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var f=n[t];if(void 0===this.props.permissionsMap[f.email]&&void 0===this.props.permissionsMap[f.userId]){e=!0;break}}if(this.props.ctaLabel){var l=!!this.props.errorMessage||a.isLoadingData(this.props.sharingInformation)||e||a.getEncodedMessageLength(this.props.messageText)>this.props.maximumMessageLength||a.getEncodedMessageLength(this.props.subjectText)>this.props.maximumSubjectLength;if(this.props.sendButtonType===u.default.button)return r.createElement(i.PrimaryButton,{disabled:l,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===u.default.link)return r.createElement("div",{className:"od-SendButton-linkButton"},r.createElement(s.Link,{disabled:l,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};t.contextTypes={platformDetection:f.object.isRequired};return t})(r.Component);t.default=l});
define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButtonType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.button=0]="button";e[e.link=1]="link"})(n||(n={}));t.default=n});
define("@ms/odsp-shared-sharing/lib/components/RoleSelectorCompact/RoleSelectorCompact",["require","exports","tslib","react","../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../Share.resx","prop-types","../../utilities/SharingAbilitiesHelper","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t,n){var r,i=e.call(this,t)||this;i._onItemClicked=function(e,t){var n;switch(t.key){case"edit":n=2;break;case"comment":n=6;break;case"view-only":n=1;break;default:n=0}i.state.selectedItemKey!==n&&i.context.sharingStore.getEngagementHelper().log("RoleSelectorCompact.RoleChanged",{clientId:i.props.clientId,scenarioId:"",mode:i.props.mode,isEdit:2===n});i.setState({selectedItemKey:n});i.props.onEditChange(n);return!0};r=i.props.currentSettings.isEdit?2:1;i.state={selectedItemKey:r};return i}t.prototype.render=function(){var e=this,t=c.isReviewingAllowed(i.SharingAudience.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),n=this.props.clientId===i.ClientId.word||this.props.appmap&&"ms-word"===this.props.appmap,l=[{key:"edit",text:f.default.canEditRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canEditRole,f.default.canEditRoleSubText),canCheck:!0,isChecked:2===this.state.selectedItemKey,className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"}},{key:"view-only",text:f.default.canViewOnlyRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canViewRole,f.default.canViewRoleSubText),canCheck:!0,isChecked:1===this.state.selectedItemKey,className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Uneditable"}},{key:"divider_1",itemType:s.ContextualMenuItemType.Divider},{key:"moresettings",text:f.default.moreSettingsLabel,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.moreOptionsLabel,f.default.moreOptionsLabel),onClick:function(){e.props.onShareHintClicked()},className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-settingsItem"}],h={key:"comment",text:f.default.canCommentRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canReviewRole,f.default.canReviewRoleSubText),canCheck:!0,isChecked:6===this.state.selectedItemKey,className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"}};t&&n&&l.splice(1,0,h);return r.createElement(u.IconButton,{menuIconProps:{iconName:"ChevronDownSmall",style:{fontSize:"16"}},iconProps:{iconName:this.getRoleIconName(this.state.selectedItemKey).name},className:"od-RoleSelectorCompact-permissionButton",styles:{root:{minWidth:36,minHeight:32,border:"1px solid",padding:0,marginLeft:3,borderRadius:2},menuIcon:{fontSize:6,marginLeft:0},icon:{fontSize:12,marginRight:2}},menuProps:{directionalHint:o.DirectionalHint.bottomRightEdge,shouldFocusOnMount:!0,items:l,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){return e._logRoleSelectorClicked(e.context.sharingStore)}},disabled:!!this.props.disabled,ariaLabel:this.props.ariaLabel})};t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().log("RoleSelectorCompact.Clicked",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})};t.prototype.getRoleIconName=function(e){var t;switch(e){case 2:t="Edit";break;case 1:t="Uneditable";break;case 6:t="Feedback"}return{name:t}};t.contextTypes={sharingStore:l.object.isRequired};return t})(r.Component);t.RoleSelectorCompact=h});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareTargets/ShareTargets",["require","exports","tslib","../../../interfaces/SharingInterfaces","react","../../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Tooltip","../../../components/Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==r.SharingAudience.existing&&this.props.currentSettings.audience!==r.SharingAudience.anyone&&this.props.currentSettings.audience!==r.SharingAudience.organization;this._shareTargetsData=this._getShareTargetsData();return e?i.createElement("div",{className:"od-ShareTargets"},i.createElement(a.TooltipHost,{content:f.default.accessRequestTooltip,calloutProps:{calloutWidth:300,directionalHint:a.DirectionalHint.topCenter}},i.createElement("ul",{className:"od-ShareTargets-items","aria-label":f.default.otherWaysToShareLabel},this._renderTargets()))):i.createElement("div",{className:"od-ShareTargets"},i.createElement("ul",{className:"od-ShareTargets-items","aria-label":f.default.otherWaysToShareLabel},this._renderTargets()))};t.prototype.componentDidMount=function(){u.isLoadingData(this.props.sharingInformation)||this._onRenderedShareTargets()};t.prototype.componentDidUpdate=function(e){u.isLoadingData(e.sharingInformation)&&!u.isLoadingData(this.props.sharingInformation)&&this._onRenderedShareTargets()};t.prototype._onRenderedShareTargets=function(){for(var e=[],t=0,n=this._shareTargetsData;t<n.length;t++){var r=n[t];e.push(r.shareType)}this.props.onShareTargetsRendered(e)};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==r.SharingAudience.existing&&this.props.currentSettings.audience!==r.SharingAudience.anyone&&this.props.currentSettings.audience!==r.SharingAudience.organization,n=0,s=this._shareTargetsData;n<s.length;n++){var a=s[n],f=void 0,l=a.icon,c=l.split(":",2)[1],h=t||u.isLoadingData(this.props.sharingInformation),p="od-ShareTargets-icon "+(h?"od-ShareTargets-disabled":""),d="od-ShareTargets-itemText ms-font-xs "+(h?"od-ShareTargets-disabled":"");f=l.indexOf("font:")>-1?i.createElement(o.Icon,{iconName:c,className:p}):i.createElement("img",{src:c,className:p});e.push(i.createElement("li",{key:a.shareType,className:"od-ShareTargets-item"},i.createElement("button",{className:"od-ShareTargets-target",disabled:h,onClick:a.action},i.createElement("div",{className:"od-ShareTargets-itemImage"},f),i.createElement("div",{className:d},a.label))))}return e};t.prototype._getShareTargetsData=function(){var e=[{label:f.default.copyLinkLabel,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.copy,action:this._onClick.bind(this,r.ShareType.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===r.OutlookAvailability.available?e.push({label:f.default.outlookLabel,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.outlook,action:this._onClick.bind(this,r.ShareType.outlook)}):t===r.OutlookAvailability.other&&e.push({label:f.default.nonOutlookLabel,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.nonOutlook,action:this._onClick.bind(this,r.ShareType.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:f.default.teamsLabel,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.teams,action:this._onClick.bind(this,r.ShareType.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:f.default.moreAppsLabel,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.moreApps,action:this._onClick.bind(this,r.ShareType.moreApps)});return e};t.prototype._onClick=function(e){this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){if(s.showOWAShareTarget(this.props.clientId)&&this.props.outlookAvailability===r.OutlookAvailability.available)return r.OutlookAvailability.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return r.OutlookAvailability.none}};t.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};t.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};return t})(i.Component);t.ShareTargets=l});
define("@ms/odsp-shared-sharing/lib/utilities/AttachAsCopyHelper",["require","exports","../components/Share.resx","../utilities/ClientIdHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e.getAttachAsCopyOptions=function(e,t,i,s){var o=[],u=(function(e,t,i,s){var o=!1,u=i.name.split("."),a="";u.length>1&&(a=u[1].toLowerCase());try{var f=window.external;o=f.IsSendCopyEnabled()}catch(e){}if(!o)return;var l=function(){(function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t);try{window.external.SendCopy()}catch(e){}})(e,s)};return r.isWord(t)||(function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1})(a)?{key:"word",name:n.default.wordDocument,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:l}:r.isPowerPoint(t)||(function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1})(a)?{key:"powerpoint",name:n.default.powerPointPresentation,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:l}:r.isExcel(t)||(function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1})(a)?{key:"excel",name:n.default.excelWorkbook,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:l}:r.isVisio(t)||(function(e){return["vsd","vsdx"].indexOf(e)>-1})(a)?{key:"visio",name:n.default.visioDrawing,iconProps:{iconName:"VisioLogo"},onClick:l}:{key:"document",name:n.default.document,iconProps:{iconName:"Document"},onClick:l}})(i,e,t,s);u&&o.push(u);var a=(function(e,t){var r=!1;try{var i=window.external;r=i.IsSendPdfEnabled()}catch(e){}if(!r)return;return{key:"pdf",name:n.default.pdf,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){(function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t);try{window.external.SendPdf()}catch(e){}})(e,t)}}})(i,s);a&&o.push(a);return o}})(i||(i={}));t.default=i});
define("@ms/odsp-shared-sharing/lib/components/SharePolicyDetails/SharePolicyDetails",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../Header/Header","@ms/odsp-shared-react/lib/PolicyTip","react","prop-types","../Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;1===e?i._store.updatePolicy(0):2===e&&i.setState(n.__assign(n.__assign({},i.state),{showJustificationInput:!0}))};i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(0,e)};i._onReportClicked=function(){i._store.updatePolicy(1)};i._store=r.sharingStore;i._resize=r.resize;i.state={showJustificationInput:!1};return i}t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return o.createElement("div",{className:"od-SharePolicyDetails"},o.createElement(i.Header,{clientId:e.clientId,item:e.sharingInformation.item,viewState:6,hasBackButton:!0}),o.createElement("div",{className:"od-Share-PolicyTip"},o.createElement(s.PolicyTip,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?2===n.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:a.default.ptHeader,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?a.default.ptLastScanned+": "+r.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:e?a.default.ptLearnMoreActionLabel:void 0,learnMoreLabel:e?a.default.ptLearnMoreLabel:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:a.default.ptNoPolicyTipInfo,overrideActionLabel:t?a.default.ptOverrideActionLabel:void 0,overrideLabel:a.default.ptOverrideLabel,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:a.default.ptReportActionLabel,reportLabel:a.default.ptReportLabel,reportInProgressLabel:a.default.ptReportInProgress,submitButtonLabel:a.default.ptSubmitLabel,titleText:void 0}};t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?a.default.ptReportConfirmation:2===e||3===e?a.default.ptOverrideConfirmation:""};t.contextTypes={sharingStore:u.object.isRequired,resize:u.func.isRequired};return t})(o.Component);t.SharePolicyDetails=f});
define("@ms/odsp-shared-react/lib/PolicyTip",["require","exports","tslib","./components/PolicyTip/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PolicyTip/index",["require","exports","tslib","./PolicyTip"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PolicyTip/PolicyTip",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/TextField","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Icon","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onReportClicked=function(){r.setState(n.__assign(n.__assign({},r.state),{isLoading:!0,reportButtonClicked:!0}),function(){r.props.onReportClicked()})};r._onOverrideClicked=function(){r.setState(n.__assign(n.__assign({},r.state),{overrideButtonClicked:!0}),function(){r.props.onOverrideClicked()})};r._onOverrideSubmitClicked=function(){r.setState(n.__assign(n.__assign({},r.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){r.props.onOverrideSubmitClicked(r.state.justificationText)})};r._onJustificationChanged=function(e,t){r.props.overrideRequiresJustification&&r.setState(n.__assign(n.__assign({},r.state),{justificationText:t||"",overrideSubmitDisabled:!t}))};r.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(n.__assign(n.__assign({},this.state),{isLoading:!1}))};t.prototype.componentWillUnmount=function(){this.props.onDismissed()};t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?u.createElement("div",{className:"od-PolicyTip-container"},u.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):u.createElement("div",{className:"od-PolicyTip-container"},u.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),u.createElement("div",{className:"od-PolicyTip-header"},u.createElement(f.Icon,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),u.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),u.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),u.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return u.createElement("div",null,u.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,r=this.props.strings.issues;n<r.length;n++){var i=r[n];e.push(u.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e};t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=u.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=a.formatToArray(e.learnMoreLabel,t);return u.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}};t.prototype._getAction=function(e,t,n,r){if(n)return u.createElement("div",{className:"od-PolicyTip-action"},u.createElement("span",null,""+a.format(e,t)));var i=u.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),s=a.formatToArray(e,i);return u.createElement("div",{className:"od-PolicyTip-action"},s)};t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,r=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(i);if(n.overrideActionLabel){var s=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(s)}return r};t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?u.createElement("div",{className:"od-PolicyTip-status"},u.createElement(s.Spinner,null),u.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?u.createElement("div",{className:"od-PolicyTip-status"},u.createElement(f.Icon,{iconName:"CheckMark"}),u.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return u.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},u.createElement(o.TextField,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&u.createElement(i.PrimaryButton,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};return t})(r.BaseComponent);t.PolicyTip=l});
define("@ms/odsp-shared-sharing/lib/components/AtMention/AtMention",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","../Header/Header","office-ui-fabric-react/lib/MessageBar","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","../Share.resx","../../utilities/ClientIdHelper","react","prop-types","../../utilities/ShareCommunicationManager","../../utilities/SharingFeatures","../../utilities/UiUtils","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShareClicked=function(){i.setState({isSharing:!0},function(){i._store.getEngagementHelper().shareCompleted({clientId:i.props.clientId,scenarioId:i.props.scenarioId,mode:r.Mode.atMention});i._store.grantAccess(i.props.recipients)})};i._onOkayClicked=function(){i._notifyGrantAccessCompleted(!1);i._dismiss()};i._dismiss=n.onDismiss;i._resize=n.resize;i._store=n.sharingStore;i._platformDetection=n.platformDetection;i._shareClickTime=n.shareClickTime;var s=0===t.recipients.length;s||i._notifyReady();i.state={canShare:i._canShare(t.recipients),isLoading:s,isSharing:!1};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};t.prototype.componentDidUpdate=function(){setTimeout(this._resize,10)};t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients();this._store.addListener(function(){var t=e._store.getGrantAccessResult();if(null!==t){e._notifyGrantAccessCompleted(t);v.atMentionCallbackEnabled()&&e.props.onComplete&&e.props.onComplete(!!t);e._dismiss()}})};t.prototype.render=function(){var e,t=this.state,n=t.canShare,i=t.isLoading,o=t.isSharing;e=i?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath();return h.createElement("div",{className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!i&&h.createElement(s.Header,{mode:r.Mode.atMention,viewState:5,clientId:this.props.clientId}),e,this._renderSharingActivityIndicator(),m.renderScreenReaderOnlyAlert(this._getScreenReaderAlertMessage(),"assertive","alert"))};t.prototype._renderLoadingSpinner=function(){return h.createElement("div",{className:"od-AtMention-spinnerHolder"},h.createElement(f.Spinner,{className:"od-AtMention-spinner",label:l.default.componentLoading,type:f.SpinnerType.large}))};t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return h.createElement(i.ActivityIndicator,{message:l.default.grantAccessActivityIndicatorString})};t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=c.isOneNote(this.props.clientId)?l.default.atMentionHappyMessageOneNote:l.default.atMentionHappyMessage;return h.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),h.createElement("div",{className:"od-AtMention-message"},t),h.createElement(a.PrimaryButton,{autoFocus:!0,className:e,onClick:this._onShareClicked},l.default.shareAndNotifyButtonLabel))};t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return h.createElement("div",{className:"od-AtMention-container"},h.createElement(o.MessageBar,{messageBarType:o.MessageBarType.warning},this._getSadMessage()),this._renderRecipients(!0),h.createElement(a.PrimaryButton,{autoFocus:!0,className:e,onClick:this._onOkayClicked},l.default.okayButtonLabel))};t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e);return h.createElement("li",null,h.createElement(u.Persona,{className:"od-AtMention-recipient "+(n?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:u.PersonaSize.extraSmall}))});return h.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":l.default.grantAccessRecipientsListLabel},n)};t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?l.default.grantAccessActivityIndicatorString:l.default.grantAccessPageLabel};t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&(!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};t.prototype._notifyReady=function(){d.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.atMention,this.props.scenarioId)};t.prototype._notifyReadyForRecipients=function(){d.readyForRecipients()};t.prototype._notifyGrantAccessCompleted=function(e){d.grantAccessCompleted(e)};t.prototype._getSadMessage=function(){if(this._store.isConsumer())return l.default.atMentionUnresolvedErrorODC;var e=this.props.sharingInformation,t=c.isOneNote(this.props.clientId)?l.default.atMentionSadMessageOwnerOneNote:l.default.atMentionSadMessageOwner;return e.canManagePermissions&&e.canAddInternalPrincipal?l.default.atMentionSadMessageRecipient:t};t.contextTypes={onDismiss:p.func.isRequired,resize:p.func.isRequired,sharingStore:p.object.isRequired,platformDetection:p.object.isRequired,shareClickTime:p.number};return t})(h.Component);t.AtMention=g});
define("@ms/odsp-shared-sharing/lib/components/Notify/Notify",["require","exports","tslib","react","prop-types","../../interfaces/SharingInterfaces","../ShareNotification/ShareNotification","../Header/Header","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Button","../Share.resx","../PeoplePickerWrapper/PeoplePickerWrapper","../../utilities/PeoplePickerHelper","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Link","./NotifyGroupRecipient","./NotifyPersonRecipient","../SendButton/SendButton","../../utilities/ShareHelper","../SendButton/SendButtonType","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/MessageBar","../../utilities/ResizeTracker","../../utilities/SharingFeatures","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=(function(e){n.__extends(t,e);function t(t,i){var o=e.call(this,t)||this;o._topLevelDivRef=r.createRef();o._onExpandClick=function(){o.setState(function(e){return n.__assign(n.__assign({},e),{isExpanded:!e.isExpanded})},function(){o._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",o.props.engagementExtraData)})};o._onStoreUpdate=function(){var e=o._sharingStore.getPermissionsMap(),t=h.renderPickerError({selectedItems:o.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:o.props.sharingInformation.canAddExternalPrincipal,sharingInformation:o.props.sharingInformation,viewPolicyTipCallback:o._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&o._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",o.props.engagementExtraData);e=n.__assign(n.__assign({},o.state.permissionsMap),e);o.setState(function(r){return n.__assign(n.__assign({},r),{peoplePickerError:t,permissionsMap:e})})};o._onPeoplePickerSelected=function(e){o._sharingStore.checkPermissions(e);e.filter(function(e){return e.principalType!==p.default.user}).forEach(function(e){o._sharingStore.fetchMemberCount(e)});o._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",o.props.engagementExtraData);var t=o._sharingStore.getPermissionsMap(),r=h.renderPickerError({selectedItems:o.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:o.props.sharingInformation.canAddExternalPrincipal,sharingInformation:o.props.sharingInformation,viewPolicyTipCallback:o._sharingStore.getPolicyTipInformation,permissionsMap:t});t=n.__assign(n.__assign({},o.state.permissionsMap),t);o.setState(function(i){return n.__assign(n.__assign({},i),{peoplePickerRecipients:e,peoplePickerError:r,permissionsMap:t})},function(){o._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestionSelected(o.props.engagementExtraData,e)})};o._onResolvedSuggestions=function(e){o._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(o.props.engagementExtraData,e);return e};o._updateGroupCount=function(){for(var e=o._sharingStore.getMembersCounts(),t=o.state.groups.slice(0),r=0;r<t.length;r++){var i=o.state.groups[r];if(e[i.email]!==i.memberCount){i.memberCount=e[i.email];i.checked=!1;i.disabled=i.memberCount>=100;t[r]=i}}o.setState(function(e){return n.__assign(n.__assign({},e),{groups:t})})};o._updateCheckboxForGroup=function(e){var t=o.state.groups;t.map(function(t){return t.email===e.email?e:t});o.setState({groups:t})};o._updateCheckboxForPerson=function(e){var t=o.state.people;t.map(function(t){return t.email===e.email?e:t});o.setState({people:t})};o._sendNotification=function(){var e=o._allRecipients();o.setState({showActivityIndicator:!0},function(){x.sendLinkClicked();o._sharingStore.shareLink({settings:o.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0});o._sharingStore.getEngagementHelper().shareCompleted(n.__assign(n.__assign({},o.props.engagementExtraData),{recipientsCount:e.length}));x.shareCompleted(s.ShareType.share);o._showSuccessMessage()})};o._onGroupsExpandClick=function(){var e=o.state.groupsIsExpanded;o.setState(function(t){return n.__assign(n.__assign({},t),{groupsIsExpanded:!e})},function(){o._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",o.props.engagementExtraData)})};o._selectAllPeopleCheckbox=function(e,t){var n=o.state.people;n.map(function(e){e.checked=t;return e});o.setState({people:n})};o._sharingStore=i.sharingStore;o._shareClickTime=i.shareClickTime;o._resize=i.resize;o.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:9};k.genericResizeTracker()&&(o._resizeTracker=new C.ResizeTracker(i.resize));return o}t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var r=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(r).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),s=i.filter(function(e){return e.principalType!==p.default.user}).map(function(e){return n.__assign(n.__assign({},e),{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});s.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===p.default.user}),u={};o.concat(s).forEach(function(e){u[e.email]=3});this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==p.default.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)});this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:s,people:o,peoplePickerError:null,permissionsMap:u,viewState:9})};t.prototype.componentDidMount=function(){x.pageFinishedLoading(this._shareClickTime,this.props.clientId,s.Mode.notify,this.props.scenarioId);this.setState({groupsIsExpanded:!1,isExpanded:!1});k.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){k.genericResizeTracker()?this._resizeIfNeeded():this._resize()};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return r.createElement("div",{className:v.css("od-Notify-PeoplePicker")},r.createElement(c.default,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))};t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)};t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)});return Object.keys(t).map(function(n){return t[n].principalType===p.default.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)};t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))};t.prototype._showSuccessMessage=function(){this.setState(function(e){return n.__assign(n.__assign({},e),{viewState:4,showActivityIndicator:!1})})};t.prototype._renderGroup=function(e){return r.createElement(y.NotifyGroupRecipient,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderGroups=function(e){var t=this,n=this.state,i=n.groupsIsExpanded?" expanded ":"",s=n.groups.length>5?" scroll ":"";if(0!==e.length)return r.createElement("div",{className:v.css("od-Notify-groups-container")},r.createElement("div",{className:v.css("od-Notify-groups-expand")},r.createElement(m.Label,{className:v.css("od-Notify-groupLabel")},l.default.notifyGroupsLabel),r.createElement(f.IconButton,{className:"od-Notify-group-expand-icon",iconProps:{iconName:i?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),r.createElement("div",{className:v.css("od-Notify-groups-recipient-container"+i+s)},i&&e.map(function(e){return r.createElement("div",{key:e.email,className:v.css("od-Notify-groups-listItem")},t._renderGroup(e))})))};t.prototype._renderPerson=function(e){return r.createElement(b.NotifyPersonRecipient,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderPeople=function(e){var t=this,n=this.state,i=n.people.length>5?" scroll ":"";return r.createElement("div",{className:v.css("od-Notify-people-container")},r.createElement(m.Label,{className:v.css("od-Notify-peopleLabel")},l.default.notifyPeopleLabel),n.people.length>0&&r.createElement(T.Checkbox,{label:l.default.notifySelectAllPeople,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:v.css("od-Notify-people-selectAll-checkbox")}),r.createElement("div",{className:v.css("od-Notify-people-recipient-container"+i)},e.map(function(e){return t._renderPerson(e)})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return r.createElement(a.ActivityIndicator,{message:l.default.activityMessageSendingMail})};t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,i={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return r.createElement(o.ShareNotification,{shareType:s.ShareType.share,itemName:t.item.name,linkUrl:null,clientId:this.props.clientId,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})};t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?d.format(l.default.notifyMembersTotalPlus,e):1===e?d.format(l.default.notifyMemberTotal):0===e?"":d.format(l.default.notifyMembersTotal,e)};t.prototype._tooManyRecipientsErrorString=function(){return l.default.peoplePickerLimitMessage};t.prototype._displayTotalMembersCountOrError=function(){return r.createElement(m.Label,{className:v.css("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=100?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())};t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":d.format(l.default.notifyGroupsMembersTotalPlus,e)};t.prototype._displayTotalGroupsMembersCount=function(){return r.createElement(m.Label,{className:v.css("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())};t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=d.format(l.default.notifyLargeRecipientWarning,e);return e>20&&e<100&&r.createElement("div",{className:"od-Notify-recipientWarning-container"},r.createElement(N.MessageBar,{className:v.css("od-Notify-recipientWarning"),messageBarType:N.MessageBarType.severeWarning,isMultiline:!0},t))};t.prototype._sendButtonError=function(){return r.createElement(m.Label,null,l.default.notifySendButtonError)};t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",i=E.truncateItemNameForShareNotification(this.props.sharingInformation.item.name,10);return r.createElement("div",{className:"od-Notify"+n},r.createElement("div",{className:"od-Notify-headerAndMessage"},r.createElement(u.Header,{clientId:t.clientId,viewState:9}),r.createElement(m.Label,{className:v.css("od-Notify-message")},d.format(l.default.notifyMessage,i))),this._renderWarning(),!e.isExpanded&&r.createElement("div",null,r.createElement("div",{className:v.css("od-Notify-horizontalLine")}),r.createElement(g.Link,{onClick:this._onExpandClick,className:v.css("od-Notify-show-link")},l.default.sendNotifyLinkExpandLink)),e.isExpanded&&r.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),r.createElement("div",{className:v.css("od-Notify-sendNotification-button")},r.createElement(w.default,{ctaLabel:l.default.sendNotifyLinkButton,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=100?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:S.default.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))};t.prototype._renderViews=function(){switch(this.state.viewState){case 4:return this._renderNotification();default:return this._renderNotifyMain()}};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return r.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())};t.contextTypes={resize:i.func.isRequired,strings:i.object.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t})(r.Component);t.Notify=L});
define("@ms/odsp-shared-sharing/lib/components/Notify/NotifyGroupRecipient",["require","exports","tslib","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Utilities","react","prop-types","../Share.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.group;n.checked=t;r.setState({group:n},function(){r._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",r.props.engagementExtraData);r.props.updateCountCallback();r.props.updateCheckboxForGroup(n)})};r._sharingStore=n.sharingStore;r.state={group:t.group};return r}t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)};t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)};t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return o.createElement(r.Checkbox,{id:e.email,boxSide:"start",label:t?e.name+" ("+a.default.notifyGroupReachedAllowedLimit+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:s.css("od-Notify-group-checkbox"),disabled:e.disabled})};t.prototype.render=function(){var e=this.state.group,t=e.disabled;return o.createElement(i.TooltipHost,{className:s.css("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+a.default.notifyGroupReachedAllowedLimit+")":e.name,directionalHint:i.DirectionalHint.bottomCenter},this._renderGroup())};t.contextTypes={sharingStore:u.object.isRequired,strings:u.object.isRequired};return t})(o.Component);t.NotifyGroupRecipient=f});
define("@ms/odsp-shared-sharing/lib/components/Notify/NotifyPersonRecipient",["require","exports","tslib","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Utilities","react","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.person;n.checked=t;r.setState({person:n});r.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",r.props.engagementExtraData);r.props.updateCheckboxForPerson(n)};r.state={person:t.person};return r}t.prototype.render=function(){var e=this.state.person;return o.createElement("div",{className:s.css("od-Notify-PickerPersona-container")},o.createElement(i.Persona,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:i.PersonaSize.extraSmall,className:s.css("od-Notify-PickerPersona")}),o.createElement(r.Checkbox,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:s.css("od-Notify-PickerPersona-checkbox")}))};t.contextTypes={sharingStore:u.object.isRequired,strings:u.object.isRequired};return t})(o.Component);t.NotifyPersonRecipient=a});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/AddPeople",["require","exports","tslib","../../interfaces/SharingInterfaces","react","./EditView/EditView","../Share.resx","../../components/ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","../Header/Header","../../utilities/ShareCommunicationManager","../../utilities/SharingFeatures","prop-types","../../utilities/ResizeTracker","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v;(function(e){e[e.edit=0]="edit";e[e.successGrantingPermissions=1]="successGrantingPermissions";e[e.successRequestingPermissions=2]="successRequestingPermissions";e[e.failure=3]="failure";e[e.notAllowed=4]="notAllowed"})(v=t.AddPeopleView||(t.AddPeopleView={}));var m=(function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t)||this;s._topLevelDivRef=i.createRef();s._onLoading=function(e){s.setState(function(t,r){if(t.view===v.edit){var i=void 0;i=e.requestedAccess?o.default.activityRequestingAccess:e.notifiedRecipients?o.default.activityAddingAndNotifying:o.default.activityAdding;return n.__assign(n.__assign({},t),{loading:!0,message:i})}return t})};s._onSuccess=function(e){var t,n;if(e.requestedAccess){t=o.default.accessRequested;n=v.successRequestingPermissions}else{t=e.notifiedRecipients?o.default.addedAndNotified:o.default.added;n=v.successGrantingPermissions}s.setState({view:n,message:t,loading:!1})};s._onFailure=function(e){!h.requestAccessChangesInAddPeopleMode()&&e.requestedAccess?s.setState({view:v.successRequestingPermissions,message:o.default.accessRequested,loading:!1}):s.setState({view:v.failure,message:o.default.addFailed,loading:!1})};s._shareClickTime=r.shareClickTime;s._resize=r.resize;s._dismiss=r.onDismiss;var u=!1===t.sharingInformation.canAddExternalPrincipal&&!1===t.sharingInformation.canAddInternalPrincipal&&!1===t.sharingInformation.canRequestAccessForGrantAccess;s.state={message:"",view:u?v.notAllowed:v.edit,loading:!1};h.genericResizeTracker()&&(s._resizeTracker=new d.ResizeTracker(r.resize));return s}t.prototype.componentDidMount=function(){c.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.addPeople,"");h.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){h.genericResizeTracker()?this._resizeIfNeeded():this._resize()};t.prototype.render=function(){var e=this.state.loading?" blocker":"";return i.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople"+e},this.renderView(),this.state.loading?i.createElement(u.ActivityIndicator,{message:this.state.message}):null)};t.prototype.renderView=function(){switch(this.state.view){case v.edit:return i.createElement(s.EditView,{sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked,onManageExistingAccessClick:this.props.onManageExistingAccessClick});case v.successGrantingPermissions:return this._renderSuccessGranting();case v.successRequestingPermissions:return this._renderSuccessRequesting();case v.failure:return this._renderFailure();case v.notAllowed:return this._renderNotAllowed()}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderSuccessGranting=function(){return i.createElement("div",{className:"od-AddPeople-Success"},i.createElement(l.Header,{clientId:this.props.clientId,viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick}),i.createElement(a.Icon,{className:"od-ShareNotification-icon",iconName:"CheckMark"}),i.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),i.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderSuccessRequesting=function(){return i.createElement("div",{className:"od-AddPeople-Success"},i.createElement(l.Header,{clientId:this.props.clientId,viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick}),i.createElement(a.Icon,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),i.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),i.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderFailure=function(){return i.createElement("div",{className:"od-AddPeople-Failure"},i.createElement(l.Header,{clientId:this.props.clientId,viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick}),i.createElement("p",null,this.state.message))};t.prototype._renderNotAllowed=function(){var e=this;return i.createElement(i.Fragment,null,i.createElement(l.Header,{clientId:this.props.clientId,hideShareDialogOverflowButton:!0,title:o.default.needPermissionToShare,onManageExistingAccessClick:this.props.onManageExistingAccessClick}),i.createElement("div",{className:"od-AddPeople-NotAllowed"},i.createElement("p",null,o.default.needPermissionToShareListText1),i.createElement("p",null,o.default.needPermissionToShareListText2),i.createElement(f.PrimaryButton,{autoFocus:!0,onClick:function(){e._dismiss()}},o.default.okayButtonLabel)))};t.contextTypes={shareClickTime:p.number,resize:p.func.isRequired,onDismiss:p.func.isRequired};return t})(i.Component);t.AddPeople=m});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/EditView/EditView",["require","exports","tslib","../../Header/Header","office-ui-fabric-react/lib/Button","react","../../Share.resx","../../PeoplePickerWrapper/PeoplePickerWrapper","../../RoleSelector/RoleSelector","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/MessageBar","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Checkbox","prop-types","../../../utilities/PeoplePickerHelper","@ms/odsp-datasources/lib/interfaces/sharing/enums/SPSharedObjectType","../../../utilities/SharingFeatures","../../../interfaces/ISharingStore","../../../utilities/ResizeTracker","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t,r){var i,u=e.call(this,t)||this;u._peoplePickerHasUnresolvedText=!1;u._topLevelDivRef=s.createRef();u._onPeoplePickerChange=function(e){u.setState(function(t,r){var i=f.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:r.sharingInformation.canAddExternalPrincipal,sharingInformation:r.sharingInformation,viewPolicyTipCallback:function(){return null}}),s=u.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return n.__assign(n.__assign({},t),{people:e,notifyRecipients:s,errorMessage:i})})};u._onPeoplePickerInputChange=function(e){u._peoplePickerHasUnresolvedText=""!==e};u._onMessageChange=function(e,t){u.setState({messageText:t})};u._onRoleSelectorChange=function(e){u.setState({roleSelection:e})};u._onAllowEditChange=function(e,t){u.setState({notifyRecipients:t})};u._onAddButtonClick=function(){if(u._peoplePickerHasUnresolvedText)u.setState(n.__assign(n.__assign({},u.state),{errorMessage:s.createElement("span",null,o.default.unresolvedTextError)}));else{var e=u.state.messageText||null;u._store.addPeople(u.state.people,u.state.roleSelection,u.userRequiresAccessApproval(),u.state.notifyRecipients,e);u.props.onLoading&&u.props.onLoading({notifiedRecipients:u.state.notifyRecipients,requestedAccess:u.userRequiresAccessApproval()})}};u._store=r.sharingStore;u._resize=r.resize;u._store.addListener(function(){var e=u._store.getAddPeopleResult();if(null!==e){var t=m.requestAccessChangesInAddPeopleMode(),n=t?e===g.AddPeopleResult.AccessRequestsQueued||e===g.AddPeopleResult.CompletedSuccessfully:!0===e,r=t?u.userRequiresAccessApproval():e===g.AddPeopleResult.AccessRequestsQueued;n&&u.props.onSuccess?u.props.onSuccess({notifiedRecipients:u.state.notifyRecipients,requestedAccess:r}):u.props.onFailure&&u.props.onFailure({notifiedRecipients:u.state.notifyRecipients,requestedAccess:r})}});i=3===u.props.sharingInformation.userRole?2:u.props.sharingInformation.userRole;var a=f.renderPickerError({selectedItems:u.props.currentSettings.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:u.props.sharingInformation.canAddExternalPrincipal,sharingInformation:u.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});u.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,errorMessage:a};m.genericResizeTracker()&&(u._resizeTracker=new y.ResizeTracker(r.resize));return u}t.prototype.componentDidMount=function(){m.genericResizeTracker()&&this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){m.genericResizeTracker()?this._resizeIfNeeded():this._resize()};t.prototype.render=function(){return s.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople-Edit"},s.createElement("div",{className:"od-AddPeople-Edit-Header"},this._renderHeader()),s.createElement("div",{className:"od-AddPeople-Edit-Section"},m.requestAccessChangesInAddPeopleMode()&&this.userRequiresAccessApproval()&&this._renderRequestAccessAlert(),this._renderPeoplePicker(),this._renderRoleSelector(),this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.errorMessage};t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval};t.prototype.numberSelectedUnverifiedExternals=function(){return this.state.people.filter(function(e){return d.isUnvalidatedEmailAddress(e)}).length};t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=f.getOversharingExternalsWarning(e),n=f.getOversharingGroupsWarning(e,0);return s.createElement("div",{className:"od-Share-PeoplePicker"},s.createElement(u.default,{defaultSelectedItems:this.state.people,error:this.state.errorMessage,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:1,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:null,onInputChange:this._onPeoplePickerInputChange}))};t.prototype._renderHeader=function(){return s.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,hideShareDialogOverflowButton:!this.props.onManageExistingAccessClick,onManageExistingAccessClick:this.props.onManageExistingAccessClick,viewState:10})};t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return s.createElement(c.TextField,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:o.default.messagePlaceholder,value:this.state.messageText,ariaLabel:o.default.messageAriaLabel,multiline:!0,resizable:!1,onChange:this._onMessageChange})};t.prototype._renderRoleSelector=function(){var e=this.props.sharingInformation,t=m.fullControlRoleForSharingLists()&&e.sharedObjectType===v.SPSharedObjectType.list;return s.createElement("div",{className:"od-AddPeople-RoleSelector"},s.createElement(a.RoleSelector,{onRoleChange:this._onRoleSelectorChange,role:this.state.roleSelection,ariaLabel:o.default.addPeopleRoleSelectorAriaLabel,item:this.props.sharingInformation.item,showReview:!1,showFullControl:t,isListSharing:this.props.sharingInformation.sharedObjectType===v.SPSharedObjectType.list}))};t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return s.createElement(h.Checkbox,{className:"od-AddPeople-NotificationSelector",disabled:e,label:o.default.notifyPeople,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients})};t.prototype._renderAddButton=function(){var e=o.default.addButtonLabel;return s.createElement(i.PrimaryButton,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton"},e)};t.prototype._renderRequestAccessAlert=function(){return s.createElement(l.MessageBar,{className:"od-AddPeople-Edit-Section-PermissionAlert"},o.default.requestAccessDetail)};t.contextTypes={sharingStore:p.object.isRequired,resize:p.func.isRequired};return t})(s.Component);t.EditView=b});
define("@ms/odsp-shared-sharing/lib/interfaces/ISharingStore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully";e[e.AccessRequestsQueued=1]="AccessRequestsQueued";e[e.Error=2]="Error"})(t.AddPeopleResult||(t.AddPeopleResult={}))});
define("@ms/odsp-shared-sharing/lib/components/Error/Error",["require","exports","tslib","office-ui-fabric-react/lib/Icon","react","react","../Share.resx","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/clipboard/CopyHelper","prop-types","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._errorMessage=s.createRef();r._onToggleDetailsClicked=function(){r.setState({areDetailsVisible:!r.state.areDetailsVisible})};r._onCopyToClipboardClicked=function(){a.copyToClipboard(r.props.sharingInformation.debugErrorMessage||"")};r._resize=n.resize;r.state={areDetailsVisible:!1};return r}t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus();this._resize()};t.prototype.render=function(){var e=o.default,t=this.state.areDetailsVisible&&this.props.sharingInformation.debugErrorMessage?i.createElement("div",{className:"od-Share-error-technical"},i.createElement("h4",null," ",e.errorTechnicalDetails," "),i.createElement("div",null,this.props.sharingInformation.debugErrorMessage),i.createElement(u.Button,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},e.errorCopyTechnicalDetails),i.createElement("span",{className:"od-Share-error-clear"})):null,n=this.props.showReportProblem?i.createElement("div",{className:"od-Share-error-report"},e.errorReportProblem):null,s=this.props.sharingInformation.debugErrorMessage?i.createElement("div",{className:"od-Share-error-details",onClick:this._onToggleDetailsClicked},this.state.areDetailsVisible?e.errorHideDetails:e.errorShowDetails,i.createElement(r.Icon,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;return i.createElement("div",{className:"od-Share-error",role:"alert",tabIndex:0,ref:this._errorMessage},i.createElement("h2",null," ",e.errorTitle," "),i.createElement("div",{className:"od-Share-error-message"},i.createElement("p",null," ",this.props.sharingInformation.errorMessage," "),this.props.sharingInformation.fixItUrl&&i.createElement("a",{href:this.props.sharingInformation.fixItUrl,target:"_blank"},o.default.fixIt),t),i.createElement("div",null,s,n))};t.contextTypes={resize:f.func.isRequired};return t})(i.Component);t.Error=l});
define("@ms/odsp-utilities/lib/clipboard/CopyHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToClipboard=function(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}});
define("@ms/odsp-shared-sharing/lib/interfaces/IPersonEx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Family=0]="Family";e[e.FamilyMember=1]="FamilyMember"})(t.FamilySharingTargetType||(t.FamilySharingTargetType={}))});
define("@ms/odsp-shared-sharing/lib/utilities/EngagementHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","../interfaces/SharingInterfaces","./PeoplePickerHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.Opening="Opening";e.Opened="Opened"})(t.SharingEngagementEvents||(t.SharingEngagementEvents={}));var o=(function(){function e(e){this._manager=e}e.prototype.linkSettingsOpened=function(e){this.log("LinkSettings.Opened",e)};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.shareCompleted=function(e){this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.shareTargets=function(e){this.log("ShareTargets",e)};e.prototype.trackClickThru=function(e){this.log("ClickThruTracker",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.peoplePickerLinkedinSuggestionSelected=function(e,t){this.log("PeoplePicker.SuggestionSelected",n.__assign(n.__assign({},e),{linkedinSuggestionsSelectedCount:s.getLinkedInPeopleCount(t)}))};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",n.__assign(n.__assign({},e),{linkedinSuggestionsCount:s.getLinkedInPeopleCount(t)}))};e.prototype.log=function(e,t){var s=n.__assign(n.__assign({},t),{clientId:i.ClientId[t.clientId],scenarioId:t.scenarioId,mode:i.Mode[t.mode],shareType:i.ShareType[t.shareType],audience:i.SharingAudience[t.audience],shareTargets:this._getFriendlyShareTargets(t.shareTargets)}),o={name:"ShareV3."+e,webTemplateId:t.webTemplateId?t.webTemplateId.toString():void 0,docId:t.itemUniqueId,extraData:s};(this._manager?r.Engagement.withManager(this._manager):r.Engagement).logData(o)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var s=r[n];t.push(i.ShareType[s])}return t};return e})();t.EngagementHelper=o});
define("odsp-next/controls/sharing/share/react/Share",["require","exports","tslib","prop-types","@ms/odsp-shared-sharing/lib/components/Share/index","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","react","@ms/odsp-utilities/lib/icons/ItemType","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-utilities/lib/browser/ResponsiveUI","office-ui-fabric-react/lib/FocusTrapZone","../../../../controls/sharing/shareByEmail/Sharing.resx","@ms/odsp-shared-sharing/lib/utilities/ClientIdHelper","@ms/odsp-utilities/lib/string/StringHelper","es6-promise/auto"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._resize=function(){var e=n._share.current;if(e){n._onResize&&n._onResize();var t=n._maxHeight,r=e.clientHeight>t?t:e.clientHeight,i=e.clientWidth;if(r>0&&i>0)try{window.external.Resize(i,r)}catch(e){var s={name:"share_resize",width:i,height:r};window.parent.postMessage(JSON.stringify(s),"*")}}};n._dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};var r=window._sharingContextInfo;n._copyLinkShortcut=t.copyLinkShortcut;n._onDismiss=t.onDismiss;n._dismissed=!1;n._shareDismissEnabled=!s.Killswitch.isActivated("7541C104-321A-49F2-8350-DC1343D6F61B","5/16/2019","Fix share command refresh bug");n._onResize=t.onResize;n._peoplePickerProvider=t.peoplePickerProvider;n._mode=t.mode||(n._copyLinkShortcut?o.Mode.copy:o.Mode.share);n._messageText=t.messageText;n._sharingStore=t.sharingStore;n._premiumLearnMore=t.premiumLearnMore;n._goPremium=t.goPremium;n._platformDetection=new f.default;n._breakpoint=l.default.DEFAULT_BREAKPOINTS[l.default.determineWindowSize(window.innerWidth)];n._share=u.createRef();if(!t.noMaxHeightRestriction){var i=n.props.maxHeight;n._maxHeight=i<650?i:650}r&&(n._hostSessionId=r.hostSessionId);var c=0,p=" ",v=" ",m=" ",g=0;if(t.item&&t.item.properties){var y=t.item.properties,b=y.ItemChildCount?parseInt(y.ItemChildCount,10):0,w=y.FolderChildCount?parseInt(y.FolderChildCount,10):0;c=t.item.type===a.default.OneNote?0:b+w;p=t.item.name;v=t.item.extension;m=t.item.appMap;g=t.item.type}else if(r){p=r.itemName||" ";c=r.itemCount||0;v=r.itemExtension;m=r.itemAppmap;g=r.itemType}t.items&&t.items.length>1&&(p=d.format(h.default.SharingBundleTempName,t.items.length));n._sharingItemInformation={name:p,childCount:c,hasDlpPolicy:void 0,extension:v,appmap:m,itemType:g};return n}t.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize,onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,platformDetection:this._platformDetection,breakpoint:this._breakpoint,premiumLearnMore:this._premiumLearnMore,goPremium:this._goPremium,shareClickTime:window._sharingStartTime||Date.now()}};t.prototype.render=function(){return this._sharingStore?u.createElement("div",{className:"od-share-v3",ref:this._share,role:"dialog","aria-label":h.default.ShareText},this._renderShareComponent()):null};t.prototype.componentWillUnmount=function(){this._shareDismissEnabled&&this._shareDismiss()};t.prototype._shareDismiss=function(){if(!this._dismissed&&this._onDismiss){this._dismissed=!0;this._onDismiss()}};t.prototype._renderShareComponent=function(){var e=this.props,t=u.createElement(i.Share,{copyLinkShortcut:this._copyLinkShortcut,shareId:e.shareId,theme:e.theme,clientId:e.clientId||e.sharingProvider.getClientId(),scenarioId:e.scenarioId||"",omitCustomLabeledAudience:e.omitCustomLabeledAudience,customLabeledAudienceConfig:e.customLabeledAudienceConfig,showExistingAccessOption:!!e.sharingProvider&&e.sharingProvider.supportsExistingAccessOption(e.item),onManageAccessClicked:e.onManageAccessClicked,hideShareDialogOverflowButton:e.hideShareDialogOverflowButton,maxHeight:this._maxHeight,maxWidth:this.props.maxWidth,mode:this._mode,messageText:this._messageText,useVroomCreateDefaultLink:this._mode===o.Mode.copy&&p.isTeams(e.clientId),sharingItemInformation:this._sharingItemInformation,hideElementsInManageAccess:this.props.hideElementsInManageAccess,shareCommandsExperiment:this.props.shareCommandsExperiment,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,invokeManageAccess:this.props.invokeManageAccess,hostSessionId:this._hostSessionId}),n=this._mode===o.Mode.share||this._mode===o.Mode.addPeople;return e.useFocusTrap?u.createElement(c.FocusTrapZone,{isClickableOutsideFocusTrap:!0,disableFirstFocus:n,forceFocusInsideTrap:!n},t):t};t.childContextTypes={peoplePickerProvider:r.object.isRequired,resize:r.func.isRequired,onDismiss:r.func,sharingStore:r.object.isRequired,platformDetection:r.object.isRequired,breakpoint:r.object.isRequired,premiumLearnMore:r.func,goPremium:r.func,shareClickTime:r.number};return t})(u.Component);t.default=v});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("es6-promise/auto",[],e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return"undefined"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H="undefined"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&"function"==typeof require?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype["finally"]=function(t){var e=this,n=e.constructor;return e.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it.polyfill(),it});
define("odsp-next/bindings/focus/AutoFocusBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.applyBindingsToNode,o=r.virtualElements,u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n,i=r.observables,u=r.bindingContext,a=r.element,f=(function(){var e=document.createElement("a");e.href="javascript:;";e.className="ms-accessible";e.setAttribute("role","presentation");return e})();o.prepend(a,f);i.backgroundCompute(function(){f.focus()});s(f,{},u);return n}t.supportsVirtualElements=!0;return t})(i.default);t.default=u});
define("odsp-next/providers/sharing/react/SharingStore",["require","exports","tslib","../../../providers/peoplePicker/PeoplePickerProvider","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","../../../providers/policyTip/PolicyTipProvider","@ms/odsp-shared-sharing/lib/store/odb/SharingStore"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.dependencies={sharingProvider:i.resourceKey,suiteNavProvider:s.resourceKey,peoplePickerProvider:r.resourceKey,policyTipProvider:o.resourceKey};return t})(u.default);t.default=a});
define("@ms/odsp-shared-sharing/lib/store/odb/SharingStore",["require","exports","tslib","../../interfaces/SharingInterfaces","../../interfaces/ISharingStore","../../interfaces/enums/OutlookAvailability","@ms/odsp-datasources/lib/Sharing","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/events/EventGroup","../../components/Share.resx","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/ShareHelper","@ms/odsp-datasources/lib/interfaces/sharing/enums/ClientId","@ms/odsp-utilities/lib/uri/SimpleUri","../../utilities/ClientIdHelper","../../utilities/EngagementHelper","@ms/odsp-datasources/lib/interfaces/sharing/enums/SPSharedObjectType","@ms/odsp-utilities/lib/icons/ItemType","../../utilities/FileExtensionHelper","../../utilities/SharingFeatures"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(){function e(e,t){var n=this;this._listeners=null;var r=e.item,i=e.sharingInformation,o=e.defaultRecipients,u=e.accessChecked,a=void 0===u||u,f=e.mode;this._item=r;this._mode=f;this._sharingContextInformation=e.sharingContextInformation;this._clientId=this._sharingContextInformation&&m.getClientId(this._sharingContextInformation.clientId);this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._substratePeoplePickerHelper=t.substratePeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value;this._sharingService=e.sharingService;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._engagementHelper=new b.EngagementHelper(e.telemetryManager);this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:this._sharingContextInformation&&this._sharingContextInformation.organizationName||h.default.companyNameFallback,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:s.default.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};if(o&&0!==o.length)this._resolveDefaultRecipients(o,a,f);else{this._eventGroup=new c.default(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var r=t.recipientIds;n._resolveDefaultRecipients(r,a,f)}}catch(e){}})}}e.prototype.isConsumer=function(){return!1};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getInitialLinkSettings=function(e){return null};e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return!p.Killswitch.isActivated("460d91d6-f963-47fa-9254-0a47f9989ffc","07/01/2020","Disabling Graph searching in SPO/ODB.")&&this._storeContents&&this._storeContents.sharingInformation&&this._storeContents.sharingInformation.enforceIBSegmentFiltering};e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1};e.prototype.showManageAccess=function(){return!0};e.prototype.fetchSharingInformation=function(e,t){var n=this;if(!this._storeContents.sharingInformation||this._sharingInformationInvalidated||e&&!this._storeContents.sharingInformation.hasPermissionsInformation||t){var r=(new Date).getTime(),i=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._getSharingInformationStats={name:"GetSharingInformation",resultType:d.ResultTypeEnum.Success,duration:(new Date).getTime()-r};if(!n._storeContents.sharingInformation||!n._storeContents.sharingInformation.error){n._storeContents.sharingInformation=e;n._fetchAdditionalAuthenticationTokens();n.fetchPolicyTipInformation();n._configureLinkIfShareId();n._emitChange()}},function(e){var t=5,i=e&&e.code,s=e&&e.status,o=h.default.getSharingInformationError,u=JSON.stringify(e||{});i?i.indexOf("-2147024809")>-1&&u&&u.indexOf("Item does not exist")>-1&&(t=3):s&&parseInt(s,10)>=500&&(t=2);n._getSharingInformationStats={name:"GetSharingInformation",resultType:d.ResultTypeEnum.Failure,duration:(new Date).getTime()-r,error:t};n._invokeShareStatsEvent();n._storeContents.sharingInformation={error:t,errorCategory:1,errorMessage:o,debugErrorMessage:u,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};n._emitChange()})}else{this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:d.ResultTypeEnum.Success,duration:0};this._configureLinkIfShareId();this._emitChange()}};e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var r=n.totalMemberCount;t._groupMembersCountHash[e.email]=r;t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null;t._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(e){var t=this,i=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;var s=e.settings,o=e.recipients,u=e.emailMessage,a=e.emailSubject,f=e.copyLinkCommand,c=e.allRecipientsHaveAccess,v=e.shareId,m=e.inviteesToRemove;if(e.copyLinkCommand&&y.isTeams(this._clientId)&&this._mode===r.Mode.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&i)this._getDefaultLink();else{var g=0,b=0,w=!1,E=(o=o||[]).map(function(e){1===e.entityType?b++:g++;e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(w=!0);return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});E=this._dedupeRecipients(E);if(!p.Killswitch.isActivated("88cc94ae-ba5f-4552-aea0-f5a00a24ff6b","01/02/2019","Ensure share link is called for manage access")&&(v&&v.length>0||s.shareId&&s.shareId.length>0))this._shareLink(s,E,u,a,f,i,v,m);else{if((p.Killswitch.isActivated("099614d2-0712-466a-be0f-c1f1ec2ee793","08/13/2019","fix sharing to new external users incident")?this.isPeopleSharingLinksEnabled()&&s.audience!==r.SharingAudience.existing:this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!w)&&s.audience!==r.SharingAudience.existing)&&!this._storeContents.sharingInformation.requiresAccessApproval)this._shareLink(s,E,u,a,f,i,v,m);else if(1!==s.sharingLinkKind&&6!==s.sharingLinkKind)this._shareLink(s,E,u,a,f,i,v,m);else{var S=void 0;S=s.sharingRole?this._getRoleString(s.sharingRole):this._getRoleValue(s.isEdit);var x={items:[this._item],roleValue:S,sendEmail:void 0!==u,message:u,subject:a,requireSignIn:!0,propagateSharing:!0},T=this._storeContents.sharingInformation.directLink;if(0===o.length||s.audience==r.SharingAudience.existing&&(this._mode===r.Mode.copy||this._mode==r.Mode.linkSettings)){this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:d.ResultTypeEnum.Success});this._handleSharedLink(T,f)}else{for(var N=!0,C=0,k=o;C<k.length;C++){var L=k[C];3!==this._storeContents.permissionsMap[L.email]&&3!==this._storeContents.permissionsMap[L.userId]&&(N=!1)}if(N||c){var A=(new Date).getTime();this._sharingProvider.emailWithoutPermissioning(E,this._item,u,a).done(function(e){var r=e.statusCode;if(0===r){t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-A,resultType:d.ResultTypeEnum.Success});t._handleSharedLink(T,f)}else{var i=h.default,s=5,o=i.getSharingInformationError;if(-8===r){s=6;o=i.sharingOperationNotSupportedError}else if(-13===r){s=7;o=l.format(i.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===r){s=5;o=e.errorMessage}t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-A,resultType:d.ResultTypeEnum.Failure,error:s});t._storeContents.sharingInformation=n.__assign(n.__assign({},t._storeContents.sharingInformation),{error:s,errorCategory:3,errorMessage:o});t._emitChange()}})}else{var O=(new Date).getTime();this._sharingProvider.share(E,x,!0).done(function(e){var i=e.statusCode;if(0===i){var o=T;0===g&&1===b&&e.invitationLink?o=n.__assign(n.__assign({},T),{url:e.invitationLink}):0===g&&b>1&&e.invitationLink&&(o=n.__assign(n.__assign({},T),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));s.audience===r.SharingAudience.customLabeledSpecificPeople&&(o=n.__assign(n.__assign({},o),{audience:r.SharingAudience.customLabeledSpecificPeople}));t._invokeShareStatsEvent({name:"ShareObject",resultType:d.ResultTypeEnum.Success,duration:(new Date).getTime()-O});t._handleSharedLink(o,f)}else if(1===i){t._storeContents.accessRequestCreated=!0;t._invokeShareStatsEvent({name:"ShareObject",resultType:d.ResultTypeEnum.Success,duration:(new Date).getTime()-O});t._handleSharedLink(T,f)}else{var u=h.default,a=5,c=u.getSharingInformationError;if(-8===i){a=6;c=u.sharingOperationNotSupportedError}else if(-13===i){a=7;c=l.format(u.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===i){a=5;c=e.errorMessage}t._storeContents.sharingInformation=n.__assign(n.__assign({},t._storeContents.sharingInformation),{error:a,errorCategory:3,errorMessage:c});t._invokeShareStatsEvent({name:"ShareObject",resultType:d.ResultTypeEnum.Failure,duration:(new Date).getTime()-O,error:a});t._emitChange()}})}}}f&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==s.audience&&this._cleanupDefaultLink()}}};e.prototype.unshareLink=function(e,t){var n=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).done(function(e){if(!0===e){n._removeLinkByShareId(t);n._updateIsShared();n._emitChange()}})};e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated};e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var i=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===r.UpdatePermissionsRole.NONE){n._storeContents.sharingInformation.sharingPrincipals=i.filter(function(t){return t.id!==e.id});n._updateIsShared();n._emitChange()}else for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u.id===e.id){switch(t.role){case r.UpdatePermissionsRole.VIEW:u.role=1;break;case r.UpdatePermissionsRole.EDIT:u.role=2;break;case r.UpdatePermissionsRole.OWNER:u.role=3;break;case r.UpdatePermissionsRole.REVIEW:u.role=6}n._emitChange()}}})};e.prototype.addPeople=function(e,t,n,r,s){var o=this,u=this._getRoleString(t),a={items:[this._item],roleValue:u,sendEmail:r,message:s,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,a,!0).then(function(e){if(x.requestAccessChangesInAddPeopleMode())switch(e.statusCode){case 0:o._storeContents.addPeopleResult=i.AddPeopleResult.CompletedSuccessfully;break;case 1:o._storeContents.addPeopleResult=i.AddPeopleResult.AccessRequestsQueued;break;default:o._storeContents.addPeopleResult=i.AddPeopleResult.Error}else o._storeContents.addPeopleResult=0===e.statusCode;o._emitChange()},function(){o._storeContents.addPeopleResult=!1;o._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var e=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,r=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n;e._storeContents.outlookAvailability=r.HasEXOLicense?s.default.available:s.default.none;e._emitChange()});else{this._storeContents.outlookAvailability=s.default.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._storeContents.companyName};e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId};e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,r=function(e){var r={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===u.default.securityGroup){var s=i._groupsMemberCountCache[e.userId];void 0!==s?n+=s:i._peoplePickerProvider.getPickerEntityInformation(r).then(function(r){var i=r.totalMemberCount;t._groupsMemberCountCache[e.userId]=i;n+=i;t._storeContents.groupsMemberCount=n;t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null;t._emitChange()})}},i=this,s=0,o=e;s<o.length;s++){r(o[s])}this._storeContents.groupsMemberCount=n;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info){this._emitChange();return}var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,4),r=t.sharingAbilities;if(r){if(7!==(r&&r.directSharingAbilities.canAddExternalPrincipal.disabledReason)&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){if(t){e._storeContents.policyTipInfo.info=t;e._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo};e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){n._storeContents.policyTipInfo.actionResult=e;n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0);n._emitChange()})}};e.prototype.checkPermissions=function(e,t){var n=this;if(0!==e.length){var r=[];this._recipients=[];for(var i=0,s=e;i<s.length;i++){var o=s[i];r.push({alias:p.Killswitch.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email});this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers;this._invitedUsers=[];for(var u=0,a=t;u<a.length;u++){var f=a[u];r.push({alias:f.email});this._invitedUsers.push(f.email)}var l=r.map(function(e){return e.alias});this._sharingProvider.checkPermissions(r,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,r=e;t<r.length;t++){var i=r[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:2:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:1)}n._emitChange()})}else{this._storeContents.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,r=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});r=this._dedupeRecipients(r);var i={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(r,i,!0).done(function(e){t._storeContents=n.__assign(n.__assign({},t._storeContents),{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients};e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})};e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!!e&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1};e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._storeContents.defaultLink=void 0}};e.prototype._emitChange=function(){for(var e=0,t=this._listeners;e<t.length;e++){(0,t[e])()}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var e=this;if(this._storeContents.sharingInformation){var t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n;e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1;var n=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();n?this._substratePeoplePickerHelper.getSubstrateToken().then(function(t){e._substratePeoplePickerHelper.init(t);n=!!t;e._storeContents.sharingInformation.isTsAvailable=n}):this._storeContents.sharingInformation.isTsAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._storeContents.sharingLinkCreated=e;this._updateIsShared();this._emitChange()};e.prototype._getRoleValue=function(e){return e?"role:1073741827":"role:1073741826"};e.prototype._getRoleString=function(e){return 6===e?"roletype:Reviewer":2===e?o.EDIT_ROLE:3===e?o.OWNER_ROLE:o.VIEW_ROLE};e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===r.Mode.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}};e.prototype._removeLinkByShareId=function(e){this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(t){if(e===t.shareId){t.expiration=null;t.isActive=!1;t.shareId=a.default.Empty;t.url=null;t.principals=[]}return t})};e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,r=!1,i=0,s=t;i<s.length;i++){var o=s[i];o.isActive&&1!==o.sharingLinkKind&&(r=!0)}r||(r=n.length>0);this._storeContents.sharingInformation.isShared=r}};e.prototype._getOwaUrl=function(e,t){var n=location.origin.indexOf(".cn")===location.origin.length-3,r=location.origin.indexOf(".de")===location.origin.length-3,i="https://outlook.office.com/owa/";n?i="https://partner.outlook.cn/owa/":r&&(i="https://outlook.office.de/owa/");return i+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,i){var s=this,o=e||[],u=[];this._storeContents.isValidatingDefaultRecipients=e.length>0;if(!t){o=[];for(var a=[],l=0,c=e;l<c.length;l++){var h=c[l];a.push({alias:h})}u.push(this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.hasAccess||o.push(r.inputEntity)}}))}f.default.all(u).then(function(){if(0!==o.length){for(var e=[],t=[],u={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},a=0,l=o;a<l.length;a++){var c=l[a];e.push(s._peoplePickerProvider.resolve(c,u).then(function(e){t.push(e)}))}f.default.all(e).then(function(){s._storeContents.defaultRecipients={isConsumed:!1,recipients:t};s._storeContents.isValidatingDefaultRecipients=!1;s._emitChange()},function(){s._storeContents.defaultRecipients={isConsumed:!1,recipients:[]};s._storeContents.isValidatingDefaultRecipients=!1;s._emitChange()})}else if(i===r.Mode.atMention){s._storeContents=n.__assign(n.__assign({},s._storeContents),{grantAccessResult:!0});s._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],r=0,i=t[1].split("&");r<i.length;r++){var s=i[r];-1===s.indexOf("email=")&&n.push(s)}var o=n.join("&");return t[0]+"?"+o}return e};e.prototype._shareLink=function(e,t,i,s,o,u,a,f){var l=this,c={emailData:i,emailSubject:s,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:a,inviteesToRemove:f,role:e.sharingRole}};c.settings.role||(c.settings.role=e.isEdit?2:1);if(e.shareId&&e.shareId.length>0){c.settings.shareId=e.shareId;e.fetchLinkOnly&&(c.settings.createLink=!1)}var v=(new Date).getTime(),m=new d.default({name:"SharingShareLink."+r.Mode[this._mode]+"."+(r.ClientId[this._clientId]||"unknown")});if((e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===r.SharingAudience.anyone){c.settings.sharingLinkKind=6;c.settings.allowAnonymousAccess=!0}if(e.audience===r.SharingAudience.anyone){c.settings.allowAnonymousAccess=!0;c.settings.restrictShareMembership=!1}else if(e.audience===r.SharingAudience.organization){c.settings.allowAnonymousAccess=!1;c.settings.restrictShareMembership=!1}if(e.preventDownload){c.settings.role=7;e.sharingRole=7;c.settings.sharingLinkKind=6}e.audience!==r.SharingAudience.specificPeopleFlex&&e.audience!==r.SharingAudience.customLabeledSpecificPeople||(c.settings.restrictShareMembership=!0);e.audience===r.SharingAudience.customLabeledSpecificPeople&&(c.recipients=this.getDefaultRecipients().recipients);if(e.isCreateOnlyLink){c.settings.role=8;c.settings.description=e.description}this._sharingProvider.shareLink(c).done(function(t){if(t.error){l._storeContents.sharingInformation=n.__assign(n.__assign({},l._storeContents.sharingInformation),{error:t.error,errorCategory:2,debugErrorMessage:t.debugErrorMessage,errorMessage:h.default.getSharingInformationError});m.end({resultType:d.ResultTypeEnum.Failure});l._invokeShareStatsEvent({name:"ShareLink",resultType:d.ResultTypeEnum.Failure,duration:(new Date).getTime()-v,error:t.error});l._emitChange()}else{m.end({resultType:d.ResultTypeEnum.Success});l._invokeShareStatsEvent({name:"ShareLink",resultType:d.ResultTypeEnum.Success,duration:(new Date).getTime()-v});var i=t.link;e.audience===r.SharingAudience.customLabeledSpecificPeople&&(i.audience=r.SharingAudience.customLabeledSpecificPeople);i.sharingLinkKind===l._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&u&&o&&(p.Killswitch.isActivated("4FE917A1-5DBE-4BEB-8145-41D71F6F3673","9/20/2018","Use Share Id to test for existing link.")?l._storeContents.sharingInformation.sharingLinks.forEach(function(e){e.audience!==i.audience||!p.Killswitch.isActivated("EC2649A7-64A3-4EDB-BB8F-71AC090528CB","9/20/2018","Scope comparison against existing share links")&&e.isEdit!==i.isEdit||e.isActive||(l._storeContents.defaultLink=i)}):0===l._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===i.shareId}).length&&(l._storeContents.defaultLink=i));if(a){l._sharingInformationInvalidated=!0;l.fetchSharingInformation(!0);l._emitChange()}else l._handleSharedLink(i,o)}})};e.prototype._invokeShareStatsEvent=function(e){var t=new d.default,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var i={mode:r.Mode[this._mode],clientId:r.ClientId[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:i})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype._getDefaultLink=function(){var e=this,t=new d.default({name:"SharingGetDefaultLink"}),n=this._sharingContextInformation.itemUrl;if(!n&&this._sharingContextInformation.serverRelativeItemUrl){n=""+new g.default(this._sharingContextInformation.webAbsoluteUrl).authority+this._sharingContextInformation.serverRelativeItemUrl}var r=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(r=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));(this._permissions?f.default.resolve(this._permissions):this._sharingContextInformation.uniqueId?this._sharingService.getDefaultLinkByUniqueId(this._sharingContextInformation.uniqueId||"",r,!0):this._sharingService.getDefaultLink(n,r,!0)).then(function(n){var r=n[0],i=r.link,s=r.roles&&r.roles.indexOf("write")>=0;t.end({resultType:d.ResultTypeEnum.Success});e._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:v.getSharingAudienceFromVroomScope(i.scope),expiration:r.expirationDateTime,isActive:!0,isEdit:s,principals:[],shareId:r.id,sharingLinkKind:v.getSharingLinkKindFromVroomScope(i.scope,s),url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(n){t.end({resultType:d.ResultTypeEnum.Failure,extraData:{error:n}});var r="";try{r=JSON.stringify(n)}catch(e){}e._storeContents.sharingInformation={error:n,errorCategory:8,errorMessage:h.default.getSharingInformationError,debugErrorMessage:r,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};e._emitChange()})};e.prototype._dedupeRecipients=function(e){var t=[];if(p.Killswitch.isActivated("57ddc052-f331-4283-9af2-51d8ed07235d","08/15/2019","Deduping ShareLink Recipients"))t=e;else{var n={};e.forEach(function(e){n[e.userId]=e});Object.keys(n).forEach(function(e){t.push(n[e])})}return t};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return!0};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.shouldInterruptCopyLink=function(e){return new f.default(function(e,t){e(!1)})};e.prototype.isPreventDownloadAllowed=function(){return!0};e.prototype.isBundleShare=function(){return!1};e.prototype.getSupportedAudienceOptions=function(){return[r.SharingAudience.anyone,r.SharingAudience.customLabeledSpecificPeople,r.SharingAudience.existing,r.SharingAudience.organization,r.SharingAudience.specificPeople,r.SharingAudience.specificPeopleFlex]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1};e.prototype.showAudienceLearnMore=function(){return!0};e.prototype.showEmailsInSuggestions=function(){return!1};e.prototype.getFamily=function(){return null};e.prototype.getFamilyMembers=function(){return null};e.prototype.getCurrentUserId=function(){return null};e.prototype.getItemInformationForLogging=function(){var e,t,n,r=!0,i=this.getSharingInformation();if(i.fileExtension){e=S.getCategoryFromExtension(i.fileExtension);t=i.fileExtension}else if(i.sharedObjectType)e=w.SPSharedObjectType[i.sharedObjectType];else if(i.item){e=S.getItemCategory(i.item);t=i.item.extension;r=i.item.itemType===E.default.File}r&&e&&"other"!==e&&(n=t);return{itemType:e,extension:n}};return e})();t.default=T});
define("@ms/odsp-datasources/lib/Sharing",["require","exports","tslib","./interfaces/sharing/SharingInterfaces","./providers/sharing/SharingSiteProvider","./interfaces/sharing/enums/SharingInfoType","./interfaces/sharing/enums/SharingLinkKind","./interfaces/sharing/enums/SharingLinkType","./interfaces/sharing/enums/SharingRole","./dataSources/sharing/SharingDataSource","./providers/sharing/SharingProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t)});
define("@ms/odsp-datasources/lib/providers/sharing/SharingSiteProvider",["require","exports","../../dataSources/sharing/SharingSiteDataSource"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this._dataSource=e.sharingSiteDataSource||new n.SharingSiteDataSource(e.pageContext)}e.prototype.getSharingSettings=function(){return this._dataSource.getSharingSettings()};e.prototype.shareSite=function(e,t){return this._dataSource.shareSite(e,t)};e.prototype.getSiteSharingSettings=function(){return this._dataSource.getSiteSharingSettings()};e.prototype.setSiteSharingSettings=function(e){return this._dataSource.setSiteSharingSettings(e)};return e})();t.SharingSiteProvider=r});
define("@ms/odsp-datasources/lib/dataSources/sharing/SharingSiteDataSource",["require","exports","tslib","../../dataSources/base/DataSource","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/async/Promise","../base/DataBatchOperationHelper","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharingSiteDataSource"},{pageContext:t})||this,r=i.getSafeWebServerRelativeUrl(n._pageContext);n._getSharingSettingsUrl=r+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings/PickerProperties";n._shareUrl=r+"/_api/SP.Web.ShareObject";n._getSiteSharingtSettingsUrl=r+"/_api/web?$select=MembersCanShare,TenantAdminMembersCanShare,RequestAccessEmail,UseAccessRequestDefault,AccessRequestSiteDescription,AssociatedOwnerGroup,AssociatedMemberGroup&$expand=AssociatedOwnerGroup,AssociatedMemberGroup,AssociatedMemberGroup/AllowMembersEditMembership";n._setSiteSharingSettingsUrl=r+"/_api/web";n._setUseAccessRequestDefaultUrl=r+"/_api/web/SetUseAccessRequestDefaultAndUpdate";n._setUseAccessRequestDescriptiontUrl=r+"/_api/web/SetAccessRequestSiteDescriptionAndUpdate";n._setGroupAllowMembersEditMembershipUrl=r+"/_api/web/SiteGroups({0})";return n}t.prototype.getSharingSettings=function(){var e=this;return this._getSharingSettingsRawResponse().then(function(t){return e._parseSettings(t)},function(t){return e._parseError(t)})};t.prototype.getSiteSharingSettings=function(){var e=this;return this.getData(function(){return e._getSiteSharingtSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.SiteSharingSettings",null,"GET",null,null,null,!0).then(function(t){var n={};n.membersCanShare=t.MembersCanShare;n.tenantAdminMembersCanShare=t.TenantAdminMembersCanShare;n.requestAccessEmail=t.RequestAccessEmail;n.useAccessRequestDefault=t.UseAccessRequestDefault;n.accessRequestSiteDescription=t.AccessRequestSiteDescription;n.ownersGroup=e.parseSPGroup(t.AssociatedOwnerGroup);n.membersGroup=e.parseSPGroup(t.AssociatedMemberGroup);return n},function(t){return e._parseError(t)})};t.prototype.setSiteSharingSettings=function(e){var t=this,n=u.default.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],f=[],l=[];if(void 0!==e.membersCanShare||void 0!==e.requestAccessEmail){i.push(this._setSiteSharingSettingsUrl);l.push("MERGE");f.push(JSON.stringify({__metadata:{type:"SP.Web"},MembersCanShare:e.membersCanShare,RequestAccessEmail:e.requestAccessEmail}))}if(void 0!==e.useAccessRequestDefault){i.push(this._setUseAccessRequestDefaultUrl);l.push("POST");f.push(JSON.stringify({useAccessRequestDefault:e.useAccessRequestDefault}))}if(void 0!==e.accessRequestSiteDescription){i.push(this._setUseAccessRequestDescriptiontUrl);l.push("POST");f.push(JSON.stringify({description:e.accessRequestSiteDescription}))}if(e.membersGroup&&void 0!==e.defaultMembersGroupAddMembers){i.push(a.format(this._setGroupAllowMembersEditMembershipUrl,e.membersGroup.id));l.push("MERGE");f.push(JSON.stringify({__metadata:{type:"SP.Group"},AllowMembersEditMembership:e.defaultMembersGroupAddMembers}))}if(0!=i.length){var c=this.getData(function(){return o.DataBatchOperationHelper.getBatchOperationUrl(t._pageContext.webAbsoluteUrl)},function(e){return e},"SP.Web.SetSiteSharingSettings",function(){return o.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",o.DataBatchOperationHelper.defaultBatchRequestPostData,f,o.DataBatchOperationHelper.defaultBatchAcceptData,l)},"POST",null,r,void 0,void 0,void 0);return new s.default(function(e,t){c.then(function(n){var r=o.DataBatchOperationHelper.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})}).then(function(e){},function(e){return s.default.reject(e)})}};t.prototype.shareSite=function(e,n){var r=this;return this.getData(function(){return r._shareUrl},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t._parsePeople(i,n.siteUrl);o.invitedUsers=t._parsePeople(s,n.siteUrl);return o},"ShareSite",function(){for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(i.rawPersonData)}n.roleValue===2..toString()?n.roleValue="role:1073741827":n.roleValue===1..toString()?n.roleValue="role:1073741826":n.roleValue===(0).toString()&&(n.roleValue="role:1073741829");var s={url:n.siteUrl,peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,groupId:n.groupId,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return JSON.stringify(s)})};t.prototype._getSharingSettingsRawResponse=function(){var e=this,t={useSimplifiedRoles:!0};t.objectUrl=this._pageContext.webAbsoluteUrl;return this.getData(function(){return e._getSharingSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.GetObjectSharingSettings",function(){return JSON.stringify(t)},"POST",null,null,null,!0)};t._parsePeople=function(e,n){return e.map(function(e){var r={siteUrl:n,role:t._parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:r}})};t._parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;default:return 1}};t.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};t.prototype._parseSettings=function(e){var t={};t.canSendEmail=e.canSendEmail;t.pickerProperties={};t.itemUrl=e.itemUrl;t.mailSettings={defaultCharacterLimit:500};t.itemId=e.ItemId;t.itemName=e.ItemName;t.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;t.canSendEmail=e.CanSendEmail;t.pickerProperties={};t.supportsSharingPropagation=e.SupportsAclPropagation;t.showAdditionalExternalWarning=e.ShowExternalSharingWarning;t.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;t.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;t.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,t);var n=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var r=0;r<e.SimplifiedRoles.results.length;r++){var i={};i.name=e.SimplifiedRoles.results[r].Key;i.value=e.SimplifiedRoles.results[r].Value;n.push(i)}t.sharingRoles=n;t.showAdvanced=t.canManagePermissions;return t};t.prototype.parseSPGroup=function(e){return{id:e.Id,loginName:e.LoginName,principalType:e.PrincipalType,title:e.Title,allowMembersEditMembership:e.AllowMembersEditMembership,description:e.Description}};t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e;n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t};return t})(r.default);t.SharingSiteDataSource=f;t.default=f});
define("@ms/odsp-datasources/lib/dataSources/base/DataBatchOperationHelper",["require","exports","@ms/odsp-utilities/lib/guid/Guid","../../utilities/url/ApiUrlHelperBasic","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}e.getBatchOperationUrl=function(e,t){return new r.ApiUrlHelperBasic({webAbsoluteUrl:!e&&t?new i.SimpleUri(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,r,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=n.default.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(r+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,r,i,s,o,u){var a=n.default.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(r+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e})();t.DataBatchOperationHelper=s;t.default=s});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutor",["require","exports","./ShowPermissionsExecutor.html","./ShowPermissionsExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-show-permissions-panel-executor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:panelOverlayTagName,params:{ariaLabel:permissionsPanelName,onClose:$component.onClosePanel.bind($component),virtualParentElement:virtualParentElement}}--\x3e\x3c!--ko if:showShareCommands--\x3e<div class="od-ShowPermissions-commandBar od--hasSelection" data-bind="control:commandBarSpecification"></div>\x3c!--/ko--\x3e<div class="od-PermissionsPanel-container" data-bind="css:{\'od-PermissionsPanel-container-withCommandbar\':showShareCommands}">\x3c!--ko if:isManageAccessInReactEnabled--\x3e<div class="od-PermissionsPanel-titleBar--react"><div class="od-PermissionsPanel-fileName manageAccessInReactEnabled-fileName">\x3c!--ko component:{name:FileNameWithIconTagname,params:{oneDriveItem:fileItem}}--\x3e\x3c!--/ko--\x3e</div><h1 class="od-PermissionsPanel-head manageAccessInReactEnabled-head" data-bind="text:permissionsPanelName"></h1><div class="od-PermissionsPanel-stopSharing" data-bind="visible:canUnshare"><a role="button" href="javascript:;" data-bind="click:stopSharing,text:stopSharingText"></a><br></div></div>\x3c!--ko if:isItemMalwareDetected--\x3e<div class="od-PermissionsPanel-malwareDetectedMessageBar--react" data-bind="react:{componentType:malwareDetectedMessageComponent}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:isManageAccessInReactEnabled--\x3e<div class="od-PermissionsPanel-titleBar"><div class="od-PermissionsPanel-head" data-bind="text:permissionsPanelName"></div><div class="od-PermissionsPanel-fileName">\x3c!--ko component:{name:FileNameWithIconTagname,params:{oneDriveItem:fileItem}}--\x3e\x3c!--/ko--\x3e</div><button class="od-PermissionsPanel-stopSharing" data-bind="visible:canUnshare,click:stopSharing,text:stopSharingText"></button></div>\x3c!--/ko--\x3e\x3c!--ko if:isManageAccessInReactEnabled--\x3e<div class="od-PermissionsPanel-content-React"><div class="od-PermissionsPanel-table"><div class="od-PermissionsPanel-row"><div class="od-PermissionsPanel-cell" data-bind="react:{componentType:shareComponent,props:shareComponentProps}"></div></div>\x3c!--ko if:canManagePermissions()--\x3e<div class="od-PermissionsPanel-linksBox-row"><div class="od-PermissionsPanel-linksBox-cell" data-bind="if:hasSettings()"><a target="_blank" data-bind="attr:{href:advancedUrl},text:advancedText,visible:canShowAdvanced,click:onAdvancedClick"></a></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isManageAccessInReactEnabled--\x3e<div class="od-PermissionsPanel-content"><div class="od-PermissionsPanel" data-bind="keyboard:keyNav.keyboardOptions,selection:{data:keyNav.focusableTiles,mode:\'single\',direction:\'vertical\',focused:keyNav.focusedTile}">\x3c!--ko if:!isLoading()&&isShareLinkVisible&&!showShareCommands--\x3e<div class="od-PermissionsPanel-addPeople"><a role="button" href="#" data-bind="click:onPermissionsPanelShareClick,hasFocus:hasFocus"><div class="od-PermissionsPanel-addPeople-icon"><i class="ms-Icon ms-Icon--PeopleAdd" data-bind="icon:true"></i></div><span class="od-PermissionsPanel-addPeople-text" data-bind="text:addPeopleText"></span></a></div>\x3c!--/ko--\x3e\x3c!--ko if:isItemMalwareDetected--\x3e<div class="od-PermissionsPanel-malwareDetectedMessageBar" data-bind="react:{componentType:malwareDetectedMessageComponent}"></div>\x3c!--/ko--\x3e<span role="alert" class="ms-accessible" data-bind="text:updateComplete,visible:readPermissionsUpdated()"></span>\x3c!--ko if:!isLoading()--\x3e<div class="od-PermissionsPanel-links" data-bind="foreach:{data:links,as:\'link\'}"><div class="od-PermissionsPanel-link" data-bind="component:{name:$component.sharingLinkTagName,params:{link:link,isShareLinkVisible:$component.isShareLinkVisible,onLinkRemoved:function(){$component.onLinkRemoved()}}}"></div></div><div class="od-PermissionPanel-shareScope" data-bind="foreach:{data:scopes,as:\'scope\'}"><div class="od-PermissionPanel-shareScopeHeader" data-bind="bindableHtml:headerHtml"></div><div class="od-PermissionPanel-shareEntities" data-bind="foreach:{data:people,as:\'person\'}">\x3c!--ko if:person.sharingInfo.link--\x3e<div class="od-PermissionsPanel-link" data-bind="component:{name:$component.sharingLinkTagName,params:{link:person.sharingInfo.link,isShareLinkVisible:$component.isShareLinkVisible,onLinkRemoved:function(){$component.onLinkRemoved()},isEditable:$component.isPremium()}}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:person.sharingInfo.link--\x3e\x3c!--ko with:$component.getTileForPerson(person)--\x3e<div class="od-PermissionsPanel-entity" data-bind="component:{name:$component.personaTileTagName,params:{canManagePermissions:$component.canManagePermissions(),tile:$data}}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--ko if:canManagePermissions()--\x3e<div class="od-PermissionsPanel-linksBox" data-bind="if:hasSettings()"><a target="_blank" data-bind="attr:{href:advancedUrl},text:advancedText,visible:advancedUrl(),click:onAdvancedClick"></a></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutorViewModel",["require","exports","tslib","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../base/ControlExecutorViewModel","../../controls/dialogHost/DialogHost","../../controls/fileNameWithIcon/FileNameWithIcon","../../resources/ProviderResourceKeys","../../providers/dialog/DialogProvider","../../bindings/html/BindableHtmlBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../controls/personaTile/PersonaTile","../../controls/overlays/panel/PanelOverlay","../../controls/infoPane/InfoPane.resx","../../controls/infoPane/sections/sharing/SharingSectionHelper","../../controls/sharing/sharingLink/SharingLink","../../providers/item/ItemProvider","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","./ShowPermissionsExecutorCommandSet","../../utilities/features/Features","../../controls/commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../bindings/react/ReactBinding","../../controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage","../../controls/sharing/share/react/Share","@ms/odsp-shared-sharing/lib/Share","../../providers/sharing/react/SharingStore","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.malwareDetectedMessageComponent=A.malwareDetectedMessage;n._hideElementsInManageAccess=function(e){if(!D.Killswitch.isActivated("228291dd-a7a0-40c5-b303-c79dc377d953","02/21/2019","Fix stop sharing button accessibility")){var t=n.canUnshare&&!e;n.canShowStopSharing(t);n.canShowAdvanced(!e)}};n.addBindingHandlers({bindableHtml:l.default,keyboard:c.default,control:k.default,selection:h.default,react:L.default});n.panelOverlayTagName=d.default.tagName;n.dialogHostTagName=o.default.tagName;n.personaTileTagName=p.default.tagName;n.sharingLinkTagName=g.default.tagName;n.permissionsPanelName=v.default.sharingPermissionsPanelName;n.FileNameWithIconTagname=u.default.tagName;n.addPeopleText=v.default.addPeople;n.advancedText=v.default.advanced;n.stopSharingText=v.default.stopSharing;n.personaListScreenReaderText=v.default.personaListScreenReaderText;var r=t.item,i=t.engagementSource;n.item=n.resources.consume(y.resourceKey).getItemSync({parentKey:r.key}).item;n.isLoading=n.createObservable(!1);n.hasFocus=!1;n.resources.bind(f.resourceKey);n.engagementSource=i;n.commandBarSpecification=k.toSpecification(C.resourceKey,{commandSet:new(n.managed(T.default))({engagementSource:n.engagementSource,item:n.item})});n._sharingSectionHelper=new(n.managed(m.default))({item:n.item});n.updateComplete=n._sharingSectionHelper.updateComplete;n.readPermissionsUpdated=n._sharingSectionHelper.readPermissionsUpdated;n._initializeUpdateText();n.links=n._sharingSectionHelper.links;n.personaTileCollection=n._sharingSectionHelper.personaTileCollection;n.personaTileByUser=n._sharingSectionHelper.personaTileByUser;n.scopes=n._sharingSectionHelper.scopes;n.createComputed(n._permissionsChanged);n.canShowStopSharing=n.createObservable(!0);n.canUnshare=n.createPureComputed(function(){return!n._sharingSectionHelper.privateDescription()&&n._sharingSectionHelper.canUnshare()&&n.canShowStopSharing()});n.hasSettings=n._sharingSectionHelper.hasSettings;n.isLoading=n._sharingSectionHelper.isLoading;n.advancedUrl=n._sharingSectionHelper.advancedUrl;n.canShowAdvanced=n.createObservable(!0);n.isShareLinkVisible=n._sharingSectionHelper.isShareLinkVisible;n.hasFocus=n._sharingSectionHelper.hasFocus||!1;n.canManagePermissions=n._sharingSectionHelper.canManagePermissions;n.moveShareCommands=N.isFeatureEnabled(N.ShareCommandsExperiment);n.showShareCommands=N.isFeatureEnabled(N.EnableFolderShareAccessHint)&&!n.moveShareCommands;n.isManageAccessInReactEnabled=N.isFeatureEnabled(N.EnableManageAccessInReact);n.isItemMalwareDetected=n.createPureComputed(n._computeIsItemMalwareDetected);n._storageOptionsProvider=n.resources.consume(a.storageOptions.optional);n.isPremium=n.createPureComputed(n._computeIsPremium);n.personaListTabIndex=n.createPureComputed(function(){for(var e=!1,t=0,r=n.keyNav.focusableTiles();t<r.length;t++){var i=r[t];e=e||i.focused()}return e});n.virtualParentElement=t.event?n._getVirtualParent(t.event.target):void 0;n.shareComponent=O.default;n.shareComponentProps=n.createPureComputed(n._computeShareComponentProps);return n}t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing(this.onClosePanel.bind(this))};t.prototype.onClosePanel=function(){this.action.complete()};t.prototype.onPermissionsPanelShareClick=function(){this._sharingSectionHelper.onShareClick()};t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};t.prototype.onAdvancedClick=function(){this.resources.consume(r.resourceKey).logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};t.prototype.getTileForPerson=function(e){return this.personaTileByUser()[e.userId]};t.prototype._permissionsChanged=function(){this.keyNav=this._sharingSectionHelper.keyNav;this.fileItem=this._sharingSectionHelper.fileItem};t.prototype._initializeUpdateText=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype._computeIsPremium=function(){if(this._storageOptionsProvider.isReady())return this._storageOptionsProvider.hasOffice.peek()};t.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};t.prototype._computeIsItemMalwareDetected=function(){var e=this.item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._computeShareComponentProps=function(){var e=this.resources.consume(b.resourceKey),t=this.resources.consume(w.resourceKey),n=this.resources.consume(E.resourceKey),r=this.resources.consume(S.resourceKey),s=this.resources.consume(x.resourceKey),o=this.resources.consume(i.actionMap);if(this.item()){var u=this.item(),a=new _.default({item:u,accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:M.Mode.manageAccess,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:r,peoplePickerProvider:e,policyTipProvider:s,graphPeoplePickerHelper:t});return{actionMap:o,copyLinkShortcut:!1,item:u,peoplePickerProvider:e,graphPeoplePickerHelper:t,resources:this.resources,sharingInformation:null,sharingProvider:n,policyTipProvider:s,maxHeight:void 0,defaultRecipients:[],mode:M.Mode.manageAccess,noMaxHeightRestriction:!0,hideElementsInManageAccess:this._hideElementsInManageAccess,shareCommandsExperiment:this.moveShareCommands,sharingStore:a}}};return t})(s.default);t.default=P});
define("odsp-next/controls/personaTile/PersonaTile",["require","exports","./PersonaTile.html","./PersonaTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-persona-tile",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/personaTile/PersonaTile.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-PersonaTile" role="treeitem" data-bind="attr:{tabindex:tile.index===0&&!(disableTab===true)?0:-1,\'aria-label\':ariaLabel},hasFocus:tile.focused,scrollIntoView:{isSelected:tile.focused}"><div class="od-PersonaTile-Persona" data-bind="attr:{\'aria-hidden\':true},component:{name:personaTagName,params:tile.personaParams}"></div></div>'});
define("odsp-next/controls/personaTile/PersonaTileViewModel",["require","exports","tslib","../persona/Persona.resx","../persona/Persona","../../bindings/scrollIntoView/ScrollIntoViewBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.personaTagName=i.default.tagName;n.addBindingHandlers({scrollIntoView:s.default});var r=t.tile;n.tile=r;n.tile.personaParams.disableTab=!0;n.tile.personaParams.canManagePermissions=t.canManagePermissions;n.disableTab=t.disableTab;n._person=n.tile.personaParams.person.peek();n.ariaLabel=n.createComputed(n._computeAriaLabel);return n}t.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",n=this.tile.personaParams.canManagePermissions?r.default.EnterKeyInstruction:"";if(0===e)t=r.default.Owner;else if(2===e){t=r.default.Edit;t+=n}else if(1===e){t=r.default.View;t+=n}return this._person.name+" "+t};return t})(o.default);t.default=u});
define("odsp-next/controls/sharing/sharingLink/SharingLink",["require","exports","./SharingLink.html","./SharingLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-sharingLink",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/sharing/sharingLink/SharingLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharingLink" role="group" data-bind="attr:{\'aria-label\':sharingHintText}"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class="od-SharingLink-iconBackground" data-bind="css:{\'od-SharingLink-anonymous-bg\':isAnonymousLink,\'od-SharingLink-csl-bg\':isCSL,\'od-SharingLink-psl-bg\':isPSL,\'od-SharingLink-generic-bg\':isGeneric}"></div><div class="od-SharingLink-icon" role="presentation" data-bind="react:{componentType:iconComponent,props:iconComponentProps},css:{\'od-SharingLink-anonymous\':isAnonymousLink,\'od-SharingLink-csl\':isCSL,\'od-SharingLink-psl\':isPSL,\'od-SharingLink-generic\':isGeneric}"></div></div><div class="od-SharingLink-cell"><div class="od-Sharinglink-table od-Sharinglink-url"><div class="od-Sharinglink-row"><div class="od-SharingLink-cell">\x3c!--ko if:isLinkVisible--\x3e<input class="od-SharingLink-input od-TextField-field" type="text" readonly data-bind="value:link.url,selectOnFocus:{isPermanent:true},attr:{title:shareableLinkText,\'aria-label\':shareableLinkText},event:{copy:$component.logCopy.bind($component)}">\x3c!--/ko--\x3e\x3c!--ko ifnot:isLinkVisible--\x3e<span class="od-SharingLink-linkSwitcher" data-bind="text:sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:canManageLinks--\x3e<div class="od-SharingLink-cell"><button class="od-SharingLink-removeLinkButton" data-bind="css:{\'od-SharingLink-removeLinkButton-leftMargin\':isLinkVisible},click:removeSharingLink,attr:{title:disableLinkText,\'aria-label\':disableLinkText}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:isLinkVisible--\x3e<div class="od-SharingLink-linkSwitcher">\x3c!--ko if:isEditable--\x3e<div class="od-SharingLink-sharingHintContainer"><button class="od-SharingLink-sharingHint" data-bind="click:onSharingHintClick">\x3c!--ko text:sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon:true"></i></button>\x3c!--ko if:arePasswordLinksEnabled--\x3e\x3c!--ko if:isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role="img" data-bind="icon:true,attr:{\'aria-label\':passwordProtectedLinkIndicatorLabel}"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!isEditable--\x3e<div class="od-SharingLink-sharingHint" data-bind="text:sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:link.linkMembers--\x3e<div class="od-SharingLink-linkUser"><div class="od-Sharing-briefLinkMembers">\x3c!--ko foreach:briefLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:extraMembersText()--\x3e\x3c!--ko if:!showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role="button" data-bind="icon:true,click:showTotalLinkMembers,tooltip:{content:extraMembersName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role="button" data-bind="icon:true,click:hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:showTotal()--\x3e<div class="od-Sharing-extraLinkMembers">\x3c!--ko foreach:extraLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showEditLinkPanel--\x3e\x3c!--ko component:{name:panelOverlayTagName,params:{onClose:$component.onClosePanel.bind($component),title:editLinkPanelTitle}}--\x3e\x3c!--ko component:{name:editLinkTagName,params:editLinkParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingLink/SharingLinkViewModel",["require","exports","tslib","knockout","../../../providers/engagement/Engagement","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../sharingByLink/SharingByLinkStringHelper","../../../utilities/sharing/SharingHelper","../../../bindings/focus/SelectOnFocusBinding","../../../bindings/tooltip/TooltipBinding","../sharedWith/SharedWith.resx","../../infoPane/InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../persona/Persona","@ms/odsp-shared-sharing/lib/Share","../../overlays/panel/PanelOverlay","../editLink/EditLink.resx","../editLink/EditLink","../../../bindings/react/ReactBinding","office-ui-fabric-react/lib/Icon","../../../models/item/ItemHelper","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.passwordProtectedLinkIndicatorLabel=w.default.passwordProtectedLinkIndicatorAriaLabel;n._engagement=n.resources.consume(i.resourceKey);n.link=t.link;var u=!t.isShareLinkVisible||t.isShareLinkVisible,a=6===n.link.kind?n._dedupeLinkMembers(n.link.linkInvitees.concat(n.link.linkMembers)):n.link.linkMembers;n.totalLinkMembers=n.createObservable(a);n._extraMembersCount=n.createPureComputed(n._getExtraMembers);n.extraMembersText=n.createPureComputed(n._getExtraMemberText);n.briefLinkMembers=n.createPureComputed(n._getBriefLinkMembers);n.extraLinkMembers=n.createPureComputed(n._getExtraLinkMembers);n.extraMembersName=n.createPureComputed(n._getExtraMembersName);n.showTotal=n.createObservable(!1);n.personaTagName=g.default.tagName;n.personaSize=7;n.isLinkVisible=10!==n.link.type&&u;n._onLinkRemoved=t.onLinkRemoved;n.isEditable=t.isEditable||!1;n.arePasswordLinksEnabled=N.isFeatureEnabled(N.EnablePasswordProtectedLinks);n.isPasswordProtectedLink=n.link&&n.link.hasPassword;n.panelOverlayTagName=b.default.tagName;n.editLinkTagName=E.default.tagName;n.editLinkPanelTitle=w.default.editLinkPanelTitle;n.editLinkParams={onClose:n.onClosePanel.bind(n),onLinkRemoved:n._onLinkRemoved,sharingLink:n.link};n.showEditLinkPanel=n.createObservable(!1);n._sharingProvider=n.resources.consume(s.resourceKey);n.disableLinkText=w.default.removeLinkButtonText;n.shareableLinkText=p.default.ShareableLink;n.isInheritedText=n.link.isInherited?p.default.InheritedText:"";n.sharingHintText=r.observable("");var l=n.resources.consume(o.resourceKey.optional);l&&l.loadData().then(function(e){n.sharingHintText(f.getLinkHintText(n.link,e.CompanyDisplayName))});n.canManageLinks=r.observable(!1);n._sharingProvider.getSharingData(n.link.item).getSettings().then(function(e){N.isFeatureEnabled(N.EnableLinkLevelManageAccess)?n.canManageLinks(n.link.linkMembers&&!n.link.isInherited&&!T.hasAutoAlbumTag(n.link.item)):n.canManageLinks(e.canManageLinks&&!n.link.isInherited&&!T.hasAutoAlbumTag(n.link.item))});n.addBindingHandlers({tooltip:h.default,selectOnFocus:c.default,react:S.default});n.iconComponent=x.Icon;n.iconComponentProps=n._getLinkIconProps(n.link);return n}t.prototype.logCopy=function(){this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0});return!0};t.prototype.removeSharingLink=function(){var e=this,t=this.resources.consume(a.resourceKey);l.disableLinkConfirm(function(){e._engagement.logData({name:"Disable "+e.link.tag+" Link.SharingLink.Click",isIntentional:!0});var t={link:e.link,type:e.link.type,role:e.link.role,create:!1};return e._sharingProvider.manageSharingLinks([e.link.item],t).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return u.default.wrap(!0)},function(e){return!1})},function(t){e.isReady=t},t,"SharingLink")};t.prototype.onSharingHintClick=function(){if(this.isEditable){this._engagement.logData({name:this.link.tag+"Link.SharingLink.EditPermissions",isIntentional:!0});this.showEditLinkPanel(!0)}};t.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)};t.prototype.showTotalLinkMembers=function(){this.showTotal(!0)};t.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)};t.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return e>0?e+1:0};t.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();if(t){t>99&&(e=d.default.sharingExtraNumberOverflow);e=v.format(d.default.sharingExtraNumberText,t)}return e};t.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e};t.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]};t.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(p.default.NameSeparator)};t.prototype._dedupeLinkMembers=function(e){for(var t=[],n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=s.email;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=e.audience===y.SharingAudience.anyone||5===t||4===t;this.isCSL=e.audience===y.SharingAudience.organization||3===t||2===t;this.isPSL=e.audience===y.SharingAudience.specificPeople||e.audience===y.SharingAudience.specificPeopleFlex;this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL;var n="Link";this.isAnonymousLink?n="Globe":this.isCSL?n="Work":this.isPSL&&(n="PeopleAdd");return{iconName:n}};return t})(m.default);t.default=C});
define("odsp-next/controls/sharing/sharingByLink/SharingByLinkStringHelper",["require","exports","./SharingByLink.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared-sharing/lib/Share"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLinkHintText=function(e,t,u,a){if(null===e)return"";if(6===e.kind){if(e.blockDownload){if(e.audience===i.SharingAudience.anyone)return e.expiration?r.format(e.hasPassword?n.default.AnonymousViewOnlyWithExpiryAndPassword:n.default.AnonymousViewOnlyWithExpiry,new Date(e.expiration).toLocaleDateString()):e.hasPassword?n.default.AnonymousViewOnlyWithPassword:n.default.AnonymousViewOnlyText;if(e.audience===i.SharingAudience.organization)return r.format(n.default.OrganizationViewOnly,t);if(e.audience===i.SharingAudience.specificPeopleFlex)return n.default.SpecificPeopleViewOnly}if(e.audience!==i.SharingAudience.anyone)return 2===e.role?n.default.pslEditLabel:6===e.role?n.default.pslReviewLabel:1===e.role?n.default.pslViewLabel:n.default.peopleSharingLinkLabel;if(e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return o(6,new Date(e.expiration));if(1===e.role||5===e.type)return o(5,new Date(e.expiration))}else if(!e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return n.default.AnonymousPasswordEditText;if(1===e.role||5===e.type)return n.default.AnonymousPasswordViewText}else if(e.expiration&&!e.hasPassword){if(2===e.role||6===e.type)return s(6,new Date(e.expiration));if(1===e.role||5===e.type)return s(5,new Date(e.expiration))}else{if(2===e.role||6===e.type)return n.default.AnonymousEditText;if(1===e.role||5===e.type)return n.default.AnonymousViewText}}if(8===e.type&&u&&u.length>0&&a&&1===a){for(var f=u[0].sharingInfo.role,l=1;l<u.length;l++){if(f!==u[l].sharingInfo.role){f=5;break}}return 1===u.length?2===f?r.format(n.default.InvitedUsersOneEditLinkText,u[0].name):1===f?r.format(n.default.InvitedUsersOneViewLinkText,u[0].name):r.format(n.default.InvitedUsersOneAccessLinkText,u[0].name):2===u.length?2===f?r.format(n.default.InvitedUsersTwoEditLinkText,u[0].name,u[1].name):1===f?r.format(n.default.InvitedUsersTwoViewLinkText,u[0].name,u[1].name):r.format(n.default.InvitedUsersTwoAccessLinkText,u[0].name,u[1].name):3===u.length?2===f?r.format(n.default.InvitedUsersThreeEditLinkText,u[0].name,u[1].name):1===f?r.format(n.default.InvitedUsersThreeViewLinkText,u[0].name,u[1].name):r.format(n.default.InvitedUsersThreeAccessLinkText,u[0].name,u[1].name):2===f?r.format(n.default.InvitedUsersThreePlusEditLinkText,u[0].name,u[1].name,u.length-2):1===f?r.format(n.default.InvitedUsersThreePlusViewLinkText,u[0].name,u[1].name,u.length-2):r.format(n.default.InvitedUsersThreePlusAccessLinkText,u[0].name,u[1].name,u.length-2)}var c=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return n.default.AnonymousViewText;switch(e.type){case 9:return 2===e.role?t?r.format(n.default.OrganizationEditText,t):n.default.NoNameOrganizationEditText:t?r.format(n.default.OrganizationViewText,t):n.default.NoNameOrganizationViewText;case 8:return 2===a?2===e.role?n.default.ToLineEditText:n.default.ToLineViewText:n.default.DirectLinkText;case 6:return e.supportsExpiration&&c?s(6,new Date(e.expiration)):n.default.AnonymousEditText;case 5:return e.supportsExpiration&&c?s(5,new Date(e.expiration)):n.default.AnonymousViewText;case 3:return n.default.AnonymousEmbedText;case 4:return r.format(n.default.appText,e.name);case 7:return n.default.AnonymousSurveyText;case 10:return n.default.OneNoteSharingText;default:return""}};t.getWhoCanAccessLinkOptions=function(e,t,i){var s=[];if(1===i||2===i){e.anonymousLinksEnabled&&e.canManageLinks&&s.push({text:n.default.AnonymousOptionText,type:6});e.organizationLinksEnabled&&e.canManageLinks&&(t?s.push({text:r.format(n.default.NamedOrganizationOptionText,t),type:9}):s.push({text:n.default.UnnamedOrganizationOptionText,type:9}))}1===i?s.push({text:n.default.SpecificPeopleOptionText,type:8}):s.push({text:n.default.ToLineOptionText,type:8});return s};t.getSharingInfoText=function(e){return 0===e.length?null:1===e.length?r.format(n.default.PermissionsInfoOneAccessLinkText,e[0].name):2===e.length?r.format(n.default.PermissionsInfoTwoAccessLinkText,e[0].name,e[1].name):3===e.length?r.format(n.default.PermissionsInfoThreeAccessLinkText,e[0].name,e[1].name):r.format(n.default.PermissionsInfoThreePlusAccessLinkText,e[0].name,e[1].name,e.length-2)};function s(e,t){var i=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?r.format(s?n.default.AnonymousEditExpiredText:n.default.AnonymousEditExpiryText,i):5===e?r.format(s?n.default.AnonymousViewExpiredText:n.default.AnonymousViewExpiryText,i):""}function o(e,t){var i=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?r.format(s?n.default.AnonymousPasswordEditExpiredText:n.default.AnonymousPasswordEditExpiryText,i):5===e?r.format(s?n.default.AnonymousPasswordViewExpiredText:n.default.AnonymousPasswordViewExpiryText,i):""}});
define("odsp-next/controls/sharing/editLink/EditLink",["require","exports","./EditLink.html","./EditLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-editLink",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/sharing/editLink/EditLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-EditLink"><div class="od-CheckBox od-EditLink-linkExpiresCheckbox"><input type="checkbox" id="od-EditLink-linkExpires" data-bind="checked:linkExpiresChecked" class="od-CheckBox-input"><label for="od-EditLink-linkExpires" class="od-CheckBox-field" data-bind="css:{\'is-checked\':linkExpiresChecked}"><span data-bind="text:linkExpiresText,automation:\'linkExpiresText\'" class="od-Label"></span></label>\x3c!--ko if:linkExpiresChecked()--\x3e<div class="od-EditLink-linkExpiresInputDiv"><input id="od-EditLink-linkExpiresInput" class="od-EditLink-linkExpiresInput" type="number" data-bind="value:linkExpirationInDays,selectOnFocus:{isPermanent:false,isReentrant:true}"><label for="od-EditLink-linkExpiresInput"><span class="od-EditLink-linkExpiresInputLabel" data-bind="text:linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:arePasswordLinksEnabled--\x3e<div class="od-CheckBox od-EditLink-setPasswordCheckbox"><input type="checkbox" id="od-EditLink-setPassword" data-bind="checked:isSetPasswordChecked" class="od-CheckBox-input"><label for="od-EditLink-setPassword" class="od-CheckBox-field" data-bind="css:{\'is-checked\':isSetPasswordChecked}"><span data-bind="text:setPasswordLabel,automation:\'setPasswordLabel\'" class="od-Label"></span></label>\x3c!--ko if:isSetPasswordChecked()--\x3e<div class="od-EditLink-setPasswordInputContainer"><input id="od-EditLink-setPasswordInput" class="od-EditLink-setPasswordInput" type="password" data-bind="attr:{\'aria-label\':setPasswordAriaLabel,\'aria-invalid\':isPasswordInvalid()},value:passwordValue,valueUpdate:\'input\',click:changePasswordInput,selectOnFocus:{isPermanent:false,isReentrant:true},css:{\'od-EditLink-invalidPasswordOutline\':isPasswordInvalid()}"></div>\x3c!--ko if:isPasswordInvalid()--\x3e<div class="od-EditLink-invalidPasswordError" role="alert" data-bind="text:invalidPasswordText"></div>\x3c!--/ko--\x3e<div class="od-EditLink-passwordProtectedLinkInformationArea"><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon:true"></i><div class="od-EditLink-passwordProtectedLinkInformationTextArea" data-bind="text:setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-EditLink-removeLinkHolder"><i class="ms-Icon ms-Icon--Delete" data-bind="icon:true"></i><button class="od-EditLink-removeLinkText" data-bind="click:onRemoveLinkClicked,text:removeLinkButtonText"></button></div><div class="od-EditLink-buttons"><button class="od-Button od-Button--primary" role="button" data-bind="click:onUpdateClick,disable:isUpdateButtonDisabled"><span class="od-Button-label" data-bind="text:updateButtonText"></span></button><button class="od-Button" role="button" data-bind="click:onCancelClick"><span class="od-Button-label" data-bind="text:cancelButtonText"></span></button></div></div>'});
define("odsp-next/controls/sharing/editLink/EditLinkViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../providers/item/ItemProvider","./EditLink.resx","../../../controls/sharing/sharingByLink/SharingByLink.resx","../../../utilities/sharing/SharingHelper","../../../providers/sharing/SharingProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.setPasswordAriaLabel=s.default.setPasswordAriaLabel;var u=t.onClose,f=t.onLinkRemoved,l=t.sharingLink;n._onClose=u;n._onLinkRemoved=f;n._sharingLink=l;n.addBindingHandlers({selectOnFocus:c.default});n._itemProvider=n.resources.consume(i.resourceKey);n._sharingProvider=n.resources.consume(a.resourceKey);n._engagement=n.resources.consume(r.resourceKey);n._sharingLinkExpirationHelper=new(n.managed(h.default));n.cancelButtonText=s.default.cancelButtonText;n.createBackgroundComputed(n._computeValidInput);n.invalidPasswordText=o.default.invalidPasswordError;n.linkExpirationInDays=n.createObservable(n._getDefaultLinkExpirationInDays(n._sharingLink.expiration));n.linkExpiresChecked=n.createObservable(!!n._sharingLink.expiration);n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel);n.linkExpiresText=s.default.setExpirationLabel;n.passwordChanged=n.createObservable(!1);n.passwordValue=n.createObservable("");n.updateButtonText=s.default.updateButtonText;n.setPasswordPermissionsWarning=o.default.SetPasswordPermissionsWarning;n.removeLinkButtonText=s.default.removeLinkButtonText;n.arePasswordLinksEnabled=d.isFeatureEnabled(d.EnablePasswordProtectedLinks);n.isSetPasswordChecked=n.createObservable(!!n._sharingLink.hasPassword);n.setPasswordLabel=s.default.setPasswordLabel;n.arePasswordLinksEnabled&&n._onSetPasswordChecked();n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid);n.isUpdateButtonDisabled=n.createComputed(n._computeIsUpdateButtonDisabled);return n}t.prototype.onUpdateClick=function(){var e=this;this._logEngagementEvent("Update");var t=this._sharingLink,n=[t.item],r=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,i={type:t.type,role:t.role,create:!0,expiration:r,name:t.name,id:t.id};if(this.arePasswordLinksEnabled){var s=this.isSetPasswordChecked.peek(),o=s&&this.passwordChanged.peek(),u=!s&&t.hasPassword;o&&(i.password=this.passwordValue.peek());u&&(i.password="")}this._sharingProvider.manageSharingLinks(n,i).then(function(t){e._itemProvider.invalidateItem(n[0].key,{triggerFetch:!0});e._onClose()})};t.prototype.changePasswordInput=function(){this.passwordChanged(!0);this.passwordValue("")};t.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel");this._onClose()};t.prototype.onRemoveLinkClicked=function(){var e=this,t=this._sharingLink,n=this.resources.consume(l.resourceKey);this._logEngagementEvent("RemoveLink");u.disableLinkConfirm(function(){e._engagement.logData({name:"Disable "+t.tag+" Link.SharingLink.Click",isIntentional:!0});var r={link:t,type:t.type,role:t.role,create:!1};return e._sharingProvider.manageSharingLinks([t.item],r).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return f.default.wrap(!0)},function(e){var t=e&&e.message||s.default.unableToRemoveLinkGenericMessage;u.displayMessage(t,s.default.unableToRemoveLinkTitle,n);return!1})},function(e){},n,"EditLink")};t.prototype._onSetPasswordChecked=function(){if(this._sharingLink&&this._sharingLink.hasPassword){this.passwordValue("        ")}};t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),n=t.toString();if(t<=0&&t>h.MAX_EXPIRATION){n="";this.linkExpiresChecked(!1)}this.linkExpirationInDays(n)};t.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&e.length>0&&0===e.trim().length};t.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),n=this.isPasswordInvalid();if(!e&&!t)return!1;var r=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(r)!==h.LinkExpirationValidity.Valid||n};t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};t.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt(h.DEFAULT_EXPIRATION,10);e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e)));return t.toString()};t.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"EditLinkPanel."+e+".Click",isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})};return t})(p.default);t.default=v});
define("odsp-next/dataSources/sharing/odc/SharingLinkExpirationHelper",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/sharing/sharingByLink/SharingByLink.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_EXPIRATION="30";t.MAX_EXPIRATION=1825;var u;(function(e){e[e.Invalid=0]="Invalid";e[e.Empty=1]="Empty";e[e.Valid=2]="Valid"})(u=t.LinkExpirationValidity||(t.LinkExpirationValidity={}));var a=(function(e){n.__extends(i,e);function i(t){return e.call(this,t)||this}i.prototype.computeExpirationValidity=function(e){if(""===e)return u.Empty;var n=e.match(/^-?[0-9]+/);if(n&&n[0]!==e||!n)return u.Invalid;var r=parseInt(e,10);return r<=0||r>t.MAX_EXPIRATION?u.Invalid:u.Valid};i.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===u.Valid){var t=parseInt(e,10),n=new Date;n.setDate(n.getDate()+t);return s.format(o.default.daysWithDate,r.getShortDisplayDate(n))}return o.default.days};i.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)};i.prototype.calculateLinkExpiration=function(e){if(e>0&&e<=t.MAX_EXPIRATION){var n=new Date;n.setDate(n.getDate()+e);return n.toISOString()}return null};return i})(i.default);t.default=a});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutorCommandSet",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../utilities/icons/Icon","../../utilities/browser/WebViewDetector","../../controls/commands/Commands.resx","../../controls/sharing/share/commands/ShareCommandBuilder","../../controls/sharing/share/odc/CommandBuilder","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","../../controls/sharing/share/odc/Share.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.commands=r.observableArray();n.engagementSource=t.engagementSource;var i,p=s.isFeatureEnabled(s.UseNewShareDialog)&&(!u.isOneDriveWinApp()||s.isFeatureEnabled(s.UseNewShareDialogForWinApp));p&&((i=new(n.managed(l.default))({renderLabel:2,mode:c.Mode.share,itemsKey:h.manageAccessShareResourceKey,text:a.default.Share,tooltip:a.default.ShareCommandTooltipV3,icon:r.observable(new o.default("Share")),keys:["S"],engagementName:"newShareCommand",isHidden:r.observable(!1)}).command).payload.calloutLayerProps={styles:{root:{zIndex:600}}});n.commands=p?n.observables.createArray([i]):n.observables.createArray([new(n.managed(f.default))({renderLabel:2,mode:2,item:t.item}).command]);s.isFeatureEnabled(s.AddPeopleReact)&&n.commands.push(new(n.managed(f.default))({renderLabel:2,mode:4,item:t.item}).command);return n}return t})(i.default);t.default=p});
define("odsp-next/controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage",["require","exports","react","office-ui-fabric-react/lib/MessageBar","@ms/odsp-utilities/lib/string/StringHelper","../MalwareDetectedMessage.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.malwareDetectedMessage=function(){var e=n.createElement("a",{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},s.default.malwareDetectedMessageLearnMore),t=i.formatToArray(s.default.malwareDetectedMessage,e);return n.createElement(r.MessageBar,{messageBarType:r.MessageBarType.severeWarning,isMultiline:!0},t)}});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutor",["require","exports","./ShowSuggestedFilesExecutor.html","./ShowSuggestedFilesExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-show-suggestedFiles-executor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:panelOverlayTagName,params:{ariaLabel:suggestedFilesPanelName,width:320,onClose:$component.onClosePanel.bind($component)}}--\x3e<div class="od-SuggestedFiles-container"><div class="od-SuggestedFiles-titleBar"><div class="od-SuggestedFiles-head" data-bind="text:suggestedFilesPanelName"></div></div><div class="od-SuggestedFiles-description" data-bind="text:suggestedFilesPanelDescription"></div><div class="od-SuggestedFiles-activities" data-bind="react:{componentType:suggestedFileTypeListComponent,props:suggestedFileTypeListProps}"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../bindings/react/ReactBinding","../../controls/vaultSuggestCard/react/VaultSuggestedFileTypeList","../../controls/vaultSuggestCard/VaultSuggestCard.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:s.default});n.panelOverlayTagName=i.default.tagName;n.suggestedFilesPanelName=u.default.SuggestedFilesPanelName;n.suggestedFilesPanelDescription=u.default.SuggestedFilesPanelDescription;n.suggestedFileTypeListComponent=o.default;n.suggestedFileTypeListProps=n.createPureComputed(n._updatesuggestedFileTypeListProps);return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._updatesuggestedFileTypeListProps=function(){return{resources:this.resources,onPanelDismissed:this.onClosePanel.bind(this)}};return t})(r.default);t.default=a});
define("odsp-next/controls/vaultSuggestCard/react/VaultSuggestedFileTypeList",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Styling","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","office-ui-fabric-react/lib/common/DirectionalHint","../../../resources/ControlResourceKeys","../../fluentStyling/FluentStyling.key","../VaultSuggestCard.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._getFileTypeList=function(e){return n._fileTypeStrings.map(function(t){return{typeName:t,isExpanded:t===e}})};n._onRenderCell=function(e,t){if(e){var s=i.css("od-SuggestedFiles-TypeCell",{"od-SuggestedFiles-TypeCell--isSelected":e.isExpanded&&n.isFluentEnabled});return r.createElement("div",{className:s,"data-is-focusable":!0},r.createElement("div",{className:"od-SuggestedFiles-TypeName"},e.typeName),r.createElement(o.IconButton,{iconProps:{iconName:"More"},onRenderMenuIcon:function(){return null},className:"od-SuggestedFiles-MoreCommands",menuProps:n._getMenuProps(e,t),styles:n.isFluentEnabled?n._getIconStyles(n._theme):void 0}))}};n._getIconStyles=function(e){var t=e.palette;return{root:{color:t.neutralSecondary,width:"28px",height:"28px",margin:"4px",borderRadius:"2px"},rootHovered:{color:t.neutralSecondary,backgroundColor:t.neutralLight},rootPressed:{color:t.neutralSecondary,backgroundColor:t.neutralQuaternaryAlt},rootExpanded:{color:t.neutralSecondary,backgroundColor:t.neutralLight},rootExpandedHovered:{backgroundColor:t.neutralQuaternaryAlt}}};n._getMenuProps=function(e,t){return{ariaLabel:e.typeName,shouldFocusOnMount:!0,directionalHint:l.DirectionalHint.bottomRightEdge,directionalHintFixed:!0,onMenuOpened:n._onMenuOpened,onMenuDismissed:n._onMenuDismissed,items:[n._getUploadCommand(),n._getMoveCommand()]}};n._getUploadCommand=function(){return{key:"upload",name:p.default.UploadFile,onClick:n._uploadAction}};n._uploadAction=function(e){n.props.onPanelDismissed&&n.props.onPanelDismissed();n._uploadFileAction.execute(e)};n._onMenuOpened=function(e){if(e&&e.ariaLabel){var t=n._getTypeName(e.ariaLabel);n.setState({suggestedFileTypeList:n._getFileTypeList(t)});t&&a.Engagement.logData({name:"Vault.SuggestedFile.Clicked",extraData:{FileType:t}})}console.log("... clicked, "+(e&&e.title))};n._onMenuDismissed=function(e){n.setState({suggestedFileTypeList:n._getFileTypeList()})};n._getTypeName=function(e){for(var t=0,n=Object.keys(p.default);t<n.length;t++){var r=n[t];if(p.default[r]===e)return e}return""};n._getMoveCommand=function(){return{key:"move",name:p.default.MoveExistingLink,onClick:n._moveExistingAction}};n._moveExistingAction=function(e){n.props.onPanelDismissed&&n.props.onPanelDismissed();(new(n.resources.injected(n.actionMap.AddToFolderAction))).execute(e)};n.resources=t.resources;n.actionMap=n.resources.consume(c.actionMap);n.isFluentEnabled=n.resources.consume(h.resourceKey);n._theme=u.getTheme();n._fileTypeStrings=[p.default.Passport,p.default.DriversLicense,p.default.TaxRecords,p.default.BirthCertificate,p.default.AutomotiveInsurance,p.default.CreditReport,p.default.FinancialPlan,p.default.FinancialBudget,p.default.IncomeRecords,p.default.HomeInsurance,p.default.ApartmentInsurance,p.default.CyberInsurance,p.default.VehicleInformation,p.default.TravelDocument,p.default.IdentificationDocument,p.default.WorkIdentification,p.default.SchoolIdentification,p.default.ProfessionalLicense,p.default.PropertyRecord,p.default.PropertyDeed,p.default.EducationalTranscript,p.default.EducationalDegree,p.default.ImmigrationDocuments,p.default.PowerOfAttorney,p.default.BusinessFormationDocument,p.default.Other];n._uploadFileAction=new(n.resources.injected(n.actionMap.UploadAction))({uploadProcessorType:f.UploadProcessorType.Html5file});n.state={suggestedFileTypeList:n._getFileTypeList()};return n}t.prototype.render=function(){return r.createElement("div",{className:"od-SuggestedFiles-TypeList"},r.createElement(s.List,{items:this.state.suggestedFileTypeList,onRenderCell:this._onRenderCell}))};return t})(r.Component);t.default=d});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor",["require","exports","./ShowReactVersionHistoryExecutor.html","./ShowReactVersionHistoryExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-show-version-history-executor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:{name:panelTagName,params:{ariaLabel:panelTitle,size:panelSize,onClose:$component.onClosePanel.bind($component),virtualParentElement:virtualParentElement}}--\x3e<div class="od-versionHistory-panelTitle" data-bind="text:panelTitle"></div><div class="od-versionHistory-container" role="application"><div data-bind="react:{componentType:listComponent,props:listComponentProps}"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../bindings/react/ReactBinding","../../bindings/html/BindableHtmlBinding","../../controls/versionHistory/VersionHistory.resx","../../controls/overlays/panel/PanelOverlay","../../providers/versionHistory/VersionHistoryProvider","../../controls/versionHistory/react/ReactVersionHistoryList"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:s.default,react:i.default});n.panelTagName=u.default.tagName;n.panelSize="Medium";n.panelTitle=o.default.panelName;var r=t.item,l=n.createObservable([]);n.addBindingHandlers({react:i.default});n.resources.consume(a.resourceKey).getVersionHistoryInfo(r()).then(function(e){l(e)});n.listComponent=f.default;n.listComponentProps={items:l,fileItem:r(),resources:n.resources};n.virtualParentElement=t.event?n._getVirtualParent(t.event.target):void 0;return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};return t})(r.default);t.default=l});
define("odsp-next/providers/versionHistory/VersionHistoryProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataSource=t.dataSource}e.prototype.getVersionHistoryInfo=function(e){return this._dataSource.getVersionHistoryInfo(e)};e.prototype.restoreVersionByLabel=function(e,t){return this._dataSource.restoreVersionByLabel(e,t)};e.prototype.deleteVersionByLabel=function(e,t){return this._dataSource.deleteVersionByLabel(e,t)};e.prototype.canRestoreVersions=function(e){return this._dataSource.canRestoreVersions(e)};e.prototype.canDeleteVersions=function(e){return this._dataSource.canDeleteVersions(e)};e.prototype.showVersionLabel=function(){return this._dataSource.showVersionLabel()};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{dataSource:r.versionHistory})});
define("odsp-next/controls/versionHistory/react/ReactVersionHistoryList",["require","exports","tslib","react","office-ui-fabric-react/lib/DetailsList","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/index","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../../../resources/ControlResourceKeys","../../../providers/versionHistory/VersionHistoryProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../models/item/OneDriveItem","../VersionHistory.resx","../../commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/graft/Graft","../../list/react/detailsList/fields/UserRenderer","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.resources=t.resources;n.fileItem=t.fileItem;n.state={items:[],onItemContextMenu:null,menuProps:null};n._versionHistoryProvider=n.resources.consume(d.resourceKey);n.columns=n._getColumns();n.selectionMode=t.selectionMode;n.scope=new u.default;n.observables=n.scope.attach(new(n.resources.consume(s.observablesFactoryTypeResourceKey))({owner:n}));n._actionMap=n.resources.consume(p.actionMap);n._platform=n.resources.consume(x.platformDetection);n._isFluentEnabled=n.resources.consume(T.resourceKey);return n}t.prototype.UNSAFE_componentWillMount=function(){this.observables.compute(this._computeItems).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};t.prototype.render=function(){var e=this.state,t=e.items,s=e.onItemContextMenu,u=e.menuProps;return r.createElement("div",null,r.createElement(i.DetailsList,{items:t,columns:this.columns,selectionMode:o.SelectionMode.none,onItemContextMenu:s,getRowAriaLabel:this._getAriaLabel,className:"od-versionHistoryList",ariaLabel:"List of versions, use up and down arrow keys to navigate, use the SPACE key to select within the list."}),u&&r.createElement(l.ContextualMenu,n.__assign({},u)))};t.prototype._getAriaLabel=function(e){return y.default.columnNameNumber+" "+e.versionLabel+", "+y.default.columnNameModifiedDate+" "+e.created.toString()+", "+y.default.columnNameModifiedBy+" "+e.createdBy.Title+", "+y.default.columnNameSize+" "+c.default.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._reLoadPage=function(){var e=this;this._versionHistoryProvider.getVersionHistoryInfo(this.fileItem).then(function(t){e.setState({items:t})})};t.prototype._computeItems=function(){var e=this,t=this.props.items();this.setState({items:t,onItemContextMenu:function(t,r,i){e.setState({menuProps:n.__assign({target:"#more-"+t.id},e._getMenuProps(t))})}})};t.prototype._modifiedDateOnRender=function(e,t,n){var i;i=this._isFluentEnabled?h.getFriendlyDateTimeStringPast(new Date(e.created)):r.createElement("a",{className:"od-modifiedDateColumn-modifiedDate","aria-label":w.format(y.default.cellAriaLabel,y.default.columnNameModifiedDate,h.getFriendlyDateTimeStringPast(new Date(e.created))),href:this._getOpenFileLink(e)},h.getFriendlyDateTimeStringPast(new Date(e.created)));return r.createElement("div",{className:"od-modifiedDateColumn"},i)};t.prototype._versionNumberOnRender=function(e,t,n){var i;i=this._isFluentEnabled?r.createElement("a",{className:"od-versionNumberColumn-versionNumber","aria-label":w.format(y.default.cellAriaLabel,y.default.columnNameNumber,e.versionLabel),href:this._getOpenFileLink(e)},e.versionLabel):e.versionLabel;return r.createElement("div",{"data-is-focusable":"true",className:"od-versionNumberColumn","aria-label":w.format(y.default.cellAriaLabel,y.default.columnNameNumber,e.versionLabel)},i)};t.prototype._onDotDotDotRender=function(e,t,i){var s=this,o=r.createElement(f.IconButton,{id:"more-"+e.id,className:"od-FieldRenderer-dot od-modifiedDateColumn-moreButton",role:"button",ariaLabel:y.default.buttonNameDotdotdot,iconProps:{iconName:this._isFluentEnabled?"MoreVertical":"More"},onClick:function(){return s.setState({menuProps:n.__assign({target:"#more-"+e.id},s._getMenuProps(e))})}});return this._isFluentEnabled?r.createElement("div",{className:"od-FieldRenderer-dotDotDotContainer"},o):o};t.prototype._getColumns=function(){var e=this,t=[{key:"version.dotdotdot",name:"",columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.default.columnHeaderAriaLabel,y.default.columnNameDotdotdot),fieldName:null,minWidth:36,maxWidth:36,onRender:function(t,n,r){return e._onDotDotDotRender(t,n,r)}},{key:"version.modifiedBy",name:y.default.columnNameModifiedBy,columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.default.columnHeaderAriaLabel,y.default.columnNameModifiedBy),fieldName:null,minWidth:80,maxWidth:160,onRender:function(t,n,r){return S.userRendererByUser([{title:t.createdBy.Title,email:t.createdBy.Email,picture:void 0,sip:t.createdBy.Email}],e.resources,{text:"version.modifiedBy",isDisabled:!1,ariaLabel:w.format(y.default.cellAriaLabel,y.default.columnNameModifiedBy,t.createdBy.Title)},"od-modifiedByColumn")}},{key:"version.size",name:y.default.columnNameSize,columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.default.columnHeaderAriaLabel,y.default.columnNameSize),fieldName:null,minWidth:80,maxWidth:80,onRender:function(e,t,n){return r.createElement("div",{"data-is-focusable":"true",className:"od-fileSizeColumn","aria-label":w.format(y.default.cellAriaLabel,y.default.columnNameSize,c.default.getDisplayString(e.size,{ignoreZero:!0}))},e.size?c.default.getDisplayString(e.size,{ignoreZero:!0}):"")}}],n={key:"version.modifiedDate",columnActionsMode:i.ColumnActionsMode.disabled,name:y.default.columnNameModifiedDate,ariaLabel:w.format(y.default.columnHeaderAriaLabel,y.default.columnNameModifiedDate),fieldName:null,minWidth:80,maxWidth:160,onRender:function(t,n,r){return e._modifiedDateOnRender(t,n,r)}};this._isFluentEnabled?t.splice(1,0,n):t.unshift(n);this._versionHistoryProvider.showVersionLabel()&&t.unshift({key:"version.number",name:y.default.columnNameNumber,columnActionsMode:i.ColumnActionsMode.disabled,fieldName:null,minWidth:this._isFluentEnabled?80:40,maxWidth:this._isFluentEnabled?80:40,ariaLabel:w.format(y.default.columnHeaderAriaLabel,y.default.columnNameNumber),onRender:function(t,n,r){return e._versionNumberOnRender(t,n,r)}});return t};t.prototype._getOpenFileLink=function(e){var t=this.fileItem,n=new g.default(t.key);E.default(n,t);e.isCurrentVersion||E.default(n,{properties:{path:e.url}});var r=this.resources.consume(v.url),i=this.resources.consume(m.navigation),s=this._platform.isMac;return t.appMap&&!s?r.getOpenInOfficeClientUrl(n,i.viewParams):e.url};t.prototype._getMenuProps=function(e){var t=this;return{directionalHint:a.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,items:this._getMenuItems(e),gapSpace:0,onDismiss:function(){return t.setState({menuProps:null})}}};t.prototype._getMenuItems=function(e){var t=this,n={key:"version.restore",name:y.default.versionActionNameRestore,onClick:function(){t._versionHistoryProvider.restoreVersionByLabel(t.fileItem,e.versionLabel).then(function(e){e&&t._reLoadPage()})}},r={key:"version.open",name:y.default.versionActionNameOpen,onClick:function(n,r){return new(t.resources.injected(t._actionMap.NavigationAction))({url:t._getOpenFileLink(e)}).execute(n)}},i={key:"version.download",name:b.default.Download,onClick:function(n,r){return new(t.resources.injected(t._actionMap.NavigationAction))({url:t._getOpenFileLink(e)}).execute(n)}},s={key:"version.delete",name:y.default.versionActionNameDelete,onClick:function(){t._versionHistoryProvider.deleteVersionByLabel(t.fileItem,e.versionLabel).then(function(e){e&&t._reLoadPage()})}},o=[];this._canRestoreVersion(e)&&o.push(n);this._platform.isMac?o.push(i):o.push(r);this._canDeleteVersion(e)&&o.push(s);return o};t.prototype._canDeleteVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canDeleteVersions(this.fileItem)};t.prototype._canRestoreVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canRestoreVersions(this.fileItem)};return t})(r.Component);t.ReactVersionHistoryList=N;t.default=N});
define("odsp-next/controls/list/react/detailsList/fields/UserRenderer",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","react","office-ui-fabric-react/lib/Utilities","knockout","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-datasources/lib/Permissions","../../../../../providers/bundleLoader/PageLoadMonitor","./../../../../../resources/ProviderResourceKeys","../../../../../resources/DataSourceResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Async","../../../../peopleCard/PeopleCardCommons","../../../../../utilities/features/Features","../../../../../utilities/delayLoading/DelayLoadingHelper","./BaseText","@ms/odsp-list-utilities/lib/Renderers/BaseText","../../../../../controls/personaCard/EasyLpc","../../../../../dataSources/item/vroom/TopCollaboratorExperimentHelper","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=new d.default,T=void 0,N=m.isFeatureEnabled(m.PeopleCardsReactComponent),C=m.isFeatureEnabled(m.PeopleCardsOnLoki),k=null;t.userRenderer=function(e){var t=e.item,n=e.column,r=e.resources,i=e.isDisabled,o=t.properties[n.key],u=Array.isArray(o)?o:o?[o]:[],a=t.properties.isDisabled||i,f=y.getCellText(t,n);return f||u.length?O(u,r,{text:f,withTopCollaborator:"sharedByUser"===n.key,isDisabled:a,ariaLabel:u.length?y.getAriaLabel(n,u[0].title):""},s.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":C||N,"od-FieldRenderer--disabled":a})):null};function L(e,t){var n=t.consume(c.profile.optional);if(n){var r=e.map(function(e){return e.sip});n.personRendered(r)}return{lastMouseMove:null,showCardTimeoutId:-1,prepareCardTimeoutId:-1}}t.generatePeopleCardState=L;function A(t){if(!T){var n=t.consume(c.bundleLoader);T=n.waitForPageRenderingComplete().then(function(){return new r.default(function(t,n){x.setTimeout(function(){t(a.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["../../../../personaCard/PersonaCardLauncher"],t,n)}))}}))},1e3)})})}}t.loadPeopleCardComponent=A;function O(e,t,n,r){var s=e||[],o=n.text,u=n.ariaLabel,a=n.noTextRender,l=n.title,c=n.isDisabled,p=n.withTopCollaborator;if(t.consume(h.identity).getIdentity().type===f.IdentityType.anonymous)return i.createElement("div",null,s.map(function(e,t){return i.createElement("div",{key:t},i.createElement(b.BaseText,{text:e.title||o,isDisabled:c,ariaLabel:u,noTextRender:a,title:l}))}));N&&A(t);var d=L(s,t);return s.length?i.createElement("div",null,s.map(function(e,n){var s=M({resources:t,user:e,ariaLabel:u,isDisabled:c,withTopCollaborator:p,noTextRender:a,cellClassName:r,state:d});return i.createElement("div",{key:n},s)})):i.createElement(b.BaseText,{text:o,isDisabled:c,ariaLabel:u,noTextRender:a,title:l})}t.userRendererByUser=O;function M(t){var r=t.user,s=t.resources,o=t.ariaLabel,u=t.isDisabled,a=t.noTextRender,f=t.withTopCollaborator,h=r.email||r.sip;if(!h)return i.createElement(b.BaseText,{text:r.title,isDisabled:u,ariaLabel:o,noTextRender:a,title:r.title});if(t.resources.isExposed(p.pageContext)){var d=s.consume(p.pageContext),m=i.createElement(w.EasyLpc,{personaType:"User",identifier:h,loggingData:{name:"UserRenderer.LPC.Click"},placeHolder:i.createElement("span",{className:t.cellClassName},r.title)},i.createElement("span",{className:t.cellClassName,"data-is-focusable":!0,role:"button","aria-label":t.ariaLabel},r.title));return f&&E.topCollaboratorExperiment(d)?i.createElement("div",{className:"od-userWithTopCollaborator"},(function(t,r){var s={load:function(){return new Promise(function(t,n){e(["@ms/odsp-shared-react/lib/components/TopCollaborator/TopCollaborator"],t,n)}).then(function(e){return e.TopCollaborator})},parse:void 0},o={userName:t.title,isPlaceholder:!t.isTopCollaborator},u=r.consume(l.resourceKey),a=g.waitForPageLoadWithTimeout(u),f={modulePath:"@ms/odsp-shared-react/lib/components/TopCollaborator/TopCollaborator",moduleLoader:s,customWaiter:a,props:o};return i.createElement(S.ReactDeferredComponent,n.__assign({},f))})(r,s),m):m}return i.createElement("span",{ref:function(e){N&&e&&r&&h?(function(e,t,n){T&&T.then(function(r){k=e;r.personaRendered(e,t,n.consume(p.pageContext))})})(e,h,t.resources):k&&(function(e,t,n){T&&T.then(function(r){r.personaRemoved(e,t,n.consume(p.pageContext))})})(e,h,t.resources)},className:t.cellClassName,"data-is-focusable":!0,role:"button","aria-label":t.ariaLabel,onMouseOut:function(e){return D(t.state)},onMouseMove:function(e){(function(e,t,n,r){void 0===r&&(r=null);if(N)return;if(e&&(e.sip||e.email)){if(-1===n.prepareCardTimeoutId){var i=t.consume(c.profile.optional);n.prepareCardTimeoutId=x.setTimeout(function(){return i.getPeopleCardData(e.email||e.sip)},v.PEOPLE_CARD_DATA_PRELOAD_DELAY)}n.lastMouseMove=r;n.lastMouseMove.persist();-1===n.showCardTimeoutId&&(n.showCardTimeoutId=x.setTimeout(function(){return _(e,t,r,!0)},v.PEOPLE_CARD_HOVER_DELAY))}})(r,t.resources,t.state,e)},onClick:function(e){_(r,t.resources,t.state,e)}},r.title)}t.getUserComponent=M;function _(t,n,i,s,u){void 0===s&&(s=null);void 0===u&&(u=!1);if(!N){(s=s||i.lastMouseMove).stopPropagation();s.preventDefault();s=o.utils.extend({},s);D(i);t&&(t.sip||t.email)&&a.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return r.default.resolve(new Promise(function(t,n){e(["../../../../personaCard/PersonaCardLauncher"],t,n)}))}}).then(function(e){var r={name:t.title,email:t.email,image:t.picture,sip:t.sip||t.email,userId:t.sip};new(n.injected(e))(r).show(s,u)})}}function D(e){x.clearTimeout(e.showCardTimeoutId);x.clearTimeout(e.prepareCardTimeoutId);e.showCardTimeoutId=-1;e.prepareCardTimeoutId=-1;e.lastMouseMove=null}t.resourceKey=new u.ResourceKey({name:e("module").id,factory:new u.ConstantResourceFactory(t.userRenderer)})});
define("odsp-next/utilities/delayLoading/DelayLoadingHelper",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Async"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.default;t.loadModuleOnEvent=function(e,t){if(e){var s=e.eventSource,o=e.eventName,u=e.eventGroup,a=void 0===u?new r.default(this):u;return new i.default(function(e){a.on(s,o,function(){a.off(s,o);n.loadModule({path:t.path,getModule:t.getModule}).then(e)})})}return n.loadModule({path:t.path,getModule:t.getModule})};t.getReactDeferredComponentModuleLoader=function(){return{load:function(e,t){return n.loadModule({path:e,getModule:t}).then(function(t){var n;return(n={})[e]=t,n})},parse:void 0}};t.waitForPageLoadWithTimeout=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=1e3);var r=new s.default;(1===t?e.waitForPageRenderingComplete():e.waitForPLT()).then(function(){u.setTimeout(function(){return r.complete()},n)});return r.getPromise()}});
define("odsp-next/controls/list/react/detailsList/fields/BaseText",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/BaseText"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,r=e.item,i=e.column,a=e.children,f=e.noTextRender,l=e.title,c=o(i,t),h=r&&r.properties.isDisabled||e.isDisabled;void 0===t&&(t=u(r,i));return n.createElement(s.BaseText,{text:t,isDisabled:h,ariaLabel:c,noTextRender:f,title:l},a)};function o(e,t){(!t||e.internalName&&"attachments"===e.internalName.toLowerCase()&&"0"===t)&&(t=i.default.emptyValueAriaLabel);return r.format(i.default.cellAriaLabel,e.name,t)}t.getAriaLabel=o;function u(e,t){var n="";if(e&&void 0===(n=e[t.key])&&e.properties){void 0===(n=e.properties[t.key])&&(n=e.recycleBinProperties[t.key]);n&&Array.isArray(n)&&(n=n.join(", "))}return n}t.getCellText=u;t.isCellChanged=function(e,t,n){return!(!e||!t)&&u(e,n)!==u(t,n)}});
define("@ms/odsp-list-utilities/lib/Renderers/BaseText",["require","exports","react","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,i=e.isDisabled,s=e.noTextRender,o=e.ariaLabel,u=e.children;t=t||" ";o=o||t;return n.createElement("div",{"aria-label":s?o:void 0,className:r.css(e.className,{"od-FieldRenderer--disabled":i})},s?null:n.createElement("span",null,t),u)}});
define("odsp-next/controls/personaCard/EasyLpc",["require","exports","tslib","react","../../resources/SPOResourceKeys","../../utilities/delayLoading/DelayLoadingHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard","../../providers/bundleLoader/PageLoadMonitor","../base/react/WithResources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EasyLpc=function(e){var t=e.pageLoadBarrier,l=e.identifier,c=e.children,h=n.__rest(e,["pageLoadBarrier","identifier","children"]),p=f.useResourceScope(),d=r.useState(function(){return s.getReactDeferredComponentModuleLoader()})[0],v=r.useMemo(function(){return t?o.CancelablePromise.resolve(t):void 0},[t]),m=v?void 0:p.consume(a.resourceKey),g=r.useState(function(){return m?s.waitForPageLoadWithTimeout(m):void 0})[0],y=v||g;return void 0===l?r.createElement(r.Fragment,null,c):r.createElement(u.DeferredSpLivePersonaCard,n.__assign({identifier:l,moduleLoader:d,customWaiter:y,pageContext:p.consume(i.pageContext)},h),c)}});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../ReactDeferredComponent/index","@ms/odsp-utilities/lib/features/FeatureOverrides","ODCExecutors_css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={ODB:1596},a=(function(t){n.__extends(i,t);function i(n,r){var i=t.call(this,n,r)||this;i._onActivate=function(){i.state.hovered||i.setState({hovered:!0})};i.modulePath="./SpLivePersonaCard";i.moduleLoader={load:function(){return new Promise(function(t,n){e(["./SpLivePersonaCard"],t,n)}).then(function(e){return e.SpLivePersonaCard})}};i.state={hovered:!o.default.isFeatureEnabled(u)};return i}i.prototype.render=function(){var e=this.state.hovered;this._deferredComponentProps={modulePath:this.modulePath,moduleLoader:this.moduleLoader,props:this.props,customWaiter:this.props.customWaiter,placeHolder:this.props.placeHolder};return r.createElement("div",{onMouseOver:this._onActivate,onClick:this._onActivate,onFocus:this._onActivate,onMouseDown:this._onActivate,onKeyDown:this._onActivate,className:"sp-deferredLivePersonaCard-root",tabIndex:-1},e?r.createElement(s.ReactDeferredComponent,n.__assign({},this._deferredComponentProps),this.props.children):this.props.children)};return i})(i.BaseComponent);t.DeferredSpLivePersonaCard=a;t.wrapWithDeferredSpLivePersonaCard=function(e,t){return r.createElement(a,n.__assign({},e),t)}});
define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index",["require","exports","tslib","./ReactDeferredComponent"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/ReactDeferredComponent",["require","exports","tslib","react","@uifabric/utilities/lib/hoist"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e));if(!e){var t="ReactDeferredComponent: component not found when loading "+n.props.modulePath+" - check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})};n._mounted=!1;n.state={ComponentModule:void 0};n._setupDeferLoadCallback(t);return n}t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?r.createElement(t,n.__assign({ref:function(t){t&&i.hoistMethods(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null};t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)};t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()};return t})(r.Component);t.ReactDeferredComponent=s});
define("odsp-next/dataSources/item/vroom/TopCollaboratorExperimentHelper",["require","exports","@ms/sp-experiments/lib/flightsonrails/SPExperiment"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorExperiment=function(e){switch(n.getVariantAndLogExposure(90012,e)){case 1:return!0;default:return!1}}});
define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../resources/ControlResourceKeys","../../NavigationAction","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._viewParams=n.resources.consume(s.viewParams);return n}t.prototype.execute=function(e){var t=u.extend({},this._viewParams.peek());t.ft?delete t.ft:t.ft=8..toString();return new(this.managed(o.default))({url:"#"+i.serializeQuery(t),ignoreHistory:!0}).execute(null)};return t})(r.default);t.default=a});
define("odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/commands/Commands.resx","../../../controls/addToAlbum/AddToAlbum","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.itemSelectionHelper,s=t.panelProvider;n.name=r;n._itemSelectionHelper=i;n._panelProvider=s;n._itemReedemer=n.resources.consume(u.resourceKey);n._currentItem=n.resources.consume(a.currentItem);return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){var n=t._panelProvider.requestPanel({title:i.default.AddToAlbum,component:{name:s.default.tagName,params:{selection:e,onComplete:function(){n.state(1)},currentAlbumKey:t._currentItem.peek().key}}});return n.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})})})};return t})(r.default);t.default=f});
define("odsp-next/controls/addToAlbum/AddToAlbum",["require","exports","./AddToAlbum.html","./AddToAlbumViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-add-to-album",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/addToAlbum/AddToAlbum.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-AddToAlbum">\x3c!--ko ifnot:isLoading--\x3e<div class="od-AddToAlbum-createArea od-TextField"><form class="od-AddToAlbum-form od-AddToAlbum-form--buttonVisible" data-bind="submit:createNewAlbum,css:{\'od-AddToAlbum-form--errorVisible\':hasError}"><input type="text" class="od-TextField-field" autocomplete="off" data-bind="textInput:newAlbumName,attr:{placeholder:newAlbumPlaceholder},hasFocus:createNewAlbumInputIsVisible,css:{\'od-AddToAlbum-createAreaInput--error\':hasError}"><p class="od-AddToAlbum-error" data-bind="visible:hasError,text:nameCollisionErrorString"></p><p class="od-AddToAlbum-savingText" data-bind="visible:isMakingRequest,text:savingText"></p><button type="submit" class="od-Button od-Button--primary od-AddToAlbum-createNewAlbumButton od-AddToAlbum-createNewAlbumButton--visible" data-bind="click:createNewAlbum,disable:isSubmitDisabled"><span class="od-Button-label" data-bind="text:createNewAlbumText"></span></button><div class="ms-clearfix"></div></form></div>\x3c!--ko if:children().length&&isFluentEnabled--\x3e<div class="od-AddToAlbum-albumRowTitle ms-fontWeight-semibold" data-bind="text:albumListTitle"></div>\x3c!--/ko--\x3e\x3c!--ko foreach:children--\x3e<div class="od-AddToAlbum-albumRow" data-bind="click:$parent.onClickAlbumRow.bind($parent)"><a href="#" data-bind="attr:{title:name}"><span class="thumbnail"><div class="od-AddToAlbum-albumThumbnail" data-bind="component:{name:$component.imageFrameTagName,params:{image:folder.covers[0],desiredSize:$parent.thumbnailSize}}"></div></span><div class="od-AddToAlbum-albumName" data-bind="text:name,css:{\'ms-font-l\':!$parent.isFluentEnabled,\'ms-font-m\':$parent.isFluentEnabled}"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if:shouldShowEmptyAlbumList--\x3e<div class="od-AddToAlbum-emptyList"><img class="od-AddToAlbum-emptyListImage" data-bind="attr:{src:emptyAlbumListImgSrc}"><p class="od-AddToAlbum-emptyListTitle ms-font-xl ms-fontWeight-semilight" data-bind="text:emptyAlbumListTitle"></p><p class="od-AddToAlbum-emptyListBody ms-font-m" data-bind="text:emptyAlbumListBody"></p></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isLoading--\x3e<div class="od-AddToAlbum-progressSpinner" data-bind="component:{name:progressSpinnerFlatTagName}"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/addToAlbum/AddToAlbumViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../providers/album/AlbumProvider","../../providers/item/ItemProvider","../../actions/createAlbum/CreateAlbumHelper","../../resources/DataSourceResourceKeys","./AddToAlbum.resx","../commands/Commands.resx","../progressSpinnerFlat/ProgressSpinnerFlat","../image/frame/ImageFrame","../../bindings/keyboard/KeyboardBinding","../../models/item/OneDriveItem","../../models/itemSet/ItemSet","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../actions/createAlbum/CreateAlbumOperator","../../controls/fluentStyling/FluentStyling.key","../../models/itemsScope/ItemsScopeFeature.key","../../utilities/albums/itemsScope/AlbumsInvalidator.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.thumbnailSize={width:50,height:50};n._albumProvider=n.resources.consume(i.resourceKey);n._urlDataSource=n.resources.consume(u.url);n._itemProvider=n.resources.consume(s.resourceKey);n._onComplete=t.onComplete;n._currentAlbumKey=t.currentAlbumKey?t.currentAlbumKey:"";n.addBindingHandlers({keyboard:h.default});n.newAlbumName=n.createObservable("");n.newAlbumPlaceholder=a.default.newAlbumPlaceholder;n.emptyAlbumListTitle=a.default.emptyAlbumListTitle;n.emptyAlbumListBody=a.default.emptyAlbumListBody;n.albumListTitle=a.default.albumListTitle;n.createNewAlbumText=f.default.CreateCommit;n.closeText=f.default.Close;n.savingText=f.default.Saving;n.progressSpinnerFlatTagName=l.default.tagName;n.imageFrameTagName=c.default.tagName;n.isLoading=n.createObservable(!0);n.isMakingRequest=n.createObservable(!1);n.isSubmitDisabled=n.createComputed(n._computeSubmitDisabled);n.selection=t&&t.selection;n.createNewAlbumInputIsVisible=n.createObservable(!1);n.nameCollisionErrorString=n.createObservable("");n.hasError=n.createComputed(n._computeHasError);n.emptyAlbumListImgSrc=window.require.toUrl("odsp-media/images/album/empty-albums-list.svg");n.shouldShowEmptyAlbumList=n.createObservable(!1);n.isFluentEnabled=n.resources.consume(g.resourceKey);if(!n.selection)throw new Error("No items passed to Add to Album control");var r=new p.default,o=new d.default;o.item=n.createObservable(r);n.itemSet=n.createObservable(o);n.itemSet.equalityComparer=v.objectStrictEquality;n.children=n.observables.createArray([]);n.children.equalityComparer=v.arrayStrictEquality;n.init();n.createComputed(function(){n.newAlbumName();n.nameCollisionErrorString("")});return n}t.prototype.init=function(){var e=this,t={parentKey:this._albumProvider.getAlbumsParentKey({}),ownerId:this._urlDataSource.getOwnerId(),pageSize:100,startIndex:0,isAscending:!1};this.itemSet(this._itemProvider.getItemSync(t));this._itemProvider.getItem(t).then(function(t){e.isLoading(!1);e._updateChildrenSet()},function(e){})};t.prototype.onClickAlbumRow=function(e,t){this.isMakingRequest(!0);var n={album:e,items:this.selection};this._albumProvider.addToAlbum(n);this._onComplete()};t.prototype.createNewAlbum=function(e,t){var n=this,r=this.unwrapObservable(this.newAlbumName).trim(),i=this.selection,s=o.validateAlbumCreation(i,r);if(s){this.nameCollisionErrorString(s);return!1}this.isMakingRequest(!0);this.resources.consumeAsync(m.typeResourceKey).then(function(e){var t=new e({name:r,keys:i.filter(function(e){return!!e}).map(function(e){return e.key})});return n.trackPromise(t.start())}).done(function(){n.resources.consume(y.isItemsScopeEnabledInAllAlbumsPivotResourceKey)&&n.resources.consumeAsync(b.resourceKey).then(function(e){e.invalidate()});n._onComplete()},function(e){n.isMakingRequest(!1);n.nameCollisionErrorString(e&&e.error&&e.error.message||"")});return!1};t.prototype.onCloseButtonClick=function(e,t){this._onComplete()};t.prototype.setFocusToInput=function(e,t){this.createNewAlbumInputIsVisible(!0)};t.prototype._computeHasError=function(){return this.nameCollisionErrorString&&!!this.nameCollisionErrorString()};t.prototype._computeSubmitDisabled=function(){return this.newAlbumName().trim().length<1||this.isMakingRequest()};t.prototype._updateChildrenSet=function(){var e=this,t=this.itemSet().content().items;if(this._currentAlbumKey)t=t.filter(function(t){var n=e.unwrapObservable(t);e._updateCurrentItem(n);return n.key!==e._currentAlbumKey});else for(var n=0,r=t;n<r.length;n++){var i=r[n];this._updateCurrentItem(this.unwrapObservable(i))}this.shouldShowEmptyAlbumList(t.length<=0);this.children(t)};t.prototype._updateCurrentItem=function(e){e&&e.folder&&e.folder.covers&&0===e.folder.covers.length&&e.folder.covers.push({url:"odsp-media/images/album/empty-album.svg",width:this.thumbnailSize.width,height:this.thumbnailSize.height})};return t})(r.default);t.default=w});
define("odsp-next/actions/createAlbum/CreateAlbumHelper",["require","exports","../../controls/albumBuilder/AlbumBuilder.resx","../../dataSources/item/ItemDataSource.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.validateAlbumCreation=function(e,t){if(!t)return n.default.errorNameNotSpecified;var i=new RegExp('[/"*:<>?/|/]+|[^\0-]+|[.]+$');t=t.trim();if(i.test(t))return r.default.InvalidChar;for(var s=0,o=0,u=e;o<u.length;o++){var a=u[o];(a.photo||a.video)&&s++}return s<e.length?n.default.errorInvalidItems:""}});
define("odsp-next/actions/createAlbum/CreateAlbumOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._albumProvider=n.albumProvider;r._context=t;r._payloads={createAlbum:{name:r.createObservable(""),items:r.createObservable(),album:r.createObservable()}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=i.default.createAlbum;n.name=t.input;n.payloads=this._payloads;t.output&&t.output.isAlbum&&this._payloads.createAlbum.album(t.output);return n};t.prototype.onStart=function(e){return this._albumProvider.createAlbum(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{albumProvider:s.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/utilities/albums/itemsScope/AlbumsInvalidator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".albumsInvalidator",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumsInvalidator"],t,n)}).then(function(e){return e.resourceKey})})});t.default=t.resourceKey});
define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/ApplyOfficeLensOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._item=t.item;n._itemReedemer=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){var n=new(e.managed(o.default))({item:t,parentKey:e._item.key});e.trackPromise(n.start());return n.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t})(r.default);t.default=u});
define("odsp-next/providers/operator/ApplyOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n._context=t;n._processFiltersProvider=n.resources.consume(i.processFilters);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.applyOfficeLens;n.payloads={applyOfficeLens:{item:r}};return n};t.prototype.onStart=function(e){return this._processFiltersProvider.applyOfficeLens(this._context,e)};return t})(r.default);t.default=o});
define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/RemoveOfficeLensOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._item=t.item;n._itemReedemer=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){var n=new(e.managed(o.default))({item:t,parentKey:e._item.key});e.trackPromise(n.start());return n.wait()})}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t})(r.default);t.default=u});
define("odsp-next/providers/operator/RemoveOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n._context=t;n._processFiltersProvider=n.resources.consume(i.processFilters);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.removeOfficeLens;n.payloads={removeOfficeLens:{item:r}};return n};t.prototype.onStart=function(e){return this._processFiltersProvider.removeOfficeLens(this._context,e)};return t})(r.default);t.default=o});
define("odsp-next/actions/addToBundle/odc/AddToBundleExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../controls/bundleBuilder/BundleBuilder","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/UpdateBundleOperator","../../../providers/panel/PanelProvider","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._panelProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=e.observables.createArray(),r=t[0];return e._addToBundleViaPanel(r,n).then(function(){return e._addToBundle(r,n.peek())})})};t.prototype._addToBundleViaPanel=function(e,t){var s=this.observables.create(!1),o={resources:this.resources,bundleName:e.displayName,complete:function(e){t.splice.apply(t,n.__spreadArrays([0,t.peek().length],e.map(function(e){return e.id})));s(!0);return r.default.wrap()},cancel:function(){s(!0);return r.default.wrap()}},u=this._panelProvider.requestPanel({noTitle:!0,hasCommandBar:!0,size:"Large",showCloseButton:!1,component:{name:i.default.tagName,params:o}}),a=this.createComputed(function(){s()&&u.state(1)});return u.wait().then(function(){a.dispose()},function(e){a.dispose();return r.default.wrapError(e)})};t.prototype._addToBundle=function(e,t){var n=this;return t&&0===t.length?r.default.wrap({resultType:s.ResultTypeEnum.Success}):this.resources.consumeAsync(o.typeResourceKey).then(function(r){var i=new r({items:t,bundleAction:0,item:e});n.trackPromise(i.start());return i.wait()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t})(a.default);t.default=f});
define("odsp-next/controls/bundleBuilder/BundleBuilder",["require","exports","./BundleBuilder.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./BundleBuilderViewModel","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-bundle-builder",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/bundleBuilder/BundleBuilder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-BundleBuilder" data-bind="component:{name:filePickerHostTagName,params:filePickerHostParams}"><div class="od-BundleBuilder-content od-ItemContent"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-BundleBuilder-title od-ItemContent-title" data-bind="text:title"></div></div></div></div>'});
define("odsp-next/controls/bundleBuilder/BundleBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","@ms/odsp-utilities/lib/async/Promise","./BundleBuilder.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.filePickerHostTagName=i.default.tagName;var r=t.complete,u=t.cancel,a=t.bundleName,f=t.typeFilter,l=t.viewType,c=void 0===l?1:l,h=t.itemKey,p=t.showCommandBar,d=void 0===p||p,v=t.useMoveString,m=void 0!==v&&v,g=t.allowRootItem,y=void 0===g||g;n.title=a?m?n.format(o.default.moveItemsTitleFormat,a):n.format(o.default.addItemsTitleFormat,a):m?o.default.moveItemsTitle:o.default.addItemsTitle;n.filePickerHostParams={itemKey:h,behavior:{showActions:!1,selectionMode:1,viewType:c,typeFilter:f,completeText:m?o.default.moveItemsTitle:o.default.addItemsTitle,showCommandBar:d,allowRootItem:y},agent:{initialize:function(){return s.default.wrap()},getApplication:function(){return s.default.wrap()},complete:r,cancel:u,switchAccount:function(){return s.default.wrap()}}};return n}return t})(r.default);t.default=u});
define("odsp-next/controls/filePickerHost/FilePickerHost",["require","exports","./FilePickerHost.html","./templates/FilePickerHostInline.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePickerHostViewModel","./templates/FilePickerHostTemplates","../../bindings/component/ControlBinding","ODCExecutors_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="od-file-picker-host",f=n.default,l=i.registerComponent({tagName:a,template:f,viewModel:s.default,synchronous:!0});t.resourceKey=u.createResolvedControlDefinitionResourceKey({automationName:a,name:e("module").id,template:f,viewModelType:s.default});i.registerTemplate(o.INLINE,r.default);t.default=l});
define("odsp-next/controls/filePickerHost/FilePickerHost.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko template:pickerTemplate--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/filePickerHost/templates/FilePickerHostInline.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-FilePickerHost od-FilePickerHost--inline" data-bind="component:pickerComponent">\x3c!--ko host:{data:$host}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/filePickerHost/FilePickerHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","./templates/FilePickerHostTemplates","@ms/odsp-shared/lib/utilities/navigation/InPlaceNavigation","../../resources/ControlResourceKeys","../progressSpinnerFlat/ProgressSpinnerFlat","../../bindings/host/HostBinding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../models/item/ItemType","../../dataSources/url/PageType","../../resources/PagesResourceKeys","../../dataSources/moduleLoader/ModuleLoaderDataSource.key","../../actions/base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:f.default});r._urlDataSource=r.resources.consume(i.url);var m=t.itemKey,g=t.agent,y=t.behavior,b=r._urlDataSource.getDefaultClickUrl({key:m||r._urlDataSource.getRootItemKey(),type:c.default.Folder},{page:h.default.FilePicker,viewParams:{}}),w=new(r.managed(o.default));w.navigateTo({url:b});r.resources.expose(l.navigation,w);r.resources.expose(u.viewParams,w.viewParamsObservable);r.resources.expose(p.base.leftNav.isLeftNavVisible,r.createObservable(!1));r.resources.expose(p.base.leftNav.hideLeftNav,r.createObservable(!1));r.resources.expose(p.base.suiteNav.isSuiteNavHidden,r.createObservable(!0));r.resources.expose(p.base.commandBar.isDarkTheme,r.createObservable(!1));r.resources.expose(p.base.commandBar.isSearchHidden,r.createObservable(!1));r.resources.block(v.typeResourceKey);r._pickerParams={behavior:y,agent:g,shouldHostOverlays:!1};r.pickerComponent=r.createObservable({name:a.default.tagName,params:{}});var E=r._urlDataSource.getPageType(w.viewParamsObservable.peek()),S=r.resources.consume(d.resourceKey).getPageModuleLoader(E);r.trackPromise(S().then(function(e){r.pickerComponent({name:e.tagName,params:r._pickerParams})}));r.pickerTemplate=s.INLINE;return r}return t})(r.default);t.default=m});
define("odsp-next/controls/filePickerHost/templates/FilePickerHostTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INLINE="od-file-picker-host-inline"});
define("odsp-next/actions/feedback/odc/FeedbackExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../bindings/component/ControlBinding","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/feedback/Feedback","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../models/feedback/FeedbackDialogState","../../../providers/dialog/DialogProvider","../../../providers/sendFeedback/SendFeedbackProvider","../../NavigationAction","../../../resources/ODCResourceKeys","../../../dataSources/url/AutoActionType","../../../controls/feedback/Feedback.resx","../../../controls/sendFeedback/SendFeedback.resx","../../../utilities/features/Features","../../../controls/sendFeedback/SendFeedback"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._userInfoProvider=n.resources.consume(a.userInfo);n._urlDataSource=n.resources.consume(p.urlDataSource);n._sendFeedbackProvider=n.resources.consume(c.resourceKey);return n}t.prototype.execute=function(e){var t=this;if(!this._userInfoProvider.isAuthenticated()){var n=this._urlDataSource.getSignInUrlWithAction(d.default.feedback);return new(this.managed(h.default))({url:n,forceNavigation:!0}).execute(e)}var r=this.observables,a=this.resources.consume(l.resourceKey),c=r.create(f.default.initialLoad),p=r.create(""),b=r.create(""),w=r.create(!1),E=g.isFeatureEnabled(g.EnableNewTicketingService);E&&(b=this.createPureComputed(function(){return t._getHeaderText(c)}));var S,x,T={onComplete:function(){N.state(3)},comment:p,state:c,title:b,retryTrigger:w};E?x=i.toSpecification(y.resourceKey,T):S={name:o.default.tagName,params:T};var N=a.requestDialog({title:b,component:S,control:x,actions:[{name:v.default.retryTitle,execute:function(){w(!0);return u.default.wrap(1)},isVisible:r.pureCompute(function(){return c()===f.default.error}),icon:null,isDefault:!0},{name:m.default.sendFeedbackBtnText,execute:function(){return t._submitFeedback(p.peek(),c).then(function(){return u.default.wrap(1)})},isVisible:r.pureCompute(function(){return E&&c()===f.default.initialLoad}),isAvailable:r.pureCompute(function(){return!!p()}),icon:null,isDefault:!0}],size:"Small"});return N.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype._getHeaderText=function(e){var t=e();return t===f.default.error?m.default.errorHeader:t===f.default.done?m.default.successHeader:t===f.default.initialLoad?m.default.emailSupportTitle:t===f.default.feedbackSent?m.default.sendingHeader:""};t.prototype._submitFeedback=function(e,t){t(f.default.feedbackSent);return this._sendFeedbackProvider.sendFeedback(e).then(function(){t(f.default.done)},function(e){t(f.default.error)})};return t})(r.default);t.default=b});
define("odsp-next/controls/feedback/Feedback",["require","exports","./Feedback.html","./FeedbackViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-feedback",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/feedback/Feedback.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-feedback od-feedback-smaller"><div class="od-feedback-inner" data-bind="css:{\'od-feedback--hasError\':state()===states.error}">\x3c!--ko if:state()===states.initialLoad--\x3e<div data-bind="component:progressSpinnerTagName"></div>\x3c!--/ko--\x3e\x3c!--ko if:iframeUrl().length--\x3e<iframe data-bind="attr:{src:iframeUrl},visible:state()===states.showingIframe||state()===states.done"></iframe>\x3c!--/ko--\x3e\x3c!--ko if:state()===states.error--\x3e<p data-bind="text:bodyText"></p>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/feedback/FeedbackViewModel",["require","exports","tslib","knockout","./Feedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/feedback/FeedbackDialogState"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v="Init",m="Submit",g="Close",y="Cancel",b="Confirm",w="Timeout",E="FrameLoad",S=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.states=d.default;n._qos={};n._paratureEvents={};n._urlDataSource=n.resources.consume(l.url);n._reportParatureStage(v);n.state=t.state;n._retryTrigger=t.retryTrigger;n._headerText=t.title;n.progressSpinnerTagName=o.default.tagName;n.bodyText=r.observable("");n.iframeUrl=r.observable("");n._loadTimer=0;n._feedbackProvider=n.resources.consume(u.feedback);n._onComplete=t.onComplete;n.createComputed(n._onRetryTrigger);n._init();return n}t.prototype.dispose=function(){e.prototype.dispose.call(this)};t.prototype.onCloseClicked=function(){this._reportParatureStage(this.state()===d.default.done?g:y);this._onComplete()};t.prototype._init=function(){this.state(d.default.initialLoad);this._headerText(i.default.loadingTitle);this.bodyText("");this.iframeUrl("");this._initListeners();this._initIframe()};t.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};t.prototype._initIframe=function(){var e=this;this._feedbackProvider.getFeedbackUrl().then(function(t){e.iframeUrl(t);e._loadTimer=e.async.setTimeout(e._onIframeTimeout,1e4)},function(t){e._headerText(i.default.errorHeader);e.bodyText(i.default.errorBody);e.state(d.default.error)})};t.prototype._onIframeTimeout=function(){if(this.state()===d.default.initialLoad){this._reportParatureLoadQos(E,!0);this._reportParatureStage(w);this.state(d.default.error);this._headerText(i.default.errorHeader);this.bodyText(i.default.errorBody)}};t.prototype._initListeners=function(){this.events.on(window,"message",this._onReceiveMessage)};t.prototype._onReceiveMessage=function(e){var t=this._feedbackProvider.getFeedbackEndpoints(),n=!1;if(e){for(var r=0,i=t;r<i.length;r++){var s=i[r];if(n=e.origin.startsWith(s))break}if(n){var o={};try{o=JSON.parse(e.data)}catch(e){}o.action?this._handleReceivedAction(o.action):o.location?this.state()===d.default.initialLoad&&this._onParatureLoaded():void 0!==o.height||o.name}}};t.prototype._handleReceivedAction=function(e){switch(e){case"submit":this._reportParatureStage(m);break;case"cancel":this.onCloseClicked();break;case"confirmation":this._onConfirmed()}};t.prototype._onParatureLoaded=function(){this.async.clearTimeout(this._loadTimer);if(this.state()!==d.default.error){this._reportParatureLoadQos(E,!1);this.state(d.default.showingIframe);this._headerText(i.default.emailSupportTitle)}};t.prototype._onConfirmed=function(){this._reportParatureStage(b);this.state(d.default.done);this._headerText(i.default.successTitle)};t.prototype._reportParatureLoadQos=function(e,t){var n=this._qos[e];n||(n=this._qos[e]=new a.Qos({name:"Parature.Flow."+e}));n.end({resultType:t?p.ResultTypeEnum.Failure:p.ResultTypeEnum.Success})};t.prototype._reportParatureStage=function(e){var t=this._paratureEvents[e];t||(t=this._paratureEvents[e]=new f.Action({name:"Parature.Flow."+e,pageType:c.default[this._urlDataSource.getPageType()],queryType:h.default[this._urlDataSource.getQueryType()]}));t.end({resultType:p.ResultTypeEnum.Success})};return t})(s.default);t.default=S});
define("odsp-next/models/feedback/FeedbackDialogState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.initialLoad=0]="initialLoad";e[e.showingIframe=1]="showingIframe";e[e.feedbackSent=2]="feedbackSent";e[e.done=3]="done";e[e.error=4]="error"})(n||(n={}));t.default=n});
define("odsp-next/providers/sendFeedback/SendFeedbackProvider",["require","exports","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._sendFeedbackDataSource=t.sendFeedbackDataSource}e.prototype.sendFeedback=function(e){return this._sendFeedbackDataSource.sendFeedback(e)};return e})();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{sendFeedbackDataSource:n.sendFeedback})});
define("odsp-next/controls/sendFeedback/SendFeedback",["require","exports","./SendFeedback.html","./SendFeedbackViewModel","../../bindings/component/ControlBinding","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-sendfeedback",template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/sendFeedback/SendFeedback.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-sendFeedback od-sendFeedback-smaller"><div class="od-sendFeedback-inner">\x3c!--ko if:state()===states.feedbackSent--\x3e\x3c!--ko component:{name:progressSpinnerTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="od-sendFeedback-area" data-bind="visible:state()===states.initialLoad||state()===states.feedbackSent"><textarea class="od-sendFeedback-textarea" hasfocus="true" data-bind="attr:{\'aria-label\':hintText,placeholder:hintText},textInput:comment"></textarea><a class="od-sendFeedback-Privacy-Link" target="_blank" rel="“noopener”" data-bind="attr:{href:privacyStatementUrl},text:privacyStatementText"></a></div><div aria-live="assertive" class="od-sendFeedback-response">\x3c!--ko if:state()===states.done--\x3e<p data-bind="text:bodyText"></p>\x3c!--/ko--\x3e\x3c!--ko if:state()===states.error--\x3e<p data-bind="text:bodyText"></p>\x3c!--/ko--\x3e</div></div></div>'});
define("odsp-next/controls/sendFeedback/SendFeedbackViewModel",["require","exports","tslib","./SendFeedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-utilities/lib/string/StringHelper","../../models/feedback/FeedbackDialogState","../../providers/sendFeedback/SendFeedbackProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i.states=u.default;i.state=t.state;i._retryTrigger=t.retryTrigger;i.feedbackResx=r.default;i.email=$Config.email;i.lang=$Config.mktLocale;i.progressSpinnerTagName=s.default.tagName;i.hintText=i.feedbackResx.hintText;i.sendFeedbackBtnText=i.feedbackResx.sendFeedbackBtnText;i.bodyText=i.createPureComputed(i._computeBodyText);i.comment=t.comment;i._onComplete=t.onComplete;i.createComputed(i._onRetryTrigger);i.privacyStatementText=i.feedbackResx.privacyLink;i.privacyStatementUrl="https://privacy.microsoft.com/"+i.lang+"/privacystatement/";i._successMessage=o.format(i.feedbackResx.successBody,i.email);i._init();return i}t.prototype.dispose=function(){e.prototype.dispose.call(this)};t.prototype.onCloseClicked=function(){this._onComplete()};t.prototype._computeBodyText=function(){var e=this.state();return e===u.default.error?this.feedbackResx.errorBody:e===u.default.done?this._successMessage:""};t.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};t.prototype._init=function(){this.state(u.default.initialLoad)};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{sendFeedbackProvider:a.resourceKey});return t})(i.default);t.default=f});
define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../CreateAlbumFromFolderOperator","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._itemSelectionHelper=t.itemSelectionHelper;n._itemReedemer=n.resources.consume(o.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveFirst().then(function(e){return t._itemReedemer.redeemItems([e],t).then(function(){return t.resources.consumeAsync(i.typeResourceKey).then(function(n){var r=new n({folder:e});return t.trackPromise(r.start())}).then(function(){return{resultType:s.ResultTypeEnum.Success}},function(){return{resultType:s.ResultTypeEnum.Failure}})})})};return t})(r.default);t.default=u});
define("odsp-next/actions/createAlbumFromFolder/CreateAlbumFromFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._albumProvider=n.albumProvider;r._context=t;r._payloads={createAlbumFromFolder:{folder:r.createObservable(t.folder),album:r.createObservable()}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=i.default.createAlbumFromFolder;n.name=t.input;n.iconName=this._context.folder.iconName;n.payloads=this._payloads;t.output&&t.output.isAlbum&&this._payloads.createAlbumFromFolder.album(t.output);return n};t.prototype.onStart=function(e){return this._albumProvider.createAlbumFromFolder(this._context,e)};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{albumProvider:s.resourceKey});return t})(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/orderPrints/odc/OrderPrintsExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/panel/PanelProvider","../../../controls/orderPrints/OrderPrints","../../base/ItemRedeemer"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.itemSelectionHelper;n.name=r;n._itemSelectionHelper=i;n._itemReedemer=n.resources.consume(u.resourceKey);n._panelProvider=n.resources.consume(s.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){var n=t.observables.create(""),r=t._panelProvider.requestPanel({title:n,component:{name:o.default.tagName,params:{selection:e,onComplete:function(){r.state(1)},title:n}}});return r.wait().then(function(){return{resultType:i.ResultTypeEnum.Success}},function(){return{resultType:i.ResultTypeEnum.Failure}})})})};return t})(r.default);t.default=a});
define("odsp-next/controls/orderPrints/OrderPrints",["require","exports","./OrderPrints.html","./OrderPrintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-order-prints",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/orderPrints/OrderPrints.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-OrderPrints"><div class="od-OrderPrints-splash" data-bind="visible:currentState()===orderPrintsStates.splash"><p data-bind="text:orderPrintsResx.WalgreensSplashText" class="od-OrderPrints-splashText"></p><div class="od-OrderPrints-centered"><img data-bind="attr:{src:splashImageSrc()}"></div></div><div class="od-OrderPrints-progressSpinner" data-bind="component:{name:progressSpinnerFlatTagName},visible:currentState()===orderPrintsStates.loading"></div><div class="od-OrderPrints-iframe" data-bind="visible:currentState()===orderPrintsStates.core"><iframe data-bind="attr:{src:orderPrintsIframeUrl()}"></iframe></div><div class="od-OrderPrints-complete" data-bind="visible:currentState()===orderPrintsStates.done"><p data-bind="text:orderPrintsResx.WalgreensSubmitted"></p></div><div class="od-OrderPrints-error" data-bind="visible:currentState()===orderPrintsStates.error"><p data-bind="text:orderPrintsResx.WalgreensError"></p></div><div class="od-OrderPrints-actions od-OrderPrints-centered"><button type="button" role="button" class="od-Button od-Button--primary" data-bind="text:orderPrintsResx.PrintToWalgreens,click:onPrintButtonClicked,visible:currentState()===orderPrintsStates.splash"></button></div></div>'});
define("odsp-next/controls/orderPrints/OrderPrintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./OrderPrints.resx","../commands/Commands.resx","../../providers/album/AlbumProvider.key","./OrderPrintsState","../progressSpinnerFlat/ProgressSpinnerFlat"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onComplete=t.onComplete;n.selection=t.selection;n.orderPrintsStates=u.default;n.currentState=n.createObservable(u.default.splash);n.orderPrintsResx=i.default;n.splashImageSrc=n.createObservable(FilesConfig.imgBaseUrl+"/partners/walgreens2.png");n.orderPrintsIframeUrl=n.createObservable("");n.progressSpinnerFlatTagName=a.default.tagName;n.events.on(window,"message",n._onReceiveMessage);n._title=n.createComputed(n._computeTitle);t.title&&n.createComputed(function(){return t.title(n._title())});return n}t.prototype.onPrintButtonClicked=function(e,t){var n=this;this.currentState(u.default.loading);this.resources.consumeAsync(o.resourceKey).then(function(e){return e.getWalgreensLandingPageUrl(n.selection)}).then(function(e){n.orderPrintsIframeUrl(e.landingUrl);n.currentState(u.default.core)},function(e){n.currentState(u.default.error)})};t.prototype.onCloseButtonClicked=function(e,t){this._onComplete()};t.prototype._computeTitle=function(){var e="";switch(this.currentState()){case u.default.splash:case u.default.loading:e=s.default.OrderPrints;break;case u.default.core:e=this.orderPrintsResx.PrintToWalgreens;break;case u.default.done:e=this.orderPrintsResx.WalgreensSubmittedTitle}return e};t.prototype._onReceiveMessage=function(e){if(e&&e.origin.indexOf(t.WALGREENS_ORIGIN)>-1){var n=e.data;n===t.EVENT_CANCEL||n===t.EVENT_BACK?this._onComplete():n===t.EVENT_DONE?this._onSubmitted():this.currentState(u.default.error)}};t.prototype._onSubmitted=function(){this.currentState(u.default.done)};t.WALGREENS_ORIGIN=window.$Config&&$Config.isINT?"https://m5-qa.walgreens.com":"https://m5.walgreens.com";t.EVENT_CANCEL="action=cancel";t.EVENT_BACK="action=back";t.EVENT_DONE="action=done";return t})(r.default);t.default=f});
define("odsp-next/controls/orderPrints/OrderPrintsState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.splash=0]="splash";e[e.loading=1]="loading";e[e.core=2]="core";e[e.done=3]="done";e[e.error=4]="error"})(n||(n={}));t.default=n});
define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/keyboardMap/KeyboardMap","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.execute=function(){return this.resources.consume(s.resourceKey).requestDialog({title:u.default.keyboardShortcutsTitle,size:"Large",component:{name:o.default.tagName,params:{}},actions:[{name:u.default.ok,icon:new f.default("Cancel"),isDefault:!0,execute:function(){return r.default.wrap(2)}}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};return t})(i.default);t.default=l});
define("odsp-next/controls/keyboardMap/KeyboardMap",["require","exports","./KeyboardMap.html","./KeyboardMapViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-keyboard-map",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/keyboardMap/KeyboardMap.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-KeyboardMap-group"><ul class="od-KeyboardMap-table"><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.arrowsDesc+\'; \'+strings.arrowsAria+\'; \'}"><span class="od-KeyboardMap-key">&uarr; &darr; &larr; &rarr;</span><span class="od-KeyboardMap-val" data-bind="text:strings.arrowsDesc"></span></li>\x3c!--ko if:isMac--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.selectAllDesc+\'; \'+strings.selectAllMacAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.selectAllMacKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.selectAllDesc"></span></li>\x3c!--/ko--\x3e\x3c!--ko if:isPC--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.selectAllDesc+\'; \'+strings.selectAllPCAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.selectAllPCKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.selectAllDesc"></span></li>\x3c!--/ko--\x3e\x3c!--ko if:isMac--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.deselectAllDesc+\'; \'+strings.deselectAllMacAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.deselectAllMacKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.deselectAllDesc"></span></li>\x3c!--/ko--\x3e\x3c!--ko if:isPC--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.deselectAllDesc+\'; \'+strings.deselectAllPCAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.deselectAllPCKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.deselectAllDesc"></span></li>\x3c!--/ko--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.escDesc+\'; \'+strings.escAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.escKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.escDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.spaceDesc+\'; \'+strings.spaceKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.spaceKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.spaceDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.enterDesc+\'; \'+strings.enterKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.enterKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.enterDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.altUpDesc+\'; \'+strings.altUpAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.altUpKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.altUpDesc"></span></li>\x3c!--ko if:isVaultEnabled--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.lockVaultDesc+\'; \'+strings.lockVaultAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.lockVaultKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.lockVaultDesc"></span></li>\x3c!--/ko--\x3e</ul></div><div class="od-KeyboardMap-group"><ul class="od-KeyboardMap-table"><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.renameDesc+\'; \'+strings.renameKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.renameKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.renameDesc"></span></li>\x3c!--ko if:isMac--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.deleteDesc+\'; \'+strings.deleteMacAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.deleteMacKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.deleteDesc"></span></li>\x3c!--/ko--\x3e\x3c!--ko if:isPC--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.deleteDesc+\'; \'+strings.deletePCKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.deletePCKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.deleteDesc"></span></li>\x3c!--/ko--\x3e<li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.toggleInfoDesc+\'; \'+strings.toggleInfoKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.toggleInfoKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.toggleInfoDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.showKeymapDesc+\'; \'+strings.showKeymapAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.showKeymapKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.showKeymapDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.showSearchDesc+\'; \'+strings.showSearchAria+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.showSearchKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.showSearchDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.showShareDesc+\'; \'+strings.showShareKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.showShareKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.showShareDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.openContextualMenuDesc+\'; \'+strings.openContextualMenuKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.openContextualMenuKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.openContextualMenuDesc"></span></li><li class="od-KeyboardMap-row" data-bind="attr:{\'aria-label\':strings.showActionDetailsDesc+\'; \'+strings.showActionDetailsKey+\'; \'}"><span class="od-KeyboardMap-key" data-bind="text:strings.showActionDetailsKey"></span><span class="od-KeyboardMap-val" data-bind="text:strings.showActionDetailsDesc"></span></li></ul></div>'});
define("odsp-next/controls/keyboardMap/KeyboardMapViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./KeyboardMap.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/features/Features"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.strings=i.default;var r=n.resources.consume(s.platformDetection);n.isMac=r.isMac;n.isPC=!r.isMac;n.isVaultEnabled=o.isFeatureEnabled(o.ProjectVKeyboardShortcut);return n}return t})(r.default);t.default=u});
define("odsp-next/actions/redeemCode/odc/RedeemCodeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ProviderResourceKeys","../../../controls/redeemCodeDialog/RedeemCodeDialog","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/guid/Guid","../../../controls/redeemCodeDialog/RedeemCodeDialog.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.maxNameLength=255;n._token=t.redeemCode;n._storageInfoProvider=n.resources.consume(i.storageInfo);n._dialogProvider=n.resources.consume(a.resourceKey);n._redeemSuccess=t.redeemSuccess;n.supportInlineSharing=!0;return n}t.prototype.execute=function(){var e=this,t=this.observables.create(""),n=this.observables.create(!1),r=this.observables.create(!0),i=this.observables.create(!0),a=l.default.generate();return this._dialogProvider.requestDialog({title:"",component:{name:s.default.tagName,params:{token:this._token,automationId:"redeemDialog",status:t,hasError:n,isEnabled:r,hasFocus:i}},actions:[{name:c.default.Redeem,execute:function(){t(o.default.Saving);r(!1);n(!1);return e._storageInfoProvider.redeemCode({token:e._token(),trackingGuid:a}).then(function(){e._redeemSuccess(!0);return 2},function(e){n(!0);r(!0);i(!0);t(e);return 1})},isAvailable:this.observables.pureCompute(function(){return!!e._token()&&r()}),isDefault:!0,icon:new f.default("CirclePlus"),automationId:"redeemDialogCommit"}]}).wait().then(function(){return{resultType:u.ResultTypeEnum.Success}})};return t})(r.default);t.default=h});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog",["require","exports","./RedeemCodeDialog.html","./RedeemCodeDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-redeemcode-dialog",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-RedeemCode"><div class="od-TextField"><label class="od-RedeemCode-nameLabel od-Label" data-bind="text:tokenLabel"></label><input class="od-RedeemCode-nameInput od-TextField-field" type="text" data-bind="value:token,textInput:token,hasFocus:hasFocus,automation:automationId,css:{\'od-RedeemCode-input--error\':hasError},enable:isEnabled"></div><div class="od-RedeemCode-status" data-bind="text:status,css:{\'od-RedeemCode-status--error\':hasError}"></div></div>'});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RedeemCodeDialog.resx","knockout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.tokenLabel=i.default.TokenLabel;n.token=t.token;n.status=t.status||s.observable("");n.hasError=t.hasError||s.observable(!1);n.isEnabled=t.isEnabled||s.observable(!0);n.hasFocus=t.hasFocus||s.observable(!0);return n}return t})(r.default);t.default=o});
define("odsp-next/actions/editTags/odc/EditTagsExecutor",["require","exports","tslib","../../../resources/ProviderResourceKeys","../../../controls/tagEditor/TagEditor","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer","../../../controls/tagEditor/TagEditor.resx","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ControlResourceKeys","../../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._currentItem=t.currentItem;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(u.resourceKey);n._panelProvider=n.resources.consume(s.resourceKey);n._tagProvider=n.resources.consume(r.tag);n._viewParams=n.resources.consume(l.viewParams);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=[],s=[],u=e.resources.consume(r.photo).getAllPhotosSettings().peek(),f=!1,l=e._viewParams.peek();e.resources.consume(c.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===l.tagFilter&&(f=!0);return e._itemReedemer.redeemItems(t,e).then(function(){var r={selection:t,tagsToAdd:n,tagsToDelete:s};return e._panelProvider.requestPanel({title:a.default.title,scrollMode:"always",component:{name:i.default.tagName,params:r}}).wait().then(function(){return n.length>0||s.length>0?e._tagProvider.updateTags({items:t,tagsToAdd:n,tagsToDelete:s,parentKey:e._currentItem.key,rootItemId:u.rootId,skipInvalidate:f}).then(function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}}):{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})})})};return t})(f.default);t.default=h});
define("odsp-next/controls/tagEditor/TagEditor",["require","exports","./TagEditor.html","./TagEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","ODCExecutors_css","../tagInput/TagInput","../list/TagsList"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-tag-editor",template:n.default,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-tag-editor",name:e("module").id,template:n.default,viewModelType:r.default});t.default=o});
define("odsp-next/controls/tagEditor/TagEditor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-TagEditor" data-bind="keyboard:{Backspace:onBackspace,Up:onUp,allowInputEvents:true}"><div data-bind="component:{name:\'od-tag-input\',params:tagInputParams}"></div>\x3c!--ko if:isExistingTagsEmpty--\x3e<div class="od-TagEditor-emptyExistingTags"><img class="od-TagEditor-emptyExistingTags-image" data-bind="attr:{src:emptyTagsImageUrl,height:112}"><div class="ms-font-xl ms-fontWeight-semilight od-TagEditor-emptyExistingTags-title" data-bind="text:TagEditorResx.addFirstTagTitle"></div><div class="ms-font-m ms-fontWeight-semilight" data-bind="text:TagEditorResx.addFirstTagDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:!isExistingTagsEmpty()--\x3e\x3c!--ko if:isNewDetailsPane--\x3e<h3 class="od-TagEditor-header" data-bind="text:TagEditorResx.addFromExistingTagTitle"></h3><div class="od-TagEditor-existingTags-wrapper"><span class="od-TagEditor-existingTags" data-bind="component:{name:\'od-tags-list\',params:{itemSet:existingTagsSet,requiredRange:listRange,selectionModel:itemSelectionModel,isSelectionOnKeyInputEnabled:false,tooltip:TagEditorResx.addFromExistingTagTitle}}"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:!isNewDetailsPane--\x3e<div class="od-TagEditor-title" data-bind="text:TagEditorResx.addExistingTagTitle,css:{\'ms-font-l\':!isFluentEnabled,\'ms-fontWeight-semilight\':!isFluentEnabled,\'ms-fontWeight-semibold\':isFluentEnabled}"></div><span class="od-TagEditor-existingTags" data-bind="component:{name:\'od-tags-list\',params:{itemSet:existingTagsSet,requiredRange:listRange,selectionModel:itemSelectionModel,isSelectionOnKeyInputEnabled:false}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:isLoadingExistingTags--\x3e<span class="ms-font-m" data-bind="component:{name:\'ms-loadingSpinner\',params:{loadingText:TagEditorResx.loading}}"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/tagEditor/TagEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./TagEditor.resx","../../models/tag/TagSourceOptions","../../resources/ProviderResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../../models/itemSet/ItemSet","../../models/item/OneDriveItem","@ms/odsp-utilities/lib/object/ObjectUtil","../../models/selection/ItemSetSelectionModel","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../bindings/keyboard/KeyboardBinding","../loadingSpinner/LoadingSpinner","../../controls/fluentStyling/FluentStyling.key","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;i.loadingSpinnerTagName=m.default.tagName;i.addBindingHandlers({keyboard:v.default});i.TagEditorResx=s.default;i._tagProvider=i.resources.consume(u.tag);i._photoProvider=i.resources.consume(u.photo);i.isFluentEnabled=i.resources.consume(g.resourceKey);i.isNewDetailsPane=y.isFeatureEnabled(y.EnableNewDetailsPane);i.emptyTagsImageUrl=window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg");i.isExistingTagsEmpty=r.observable(!1);i.isTextBoxSelected=r.observable(!0);i.tagInput=r.observable("");i.isLoadingExistingTags=r.observable(!1);i._resolvedTags=r.observableArray(i._getCommonTags(t.selection));i.listRange=r.observable({start:0,end:0});i.listRange.equalityComparer=h.deepCompare;i.tagInputParams={inputText:i.tagInput,resolvedTags:i._resolvedTags,tagsToAdd:t.tagsToAdd,tagsToDelete:t.tagsToDelete,isTextBoxSelected:i.isTextBoxSelected};var o=new c.default,f=new l.default;f.item=r.observable(o);i.existingTagsSet=i.resources.expose(a.currentItemSet,r.observable(f));i.itemSelectionModel=i.resources.expose(a.itemsSelection,new(i.managed(p.default)));i.createComputed(i._computeAllExistingTagsForQuery).extend({rateLimit:250});i.createComputed(i._computeEnsureThumbnails);return i}t.prototype.getThumbnailUrl=function(e){var t="";e.folder&&e.folder.covers&&e.folder.covers.length>0&&(t=f.format(e.folder.covers[0].url,50,50));return t};t.prototype.onBackspace=function(e){var t=this.itemSelectionModel.getFocusIndex()>=0;if(t){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!t};t.prototype.onUp=function(e){if(0===this.itemSelectionModel.getFocusIndex()){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!1};t.prototype._getTagFieldColumn=function(){return{key:"",name:name,minWidth:240,width:240,isVisible:!0,isVisibleMobile:!0,isCollapsable:!1,groupable:!1,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:d.ColumnFieldType.Tag,filterable:!1,isFocused:r.observable(!1)}};t.prototype._computeAllExistingTagsForQuery=function(){var e=this;this.isLoadingExistingTags(!0);var t=this._resolvedTags().map(function(e){return"#"+(e.localizedTag||e.tag)});this.itemSelectionModel.clear(!0);var n=this.tagInput(),r=this._tagProvider.getAllTagsForQuery(n,t);this._existingTagsPromise=r;r.then(function(i){if(r!==e._existingTagsPromise)return null;e._existingTagsPromise=null;n||0!==t.length||e.isExistingTagsEmpty(0===i.content.peek().items.length);i.schema([e._getTagFieldColumn()]);e.existingTagsSet(i);e.isLoadingExistingTags(!1)})};t.prototype._computeEnsureThumbnails=function(){var e=this._photoProvider.getAllPhotosSettings(),t={rootItemId:e.peek().rootId,ascending:e.peek().isAscending,startIndex:0,parentKey:void 0};this._tagProvider.ensureHasThumbnails(this.existingTagsSet.peek(),this.listRange(),t)};t.prototype._getCommonTags=function(e){for(var t=e.length,n={},r={},i=[],s=0,u=e;s<u.length;s++)for(var a=u[s],f=0,l=a.tags&&a.tags.filter(function(e){return e.source!==o.default[o.default.LocationAndEventsAPI]&&e.source!==o.default[o.default.SystemDefined]&&!!e.tag});f<l.length;f++){var c=l[f],h=c.localizedTag||c.tag,p=(n[h]||0)+1;n[h]=p;r[h]=c}for(var d in n)n[d]>=t&&i.push(r[d]);return i};t.dependencies=n.__assign({},i.default.dependencies);return t})(i.default);t.default=b});
define("odsp-next/models/tag/TagSourceOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.LocationAndEventsAPI=0]="LocationAndEventsAPI";e[e.ObjectDetectors=1]="ObjectDetectors";e[e.LocationBasedPlace=2]="LocationBasedPlace";e[e.UserDefined=3]="UserDefined";e[e.SystemDefined=4]="SystemDefined"})(n||(n={}));t.default=n});
define("odsp-next/controls/tagInput/TagInput",["require","exports","./TagInput.html","./TagInputViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-tag-input",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/tagInput/TagInput.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="TagInput" data-bind="click:function(){focus()},css:{\'TagInput--isDeleteMode\':isDeleteMode,old:!isNewDetailsPane,new:isNewDetailsPane},attr:{title:inputPlaceholder}">\x3c!--ko if:isNewDetailsPane--\x3e<input class="TagInput-textBox TagInput-entry" type="text" autocomplete="off" autocapitalize="off" autocorrect="off" autofocus data-bind="value:inputText,valueUpdate:\'keyup\',attr:{size:inputSize,title:inputTextPlaceHolder,placeHolder:inputTextPlaceHolder,maxlength:maxTagLength},automation:\'addTagInput\',event:{keyup:inputChange,focus:inputFocus,blur:inputBlur,paste:inputPaste},hasFocus:isSelected,keyboard:{mappings:{Down:onDown},context:$data,allowInputEvents:true}">\x3c!--/ko--\x3e<div class="TagInput-container" data-bind="css:{new:isNewDetailsPane}">\x3c!--ko foreach:resolvedTags--\x3e<div class="TagInput-resolvedTag TagInput-entry"><a class="TagInput-resolvedTagLink ms-font-m" data-bind="attr:{title:$component.getTagDisplayText($data)}"><div class="TagInput-resolvedTagName" data-bind="text:$component.getTagDisplayText($data)"></div></a><button class="TagInput-removeTag ms-font-m" data-bind="click:$component.removeItem.bind($component),attr:{\'aria-label\':$component.getRemoveTagAriaLabel($data)}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e\x3c!--ko if:!isNewDetailsPane--\x3e<input class="TagInput-textBox-underlined TagInput-entry" type="text" autocomplete="off" autocapitalize="off" autocorrect="off" autofocus data-bind="value:inputText,valueUpdate:\'keyup\',attr:{size:inputSize,title:inputPlaceholder,maxlength:maxTagLength},automation:\'addTagInput\',event:{keyup:inputChange,focus:inputFocus,blur:inputBlur,paste:inputPaste},hasFocus:isSelected,keyboard:{mappings:{Down:onDown},context:$data,allowInputEvents:true}"><span class="TagInput-ghostText TagInput-entry" aria-hidden="true" data-bind="text:inputPlaceholder,visible:showPlaceholder"></span>\x3c!--/ko--\x3e</div><div class="TagInput-belowContainer" data-bind="scrollIntoView:{isSelected:scrollDown}"></div></div><div aria-live="assertive" class="TagInput-error" data-bind="text:error"></div>'});
define("odsp-next/controls/tagInput/TagInputViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./TagInput.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/keyboard/KeyboardBinding","../../bindings/scrollIntoView/ScrollIntoViewBinding","../../models/tag/TagSourceOptions","../../models/tag/TagTypeOptions","../../resources/ControlResourceKeys","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.error=i.observable("");n.addBindingHandlers({keyboard:u.default,scrollIntoView:a.default});n.inputChange=function(e,t){n._inputChangeOuter(t)};n.scrollDown=i.observable(!1);n.inputText=t.inputText;n._tagsToAdd=t.tagsToAdd;n._tagsToDelete=t.tagsToDelete;n._initialCommonTags=t.resolvedTags&&t.resolvedTags().slice(0)||[];n.resolvedTags=t.resolvedTags;n.maxTagLength=256;n.isDeleteMode=i.observable(!1);n._inputBoxWasEmpty=!0;n.showPlaceholder=i.observable(!0);n.inputPlaceholder=n.createComputed(function(){return""===n.inputText()&&0===n.resolvedTags().length?s.default.InputPlaceholderText:""});n.inputSize=n.createComputed(function(){return n.inputText().length+1});n.inputTextPlaceHolder=s.default.InputAddTagPlaceholderText;n.isNewDetailsPane=h.isFeatureEnabled(h.EnableNewDetailsPane);n._selectionModel=n.resources.consume(c.itemsSelection);n._selectionModel.selection.subscribe(function(e){e.length>0&&n._resolveTag(e[0].peek().name)});n.isSelected=t.isTextBoxSelected;return n}t.prototype.removeItem=function(e){for(var t=0;t<this._initialCommonTags.length;t++)e===this._initialCommonTags[t]&&this._tagsToDelete.push(e);var n=this._tagsToAdd.indexOf(e);-1!==n&&this._tagsToAdd.splice(n,1);this.resolvedTags.remove(e);this.isSelected(!0)};t.prototype.focus=function(){this.isSelected(!0);this.showPlaceholder()&&this.showPlaceholder(!1)};t.prototype.inputFocus=function(){this.showPlaceholder()&&this.showPlaceholder(!1)};t.prototype.inputBlur=function(){this.showPlaceholder()||0!==this.resolvedTags().length||0!==this.inputText().length||this.showPlaceholder(!0)};t.prototype.inputPaste=function(e,t){var n=this;this.async.setTimeout(function(){n._resolveTag(n.inputText());n.inputText("")},500);return!0};t.prototype.getTagDisplayText=function(e){return"#"+(e.localizedTag||e.tag)};t.prototype.getRemoveTagAriaLabel=function(e){return o.format(s.default.removeTagAriaLabel,this.getTagDisplayText(e))};t.prototype.onDown=function(e,t){this.isDeleteMode(!1);this._selectionModel.setIndexFocus(0);return!1};t.prototype._inputChangeOuter=function(e){var t=this;this._timer||this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};t.prototype._add=function(e){this.inputText("");this._tagsToAdd.push(e);this.resolvedTags.push(e);this._scrollIntoView()};t.prototype._inputChange=function(e){var t=e.keyCode,n=this.inputText().length;this._scrollIntoView();if(0===n){8===t&&this._inputBoxWasEmpty&&(this.isDeleteMode.peek()?this.removeItem(this.resolvedTags.pop()):this.isDeleteMode(!0));this._inputBoxWasEmpty=!0}else{this.isDeleteMode(!1);13===t||51===t&&e.shiftKey&&this.inputText().length>1?this._resolveTag(this.inputText()):this._inputBoxWasEmpty=!1}};t.prototype._scrollIntoView=function(){var e=this;this.async.setTimeout(function(){e.scrollDown(!0);e.scrollDown(!1)},1e3)};t.prototype._resolveTag=function(e){for(var t,n=e.split(/[,;#]/),r=0;r<n.length;r++){var i=n[r].trim();if(""!==i){t=this._getUserDefinedTag(i);this._add(t)}}this._inputBoxWasEmpty=!0;this.isSelected(!0);this.isDeleteMode(!1)};t.prototype._getUserDefinedTag=function(e){return{source:f.default[f.default.UserDefined],tag:e,type:l.default[l.default.keyword]}};return t})(r.default);t.default=p});
define("odsp-next/models/tag/TagTypeOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.keyword=0]="keyword";e[e.Scene=1]="Scene";e[e.Location=2]="Location"})(n||(n={}));t.default=n});
define("odsp-next/actions/editTags/odc/ShowTagsEditorExecutor",["require","exports","./tagsEditorPanel/TagsEditorPanelWrapper.html","./tagsEditorPanel/TagsEditorPanelWrapperViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-show-tag-editor-panel-executor",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/actions/editTags/odc/tagsEditorPanel/TagsEditorPanelWrapper.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div data-bind="react:{componentType:controlComponent,props:controlProps}"></div>'});
define("odsp-next/actions/editTags/odc/tagsEditorPanel/TagsEditorPanelWrapperViewModel",["require","exports","tslib","../../../base/ControlExecutorViewModel","../../../../bindings/react/ReactBinding","./TagsEditorPanel","../../../base/ItemRedeemer"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:i.default});n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(o.resourceKey);n.controlComponent=s.default;n._selectionHelper.resolveSelection().then(function(e){n._itemReedemer.redeemItems(e,n).then(function(){n.controlProps=n.observables.pureCompute(function(){return{currentItem:t.currentItem,selection:e,resources:n.resources}})})});return n}return t})(r.default);t.default=u});
define("odsp-next/actions/editTags/odc/tagsEditorPanel/TagsEditorPanel",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Panel","office-ui-fabric-react/lib/Button","../../../../controls/tagEditor/TagEditor.resx","../../../../controls/tagEditor/TagEditor","../../../../controls/knockout/Knockout","../../../../bindings/component/ControlBinding","../../../../resources/ProviderResourceKeys","../../../../resources/ControlResourceKeys","../../../../models/itemsScope/ItemsScopeFeature.key","ODCExecutors_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._tagsToAdd=[];n._tagsToDelete=[];n._onRenderHeaderContent=function(){return r.createElement("div",null,r.createElement("h2",{className:"od-tagsEditor-Panel-title"},u.default.title),r.createElement(o.IconButton,{className:"od-tagsEditor-Panel-button--close",iconProps:{iconName:"cancel"},onClick:n._updateTags,ariaLabel:u.default.closeTagEditorAriaLabel}))};n._onRenderFooterContent=function(){return r.createElement("div",{className:"od-tagsEditor-footer"},r.createElement(o.PrimaryButton,{className:"od-tagsEditor-footer-saveButton",onClick:n._onSaveClick},u.default.save),r.createElement(o.DefaultButton,{className:"od-tagsEditor-footer-cancelButton",onClick:n._onCancelClick},u.default.cancel))};n._onSaveClick=function(){n._updateTags()};n._onCancelClick=function(){n._tagsToAdd=[];n._tagsToDelete=[];n.setState({isOpen:!1})};n._onPanelClosed=function(){n._updateTags()};n._updateTags=function(){n._tagsToAdd.length>0||n._tagsToDelete.length>0?n._tagProvider.updateTags({items:n.props.selection,tagsToAdd:n._tagsToAdd,tagsToDelete:n._tagsToDelete,parentKey:n._currentItem.key,rootItemId:n._allPhotosUserSettings.rootId,skipInvalidate:n._shouldSkipInvalidate}).then(function(){n.setState({isOpen:!1})},function(){n.setState({isOpen:!1})}):n.setState({isOpen:!1})};n._tagProvider=n.props.resources.consume(c.tag);n._currentItem=n.props.currentItem;var i=n.props.resources.consume(c.photo);n._allPhotosUserSettings=i.getAllPhotosSettings().peek();n._viewParams=n.props.resources.consume(h.viewParams);n.state={isOpen:!0};return n}t.prototype.render=function(){this._shouldSkipInvalidate=!1;var e=this._viewParams.peek();this._tagProvider=this.props.resources.consume(c.tag);this.props.resources.consume(p.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===e.tagFilter&&(this._shouldSkipInvalidate=!0);var t={selection:this.props.selection,tagsToAdd:this._tagsToAdd,tagsToDelete:this._tagsToDelete},n=l.toSpecification(a.resourceKey,t);return r.createElement(s.Panel,{className:i.css("od-tagsEditorPanel","isFluent"),isOpen:this.state.isOpen,isLightDismiss:!0,hasCloseButton:!1,onRenderHeader:this._onRenderHeaderContent,onDismiss:this._onPanelClosed,onRenderFooterContent:this._onRenderFooterContent},r.createElement(f.default,{specification:n,resources:this.props.resources}))};return t})(i.BaseComponent);t.default=d});
define("odsp-next/actions/shareByLink/odc/ShareByLinkExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/dialog/DialogProvider","../../../controls/sharing/sharingWizard/SharingWizard","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/loadingSpinner/LoadingSpinner","../../../models/item/ItemType","../../../controls/sharing/sharingWizard/SharingWizard.resx","../../../controls/sharing/shareByEmail/Sharing.resx","../../../providers/engagement/Engagement","../../../utilities/icons/Icon","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/list/ShortcutUtilities","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/textContainer/TextContainer","../../base/ItemRedeemer","../../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.canToggleEditInline=!0;n.hideInviteOptions=!0;n.requireSignInByDefault=!1;n.name=t.actionName;n._initialState=t&&t.startState?[1,t.startState]:[1];n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(b.resourceKey);if(t&&t.item&&t.item())n._itemPromise=r.default.wrap([t.item()]);else if(t&&t.itemKey){var i=n.resources.consume(w.resourceKey);n._itemPromise=i.getSpecifiedItems({itemKeys:[t.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}n.urlDataSource=n.resources.consume(d.url);var s=t.sharingMethod,o=void 0===s?null:s;n.sharingMethod=o;return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){var n=e.resources.consume(s.resourceKey);if(t.some(function(e){return!!e.vault}))return e._showVaultWarning(n);if(t.length>=100){var d=g.format(c.default.MultiShareTitleText,t.length),m=g.format(c.default.MultiShareOverLimit,100);return n.requestDialog({title:d,component:{name:y.default.tagName,params:{text:m}}}).wait().then(function(){return r.default.wrap({resultType:u.ResultTypeEnum.Success})})}for(var b=[],w=0;w<e._selectionHelper.selection().length;w++){var E=e._selectionHelper.selection()[w];b.push(E())}var S=e.observables.create([].concat(e._initialState)),x=e.observables.create(""),T=e.observables.create(!0),N=e._itemPromise,C=!1;if(!N){N=r.default.wrap(b);C=!0}if(!C)var k=n.requestDialog({title:c.default.ShareText,size:"Medium",component:{name:a.default.tagName,params:{}}});return N.then(function(t){k&&k.dismiss();if(!t[0])return r.default.wrapError({resultType:u.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});var s=e.resources.consume(h.resourceKey);v.default.isShortcutItem(t[0])&&s.logData({name:"ShortcutLink.ShareByLinkInitiate"});var a=n.requestDialog({title:x,size:"Medium",shouldPreserveFocus:T,component:{name:o.default.tagName,params:{items:t,dialogTitle:x,stateArray:S,canToggleEditInline:e.canToggleEditInline,hideInviteOptions:e.hideInviteOptions,requireSignInByDefault:e.requireSignInByDefault,onExecuteAction:function(){return a.state(2)},shouldPreserveFocus:T,resources:e.resources,sharingMethod:e.sharingMethod}},titleAction:{name:l.default.BackButtonText,execute:function(){var e=S();switch(e.pop()){case 2:s.logData({name:"GoBackSharedWith.SharingWizard.Click",isIntentional:!0});break;case 3:s.logData({name:"GoBackAddPeople.SharingWizard.Click",isIntentional:!0})}S(e);return r.default.wrap(1)},icon:new p.default("Back"),isVisible:e.observables.pureCompute(function(){return S().length>1})}}),c=e.subscribe(e.resources.consume(i.currentItemSet),function(){a.dismiss()});return a.wait().then(function(){c.dispose();S([]);var e={},t={count:b.length};if(1===b.length){e.fileType=f.default[b[0].type];e.extension=b[0].extension||""}return{resultType:u.ResultTypeEnum.Success,extraData:e,extraMetrics:t}},function(e){c.dispose();S([]);return r.default.wrapError(e)})})})})};t.prototype._showVaultWarning=function(e){var t=c.default.VaultShareTitle,n=c.default.VaultShareText,i=e.requestDialog({title:t,component:{name:y.default.tagName,params:{text:n}},actions:[{name:c.default.Close,execute:function(){return r.default.resolve(2)},isAvailable:this.observables.create(!0),icon:new p.default("CheckMark"),isDefault:!0}]});this.resources.consume(h.resourceKey).logData({name:"Vault.Share.Clicked"});return i.wait().then(function(){return r.default.wrap({resultType:u.ResultTypeEnum.Success})})};return t})(m.default);t.default=E});
define("odsp-next/controls/sharing/sharingWizard/SharingWizard",["require","exports","./SharingWizard.html","./SharingWizardViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../sharingByLink/SharingByLink","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-shareWizard",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/sharing/sharingWizard/SharingWizard.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharingWizard">\x3c!--ko if:isLoading--\x3e<div class="od-SharingWizard-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isLoading--\x3e<div class="od-SharingWizard-sharingHints" data-bind="component:{name:sharingHintsTagName,params:sharingHintsParams}"></div><div class="od-SharingWizard-component" data-bind="component:componentDefinition"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/sharingWizard/SharingWizardViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner","./SharingWizardTemplates","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../sharingWizard/SharingWizard.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/css/VisibilityBinding","../sharingHints/SharingHints"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=s.default.tagName;n.sharingHintsTagName=h.default.tagName;n._params=t;n.addBindingHandlers({visibility:c.default});n._sharingProvider=n.resources.consume(u.resourceKey);n._stateStack=t.stateArray;n._currentState=n.createComputed(function(){return this._stateStack()[this._stateStack().length-1]});n.currentLink=r.observable(null);n._items=t.items;n._sharingMethod=t.sharingMethod;n._companyDisplayName=t.companyDisplayName;n._expiration=n.createObservable(null);n.componentDefinition=n.createComputed(function(){return n._getComponentDefinition()});n.isLoading=r.observable(!0);if(n._items.length>1){n._shareDialogTitle=l.format(f.default.MultiShareTitleText,n._items.length);n._params.dialogTitle(n._shareDialogTitle);n.isLoading(!1)}else n._getSharingSettings();n.sharingHintsParams={guestLinkExists:r.observable(!1),sharedWithMany:r.observable(!1),sharingHintsOption:1,sharedWith:r.observableArray([]),items:n._items};return n}t.prototype._getSharingSettings=function(){var e=this,t=this._items[0],n=t.type===a.default.Folder?f.default.MissingFolderTitle:f.default.MissingFileTitle,r=this._sharingProvider.getSharingData(t);this.isReady=r.getSettings().then(function(t){e._sharingSettings=t;e._shareDialogTitle=e._sharingSettings.itemId?l.format(f.default.TitleText,t.itemName):n;e._params.dialogTitle(e._shareDialogTitle);e.isLoading(!1)},function(n){e._shareDialogTitle=l.format(f.default.TitleText,t.name);e._params.dialogTitle(e._shareDialogTitle);e.isLoading(!1)})};t.prototype._getComponentDefinition=function(){var e=o.getTemplateName(this._currentState()),t={items:this._items,dialogStateArray:this._stateStack,includeLinks:!0,currentLink:this.currentLink,height:"500px",canToggleEditInline:this._params.canToggleEditInline,onExecuteAction:this._params.onExecuteAction,shouldPreserveFocus:this._params.shouldPreserveFocus,sharingMethod:this._sharingMethod,selectedPeople:r.observableArray([]),hasUnresolvedText:r.observable(!1),companyDisplayName:this._companyDisplayName,expiration:this._expiration};4===this._currentState()?this._params.dialogTitle(f.default.SwitchLink):this._params.dialogTitle(this._shareDialogTitle);3===this._currentState()&&(t={selectedPeople:r.observableArray([]),roleValue:r.observable(""),emailMessage:r.observable(""),errorMessage:r.observable(""),sendEmail:r.observable(!0),requireSignIn:r.observable(this._params.requireSignInByDefault),propagateSharing:r.observable(!1),hasUnresolvedText:r.observable(!1),emailMessageExceedsLimit:r.observable(!1),dialogTitle:r.observable(""),hideOptions:this._params.hideInviteOptions,showSendEmailOption:!0,onExecuteAction:this._params.onExecuteAction,items:this._items,currentLink:this.currentLink,sharingMethod:this._sharingMethod,companyDisplayName:this._companyDisplayName,expiration:this._expiration});return{name:e,params:t}};return t})(i.default);t.default=p});
define("odsp-next/controls/sharing/sharingWizard/SharingWizardTemplates",["require","exports","../sharingByLink/SharingByLink","../sharedWith/SharedWith","../shareByEmail/ShareByEmail","../sharingLinksSwitcher/SharingLinksSwitcher"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTemplateName=function(e){switch(e){case 1:return n.default.tagName;case 2:return r.default.tagName;case 3:return i.default.tagName;case 6:case 4:return s.default.tagName;default:return n.default.tagName}};t.getBottomAction=function(e){switch(e){case 1:case 3:return 2;case 2:return 3;default:return 1}}});
define("odsp-next/controls/sharing/sharingByLink/SharingByLink",["require","exports","./SharingByLink.html","./SharingByLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../../panelHost/PanelHost"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-sharebylink",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/sharing/sharingByLink/SharingByLink.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharingByLink">\x3c!--ko if:loading()--\x3e<div class="od-SharingByLink-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!hasError()--\x3e\x3c!--ko ifnot:loading()--\x3e<div aria-live="assertive" class="od-SharingByLink-error" data-bind="if:error"><span data-bind="text:error"></span></div>\x3c!--ko if:note()--\x3e<div aria-live="assertive" class="od-SharingByLink-note"><span data-bind="text:note"></span></div>\x3c!--/ko--\x3e<div data-bind="ifnot:hasLoadingError">\x3c!--ko if:!isSingleLinkLabelVisible()--\x3e<a href="javascript:;" class="od-SharingByLink-linkSwitcher" data-bind="attr:{title:linkTitle},click:switchLinks">\x3c!--ko if:arePasswordProtectedLinksEnabled&&setPasswordChecked()--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingByLink-lock" role="img" data-bind="icon:true,attr:{\'aria-label\':passwordProtectedLinkIndicatorLabel}"></i>\x3c!--/ko--\x3e<span data-bind="text:sharingHintText,automation:\'sharingHintText\'"></span><i data-bind="class:arrowIcon" class="ms-Icon od-SharingByLink-linkSwitcher-icon"></i></a>\x3c!--/ko--\x3e\x3c!--ko if:isSingleLinkLabelVisible()--\x3e<span class="od-SharingByLink-linkSwitcher" data-bind="text:sharingHintText"></span>\x3c!--/ko--\x3e\x3c!--ko if:isAllowEditVisible()--\x3e<div class="od-CheckBox od-SharingByLink-CheckBoxContainer"><input type="checkbox" id="od-SharingByLink-allowEdit" data-bind="checked:allowEditChecked" class="od-CheckBox-input"><label for="od-SharingByLink-allowEdit" class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css:{\'is-checked\':allowEditChecked}"><span data-bind="text:allowEditText,automation:\'allowEditText\'" class="od-Label"></span></label></div><div class="od-CheckBox od-SharingByLink-CheckBoxContainer"><input type="checkbox" id="od-SharingByLink-linkExpires" class="od-CheckBox-input od-SharingByLink-CheckBox" data-bind="checked:linkExpiresChecked,disable:isPremiumEligible"><label for="od-SharingByLink-linkExpires" class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css:{\'is-checked\':linkExpiresChecked},teachingBubble:expiringLinkTeachingBubbleOptions,click:onLinkExpiresClicked"><span data-bind="text:linkExpiresText,automation:\'linkExpiresText\'" class="od-Label"></span></label>\x3c!--ko if:isPremiumEligible--\x3e<span data-bind="click:onLinkExpiresClicked,react:{componentType:gleamCalloutComponent,props:expiringLinkGleamCalloutComponentProps}"></span>\x3c!--/ko--\x3e\x3c!--ko if:linkExpiresChecked()--\x3e<div class="od-SharingByLink-linkExpiresInputDiv"><input id="od-SharingByLink-linkExpiresInput" class="od-SharingByLink-linkExpiresInput" type="number" data-bind="value:linkExpirationInDays,selectOnFocus:{isPermanent:false,isReentrant:true}"><label for="od-SharingByLink-linkExpiresInput"><span class="od-SharingByLink-linkExpiresInputLabel" data-bind="text:linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:arePasswordProtectedLinksEnabled--\x3e<div class="od-CheckBox od-SharingByLink-setPassword-container od-SharingByLink-CheckBoxContainer"><input type="checkbox" id="od-SharingByLink-setPassword" class="od-CheckBox-input" data-bind="checked:setPasswordChecked,disable:isPremiumEligible"><label for="od-SharingByLink-setPassword" class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css:{\'is-checked\':setPasswordChecked},click:onSetPasswordClicked"><span data-bind="text:setPasswordLabel" class="od-Label"></span></label>\x3c!--ko if:isPremiumEligible--\x3e<span data-bind="click:onSetPasswordClicked,react:{componentType:gleamCalloutComponent,props:passwordProtectedLinkGleamCalloutComponentProps}"></span>\x3c!--/ko--\x3e\x3c!--ko if:setPasswordChecked()--\x3e<div class="od-SharingByLink-setPasswordInputContainer"><input id="od-SharingByLink-setPasswordInput" autocomplete="new-password" class="od-SharingByLink-setPasswordInput" type="password" data-bind="value:passwordDisplayValue,valueUpdate:\'input\',attr:{\'aria-invalid\':isPasswordInvalid()},event:{blur:onPasswordChanged,click:clearPasswordDisplayValue},keyboard:{mappings:{Enter:$component.onPasswordDefined.bind($component)}},css:{\'od-SharingByLink-invalidPasswordOutline\':isPasswordInvalid()}"><label for="od-SharingByLink-setPasswordInput"></label>\x3c!--ko if:isPasswordInvalid()--\x3e<div class="od-SharingByLink-invalidPasswordError" role="alert" data-bind="text:invalidPasswordText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="od-SharingByLink-linkSection"><div class="od-SharingByLink-table"><div class="od-SharingByLink-row"><div class="od-SharingByLink-cell od-SharingByLink-iconCell">\x3c!--ko if:currentSharingLink().url--\x3e<div class="od-SharingByLink-icon"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true,attr:{\'aria-label\':getLinkText}"></i></div>\x3c!--/ko--\x3e\x3c!--ko if:!currentSharingLink().url--\x3e<a href="#" class="od-SharingByLink-linkText" id="od-SharingByLink-linkText" data-bind="click:onClickCreateLink,automation:\'getLink\'"><div class="od-SharingByLink-icon"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true,attr:{\'aria-label\':getLinkText}"></i></div>\x3c!--ko if:!isCreatingLink()--\x3e<span class="od-SharingbyLink-text" data-bind="text:getLinkText"></span>\x3c!--/ko--\x3e\x3c!--ko if:isCreatingLink()--\x3e<div class="od-SharingByLink-creatingLink-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--ko if:currentSharingLink().url--\x3e<div class="od-SharingByLink-cell"><div class="od-SharingByLink-table od-SharingByLink-url"><div class="od-SharingByLink-row"><div class="od-SharingByLink-cell"><input class="od-SharingByLink-input od-TextField-field" type="text" readonly data-bind="value:sharingLinkUrl,automation:\'sharingLinkUrl\',hasFocus:true,event:{copy:logCopy},css:{\'is-disabled\':isLinkDisabled},attr:{\'aria-label\':sharingHintText,disabled:isLinkDisabled}"></div><div class="od-SharingByLink-cell"><button class="ms-Dialog-action od-Button od-Button--primary od-SharingByLink-copyButton" data-bind="visible:supportsCopy,click:onClickCopyLink"><i class="od-SharingByLink-copySuccess ms-Icon ms-Icon--CheckMark" data-bind="icon:true,visible:isCopyLoadingVisible"></i><span class="od-Button-label od-SharingByLink-copyButton-label" data-bind="text:copyText,visible:!isCopyLoadingVisible()"></span></button></div></div></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:!arePasswordProtectedLinksEnabled||!setPasswordChecked()--\x3e<div class="od-SharingByLink-mailRow"><a href="#" class="od-SharingByLink-mailText" id="od-SharingByLink-mailText" data-bind="click:showInvite"><div class="od-SharingByLink-icon"><i class="ms-Icon ms-Icon--Mail" data-bind="icon:true"></i></div><span class="od-SharingByLink-text" data-bind="text:inviteText"></span></a></div>\x3c!--/ko--\x3e</div><div class="od-SharingByLink-moreSection">\x3c!--ko if:isNetworksSectionVisible()--\x3e<a href="#" class="od-SharingByLink-moreLink" data-bind="click:onMoreOptionsClicked"><span data-bind="text:moreOptionsText"></span><span><i data-bind="class:moreSectionIcon" class="ms-Icon"></i></span></a>\x3c!--/ko--\x3e\x3c!--ko if:isMoreSectionVisible()--\x3e<div><div class="od-sharingByLinks-networksList" data-bind="foreach:{data:networksList,as:\'network\'}"><div class="od-SharingByLink-networksRow"><a href="#" class="od-SharingByLink-networkText" data-bind="click:$parent.onNetworkClicked.bind($parent)"><div class="od-SharingByLink-icon"><img data-bind="attr:{src:network.iconUrl,alt:$parent.getNetworkAltText(network)}"></div><div class="od-SharingByLink-social-holder"><span class="od-SharingByLink-social-text od-SharingByLink-social-name" data-bind="text:network.text"></span>\x3c!--ko if:$data.isCreatingLink()--\x3e<span class="od-SharingByLink-social-text od-SharingByLink-social-creating" data-bind="text:$parent.generatingLinkForSocialNetworkText"></span>\x3c!--/ko--\x3e</div></a></div></div>\x3c!--ko if:isManagePermissionsVisible()&&!isPasswordProtectedLinksBannerVisible()--\x3e<a href="#" data-bind="click:showPermissions,text:managePermissionsText"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--ko if:isPasswordProtectedLinksBannerVisible()--\x3e<div class="od-sharingByLinks-passwordProtectedLinkInformationArea"><i class="ms-Icon ms-Icon--Info od-SharingByLink-passwordProtectedLinkInformationIcon" data-bind="icon:true"></i><div class="od-SharingByLink-passwordProtectedLinkInformationTextArea"><span class="od-SharingByLink-passwordProtectedLinkInformation" data-bind="text:setPasswordPermissionsWarning"></span><a href="#" class="od-SharingByLink-ManageAccessLink" data-bind="text:manageAccessLink,click:launchPermissionsPanel"></a></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:hasError()--\x3e<div class="od-SharingByLink-error" data-bind="text:missingItemError" aria-live="assertive"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:displayFeatureCards--\x3e<div data-bind="component:{name:featureCardsTagName,params:{cards:featureCardData,currentIndex:featureCardIndex,close:$component.closeFeatureCards.bind($component),includeOverlay:true}}"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingByLink/SharingByLinkViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","../../../providers/engagement/Engagement","../../../models/teachingBubble/TeachingBubbleCampaigns","../../../utilities/dom/Dom","../../gleamCallout/GleamCallout","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/featureCards/FeatureCardsProvider","../../../providers/featureCards/FeatureCards.resx","./SharingByLink.resx","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","./SharingByLinkStringHelper","../../../utilities/attribution/AttributionHelper","../../../utilities/browser/ClipboardData","../../../resources/ControlResourceKeys","../../featureCards/FeatureCards","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../../../bindings/keyboard/KeyboardBinding","../../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../bindings/react/ReactBinding","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","../../../models/sharing/SharingNetworks","../../../bindings/teachingBubble/TeachingBubbleBinding","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features","../../../resources/ODCResourceKeys","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=x.default.tagName;n.passwordProtectedLinkIndicatorLabel=h.default.passwordProtectedLinkIndicatorAriaLabel;n.addBindingHandlers({keyboard:S.default,react:C.default,selectOnFocus:k.default,teachingBubble:O.default});var r=t.canToggleEditInline,o=t.currentLink,p=t.dialogStateArray,d=t.expiration,T=t.items,M=t.onExecuteAction,H=t.shouldPreserveFocus;n._canToggleEditInline=r;n._dialogStateArray=p;n._items=T;n._onExecuteAction=M;n._shouldPreserveFocus=H;n._expiration=d;n._isOneDriveWinApp=P.isOneDriveWinApp();n._actionMap=n.resources.consume(y.actionMap);n._attributionHelper=n.resources.consume(m.resourceKey);n._instrumentationProvider=n.resources.consume(N.instrumentation);n._itemProvider=n.resources.consume(a.resourceKey);n._platform=n.resources.consume(f.platformDetection);n._sharingProvider=n.resources.consume(w.resourceKey);n._sharingLinkExpirationHelper=new(n.managed(L.default));n._storageOptionsProvider=n.resources.consume(N.storageOptions);n._userInfoProvider=n.resources.consume(N.userInfo);n._featureCardsProvider=n.resources.consume(l.resourceKey);n._engagement=n.resources.consume(i.resourceKey);n._odcUrlDataSource=n.resources.consume(D.urlDataSource);n.allowEditChecked=n.createObservable(!1);n.allowEditText=h.default.AllowEdit;n.copyText=h.default.CopyLinkText;n.currentSharingLink=o;n.error=n.createObservable("");n.displayFeatureCards=n.createObservable(!1);n.featureCardIndex=0;n.setPasswordChecked=n.createObservable(!1);n.featureCardsTagName=b.default.tagName;n.generatingLinkForSocialNetworkText=h.default.generatingLinkForSocialNetworkText;n.getLinkText=h.default.GetLink;n.gleamImageUrl=window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg");n.hasError=n.createObservable(!1);n.hasLoadingError=n.createObservable(!1);n.invalidPasswordText=h.default.invalidPasswordError;n.inviteText=h.default.AddPeopleEmail;n.isAllowEditVisible=n.createObservable(!0);n.isCopyLoadingVisible=n.createObservable(!1);n.isCreatingLink=n.createObservable(!1);n.isLinkDisabled=n.createObservable(!1);n.isManagePermissionsVisible=n.createObservable(n._canToggleEditInline);n.isMoreSectionVisible=n.createObservable(!1);n.isSingleLinkLabelVisible=n.createObservable(!1);n.linkExpiresText=h.default.SetExpirationLabel;n.linkTitle=h.default.ChangeLinkTitle;n.linkExpiresChecked=n.createObservable(!1);n.linkExpirationInDays=n.createObservable(L.DEFAULT_EXPIRATION).extend({notify:"always"});n.loading=n.createObservable(!0);n.manageAccessLink=h.default.ManageAccessLink;n.managePermissionsText=h.default.managePermissions;n.missingItemError=n._items[0].type===E.default.Folder?h.default.MissingFolderError:h.default.MissingFileError;n.moreOptionsText=h.default.MoreOptions;n.moreSectionIcon=n.createPureComputed(n._computeMoreIcon);n.networksList=[A.default.Facebook,A.default.Twitter,A.default.LinkedIn,A.default.Weibo];n.networksList.forEach(function(e){e.isCreatingLink=n.createObservable(!1)});n.note=n.createObservable("");n.peopleSharingWith=n.observables.createArray();n.setPasswordPermissionsWarning=h.default.SetPasswordPermissionsWarning;n.sharingLinkUrl=n.createObservable("");n.supportsCopy=(g.default.CanUseClipboardData()||document.queryCommandSupported&&document.queryCommandSupported("copy"))&&!n._platform.isIOS;n.setPasswordLabel=h.default.SetPasswordLabel;n.passwordDisplayValue=n.createObservable("");n.passwordHasBeenUpdated=n.createObservable(!1);n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid);n._areNetworksSupported=n.createObservable(!1);n._expiringLinkGleamCalloutStrings={calloutTitle:c.default.expiringLinksFeatureHeadline,calloutBody:c.default.expiringLinksFeatureBody,premiumButtonText:h.default.premiumButtonText,learnMoreButtonText:h.default.learnMoreButtonText};n._passwordProtectedLinkGleamCalloutStrings={calloutTitle:c.default.passwordProtectedLinksFeatureName,calloutBody:c.default.passwordProtectedBody,premiumButtonText:h.default.premiumButtonText,learnMoreButtonText:h.default.learnMoreButtonText};n._isMultiSelect=n._items.length>1;n._defaultGleamCalloutIconUrl=window.require.toUrl("@ms/odsp-media/images/premium/diamond-blue-background-24.svg");n._sharingLinksCollection=n.observables.createArray();n._showExpiringLinkTeachingBubble=n.createObservable(!1);n._expiringLinkUpgradeNavigationAction=n._createExpiringLinkUpgradeNavigationAction();n._passwordProtectedLinkUpgradeNavigationAction=n._createPasswordProtectedLinkUpgradeNavigationAction();n._showAction=new(n.managed(n._actionMap.ShowPermissionsAction));n.createComputed(n._onCurrentSharingLinkUpdated);n.createComputed(n._onAllowEditToggled);n.featureCardData=n._getFeatureCardsData();n.arrowIcon=n.createPureComputed(n._computeArrowIcon);n.isNetworksSectionVisible=n.createPureComputed(n._computeIsNetworksSectionVisible);n.isPremiumEligible=n.createPureComputed(n._computeIsPremiumEligible);n.isPremium=n.createComputed(n._computeIsPremium);n.arePasswordProtectedLinksEnabled=_.isFeatureEnabled(_.EnablePasswordProtectedLinks);n.createBackgroundComputed(n._onSetPasswordChecked);n.isPasswordProtectedLinksBannerVisible=n.createPureComputed(n._computeIsPasswordProtectedLinksBannerVisible);n.createBackgroundComputed(n._computeValidInput);n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel);n.createBackgroundComputed(n._linkExpirationChanged);n.createBackgroundComputed(n._onLinkExpiresChecked);n._isExpiringLinkCalloutOpen=n.createObservable(!1);n._isPasswordProtectedLinkCalloutOpen=n.createObservable(!1);n._userInfoProvider.getExpiringSharingLinksSeen().then(function(e){if(!e){n.isAllowEditVisible(!0);n.isPremiumEligible.peek()?n.async.setTimeout(function(){n._isExpiringLinkCalloutOpen(!0)},0):n.async.setTimeout(function(){n._showExpiringLinkTeachingBubble(!0)},0);n._userInfoProvider.setExpiringSharingLinksSeen()}});n.expiringLinkTeachingBubbleOptions={campaign:n.createObservable(s.EXPIRING_SHARING_LINKS),isVisible:n._showExpiringLinkTeachingBubble};n.gleamCalloutComponent=u.GleamCallout;n.expiringLinkGleamCalloutComponentProps=n.createPureComputed(n._computeExpiringLinkGleamCalloutProps);n.passwordProtectedLinkGleamCalloutComponentProps=n.createPureComputed(n._computePasswordProtectedLinkGleamCalloutProps);n.sharingHintText=n.createComputed(function(){var e=n.currentSharingLink();if(e)return v.getLinkHintText(e,null,n.peopleSharingWith())});n._checkForSpecialFolder();n._getSharingInfo();return n}t.prototype.getNetworkAltText=function(e){return e.altText};t.prototype.logCopy=function(e,t,n){var r=this;this._engagement.logData({name:this.currentSharingLink().tag+"Link.SharingByLinkDialog.Copy",isIntentional:!0,extraData:{linkExpiration:this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0",hasPassword:0!==this.passwordDisplayValue.peek().length}});if(n){this.isCopyLoadingVisible(!0);this.async.setTimeout(function(){r.isCopyLoadingVisible(!1)},1e3)}return!0};t.prototype.onClickCopyLink=function(e,t){var n=!1,r=o.findAncestor(t.target,"od-SharingByLink-row").getElementsByTagName("input")[0];try{r.select();n=document.execCommand("copy")}catch(e){}!n&&g.default.CanUseClipboardData()&&(n=!!g.default.CopyToClipboard(this.currentSharingLink().url));this.logCopy(e,t,n);return!0};t.prototype.onClickCreateLink=function(){this.canManageLinks&&this._createLink()};t.prototype.onMoreOptionsClicked=function(){this.isMoreSectionVisible(!this.isMoreSectionVisible.peek());return!1};t.prototype.onNetworkClicked=function(e,t){var n=this;if(this.currentSharingLink().url)A.default.open(e,this.currentSharingLink().url);else{e.isCreatingLink(!0);this._createLink(!0).then(function(){e.isCreatingLink(!1);A.default.open(e,n.currentSharingLink().url)})}this._engagement.logData({name:p.UsageName[this._getNetworkUsageName(e.name)],isIntentional:!0,location:p.LocationName[p.LocationName.SharingDialog],usageType:d.UsageType[d.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!1};t.prototype.onSetPasswordClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=1;this._isPasswordProtectedLinkCalloutOpen(!0)}return!0};t.prototype.showInvite=function(){if(!this.isCreatingLink.peek()){if(this._dialogStateArray){this._engagement.logData({name:"AddPeople.SharingByLinkDialog.Click",isIntentional:!0});if(this.linkExpiresChecked.peek()){var e=this.linkExpirationInDays.peek(),t=this._sharingLinkExpirationHelper.computeExpirationValidity(e);t===L.LinkExpirationValidity.Valid?this._expiration(this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(e,10))):(t===L.LinkExpirationValidity.Empty||t===L.LinkExpirationValidity.Invalid)&&this._expiration(null)}else this._expiration(null);var n=this._dialogStateArray();n.push(3);this._dialogStateArray(n)}return!1}};t.prototype.showPermissions=function(e,t){this._shouldPreserveFocus(!1);new(this.managed(this._actionMap.ShowPropertiesAction))({useToggleBehavior:!1}).execute(t);this._engagement.logData({name:"ManagePermissions.SharingByLinkDialog.Click",isIntentional:!0});this._onExecuteAction();new(this.managed(this._actionMap.ShowPermissionsAction))({item:this.createObservable(this._items[0])}).execute(t);return!1};t.prototype.switchLinks=function(){this.canManageLinks&&this.isAllowEditVisible(!this.isAllowEditVisible.peek())};t.prototype.onLinkExpiresClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=0;this._isExpiringLinkCalloutOpen(!0)}return!0};t.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1);0===this._currentPremiumFeatureGleamShowing?this._isExpiringLinkCalloutOpen(!0):1===this._currentPremiumFeatureGleamShowing&&this._isPasswordProtectedLinkCalloutOpen(!0)};t.prototype.onPasswordDefined=function(){this.onPasswordChanged()||this.onClickCreateLink()};t.prototype.onPasswordChanged=function(){var e=this.currentSharingLink.peek(),t=e&&e.url.length>0;if(t){this.passwordHasBeenUpdated(!0);this._onLinkExpiresOrPasswordSettingChanged()}return t};t.prototype.clearPasswordDisplayValue=function(){this.passwordDisplayValue("")};t.prototype.launchPermissionsPanel=function(e){this._engagement.logData({name:"ODCExpiringSharingLinks.PasswordBannerManageAccessClicked",isIntentional:!0});this._executeShowPermissionsPanel(e)};t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};t.prototype._onSetPasswordChecked=function(){var e=this.setPasswordChecked(),t=this.currentSharingLink.peek(),n=t&&t.hasPassword,r=n&&!e;n&&e?this.passwordDisplayValue("        "):this.passwordDisplayValue("");r&&this.onPasswordChanged()};t.prototype._computePasswordProtectedLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isPasswordProtectedLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,"ODCPasswordProtectedLinks",this._passwordProtectedLinkUpgradeNavigationAction),learnMoreAction:this._showPasswordProtectedLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,"ODCPasswordProtectedLinks",!1,function(){e._isPasswordProtectedLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,"ODCPasswordProtectedLinks",!0,function(){e._isPasswordProtectedLinkCalloutOpen(!0)}),strings:this._passwordProtectedLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};t.prototype._computeIsPasswordInvalid=function(){return!(!this.passwordHasBeenUpdated.peek()&&"        "===this.passwordDisplayValue())&&(0!==this.passwordDisplayValue().length&&0===this.passwordDisplayValue().trim().length)};t.prototype._onGleamCalloutStateChange=function(e,t,n){var r=t?"UpsellShown":"UpsellDismissed";this._engagement.logData({name:e+"."+r});n()};t.prototype._showPasswordProtectedLinkFeatureCards=function(){this._engagement.logData({name:"ODCPasswordProtectedLinks.LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.passwordProtectedLinkFeatureCardsIndex;this.displayFeatureCards(!0)};t.prototype._getFeatureCardsData=function(){var e=this,t=this._featureCardsProvider.getFeatureCards();t&&t.forEach(function(t,n){3===t.type&&(e.expiringLinkFeatureCardsIndex=n);7===t.type&&(e.passwordProtectedLinkFeatureCardsIndex=n)});return t};t.prototype._createPasswordProtectedLinkUpgradeNavigationAction=function(){return this._isOneDriveWinApp?this._createNavigationActionInBrowser():this._createNavigationAction("PasswordProtectedLinks")};t.prototype._createNavigationAction=function(e){var t=this._attributionHelper.getPurchaseAttribution({source:e,cta:"GoPremium"}),n=this.resources.consume(y.actionMap);return new(this.managed(n.NavigationAction))({url:this._odcUrlDataSource.getUpgradeOptionsUrl(t,!0)})};t.prototype._createNavigationActionInBrowser=function(){return new(this.managed(this._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/?LinkId=330671&clcid=0x"})};t.prototype._computeExpiringLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isExpiringLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,"ODCExpiringSharingLinks",this._expiringLinkUpgradeNavigationAction),learnMoreAction:this._showExpiringLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,"ODCExpiringSharingLinks",!1,function(){e._isExpiringLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,"ODCExpiringSharingLinks",!0,function(){e._isExpiringLinkCalloutOpen(!0)}),strings:this._expiringLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};t.prototype._goToUpgradePage=function(e,t){this._engagement.logData({name:e+".GoPremiumClicked",isIntentional:!0});t.execute(null);t.dispose();this._onExecuteAction()};t.prototype._createExpiringLinkUpgradeNavigationAction=function(){return this._isOneDriveWinApp?this._createNavigationActionInBrowser():this._createNavigationAction("ExpiringLinks")};t.prototype._showExpiringLinkFeatureCards=function(){this._engagement.logData({name:"ODCExpiringSharingLinks.LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.expiringLinkFeatureCardsIndex;this.displayFeatureCards(!0)};t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10);this.linkExpirationInDays(t>0&&t<=L.MAX_EXPIRATION?t.toString():"")};t.prototype._checkForSpecialFolder=function(){this._items[0].isSpecialFolder&&this.note(h.default.specialFolderNote)};t.prototype._computeLinkExpirationInDays=function(e){var t=this.currentSharingLink.peek(),n=parseInt(L.DEFAULT_EXPIRATION,10);t&&t.expiration&&(n=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(t.expiration)));var r=n.toString();this._lastExpiration=e?r:null;this.linkExpirationInDays(r)};t.prototype._computeArrowIcon=function(){return this.unwrapObservable(this.sharingHintText)?this._computeChevron(this.isAllowEditVisible()):""};t.prototype._computeMoreIcon=function(){return this._computeChevron(!this.isMoreSectionVisible())};t.prototype._computeChevron=function(e){var t="Chevron"+(e?"Down":"Up");return r.getIconClassName(t)+" ms-Icon--"+t};t.prototype._computeIsNetworksSectionVisible=function(){return!!this._areNetworksSupported()&&!this._platform.isMobile};t.prototype._computeIsPremiumEligible=function(){return!!_.isFeatureEnabled(_.EnablePremiumCheckWebPasswordLinks)&&(!this._storageOptionsProvider.isReady()||this._storageOptionsProvider.isEligibleForPremium.peek())};t.prototype._computeIsPremium=function(){return!_.isFeatureEnabled(_.EnablePremiumCheckWebPasswordLinks)||!!this._storageOptionsProvider.isReady()&&this._storageOptionsProvider.hasOffice.peek()};t.prototype._computeIsPasswordProtectedLinksBannerVisible=function(){return this.arePasswordProtectedLinksEnabled&&this.currentSharingLink().url&&this.setPasswordChecked()};t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};t.prototype._onLinkExpiresChecked=function(){this.linkExpiresChecked()?this._computeLinkExpirationInDays(!1):this.linkExpirationInDays("")};t.prototype._linkExpirationChanged=function(){var e=this.currentSharingLink.peek(),t=this.linkExpirationInDays();if(e)if(e.type===this._lastLinkType){if(e.url){if(this._sharingLinkExpirationHelper.computeExpirationValidity(t)!==L.LinkExpirationValidity.Invalid&&this._lastExpiration!==t){this._onLinkExpiresOrPasswordSettingChanged();this._lastExpiration=t}}}else this._lastLinkType=e.type};t.prototype._onLinkExpiresOrPasswordSettingChanged=function(){var e=this,t=this.currentSharingLink.peek(),n=this.linkExpirationInDays.peek(),r=this.passwordHasBeenUpdated.peek(),i=this.passwordDisplayValue.peek();this._engagement.logData({name:"SharingByLinkDialog.UpdateLink",extraData:{linkExpiration:this.linkExpiresChecked.peek()?n:"0",hasPassword:0!==i.length}});this.isCreatingLink(!0);this.isLinkDisabled(!0);var s={type:t.type,role:t.role,create:!0};if(this.isPremium.peek()){(t.expiration||this._lastExpiration!==n)&&(s.expiration=this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(n,10)));this.isPasswordInvalid.peek()?s.password="":r&&"        "!==i&&(s.password=i)}this._sharingProvider.manageSharingLinks(this._items,s).then(function(n){for(var r=n.filter(function(n){return e._items[0].id===n.item.id&&n.type===t.type})[0]||n[0],i=!1,s=e._sharingLinksCollection.peek(),o=0,u=s;o<u.length;o++){var a=u[o];if(a.id===r.id&&a.isActive){r.expiration&&(a.expiration=r.expiration);r.hasPassword&&(a.hasPassword=r.hasPassword);i=!0}}i||s.push(r);e._sharingLinksCollection(s);e.currentSharingLink(r);r.hasPassword&&e.passwordDisplayValue("        ");e._itemProvider.invalidateItem(e._items[0].key,{triggerFetch:!0})});this.passwordHasBeenUpdated(!1)};t.prototype._createLink=function(e){var t=this,n=this.allowEditChecked.peek()?6:5,r=this.allowEditChecked.peek()?2:1,i=this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0";if(!e){this.isCreatingLink(!0);this.isLinkDisabled(!0)}var s={type:n,role:r,create:!0,expiration:this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(i,10))};if(this.arePasswordProtectedLinksEnabled){this.isPasswordInvalid.peek()&&(s.password="");0!==this.passwordDisplayValue.peek().length&&(s.password=this.passwordDisplayValue.peek())}this._engagement.logData({name:"SharingByLinkDialog.CreateLink",extraData:{linkExpiration:i,hasPassword:0!==this.passwordDisplayValue.peek().length}});return this._sharingProvider.manageSharingLinks(this._items,s).then(function(e){var r=e.filter(function(e){return t._items[0].id===e.item.id&&e.type===n})[0]||e[0],i=t._sharingLinksCollection.peek();i.push(r);t._sharingLinksCollection(i);t.currentSharingLink(r);t._enableLink();r.hasPassword&&t.passwordDisplayValue("        ");t._itemProvider.invalidateItem(t._items[0].key,{triggerFetch:!0});return T.default.wrap(!0)})};t.prototype._enableLink=function(){var e=this;this.async.setTimeout(function(){e.isLinkDisabled(!1)},500)};t.prototype._isLinkExpired=function(e){if(e.expiration){return new Date(e.expiration).getTime()<=Date.now()}return!1};t.prototype._setCurrentSharingLink=function(e){var t=this;if(this._isLinkExpired(e)){var n=e.type,r=e.role,i={link:e,type:n,role:r,create:!1};this._sharingProvider.manageSharingLinks(this._items,i).then(function(e){t._sharingLinksCollection(e)});this.currentSharingLink({url:"",type:n,role:r});return!1}this.currentSharingLink(e);return!0};t.prototype._setDefaultSharingLink=function(){1===this._items.length&&!!(this._items[0].isAlbum||this._items[0].photo||this._items[0].video)?this.currentSharingLink({url:"",type:5,role:1}):this.currentSharingLink({url:"",type:6,role:2})};t.prototype._getBestSharingLink=function(e){var t=this;this.isReady=e.getBestSharingLink().then(function(e){e?t._setCurrentSharingLink(e):t._setDefaultSharingLink()},function(e){t.error(h.default.ServerError)})};t.prototype._onAllowEditToggled=function(){var e=this,t=this.allowEditChecked(),n=this.currentSharingLink.peek();if(!(!n||t&&6===n.type||!t&&5===n.type)){this.isLinkDisabled(!0);this._sharingLinksCollection().some(function(n){return t&&6===n.type?e._setCurrentSharingLink(n):t||5!==n.type?void 0:e._setCurrentSharingLink(n)})||(t?this.currentSharingLink({url:"",type:6,role:2}):this.currentSharingLink({url:"",type:5,role:1}));this._computeLinkExpirationInDays(!0)}};t.prototype._getNetworkUsageName=function(e){var t=p.UsageName.SharedViaFacebook;e===A.default.Facebook.name?t=p.UsageName.SharedViaFacebook:e===A.default.Twitter.name?t=p.UsageName.SharedViaTwitter:e===A.default.LinkedIn.name?t=p.UsageName.SharedViaLinkedIn:e===A.default.Weibo.name&&(t=p.UsageName.SharedViaSinaWeibo);return t};t.prototype._getSharingInfo=function(){var e=this,t=this._sharingProvider.getSharingData(this._items[0]);this._getSharingSettings(t).then(function(){if(e._isMultiSelect){e._setDefaultSharingLink();e.isManagePermissionsVisible(!1);e.loading(!1)}else{e._getSharingLinks(t);e._getBestSharingLink(t)}})};t.prototype._getSharingLinks=function(e){var t=this;e.getLinks().then(function(e){null!=e&&t._sharingLinksCollection(e.filter(function(e){return e.item.id===t._items[0].id}))},function(e){t.error(h.default.ServerError);t.loading(!1)})};t.prototype._getSharingSettings=function(e){var t=this;return this.isReady=e.getSettings().then(function(e){t._sharingSettings=e;e.itemId||t.hasError(!0);t._areNetworksSupported(t._sharingSettings.networkLinksEnabled);t.canManageLinks=t._sharingSettings.canManageLinks;t.peopleSharingWith(t._sharingSettings.sharedWith)},function(e){e&&403===e.status?t.error(h.default.AccessDenied):t.error(h.default.ServerError);t.hasLoadingError(!0);t.loading(!1)})};t.prototype._onCurrentSharingLinkUpdated=function(){var e=this.currentSharingLink();if(e){this.sharingLinkUrl(e.url);this.allowEditChecked(6===e.type);this.linkExpiresChecked(!!e.expiration);this.setPasswordChecked(!!e.hasPassword);this.hasLoadingError(!1);this.loading(!1);this.isCreatingLink(!1);this._enableLink()}};return t})(M.default);t.default=H});
define("odsp-next/controls/gleamCallout/GleamCallout",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/FocusZone","react","office-ui-fabric-react/lib/Styling","../banner/Banner.resx","ODCExecutors_css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._showCallout=function(){n.setState({isCalloutVisible:!0})};n._onCalloutDismiss=function(){n.setState({isCalloutVisible:!1})};n._onGleamRef=function(e){n._gleam=e};n.state={isCalloutVisible:t.forceOpenCallout};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isCalloutVisible:e.forceOpenCallout})};t.prototype.componentDidUpdate=function(e,t){this.state.isCalloutVisible&&!t.isCalloutVisible?this.props.onOpened():!this.state.isCalloutVisible&&t.isCalloutVisible&&this.props.onDismissed()};t.prototype.render=function(){var e=this.props,t=this.state,n=this.props,a=n.strings,f=n.gleamCalloutHeaderIconUrl;return s.createElement("span",{className:"od-GleamCallout",onClick:this._showCallout},s.createElement("img",{className:"od-GleamCallout-gleam",ref:this._onGleamRef,src:window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg")}),t.isCalloutVisible&&s.createElement(r.Callout,{className:"od-GleamCallout-callout",directionalHint:r.DirectionalHint.rightCenter,directionalHintForRTL:r.DirectionalHint.bottomCenter,gapSpace:2,onDismiss:this._onCalloutDismiss,target:this._gleam,setInitialFocus:!0},s.createElement(i.FocusZone,{className:"od-GleamCallout-calloutContent",isCircularNavigation:!0},s.createElement("button",{className:"od-GleamCallout-closeButton",onClick:this._onCalloutDismiss,"aria-label":u.default.CloseLabel,title:u.default.CloseLabel},s.createElement("i",{className:o.getIconClassName("Cancel")})),s.createElement("img",{className:"od-GleamCallout-headerImage",src:f}),s.createElement("h3",{className:"od-GleamCallout-title"},a.calloutTitle),s.createElement("p",{className:"od-GleamCallout-body"},a.calloutBody),s.createElement("div",null,s.createElement("button",{className:"od-Button od-GleamCallout-button od-GleamCallout-premiumButton",onClick:e.goPremiumAction},a.premiumButtonText),!this.props.isMobile&&s.createElement("button",{className:"od-Button od-Button--primary od-GleamCallout-button od-GleamCallout-learnButton",onClick:e.learnMoreAction},a.learnMoreButtonText)))))};return t})(s.Component);t.GleamCallout=a});
define("odsp-next/controls/sharing/sharedWith/SharedWith",["require","exports","./SharedWith.html","./SharedWithViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../../persona/Persona"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-sharedWith",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/sharing/sharedWith/SharedWith.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharedWith-Container">\x3c!--ko if:loading--\x3e<div class="od-SharedWith-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div data-bind="if:showRequests"><div aria-live="polite" class="od-SharedWith-accessRequests" role="alert"><i class="ms-Icon ms-Icon--Info od-SharedWith-accessRequestsIcon" data-bind="icon:true"></i><span data-bind="text:requestsPending"></span><a class="od-SharedWith-accessRequestsLink" target="_blank" data-bind="attr:{href:requestsLink},text:viewRequests,click:$component.clickAccessRequests.bind($component)"></a></div></div><div aria-live="assertive" class="od-SharedWith-error" data-bind="if:hasError"><span data-bind="text:error"></span></div><div aria-live="polite" data-bind="if:isMultiSelect"><span data-bind="text:multiSelectErrorText"></span></div><div class="od-SharedWith-wrapper" aria-live="polite" aria-relevant="text" data-bind="style:{maxHeight:height},keyboard:keyNav.keyboardOptions,selection:{data:keyNav.focusableTiles,mode:\'single\',direction:\'vertical\',focused:keyNav.focusedTile}"><div data-bind="foreach:links"><div class="od-SharedWith-table"><div class="od-SharedWith-row"><div class="od-SharedWith-cell od-SharedWith-iconCell"><div class="od-SharedWith-icon"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true"></i></div></div><div class="od-SharedWith-cell">\x3c!--ko if:$parent.canManageLinks--\x3e<a class="od-SharedWith-linkScope" data-bind="text:$parent.calculateScope($data),click:$parent.scopeClick.bind($parent,$data)"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:$parent.canManageLinks--\x3e<span class="od-SharedWith-linkScope" data-bind="text:$parent.calculateScope($data)"></span>\x3c!--/ko--\x3e<div class="od-SharedWith-table od-SharedWith-url"><div class="od-SharedWith-row"><div class="od-SharedWith-cell"><input class="od-SharedWith-input" readonly data-bind="value:url,selectOnFocus:{isPermanent:true},event:{copy:$component.logCopy.bind($component)},attr:{\'aria-label\':$parent.calculateHint($data)}"></div>\x3c!--ko if:$parent.canManageLinks--\x3e<div class="od-SharedWith-cell"><button class="od-SharedWith-removeLinkButton" data-bind="click:$parent.removeSharingLink.bind($parent,$data),attr:{title:$parent.disableLinkText,\'aria-label\':$parent.disableLinkText}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</div></div><span class="od-SharedWith-linkSwitcher" data-bind="text:$parent.calculateHint($data)"></span></div></div></div></div><div class="od-SharedWith-PersonaTiles" role="tree" data-bind="foreach:{data:personaTileCollection,as:\'personaTile\'}"><div class="od-SharedWith-person" data-bind="component:{name:$parent.personaTileTagName,params:{tile:personaTile}}"></div></div>\x3c!--ko if:showUserListTrimmedText()--\x3e<div class="od-SharedWith-trimmedText" data-bind="text:userListTrimmedText"></div>\x3c!--/ko--\x3e</div><div class="od-SharedWith-linksBox" data-bind="if:hasSettings()"><button class="od-SharedWith-link" data-bind="click:stopSharing,text:stopSharingText,visible:canUnshare"></button><button class="od-SharedWith-link" data-bind="text:emailText,visible:showEmailLink(),click:$component.clickEmail.bind($component)"></button>\x3c!--ko if:canManagePermissions--\x3e<a class="od-SharedWith-link" target="_blank" data-bind="attr:{href:advancedUrl},text:advancedText,visible:showAdvanced,click:clickAdvanced"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/sharedWith/SharedWithViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../providers/dialog/DialogProvider","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","./SharedWith.resx","@ms/odsp-utilities/lib/encoding/UriEncoding","../../confirmation/Confirmation","../sharingByLink/SharingByLinkStringHelper","../../../bindings/focus/SelectOnFocusBinding","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/sharing/SharingHelper","../../../utilities/icons/Icon","../../iframeLoader/IframeLoader","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../bindings/keyboard/KeyboardBinding","../../personaTile/PersonaTile","../../personaTile/PersonaTileHelper","../../../bindings/selection/SelectionBinding","./SharedWithKeyboardNav"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=l.default.tagName;n.personaTileTagName=T.default.tagName;n._sharingProvider=n.resources.consume(c.resourceKey);n._engagement=n.resources.consume(f.resourceKey);n._navigation=n.resources.consume(S.navigation);n._personaTileHelper=new N.default;n.keyNav=new k.default;n.personaTileCollection=n.observables.createArray([]);n.addBindingHandlers({keyboard:x.default,selection:C.default,selectOnFocus:g.default});n.removePerson=function(e){n.people.remove(e)};n._item=t.item;n._items=t.items;t.personaSize?n.cardSize=t.personaSize:n.cardSize=r.observable(4);n.height=t.height?t.height:"none";n.showEmailLink=r.observable(!1);n.hasSettings=r.observable(!1);n.hasData=r.observable(!1);n.showRequests=r.observable(!1);n.loading=r.observable(!0);n.isMultiSelect=r.observable(!1);n.error=r.observable("");n.advancedUrl=r.observable("");n.disableLinkText=p.default.DisableLinkText;n.emailText=p.default.EmailEveryone;n.advancedText=p.default.Advanced;n.requestsPending=p.default.RequestPending;n.stopSharingText=p.default.StopSharing;n.viewRequests=p.default.ViewRequests;n.multiSelectErrorText=p.default.MultiSelectError;n.userListTrimmedText=p.default.SharedWithManyText;n.showUserListTrimmedText=n.createObservable(!1);n._selectionModel=n.resources.consume(o.itemsSelection);n._urlDataSource=n.resources.consume(u.url);n.people=r.observableArray([]);n.links=r.observableArray([]);n.canManageLinks=r.observable(!1);n.canManagePermissions=r.observable(!1);n.showAdvanced=n.createComputed(function(){return!!n.advancedUrl()});n.canUnshare=r.observable(!1);n.requestsLink=r.observable("");n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e=n.people(),t="mailto:",r=new Array,i=0;i<e.length;i++)e[i].email&&r.push(e[i].email);n.showEmailLink(r.length>0&&r.length<29);t+=d.default.encodeURIComponent(r.join(";"));t+="?subject="+d.default.encodeURIComponent(n._settings.itemName);return t+="&body="+encodeURI(encodeURI(n._settings.itemUrl))});n.hasError=n.createComputed(function(){return!!n.error()});if(n._selectionModel&&n._selectionModel.selection&&n._selectionModel.selection().length>1||n._items&&n._items.length>1){n.isMultiSelect(!0);n.loading(!1)}else{t.includeLinks&&n._getLinks();n._getSharedWith()}return n}t.prototype.logCopy=function(e,t){this._engagement.logData({name:e.tag+"Link.SharedWith.Copy",isIntentional:!0});return!0};t.prototype.calculateScope=function(e){var t="";e.item&&this._getCurrentItem()!==e.item&&(t=y.format(p.default.SharingFrom,e.item.name));return t};t.prototype.scopeClick=function(e){this._navigation.navigateTo(this._urlDataSource.getItemUrl(e.item.key));return!0};t.prototype.calculateHint=function(e){return m.getLinkHintText(e,this._companyDisplayName)};t.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.SharingDialog.Click",isIntentional:!0});this._navigation.navigateTo(this.mailto.peek())};t.prototype.clickAdvanced=function(){this._engagement.logData({name:"AdvancedSettings.SharingDialog.Click",isIntentional:!0});if(this._settings.advancedUrlOpenInPlace){this._showAdvancedDialog();return!1}return!0};t.prototype.clickAccessRequests=function(){this._engagement.logData({name:"PendingAccessRequests.SharingDialog.Click",isIntentional:!0});return!0};t.prototype.stopSharing=function(){this._engagement.logData({name:"StopSharing.SharingDialog.Click",isIntentional:!0});this._stopSharingConfirm()};t.prototype.removeSharingLink=function(e){var t=this,n=this.resources.consume(a.resourceKey);b.disableLinkConfirm(function(){t._engagement.logData({name:"Disable"+e.tag+"Link.SharedWith.Click",isIntentional:!0});var n={type:e.type,role:e.role,create:!1};return t._sharingProvider.manageSharingLinks([t._getCurrentItem()],n).then(function(e){t._updateSharingLinks(e);return s.default.wrap(!0)},function(e){return!1})},function(e){t.isReady=e},n,"SharedWith")};t.prototype._stopSharing=function(){var e=this._sharingProvider.unshare(this._getCurrentItem());this.loading(!0);return e};t.prototype._getLinks=function(){var e=this,t=this.resources.consume(h.resourceKey.optional);t&&t.loadData().then(function(t){e._companyDisplayName=t.CompanyDisplayName;e.links.peek().length>0&&e._updateSharingLinks(e.links())});this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(t){t&&e._updateSharingLinks(t)},function(t){e.error(p.default.LinksError)})};t.prototype._updateSharingLinks=function(e){this.links(e.filter(function(e){return e.isActive&&8!==e.type}))};t.prototype._getSharedWith=function(){var e=this,t=this._sharingProvider.getSharingData(this._getCurrentItem());this.isReady=t.getPermissions(!0).then(function(t){var n=t[0];if(n){if(n.hasPendingAccessRequests){e.showRequests(!0);e._engagement.logData({name:"PendingAccessRequests.SharingDialog.Render"})}e.requestsLink(n.pendingAccessRequestsLink);e.canUnshare(n.canUnshare);e._parseSharedWith(n?n.people:null)}else e.loading(!1)},function(t){t&&403===t.status?e.error(p.default.AccessDenied):e.error(p.default.ServerError);e.loading(!1)});t.getSettings().done(function(t){e._settings=t;e.canManageLinks(t.canManageLinks);e.canManagePermissions(t.canManagePermissions);e.advancedUrl(t.advancedUrlOpenInPlace?"javascript:;":t.advancedUrl);e.hasSettings(!0)},function(e){})};t.prototype._parseSharedWith=function(e){if(e){this.people(e);this._convertPeopleToPersonaTiles();this.showUserListTrimmedText(this.people().length>=30)}this.loading(!1)};t.prototype._convertPeopleToPersonaTiles=function(){for(var e=this.people.peek(),t=new Array,n=0;n<e.length;n++){var r=e[n],i={inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),person:this.observables.create(r),personaSize:this.cardSize,removePerson:this.removePerson,showPresence:!0},s=this._personaTileHelper.convertPersonaToPersonaTile(i,r.userId);t.push(s)}this.personaTileCollection(t);this.keyNav.focusableTiles(t)};t.prototype._getCurrentItem=function(){return this._item?this._item:r.utils.unwrapObservable(this._selectionModel.selection()[0])};t.prototype._stopSharingConfirm=function(){var e=this,t=this.resources.consume(a.resourceKey),n=this._engagement,i=r.observable(!0);t.requestDialog({title:p.default.StopSharingConfirmationTitle,size:"Medium",component:{name:v.default.tagName,params:{message:p.default.StopSharingConfirmationMessage}},actions:[{name:p.default.StopSharingConfirmationButton,execute:function(){n.logData({name:"Unshare.SharedWithDialog.Click",isIntentional:!0});i(!1);return e._stopSharing().then(function(e){return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new w.default("Save"),automationId:"UnshareConfirm"},{name:p.default.StopSharingCancelButton,execute:function(){n.logData({name:"CancelStopSharing.SharedWithDialog.Click",isIntentional:!0});return s.default.wrap(3)},isDefault:!1,icon:new w.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.prototype._showAdvancedDialog=function(){var e=this,t=this.resources.consume(a.resourceKey),n=t.currentDialog();n&&n.dismiss();n=t.requestDialog({title:y.format(p.default.AdvancedDialogTitle,this._getCurrentItem().name),size:"Large",component:{name:E.default.tagName,params:{url:this._settings.advancedUrl,onload:function(e){var t=e.target;if(t){t.commitPopup=function(){n.dismiss()};t.style.height=Math.max(300,.25*window.innerHeight)+"px"}}}},actions:[{name:p.default.ShowAdvancedDialogCloseButton,execute:function(){e._engagement.logData({name:"AdvancedSharingClose.SharedWithDialog.Click",isIntentional:!0});return s.default.wrap(3)},isDefault:!0,isAvailable:r.observable(!0),icon:new w.default("Cancel"),automationId:"AdvancedSharingClose"}],executeDefaultAction:!1})};return t})(i.default);t.default=L});
define("odsp-next/controls/iframeLoader/IframeLoader",["require","exports","./IframeLoader.html","./IframeLoaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-iframe-loader",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/iframeLoader/IframeLoader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ms-IframeLoader" data-bind="css:{\'ms-IframeLoader--visible\':isVisible}"><div class="ms-IframeLoader-title" data-bind="css:{\'ms-IframeLoader-title--visible\':isTitleVisible},text:title()"></div><iframe class="ms-IframeLoader-iframeElmt" data-bind="attr:{src:url(),role:role,tabindex:tabindex},event:{load:iframeOnLoad},css:{\'ms-IframeLoader-iframeElmt--visible\':!isLoading()},element:iframeElement"></iframe>\x3c!--ko if:showLoadingLabel--\x3e<span class="ms-IframeLoader-loadingLabel" data-bind="text:loadingLabel,css:{\'ms-IframeLoader-loadingLabel--visible\':isLoading,\'ms-IFrameLoader-LoadingWithMargin\':loadingLabelHasMargins}"></span>\x3c!--/ko--\x3e<div class="ms-IframeLoader-progressContainer" data-bind="css:{\'ms-IframeLoader-progressContainer--visible\':isLoading}"><div class="ms-IframeLoader-progress" data-bind="component:{name:progressSpinnerFlatTagName}"></div></div></div>'});
define("odsp-next/controls/iframeLoader/IframeLoaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","./IframeLoader.resx","../../bindings/element/ElementBinding","../../utilities/iframe/IframeHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.loadingLabel=o.default.IframeLoadingLabel;n._isIframeAvailable=!0;var r=t.url,f=t.title||"";n.url="string"==typeof r?i.observable(r):r;n.title="string"==typeof f?i.observable(f):f;n.isExcludeFromScreenReader=t.isExcludeFromScreenReader||!1;n.isLoading=t.isLoading?t.isLoading:i.observable(!0);n.loadingLabelHasMargins=t.loadingLabelHasMargins;n.progressSpinnerFlatTagName=s.default.tagName;n.showLoadingLabel=t.showLoadingLabel;n.iframeElement=t.iframeElement||i.observable(null);n.tabindex=n.isExcludeFromScreenReader?"-1":null;n.role=n.isExcludeFromScreenReader?"presentation":null;n.isVisible=n.createComputed(n._computeIsVisible);n.isTitleVisible=n.createComputed(n._computeIsTitleVisible);n.addBindingHandlers({element:u.default});n.iframeOnLoad=function(e,r){n._isIframeAvailable&&t.onload&&t.onload(r);n.isLoading(!1)};n.addDisposable({dispose:function(){a.disposeIframe(n.iframeElement(),function(){n._isIframeAvailable=!1})}});return n}t.prototype._computeIsVisible=function(){return!!this.url()};t.prototype._computeIsTitleVisible=function(){return!!this.title()};return t})(r.default);t.default=f});
define("odsp-next/utilities/iframe/IframeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disposeIframe=function(e,t){if(e){e.src="";t&&t()}};t.isCrossOrigin=function(){try{return!window.top.location.hostname}catch(e){return!0}}});
define("odsp-next/controls/personaTile/PersonaTileHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){return e.call(this)||this}t.prototype.convertPersonaToPersonaTile=function(e,t){return{personaParams:e,key:t,focused:this.observables.create(!1)}};return t})(r.default);t.default=i});
define("odsp-next/controls/sharing/sharedWith/SharedWithKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Right:t.onKeyRight}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyRight=function(e,t){var n=e.keyNav.focusedTile();n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0);t.stopPropagation();return!0};return t})(r.default);t.default=i});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmail",["require","exports","./ShareByEmail.html","./ShareByEmailViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../../peoplePicker/PeoplePicker"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-share-by-email",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmail.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="Sharing">\x3c!--ko if:loading--\x3e<div class="Sharing-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!sharingError()--\x3e\x3c!--ko ifnot:loading--\x3e<div class="Sharing-table" data-bind="ifnot:hasLoadingError"><div class="Sharing-row"><div class="Sharing-cell Sharing-peoplePicker" id="Sharing-peoplePicker" data-bind="component:{name:peoplePickerTagName,params:peoplePickerParams}"></div>\x3c!--ko if:!hasSharingLink--\x3e<select class="Sharing-cell Sharing-simpleRoleSelector" data-bind="foreach:sharingRoleOptions,value:roleSelection,attr:{\'aria-label\':permissionLabel},visible:sharingRoleOptions().length>0"><option data-bind="text:name,value:value"></option></select>\x3c!--/ko--\x3e</div></div><div aria-live="assertive" class="PeoplePicker-error" data-bind="if:error"><span data-bind="text:error"></span></div><div data-bind="ifnot:hasLoadingError"><div aria-live="polite" data-bind="component:{name:sharingTipsTagName,params:sharingTipsParams}"></div></div><div class="od-ShareByEmail-textInput" data-bind="visible:canSendEmail()"><textarea class="Sharing-mailInput" data-bind="enable:sendEmail,textInput:emailInputText,attr:{placeholder:inputPlaceholder}"></textarea>\x3c!--ko if:expirationLabel--\x3e<div class="od-ShareByEmail-expirationLabel"><i class="od-ShareByEmail-expirationIcon ms-Icon ms-Icon--Calendar" data-bind="icon:true"></i><span class="od-ShareByEmail-expirationText" data-bind="text:expirationLabel"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:arePasswordProtectedLinksEnabled--\x3e\x3c!--ko if:isPasswordProtectedLink--\x3e<div class="od-ShareByEmail-passwordLabel"><i class="ms-Icon ms-Icon--Lock" data-bind="icon:true"></i><span class="od-ShareByEmail-passwordProtectedText" data-bind="text:passwordProtectedLabel"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:!hasSharingLink--\x3e<div class="Sharing-link" data-bind="visible:supportsSharingPropagation()"><input id="Sharing-aclPropagation" type="checkbox" data-bind="checked:propagateSharing"><label for="Sharing-aclPropagation" class="Sharing-aclPropagationLabel" data-bind="text:propagateSharingLabel"></label></div><div class="Sharing-options" data-bind="visible:canSendEmail()&&sharingRoleOptions().length>0&&!hideOptions"><div class="Sharing-link" data-bind="visible:canSendLink"><input id="Sharing-requireSignIn" type="checkbox" data-bind="checked:requireSignIn,event:{change:requireSignInChanged}"><label for="Sharing-requireSignIn" data-bind="text:requireSignInLabel,attr:{title:requireSignInTooltip}"></label></div><div class="Sharing-link" data-bind="visible:showSendEmailOption"><input id="Sharing-sendEmailCheckbox" type="checkbox" data-bind="checked:sendEmail,enable:requireSignIn()"><label for="Sharing-sendEmailCheckbox" data-bind="text:sendEmailLabel"></label></div></div>\x3c!--/ko--\x3e<div class="Sharing-charCounter" data-bind="visible:charLimitVisible,css:{\'Sharing-charCounter--limitReached\':charLimitReached},text:charCountText" aria-live="polite"></div><div class="ms-clearfix"></div>\x3c!--ko if:showShareButton--\x3e<div class="Sharing-submit"><button class="Sharing-submitButton od-Button od-Button--primary" data-bind="click:shareClicked,enable:shareAvailable,automation:\'shareDialogCommit\'"><span class="od-Button-label" data-bind="text:shareButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:sharingError()--\x3e<div class="od-ShareByEmail-error" data-bind="text:sharingError" aria-live="assertive"></div>\x3c!--/ko--\x3e\x3c!--ko component:{name:\'ms-panel-host\'}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmailViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","knockout","../../loadingSpinner/LoadingSpinner","../../../providers/panel/PanelProvider","../../peoplePicker/PeoplePicker","./Sharing.resx","../sharingTips/SharingTips","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/dateTime/DateTime","../emailLink/EmailLink.resx","../../../utilities/policyTip/PolicyTipHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=f.default.tagName;n.peoplePickerTagName=c.default.tagName;n.sharingTipsTagName=p.default.tagName;n._params=t;n._items=t.items;n._itemProvider=n.resources.consume(m.resourceKey);n._engagement=n.resources.consume(r.resourceKey);n._expiration=n.wrapObservable(t.expiration);var o=n._expiration&&n._expiration.peek();n.expirationLabel=o?g.getShortDisplayDate(new Date(n._expiration.peek())):null;n.isPasswordProtectedLink=n._params.currentLink&&n._params.currentLink.peek()&&n._params.currentLink.peek().hasPassword;var d=n._items[0].key;n.item=n._itemProvider.getItemSync({parentKey:d}).item;n._referenceRevision=n.createPureComputed(function(){return n.item().revision});n._isDoneGettingSharingSettings=n.createObservable(!1);n.canUserShareExternally=n._params.canUserShareExternally||n.observables.create(!1);n.policyTipInfo=n.createObservable(null);n._policyTipDataSource=n.resources.isExposed(i.policyTip)?n.resources.consume(i.policyTip):null;n.showShareButton=!!t.onExecuteAction;n.permissionLabel=h.default.PermissionLabel;n.passwordProtectedLabel=h.default.PasswordProtectedLabel;n.arePasswordProtectedLinksEnabled=s.isFeatureEnabled(s.EnablePasswordProtectedLinks);n.inputPlaceholder=h.default.EmailPlaceholder;n.sendEmailLabel=h.default.EmailInvitation;n.requireSignInLabel=h.default.RequireSignInLabel;n.propagateSharingLabel=h.default.PropagateSharingLabel;n.requireSignInTooltip=h.default.RequireSignInTooltip;n.shareButtonText=h.default.ShareText;n.charLimitVisible=a.observable(!1);n.charLimitReached=n._params.emailMessageExceedsLimit;n.charCountText=a.observable("");n._emailCharLimit=-1;n.canSendEmail=a.observable(!1);n.canSendLink=a.observable(!1);n.supportsSharingPropagation=a.observable(!1);n.sharingRoleOptions=a.observableArray([]);n.hideOptions=!!t.hideOptions;n.showSendEmailOption=t.showSendEmailOption;n.propagateSharing=t.propagateSharing;n.currentSharingLink=t.currentLink;n.hasSharingLink=!!n.currentSharingLink&&null!==n.currentSharingLink();if(n.hasSharingLink){n.requireSignIn=n.createComputed(function(){var e=n.currentSharingLink();return 6!==e.type&&5!==e.type});n.roleSelection=n.createComputed(function(){return n.currentSharingLink().role.toString()});n.linkType=n.createComputed(function(){return n.currentSharingLink().type});n.sendEmail=a.observable(!0)}else{n.requireSignIn=t.requireSignIn;n.roleSelection=t.roleValue;n.linkType=t.linkType?n.createObservable(t.linkType):n.createObservable(8);n.sendEmail=t.sendEmail}n.emailInputText=t.emailMessage||a.observable("");n.error=t.errorMessage||a.observable("");n._canCurrentUserShareExternally=n.createObservable(!1);n.loading=a.observable(!0);n.hasLoadingError=a.observable(!1);n.sharedWithSize=a.observable(2);n.shareAvailable=n.createComputed(n._computeShareAvailable);n.createComputed(n._computeValidateMessageLength);n.peopleSharingWith=a.observableArray([]);n.resources.bind(l.resourceKey);n._sharingSettings2=n.observables.create(null);n.ppQueryParams=n.createPureComputed(n._computePeoplePickerQueryParams);n.policyTipType=n.createPureComputed(n._computePolicyTipType);n.blockViaPolicy=n.createPureComputed(n._computeBlockViaPolicy);n._policyTipDataSource&&(n.policyTipType?n._policyTipDataSource.getPolicyTip(n.item.peek()).done(function(e){e&&e.issueDescriptions&&e.issueDescriptions.length&&n.policyTipInfo(e)}):n.policyTipInfo(null));n.sharingTipsParams=n.createComputed(n._computeSharingTipsParams);n.missingItemError=n._items[0].type===u.default.Folder?h.default.MissingFolderError:h.default.MissingFileError;n.sharingError=n.createObservable("");n.getSharingSettings(!!n.item.peek().policyTip);n.createBackgroundComputed(n._refreshSharingSettings);return n}t.prototype.requireSignInChanged=function(){this.requireSignIn()&&this.sendEmail(!0)};t.prototype.shareClicked=function(){var e;e=this._items.length>1?this._items:[this.item.peek()];var t=this.resources.consume(o.resourceKey),n={items:e,roleValue:this.roleSelection.peek(),message:this._params.emailMessage.peek(),sendEmail:this.sendEmail.peek(),requireSignIn:this.requireSignIn.peek(),propagateSharing:this._params.propagateSharing.peek(),expiration:this._expiration.peek()};this._engagement.logData({name:"Share.SharingDialog.Click",isIntentional:!0});t.share(this._params.selectedPeople.peek(),n);this._params.onExecuteAction&&this._params.onExecuteAction()};t.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};t.prototype._computeBlockViaPolicy=function(){if(!s.isFeatureEnabled(s.PolicyTipPanel))return!1;var e=this.policyTipType();return e?b.isPolicyTipFlagSet(e,4):void 0};t.prototype._computeSharingTipsParams=function(){if(this._isDoneGettingSharingSettings()){return{selectedPeople:this.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:this.showExternalUserWarning,policyTipType:this.policyTipType(),policyTipInfo:this.policyTipInfo,item:this.item()}}};t.prototype._computeShareAvailable=function(){if(!this._isDoneGettingSharingSettings())return!1;if(this.peoplePickerParams.hasUnresolvedText&&this.peoplePickerParams.hasUnresolvedText())return!1;if(this.blockViaPolicy()&&this.peoplePickerParams&&this.peoplePickerParams.selectedPeopleContainsExternal&&this.peoplePickerParams.selectedPeopleContainsExternal())return!1;for(var e=0,t=this.peoplePickerParams.selectedPeople();e<t.length;e++){if(!t[e].isResolved)return!1}this._emailCharLimit=this._mailSettings&&this._mailSettings.defaultCharacterLimit;this._evaluateMessageLength(this.emailInputText.peek());return!this.charLimitReached()&&this.peoplePickerParams.selectedPeople().length>0};t.prototype._computeValidateMessageLength=function(){var e=this.emailInputText();this._evaluateMessageLength(e)};t.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings2();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.blockViaPolicy()};if(e.pickerProperties){var n=e.pickerProperties;t.principalSource=n.PrincipalSource;t.principalType=n.PrincipalAccountType;t.querySettings=n.QuerySettings;t.allowEmailAddresses=n.AllowEmailAddresses;t.filterExternalUsers=!1}return t}};t.prototype._evaluateMessageLength=function(e){var t=this._getEncodedMessageLength(e),n=this._emailCharLimit;if(9999999999!==n){!this.charLimitVisible.peek()&&t&&t>n-100&&this.charLimitVisible(!0);if(this.charLimitVisible.peek()){this.charCountText(d.format(h.default.CharacterCounterFormat,t,n));t>n?this.charLimitReached(!0):this.charLimitReached.peek()&&this.charLimitReached(!1)}}else{this.charLimitVisible(!1);this.charLimitReached(!1)}};t.prototype._getEncodedMessageLength=function(e){var t=0,n=e.length,r=0,i=!1;if(!e||0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t};t.prototype.getSharingSettings=function(e){var t=this,n=this.resources.consume(o.resourceKey).getSharingData(this.item(),e);this.isReady=n.getSettings().then(function(e){t.sharingSettings=e;t._sharingSettings2(e);t.sharingSettings.itemId?t.sharingSettings.blockPeoplePickerAndSharing&&t.sharingError(y.default.CannotShareText):t.sharingError(t.missingItemError);t.showExternalUserWarning=t.sharingSettings.showAdditionalExternalWarning;t._canCurrentUserShareExternally(t.sharingSettings.canCurrentUserShareExternally);t.peoplePickerParams={selectedPeople:t._params.selectedPeople,selectedPeopleContainsExternal:t._params.selectedPeopleContainsExternal,peoplePickerQueryParams:t.ppQueryParams,hasUnresolvedText:t._params.hasUnresolvedText,contactInviteLimit:e.contactInviteLimit};t.sharingRoleOptions(e.sharingRoles);t._mailSettings=e.mailSettings;t.canSendEmail(e.canSendEmail);t.canSendLink(e.canSendLink);t.supportsSharingPropagation(e.supportsSharingPropagation);t._params.propagateSharing&&t._params.propagateSharing(e.supportsSharingPropagation);t.peopleSharingWith(e.sharedWith);t._isDoneGettingSharingSettings(!0);t.hasLoadingError(!1);t.loading(!1)},function(e){var n=t.item();if(n&&n.parentLink){t._engagement.logData({name:"GetSettings.SharingDialog.Redirect"});window.location.href=n.parentLink+"?sharingDialogForListItemId="+n.id}else{e&&403===e.status?t.error(h.default.AccessDenied):t.error(h.default.ServerError);t._isDoneGettingSharingSettings(!0);t.hasLoadingError(!0);t.loading(!1)}})};t.prototype._refreshSharingSettings=function(){var e=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(t){e.getSharingSettings(!0)})};return t})(v.default);t.default=w});
define("odsp-next/controls/sharing/sharingTips/SharingTips",["require","exports","./SharingTips.html","./SharingTipsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../../dlplite/DlpLite"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-sharingTips",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/sharing/sharingTips/SharingTips.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharingTips"><div class="od-SharingTips-section" data-bind="if:externalUsers().length>0"><div data-bind="if:externalUsers().length===1"><div class="od-SharingTips-singleExternalUser" data-bind="html:singleExternalUserText,css:{\'od-SharingTips-error\':isUserBlocked}"></div></div><div data-bind="if:externalUsers().length>1"><span class="od-SharingTips-multiUser" data-bind="text:multiExternalUserText,css:{\'od-SharingTips-error\':isUserBlocked}"></span><button class="od-SharingTips-expandLink" data-bind="text:expandUsersText,click:clickExpandUsers"></button><div>\x3c!--ko if:showMultiUsers--\x3e<ul class="od-SharingTips-multiUserList" data-bind="foreach:externalUsers"><li class="od-SharingTips-resolvedUser" data-bind="text:email||name"></li></ul>\x3c!--/ko--\x3e</div></div><ms-dlplite></ms-dlplite>\x3c!--ko if:showAdvancedMessage--\x3e<div data-bind="text:advancedWarningText"></div>\x3c!--/ko--\x3e\x3c!--ko if:hasPolicyTip()&&showPolicyTip--\x3e<div class="od-SharingTips-policyTip" data-bind="bindableHtml:policyTipText"></div>\x3c!--/ko--\x3e</div><div class="od-SharingTips-section" data-bind="if:groups().length>0"><span class="od-SharingTips-multiUser" data-bind="text:groupsText"></span><span class="od-SharingTips-groupsMemberCount" data-bind="text:groupsMemberCountText"></span><button class="od-SharingTips-expandLink" data-bind="text:expandGroupsText,click:clickExpandGroups"></button><div>\x3c!--ko if:showGroups--\x3e<ul class="od-SharingTips-multiUserList" data-bind="foreach:groups"><li class="od-SharingTips-resolvedUser"><span data-bind="text:group.name"></span><span data-bind="text:memberCountText"></span></li></ul>\x3c!--/ko--\x3e</div></div>\x3c!--ko component:{name:\'ms-panel-host\'}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/sharingTips/SharingTipsViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../utilities/policyTip/PolicyTipHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../../../providers/panel/PanelProvider","../../../providers/peoplePicker/PeoplePickerProvider","knockout","../../policyTipPanel/PolicyTipPanel","./SharingTips.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(n){var l=e.call(this,n)||this,p=n.showPolicyTip,d=void 0===p?o.isFeatureEnabled(o.PolicyTipPanel):p;l.addBindingHandlers({bindableHtml:s.default});var v=l._engagement=l.resources.consume(r.resourceKey);l._item=n.item;l._policyTipType=n.policyTipType;l._policyTipInfo=n.policyTipInfo;l.hasPolicyTip=l.createObservable(l._item&&i.isPolicyTipFlagSet(l._item.policyTip,4));l.policyTipText=i.getPolicyTipText(l._policyTipType,"onViewPolicyTipClick");l._resolvedUsers=n.selectedPeople;l.showAdvancedMessage=n.showAdditionalSharingWarning;l.showPolicyTip=d;l.advancedWarningText=c.default.GallatinMessage;l.multiExternalUserText=f.observable("");l.expandUsersText=f.observable(c.default.Show);l.expandGroupsText=f.observable(c.default.Show);l.showMultiUsers=f.observable(!1);l.isUserBlocked=f.observable(!1);l.showGroups=f.observable(!1);l.singleExternalUserText=f.observable("");l.groupsText=f.observable("");l.groupsMemberCountText=f.observable("");l._renderedExternalUsers=!1;l._renderedGroups=!1;l._peoplePickerProvider=l.resources.consume(a.resourceKey);l._pickerEntityInformations=[];if(n.pickerEntityInformations)for(var m=0,g=n.pickerEntityInformations;m<g.length;m++){var y=g[m];l._pickerEntityInformations[y.person.userId]=y}l.externalUsers=l.createComputed(function(){for(var e=!1,t=[],n=0,r=l._resolvedUsers();n<r.length;n++){var i=r[n];if(1===i.entityType){var s=i.rawPersonData.EntityData.IsBlocked;e=e||s&&"true"===s.toLowerCase();t.push(i)}}l.isUserBlocked(e);if(1===t.length){var o='<span class="od-SharingTips-resolvedUser">'+(t[0].email||t[0].name)+"</span>";l.singleExternalUserText(h.format(e?c.default.SingleEmailBlockedByAllowDenyList:c.default.SingleExternalUserText,o));l.showMultiUsers(!1)}else t.length>1&&l.multiExternalUserText(e?c.default.MultipleEmailBlockedByAllowDenyList:c.default.MultiExternalUserText);if(t.length>0&&!l._renderedExternalUsers){l._renderedExternalUsers=!0;l._engagement.logData({name:"ExternalUsers.SharingTips.Render"})}return t});l.groups=l.createComputed(function(){for(var e=[],n=0,r=0,i=l._resolvedUsers();r<i.length;r++){var s=i[r];if(2===s.entityType){var u={group:s,memberCountText:f.observable("")};if(o.isFeatureEnabled(o.OversharingMitigations)){var a=l.getGroupMemberCount(u);n+=a;u.memberCountText(t.getMemberCountText(a,!1))}e.push(u)}}e.length>1?l.groupsText(h.format(c.default.MultiGroupText,e.length)):l.groupsText(h.format(c.default.SingleGroupText,e.length));l.groupsMemberCountText(t.getMemberCountText(n,!0));if(e.length>0&&!l._renderedGroups){l._renderedGroups=!0;v.logData({name:"Groups.SharingTips.Render"})}return e});l.resources.bind(u.resourceKey);l._panelProvider=l.resources.consume(u.resourceKey);return l}t.getMemberCountText=function(e,t){return 1===e?t?c.default.GroupOneMemberCountText:c.default.SingleGroupOneMemberCountText:e>1&&e<1e3?h.format(t?c.default.GroupMemberCountText:c.default.SingleGroupMemberCountText,e):e>=1e3?t?c.default.GroupMemberCountTextGreaterThan1000:c.default.SingleGroupMemberCountTextGreaterThan1000:""};t.prototype.onViewPolicyTipClick=function(){var e={item:this._item,policyTipInfo:this._policyTipInfo()};this._panelProvider.requestPanel({component:{name:l.default.tagName,params:e}})};t.prototype.clickExpandUsers=function(){if(this.showMultiUsers()){this.expandUsersText(c.default.Show);this.showMultiUsers(!1)}else{this._engagement.logData({name:"ExpandUsers.SharingTips.Click",isIntentional:!0});this.expandUsersText(c.default.Hide);this.showMultiUsers(!0)}};t.prototype.clickExpandGroups=function(){if(this.showGroups()){this.expandGroupsText(c.default.Show);this.showGroups(!1)}else{this._engagement.logData({name:"ExpandGroups.SharingTips.Click",isIntentional:!0});this.expandGroupsText(c.default.Hide);this.showGroups(!0)}};t.prototype.getGroupMemberCount=function(e){var t=0;this._pickerEntityInformations[e.group.userId]?t=this._pickerEntityInformations[e.group.userId].totalMemberCount:this._retrievePickerEntityInformation(e);return t};t.prototype.updateGroupsMemberCountText=function(){for(var e=0,n=0,r=this._resolvedUsers();n<r.length;n++){var i=r[n];2===i.entityType&&this._pickerEntityInformations[i.userId]&&(e+=this._pickerEntityInformations[i.userId].totalMemberCount)}this.groupsMemberCountText(t.getMemberCountText(e,!0))};t.prototype._retrievePickerEntityInformation=function(e){var n=this;this._peoplePickerProvider.getPickerEntityInformation(e.group).then(function(r){n._pickerEntityInformations[e.group.userId]=r;e.memberCountText(t.getMemberCountText(r.totalMemberCount,!1));n.updateGroupsMemberCountText()},function(e){})};return t})(p.default);t.default=d});
define("odsp-next/utilities/policyTip/PolicyTipHelper",["require","exports","../../controls/policyTipPanel/PolicyTipPanel.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPolicyTipActionText=function(){return n.default.ViewPolicyTip};t.getPolicyTipHeader=function(e){return r.format(n.default.PolicyTipHeader,"'"+e+"'")};t.getPolicyTipText=function(e,t){var r=n.default.PolicyTipBlock,i=this.isPolicyTipFlagSet(e,4),s=this.isPolicyTipFlagSet(e,2),o=this.isPolicyTipFlagSet(e,1);i?r=n.default.PolicyTipNotifyAndBlock:s?r=n.default.PolicyTipBlock:o&&(r=n.default.PolicyTipNotify);t&&(r=r+' <a href=";" data-bind="click: '+t+'">'+n.default.ViewPolicyTip+"</a>");return r};t.isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t}});
define("odsp-next/controls/policyTipPanel/PolicyTipPanel",["require","exports","./PolicyTipPanel.html","./PolicyTipPanelViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-policy-tip-panel",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/policyTipPanel/PolicyTipPanel.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div data-bind="react:{componentType:policyTipComponent,props:policyTipComponentProps}"></div>'});
define("odsp-next/controls/policyTipPanel/PolicyTipPanelViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/dateTime/DateTime","../../providers/item/ItemProvider","@ms/odsp-shared-react/lib/PolicyTip","../policyTipPanel/PolicyTipPanel.resx","../../utilities/policyTip/PolicyTipHelper","../../resources/DataSourceResourceKeys","../../bindings/react/ReactBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.item,i=t.policyTipInfo;n._item=r;n._policyTipInfo=i;n.addBindingHandlers({react:l.default});n._itemProvider=n.resources.consume(s.resourceKey);n._policyTipDataSource=n.resources.consume(f.policyTip);n._showJustificationInput=n.createObservable(!1);n._confirmationText=n.createObservable("").extend({notify:"always"});n.policyTipComponent=o.PolicyTip;n.policyTipComponentProps=n.createPureComputed(n._computePolicyTipComponentParams);return n}t.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),n=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:n}};t.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:u.default.NoPolicyTipInfoError,titleText:a.getPolicyTipHeader(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:u.default.TipIssues,issues:e.issueDescriptions,lastScannedText:e.lastScanned?u.default.TipLastScanned+": "+i.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:u.default.LearnMoreActionLabel,learnMoreLabel:u.default.LearnMoreLabel,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?u.default.OverrideActionLabel:void 0,overrideLabel:u.default.OverrideLabel,policyTipDescription:e.explanationText,reportActionLabel:u.default.ReportActionLabel,reportInProgressLabel:u.default.ReportInProgress,reportLabel:u.default.ReportLabel,submitButtonLabel:u.default.SubmitButtonText,titleText:a.getPolicyTipHeader(this._item.name)}};t.prototype._onReportClicked=function(){var e=this;this._logEngagementEvent("ReportClicked");var t={item:this._item,action:1};this._policyTipDataSource.updatePolicy(t).done(function(t){if(1===t){e._logEngagementEvent("FalsePositiveReported");e._confirmationText(u.default.ReportConfirmation)}else if(3===t||2===t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(u.default.OverrideConfirmation)}})};t.prototype._onOverrideClicked=function(){var e=this;this._logEngagementEvent("OverrideClicked");var t=this._policyTipInfo.overrideOption;if(1===t){var n={item:this._item,action:0};this._policyTipDataSource.updatePolicy(n).done(function(t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(u.default.OverrideConfirmation)})}else if(2===t){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};t.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var n={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(n).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(u.default.OverrideConfirmation)})};t.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};t.prototype._logEngagementEvent=function(e){r.Engagement.logData({name:"PolicyTipPanel."+e})};return t})(c.default);t.default=h});
define("odsp-next/controls/dlplite/DlpLite",["require","exports","./DlpLite.html","./DlpLiteViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-dlplite",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/dlplite/DlpLite.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ms-DlpLite" data-bind="visible:isVisible"><span class="ms-DlpLite-middle" data-bind="text:strings.bannerWarning"></span><a class="ms-DlpLite-middle" target="_blank" data-bind="text:strings.learnMore,attr:{href:externalSharingLearnUrl}"></a></div>'});
define("odsp-next/controls/dlplite/DlpLiteViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./DlpLite.resx","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.strings=s.default;n.isVisible=i.observable(!1);n.externalSharingLearnUrl=i.observable("javascript:");n.resources.consume(o.policyTip).getExternalSharingStatus().then(function(e){if(e){n.isVisible(e.isExternalSharingTipEnabled);n.externalSharingLearnUrl(e.externalSharingTipsLearnMoreUrl)}},function(e){});return n}return t})(r.default);t.default=u});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher",["require","exports","./SharingLinksSwitcher.html","./SharingLinksSwitcherViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-sharingLinksSwitcher",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:loading--\x3e<div class="od-SharingLinksSwitcher-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div aria-live="assertive" class="od-SharingLinksSwitcher-error" data-bind="if:error"><span data-bind="text:error"></span></div><div class="od-SharingLinksSwitcher-sharingLinkSelector"><div class="od-SharingLinksSwitcher-linkPickerArea"><span class="od-SharingLinksSwitcher-linkLabel" data-bind="text:sharingLinksSelectorStrings.LinkLabelText"></span>\x3c!--ko if:isSingleLinkLabelVisible--\x3e<span class="od-SharingLinksSwitcher-linkInput-label" data-bind="text:linkSelectorCurrentLabelText()"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isSingleLinkLabelVisible--\x3e<a href="javascript:;" class="od-SharingLinksSwitcher-dropdownLinkContainer ms-font-color-neutralPrimary ms-lines ms-fullWidth" aria-haspopup="true" data-bind="click:onClickSharingLinkMenu,hasFocus:true,dismiss:onDismissSharingLinksMenu,attr:{\'aria-expanded\':isSharingLinkMenuOpen}"><span class="od-SharingLinksSwitcher-dropdownText" data-bind="text:linkSelectorCurrentLabelText()"></span><i class="ms-Icon ms-Icon--ChevronDown od-SharingLinksSwitcher-dropdownArrow" data-bind="icon:true,visible:shouldShowSetExpirationDropDown,title:sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: sharingLinkMenuItems, isOpen: isSharingLinkMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu>\x3c!--/ko--\x3e</div>\x3c!--ko if:editVisible--\x3e<div><input type="checkbox" id="od-SharingLinkSwitcher-canEdit" data-bind="checked:editChecked"><label for="od-SharingLinkSwitcher-canEdit" data-bind="text:sharingLinksSelectorStrings.CanEditLabel"></label></div>\x3c!--/ko--\x3e\x3c!--ko if:shouldShowLinkExpiration--\x3e<div class="od-SharingLinksSwitcher-linkExpirationArea"><div data-bind="visible:!shouldShowCustomExpiration(),automation:\'SharingLinksSwitcher-expiration-selector\'"><span class="od-SharingLinksSwitcher-expiration-expirationText" data-bind="visible:!!sharingLinkExpirationDate(),text:sharingLinkExpirationDate,automation:\'SharingLinksSwitcher-expiration-expirationSpan\'"></span><span class="od-SharingLinksSwitcher-LinkExpirationMenuArea"><a tabindex="0" class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-dropdownLinkContainer" aria-haspopup="true" data-bind="click:onClickLinkExpirationMenu,dismiss:onDismissLinkExpirationMenu,attr:{\'aria-expanded\':isLinkExpirationMenuOpen}"><span class="od-SharingLinksSwitcher-expiration-dropdownText ms-uppercase" data-bind="text:sharingLinkExpirationLabel"></span><i class="ms-Icon ms-Icon--ChevronDown ms-callout-icon od-SharingLinksSwitcher-expiration-dropdownArrow" data-bind="icon:true,visible:shouldShowSetExpirationDropDown,title:sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: linkExpirationMenuItems, isOpen: isLinkExpirationMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></span></div><div class="ms-fullWidth" data-bind="visible:shouldShowCustomExpiration"><div class="od-SharingLinksSwitcher-expiration-expirationText"><span data-bind="text:sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_BeforeTextBox"></span><input type="text" class="od-SharingLinksSwitcher-expirationInput" data-bind="selectOnFocus,value:sharingLinkExpirationNumDays,title:sharingLinksSelectorStrings.LinkExpiration_CustomValueTooltip"><span data-bind="text:sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_AfterTextBox"></span></div><div class="od-SharingLinksSwitcher-expiration-buttons"><a href="javascript:;" class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-expirationSave" data-bind="click:onClickCancelCustomExpiration,text:sharingLinksSelectorStrings.CancelCustomExpiration,automation:\'SharingLinksSwitcher-expiration-cancelLink\'"></a></div></div></div>\x3c!--/ko--\x3e<div class="od-SharingLinksSwitcher-rightArea">\x3c!--ko if:isUpdatingLink--\x3e<div class="od-SharingLinksSwitcher-processing" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e<button class="od-Dialog-action od-Button" data-bind="css:{\'od-Button--primary\':true},click:switchLinksClick,enable:!isUpdatingLink()"><span class="od-Button-label" data-bind="text:sharingLinksSelectorStrings.OkayButtonLabel"></span></button></div><div aria-live="assertive" class="od-SharingLinksSwitcher-error" data-bind="if:sharingLinkError"><span data-bind="text:sharingLinkError"></span></div><div class="ms-clearfix"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcherViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../progressSpinnerFlat/ProgressSpinnerFlat","./SharingLinksSwitcher.resx","../../../providers/sharing/SharingProvider","../../../bindings/css/VisibilityBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","../../../bindings/dismiss/DismissBinding","../../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/string/StringHelper","../../../actions/SwitchSharingLinkAction","../../../bindings/html/BindableHtmlBinding","@ms/odsp-utilities/lib/locale/Locale","../../../bindings/focus/SelectOnFocusBinding","../../../providers/suiteNav/SuiteNavProvider","../../../utilities/sharing/SharingHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=a.default.tagName;n.progressSpinnerFlatTagName=f.default.tagName;n._anonymousLinksEnabled=!1;n._organizationLinksEnabled=!1;t.item&&(n._item=t.item);n._stateArray=t.dialogStateArray||r.observable([]);n.addBindingHandlers({bindableHtml:b.default,dismiss:v.default,selectOnFocus:E.default,visibility:h.default});n._selectionModel=n.resources.consume(o.itemsSelection);n._selectionHelper=n.resources.consume(m.resourceKey);n._sharingProvider=n.resources.consume(c.resourceKey);n._engagement=n.resources.consume(u.resourceKey);n.loading=r.observable(!0);n.sharingLinksSelectorStrings=l.default;n.error=r.observable("");n.links=r.observable([]);n._unsavedLinkType=r.observable(8);n.sharingLinkMenuItems=r.observableArray();n.isSharingLinkMenuOpen=r.observable(!1);n.menuAlignment=r.observable(w.default.isRightToLeft?d.default.Left:d.default.Right);n.menuLeft=r.observable(w.default.isRightToLeft?"0":"auto");n.linkSelectorCurrentLabelText=r.observable("");n.currentSharingLink=t.currentLink||r.observable(null);n.selectedSharingLinkType=t.currentLink&&t.currentLink()?r.observable(t.currentLink().type):r.observable(8);n.editChecked=r.observable(!1);n.editVisible=r.observable(!0);n.isUpdatingLink=r.observable(!1);n.processingSharingLink=r.observable(!0);n.sharingLinkError=r.observable("");n.linkExpirationMenuItems=r.observableArray();n.isLinkExpirationMenuOpen=r.observable(!1);n.shouldShowLinkExpiration=r.observable(!1);n.shouldShowCustomExpiration=r.observable(!1);n.sharingLinkExpirationDate=r.observable("");n.sharingLinkExpirationNumDays=r.observable(0);n.sharingLinkExpirationLabel=n.createComputed(function(){return 0===n.sharingLinkExpirationNumDays()?n.sharingLinksSelectorStrings.SetSharingLinkExpiration:n.sharingLinksSelectorStrings.UpdateSharingLinkExpiration});n.shouldShowSetExpirationDropDown=r.observable(!0);n._companyDisplayName=r.observable("");var i=n.resources.consume(S.resourceKey.optional);i&&i.loadData().then(function(e){n._companyDisplayName(e.CompanyDisplayName);null!=n.currentSharingLink()&&n._setCurrentLinkLabelText(n.currentSharingLink().type)});var s=!1;n._selectionModel&&n._selectionModel.selection&&n._selectionModel.selection().length>1&&(s=!0);var p=n._sharingProvider.getSharingData(n._getCurrentItem());if(!s)if(null==n.currentSharingLink())n.isReady=p.getBestSharingLink().then(function(e){if(e){n._setSelectedType(e.type);n._setCurrentSharingLink(e);n.editChecked(6===e.type||9===e.type&&2===e.role);n.processingSharingLink(!1)}},function(e){n._handleSharingLinkError()});else{n.editChecked(6===n.currentSharingLink().type||9===n.currentSharingLink().type&&2===n.currentSharingLink().role);n.processingSharingLink(!1)}n.isSingleLinkLabelVisible=!1;p.getSettings().done(function(e){n.canManageLinks=e.canManageLinks;n._anonymousLinksEnabled=e.anonymousLinksEnabled;n._organizationLinksEnabled=e.organizationLinksEnabled;if(null!=n.currentSharingLink()){n._setSelectedType(n.currentSharingLink().type);n._setCurrentSharingLink(n.currentSharingLink())}n._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;n._enforceRequiredAnonymousLinkExpiration=Number(e.requiredAnonymousLinkExpirationInDays)>0;n.shouldShowSetExpirationDropDown(!n._enforceRequiredAnonymousLinkExpiration);n.loading(!1)},function(e){});n._getSharingLinks().then(function(e){if(null!=e&&e.length>0){n.links(e);n.isSingleLinkLabelVisible=e.length<2;null==n.currentSharingLink()&&n._setSelectedType(e[0].type)}},function(e){n._handleSharingLinkError();n.loading(!1)});return n}t.prototype.onClickSharingLinkMenu=function(e,t){var n=this._engagement,r=this,i=new p.default({text:this._getLinkLabelText(8),subtext:this._getLinkLabelSubtext(8),isToggleable:!1,callback:function(){r.menuItemClick(8);n.logData({name:"SwitchToDirectLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),s=new p.default({text:this._getLinkLabelText(9),subtext:this._getLinkLabelSubtext(9),isToggleable:!1,callback:function(){r.menuItemClick(9);n.logData({name:"SwitchToOrganizationLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),o=new p.default({text:this._getLinkLabelText(5),subtext:this._getLinkLabelSubtext(5),isToggleable:!1,callback:function(){r.menuItemClick(5);n.logData({name:"SwitchToAnonymousLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),u=[i];this._organizationLinksEnabled&&u.push(s);this._anonymousLinksEnabled&&u.push(o);this.sharingLinkMenuItems(u);this.isSharingLinkMenuOpen(!this.isSharingLinkMenuOpen());return u};t.prototype.menuItemClick=function(e){this._setSelectedType(e);this._unsavedLinkType(e);this._setCurrentLinkLabelText(e)};t.prototype.onDismissSharingLinksMenu=function(e,t){this.isSharingLinkMenuOpen(!1)};t.prototype.onClickLinkExpirationMenu=function(e,t){var n=this;if(this.processingSharingLink())return null;if(this._enforceRequiredAnonymousLinkExpiration){this.shouldShowCustomExpiration(!0);this.sharingLinkExpirationNumDays.peek()&&"0"!==String(this.sharingLinkExpirationNumDays.peek())||this.sharingLinkExpirationNumDays(this._adminRequiredAnonymousLinkExpirationInDays);this.sharingLinkError("");return null}var r=this,i=[],s=this._getAvailableExpirationOptions();Object.keys(s).forEach(function(e,t,o){var u=s[e],a=!isNaN(u)&&u>=0?n._calculateLinkExpiration(u):"CUSTOM",f=new p.default({text:e,isToggleable:!1,callback:function(){r.expiryDateChanged(a,u/1440)}});i.push(f)});this.linkExpirationMenuItems(i);this.isLinkExpirationMenuOpen(!this.isLinkExpirationMenuOpen());return i};t.prototype.expiryDateChanged=function(e,t){if("CUSTOM"===e)this.shouldShowCustomExpiration(!0);else if(e){this.sharingLinkExpirationNumDays(t);this.shouldShowCustomExpiration(!0)}else{this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1)}};t.prototype.onDismissLinkExpirationMenu=function(e,t){this.isLinkExpirationMenuOpen(!1)};t.prototype.switchLinksClick=function(){var e,t=this,n=this.selectedSharingLinkType();5===n&&this.editChecked()&&(n=6);this.links().forEach(function(r,i,s){r.type===n&&(9!==n||9===n&&2===r.role&&t.editChecked()||9===n&&1===r.role&&!t.editChecked())&&(e=r)});e||(e={type:n,role:this.editChecked()?2:1,url:""});var r=e&&e.expiration;if(this.shouldShowLinkExpiration()){var i=parseInt(String(this.sharingLinkExpirationNumDays()),10);if(String(this.sharingLinkExpirationNumDays())===String(i)){var o;if(i<0||i>730)o=this.sharingLinksSelectorStrings.LinkExpiration_InvalidValueErrorMessage;else if(this._enforceRequiredAnonymousLinkExpiration)if(i>this._adminRequiredAnonymousLinkExpirationInDays){var u=g.getLocalizedCountValue(this.sharingLinksSelectorStrings.LinkExpiration_AdminRequiredValueErrorMessage,this.sharingLinksSelectorStrings.LinkExpiration_ExpirationDaysIntervals,this._adminRequiredAnonymousLinkExpirationInDays);o=g.format(u,this._adminRequiredAnonymousLinkExpirationInDays)}else 0===i&&(i=this._adminRequiredAnonymousLinkExpirationInDays);if(o){this._handleSharingLinkError(o);return}r=i>0?this._calculateLinkExpiration(1440*i):null}}var a,f=this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection();a=!this._item||f&&f.length>1?this._selectionHelper.resolveSelection():s.default.wrap([this._item]);this.sharingLinkError("");a.then(function(n){new(t.managed(y.default))({items:n,link:e,expiration:r,isExecuting:t.isUpdatingLink,successCallback:function(n){t.shouldShowCustomExpiration(!1);if(null!=n){var i=t._engagement;"CUSTOM"===r?i.logData({name:"SwitchTo"+n.tag+"Link.Custom.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):r?i.logData({name:"SwitchTo"+n.tag+"Link.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):i.logData({name:"SwitchTo"+n.tag+"Link.SharingLinksSwitcher.Click",isIntentional:!0});if(!t.currentSharingLink()||n.type!==t.currentSharingLink().type||n.role!==t.currentSharingLink().role||n.expiration!==t.currentSharingLink().expiration){e.url=n.url;e.expiration=n.expiration;e.isActive=!!e.url;t._setCurrentSharingLink(e);t.processingSharingLink(!1)}var s=t._stateArray();s.pop();t._stateArray(s)}else t._handleSharingLinkError()},failureCallback:function(e){t._handleSharingLinkError(e)}}).execute(null)})};t.prototype.onClickCancelCustomExpiration=function(e,t){if(this.processingSharingLink())return!1;this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1);this.sharingLinkError("")};t.prototype._getAvailableExpirationOptions=function(){var e=this,t=[];t[this.sharingLinksSelectorStrings.LinkExpiration_Never]=0;[1,30,60].forEach(function(n,r,i){var s=1===n?e.sharingLinksSelectorStrings.LinkExpiration_SingleDay:g.format(e.sharingLinksSelectorStrings.LinkExpiration_MultiDay,n),o=1440*n;t[s]=o});t[this.sharingLinksSelectorStrings.LinkExpiration_Custom]=-1;return t};t.prototype._getSharingLinks=function(){var e=this;return this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){return e},function(t){e.error(e.sharingLinksSelectorStrings.ServerError);return null})};t.prototype._setSelectedType=function(e){6===e&&(e=5);this.selectedSharingLinkType(e);this._setCurrentLinkLabelText(e);8===e?this.editVisible(!1):this.editVisible(!0);5!==e?this.shouldShowLinkExpiration(!1):this.shouldShowLinkExpiration(!0)};t.prototype._setCurrentSharingLink=function(e){if(e){this.currentSharingLink(e);this._setCurrentLinkLabelText(e.type);this.shouldShowLinkExpiration(e.supportsExpiration);if(e.supportsExpiration){var t=e.expiration?new Date(e.expiration):null,n=e.expiration?t.toLocaleDateString():null;this.sharingLinkExpirationNumDays(x.getNumberOfDaysUntilExpiry(t));this.sharingLinkExpirationDate(n?g.format(this.sharingLinksSelectorStrings.LinkExpiration_DateDescription,n):"")}}};t.prototype._setCurrentLinkLabelText=function(e){this.linkSelectorCurrentLabelText(this._getLinkLabelText(e))};t.prototype._getLinkLabelSubtext=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkSubtext;case 9:return this._companyDisplayName()?g.format(this.sharingLinksSelectorStrings.OrganizationSubtext,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.AnonymousLinkSubtext}return""};t.prototype._getLinkLabelText=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkLabel;case 9:return this._companyDisplayName()?g.format(this.sharingLinksSelectorStrings.OrganizationTenantAccountRequired,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.NoSignInRequiredLabel}return""};t.prototype._calculateLinkExpiration=function(e){if(e>0){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};t.prototype._getCurrentItem=function(){return this._item?this._item:r.utils.unwrapObservable(this._selectionModel.selection()[0])};t.prototype._handleSharingLinkError=function(e){this.processingSharingLink(!1);this.sharingLinkError(e||this.sharingLinksSelectorStrings.ServerError)};return t})(i.default);t.default=T});
define("odsp-next/actions/SwitchSharingLinkAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/sharing/SharingProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SwitchSharingLink";n._items=t.items;n._newLink=t.link;n._successCallback=t.successCallback;n._failureCallback=t.failureCallback;n._isExecuting=t.isExecuting;n._sharingProvider=n.resources.consume(o.resourceKey);n._expiration=t.expiration;return n}t.prototype.onExecute=function(e,t){var n=this,r=this._expiration&&"CUSTOM"!==this._expiration?new Date(this._expiration).toLocaleDateString():null,o=this._newLink.expiration?new Date(this._newLink.expiration).toLocaleDateString():null;if(this._expiration&&"CUSTOM"!==this._expiration&&r!==o||!this._expiration&&this._newLink.expiration){this._isExecuting&&this._isExecuting(!0);return new i.default(function(e,t){var r={},i={type:n._newLink.type,role:n._newLink.role,create:!0,expiration:n._expiration};n._sharingProvider.manageSharingLinks(n._items,i).then(function(t){n._successCallback&&n._successCallback(t[0]);r.resultType=s.ResultTypeEnum.Success;e(r)},function(t){n._failureCallback&&n._failureCallback(t&&t.message?t.message.value:"");r.resultType=s.ResultTypeEnum.Failure;e(r)})})}if(this._newLink.isActive){this._successCallback&&this._successCallback(this._newLink,this._expiration);return i.default.wrap({resultType:s.ResultTypeEnum.Success})}this._successCallback(this._newLink);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};return t})(r.default);t.default=u});
define("odsp-next/controls/sharing/sharingHints/SharingHints",["require","exports","./SharingHints.html","./SharingHintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css","../../persona/Persona"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-sharingHints",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/sharing/sharingHints/SharingHints.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-SharingHints"><div class="od-SharingHints-shared" data-bind="visible:showSharedWithHint&&sharedWithMany()"><span class="od-SharingHints-text" data-bind="visible:showNumberOfFilesHint,text:totalFileCountText"></span><span class="od-SharingHints-text" data-bind="bindableHtml:sharedWithManyHtml"></span></div><div class="od-SharingHints-shared" data-bind="visible:showNumberOfFilesOnlyHint"><span class="od-SharingHints-text" data-bind="text:totalFileCountText"></span></div>\x3c!--ko if:showSharedWithHint&&users().length>0&&!sharedWithMany()--\x3e<div class="od-SharingHints-shared"><span class="od-SharingHints-text" data-bind="visible:showNumberOfFilesHint,text:totalFileCountText"></span><span class="od-SharingHints-text" data-bind="bindableHtml:sharedWithHtml"></span></div>\x3c!--/ko--\x3e<div class="od-SharingHints-private" data-bind="visible:showOnlyYouHint&&users().length===0&&!guestLinkExists()&&!sharedWithMany()"><i class="ms-Icon ms-Icon--Lock" data-bind="icon:true"></i><span class="od-SharingHints-text" data-bind="visible:showNumberOfFilesHint,text:totalFileCountText"></span><span class="od-SharingHints-text" data-bind="text:onlyYouText"></span></div><div class="od-SharingHints-externalWarning" data-bind="visible:showGuestLinkHint&&guestLinkExists"><i class="ms-Icon ms-Icon--Globe" data-bind="icon:true"></i><span class="od-SharingHints-text" data-bind="text:anonymousLinksText"></span></div></div>'});
define("odsp-next/controls/sharing/sharingHints/SharingHintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SharingHints.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../shareByEmail/Sharing.resx","../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._openAnchorHtml='<a href="javascript:;" data-bind="attr:{title: sharedWithLinkTitle}, click: switchTabs">';n._closeAnchorHtml="</a>";n._lastPersonTemplate='<od-persona class="od-SharingHints-persona" params="{ person: lastPerson, personaSize: 1, showPresence: true, profileLinkOn: true }" ></od-persona>';n._peopleTemplate='<span data-bind = "foreach: usersTrimmed" >    <od-persona class="od-SharingHints-persona" params="{ person: $data, personaSize: 1, showPresence: true, profileLinkOn: true, includeComma: true }" ></od-persona></span>';var r=i.default.SharedWithText,l=i.default.SharedWithOneText;n.sharedWithLinkTitle=n.createObservable("");n.addBindingHandlers({bindableHtml:o.default});n.guestLinkExists=t.guestLinkExists;n.sharedWithMany=t.sharedWithMany||n.observables.create(!1);n.anonymousLinksText=i.default.GuestLinkText;n.showGuestLinkHint=8==(8&t.sharingHintsOption);n.showOnlyYouHint=4==(4&t.sharingHintsOption);n.showSharedWithHint=2==(2&t.sharingHintsOption);n.showNumberOfFilesHint=1==(1&t.sharingHintsOption);n.showNumberOfFilesOnlyHint=0===t.sharingHintsOption;if(1===t.items.length){var c=t.items[0],h=i.default.SharedWithManyText;n.sharedWithLinkTitle(s.format(i.default.SharedWithLinkTitle,c.name));n._isFolder=c.type===f.default.Folder;n._totalFileCount=n._isFolder&&c.folder?c.folder.totalCount:0;n.totalFileCountText=s.format(a.default.SharingHintNumberOfFilesText,n._totalFileCount);n.showNumberOfFilesHint=n.showNumberOfFilesHint&&u.isFeatureEnabled(u.OversharingMitigations)&&n._isFolder&&n._totalFileCount>1;n.showNumberOfFilesOnlyHint=n.showNumberOfFilesOnlyHint&&u.isFeatureEnabled(u.OversharingMitigations)&&n._isFolder&&n._totalFileCount>1;n.showNumberOfFilesHint&&(h=h.toLowerCase());n.sharedWithManyHtml=s.format(h,n._openAnchorHtml,n._closeAnchorHtml)}else{n.sharedWithManyHtml="";n._isFolder=!1;n._totalFileCount=0;n.totalFileCountText="";n.showNumberOfFilesHint=!1}n.onlyYouText=i.default.OnlyYouText;n._sharedWithCallBack=t.sharedWithCallback;n.users=t.sharedWith?n.observables.createArray(t.sharedWith().reverse()):n.observables.createArray([]);n.usersTrimmed=n.createComputed(function(){var e=n.users().length;return e<4?n.users().slice(0,e-1):n.users().slice(0,3)});n.lastPerson=n.createComputed(function(){var e=n.users().length;return e>0?n.users()[e-1]:null});n._moreLink=n.createComputed(function(){return n._openAnchorHtml+s.format(i.default.NumberMoreText,n.users().length-3)+n._closeAnchorHtml});if(n.showNumberOfFilesHint){r=r.toLowerCase();l=l.toLowerCase()}n.users().length>4?n.sharedWithHtml=s.format(r,n._peopleTemplate,n._moreLink()):1===n.users().length?n.sharedWithHtml=s.format(l,n._lastPersonTemplate):n.sharedWithHtml=s.format(r,n._peopleTemplate,n._lastPersonTemplate);return n}t.prototype.switchTabs=function(){this._sharedWithCallBack&&this._sharedWithCallBack()};return t})(r.default);t.default=l});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor",["require","exports","./AddPhotosToAlbumExecutor.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AddPhotosToAlbumExecutorViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"add-photos-to-album-executor",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko if:showBundleBuilder--\x3e\x3c!--ko component:{name:panelOverlayTagName,params:panelOverlayParams}--\x3e\x3c!--ko component:{name:bundleBuilderTagName,params:bundleBuilderParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/bundleBuilder/BundleBuilder","../../models/item/IItemTypeFilter","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../providers/album/AlbumProvider.key","../../controls/albumBuilder/AlbumBuilder.resx","../../models/itemsScope/ItemsScopeFeature.key","../../utilities/albums/itemsScope/AlbumsInvalidator.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.panelOverlayTagName=i.default.tagName;n.bundleBuilderTagName=s.default.tagName;var r=t.item;n._urlDataSource=n.resources.consume(a.url);n._item=r;n._signal=new l.default;n.showBundleBuilder=n.createObservable(!0);n.endWith(n.trackPromise(n._signal.getPromise().then(function(e){n.showBundleBuilder(!1);return n._addPhotosToAlbum(e)})));n.bundleBuilderParams={bundleName:n._item.name,typeFilter:{filters:[o.ItemTypeFilter.folder,o.ItemTypeFilter.media]},itemKey:n._urlDataSource.getRootItemKey(u.default.AllMyPhotos),complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()}};n.panelOverlayParams={size:"XLarge",onClose:function(){return n.action.cancel()},showCloseButton:!1};return n}t.prototype._complete=function(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];(i.photo||i.video)&&t++}if(t<e.length)return f.default.wrapError(new Error(h.default.errorInvalidItems));this._signal.complete(e);return f.default.wrap()};t.prototype._cancel=function(){this._signal.cancel();return f.default.wrap()};t.prototype._addPhotosToAlbum=function(e){var t=this;return this.resources.consumeAsync(c.resourceKey).then(function(n){return n.addToAlbum({album:t._item,items:e})}).then(function(){t.resources.consume(p.isItemsScopeEnabledInAllAlbumsPivotResourceKey)&&t.resources.consumeAsync(d.resourceKey).then(function(e){e.invalidate()})})};return t})(r.default);t.default=v});
define("odsp-next/actions/createAlbum/CreateAlbumExecutor",["require","exports","./CreateAlbumExecutor.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateAlbumExecutorViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"create-album-executor",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/actions/createAlbum/CreateAlbumExecutor.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default="\x3c!--ko if:showAlbumBuilder--\x3e\x3c!--ko component:{name:panelOverlayTagName,params:panelOverlayParams}--\x3e\x3c!--ko component:{name:albumBuilderTagName,params:albumBuilderParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/createAlbum/CreateAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/albumBuilder/AlbumBuilder","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","./CreateAlbumOperator","./CreateAlbumHelper","../../models/itemsScope/ItemsScopeFeature.key","../../utilities/albums/itemsScope/AlbumsInvalidator.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.panelOverlayTagName=i.default.tagName;n.albumBuilderTagName=s.default.tagName;n._urlDataSource=n.resources.consume(u.url);n._name=n.createObservable("");n.showAlbumBuilder=n.createObservable(!0);n._signal=new f.default;n.endWith(n.trackPromise(n._signal.getPromise().then(function(e){n.showAlbumBuilder(!1);return n._createAlbum(e)})));n.albumBuilderParams={name:n._name,itemKey:n._urlDataSource.getRootItemKey(o.default.AllMyPhotos),complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()}};n.panelOverlayParams={size:"XLarge",onClose:function(){return n.action.cancel()},showCloseButton:!1};return n}t.prototype._complete=function(e){var t=this._name.peek(),n=c.validateAlbumCreation(e,t);if(n)return a.default.wrapError(new Error(n));this._signal.complete(e);return a.default.wrap()};t.prototype._cancel=function(){this._signal.cancel();return a.default.wrap()};t.prototype._createAlbum=function(e){var t=this,n=this._name.peek(),r=e.map(function(e){return e.key});return this.resources.consumeAsync(l.typeResourceKey).then(function(e){var i=new e({name:n,keys:r});t.trackPromise(i.start().then(function(){t.resources.consume(h.isItemsScopeEnabledInAllAlbumsPivotResourceKey)&&t.resources.consumeAsync(p.resourceKey).then(function(e){e.invalidate()})}));return i.wait()})};return t})(r.default);t.default=d});
define("odsp-next/controls/albumBuilder/AlbumBuilder",["require","exports","./AlbumBuilder.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AlbumBuilderViewModel","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-album-builder",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/albumBuilder/AlbumBuilder.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-AlbumBuilder" data-bind="component:{name:filePickerHostTagName,params:filePickerHostParams},dismiss:{close:$component.onDismiss.bind($component),disableEscape:false}"><div class="od-AlbumBuilder-content od-ItemContent" data-bind="css:{\'od-AlbumBuilder-content--hasError\':!!$host.status().error&&!!$host.status().error.message}"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-AlbumBuilder-title od-ItemContent-title" data-bind="component:{name:itemNameEditorTagName,params:itemNameEditorParams}"></div>\x3c!--ko if:!!$host.status().error&&!!$host.status().error.message--\x3e<div class="od-AlbumBuilder-status od-ItemContent-subTitle" role="alert" data-bind="text:!!$host.status().error&&$host.status().error.message"></div>\x3c!--/ko--\x3e</div></div></div>'});
define("odsp-next/controls/albumBuilder/AlbumBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","../itemNameEditor/ItemNameEditor","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../dataSources/url/QueryType","./AlbumBuilder.resx","../../models/item/IItemTypeFilter","../../bindings/dismiss/DismissBinding","knockout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.itemNameEditorTagName=s.default.tagName;n.filePickerHostTagName=i.default.tagName;n._urlDataSource=n.resources.consume(u.url);n.addBindingHandlers({dismiss:c.default});var r=t.name,p=t.itemKey,d=void 0===p?n._urlDataSource.getRootItemKey(a.default.AllMyPhotos):p,v=t.complete,m=t.cancel;n._onClose=m;n.filePickerHostParams={itemKey:d,behavior:{showActions:!1,viewType:1,selectionMode:1,typeFilter:{filters:[l.ItemTypeFilter.media,l.ItemTypeFilter.folder]},completeText:f.default.createCompleteActionName},agent:{initialize:function(){return o.default.wrap()},getApplication:function(){return o.default.wrap()},complete:v,cancel:m,switchAccount:function(){return o.default.wrap()}}};n.itemNameEditorParams={name:r,extension:void 0,hasFocus:h.observable(!0),namePlaceholder:f.default.createNamePlaceholder,nameAriaLabel:f.default.albumNameLabelTextString};return n}t.prototype.onDismiss=function(e){this._onClose&&this._onClose(e);return!1};return t})(r.default);t.default=p});
define("odsp-next/actions/printPdf/odc/PrintPdfExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/commands/Commands.resx","../../../controls/pdfViewer/PdfViewer.resx","../../../utilities/icons/Icon","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.instrumentationProvider,s=t.selectionHelper;n.name=r;n._instrumentationProvider=i;n._selectionHelper=s;n._actionMap=n.resources.consume(c.actionMap);n._dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this._selectionHelper.resolveFirst().then(function(n){var r=t._dialogProvider.requestDialog({title:u.default.PrintOptionsTitle,component:{name:f.default.tagName,params:{text:u.default.PrintOptionsText}},actions:[{name:o.default.Download,execute:function(){var n=new(t.managed(t._actionMap.DownloadAction))({});h.default.logData({name:p.UsageName[p.UsageName.PrintPdfDownloadOptionClicked],location:p.LocationName[p.LocationName.OneUp],usageType:d.UsageType[d.UsageType.Click],currentPage:t._instrumentationProvider.currentPageName(),previousPage:t._instrumentationProvider.previousPageName()});n.execute(e);return i.default.wrap(2)},isAvailable:t.createObservable(!0),icon:new a.default("Download"),isDefault:!0}]});h.default.logData({name:p.UsageName[p.UsageName.PrintPdfDownloadOptionShown],location:p.LocationName[p.LocationName.OneUp],usageType:d.UsageType[d.UsageType.Click],currentPage:t._instrumentationProvider.currentPageName(),previousPage:t._instrumentationProvider.previousPageName()});return r.wait().then(function(){return i.default.wrap({resultType:s.ResultTypeEnum.Success})})})};return t})(r.default);t.default=v});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./SaveAutoAlbumOperator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._isHidden=t.isHidden;return n}t.prototype.execute=function(e){var t=this,n={album:this._selectionHelper.firstItem.peek(),operationVisibility:this._isHidden?2:0};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(s.default))(n);return t.trackPromise(e.start())}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure}})};return t})(r.default);t.default=o});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/album/AlbumProvider","../../../utilities/features/Features","../../../models/item/ItemHelper","../../../models/itemsScope/ItemsScopeFeature.key","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._context=t;n._albumProvider=n.resources.consume(o.resourceKey);n._viewParams=n.resources.consume(l.viewParams);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.saveAutoAlbum;n.name=r.name;n.payloads.saveAutoAlbum={album:r};n.visibility=void 0!==this._context.operationVisibility?this._context.operationVisibility:0;return n};t.prototype.onStart=function(e){var t=this._context.album,n=new i.default(t.key,t);e.update([n]);var r=!1,s=this._viewParams.peek();this.resources.consume(f.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===s.tagFilter&&(r=!0);return!u.isFeatureEnabled(u.EvokeDev)||a.isAutoAlbum(t)?this._albumProvider.saveAutoAlbum(this._context,r,e):this._albumProvider.convertToAutoAlbum(t,r,e)};return t})(r.default);t.default=c});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./DiscardAutoAlbumOperator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;return n}t.prototype.execute=function(e){var t=this,n={album:this._selectionHelper.firstItem.peek()};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(s.default))(n);t.trackPromise(e.start());return e.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure}})};return t})(r.default);t.default=o});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/fileSystem/FileSystemProvider","../../../dataSources/item/DeletionType","../../../providers/album/AlbumProvider","../../../dataSources/item/ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._context=t;n._fileSystemProvider=n.resources.consume(o.resourceKey);n._albumProvider=n.resources.consume(a.resourceKey);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.discardAutoAlbum;n.name=r.name;n.payloads.discardAutoAlbum={album:r};n.visibility=0;return n};t.prototype.onStart=function(e){var t=this,n=this._context.album,r=new i.default(n.key,n),s=this._albumProvider.getAlbumsParentKey({}),o=new(this.managed(f.default));e.update([r]);var a={items:[this._context.album],deletionType:u.default.Recycle,overrideLock:!1,parentKey:s,emptyRecycleBin:!1};this._updateAlbumDeletionStatus(o,n,1);return this._fileSystemProvider.deleteItems(a,e).then(function(e){t._updateAlbumDeletionStatus(o,n,2);o.dispose();return e})};t.prototype._updateAlbumDeletionStatus=function(e,t,n){var r=t.state&&t.state.delete||{};r.status=n;e.update([new i.default(t.key).succeed({item:{state:{delete:r}}})]);e.flush()};return t})(r.default);t.default=l});
define("odsp-next/actions/addToFolder/odc/AddToFolderExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../controls/bundleBuilder/BundleBuilder","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/panel/PanelProvider","@ms/odsp-shared/lib/base/BaseModel","../../../providers/moveCopy/MoveCopyProvider.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._panelProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=e.observables.createArray(),r=t[0];r.vault&&r.vault.root&&i.Engagement.logData({name:"Vault.MoveFrom.Clicked"});return e._addToFolderViaPanel(r,n).then(function(){return e._addToFolder(r,n.peek())})})};t.prototype._addToFolderViaPanel=function(e,t){var i=this.observables.create(!1),o={resources:this.resources,bundleName:e.displayName,viewType:0,showCommandBar:!1,allowRootItem:!1,complete:function(e){t.splice.apply(t,n.__spreadArrays([0,t.peek().length],e));i(!0);return r.default.wrap()},cancel:function(){i(!0);return r.default.wrap()},useMoveString:!!e.vault},u=this._panelProvider.requestPanel({noTitle:!0,hasCommandBar:!0,size:"Large",showCloseButton:!1,component:{name:s.default.tagName,params:o}}),a=this.createComputed(function(){i()&&u.state(1)});return u.wait().then(function(){a.dispose()},function(e){a.dispose();return r.default.wrapError(e)})};t.prototype._addToFolder=function(e,t){if(t&&0===t.length)return r.default.wrap({resultType:o.ResultTypeEnum.Success});var n={items:t,parentKey:e.parent.key,targetId:e.id,targetKey:e.key,cid:null,group:e.isGroup?1:0,isMove:!0};return this.resources.consumeAsync(f.resourceKey).then(function(e){return e.moveItems(n)}).then(function(){return{resultType:o.ResultTypeEnum.Success}})};return t})(a.default);t.default=l});
define("odsp-next/actions/vault/odc/VaultExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/icons/Icon","../../../dataSources/vault/odc/VaultLogHelper","../../../providers/dialog/DialogProvider","../../../providers/featureCards/FeatureCardsProvider","../../../dataSources/vault/IVaultDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/textContainer/TextContainer","../../../dataSources/url/odc/UrlDataSource","../VaultActionType","../../../dataSources/vault/odc/VaultDataSource","../../../controls/vaultFre/VaultFre","../../../controls/featureCards/FeatureCards","./VaultHelper","./VaultExecutor.resx","../../../utilities/browser/WebViewDetector","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._navigation=n.resources.consume(c.navigation);n._urlDataSource=n.resources.consume(v.resourceKey);n._vaultDataSource=n.resources.consume(g.resourceKey);n._vaultActionType=t.actionType;n._isPickerPage=t.isPickerPage;n._goPremiumSource=t.goPremiumSource?t.goPremiumSource:u.VAULT_GOPREMIUM_SOURCE_ICONCOMMAND;n._isVaultFreVisible=n.resources.consume(x.isVaultFreVisible);n._vaultHelper=new(n.managed(w.default))({});n._isOneDriveWinApp=S.isOneDriveWinApp();return n}t.prototype.execute=function(){var e=this,t=this._vaultActionType?this._vaultActionType.toString():"EmptyVaultAction";switch(this._vaultActionType){case m.default.Lock:return this._vaultDataSource.lockVault().then(function(){return h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success})}).catch(function(){return h.default.reject({name:t,resultType:p.ResultTypeEnum.Failure})});case m.default.Unlock:var n=window.localStorage&&!!window.localStorage.getItem("enableWinAppPersonalVault")||!1;return this._isOneDriveWinApp&&!n||this._isPickerPage?this._launchWinAppDialog():this._vaultDataSource.unlockVault(!1).then(function(){return h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success})}).catch(function(){return h.default.reject({name:t,resultType:p.ResultTypeEnum.Failure})});case m.default.Manage:this._navigation.navigateTo({url:this._urlDataSource.getManageVaultUrl()});return h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success});case m.default.FreDialog:return this._launchFreDialog().then(function(){return e._vaultHelper.unlockPopup().then(function(n){if(n){e._vaultDataSource.setVaultState(l.VaultFreState.FreShown);e._isVaultFreVisible(!1);e._vaultDataSource.setShowVaultFreMessage(!0,!0);return h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success})}return h.default.reject({name:t,resultType:p.ResultTypeEnum.Failure})})});case m.default.Reset:0;return h.default.reject({name:t,resultType:p.ResultTypeEnum.ExpectedFailure});case m.default.Debug:0;return h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success});case m.default.ShowFiles:return this._vaultHelper.unlockPopup().then(function(e){return e?h.default.resolve({name:t,resultType:p.ResultTypeEnum.Success}):h.default.reject({name:t,resultType:p.ResultTypeEnum.Failure})}).catch(function(){return h.default.reject({name:t,resultType:p.ResultTypeEnum.Failure})});case m.default.FilesRemaining:return this._launchQuotaDialog();default:return h.default.reject({name:t,resultType:p.ResultTypeEnum.ExpectedFailure})}};t.prototype._getCurrentPerson=function(){var e=this.resources.consume(i.identity).getIdentity();return{userId:e.id,name:FilesConfig.SuiteNavConfig.UserDisplayName,email:e.email,image:FilesConfig.SuiteNavConfig.UserTileUrl,sharingInfo:{type:1,role:0}}};t.prototype._launchQuotaDialog=function(){var e=this.resources.consume(a.resourceKey),t=this.resources.consume(f.resourceKey);s.Engagement.logData({name:"Vault.FeatureCard.Shown",extraData:{location:"FileRemainingCommand"}});var n=e.requestDialog({component:{name:b.default.tagName,params:{cards:t.getFeatureCardsForVaultUpsell(),currentIndex:0,close:function(){return e.currentDialog().dismiss()},includeOverlay:!0,goPremiumSource:this._goPremiumSource,goPremiumCTA:"GoPremium"}}});n.wait().catch(function(){3===n.state.peek()&&s.Engagement.logData({name:"Vault.FeatureCard.Dismiss",extraData:{location:"FileRemainingCommand"}})});return n.wait().then(function(){return{resultType:p.ResultTypeEnum.Success}})};t.prototype._launchWinAppDialog=function(){var e=this.resources.consume(a.resourceKey),t=E.default.winappUnavailableTitle,n=E.default.winappUnavailableText,r=e.requestDialog({title:t,component:{name:d.default.tagName,params:{text:n}},actions:[{name:E.default.close,execute:function(){return h.default.resolve(3)},isAvailable:this.observables.create(!0),icon:new o.default("CheckMark"),isDefault:!0}]}),i="Vault.FilePicker.NotAvailable";this._isOneDriveWinApp&&(i="Vault.PWA.NotAvailable");s.Engagement.logData({name:i});return r.wait().then(function(){return{resultType:p.ResultTypeEnum.Success}})};t.prototype._launchFreDialog=function(){var e=this,t=this.resources.consume(a.resourceKey);this._isFreVerifyAvailable=this.observables.create(!1);this._freTitle=this.observables.create("");var n=t.requestDialog({title:this._freTitle,overlayColor:"rgba(255, 255, 255, .4)",customCssClasses:"od-vaultfre-outer",size:"Medium",component:{name:y.default.tagName,params:{isVerifyVisible:this._isFreVerifyAvailable,person:this._getCurrentPerson()}},actions:[{name:E.default.freNextButton,execute:function(){return e._onDialogExecute()},isAvailable:this.createComputed(function(){return!e._isFreVerifyAvailable()}),isVisible:this.createComputed(function(){return!e._isFreVerifyAvailable()}),icon:new o.default("DoubleChevronRight"),isDefault:!0},{name:E.default.freVerifyButton,execute:function(){s.Engagement.logData({name:"Vault.FRE.Positioning.Verify"});return h.default.wrap(2)},isAvailable:this.observables.create(!0),isVisible:this._isFreVerifyAvailable,icon:new o.default("Shield"),isDefault:!0}]});s.Engagement.logData({name:"Vault.FRE.Positioning.Shown"});this._isVaultFreVisible(!0);n.wait().catch(function(){3===n.state.peek()&&(e._isFreVerifyAvailable()?s.Engagement.logData({name:"Vault.FRE.Positioning.Page2.Dimiss"}):s.Engagement.logData({name:"Vault.FRE.Positioning.Page1.Dimiss"}));return{resultType:p.ResultTypeEnum.ExpectedFailure}});return n.wait().then(function(){return{resultType:p.ResultTypeEnum.Success}})};t.prototype._onDialogExecute=function(){s.Engagement.logData({name:"Vault.FRE.Positioning.Next"});this._isFreVerifyAvailable(!0);this._freTitle(E.default.freVerifyTitle);return h.default.wrap(1)};return t})(r.default);t.default=T});
define("odsp-next/dataSources/vault/odc/VaultDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Api.event","../../../utilities/icons/Icon","@ms/odsp-graph/lib/Models","../../../models/item/ItemParentHelper","../../../models/store/ItemsStore","../IVaultDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","./VaultLogHelper","../../../dataSources/url/QueryType","../../../resources/ProviderResourceKeys","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor","../../../controls/textContainer/TextContainer","../../../controls/htmlContainer/HTMLContainer","./VaultDataSource.resx","@ms/odsp-utilities/lib/uri/Uri","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=["ManageVault","Restore","RansomwareDetection"],A=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;r._vroomDataRequestor=n.vroomDataRequestor;r._itemStore=n.itemStore;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;r._dialogProvider=n.dialogProvider;r._userInfoProvider=n.userInfoProvider;r._itemParentHelper=n.itemParentHelper;r._bundleLoader=n.bundleLoader;r._storageKeyPrefix=d.STORAGE_KEY_VAULT_PREFIX+r._identityDataSource.getIdentity().id;r._dataStore=t.dataStore||new i.default(r._storageKeyPrefix,s.default.local);r._isVaultOpen=r.createObservable(!!r._dataStore.getValue("expirationtime",s.default.local));r._vaultFreState=r.createObservable(d.VaultFreState.NotCreated);r._vaultSuggestCardState=r.createObservable(0);r._vaultQuota=r.createObservable(void 0);r._quotaLoaded=r.createComputed(r._computeQuotaLoaded);r._isVaultDisabled=r.createObservable(void 0);r._isLocking=!1;r._isOneDriveWinApp=k.isOneDriveWinApp();r.isOverQuota=r.createPureComputed(r._computeIsOverQuota);r._showVaultLockNotification=r.createObservable(!1);r._showVaultFreMessage=r.createObservable(!1);r.createComputed(r._calculateFreMessage);r.events.on(window,"storage",r._onStorageChange);r.createBackgroundComputed(r._updateVaultQuota);r.isVaultDisabled();r._isVaultOpen.peek()&&(r._getExpiration()<Date.now()?r.lockVault(void 0,!0):r._handleVaultUnlock());return r}t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))};t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))};t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))};t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))};t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))};t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))};t.prototype.getVaultItem=function(){return this._vaultItem};t.prototype.isVaultOpen=function(){return this._isVaultOpen};t.prototype.freState=function(){return this._vaultFreState};t.prototype.suggestCardState=function(){return this._vaultSuggestCardState};t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()};t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1);t||this._showVaultFreMessage(e);this._setVaultIconFre(e)};t.prototype.unlockVault=function(e,t){var n=this;return this.getVault(!1,!0).then(function(r){if(!r||!r.vault||r.vault.isLocked||e){var i;i=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?m.default.resolve({wlidToken:t}):m.default.resolve({accessToken:t});var s={};n._isOneDriveWinApp&&(s.Prefer="Include-Feature=Vault");return i.then(function(t){return n._vroomDataRequestor.send({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:s,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}}).then(function(){n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:1200});if(!e){var t=n._urlDataSource.getRootItemKey();n._itemProvider.invalidateItem(t)}return m.default.resolve({})}).catch(function(e){n._handleVaultLock();return m.default.reject(e)})})}n.setVaultLockState(r.vault,!!t)})};t.prototype.setVaultLockState=function(e,t,n){void 0===t&&(t=!1);if(!this._isLocking){var r=this._isVaultOpen.peek(),i=e.isLocked;if(i||r)i&&r&&this._handleVaultLock(!1,n);else{var o=e.expirationInSeconds||1200,u=Date.now()+1e3*o;this._dataStore.setValue("expirationtime",u,s.default.local);this._handleVaultUnlock(t)}}};t.prototype.lockVault=function(e,t){var n=this;this._isLocking=!0;this._navToRootIfInVault();if(e){var r=this._urlDataSource.getPageType(this._navigation.viewParams),i=this._urlDataSource.getQueryType(this._navigation.viewParams);u.Engagement.logData({name:"Vault.Autolocked",extraData:{location:g.getPageName(r,i)}})}var s=this._vaultItem?m.default.resolve(this._vaultItem):this.getVault(),o={};this._isOneDriveWinApp&&(o.Prefer="Include-Feature=Vault");return s.then(function(r){return n._vroomDataRequestor.send({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:o,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}}).then(function(){n._isLocking=!1;n._handleVaultLock(t)}).catch(function(e){n._isLocking=!1;403===e.status?n._handleVaultLock(t):n._showLockFailed();return n._isExpectedError(e)?m.default.resolve():m.default.reject(e)})})};t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)};t.prototype.extendLock=function(){return this.unlockVault(!0)};t.prototype.getVault=function(e,t,n,r){var i=this,s={};e&&(s.Prefer="auto-create-special-folder");this._isOneDriveWinApp&&(s.Prefer=s.Prefer+",Include-Feature=Vault");n=n||"GET";return this._vroomDataRequestor.send({apiName:r?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:s,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)}).then(function(e){e.createdBy.user.id=e.createdBy.user.id.toUpperCase();i._vaultItem=e;return e}).catch(function(e){return t?null:m.default.reject(e)})};t.prototype.getQuota=function(){var e=this,t={};this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"}).then(function(t){var n=t&&t.quota&&t.quota.vault;e._vaultQuota(n);return n})};t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===d.VaultFreState.Created)return e.getVault(!0).then(function(t){e.setVaultState(d.VaultFreState.Created);e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();e._itemProvider.invalidateItem(n,{triggerFetch:!0});return t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s);e._vaultSuggestCardState(n.c)})};t.prototype.isVaultDisabled=function(){var e=this;return void 0!==this._isVaultDisabled.peek()?m.default.wrap(this._isVaultDisabled.peek()):this._userInfoProvider.getUserFact(46).then(function(t){if(t)return e.getVault(!1,!1,"HEAD").then(function(){e._isVaultDisabled(!1);return!1}).catch(function(t){var n=404===t.status;e._isVaultDisabled(n);return n});e._isVaultDisabled(!0);return!0})};t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();e._itemProvider.invalidateItem(n,{triggerFetch:!0});e._isVaultDisabled(!1);return t})};t.prototype.disableVault=function(e){var t=this,n={};e&&(n.If="(<"+e+">)");this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault");return this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault/delete",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new C.default(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n){0;return n}}return m.default.reject(e)})};t.prototype.setVaultState=function(e,t){var n=void 0;if(void 0!==e&&e>this._vaultFreState.peek()){this._vaultFreState(e);n=e}t&&this._vaultSuggestCardState(t);var r={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(r))};t.prototype.reset=function(){0;return m.default.resolve(!1)};t.prototype.toggleDebug=function(){0};t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();if(e){n&&(!e.vault&&L.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents());if(e.vault&&e.vault.root){if(!this._vaultRootLoadEventFiled){u.Engagement.logData({name:"Vault.Unlocked.Loaded"});this._vaultRootLoadEventFiled=!0}}else this._vaultRootLoadEventFiled=!1}};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(2).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(b.quota));return!0}return!1};t.prototype._computeIsOverQuota=function(){var e=this._vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0};t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();this._quotaLoaded()&&e&&this._isVaultOpen()&&this.getQuota()};t.prototype._isDebug=function(){0;return!1};t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue("expirationtime",s.default.local)};t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4);this._expirationLockTimerId=this.async.setTimeout(function(){0;e.lockVault(!0)},this._getExpiration()-Date.now())};t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId);this.async.clearTimeout(this._expirationLockTimerId)};t.prototype._resetExpirationTimers=function(){0;this._stopExpirationTimers();this._startExpirationTimers()};t.prototype._attachIdleEvents=function(){if(!this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0);this.events.on(document,"mousemove",this._resetLastActivity,!0);this.events.on(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!0;0}};t.prototype._detatchIdleEvents=function(){if(this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0);this.events.off(document,"mousemove",this._resetLastActivity,!0);this.events.off(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!1;0}};t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()};t.prototype._verifyLockExpiration=function(){var e=this;0;if(this._isDebug())this._showLockWarning();else if(Date.now()-this._lastActivity<9e5){0;this.extendLock().then(function(){e._resetExpirationTimers()})}else this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){0;var r=Date.now()+1e3*n;e._dataStore.setValue("expirationtime",r,s.default.local);e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){0;return e.lockVault()})};t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:N.default.LockFailedDialogTitle,component:{name:T.default.tagName,params:{html:'<span class="ms-fontColor-error">'+N.default.LockFailedDialogBody+"</span>"}},actions:[{name:N.default.LockFailedDialogRetryButton,execute:function(){return m.default.resolve(2)},isAvailable:this.observables.create(!0),icon:new l.default("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){if(2===t.state.peek()){e.async.clearTimeout(e._retryLockVault);e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500)}})};t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:N.default.ExpirationDialogTitle,component:{name:x.default.tagName,params:{text:N.default.ExpirationDialogBody}},actions:[{name:N.default.ExpirationDialogExtendButton,execute:function(){u.Engagement.logData({name:"Vault.StillHere.Extend"});return e.extendLock().then(function(){e._resetExpirationTimers();return m.default.resolve(2)})},isAvailable:this.observables.create(!0),icon:new l.default("Cancel"),isDefault:!0}],isSoftDismissable:!1});u.Engagement.logData({name:"Vault.StillHere.Shown"});this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&u.Engagement.logData({name:"Vault.StillHere.Dismiss"})})};t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t);this._showVaultLockNotification(!e)};t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1);this._dataStore.remove("expirationtime",s.default.local);this._stopExpirationTimers();e||this._navToRootIfInVault();this.events.off(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!1;this._getVaultIconFre()||this._showVaultFreMessage(!1);this._detatchIdleEvents();this._warningDialog&&this._warningDialog.dismiss();Object.keys(y.default).map(function(e){var n=t._urlDataSource.getRootItemKey(y.default[e]);t._itemProvider.invalidateItem(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var r=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([r])}else n&&this._itemProvider.invalidateItem(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()};t.prototype._navToRootIfInVault=function(){var e=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"))){var t=this._urlDataSource.getRootItemKey(),n=this._urlDataSource.getItemUrl(t);this._navigation.navigateTo({url:n})}};t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1);this._isVaultOpen(!0);this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._itemProvider.invalidateItem(n,{triggerFetch:!0});if(!this._navEventAttached){this.events.on(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!0;this._onNavigationChange()}this.getQuota();this._warningDialog&&this._warningDialog.dismiss();var r=this._getCurrentItem();if(r&&(r.vault||r.isPlaceholder||r.error&&r.error.data&&161===r.error.data.errorCode||r.queryType===y.default.RecycleBin&&"root"===r.id)){this._itemProvider.invalidateItem(r.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._itemProvider.invalidateItem(i,{purgeCache:!0})}this._showVaultLockNotification(!1);u.Engagement.logData({name:"Vault.Unlocked.Succeeded"});if(this._getVaultIconFre()&&!e){this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3);this._setVaultIconFre(!1)}};t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,r=e.newValue;if(t===this._storageKeyPrefix+d.STORAGE_KEY_VAULT_CANARY&&r)try{var i=JSON.parse(r);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}if(t===this._storageKeyPrefix+"expirationtime")if(r){if(!n||r>n){this._dataStore.getValue("expirationtime",s.default.local)||this._dataStore.setValue("expirationtime",parseInt(r,10),s.default.local);this._handleVaultUnlock()}}else this._isVaultOpen.peek()&&this._handleVaultLock()};t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)};t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))};t.prototype._getVaultIconFre=function(){return this._dataStore.getValue("vaultMenuCalloutMessageShow",s.default.local)};t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue("vaultMenuCalloutMessageShow",e,s.default.local):this._dataStore.remove("vaultMenuCalloutMessageShow",s.default.local)};t.prototype._postProcessQos=function(e,t){this._isExpectedError(t)&&(e.resultType=f.ResultTypeEnum.ExpectedFailure);return e};t.prototype._postProcessUnlockQos=function(e,t){this._isExpectedUnlockError(t)&&(e.resultType=f.ResultTypeEnum.ExpectedFailure);return e};t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=c.getResultCodeFromError(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1};t.prototype._isExpectedUnlockError=function(e){var t=c.getResultCodeFromError(e);if("vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())){u.Engagement.logData({name:"Vault.Unlock.MaxExtensionError"});return!0}return!1};return t})(r.default);t.default=A;t.resourceKey=E.createResolvedResourceKey(e("module").id,A,n.__assign(n.__assign({},r.default.dependencies),{identityDataSource:o.identity,vroomDataRequestor:S.resourceKey,itemStore:p.resourceKey,urlDataSource:o.url,navigation:v.navigation,itemProvider:w.resourceKey,dialogProvider:a.resourceKey,userInfoProvider:b.userInfo,itemParentHelper:h.resourceKey,bundleLoader:b.bundleLoader}))});
define("odsp-next/controls/vaultFre/VaultFre",["require","exports","./VaultFre.html","./VaultFreViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-vault-fre",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/vaultFre/VaultFre.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-vaultfre"><div class="intro" data-bind="visible:!isVerifyVisible()"><span class="od-vaultfre-title" data-bind="text:secondaryTitle"></span><span class="od-vaultfre-description" data-bind="text:descriptionText"></span><div class="od-vaultfre-points"><div><img class="od-vaultfre-image" role="presentation" data-bind="attr:{src:lockImageUrl}"><span data-bind="text:itemOneText"></span></div><div><img class="od-vaultfre-image" role="presentation" data-bind="attr:{src:clockImageUrl}"><span data-bind="text:itemTwoText"></span></div><div><img class="od-vaultfre-image" role="presentation" data-bind="attr:{src:fileImageUrl}"><span data-bind="text:itemThreeText"></span></div></div></div><div class="od-vaultfre-verify" data-bind="visible:isVerifyVisible"><span class="od-vaultfre-description" data-bind="text:verifyText"></span><div class="od-vaultfre-person" data-bind="component:{name:personaTagName,params:personaParams}"></div></div></div>'});
define("odsp-next/controls/vaultFre/VaultFreViewModel",["require","exports","tslib","../persona/Persona","./VaultFre.resx","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.isVerifyVisible=t.isVerifyVisible;n.secondaryTitle=i.default.freSecondaryTitle;n.descriptionText=i.default.freDescription;n.itemOneText=i.default.freItemOne;n.itemTwoText=i.default.freItemTwo;n.itemThreeText=i.default.freItemThree;n.verifyText=i.default.freVerifyText;n.lockImageUrl=n._getImagePath("lock");n.clockImageUrl=n._getImagePath("clock");n.fileImageUrl=n._getImagePath("mobiledevice");n.personaTagName=r.default.tagName;n.personaParams={person:n.observables.create(t.person),personaSize:8};return n}t.prototype._getImagePath=function(e){return window.require.toUrl("odsp-media/images/vault/"+e+".svg")};return t})(s.default);t.default=o});
define("odsp-next/actions/downloadZipContents/odc/DownloadZipContentsAction",["require","exports","tslib","@ms/odsp-utilities/lib/navigation/AddressWriter","../DownloadZipContentsAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.onExecute=function(e,t){var n=this;this._engagement.logData({name:"OneUpZipPreviewer.SelectiveDownload",isIntentional:!0});var i=this._selection.peek(),s=this._downloadUrl.peek();return this.getAuthenticationParams().then(function(e){var t={url:s+"?"+r.serializeQuery(e),postdata:{relativeFilePath:i.map(function(e){return e.path}).join(",")}};return n.downloadContent(t,i)})};return t})(i.default);t.default=s});
define("odsp-next/actions/downloadZipContents/DownloadZipContentsAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/utilities/permissions/Identity","../NavigateViaPost","../../base/BaseAction","../../controls/downloadZipContents/DownloadZipContents","../../providers/engagement/Engagement","../../providers/hiddenDom/HiddenDomProvider","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="DownloadZipContents";var i=n.resources;n._engagement=i.consume(c.resourceKey);n._hiddenDomProvider=i.consume(h.resourceKey);n._useWindow=i.consume(s.platformDetection).isIE;n._identityDataSource=i.consume(d.identity);n._navigation=i.consume(r.navigation);n._downloadUrl=t.url;n._selection=t.selection;var o=i.consume(p.actionMap);n._downloadAction=new(n.managed(o.DownloadAction))({item:t.item});n._isOneDriveWinApp=v.isOneDriveWinApp();return n}t.prototype.onIsAvailable=function(){return this._downloadAction.isAvailable()&&!!this._downloadUrl};t.prototype.getAuthenticationParams=function(){var e,t=this._getAuthKey();return t?i.default.resolve(((e={}).authkey=t,e)):this._identityDataSource.getSessionToken().then(function(e){var t=e.accessToken,n=e.proofToken,r={};t&&(r.access_token=decodeURIComponent(t));n&&(r.prooftoken=decodeURIComponent(n));return r})};t.prototype.downloadContent=function(e,t){var n=this;if(this._useWindow)this._downloadInWindow("od-download-tab",e);else{var r=this._hiddenDomProvider.requestControl({name:l.default.tagName,params:e}),s=this.addDisposable({dispose:function(){n._hiddenDomProvider.disposeControl(r)}});this.async.setTimeout(function(){s.dispose()},2e4)}var u={resultType:o.ResultTypeEnum.Success,extraMetrics:{count:t.length}};return i.default.resolve(u)};t.prototype._getAuthKey=function(){return this._identityDataSource.getIdentity().type===u.IdentityType.anonymous&&this._navigation.viewParams.authkey};t.prototype._downloadInWindow=function(e,t){var n=window.open("",e);a.navigateViaPost({url:t.url,postdata:t.postdata,document:n.document});this.async.setTimeout(function(){n.close()},5e3)};return t})(f.default);t.default=m});
define("odsp-next/controls/downloadZipContents/DownloadZipContents",["require","exports","./DownloadZipContents.html","./DownloadZipContentsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCExecutors_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-downloadzipcontents",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/downloadZipContents/DownloadZipContents.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-DownloadZipContents" data-bind="iframe:iframeOptions"></div>'});
define("odsp-next/controls/downloadZipContents/DownloadZipContentsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/iframe/IFrameBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({iframe:i.default});n.iframeOptions={url:t.url,postdata:t.postdata,type:"post"};return n}return t})(r.default);t.default=s});
define("odsp-next/actions/moveCopy/odc/MoveCopyAction",["require","exports","tslib","../../../providers/moveCopy/MoveCopyProvider.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../MoveCopyAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.onExecute=function(e){var t=this;return this.resources.consumeAsync(r.resourceKey).then(function(e){var n;n=t.isMove?e.moveItems(t.context()):e.copyItemsAsync(t.context());t.onComplete();return n.then(function(){return{resultType:i.ResultTypeEnum.Success}})})};return t})(s.default);t.default=o});
define("odsp-next/actions/moveCopy/MoveCopyAction",["require","exports","tslib","../base/templates/SelectionAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="MoveCopy";n.context=t.context;n.onComplete=t.onComplete;n.isMove=t.isMove;n.keepSharingAvailable=!!t.isCheckBoxShown;n.keepSharingSelected=!!t.keepSharing;n.isCrossSite=!!t.isCrossSite&&t.isCrossSite;return n}t.prototype.onIsAvailable=function(){return this.selectionHelper.selection().length&&this.context().isMove===this.isMove};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};return t})(r.default);t.default=i});
define("odsp-next/actions/createNewFolder/odc/CreateNewFolderAction",["require","exports","tslib","../../base/ItemRedeemer","../../base/ItemCommandHelper","../CreateNewFolderAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemReedemer=n.resources.consume(r.resourceKey);n._itemCommandHelper=new(n.managed(i.default));return n}t.prototype.onIsAvailable=function(){return this._itemCommandHelper.isCommandSupported(this.parentItem,o.createFolder)};t.prototype.onExecute=function(t){var n=this;return this._itemReedemer.redeemItem(this.parentItem,this).then(function(){return e.prototype.onExecute.call(n,t)})};return t})(s.default);t.default=u});
define("odsp-next/actions/createNewFolder/CreateNewFolderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../createFolder/CreateFolderOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="CreateNewFolder";n.parentItem=t.parentItem;n._newName=t.newFolderName;var r=t.options||{};n._options={dataUpdated:r.dataUpdated||n.observables.create(!1),showNewFolderInput:r.showNewFolderInput||n.observables.create(!0),hasError:r.hasError||n.observables.create(!1),status:r.status||n.observables.create(""),hasFocus:r.hasFocus||n.observables.create(!0),isEnabled:r.isEnabled||n.observables.create(!0),needsRefocus:r.needsRefocus||n.observables.create(!1)};return n}t.prototype.onExecute=function(e){var t=this;this._options.status(s.default.Saving);this._options.hasError(!1);this._options.isEnabled(!1);return this.resources.consumeAsync(o.typeResourceKey).then(function(e){var n=new e({parent:t.parentItem,folderName:t._newName.peek()});return t.trackPromise(n.start())}).then(function(){t._options.dataUpdated(!0);t._options.showNewFolderInput(!1);t._options.isEnabled(!0);t._options.status("");return{resultType:i.ResultTypeEnum.Success}},function(e){t._options.hasError(!0);t._options.status(e.message);t._options.isEnabled(!0);t._options.hasFocus(!0);return{resultType:i.ResultTypeEnum.Failure}})};return t})(r.default);t.default=u});
define('ODCExecutors_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-FolderBuilder-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-FolderBuilder-status--error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";word-wrap:break-word}.od-FolderBuilder-input--error{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"!important}.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-addEditorsButton.od-Button{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .od-Persona-emailText{display:none}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";overflow-y:auto;padding:5px;margin:10px 0 5px 0}"},{"rawString":".od-DownloadAsZip{visibility:hidden}"},{"rawString":".od-embed-useEmbedDialog .od-embed-details{display:inline-block;vertical-align:top}.od-embed-useEmbedDialog .od-embed-disclaimer{display:inline-block;margin-top:10px}.od-embed-useEmbedDialog .od-embed-textbox{padding:1px 5px 2px 10px;width:90%;text-overflow:ellipsis}html[dir=rtl] .od-embed-useEmbedDialog .od-embed-textbox{padding:1px 10px 2px 5px}.od-embed-useModernEmbedPanel .od-embed-preview{margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-generateIcon{height:255px}.isFluent .od-embed-useModernEmbedPanel .od-embed-generateIcon{width:100%}.od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:16px;margin-bottom:20px}.isFluent .od-embed-useModernEmbedPanel .od-embed-instructions{margin-bottom:16px;font-size:14px}.sm .od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:11px;margin-bottom:15px}.od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:16px;margin-bottom:18px}.lg .od-embed-useModernEmbedPanel .od-embed-imageSize,.md .od-embed-useModernEmbedPanel .od-embed-imageSize,.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-bottom:13px}.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:11px;margin-bottom:8px}.od-embed-useModernEmbedPanel .od-embed-disclaimer{display:inline-block;margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-configurator{font-size:14px}.od-embed-useModernEmbedPanel .od-embed-copyText{margin-top:0;margin-bottom:20px}.sm .od-embed-useModernEmbedPanel .od-embed-copyText{margin-bottom:10px}.od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:20px}.lg .od-embed-useModernEmbedPanel .od-embed-sizePicker,.md .od-embed-useModernEmbedPanel .od-embed-sizePicker,.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:15px}.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:12px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsBox{margin-bottom:20px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsCheckbox{vertical-align:middle}.od-embed-useModernEmbedPanel .od-embed-updateSpinner{visibility:hidden}html[dir=ltr] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:right}html[dir=rtl] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:left}.od-embed-useModernEmbedPanel .od-embed-updateSpinnerOn{visibility:visible}"},{"rawString":".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:flex;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-Button-withCheckBox{margin-top:20px}[dir=ltr] .od-Button-withCheckBox{margin-left:175px}[dir=rtl] .od-Button-withCheckBox{margin-right:175px}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}.od-InlineCreateFolder{display:flex;align-items:center;cursor:pointer}.od-InlineCreateFolder.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent;background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-InlineCreateFolder.is-focused{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-InlineCreateFolder.is-focused{background:#00c0ff}}.od-InlineCreateFolder.is-focused .od-InlineCreateFolder-addFolderText{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-InlineCreateFolder-textInput{flex-grow:1;font-size:14px;border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";outline:1px solid transparent;box-sizing:border-box;min-width:100px}[dir=ltr] .od-InlineCreateFolder-textInput{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-textInput{padding-right:10px}[dir=ltr] .od-InlineCreateFolder-textInput{margin-left:7px}[dir=rtl] .od-InlineCreateFolder-textInput{margin-right:7px}.od-InlineCreateFolder-textInput:focus,.od-InlineCreateFolder-textInput:hover{outline:1px solid transparent;border-color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-InlineCreateFolder-createButton{display:inline-block;width:32px;min-width:32px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding:0 0 3px 0}[dir=ltr] .od-InlineCreateFolder-createButton{margin-right:5px}[dir=rtl] .od-InlineCreateFolder-createButton{margin-left:5px}.od-InlineCreateFolder-createButtonIcon{font-size:18px;vertical-align:middle}.od-InlineCreateFolder-addFolderText{flex-grow:1;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:14px;cursor:pointer;outline:0}[dir=ltr] .od-InlineCreateFolder-addFolderText{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-addFolderText{padding-right:10px}.od-InlineCreateFolder-icon{width:30px;min-width:30px;text-align:center;font-size:16px;color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";padding-top:2px;position:relative}[dir=ltr] .od-InlineCreateFolder-icon{left:-1px}[dir=rtl] .od-InlineCreateFolder-icon{right:-1px}.od-InlineCreateFolder-icon .od-LoadingSpinner-loadingGif{vertical-align:inherit}.od-InlineCreateFolder-error{font-size:12px;color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}[dir=ltr] .od-InlineCreateFolder-error{padding-left:38px}[dir=rtl] .od-InlineCreateFolder-error{padding-right:38px}"},{"rawString":".od-InfoBar{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding:6px 8px 8px 8px;display:flex;align-items:flex-start}html[dir=rtl] .od-InfoBar{padding:6px 8px 8px 8px}.od-InfoBar-icon{font-size:16px;padding-top:2px}[dir=ltr] .od-InfoBar-icon{padding-left:1px}[dir=rtl] .od-InfoBar-icon{padding-right:1px}.od-InfoBar-iconPlaceholder{width:31px}.od-InfoBar-alert{background-color:"},{"theme":"alertBackground","defaultValue":"#deecf9"},{"rawString":"}.od-InfoBar-text{font-size:12px}[dir=ltr] .od-InfoBar-text{padding-left:8px}[dir=rtl] .od-InfoBar-text{padding-right:8px}"},{"rawString":".od-StillSpinning-text{text-align:center;padding-top:10px}.od-StillSpinning-error{text-align:center}.od-StillSpinning-imgError{padding-bottom:10px}"},{"rawString":".od-keepSharing{display:flex}.od-keepSharing .ms-TooltipHost{padding:2px}.od-keepSharing .ms-ActivityItem-activityTypeIcon{height:100%}.od-keepSharing .ms-ActivityItem-personaContainer{height:100%}.od-keepSharing .ms-ActivityItem-personaContainer .ms-Persona-imageArea{margin:0}.od-keepSharing .ms-ActivityItem-activityContent{display:none}.od-keepSharing-checkBox-label{font-size:12px;margin:1px;padding:0 2px 0 6px}html[dir=rtl] .od-keepSharing-checkBox-label{padding:0 6px 0 2px}.od-keepSharing .ms-TooltipHost{font-size:14px;vertical-align:middle}"},{"rawString":".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400}"},{"rawString":".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:flex;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-Button-withCheckBox{margin-top:20px}[dir=ltr] .od-Button-withCheckBox{margin-left:175px}[dir=rtl] .od-Button-withCheckBox{margin-right:175px}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}"},{"rawString":".od-FileNameWithIcon-fileName{vertical-align:bottom}[dir=ltr] .od-FileNameWithIcon-fileName{padding-left:3px}[dir=rtl] .od-FileNameWithIcon-fileName{padding-right:3px}.isFluent .od-FileNameWithIcon-fileName{vertical-align:middle}[dir=ltr] .isFluent .od-FileNameWithIcon-fileName{padding-left:5px}[dir=rtl] .isFluent .od-FileNameWithIcon-fileName{padding-right:5px}.od-FileNameWithIcon-icon .FileTypeIcon{width:20px;height:20px}"},{"rawString":".od-InlineFolderBuilder{overflow:visible;white-space:nowrap;word-wrap:break-word;display:inline-block}.od-InlineFolderBuilder-textInput{display:inline-block}[dir=ltr] .od-InlineFolderBuilder-textInput{margin-left:8px}[dir=rtl] .od-InlineFolderBuilder-textInput{margin-right:8px}.od-InlineFolderBuilder-createButton{margin-top:2px;line-height:0}html[dir=ltr] .od-InlineFolderBuilder-createButton{float:right}html[dir=rtl] .od-InlineFolderBuilder-createButton{float:left}.od-InlineFolderBuilder-status{margin-top:2px;font-size:12px;font-weight:400;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";white-space:pre-wrap;word-wrap:break-word;line-height:15px}.od-InlineFolderBuilder-status--error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}"},{"rawString":".isFluent .od-FolderTree{margin:0 -12px}.isFluent.sm .od-FolderTree{margin:0 -8px}.isFluent .od-FolderTree-row{display:flex;align-items:center}.isFluent .od-FolderTree-row .ms-Icon--ChevronDown,.isFluent .od-FolderTree-row .ms-Icon--ChevronRight,.isFluent .od-FolderTree-row .od-FolderTree-loadingGif{padding:10px 14px 10px 0}html[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--ChevronDown,html[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--ChevronRight,html[dir=rtl] .isFluent .od-FolderTree-row .od-FolderTree-loadingGif{padding:10px 0 10px 14px}[dir=ltr] .isFluent .od-FolderTree-row .od-FolderTree-folderName{margin-left:0}[dir=rtl] .isFluent .od-FolderTree-row .od-FolderTree-folderName{margin-right:0}[dir=ltr] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-left:0}[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-right:0}[dir=ltr] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-right:12px}[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-left:12px}.od-FolderTree-row{overflow:hidden;cursor:default;height:34px;line-height:14px;position:relative;margin:2px 0;min-width:220px;white-space:nowrap;text-overflow:ellipsis}.isFluent .od-FolderTree-row{padding:0 16px;border-radius:2px;min-width:auto}.od-FolderTree-row.is-selected{background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":"}.isFluent .od-FolderTree-row.is-selected{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}@media screen and (-ms-high-contrast:active){.od-FolderTree-row.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderTree-row.is-selected{background:#00c0ff}}.od-FolderTree-row:focus{outline:1px solid transparent}.od-FolderTree-row .ms-Icon--ChevronDown{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";opacity:0;padding:10px;font-size:12px}.isFluent .od-FolderTree-row .ms-Icon--ChevronDown{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderTree-row .ms-Icon--ChevronRight{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";opacity:0;padding:10px 8px 10px 14px;font-size:12px}html[dir=rtl] .od-FolderTree-row .ms-Icon--ChevronRight{padding:10px 14px 10px 8px}.isFluent .od-FolderTree-row .ms-Icon--ChevronRight{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-FolderTree-row.icon-visible .ms-Icon--ChevronRight{opacity:1}.od-FolderTree-row.icon-visible .ms-Icon--ChevronDown{opacity:1}.od-FolderTree-row .ms-Icon--OneDrive{font-size:16px;padding:10px 0;width:16px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";vertical-align:top}[dir=ltr] .od-FolderTree-row .ms-Icon--OneDrive{margin-left:-3px}[dir=rtl] .od-FolderTree-row .ms-Icon--OneDrive{margin-right:-3px}.od-FolderTree-row .od-FolderTree-loadingGif{vertical-align:bottom;padding:9px}.isFluent .od-FolderTree-row .od-FolderTree-loadingGif{width:14px;height:14px}.od-FolderTree-row>i{display:inline}.od-FolderTree-folderIcon{vertical-align:top;line-height:30px}.isFluent .od-FolderTree-folderIcon{line-height:16px}[dir=ltr] .isFluent .od-FolderTree-folderIcon{margin-right:12px}[dir=rtl] .isFluent .od-FolderTree-folderIcon{margin-left:12px}.isFluent .od-FolderTree-folderIcon .FileTypeIcon{height:100%}.isFluent .od-FolderTree-folderIcon .FileTypeIcon .FileTypeIcon-icon{vertical-align:top}.od--isNonMobile .od-FolderTree-row:hover{background:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":"}.isFluent.od--isNonMobile .od-FolderTree-row:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{"theme":"themeLightAlt","defaultValue":"#beddf4"},{"rawString":"}.isFluent.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent.od--isNonMobile .od-FolderTree-row:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-focus--enabled .od-FolderTree-row.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od-FolderTree-folderName{cursor:pointer;position:relative;top:-1px;line-height:32px}[dir=ltr] .od-FolderTree-folderName{margin-left:3px}[dir=rtl] .od-FolderTree-folderName{margin-right:3px}.isFluent .od-FolderTree-folderName{position:static;overflow:hidden;text-overflow:ellipsis}[dir=ltr] .isFluent .od-FolderTree-folderName{padding-right:8px}[dir=rtl] .isFluent .od-FolderTree-folderName{padding-left:8px}.od-FolderTree-children{margin:0}[dir=ltr] .od-FolderTree-children{padding-left:20px}[dir=rtl] .od-FolderTree-children{padding-right:20px}[dir=ltr] .isFluent .od-FolderTree-children{padding-left:0}[dir=rtl] .isFluent .od-FolderTree-children{padding-right:0}.od-FolderTree-title{margin-bottom:20px}.isFluent .od-FolderTree-title{font-size:20px}.od-FolderTree-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-FolderTree-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .ms-CommandBar{animation:none}}.isFluent .od-FolderTree-commandBar .ms-CommandBar{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";box-shadow:inset 0 1px 0 0 #2488d8;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.isFluent .od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton{height:auto;margin:6px 8px;border-radius:2px;padding:0 18px;box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton i{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton:focus{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":" inset}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton){background-color:inherit}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton):hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton):active{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-FolderTree-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .CommandBar{animation:none}}.od-FolderTree-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";box-shadow:inset 0 1px 0 0 #2488d8}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":";box-shadow:none}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":";margin:2px -8px}.od-FolderTree-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0}[dir=ltr] .od-FolderTree-contentContainer{left:0}[dir=rtl] .od-FolderTree-contentContainer{right:0}[dir=ltr] .od-FolderTree-contentContainer{right:0}[dir=rtl] .od-FolderTree-contentContainer{left:0}.od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:22px}.isFluent .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:10px}.isFluent.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.isFluent.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.isFluent.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.od-FolderTree-sharingInfo{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":";padding:4px 6px}.od-FolderTree-inlineFolderBuilder{margin:2px 0;line-height:34px}[dir=ltr] .od-FolderTree-inlineFolderBuilder{padding-left:57px}[dir=rtl] .od-FolderTree-inlineFolderBuilder{padding-right:57px}"},{"rawString":".od-UserActivity-Feed{font-size:12px}.od-UserActivity-Feed-List a,.od-UserActivity-Feed-List a:hover,.od-UserActivity-Feed-List a:visited{cursor:pointer;text-decoration:none;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}"},{"rawString":".od-UserActivityTile{padding:10px 0;min-height:50px}.od-UserActivityTile-ActorPhoto{position:absolute}.od-UserActivityTile-Text{position:relative}[dir=ltr] .od-UserActivityTile-Text{margin-left:58px}[dir=rtl] .od-UserActivityTile-Text{margin-right:58px}"},{"rawString":".reportAbuseHeader_7eb38fa6{width:400px;position:relative}.reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonWeb_7eb38fa6{position:absolute;background:none;border:none;font-size:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;top:16px;height:16px;width:16px}[dir='ltr'] .reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonWeb_7eb38fa6{right:16px}[dir='rtl'] .reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonWeb_7eb38fa6{left:16px}.reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonMobile_7eb38fa6{position:absolute;background:none;border:none;font-size:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;top:16px;height:16px;width:16px}[dir='ltr'] .reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonMobile_7eb38fa6{left:16px}[dir='rtl'] .reportAbuseHeader_7eb38fa6 .reportAbuseCloseButtonMobile_7eb38fa6{right:16px}\n"},{"rawString":".reportAbuseDescription_6c79d2a8{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font:-apple-system-footnote;width:400px}.reportAbuseDescription_6c79d2a8 .reportAbuseHeaderLabel_6c79d2a8{font-size:21px;font-weight:600;font:-apple-system-headline;margin-top:12px;margin-bottom:0px;padding:0px;text-align:center}.reportAbuseDescription_6c79d2a8 .reportAbuseHeader_6c79d2a8{margin-bottom:12px;text-align:center}.reportAbuseDescription_6c79d2a8 .reportAbuseHeaderText_6c79d2a8{font-size:14px;font-weight:400;font:-apple-system-footnote;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";padding-bottom:0px}.reportAbuseDescription_6c79d2a8 .choiceGroupSelected_6c79d2a8{margin-bottom:4px}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .choiceGroupSelected_6c79d2a8{margin-left:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .choiceGroupSelected_6c79d2a8{margin-right:24px}.reportAbuseDescription_6c79d2a8 .choiceGroupCopyrightSelected_6c79d2a8{margin-bottom:36px}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .choiceGroupCopyrightSelected_6c79d2a8{margin-left:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .choiceGroupCopyrightSelected_6c79d2a8{margin-right:24px}.reportAbuseDescription_6c79d2a8 .choiceGroupNotSelected_6c79d2a8{margin-bottom:78px}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .choiceGroupNotSelected_6c79d2a8{margin-left:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .choiceGroupNotSelected_6c79d2a8{margin-right:24px}.reportAbuseDescription_6c79d2a8 .ms-ChoiceField{font-size:14px;font-weight:400;font:-apple-system-footnote}.reportAbuseDescription_6c79d2a8 .reportAbuseFooter_6c79d2a8{margin-bottom:10px}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .reportAbuseFooter_6c79d2a8{margin-left:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .reportAbuseFooter_6c79d2a8{margin-right:24px}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .reportAbuseFooter_6c79d2a8{margin-right:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .reportAbuseFooter_6c79d2a8{margin-left:24px}.reportAbuseDescription_6c79d2a8 .reportAbuseFooterLabel_6c79d2a8{font-size:14px;font-weight:400;font:-apple-system-footnote}.reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonWeb_6c79d2a8{font-size:14px;font-weight:600;width:140px;border-radius:2px;position:absolute}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonWeb_6c79d2a8{right:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonWeb_6c79d2a8{left:24px}.reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonAndroid_6c79d2a8{font-size:14px;font-weight:600;width:75px;height:36px;border-radius:2px;position:absolute}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonAndroid_6c79d2a8{right:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtonAndroid_6c79d2a8{left:24px}.reportAbuseDescription_6c79d2a8 .reportAbuseReportButtoniOS_6c79d2a8{font-size:14px;font-weight:600;font:-apple-system-subheadline;width:88px;height:52px;border-radius:8px;position:absolute}[dir='ltr'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtoniOS_6c79d2a8{right:24px}[dir='rtl'] .reportAbuseDescription_6c79d2a8 .reportAbuseReportButtoniOS_6c79d2a8{left:24px}.reportAbuseDescription_6c79d2a8 .codeOfConductLink_6c79d2a8:hover{text-decoration:underline}.reportAbuseDescription_6c79d2a8 .privacyStatementLink_6c79d2a8:hover{text-decoration:underline}.reportAbuseTextFieldWeb_6c79d2a8 .ms-TextField-fieldGroup{width:340px;margin-top:8px;margin-left:16px;border-radius:2px;height:72px}.reportAbuseTextFieldAndroid_6c79d2a8 .ms-TextField-fieldGroup{width:340px;margin-top:8px;border-radius:4px;height:72px}.reportAbuseTextFieldiOS_6c79d2a8 .ms-TextField-fieldGroup{width:340px;margin-top:8px;margin-left:16px;border-radius:4px;height:72px}.reportAbuseTextFieldiOS_6c79d2a8 .ms-TextField-field{font-size:14px;font-weight:400;font:-apple-system-footnote}.reportAbuseCopyRightText_6c79d2a8{width:336px;margin-top:8px}.reportAbuseCopyRightLink_6c79d2a8::-moz-focus-inner{border:0}.reportAbuseCopyRightLink_6c79d2a8{outline:transparent}.reportAbuseCopyRightLink_6c79d2a8{position:relative}.ms-Fabric--isFocusVisible .reportAbuseCopyRightLink_6c79d2a8:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}.reportAbuseCopyRightLink_6c79d2a8:hover{text-decoration:underline}\n"},{"rawString":".reportAbuseActivityIndicator_5341a7f5{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2}\n"},{"rawString":".reportAbuseSentDescription_9a753041{font-size:14px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";width:400px}.reportAbuseSentDescription_9a753041 .reportAbuseSentTextLabel_9a753041{font-size:14px;font-weight:400;font:-apple-system-footnote;padding-top:0px;margin-left:24px;margin-right:24px;margin-bottom:24px;text-align:justify}.reportAbuseSentDescription_9a753041 .reportAbuseSentHeaderLabelWeb_9a753041{font-size:21px;font-weight:600;margin-top:16px;margin-bottom:16px;padding-top:5px;padding-bottom:5px;text-align:center}.reportAbuseSentDescription_9a753041 .reportAbuseSentHeaderLabelAndroid_9a753041{font-size:21px;font-weight:600;margin-top:20px;margin-bottom:20px;text-align:center}.reportAbuseSentDescription_9a753041 .reportAbuseSentHeaderLabeliOS_9a753041{font-size:21px;font-weight:600;font:-apple-system-headline;margin-top:16px;margin-bottom:16px;text-align:center}.reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonWeb_9a753041{font-size:14px;font-weight:600;width:98px;border-radius:2px;position:absolute}[dir='ltr'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonWeb_9a753041{right:24px}[dir='rtl'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonWeb_9a753041{left:24px}.reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonAndroid_9a753041{font-size:14px;font-weight:600;width:65px;height:36px;border-radius:2px;position:absolute}[dir='ltr'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonAndroid_9a753041{right:24px}[dir='rtl'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtonAndroid_9a753041{left:24px}.reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtoniOS_9a753041{font-size:14px;font-weight:600;font:-apple-system-subheadline;width:77px;height:52px;border-radius:8px;position:absolute}[dir='ltr'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtoniOS_9a753041{right:24px}[dir='rtl'] .reportAbuseSentDescription_9a753041 .reportAbuseSentReportButtoniOS_9a753041{left:24px}.reportAbuseSentDescription_9a753041 .codeOfConductLink_9a753041:hover{text-decoration:underline}\n"},{"rawString":".reportAbuseErrorBar_7d354d2d{position:relative;background-color:"},{"theme":"errorBackground","defaultValue":"#FDE7E9"},{"rawString":";height:48px;width:400px}.reportAbuseErrorBar_7d354d2d .reportAbuseErrorIcon_7d354d2d{position:absolute;font-size:16px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";height:16px;width:16px;top:16px}[dir='ltr'] .reportAbuseErrorBar_7d354d2d .reportAbuseErrorIcon_7d354d2d{left:8px}[dir='rtl'] .reportAbuseErrorBar_7d354d2d .reportAbuseErrorIcon_7d354d2d{right:8px}.reportAbuseErrorBar_7d354d2d .reportAbuseErrorText_7d354d2d{position:absolute;font-family:\"Segoe UI\",-apple-system,BlinkMacSystemFont,\"Roboto\",\"Helvetica Neue\",sans-serif;font-size:12px;font-weight:400;font:-apple-system-footnote;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";white-space:nowrap;text-overflow:ellipsis;overflow:hidden;width:100%;line-height:48px;padding:0}[dir='ltr'] .reportAbuseErrorBar_7d354d2d .reportAbuseErrorText_7d354d2d{left:32px}[dir='rtl'] .reportAbuseErrorBar_7d354d2d .reportAbuseErrorText_7d354d2d{right:32px}\n"},{"rawString":".reportAbuseClass_d8ba35eb{left:0;top:0;position:absolute;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.reportAbuseDialog_d8ba35eb{height:695px;width:400px;position:relative;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.reportAbuseDialog_d8ba35eb.blocker_d8ba35eb{position:relative}.reportAbuseDialog_d8ba35eb.blocker_d8ba35eb:after{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.95}.reportAbuseErrorDialog_d8ba35eb{position:relative;height:743px;width:400px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.reportAbuseSentDialog_d8ba35eb{position:relative;height:339px;width:400px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}\n"},{"rawString":".od-Dialog{overflow-y:auto}.od-create-reportAbuse-newFlow .od-Dialog{overflow-y:auto}.od-create-reportAbuse-newFlow.od-Dialog-main{width:unset}.od-create-reportAbuse-newFlow .isFluent .od-Dialog-inner{padding:0}.od-create-reportAbuse-newFlow .od-Dialog-inner{padding:0}.od-create-reportAbuse-newFlow .od-Dialog-header{display:none}.od-create-reportAbuse-newFlow .od-Dialog-button--close{visibility:hidden}.ms-reportAbuseDialog-option{margin-top:10px}.ms-reportAbuseDialog-text-header{margin-top:15px}.ms-reportAbuseDialog-text-area{margin-top:5px;width:80%;height:40px;resize:none}"},{"rawString":".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}"},{"rawString":".od-operationMonitor-ShareLink{padding:16px 0}.od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{display:flex;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}[dir=ltr] .od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{margin-left:auto}[dir=rtl] .od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{margin-right:auto}"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:12px}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}[dir='ltr'] .od-confirmationDialog-discard{float:left}[dir='rtl'] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0px 4px}[dir='ltr'] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir='rtl'] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-bottom-width:1px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}[dir='ltr'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:48px}[dir='rtl'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:48px}.od-ShareHeader-linkSettings{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:17px;font-weight:700}[dir='ltr'] .od-ShareHeader-linkSettings{margin-left:20px}[dir='rtl'] .od-ShareHeader-linkSettings{margin-right:20px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-left{padding-left:8px}[dir='rtl'] .od-ShareHeader-buttons-left{padding-right:8px}[dir='ltr'] .od-ShareHeader-buttons-left{left:0}[dir='rtl'] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right{right:0}[dir='rtl'] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-moreOptionsIcon{font-size:16px}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){background:none;border:none;padding:0px;width:30px;cursor:pointer;font:-apple-system-body}:global(.ms-Fabric .od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{border-color:ActiveBorder}}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:16px}.od-ShareHeader-title{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.isFluent .od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline;margin:0px 32px 0px 32px}[dir='rtl'] .od-ShareHeader-viewName{margin:0px 32px 0px 32px}.isFluent .od-ShareHeader-viewName{margin:0px 32px 0px 0px;font-size:20px;font-weight:600;margin-bottom:4px}[dir='rtl'] .isFluent .od-ShareHeader-viewName{margin:0px 0px 0px 32px}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}.isFluent .od-ShareHeader-itemName{text-align:initial;font-size:12px}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button{outline:1px solid "},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";padding:5px 4px 4px 4px;font-size:12px}.od-InfoButton-button{background:none;border:none;padding:0}.od-InfoButton-content{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDescription{-webkit-box-align:top;-ms-flex-align:top;align-items:top;display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px 0px 2px 0px;width:100%}.isFluent .od-ShareLinkDescription{padding:4px 0}.od-ShareLinkDescription-label{font-size:14px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;width:80%;padding-top:2px}[dir='ltr'] .od-ShareLinkDescription-label{margin-left:8px}[dir='rtl'] .od-ShareLinkDescription-label{margin-right:8px}[dir='ltr'] .od-ShareLinkDescription-label{text-align:left}[dir='rtl'] .od-ShareLinkDescription-label{text-align:right}.isFluent .od-ShareLinkDescription-label{padding-top:0;position:relative;top:2px}.od-ShareLinkDescription-image{width:16px;height:16px}.od-ShareLinkDescription-icon{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:1px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;height:24px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:24px}.isFluent .od-ShareLinkDescription-icon{font-size:14px}.od-ShareLinkDescription-icon .ms-Icon{font-size:14px}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#F2F2F2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004E8C;background:#F0F5F8;border:1px solid #004E8C}.od-ShareLinkDescription-icon.icon-Chat{color:#6264A7;background:#F6F6FA;border:1px solid #6264A7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":";background:#F0F5F7;border:1px solid "},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}.od-ShareLinkDescription-icon.icon-Globe{color:#0B6A0B;background:#F1F6F1;border:1px solid #0B6A0B}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8E562E;background:#F4EFEB;border:1px solid #8E562E}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":";position:relative;display:inline-block;border-radius:50%;width:24px;height:24px;border:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}[dir='ltr'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir='rtl'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-AudienceChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";font-weight:600}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:16px;margin-top:8px}[dir='ltr'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;margin-top:10px}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#A19F9D}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#A19F9D;background-color:#FAFAF9;border-color:#A19F9D}@media screen and (-ms-high-contrast: active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":" inset;box-shadow:0 0 0 1px "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir='ltr'] .od-AudienceChoiceGroup-description{float:left}[dir='rtl'] .od-AudienceChoiceGroup-description{float:right}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:32px}.od-ExpirationDatePicker-content{border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-ExpirationDatePicker-content{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content:hover,.od-ExpirationDatePicker-content-expired:hover{border-bottom-color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";cursor:pointer}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:28px;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-right:14px}[dir='rtl'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-left:14px}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:transparent}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content .ms-TextField-errorMessage,.od-ExpirationDatePicker-content-expired .ms-TextField-errorMessage{display:none}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:20px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}[dir='ltr'] .od-ExpirationDatePicker-label{margin-right:8px}[dir='rtl'] .od-ExpirationDatePicker-label{margin-left:8px}.isFluent .od-ExpirationDatePicker-label{font-size:16px}[dir='ltr'] .isFluent .od-ExpirationDatePicker-label{margin-right:12px}[dir='rtl'] .isFluent .od-ExpirationDatePicker-label{margin-left:12px}.od-ExpirationDatePicker-info{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ExpirationDatePicker-info{margin-left:auto}[dir='rtl'] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:12px}[dir='ltr'] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker-delete{background-color:transparent;background:none;border:none;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:16px;line-height:0px;padding:0px;height:16px}[dir='ltr'] .od-ExpirationDatePicker-delete{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-delete{margin-right:10px}:global(.ms-Fabric .od-ExpirationDatePicker-delete::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ExpirationDatePicker-delete{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ExpirationDatePicker-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ExpirationDatePicker-delete:focus:after{border-color:ActiveBorder}}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ExpirationDatePicker-expired{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-ExpirationDatePicker-content-expired{border-bottom:1px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-ExpirationDatePicker-premiumGleam{height:12px;margin-top:2px;color:"},{"theme":"yellow","defaultValue":"#ffb900"},{"rawString":"}[dir='ltr'] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir='rtl'] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}:global(.ms-Fabric .od-ExpirationDatePicker-delete::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ExpirationDatePicker-tooltipWrapper:focus:after{border-color:ActiveBorder}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .od-PasswordStrengthMeter{padding-left:6px}[dir='rtl'] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{"theme":"orangeLight","defaultValue":"#ea4300"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:32px;width:100%;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-PasswordField .od-ShareLink-passwordFieldContent{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-PasswordField .ms-PasswordField .ms-TextField input::-webkit-input-placeholder{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-moz-placeholder{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-ms-input-placeholder{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:28px;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:transparent}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:28px;min-width:0;width:100%;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-PasswordField .ms-Icon{font-size:20px;display:inline-block;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";margin-top:4px}.od-PasswordField-delete{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;background:none;border:none;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:16px;line-height:0px;padding:0px}[dir='ltr'] .od-PasswordField-delete{margin-left:auto}[dir='rtl'] .od-PasswordField-delete{margin-right:auto}.od-PasswordField-label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:7px}[dir='ltr'] .od-PasswordField-label{margin-right:8px}[dir='rtl'] .od-PasswordField-label{margin-left:8px}.isFluent .od-PasswordField-label{font-size:16px}[dir='ltr'] .isFluent .od-PasswordField-label{margin-right:12px}[dir='rtl'] .isFluent .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:12px}[dir='ltr'] .od-PasswordField-shareReminder{padding-left:22px}[dir='rtl'] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:12px}[dir='ltr'] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir='rtl'] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PermissionsSettings-delete{background-color:transparent;background:none;border:none;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:16px;line-height:0px;padding:0px}:global(.ms-Fabric .od-PermissionsSettings-delete::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-PermissionsSettings-delete{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-delete:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-PermissionsSettings-delete{margin-left:auto}[dir='rtl'] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:12px;margin-top:12px;color:"},{"theme":"yellow","defaultValue":"#ffb900"},{"rawString":"}[dir='ltr'] .od-PasswordField-premiumGleam{padding-right:5px}[dir='rtl'] .od-PasswordField-premiumGleam{padding-left:5px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink .od-ShareLink-main{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:12px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";min-width:54px;margin:0;padding:0}:global(.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-left:0px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}[dir='rtl'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-right:0px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-ShareLink-icon{position:relative;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:25px;border-radius:50%;width:50px;min-width:50px;height:50px}[dir='ltr'] .od-ShareLink-icon{margin-right:10px}[dir='rtl'] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon i{left:50%}[dir='rtl'] .od-ShareLink-icon i{right:50%}[dir='ltr'] .od-ShareLink-icon i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2{position:relative;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:17px;border-style:solid;border-width:1px;border-radius:50%;-webkit-box-sizing:border-box;box-sizing:border-box;width:32px;min-width:32px;height:32px}[dir='ltr'] .od-ShareLink-icon2{margin-right:10px}[dir='rtl'] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon2 i{left:50%}[dir='rtl'] .od-ShareLink-icon2 i{right:50%}[dir='ltr'] .od-ShareLink-icon2 i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon2 i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2.icon-Globe{color:#0B6A0B;background:#F1F6F1;border:1px solid #0B6A0B}.od-ShareLink-icon2.icon-Chat{color:#6264A7;background:#F6F6FA;border:1px solid #6264A7}.od-ShareLink-icon2.icon-Mail{color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":";background:#F0F5F7;border:1px solid "},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}.od-ShareLink-icon2.icon-Work{color:#004E8C;background:#F0F5F8;border:1px solid #004E8C}.od-ShareLink-icon2.icon-FileRequest{color:#333333;background:white;border:white;font-size:20px}.od-ShareLink-icon2.icon-PeopleAdd{color:#393939;background:#F2F2F2;border:1px solid #393939}.od-ShareLink-icon2.icon-SecurityGroup{color:#8E562E;background:#F4EFEB;border:1px solid #8E562E}.od-ShareLink-details{-webkit-box-flex:1;-ms-flex:1;flex:1}.od-ShareLink-actionButton{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}:global(.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLink-actionButton{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLink-actionButton:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLink-actionButton:focus:after{border-color:ActiveBorder}}.od-ShareLink-description{padding-top:8px;font-size:12px}[dir='ltr'] .od-ShareLink-description{padding-left:42px}[dir='rtl'] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir='ltr'] .od-ShareLink-description.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink-description.flightOff{padding-right:60px}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:11px}[dir='ltr'] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir='rtl'] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}.od-ShareLink--inviteesHolder{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-left:42px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-right:42px}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-right:38px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-left:38px}:global(.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLink--inviteesHolder{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLink--inviteesHolder:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLink--inviteesHolder:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:12px;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:12px}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:'';background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";display:block;height:7px}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink-personaItem{padding:18px 8px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:15px;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:11px;color:#605e5c;font:-apple-system-caption1}.od-ShareLink-personaItem .ms-Button-icon{font-size:12px}:global(.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLink-personaItem .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}:global(.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLink-linkMember{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLink-linkMember:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLink-linkMember:focus:after{border-color:ActiveBorder}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelector-wrapper{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.od-RoleSelector-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir='ltr'] .od-RoleSelector-wrapper .ms-TooltipHost{right:0}[dir='rtl'] .od-RoleSelector-wrapper .ms-TooltipHost{left:0}.od-RoleSelector-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0;height:auto}[dir='ltr'] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir='rtl'] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelector-rolesDropdown{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-RoleSelector-rolesDropdown .ms-Dropdown-title{border-top:none;border-left:none;border-right:none;border-radius:0px;border-bottom-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelector-rolesDropdown .ms-Dropdown:focus::after{border-top:none;border-left:none;border-right:none;border-radius:0px;border-bottom:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-RoleSelector-rolesDropdown:hover,.od-RoleSelector-rolesDropdown.is-open{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-RoleSelector-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelector-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir='rtl'] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelector-roleDropdownOption{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:8px 0px}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent .od-RoleSelector-roleDropdownOptionText{font-weight:600}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{font-size:12px;line-height:1.3}[dir='ltr'] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:left}[dir='rtl'] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:right}.od-RoleSelector-settingIcon{font-size:17px}[dir='ltr'] .od-RoleSelector-settingIcon{padding-left:8px}[dir='rtl'] .od-RoleSelector-settingIcon{padding-right:8px}[dir='ltr'] .od-RoleSelector-settingIcon{padding-right:12px}[dir='rtl'] .od-RoleSelector-settingIcon{padding-left:12px}.isFluent .od-RoleSelector-settingIcon{font-size:16px}[dir='ltr'] .isFluent .od-RoleSelector-settingIcon{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelector-settingIcon{padding-right:0}\n"},{"rawString":".ms-PickerPersona-container{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"focusBorder","defaultValue":"#605e5c"},{"rawString":"}.ms-PickerPersona-container:hover{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-PickerPersona-container.is-selected{background:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.ms-PickerPersona-container.is-selected:hover{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-webkit-box-flex:1;-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077B5}.itemContent_f52f5396{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_f52f5396{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.peoplePickerClose_f52f5396{border-radius:12px;height:24px;width:24px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.peoplePickerClose_f52f5396:hover{background:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";border-radius:12px}\n"},{"rawString":".ms-Suggestions{width:260px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PeoplePicker-wrapper{max-height:150px;overflow-y:auto}.od-Share-PeoplePicker-wrapper#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0px;border-bottom:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:13px;font-weight:400;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir='ltr'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir='rtl'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-top:3px}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-error{font-size:12px;font-weight:400;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir='ltr'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir='rtl'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;-webkit-box-sizing:border-box;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir='rtl'] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";background-color:RGBA("},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":", 0.06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast: active){.ms-Button.is-suggested .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast: active){.ms-Button:hover .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:6px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:12px}[dir='ltr'] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}:global(.ms-Fabric .od-preventDownload-tooltipWrapper::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-preventDownload-tooltipWrapper{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-preventDownload-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-preventDownload-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-OfficeReviewModeToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-OfficeReviewModeToggle .ms-Toggle{width:100%}.od-OfficeReviewModeToggle .ms-Toggle-slider{position:absolute;top:6px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:left}.od-OfficeReviewModeToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-OfficeReviewModeToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-OfficeReviewModeToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:left}.od-OfficeReviewModeToggle-learnMore{text-decoration:none;margin:0px 3px;white-space:nowrap;font:-apple-system-caption2}:global(.ms-Fabric .od-OfficeReviewModeToggle-learnMore::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-OfficeReviewModeToggle-learnMore{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-OfficeReviewModeToggle-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-OfficeReviewModeToggle-learnMore:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-tooltip .ms-Icon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:12px}[dir='ltr'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-right:10px}:global(.ms-Fabric .od-OfficeReviewModeToggle-learnMore::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-OfficeReviewMode-tooltipWrapper{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-OfficeReviewMode-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-OfficeReviewMode-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-LinkTemplateChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-LinkTemplateChoiceGroup-row{padding-right:0}.teams .od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{font-weight:700}.od-LinkTemplateChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-LinkTemplateChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-LinkTemplateChoiceGroup-row .od-ShareHintDetail{padding-top:2px}.od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";font-weight:600}.od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:16px;margin-top:8px}[dir='ltr'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;margin-top:10px}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareHintDetail-statusText{color:#A19F9D}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#A19F9D;background-color:#FAFAF9;border-color:#A19F9D}@media screen and (-ms-high-contrast: active){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric.is-focusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":" inset;box-shadow:0 0 0 1px "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric.is-focusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric.is-focusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.teams .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.od-LinkTemplateChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir='ltr'] .od-LinkTemplateChoiceGroup-description{float:left}[dir='rtl'] .od-LinkTemplateChoiceGroup-description{float:right}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:20px;height:20px}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:16px;line-height:20px;width:20px}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:20px}.od-PermissionsSettings-description{padding-bottom:10px;font-size:12px;font:-apple-system-caption2}[dir='ltr'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-right:3px}[dir='rtl'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-left:3px}.isFluent .od-PermissionsSettings-description{padding-bottom:8px;font-size:14px;font-weight:600}.od-PermissionsSettings-linksFromTemplateHeader{font-weight:400}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:14px}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none}:global(.ms-Fabric .od-PermissionsSetting-specificPeople-list a::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-PermissionsSetting-specificPeople-list a{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-PermissionsSetting-specificPeople-list a:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-PermissionsSetting-specificPeople-list a:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-PermissionsSettings-bottomBorder{border-bottom:0}.teams .od-PermissionsSettings-bottomBorder{border:0}.teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{margin:0}[dir='ltr'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-left:20px}[dir='rtl'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-right:20px}.od-PermissionsSettings-setting{margin-bottom:8px}.isFluent .od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:12px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}[dir='ltr'] .od-PermissionsSettings-prompt{padding-right:.25em}[dir='rtl'] .od-PermissionsSettings-prompt{padding-left:.25em}.od-PermissionsSettings-learnMore{text-decoration:none;white-space:nowrap;font:-apple-system-caption2}:global(.ms-Fabric .od-PermissionsSetting-specificPeople-list a::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-PermissionsSettings-learnMore{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-learnMore:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir='ltr'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir='rtl'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:32px}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--PreventDownload-Icon{font-size:16px}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--OfficeReviewMode{width:100%;height:32px}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-left:0}.od-PermissionsSettings-setting--OfficeReviewMode-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--OfficeReviewMode-Icon{font-size:16px}.od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%}:global(.ms-Fabric .od-PermissionsSetting-specificPeople-list a::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-PermissionsSettings-wrapper{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-wrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-PermissionsSettings-wrapper:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:300px}.od-PermissionsSettings-teachingBubbleIcon{font-size:24px;position:absolute;top:25px;z-index:1}[dir='ltr'] .od-PermissionsSettings-teachingBubbleIcon{padding-left:5px}[dir='rtl'] .od-PermissionsSettings-teachingBubbleIcon{padding-right:5px}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:50px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}[dir='ltr'] .teams .od-ModifyPermissions{margin-right:32px}[dir='rtl'] .teams .od-ModifyPermissions{margin-left:32px}[dir='ltr'] .teams .od-ModifyPermissions{margin-left:12px}[dir='rtl'] .teams .od-ModifyPermissions{margin-right:12px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}#od-ModifyPermissions-actions-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir='ltr'] .teams .od-ModifyPermissions-actions{padding-right:0}[dir='rtl'] .teams .od-ModifyPermissions-actions{padding-left:0}.od-ModifyPermissions-section{padding:20px 0px 0 0px}.isFluent .od-ModifyPermissions-section{padding:0}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0px 20px 0px 20px}.isFluent .od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir='rtl'] .isFluent .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir='ltr'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir='rtl'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:12px;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusUnhealthyText{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusUnhealthyText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusUnhealthyText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir='ltr'] .od-ShareHintDetail-statusDetails{right:-36px}[dir='rtl'] .od-ShareHintDetail-statusDetails{left:-36px}[dir='ltr'] .od-ShareHintDetail-statusDetails{text-align:right}[dir='rtl'] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:12px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:10px}[dir='ltr'] .od-ShareHintDetail-item{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-ShareHintDetail-item-expired{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}[dir='ltr'] .od-ShareHintDetail-description{text-align:left}[dir='rtl'] .od-ShareHintDetail-description{text-align:right}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHint{background:none;margin:16px 16px 0px 16px;position:relative}.isFluent .od-ShareHint{margin:0 16px}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:16px}.od-ShareHint .ms-Label{font-size:12px;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:10px;padding-top:9px;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:14px;font-weight:400;background:none;border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";padding:10px;margin:0;opacity:0;-webkit-transition:opacity 200ms;transition:opacity 200ms}@media screen and (-ms-high-contrast: active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.isFluent .od-ShareHint .od-ShareHint-data{border-radius:2px}:global(.ms-Fabric .od-ShareHint .od-ShareHint-data::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareHint .od-ShareHint-data{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareHint .od-ShareHint-data:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareHint .od-ShareHint-data:focus:after{border-color:ActiveBorder}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:10px;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.od-ShareHint-darkBorder{border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:2px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint--clickable:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";padding:14px 10px;background:-webkit-gradient(linear, left top, right top, from("},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"), color-stop(50%, "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"), to("},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"));background:linear-gradient(to right, "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":" 0%, "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":" 50%, "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":" 100%);background-size:90% 100%;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";background-clip:content-box;background-repeat:no-repeat;-webkit-animation:2s ease-in-out infinite placeholderShimmer;animation:2s ease-in-out infinite placeholderShimmer;-webkit-transition:opacity 200ms, visibility 200ms;transition:opacity 200ms, visibility 200ms}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:36px;height:24px}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:24px;border-bottom:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-top:4px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-sizing:border-box;box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:white}@-webkit-keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;-webkit-transform:translateX(-50%) scale(0.5, 0.5);transform:translateX(-50%) scale(0.5, 0.5);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;background-color:#599B00;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:21px;border-radius:50%;width:44px;height:44px;-webkit-animation:bounce 0.45s;animation:bounce 0.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:44px}.isFluent .od-ShareNotification-icon{background-color:#498205}.od-ShareNotification-content{width:90%}[dir='ltr'] .od-ShareNotification-content{padding-left:16px}[dir='rtl'] .od-ShareNotification-content{padding-right:16px}[dir='ltr'] .od-ShareNotification-content{padding-right:16px}[dir='rtl'] .od-ShareNotification-content{padding-left:16px}.isFluent .od-ShareNotification-content .ms-font-l{font-weight:500}.od-ShareNotification-content-tooltip{margin:5px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-webkit-box;display:-ms-flexbox;display:flex}.isFluent .od-ShareNotification-urlText{padding:12px 0}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir='ltr'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir='rtl'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:32px}.od-ShareNotification-close{position:absolute;top:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:12px;width:12px;height:12px;cursor:pointer}[dir='ltr'] .od-ShareNotification-close{right:12px}[dir='rtl'] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}@-webkit-keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0px 0px 0px;padding:16px;border:none;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-ShareNotification .od-ShareHint{border-top:0;margin:0}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:12px;font-weight:400}.od-ShareNotification-copyButton{height:32px;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}[dir='ltr'] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir='rtl'] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:17px;font-weight:300;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";margin:0px 8px 24px 8px;text-align:left}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";width:100%;height:100%;padding:0 20px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400;margin:10px -20px 0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:relative}[dir='ltr'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:22px 0 12px;margin-bottom:50px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--absolute{position:absolute}.od-ShareLinkDetails--settingIcon{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}[dir='ltr'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0px}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{font-size:12px}:global(.ms-Fabric .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:12px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";display:block}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:-webkit-box;display:-ms-flexbox;display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:17px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:none;border:none;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:12px;line-height:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:12px;font-style:italic;margin-top:-5px;padding:0}[dir='ltr'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";font-size:14px}.od-ShareLinkDetails--sectionHeader .ms-Button:not(:hover){background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.od-ShareLinkDetails--sectionHeader .ms-Button:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400}[dir='ltr'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-negative:0;flex-shrink:0;margin-top:auto;height:56px;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";margin:10px -20px 0}[dir='ltr'] .od-ShareLinkDetails--actions{padding-right:35px}[dir='rtl'] .od-ShareLinkDetails--actions{padding-left:35px}:global(.ms-Fabric .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareLinkDetails--actions .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir='rtl'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button--primary::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button:focus::after{left:-2px;right:-2px;top:-2px;bottom:-2px}}.od-ShareLinkDetails--noParticipants{font-size:12px;padding-top:20px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";min-height:50px}.od-ShareLinkDetails-addressBarChoiceGroup{padding-top:10px}.od-ShareLinkDetails-addressBarChoiceGroupLabel{font-weight:600;font-size:12px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-webkit-box;display:-ms-flexbox;display:flex;outline:none}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir='ltr'] .od-SharePrincipal-persona{margin-right:8px}[dir='rtl'] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{cursor:pointer;background:none;border:none;padding:0}:global(.ms-Fabric .od-SharePrincipal-permissions::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-SharePrincipal-permissions{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-SharePrincipal-permissions:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-SharePrincipal-permissions:focus:after{border-color:ActiveBorder}}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}[dir='ltr'] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir='ltr'] .od-SharePrincipal-deleteIcon{right:8px}[dir='rtl'] .od-SharePrincipal-deleteIcon{left:8px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:#605e5c}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:12px;min-height:36px}.od-PermissionsList-header{position:relative}.od-PermissionsList-inheritance{margin:16px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0px 5px}.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:12px}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0}[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}.od-ShareLinkDetails--sectionHeader .ms-Button{height:32px}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0px}:global(.ms-Fabric .od-PermissionsList-principalGroup::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-PermissionsList-principalGroup{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-PermissionsList-principalGroup:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-PermissionsList-principalGroup:focus:after{border-color:ActiveBorder}}.od-PermissionsList-addressBarDescription{display:inline-block;padding-top:20px;font-size:12px}.od-AddressBarLinkHint{padding-top:20px;padding-bottom:24px}.isFluent .od-AddressBarLinkHint .od-ShareHint{margin:0}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-permissionButton:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:disabled{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:transparent}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:disabled{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-SendLink-message{margin-top:16px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:12px;font-weight:400;font:-apple-system-footnote}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-webkit-input-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-moz-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-ms-input-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-message-roleSelector{margin-top:12px}.od-SendLink-message-roleSelector .ms-TextField.ms-TextField--multiline{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:2px;padding-top:1px;padding-bottom:1px;margin-bottom:12px}[dir='ltr'] .od-SendLink-message-roleSelector .ms-TextField.ms-TextField--multiline{padding-right:1px}[dir='rtl'] .od-SendLink-message-roleSelector .ms-TextField.ms-TextField--multiline{padding-left:1px}[dir='ltr'] .od-SendLink-message-roleSelector .ms-TextField-fieldGroup{padding-left:8px}[dir='rtl'] .od-SendLink-message-roleSelector .ms-TextField-fieldGroup{padding-right:8px}[dir='ltr'] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-left:5px}[dir='rtl'] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-right:5px}.od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-fieldGroup{margin-bottom:16px}.od-SendLink-message-no-border .ms-TextField.ms-TextField--multiline div{border-color:transparent}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir='ltr'] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir='rtl'] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir='ltr'] .od-SendLink-ITPolicy{right:0}[dir='rtl'] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons{float:right}[dir='rtl'] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir='ltr'] .od-SendLink-emailButtons-allCaps{float:right}[dir='rtl'] .od-SendLink-emailButtons-allCaps{float:left}.od-SendLink-emailButtons-left{font:-apple-system-headline}[dir='ltr'] .isFluent .od-SendLink-emailButtons-left{text-align:right}[dir='rtl'] .isFluent .od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons-rounded{float:right}[dir='rtl'] .od-SendLink-emailButtons-rounded{float:left}.od-SendLink-emailButtons-rounded .ms-Button{font:-apple-system-headline;border-radius:8px;height:54px}[dir='ltr'] .od-SendLink-emailButtons-roleSelector{float:right}[dir='rtl'] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding-bottom:30px;font-size:12px}[dir='ltr'] .od-SendLink-email .ms-TextField-field{padding-left:0px}[dir='rtl'] .od-SendLink-email .ms-TextField-field{padding-right:0px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-footnote}.isFluent .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-webkit-input-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-moz-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-ms-input-placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .od-SendLink-sendContainer{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir='ltr'] .od-SendLink-characterCounter{float:right}[dir='rtl'] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.od-SendLink-peoplePicker{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;width:100%}.od-SendLink-peoplePicker-experiment{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:2px;padding-top:1px;padding-bottom:1px}.od-SendLink-peoplePicker-experiment .ms-BasePicker-text{border:none}.od-SendLink-peoplePicker-experiment .ms-BasePicker-input{height:28px}[dir='ltr'] .od-SendLink-peoplePicker-experiment .ms-BasePicker-input{padding-left:8px}[dir='rtl'] .od-SendLink-peoplePicker-experiment .ms-BasePicker-input{padding-right:8px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir='ltr'] .od-ShareTargets-items{margin-right:-10px}[dir='rtl'] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir='ltr'] .od-ShareTargets-item{margin-right:10px}[dir='rtl'] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-radius:50%;color:"},{"theme":"neutralPrimaryAlt","defaultValue":"#3b3a39"},{"rawString":";cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.isFluent .od-ShareTargets-itemImage{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.isFluent .od-ShareTargets-icon{font-size:26px}.od-ShareTargets-itemImage--border{border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-ShareTargets-itemText{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font:-apple-system-short-caption2}.isFluent .od-ShareTargets-itemText{font-size:10px}.od-ShareTargets-target{background:none;border:none}:global(.ms-Fabric .od-ShareTargets-target::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareTargets-target{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareTargets-target:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareTargets-target:focus:after{border-color:ActiveBorder}}.od-ShareTargets-disabled{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}@media screen and (-ms-high-contrast: active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:1px solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:2px solid highlight}}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.8}.od-ShareMain-section{padding:20px 16px 0px 16px}.isFluent .od-ShareMain-section{padding:16px 16px 0}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.od-ShareMain-section-experimental{padding:12px 16px 0 16px}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";cursor:pointer;border:none;border-top:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";font:-apple-system-subheadline;bottom:0}:global(.ms-Fabric .od-ShareMain-footer::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-ShareMain-footer{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-ShareMain-footer:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-ShareMain-footer:focus:after{border-color:ActiveBorder}}.ms-Fabric .od-ShareMain-footer{position:fixed}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir='ltr'] .od-ShareMain-attachIcon{margin-right:4px}[dir='rtl'] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}\n"},{"rawString":".od-PolicyTip-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:"},{"theme":"xLargeFontSize","defaultValue":"20px"},{"rawString":";font-weight:100;margin:0px 0px 8px 0px}.od-PolicyTip-description{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0px}.od-PolicyTip-blockedIcon{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{"theme":"largeFontSize","defaultValue":"18px"},{"rawString":";font-weight:300;font-weight:600}[dir='ltr'] .od-PolicyTip-headerText{margin-left:12px}[dir='rtl'] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:400;margin-bottom:12px}[dir='ltr'] .od-PolicyTip-issue{margin-left:33px}[dir='rtl'] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-PolicyTip-learnMoreContainer{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir='rtl'] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir='ltr'] .od-PolicyTip-label{margin-left:4px}[dir='rtl'] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-PolicyTip-statusText{font-size:"},{"theme":"smallFontSize","defaultValue":"12px"},{"rawString":";font-weight:400}[dir='ltr'] .od-PolicyTip-statusText{margin-left:4px}[dir='rtl'] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{"theme":"largeFontSize","defaultValue":"18px"},{"rawString":";font-weight:300}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0px 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding-bottom:8px}[dir='ltr'] .od-AtMention li{padding-right:4px}[dir='rtl'] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";bottom:0;content:'';left:0;opacity:0.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;padding:16px 16px 0px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-radius:16px;font:-apple-system-body}.od-AtMention .od-AtMention-message{margin-bottom:16px;font:-apple-system-body}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:44px;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Notify{padding:0px 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.8}.od-Notify .ms-Checkbox-label{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-message{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:15px;padding:6px 0px 4px 0px;margin:0px 3px 0px 0px}[dir='rtl'] .od-Notify-message{margin:0px 0px 0px 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0px 0px auto}[dir='rtl'] .od-Notify-show-link{margin:8px auto 0px 0px}.od-Notify-sendNotification-button{margin:24px auto 6px 0px}[dir='ltr'] .od-Notify-sendNotification-button{text-align:right}[dir='rtl'] .od-Notify-sendNotification-button{text-align:left}[dir='rtl'] .od-Notify-sendNotification-button{margin:24px 0px 6px auto}.od-Notify-group-recipient{display:-webkit-box;display:-ms-flexbox;display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0px 0px 0px auto}[dir='rtl'] .od-Notify-PickerPersona-checkbox{margin:0px auto 0px 0px}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0px 10px 0px 0px;font-size:13px}[dir='rtl'] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0px 0px 0px 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,0.3)}[dir='ltr'] .od-Notify-recipientWarning{left:0}[dir='rtl'] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";padding:0px 0px 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";padding:6px 0px;margin:0px 0px 0px auto}[dir='ltr'] .od-Notify-totalMembersCount{text-align:right}[dir='rtl'] .od-Notify-totalMembersCount{text-align:left}[dir='rtl'] .od-Notify-totalMembersCount{margin:0px auto 0px 0px}.od-Notify-groups-expand{height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;margin:14px 0px 0px}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0px 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0px 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0px}.od-Notify-groupMembersCount{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:11px}[dir='ltr'] .od-Notify-groupMembersCount{margin-left:28px}[dir='rtl'] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;padding-bottom:12px}.od-AddPeople-Edit-Section{padding:0px 16px 0px 16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap}.od-AddPeople-Edit-Section .od-AddPeople-Edit-Section-PermissionAlert{margin-bottom:8px}.od-AddPeople-PeoplePicker{padding-bottom:12px}.od-AddPeople-Message{padding-bottom:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{padding:0}.od-AddPeople-RoleSelector{padding-bottom:12px}.od-AddPeople-NotificationSelector{-ms-flex-item-align:start;align-self:flex-start;padding-bottom:12px}.od-AddPeople-AddButton{-ms-flex-item-align:start;align-self:flex-start}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.8}.isFluent .od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-AddPeople-Success{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{margin-top:24px}.od-AddPeople-Failure{padding:24px 16px 0 16px}.od-AddPeople-NotAllowed{padding:0 16px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-error{padding:16px;font-size:14px;font-weight:400;word-break:break-word;margin-bottom:30px}:global(.ms-Fabric .od-Share-error::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-Share-error{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-Share-error:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-Share-error:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-Share-error-details{float:left}[dir='rtl'] .od-Share-error-details{float:right}.od-Share-error-copy{margin-top:10px}[dir='ltr'] .od-Share-error-copy{float:right}[dir='rtl'] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:50px}[dir='ltr'] .od-Share-error-report{float:right}[dir='rtl'] .od-Share-error-report{float:left}[dir='ltr'] .od-Share-error-report{margin-right:5px}[dir='rtl'] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:10px}[dir='ltr'] .od-Share-error-chevron{margin-left:5px}[dir='rtl'] .od-Share-error-chevron{margin-right:5px}.od-Share-error-technical{border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";padding:0 10px 10px 10px;margin-bottom:10px}[dir='rtl'] .od-Share-error-technical{padding:0 10px 10px 10px}\n"},{"rawString":".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share{background-color:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";min-width:320px;min-height:150px;overflow-y:auto;overflow-x:hidden}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:0.8}[dir='ltr'] .od-Share .ms-Button+.ms-Button{margin-left:6px}[dir='rtl'] .od-Share .ms-Button+.ms-Button{margin-right:6px}[dir='ltr'] .isFluent .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir='rtl'] .isFluent .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}.od-Share a:hover,.od-Share a:focus{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):focus{outline:1px solid}:global(.ms-Fabric .isFluent .od-Share .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .isFluent .od-Share .ms-Button--default{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .isFluent .od-Share .ms-Button--default:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}@media screen and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .isFluent .od-Share .ms-Button--default:focus:after{border-color:ActiveBorder}}@media screen and (-ms-high-contrast: active){.od-Share .ms-Button{overflow:visible}:global(.ms-Fabric .isFluent .od-Share .ms-Button--default::-moz-focus-inner){border:0}:global(.ms-Fabric) .od-Share .ms-Button{outline:transparent;position:relative}:global(.ms-Fabric.is-focusVisible) .od-Share .ms-Button:focus:after{content:'';position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){:global(.ms-Fabric.is-focusVisible) .od-Share .ms-Button:focus:after{border-color:ActiveBorder}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264A7;background:#F6F6FA;border:1px solid #6264A7}.od-Share.icon-Mail{color:"},{"theme":"teal","defaultValue":"#008272"},{"rawString":";background:#F0F5F7;border:1px solid "},{"theme":"teal","defaultValue":"#008272"},{"rawString":"}.od-Share .icon-Globe{color:#0B6A0B;background:#F1F6F1;border:1px solid #0B6A0B}.isFluent .od-Share .icon-Globe{color:#0b6a0b;border-color:#0b6a0b;background-color:#F1F6F1}.od-Share .icon-Work{color:#004E8C;background:#F0F5F8;border:1px solid #004E8C}.isFluent .od-Share .icon-Work{color:#004e8c;border-color:#004e8c;background-color:#F0F5F8}.od-Share .icon-PeopleAdd{color:#393939;background:#F2F2F2;border:1px solid #393939}.isFluent .od-Share .icon-PeopleAdd{color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e, 0.06)}.od-Share .icon-SecurityGroup{color:#8E562E;background:#F4EFEB;border:1px solid #8E562E}.isFluent .od-Share .icon-SecurityGroup{color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c, 0.06)}.od-Share .ms-Tooltip{pointer-events:none}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active){.od-Share{width:320px}}button.od-Share-backButton{background:none;border:none;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";cursor:pointer;font-size:16px;padding:0px;position:absolute;top:8px}[dir='ltr'] button.od-Share-backButton{left:10px}[dir='rtl'] button.od-Share-backButton{right:10px}.isFluent button.od-Share-backButton{top:12px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir='rtl'] button.od-Share-backButton{-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}button.od-Share-backButton:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-Share-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--primary,.teams .ms-Button.ms-Button--default{border-radius:3px;min-width:96px}.teams .ms-Button--default{-webkit-box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);border:1px solid rgba(37,36,36,0.15)}.teams .ms-Button--primary{-webkit-box-shadow:0 2px 2px 0 rgba(98,100,167,0.4);box-shadow:0 2px 2px 0 rgba(98,100,167,0.4)}.teams .ms-Button--primary.is-disabled{-webkit-box-shadow:none;box-shadow:none;border:none}\n"},{"rawString":".od-Notify-callout{min-height:68px;width:260px}.od-Notify-callout:focus{outline:0}.od-Notify-callout .od-Share{min-width:inherit;min-height:inherit;width:inherit;height:inherit}.od-Notify-callout .od-Share .od-Share-spinnerHolder{min-width:inherit;min-height:inherit;width:inherit;height:inherit}"},{"rawString":".OperationMonitor hr{border:none;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin:8px 0 16px 0}html[dir=rtl] .OperationMonitor hr{margin:8px 0 16px 0}.isFluent .od-Panel-content .OperationMonitor-group>.OperationMonitor-item{margin-bottom:42px}.OperationMonitor-group:not(:last-child){padding-bottom:32px}.OperationMonitor-items .OperationMonitor-item:not(:last-child){margin-bottom:16px}.OperationMonitor-item{padding:0 40px 0 0}html[dir=rtl] .OperationMonitor-item{padding:0 0 0 40px}.isFluent .OperationMonitor-item{padding:0 28px 0 0}html[dir=rtl] .isFluent .OperationMonitor-item{padding:0 0 0 28px}.OperationMonitor-item--icon .OperationMonitor-itemType{display:block}[dir=ltr] .OperationMonitor-item--icon{padding-left:56px}[dir=rtl] .OperationMonitor-item--icon{padding-right:56px}[dir=ltr] .isFluent .OperationMonitor-item--icon{padding-left:40px}[dir=rtl] .isFluent .OperationMonitor-item--icon{padding-right:40px}.OperationMonitor-itemName{font-size:14px;font-weight:400;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding-top:4px;line-height:20px}.OperationMonitor-itemProgress{padding:8px 0}.OperationMonitor-itemDescription{font-size:14px;font-weight:400;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";font-size:11px;line-height:18px}.isFluent .OperationMonitor-itemDescription{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.OperationMonitor-item--failed .OperationMonitor-itemDescription{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";font-size:11px;word-wrap:break-word}.OperationMonitor-itemWarning{font-size:14px;font-weight:400;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";font-size:11px;line-height:18px;background-color:"},{"theme":"warningBackground","defaultValue":"#fff4ce"},{"rawString":";display:flex;padding:8px}.isFluent .OperationMonitor-itemWarning{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .OperationMonitor-itemWarning-text{padding-left:8px}[dir=rtl] .OperationMonitor-itemWarning-text{padding-right:8px}.OperationMonitor-itemType{display:none;width:48px;height:48px;text-align:center;box-sizing:border-box;overflow:hidden;line-height:48px;margin-top:8px}html[dir=ltr] .OperationMonitor-itemType{float:left}html[dir=rtl] .OperationMonitor-itemType{float:right}[dir=ltr] .OperationMonitor-itemType{margin-left:-56px}[dir=rtl] .OperationMonitor-itemType{margin-right:-56px}.isFluent .OperationMonitor-itemType{width:32px;height:32px;line-height:32px}[dir=ltr] .isFluent .OperationMonitor-itemType{margin-left:-40px}[dir=rtl] .isFluent .OperationMonitor-itemType{margin-right:-40px}.OperationMonitor-item-DescOnly div.OperationMonitor-itemType{margin-top:0}.OperationMonitor-item:after{display:table;width:100%;content:'';clear:both}.OperationMonitor-itemIconActions{width:32px}html[dir=ltr] .OperationMonitor-itemIconActions{float:right}html[dir=rtl] .OperationMonitor-itemIconActions{float:left}[dir=ltr] .OperationMonitor-itemIconActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemIconActions{margin-left:-40px}[dir=ltr] .isFluent .OperationMonitor-itemIconActions{margin-right:-36px}[dir=rtl] .isFluent .OperationMonitor-itemIconActions{margin-left:-36px}.OperationMonitor-itemIconAction{width:32px;height:32px;text-align:center;padding-top:12px;text-align:center;box-sizing:border-box;overflow:hidden;background:0 0;border:0;cursor:pointer}.isFluent .OperationMonitor-itemIconAction{border-radius:2px}.isFluent .OperationMonitor-itemIconAction:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .OperationMonitor-itemIconAction:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.OperationMonitor-itemIconAction .ms-Icon{transform:translate(0,-50%);display:block;font-size:14px}.isFluent .OperationMonitor-itemIconAction .ms-Icon{font-size:12px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.OperationMonitor-itemIconAction.cancel{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.OperationMonitor-itemButtonActions{width:218px}html[dir=ltr] .OperationMonitor-itemButtonActions{clear:right}html[dir=rtl] .OperationMonitor-itemButtonActions{clear:left}[dir=ltr] .OperationMonitor-itemButtonActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemButtonActions{margin-left:-40px}.OperationMonitor-itemButtonAction.od-Button{margin-top:6px}.OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}html[dir=rtl] .OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}.OperationMonitor-itemButtonAction.od-Button .od-Button-label{font-size:12px}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-left:0}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-right:0}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-right:6px}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-left:6px}.od-OperationMonitor-viewAll{padding:0;border:none;margin-top:16px;cursor:pointer;background:0 0;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-OperationMonitor-empty{font-size:14px;font-weight:400}.AnchorOverlay .OperationMonitor{max-width:400px;padding:10px}.ms-Callout .OperationMonitor{max-width:400px;padding:10px}.isFluent .ms-Callout .OperationMonitor{padding:8px}.isFluent.ms-Callout .OperationMonitor-itemName{padding-top:0}.isFluent.ms-Callout .OperationMonitor-itemIconActions{height:12px}.isFluent.ms-Callout .OperationMonitor-itemIconAction{padding:10px 0 0 0;height:15px;width:12px}.isFluent.ms-Callout .OperationMonitor-itemIconAction .ms-Icon{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}"},{"rawString":".od-PersonaTile:focus{border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}"},{"rawString":".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:flex;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-EditLink-invalidPasswordError{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:flex;flex-direction:column}.od-EditLink-removeLinkHolder{align-items:center;color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-size:14px;font-weight:400;background:0 0;border:none;color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"},{"rawString":".od-SharingLink{margin-bottom:10px;display:flex}.od-SharingLink-cell{display:table-cell;max-width:200px}.od-SharingLink-iconCell{vertical-align:top;width:48px;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:10px}[dir=rtl] .od-SharingLink-iconCell{padding-left:10px}.od-SharingLink-icon{display:inline-block;color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";font-size:28px;min-width:48px;height:48px;text-align:center;line-height:48px;position:absolute;background-color:transparent;border-width:1px;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";border-radius:50%;min-width:48px;height:48px;border-style:solid;border-width:1px;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:10px}[dir=rtl] .od-SharingLink-iconBackground{margin-left:10px}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:table-row}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingLink-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:4px}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:4px}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:2px 4px}.od-SharingLink-linkMember .ms-Icon{font-size:12px;width:24px;text-align:center;line-height:24px}.od-SharingLink-linkUser{width:200px}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:24px;height:24px;border-radius:50%;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";display:inline-block;margin:0 4px;line-height:24px}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:24px;display:table-cell;width:24px;text-align:center}.od-SharingLink-chevron{font-size:11px}[dir=ltr] .od-SharingLink-chevron{margin-left:4px}[dir=rtl] .od-SharingLink-chevron{margin-right:4px}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-size:12px;font-weight:400}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":"}.od-SharingLink-csl{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}.od-SharingLink-psl{color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":";border-color:"},{"theme":"green","defaultValue":"#107c10"},{"rawString":";opacity:.1}.od-SharingLink-csl-bg{background-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";border-color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":";border-color:"},{"theme":"orangeLighter","defaultValue":"#ff8c00"},{"rawString":";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir=ltr] .od-SharingLink-lock{margin-left:12px}html[dir=rtl] .od-SharingLink-lock{margin-right:12px}.od-SharingLink-sharingHintContainer{display:flex}"},{"rawString":".od-PermissionsPanel-malwareDetectedMessageBar{padding:0 40px 20px 0}html[dir=rtl] .od-PermissionsPanel-malwareDetectedMessageBar{padding:0 0 20px 40px}.od-PermissionsPanel-malwareDetectedMessageBar--react{padding-bottom:20px}.od-PermissionsPanel-titleBar--react{padding-top:10px;padding-bottom:32px}[dir=ltr] .od-PermissionsPanel-titleBar--react{padding-left:20px}[dir=rtl] .od-PermissionsPanel-titleBar--react{padding-right:20px}.manageAccessInReactEnabled-fileName{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.manageAccessInReactEnabled-head{font-weight:300;padding-top:15px;padding-bottom:6px}.od-PermissionsPanel-content-React{height:calc(100% - 145px);overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel-content-React .od-Share{width:340px}.od-PermissionsPanel-table{display:table;height:100%}.od-PermissionsPanel-linksBox-row,.od-PermissionsPanel-row{display:table-row}.od-PermissionsPanel-cell{display:table-cell;vertical-align:top}.od-PermissionsPanel-linksBox-cell{display:table-cell;vertical-align:bottom;padding-bottom:24px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-linksBox-cell{text-align:right}html[dir=rtl] .od-PermissionsPanel-linksBox-cell{text-align:left}[dir=ltr] .od-PermissionsPanel-linksBox-cell{padding-right:17px}[dir=rtl] .od-PermissionsPanel-linksBox-cell{padding-left:17px}"},{"rawString":".od-SuggestedFiles-TypeCell{display:flex;min-height:32px}.od-SuggestedFiles-TypeCell:hover{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-SuggestedFiles-TypeCell{padding:0 4px 0 12px;margin:0 -12px;border-radius:2px;height:36px}[dir=rtl] .isFluent .od-SuggestedFiles-TypeCell{padding:0 12px 0 4px}.od-SuggestedFiles-TypeCell--isSelected{background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-SuggestedFiles-TypeName{font-size:14px;width:100%;padding:6px 0}.od-SuggestedFiles-MoreCommands{min-width:32px;max-width:32px;padding:0}.isFluent .od-SuggestedFiles-MoreCommands{min-width:28px;max-width:28px}.od-SuggestedFiles-TypeList{padding:8px 0}.od-SuggestedFiles-TypeImage{background:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin:8px}"},{"rawString":".sp-deferredLivePersonaCard-root{display:inline-block}\n"},{"rawString":".od-versionHistory-panelTitle{top:50px;position:absolute;padding-bottom:20px;font-size:20px}.isFluent .od-versionHistory-panelTitle{top:36px;font-weight:600}.isFluent .od-versionHistoryList .ms-DetailsRow:hover .od-versionNumberColumn-versionNumber{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.isFluent .od-versionNumberColumn-versionNumber{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.isFluent .od-versionNumberColumn-versionNumber:hover{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.od-versionHistory-container{position:absolute;top:100px;overflow:auto}.isFluent .od-versionHistory-container{top:92px;left:0;padding:0 16px;box-sizing:border-box;width:100%}.od-versionHistory-container .od-fileSizeColumn,.od-versionHistory-container .od-modifiedByColumn,.od-versionHistory-container .od-versionNumberColumn{line-height:32px}.isFluent .od-versionHistory-container .od-fileSizeColumn,.isFluent .od-versionHistory-container .od-modifiedByColumn,.isFluent .od-versionHistory-container .od-versionNumberColumn{line-height:normal}.od-versionHistory-container .od-modifiedDateColumn{height:32px;line-height:32px}.isFluent .od-versionHistory-container .od-modifiedDateColumn{height:auto;line-height:normal}.od-versionHistory-container .od-FieldRenderer-dot.od-modifiedDateColumn-moreButton.ms-Button.ms-Button--icon{margin:0}"},{"rawString":".od-AddToAlbum-albumThumbnail{position:absolute;height:50px;width:50px}.isFluent .od-AddToAlbum-albumThumbnail{height:32px;width:32px;overflow:hidden;top:12px;left:0;right:0;bottom:0;border-radius:2px;overflow:hidden}[dir=ltr] .isFluent .od-AddToAlbum-albumThumbnail{margin-left:8px}[dir=rtl] .isFluent .od-AddToAlbum-albumThumbnail{margin-right:8px}.od-AddToAlbum-albumRow{line-height:50px;height:50px;margin-bottom:6px}.od-AddToAlbum-albumRow:hover{background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":"}.isFluent .od-AddToAlbum-albumRow:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-AddToAlbum-albumRow:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-AddToAlbum-albumRow{line-height:32px;height:32px;margin:0 -12px;padding:12px 0;border-radius:2px;position:relative}.isFluent .od-AddToAlbum-albumRow:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-AddToAlbum-albumRow:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent.sm .od-AddToAlbum-albumRow{margin:0 -8px}.od-AddToAlbum-albumRow a{text-decoration:none}.isFluent .od-AddToAlbum-albumRow a{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-AddToAlbum-albumName{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[dir=ltr] .od-AddToAlbum-albumName{padding-left:58px}[dir=rtl] .od-AddToAlbum-albumName{padding-right:58px}.isFluent .od-AddToAlbum-albumName{font-size:14px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}[dir=ltr] .isFluent .od-AddToAlbum-albumName{padding-left:52px}[dir=rtl] .isFluent .od-AddToAlbum-albumName{padding-right:52px}.od-AddToAlbum-createArea.od-TextField{position:relative}.od-AddToAlbum-form{margin-bottom:24px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";height:100%;overflow:auto}.isFluent .od-AddToAlbum-form{margin-bottom:16px}.od-AddToAlbum-albumRowTitle{font-size:14px;margin-bottom:8px;padding-bottom:11px;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-AddToAlbum-emptyListBody,.od-AddToAlbum-error,.od-AddToAlbum-savingText{margin-top:8px;margin-bottom:0}.od-AddToAlbum-error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-AddToAlbum-savingText{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-AddToAlbum-createAreaInput--error{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"!important}.od-AddToAlbum-form--buttonVisible,.od-AddToAlbum-form--errorVisible{transition:height 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton,.od-Button.od-AddToAlbum-createNewAlbumButton--visible{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton--visible:not(:disabled),.od-Button.od-AddToAlbum-createNewAlbumButton:not(:disabled){color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-Button.od-AddToAlbum-createNewAlbumButton{margin-top:-32px;z-index:-1}html[dir=ltr] .od-Button.od-AddToAlbum-createNewAlbumButton{float:right}html[dir=rtl] .od-Button.od-AddToAlbum-createNewAlbumButton{float:left}.isFluent .od-Button.od-AddToAlbum-createNewAlbumButton{z-index:auto}.od-Button.od-AddToAlbum-createNewAlbumButton--visible{margin-top:24px}.isFluent .od-Button.od-AddToAlbum-createNewAlbumButton--visible{position:static}.od-AddToAlbum-albumListTitle{font-size:14px;font-weight:600;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";margin-bottom:8px;padding-bottom:12px}.od-AddToAlbum-emptyListImage{margin-top:30px}.od-AddToAlbum-emptyListTitle{margin-top:40px}.od-AddToAlbum-emptyList{text-align:center}"},{"rawString":".od-FilePickerHost{position:absolute;top:0;left:0;bottom:0;right:0}.od-FilePickerHost--frame .od-FilePickerHost-content{position:absolute;left:0;right:0;bottom:0;height:90px}.od-FilePickerHost--frame .od-FilePickerHost-frame{position:absolute;top:0;left:0;bottom:90px;right:0}.od-FilePickerHost--frame .od-FilePickerHost-frame iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:none}"},{"rawString":".od-BundleBuilder{position:absolute;top:0;left:0;bottom:0;right:0}"},{"rawString":".od-feedback iframe{width:100%;height:400px;border:none}.od-feedback.od-feedback-smaller iframe{height:100%}.od-feedback-inner{height:400px}.od-feedback-smaller .od-feedback-inner{height:195px}.od-feedback-smaller .od-feedback-inner.od-feedback--hasError{height:auto}"},{"rawString":".od-sendFeedback-inner{height:400px}.od-sendFeedback-smaller .od-sendFeedback-inner{height:195px}.od-sendFeedback-smaller .od-sendFeedback-inner.od-feedback--hasError{height:auto}html[dir=ltr] .od-Button-sendFeedback{float:right}html[dir=rtl] .od-Button-sendFeedback{float:left}.od-sendFeedback-textarea{width:100%;height:110px;resize:none;padding:4px}"},{"rawString":".od-OrderPrints-splash img{padding-bottom:24px;max-width:210px}.od-OrderPrints-splashText{margin-bottom:24px}.od-OrderPrints-centered{text-align:center}.od-OrderPrints iframe{border:none;width:100%;height:450px}.od-OrderPrints-actions button{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}"},{"rawString":".od-KeyboardMap-group{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.od-KeyboardMap-table{display:table;list-style:none;margin:0;padding:0}.od-KeyboardMap-row{display:table-row}.od-KeyboardMap-row span{display:table-cell}.od-KeyboardMap-key{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";min-width:55px}.od-KeyboardMap-val{padding:4px 8px}"},{"rawString":".od-RedeemCode-nameLabel{font-size:14px;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-RedeemCode-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-RedeemCode-status--error{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-RedeemCode-input--error{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"!important}"},{"rawString":".od-TagEditor{overflow:hidden}.isFluent .od-TagEditor{overflow:visible}.od-TagEditor-label.ms-Label{display:none}.od-TagEditor-input{width:100%}html[dir=ltr] .od-TagEditor-existingTags-wrapper{margin-left:16px}html[dir=rtl] .od-TagEditor-existingTags-wrapper{margin-right:16px}html[dir=ltr] .isFluent .od-TagEditor-existingTags-wrapper{margin-left:0}html[dir=rtl] .isFluent .od-TagEditor-existingTags-wrapper{margin-right:0}.od-TagEditor-existingTags .DetailsRow{height:52px;line-height:52px}.od-TagEditor-existingTags .DetailsRow.is-selected{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent .od-TagEditor-existingTags .DetailsRow{height:32px;line-height:56px;padding:12px 0;margin:0 -8px;border-radius:2px}.isFluent .od-TagEditor-existingTags .DetailsRow:focus,.isFluent .od-TagEditor-existingTags .DetailsRow:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.isFluent .od-TagEditor-existingTags .DetailsRow:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.isFluent.sm .od-TagEditor-existingTags .DetailsRow{margin:0 -8px}.od-TagEditor-existingTags .DetailsRow:hover .DetailsRow-check{display:none}.od-TagEditor-existingTags .DetailsRow .DetailsRow-cell{padding:0}.isFluent .od-TagEditor-existingTags .DetailsRow .DetailsRow-cell{padding:0 12px}.od-TagEditor-existingTags .DetailsRow-check{visibility:hidden}.od-TagEditor-title{margin-top:20px;margin-bottom:10px}.isFluent .od-TagEditor-title{font-size:14px;margin-top:12px;margin-bottom:8px;padding-bottom:11px;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-TagEditor-header{margin-top:20px;margin-bottom:10px;font-size:14px;font-weight:600;line-height:19px}html[dir=ltr] .od-TagEditor-header{margin-left:16px}html[dir=rtl] .od-TagEditor-header{margin-right:16px}.isFluent .od-TagEditor-header{font-size:14px;margin-bottom:8px;padding-bottom:11px;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}html[dir=ltr] .isFluent .od-TagEditor-header{margin-left:0}html[dir=rtl] .isFluent .od-TagEditor-header{margin-right:0}.od-TagEditor-emptyExistingTags{margin-top:30px;text-align:center}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-image{margin-bottom:20px}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-title{margin-bottom:10px}"},{"rawString":".TagInput{border:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;position:relative}.TagInput.old{border-bottom:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";max-height:150px}.TagInput.new{margin:40px 0 0 16px}html[dir=rtl] .TagInput.new{margin:40px 16px 0 0}.isFluent .TagInput.new{margin:0}html[dir=rtl] .isFluent .TagInput.new{margin:0}.isFluent .TagInput{border-bottom:0}.TagInput.TagInput--isDeleteMode .TagInput-container.new{width:245px}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3){background-color:"},{"theme":"themeSecondary","defaultValue":"#2f69c0"},{"rawString":"}.isFluent .TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3){background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag:hover,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName:hover{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.isFluent .TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag:hover,.isFluent .TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName:hover{background-color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.TagInput-container{display:inline-block}.TagInput-container.new{width:245px}.isFluent .TagInput-container{display:block}.TagInput-ghostText{position:absolute;top:5px;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";white-space:nowrap}[dir=ltr] .TagInput-ghostText{left:5px}[dir=rtl] .TagInput-ghostText{right:5px}.TagInput-textBox-underlined{border:0;vertical-align:inherit;background-color:transparent;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin:5px;vertical-align:top;outline:0}html[dir=ltr] .TagInput-textBox-underlined{float:left}html[dir=rtl] .TagInput-textBox-underlined{float:right}.TagInput-textBox-underlined::-ms-clear{display:none}.TagInput-textBox-underlined:focus{outline-color:transparent}.TagInput-textBox{border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";width:246px;height:32px;background-color:transparent;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";margin-bottom:10px;vertical-align:top;outline:0}html[dir=ltr] .TagInput-textBox{padding-left:10px}html[dir=rtl] .TagInput-textBox{padding-right:10px}html[dir=ltr] .TagInput-textBox{float:left}html[dir=rtl] .TagInput-textBox{float:right}.isFluent .TagInput-textBox{border-radius:2px;width:100%;box-sizing:border-box;margin-bottom:16px}.TagInput-textBox::-ms-clear{display:none}.TagInput-textBox:focus{outline-color:transparent;border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.TagInput-removeItem{width:20px;font-weight:700;text-decoration:none;display:inline-block;font-size:10px;vertical-align:top}.TagInput-removeItem:hover{background-color:"},{"theme":"themeLight","defaultValue":"#a8d1ef"},{"rawString":"}.TagInput-removeItem .ms-Icon--Cancel{padding:8px 5px 5px}.TagInput-error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.TagInput-resolvedTag{font-size:12px;line-height:32px;background-color:"},{"theme":"neutralLighterAlt","defaultValue":"#faf9f8"},{"rawString":";border:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";display:inline-block;height:32px;margin:0 8px 8px 0;white-space:nowrap}html[dir=ltr] .TagInput-resolvedTag{float:left}html[dir=rtl] .TagInput-resolvedTag{float:right}html[dir=rtl] .TagInput-resolvedTag{margin:0 0 8px 8px}.isFluent .TagInput-resolvedTag{line-height:28px;height:28px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border:0;border-radius:2px}.isFluent .TagInput-resolvedTag:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.TagInput-resolvedTagLink{display:inline-block;overflow:hidden;cursor:pointer;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.isFluent .TagInput-resolvedTagLink{border-radius:2px}.TagInput-resolvedTagName{display:inline-block;padding:0 8px;max-width:180px}.isFluent .TagInput-resolvedTagName{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.TagInput-removeTag:hover,.TagInput-resolvedTagLink:hover,.od-Focus--enabled .TagInput-removeTag:focus,.od-Focus--enabled .TagInput-resolvedTagLink:focus{color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";cursor:pointer}.TagInput-removeTag:focus,.TagInput-resolvedTagLink:focus{outline:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.TagInput-removeTag{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";width:32px;text-decoration:none;display:inline-block;vertical-align:top;text-align:center;border:none;background:inherit;height:100%}.isFluent .TagInput-removeTag{width:28px;font-size:12px;height:100%;border-radius:2px}.isFluent .TagInput-removeTag:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent .TagInput-removeTag:focus{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}"},{"rawString":".od-tagsEditorPanel .ms-Panel-header{margin:0 0 0 24px}html[dir=rtl] .od-tagsEditorPanel .ms-Panel-header{margin:0 24px 0 0}.od-tagsEditorPanel .ms-Panel-footer{border-top-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";position:absolute;bottom:0;width:100%;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}html[dir=ltr] .od-tagsEditor-footer{margin-left:16px}html[dir=rtl] .od-tagsEditor-footer{margin-right:16px}html[dir=ltr] .isFluent .od-tagsEditor-footer{margin-left:0}html[dir=rtl] .isFluent .od-tagsEditor-footer{margin-right:0}html[dir=ltr] .od-tagsEditor-footer-cancelButton{margin-left:8px}html[dir=rtl] .od-tagsEditor-footer-cancelButton{margin-right:8px}.od-tagsEditor-Panel-title{margin-top:16px;margin-bottom:16px;font-size:20px;font-weight:600;color:#252423}html[dir=ltr] .od-tagsEditor-Panel-title{margin-left:32px}html[dir=rtl] .od-tagsEditor-Panel-title{margin-right:32px}.isFluent .od-tagsEditor-Panel-title{margin-top:0;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html[dir=ltr] .isFluent .od-tagsEditor-Panel-title{margin-left:24px}html[dir=rtl] .isFluent .od-tagsEditor-Panel-title{margin-right:24px}.lg .od-tagsEditor-Panel-title,.md .od-tagsEditor-Panel-title,.sm .od-tagsEditor-Panel-title{line-height:48px}.isFluent.sm .od-tagsEditor-Panel-title{line-height:normal}.isFluent.md .od-tagsEditor-Panel-title{line-height:normal}.isFluent.lg .od-tagsEditor-Panel-title{line-height:normal}.od-tagsEditor-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;padding:0;top:16px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-radius:2px}[dir=ltr] .od-tagsEditor-Panel-button--close{right:16px}[dir=rtl] .od-tagsEditor-Panel-button--close{left:16px}.od-tagsEditor-Panel-button--close:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-tagsEditor-Panel-button--close:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}"},{"rawString":".od-GleamCallout-gleam{height:8px;margin-top:15px;width:8px}[dir=ltr] .od-GleamCallout-gleam{margin-left:6px}[dir=rtl] .od-GleamCallout-gleam{margin-right:6px}.od-GleamCallout-callout{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";width:274px}.od-GleamCallout-callout .ms-Callout-beak{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-GleamCallout-callout .ms-Callout-main{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";padding-bottom:20px;padding-top:0}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-left:20px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-right:20px}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-right:12px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-left:12px}.od-GleamCallout-headerImage{height:36px}.od-GleamCallout-title{font-size:17px;font-weight:300;font-weight:600;margin-top:14px;margin-bottom:14px;cursor:pointer}.od-GleamCallout-button.od-Button{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding:5px 8px;width:106px}.od-GleamCallout-premiumButton.od-Button{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}[dir=ltr] .od-GleamCallout-premiumButton.od-Button{margin-right:20px}[dir=rtl] .od-GleamCallout-premiumButton.od-Button{margin-left:20px}.od-GleamCallout-premiumButton.od-Button:active,.od-GleamCallout-premiumButton.od-Button:hover{background-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":";border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-Button.od-Button--primary.od-GleamCallout-button.od-GleamCallout-learnButton{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-GleamCallout-callout .od-Button.od-Button--primary{border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-GleamCallout-callout .od-Button.od-Button--primary:active,.od-GleamCallout-callout .od-Button.od-Button--primary:hover{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-GleamCallout-body{margin-bottom:20px}.od-GleamCallout-closeButton{background:0 0;border:none;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";display:block;height:20px;padding:12px 0 0 0}[dir=ltr] .od-GleamCallout-closeButton{margin-left:auto}[dir=rtl] .od-GleamCallout-closeButton{margin-right:auto}"},{"rawString":".od-SharingByLink-loadingSpinner{text-align:center;padding:75px 0}.od-SharingByLink-creatingLink-loadingSpinner{display:inline-block;padding:5px 0}.od-SharingByLink-note{margin-bottom:10px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SharingByLink-iconCell{width:50px;vertical-align:top}.od-SharingByLink-icon{display:inline-block;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:20px;border-radius:50%;width:40px;height:40px}[dir=ltr] .od-SharingByLink-icon{margin-right:20px}[dir=rtl] .od-SharingByLink-icon{margin-left:20px}.od-SharingByLink-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Link{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Link{right:10px}.od-SharingByLink-icon .ms-Icon--Mail{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Mail{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Mail{right:10px}.od-SharingByLink-networksRow .od-SharingByLink-icon{background:0 0}.od-SharingByLink-mailRow{white-space:nowrap;margin-top:8px}.od-SharingByLink-mailRow .od-SharingByLink-icon,.od-SharingByLink-networksRow .od-SharingByLink-icon{vertical-align:middle}.od-SharingByLink-linkSwitcher{display:inline-block;margin-bottom:4px}.od-SharingByLink-linkSwitcher .ms-Icon--ChevronDown,.od-SharingByLink-linkSwitcher .ms-Icon--ChevronUp{position:relative}.od-SharingByLink-linkSwitcher-icon{display:inlin-block;vertical-align:middle;line-height:18px}a.od-SharingByLink-linkSwitcher{cursor:pointer}.od-SharingByLink-url .od-SharingByLink-cell{width:100%}.od-SharingByLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingByLink-input.is-disabled{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}button.od-SharingByLink-copyButton{padding:0 10px;margin-top:4px}[dir=ltr] button.od-SharingByLink-copyButton{margin-left:15px}[dir=rtl] button.od-SharingByLink-copyButton{margin-right:15px}.od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{position:relative;top:-1px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"!important}.sm .od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{top:-4px}.od-SharingByLink-copySuccess{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-SharingByLink-linkText,.od-SharingByLink-mailText,.od-SharingByLink-networkText{font-size:17px;font-weight:300}.od-SharingbyLink-text{vertical-align:middle}.od-SharingByLink-table{display:table;width:100%}.od-SharingByLink-row{display:table-row}.od-SharingByLink-cell{display:table-cell}.od-SharingByLink-networksRow{margin-top:8px}.od-SharingByLink-linkSection{margin-top:14px}.od-SharingByLink-moreLink{display:inline-block}.od-SharingByLink-moreLink .ms-Icon--ChevronDown,.od-SharingByLink-moreLink .ms-Icon--ChevronUp{position:relative;top:2px}.od-SharingByLink-moreSection,.od-SharingByLinks-networksList{margin-top:12px}.od-sharingByLinks-networksList{margin-bottom:8px}.od-SharingByLink-social-holder{display:inline-block;vertical-align:middle}.od-SharingByLink-social-text{display:block}.od-SharingByLink-social-creating{font-size:12px;font-weight:400}.od-SharingByLink-linkExpiresInputDiv{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-linkExpiresInputDiv{margin-left:8px}[dir=rtl] .od-SharingByLink-linkExpiresInputDiv{margin-right:8px}.od-SharingByLink-linkExpiresInput{font-size:14px;font-weight:400;width:40px;height:24px;text-indent:2px}.od-SharingByLink-setPasswordInputContainer{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-setPasswordInputContainer{margin-left:8px}[dir=rtl] .od-SharingByLink-setPasswordInputContainer{margin-right:8px}.od-SharingByLink-setPasswordInput{display:block;height:24px;text-indent:8px;width:198px}.od-SharingByLink-invalidPasswordError{display:block;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font-size:12px;padding-top:3px}.od-SharingByLink-invalidPasswordOutline{outline:1px solid "},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-SharingByLink-CheckBoxContainer{margin:2px 0}.od-CheckBox-field.od-SharingByLink-CheckBox:before{border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-CheckBox-field.od-SharingByLink-CheckBox:after{padding-top:1px}.od-sharingByLinks-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";display:flex}.od-SharingByLink-passwordProtectedLinkInformationTextArea{padding:10px}.od-SharingByLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-right:10px}html[dir=ltr] .od-SharingByLink-lock{margin-right:4px}html[dir=rtl] .od-SharingByLink-lock{margin-left:4px}html[dir=ltr] .od-SharingByLink-manageAccessLink{padding-left:2px}html[dir=rtl] .od-SharingByLink-manageAccessLink{padding-right:2px}"},{"rawString":".ms-IframeLoader{display:none;width:100%;height:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;margin:0 0 20px 0;font-weight:300;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";display:none}.ms-IframeLoader-loadingLabel.od-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--l{font-size:17px}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframeElmt{width:100%;height:100%;border:none;display:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframeElmt--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"},{"rawString":".od-SharedWith-Container{width:100%}.od-SharedWith-loadingSpinner{text-align:center;padding:75px 0}.od-SharedWith-wrapper{margin:2px;width:100%;overflow-x:hidden;overflow-y:auto;min-height:175px}.od-SharedWith-accessRequests{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";padding:8px 0}.od-SharedWith-accessRequestsIcon{padding:0 8px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:12pt;vertical-align:middle}[dir=ltr] .od-SharedWith-accessRequestsLink{padding-left:5px}[dir=rtl] .od-SharedWith-accessRequestsLink{padding-right:5px}.od-SharedWith-person{margin:0 0 10px;width:100%}.od-SharedWith-person .od-Persona .od-Persona-details{max-width:75%;padding-left:0}.od-SharedWith-error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-SharedWith-linksBox{margin:10px 0 1px}button.od-SharedWith-link{border:none;background:0 0}.od-SharedWith-link{text-decoration:none;cursor:pointer;padding:2px;text-transform:uppercase;font-size:12px;font-weight:400;color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .od-SharedWith-link{margin-right:10px}[dir=rtl] .od-SharedWith-link{margin-left:10px}.od-SharedWith-link:focus,.od-SharedWith-link:hover{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.od-SharedWith-iconCell{width:50px;vertical-align:top}.od-SharedWith-icon{display:inline-block;background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-size:25px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-SharedWith-icon{margin-right:10px}[dir=rtl] .od-SharedWith-icon{margin-left:10px}.od-SharedWith-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharedWith-icon .ms-Icon--Link{left:9px}[dir=rtl] .od-SharedWith-icon .ms-Icon--Link{right:9px}.od-SharedWith-mailRow{white-space:nowrap}.od-SharedWith-mailRow .od-SharedWith-icon{vertical-align:middle}.od-SharedWith-linkSwitcher{display:inline-block;margin-bottom:10px}a.od-SharedWith-linkScope,a.od-SharedWith-linkSwitcher{cursor:pointer}.od-SharedWith-url .od-SharedWith-cell{width:100%}.od-SharedWith-input{padding:3px;width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}button.od-SharedWith-copyButton{padding:0 10px;height:1.9em}.od-SharedWith-copyButton-label{position:relative;top:-1px}.od-SharedWith-mailText{font-size:17px;font-weight:300}.od-SharedWith-trimmedText{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .od-SharedWith-trimmedText{margin-right:5px}[dir=rtl] .od-SharedWith-trimmedText{margin-left:5px}.od-SharedWith-table{display:table;width:100%}.od-SharedWith-row{display:table-row}.od-SharedWith-cell{display:table-cell}.od-SharedWith-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer}[dir=ltr] .od-SharedWith-removeLinkButton{margin-left:10px}[dir=rtl] .od-SharedWith-removeLinkButton{margin-right:10px}.od-SharedWith--hidden{display:none}"},{"rawString":".od-SharingTips-section{margin-top:6px}[dir=ltr] .od-SharingTips-section{margin-left:6px}[dir=rtl] .od-SharingTips-section{margin-right:6px}.od-SharingTips-resolvedUser{display:inline-block;font-weight:700}.od-SharingTips-multiUserList{display:inline;list-style:none;padding:0}.od-SharingTips-multiUserList li{display:inline}.od-SharingTips-multiUserList li:after{content:\", \"}.od-SharingTips-multiUserList li:last-child:after{content:\"\"}.od-SharingTips-expandLink{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";background:0 0;border:none;padding:0;cursor:pointer}.od-SharingTips-expandLink:focus,.od-SharingTips-expandLink:hover{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}.od-SharingTips-error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-SharingTips-policyTip{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":";margin-top:6px}"},{"rawString":".ms-DlpLite{overflow:hidden}"},{"rawString":".Sharing{overflow:hidden}.Sharing .Sharing-requireSignInLabel{border-bottom-style:dotted;border-bottom-width:1px}.Sharing-options{width:85%}html[dir=ltr] .Sharing-options{float:left}html[dir=rtl] .Sharing-options{float:right}html[dir=ltr] .Sharing-charCounter{text-align:right}html[dir=rtl] .Sharing-charCounter{text-align:left}.Sharing-charCounter--limitReached{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.Sharing-submitButton{position:relative;width:100%;height:30px;margin-top:5px}html[dir=ltr] .Sharing-submit{float:right}html[dir=rtl] .Sharing-submit{float:left}.Sharing-loadingSpinner{text-align:center;padding:75px 0}.Sharing-table{display:table;width:100%;border-collapse:collapse}.Sharing-row{display:table-row;width:100%}.Sharing-cell{display:table-cell}.Sharing-peoplePicker{width:100%;vertical-align:top}.Sharing-link{padding-bottom:5px}.Sharing-simpleRoleSelector{padding:2px;vertical-align:top;border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:12px;font-weight:400;height:33px}[dir=ltr] .Sharing-simpleRoleSelector{margin-left:8px}[dir=rtl] .Sharing-simpleRoleSelector{margin-right:8px}.Sharing-mailInput{resize:none;height:80px;width:100%;box-sizing:border-box;border:1px solid "},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";overflow-y:auto;padding:5px;margin:10px 0 5px 0}#Sharing-aclPropagation,#Sharing-requireSignIn,#Sharing-sendEmailCheckbox{display:inline-block;vertical-align:sub}[dir=ltr] #Sharing-aclPropagation,[dir=ltr] #Sharing-requireSignIn,[dir=ltr] #Sharing-sendEmailCheckbox{margin-right:5px}[dir=rtl] #Sharing-aclPropagation,[dir=rtl] #Sharing-requireSignIn,[dir=rtl] #Sharing-sendEmailCheckbox{margin-left:5px}.od-Sharing-linkSwitcher{display:inline-block;margin-bottom:10px}.od-ShareByEmail-textInput{display:flex;flex-direction:column}.od-ShareByEmail-expirationLabel{display:flex;align-items:center}[dir=ltr] .od-ShareByEmail-expirationIcon{margin-right:8px}[dir=rtl] .od-ShareByEmail-expirationIcon{margin-left:8px}.od-ShareByEmail-expirationText{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}"},{"rawString":"html[dir=ltr] .od-SharingLinksSwitcher-rightArea{float:right}html[dir=rtl] .od-SharingLinksSwitcher-rightArea{float:left}.od-SharingLinksSwitcher-processing{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-SharingLinksSwitcher-processing{padding-right:5px}[dir=rtl] .od-SharingLinksSwitcher-processing{padding-left:5px}.od-SharingLinksSwitcher-loadingSpinner{text-align:center;padding:75px 0}.od-SharingLinksSwitcher-linkInput-label{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";display:block;padding-top:5px}.od-SharingLinksSwitcher-linkLabel{display:block;padding-bottom:5px}.od-SharingLinksSwitcher-updateLinkButton{font-size:12px;font-weight:400;text-transform:uppercase;white-space:nowrap;display:inline-block;cursor:pointer}a.od-SharingLinksSwitcher-updateLinkButton{color:"},{"theme":"blue","defaultValue":"#0078d4"},{"rawString":";text-decoration:none}.od-SharingLinksSwitcher-linksSection{padding-bottom:20px}.od-SharingLinksSwitcher-error{color:"},{"theme":"error","defaultValue":"#a80000"},{"rawString":"}.od-SharingLinksSwitcher-linkPickerArea{margin-bottom:14px}.od-SharingLinksSwitcher-dropdownLinkContainer{color:inherit;display:inline-block;box-sizing:border-box;border:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";width:100%;padding:4px 10px;padding-bottom:2px}@media (max-width:639.99999px){.od-SharingLinksSwitcher-dropdownLinkContainer{width:223px}}.od-SharingLinksSwitcher-dropdownLinkContainer:hover,.od-SharingLinksSwitcher-dropdownLinkContainer:visited{color:inherit;text-decoration:none}.od-SharingLinksSwitcher-dropdownArrow,.od-SharingLinksSwitcher-expiration-dropdownArrow{display:inline-block;position:relative;top:5px}html[dir=ltr] .od-SharingLinksSwitcher-dropdownArrow,html[dir=ltr] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:right}html[dir=rtl] .od-SharingLinksSwitcher-dropdownArrow,html[dir=rtl] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:left}.od-SharingLinksSwitcher-linkTypeText{padding:10px}.od-SharingLinksSwitcher-expiry-div{border-collapse:separate}.od-SharingLinksSwitcher-singleLinkLabel{display:inline-block;width:433px;padding:4px 0;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639.99999px){.od-SharingLinksSwitcher-singleLinkLabel{width:223px}}.od-SharingLinksSwitcher-dropdownText{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639.99999px){.od-SharingLinksSwitcher-dropdownText{width:183px}}.od-SharingLinksSwitcher-expiration-dropdownText{display:inline-block;overflow:hidden}.od-SharingLinksSwitcher-linkBoxArea{margin-bottom:5px}.od-SharingLinksSwitcher-sharingLinkSelector .od-SharingLinksSwitcher-linkInput-textbox{box-sizing:border-box;width:95%}.od-SharingLinksSwitcher-linkExpirationArea{margin-bottom:7px}.od-SharingLinksSwitcher-LinkExpirationMenuArea{display:inline-block}.od-SharingLinksSwitcher-expiration-dropdownLinkContainer{display:inline-block;vertical-align:middle}.od-SharingLinksSwitcher-expiration-expirationText{display:inline-block}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationText{padding-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationText{padding-left:10px}.od-SharingLinksSwitcher-expirationInput{display:inline-block;width:30px;margin-top:-5px;cursor:text}.od-SharingLinksSwitcher-expiration-buttons{display:inline-block}.od-SharingLinksSwitcher-expiration-expirationSave{display:inline-block;vertical-align:text-bottom}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationSave{margin-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationSave{margin-left:10px}.od-SharingLinksSwitcher-expiration-expirationError{margin-top:6px}.od-SharingLinksSwitcher-sharingLinkSelector a.od-ContextualMenu-item{padding:10px}#od-SharingLinkSwitcher-canEdit{display:inline-block;vertical-align:sub;margin-bottom:15px}[dir=ltr] #od-SharingLinkSwitcher-canEdit{margin-right:5px}[dir=rtl] #od-SharingLinkSwitcher-canEdit{margin-left:5px}"},{"rawString":".od-SharingHints{width:100%}.od-SharingHints .od-Persona--tiny{line-height:13px}.od-SharingHints .od-Persona--tiny .od-Persona-details{font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-left:0}[dir=rtl] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-right:0}.od-SharingHints-text{font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-SharingHints-persona{display:inline-block}"},{"rawString":".od-Dialog-content .od-SharingWizard{margin:-16px -32px -20px}.od-SharingWizard-loadingSpinner{margin-top:90px;text-align:center;margin-bottom:90px}.od-SharingWizard-component{padding:5px 32px 32px}.od-SharingWizard-sharingHints{padding:5px 27px 0}"},{"rawString":".od-AlbumBuilder{position:absolute;top:0;left:0;right:0;bottom:0}.od-AlbumBuilder .od-ItemContent-header.od-AlbumBuilder-header{display:block;padding-top:0}.od-AlbumBuilder .od-ItemContent{padding-bottom:24px;padding-top:12px}.od-AlbumBuilder-title .od-EditableText-textArea,.od-AlbumBuilder-title .od-TextField.od-TextField--multiline .od-TextField-field,.od-AlbumBuilder-title a.od-EditableText-readOnlyArea{font-size:21px;font-weight:100}.od-AlbumBuilder-title .od-EditableText .od-TextField-field.od-EditableText-textArea{min-height:33px}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive{border:none;border-bottom:1px solid transparent}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:focus,.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:hover{border-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-AlbumBuilder-title .od-TextField-field{border:none;border-bottom:1px solid #a19f9d;font-size:20px;font-weight:400;color:#323130;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";padding-left:8px;padding-right:8px}[dir=ltr] .od-AlbumBuilder-title .od-TextField-field{padding-left:0}[dir=rtl] .od-AlbumBuilder-title .od-TextField-field{padding-right:0}.od-AlbumBuilder-title .od-TextField-field:hover{border-bottom:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";color:#201f1e}.od-AlbumBuilder-title .od-TextField-field:focus{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";color:#323130}.od-AlbumBuilder-status{margin-top:12px;color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":";font-size:12px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-header.od-ItemContent-header{height:90px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-status{color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-title .od-TextField-field{border-color:"},{"theme":"redDark","defaultValue":"#a4262c"},{"rawString":"}"},{"rawString":".od-Dialog .od-Dialog-main.od-vaultfre-outer{text-align:center;max-width:540px;height:548px;border-radius:2px}.od-Dialog .od-Dialog-main.od-vaultfre-outer .od-Dialog-header{padding-top:40px;font-weight:600}.od-vaultfre-outer .od-StandardDialog{padding:24px 48px;overflow:auto;min-height:500px}.od-vaultfre-outer .od-Dialog-title{font-weight:400;font-size:32px}.od-vaultfre-outer .od-Dialog-inner{padding-top:0;height:400px}.od-vaultfre-outer .od-Dialog-actions{max-width:440px;position:absolute;bottom:20px;padding:0}.od-vaultfre-outer .od-Button{border-radius:2px}.od-vaultfre{font-size:17px;padding:0 16px}.od-vaultfre-title{font-size:32px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";display:block;padding-bottom:8px}.od-vaultfre-description{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";font-size:14px}.od-vaultfre-points{padding-top:36px}[dir=ltr] .od-vaultfre-points{padding-left:3px}[dir=rtl] .od-vaultfre-points{padding-right:3px}.od-vaultfre-points div{height:75px;display:flex;align-items:center;padding-top:8px}html[dir=ltr] .od-vaultfre-points div{text-align:left}html[dir=rtl] .od-vaultfre-points div{text-align:right}.od-vaultfre-points span{line-height:28px}[dir=ltr] .od-vaultfre-points span{padding-left:13px}[dir=rtl] .od-vaultfre-points span{padding-right:13px}.od-vaultfre-points i{padding:6px;border:1px solid #eaeaea;border-radius:4px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:32px}.od-vaultfre-verify{padding-top:8px;max-width:326px}[dir=ltr] .od-vaultfre-verify{padding-left:11px}[dir=rtl] .od-vaultfre-verify{padding-right:11px}.od-vaultfre-person{padding-top:57px}.od-vaultfre-person .od-Persona-imageCircle{width:120px;height:120px}.od-vaultfre-person .od-Persona .od-Persona-details{display:block}.od-vaultfre-person .od-Persona .od-Persona-details .od-Persona-primaryText{font-weight:600;font-size:20px}.od-vaultfre-person .od-Persona .od-Persona-imageArea{padding-bottom:13px}.od-vaultfre-person .od-Persona .od-Persona-emailText{padding-top:10px;font-size:14px}.od-vaultfre .od-vaultfre-person .od-Persona .od-Persona-imageArea{margin:0}"},{"rawString":".od-DownloadZipContents{visibility:hidden}"}]);return {ReportAbuse_1:{reportAbuseClass:'reportAbuseClass_d8ba35eb',reportAbuseDialog:'reportAbuseDialog_d8ba35eb',blocker:'blocker_d8ba35eb',reportAbuseErrorDialog:'reportAbuseErrorDialog_d8ba35eb',reportAbuseSentDialog:'reportAbuseSentDialog_d8ba35eb'},Header_7:{reportAbuseHeader:'reportAbuseHeader_7eb38fa6',reportAbuseCloseButtonWeb:'reportAbuseCloseButtonWeb_7eb38fa6',reportAbuseCloseButtonMobile:'reportAbuseCloseButtonMobile_7eb38fa6'},ReportAbuseMain_9:{reportAbuseDescription:'reportAbuseDescription_6c79d2a8',reportAbuseHeaderLabel:'reportAbuseHeaderLabel_6c79d2a8',reportAbuseHeader:'reportAbuseHeader_6c79d2a8',reportAbuseHeaderText:'reportAbuseHeaderText_6c79d2a8',choiceGroupSelected:'choiceGroupSelected_6c79d2a8',choiceGroupCopyrightSelected:'choiceGroupCopyrightSelected_6c79d2a8',choiceGroupNotSelected:'choiceGroupNotSelected_6c79d2a8',reportAbuseFooter:'reportAbuseFooter_6c79d2a8',reportAbuseFooterLabel:'reportAbuseFooterLabel_6c79d2a8',reportAbuseReportButtonWeb:'reportAbuseReportButtonWeb_6c79d2a8',reportAbuseReportButtonAndroid:'reportAbuseReportButtonAndroid_6c79d2a8',reportAbuseReportButtoniOS:'reportAbuseReportButtoniOS_6c79d2a8',codeOfConductLink:'codeOfConductLink_6c79d2a8',privacyStatementLink:'privacyStatementLink_6c79d2a8',reportAbuseTextFieldWeb:'reportAbuseTextFieldWeb_6c79d2a8',reportAbuseTextFieldAndroid:'reportAbuseTextFieldAndroid_6c79d2a8',reportAbuseTextFieldiOS:'reportAbuseTextFieldiOS_6c79d2a8',reportAbuseCopyRightText:'reportAbuseCopyRightText_6c79d2a8',reportAbuseCopyRightLink:'reportAbuseCopyRightLink_6c79d2a8'},ReportActivityIndicator_9:{reportAbuseActivityIndicator:'reportAbuseActivityIndicator_5341a7f5'},ReportAbuseSent_1:{reportAbuseSentDescription:'reportAbuseSentDescription_9a753041',reportAbuseSentTextLabel:'reportAbuseSentTextLabel_9a753041',reportAbuseSentHeaderLabelWeb:'reportAbuseSentHeaderLabelWeb_9a753041',reportAbuseSentHeaderLabelAndroid:'reportAbuseSentHeaderLabelAndroid_9a753041',reportAbuseSentHeaderLabeliOS:'reportAbuseSentHeaderLabeliOS_9a753041',reportAbuseSentReportButtonWeb:'reportAbuseSentReportButtonWeb_9a753041',reportAbuseSentReportButtonAndroid:'reportAbuseSentReportButtonAndroid_9a753041',reportAbuseSentReportButtoniOS:'reportAbuseSentReportButtoniOS_9a753041',codeOfConductLink:'codeOfConductLink_9a753041'},ErrorBar_5:{reportAbuseErrorBar:'reportAbuseErrorBar_7d354d2d',reportAbuseErrorIcon:'reportAbuseErrorIcon_7d354d2d',reportAbuseErrorText:'reportAbuseErrorText_7d354d2d'},PickerItem_1:{itemContent:'itemContent_f52f5396',peoplePickerPill:'peoplePickerPill_f52f5396',peoplePickerClose:'peoplePickerClose_f52f5396'}}});