define("odsp-next/controls/oneUp/video/OneUpVideo",["require","exports","./OneUpVideo.html","./OneUpVideoViewModel","../../../bindings/component/ControlBinding","ODCItemVideoPlayer_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-video",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/video/OneUpVideo.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:showThumbnail--\x3e<div class="od-OneUpVideo-thumbnail" data-bind="control:thumbnailControl,css:{\'od-OneUpVideo-thumbnail--framed\':showFrame}"></div>\x3c!--ko if:showWatermark--\x3e<img class="od-OneUpVideo-watermark" data-bind="attr:{src:watermark,alt:watermarkAlt}">\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showVideo--\x3e<div class="od-OneUpVideo" data-bind="control:videoPlayer"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/video/OneUpVideoViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../PaneProvider.key","../ToolbarProvider.key","../../video/controls/player/VideoPlayer","../../video/resources/VideoResourceKeys","../OneUpContentViewModel","../other/commands/ItemActionBar.key","../thumbnail/OneUpThumbnail","../../../resources/DataSourceResourceKeys","../../../utilities/icons/IconCdn"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t,r)||this;s.addBindingHandlers({control:u.default});var a=s.observables,f=s.showFrame=a.pureCompute(function(){var e=s.slide.item();return!(e.video&&(e.video.height||e.video.width)||!e.audio)});s.watermark=a.pureCompute(function(){var e=f()?"audiowatermark":"videowatermark";return m.ITEM_TYPES+"64/"+e+".svg"});s.watermarkAlt=a.pureCompute(function(){return s.slide.item().displayName});var h=a.pureCompute(function(){var e=s.oneUp.size();return f()?{width:Math.min(200,e.width),height:Math.min(200,e.height)}:e}),v=a.pureCompute(function(){return!f}),g=i.forSingleValue(),y=a.createCallback(g);s.showWatermark=a.pureCompute(function(){return!y()||y().resultType!==o.ResultTypeEnum.Success});var b=s.slide;s.thumbnailControl=u.toSpecification(d.default,{allowError:v,showErrorActions:!1,slide:n.__assign(n.__assign({},b),{loadState:a.create(0),loadResult:y}),oneUp:s.oneUp,size:h,isPreview:!0});s._isMobile=r.platformDetection.isMobile;b.isEditCaptionEnabled(!s._isMobile);var w=s._isPlaying=a.create(!1),E=s._isMaximized=a.create(!1);s.showVideo=a.pureCompute(function(){return!b.offset()});s.showThumbnail=a.pureCompute(function(){return f()||!s.showVideo()});var S=a.createCallback(g);s.scope.attach(b.loadResult.register(S));var x=b.loadState;x(2);var T=b.renderOptions,N=a.createCallback(i.forSingleValue());s.videoPlayer=u.toSpecification(l.default,{actionBar:T?u.toSpecification(p.resourceKey,{forceExternal:!0,item:b.item}):void 0,autoplay:!T||!!T.autofocus,result:S,item:b.item,isLoading:N,isPlaying:w,isMaximized:E});a.backgroundCompute(function(){x()<3&&(!S()||N()||E()||w()||x(3))});s.resources.expose(c.playbackPanelProvider,r.toolbarProvider);a.compute(s._computeSetIsIdleEnabledFromIsPlaying);a.compute(s._computeChangesOnMaximized);return s}t.prototype._computeSetIsIdleEnabledFromIsPlaying=function(){this.slide.isIdleEnabled(this._isPlaying())};t.prototype._computeChangesOnMaximized=function(){var e=this._isMaximized();this.oneUp.isCommandBarVisible(!e);this.slide.isEditCaptionEnabled(!this._isMobile&&!e);r.computedContext.isInitial()||this.oneUp.isInfoPaneExpanded(!1)};t.dependencies=n.__assign(n.__assign({},h.default.dependencies),{paneProvider:a.resourceKey,platformDetection:s.platformDetection,toolbarProvider:f.resourceKey,videoItemDataSource:v.videoItem});return t})(h.default);t.default=g});
define("odsp-next/controls/video/controls/player/VideoPlayer",["require","exports","./VideoPlayer.html","./VideoPlayerViewModel","../../../../bindings/component/ControlBinding","ODCItemVideoPlayer_css","../canvas/VideoCanvas","../playbackPanel/PlaybackPanel","../../../transclusion/content/TransclusionContent"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-item-videoplayer",name:e("module").id,template:n.default,viewModelType:r.default});t.default=t.resourceKey});
define("odsp-next/controls/video/controls/player/VideoPlayer.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-VideoPlayer" data-bind="fullScreen:context.isMaximized,css:{\'od-VideoPlayer--isFullScreen\':context.isMaximized,\'od-VideoPlayer--hasStatus\':context.videoStatus().isVisible}"><div class="od-VideoPlayer-canvas" data-bind="event:{dblclick:toggleIsMaximized},component:{name:\'od-videocanvas\'}"></div><div class="od-VideoPlayer-status" data-bind="click:onStatusClicked"><div class="od-VideoPlayer-statusContent">\x3c!--ko if:$component.context.videoStatus().isRetriable--\x3e<button class="od-VideoPlayer-statusButton ms-Icon" data-bind="icon:true,css:{\'ms-Icon--Sync\':context.hasError(),\'ms-Icon--Play\':!context.hasError()&&!context.isPlaying(),\'ms-Icon--Pause\':!context.hasError()&&context.isPlaying()}"></button>\x3c!--/ko--\x3e\x3c!--ko with:$component.context.videoStatus--\x3e\x3c!--ko if:$data.statusMessage--\x3e<div class="od-VideoPlayer-statusText" data-bind="text:$data.statusMessage"></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.correlationId--\x3e<div class="od-VideoPlayer-debugText"><span data-bind="text:$component.correlationId"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:$component.context.canShowDiagnostics--\x3e<div class="od-VideoPlayer-debugText"><strong data-bind="text:$component.getErrorType($data.error)"></strong><span data-bind="text:$component.getErrorDetails($data.error)"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:context.hasError()--\x3e\x3c!--ko control:actionBar--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--ko if:!context.shouldUseNativeControls--\x3e\x3c!--ko component:playbackPanelHost--\x3e\x3c!--ko component:playbackPanel--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/video/controls/player/VideoPlayerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../../bindings/component/ControlBinding","../../../../providers/engagement/Engagement","../../resources/VideoResourceKeys","../../VideoContext","../../VideoErrorType","../../../../bindings/fullScreen/FullScreenBinding","../../VideoPlaybackType","../playbackPanel/PlaybackPanel","../../../../controls/transclusion/content/TransclusionContent"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:s.default,fullScreen:l.default});var i=r,o=i.observables,f=i.resources;r.item=t.item;r._isPlaying=t.isPlaying||o.create(!1);var c=t.result;r.actionBar=o.wrap(t.actionBar);var d=t.isLoading,v=r.context=f.expose(u.context,new(r.managed(a.default))({autoplay:t.autoplay,item:r.item}));d&&r.scope.attach(d.register(v.isLoading));r._isMaximized=t.isMaximized;r.playbackPanelHost={name:p.default.tagName,params:{provider:n.playbackPanelProvider}};r.playbackPanel={name:h.default.tagName,params:{}};r.correlationId=o.pureCompute(function(){var e=v.videoStatus(),t=e&&e.error;return t&&t.correlationId||""});c&&r.scope.attach(c.register(o.pureCompute(r._computeResult)));o.backgroundCompute(r._computeSetIsMaximized);o.backgroundCompute(r._computeUpdateIsPlaying);return r}t.prototype.dispose=function(){this._isPlaying(!1);e.prototype.dispose.call(this)};t.prototype.onStatusClicked=function(e,t){var n=this.context.videoStatus.peek().error;if(!n||n.isRetriable){this.context.isPlaying(!0);t.stopPropagation();t.preventDefault()}return!0};t.prototype.toggleIsMaximized=function(e,t){if(this.context.shouldUseNativeControls)return!0;this.context.isMaximized(!this.context.isMaximized.peek());return!1};t.prototype.getErrorType=function(e){var t=e&&e.type||f.default.unknown;return f.default[t]};t.prototype.getErrorDetails=function(e){return e&&(e.message||f.default[e.type])||""};t.prototype.getCorrelationId=function(e){return e&&e.correlationId||""};t.prototype._computeUpdateIsPlaying=function(){var e=this.context.isPlaying();this._isPlaying(e)};t.prototype._computeSetIsMaximized=function(){this._isMaximized(this.context.isMaximized())};t.prototype._computeResult=function(){var e=this.context;if(e.hasError()){var t=e.videoStatus().error,n=t.type?f.default[t.type]:"",r=t.code,s=t.correlationId;r&&(n+="."+r);var o=s?{CorrelationId:s}:{};return{error:t.message,resultCode:n,resultType:t.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,extraData:o}}if(e.canPlay()){var u=e.playbackType();return{resultType:i.ResultTypeEnum.Success,resultCode:u&&c.VideoPlaybackType[u]}}};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{playbackPanelProvider:u.playbackPanelProvider.optional,engagement:o.resourceKey});return t})(r.default);t.default=d});
define("odsp-next/controls/video/resources/VideoResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.context=new n.ResourceKey("video.context");t.playbackPanelProvider=new n.ResourceKey("video.playbackPanelProvider")});
define("odsp-next/controls/video/VideoContext",["require","exports","tslib","@ms/dashling/lib/Dashling","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/models/store/KnockoutDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/utilities-error/lib/ApiError","@ms/utilities-guid/lib/Guid","./VideoError","./VideoErrorType","./PlaybackMonitor","./VideoPlaybackType","./VideoPlayer.resx","../../utilities/flash/FlashHelper","../../utilities/features/Features","./controls/canvas/VideoCanvasType","../../resources/DataSourceResourceKeys","../../utilities/network/ConnectivityTester"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=[10,0,0],x=!1,T=!1,N=!1,C=!1,k=!1,L=0,A=!1,O=new o.default;(function(){var e=document.createElement("video");if(e&&e.canPlayType){try{e.volume=0;A=!0}catch(e){return}x=P(e,'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');N=P(e,'audio/wav; codecs="1"');T=P(e,'video/webm; codecs="vp9, opus"');C=P(e,"application/vnd.apple.mpegURL")&&(O.isMac||O.isIOS);k=!(!x||!window.MediaSource&&!window.WebKitMediaSource);O.isWindows&&O.isChrome&&O.browserMajor<=34&&(k=!1);O.isSafari&&(k=!1)}})();var M=[p.default.htmlDashlingMediaSourceInit,p.default.htmlDashlingManifestDownload,p.default.htmlDashlingInitSegmentDownload,p.default.htmlDashlingMediaSegmentDownload,p.default.htmlDashlingManifestParse,p.default.htmlDashlingVideoElementError,p.default.htmlDashlingSourceBufferInit,p.default.htmlDashlingSourceBufferAppendException,p.default.htmlDashlingSourceBufferAppendMissing,p.default.htmlDashlingWebCryptoInitError,p.default.htmlDashlingAesKeyFetchError,p.default.htmlDashlingSegmentDecryptionError,p.default.htmlDashlingOther];var _=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.item=t.item;var r=n,i=r.observables,s=r.resources;n._networkTester=s.consume(E.resourceKey);n._videoItemDataSource=s.consume(w.videoItem);n._dataStore=n.addDisposable(new a.default("VideoPlayer",f.default.local));n.itemKey=i.pureCompute(n._computeItemKey);n.shouldAutoPlay=t.autoplay&&!O.isMobile;n.shouldUseNativeControls=n._computeShouldUseNativeControls();n.playbackType=i.create(v.default.htmlDashling);n.url=i.create(null);n.coverImageUrl=i.create("");n.isLoading=i.create(!1);n.canPlay=i.create(!1);n.isPlaying=i.create(!1);n.isAdjustingVolume=i.create(!1);n.position=i.create(0);n.seekPercentage=i.create(0);n.isSeeking=i.create(!1);n.isScrubbing=i.create(!1);n.duration=i.create(0);n.bufferedRanges=i.createArray();n.isMaximized=i.create(!1);n.videoStatus=i.create(null);n.playingQuality=i.create(480);n.maxQuality=i.create(720);n.dashling=i.create();n.dashQualities=i.create([]);n.useBetaTranscode=i.create(y.isFeatureEnabled(y.UseAltTranscodeForDashManifests));n.disableTranscode=i.create(!1);n._errorsByType=i.create({});n._encryptedPlaybackRequested=!1;0;y.isFeatureEnabled(y.AllowVideoDiagnostics)&&(n.canShowDiagnostics=!0);n.isMuted=i.create(!1);n._dataStore.persistBoolean(n.isMuted,"isMuted");n.volume=i.create(1);n._dataStore.persistNumber(n.volume,"volume");n.desiredQuality=i.create(480);n._dataStore.persistNumber(n.desiredQuality,"desiredQuality");n.isABREnabled=i.create(!0);n._dataStore.persistBoolean(n.isABREnabled,"isABREnabled");n.isDiagnosticsEnabled=i.create(!1);n._dataStore.persistBoolean(n.isDiagnosticsEnabled,"isDiagnosticsEnabled");n.cacheMissCount=0;n.cacheHitCount=0;n.totalPlayTimeMs=0;n.totalRebufferingTimeMs=0;n.lastPlayStartTime=0;n.lastLoadingStartTime=0;n.hasError=i.pureCompute(n._computeHasError);n.canvasType=i.pureCompute(n._computeCanvasType);n.canAdjustQuality=i.pureCompute(n._computeCanAdjustQuality);n.isPlaybackCDNEnabled=i.pureCompute(n.isPlaybackUsingCDN);n.isPlaybackEncryptionEnabled=i.pureCompute(n.isPlaybackEncrypted);n.subscribe(n.item,n._onItemChanged);n.subscribe(n.isAdjustingVolume,n._onIsAdjustingVolumeChanged);n.subscribe(n.isPlaying,n._onIsPlayingChanged);n.subscribe(n.isLoading,n._onIsLoadingChanged);i.backgroundCompute(n._evaluateItemPlayability);n._onItemChanged(n.item.peek());new(n.managed(d.default))({context:n});return n}t.prototype.setVideoStatus=function(e){var t,r=e.statusMessage,i=e.error,s=this._errorsByType.peek(),o=this.playbackType.peek(),u=s[o],a=y.isFeatureEnabled(y.VideoAttemptFfmpegToMediaFoundationFallback)&&(function(e){return!!e&&-1!==M.indexOf(e.type)})(i);if(!y.isFeatureEnabled(y.VideoModeCascade)||u||!(function(e){if(!e)return!1;var t=e.type,n=y.isFeatureEnabled(y.VideoModeCascadeTimeout);return t===p.default.htmlElementNetwork||t===p.default.htmlElementSrcNotSupported||t===p.default.htmlElementDecode||(e.isExpected||n&&(function(e){var t=e.code;return!!t&&t.indexOf("timeout")>=0})(e))&&(t===p.default.htmlDashlingManifestDownload||t===p.default.htmlDashlingInitSegmentDownload||t===p.default.htmlDashlingMediaSegmentDownload)})(i)&&!a){this.videoStatus({isVisible:!0,statusMessage:r,error:i});this.isLoading(!1);this.isPlaying(!1);this.canPlay(!1);if((!i||i.isRetriable)&&!this.isSeeking.peek()&&this.duration.peek()){var f=this.duration.peek(),l=f?this.position.peek()/f:0;this.seekPercentage(l);this.isSeeking(!0)}}else{var c=n.__assign(n.__assign({},s),((t={})[o]=e,t));this._errorsByType(c)}};t.prototype.getRequestParametersAsync=function(e){return this._videoItemDataSource.getRequestParametersAsync(this.item.peek(),e)};t.prototype.testConnectivity=function(e){return i.default.resolve(this._networkTester.testConnectivity(e))};t.prototype.isPlaybackEncrypted=function(){return this._encryptedPlaybackRequested&&(y.isFeatureEnabled(y.VideoEnableEncyrption)||y.isFeatureEnabled(y.VideoUseCdn))};t.prototype.isPlaybackUsingCDN=function(){return this._encryptedPlaybackRequested&&y.isFeatureEnabled(y.VideoUseCdn)};t.prototype.hasVideoQuality=function(e){return-1!==this.dashQualities.peek().indexOf(e)};t.prototype.getTotalPlayTimeMs=function(){if(this.isPlaying.peek()){var e=Date.now();this.totalPlayTimeMs=this.totalPlayTimeMs+(e-this.lastPlayStartTime);this.lastPlayStartTime=e}return this.totalPlayTimeMs};t.prototype.resetSessionTelemetry=function(){this.totalPlayTimeMs=0;this.totalRebufferingTimeMs=0;this.cacheHitCount=0;this.cacheMissCount=0};t.prototype.getTotalRebufferingTimeMs=function(){if(this.isLoading.peek()&&!this.isSeeking.peek()){var e=Date.now();this.totalRebufferingTimeMs=this.totalRebufferingTimeMs+(e-this.lastLoadingStartTime);this.lastLoadingStartTime=e}return this.totalRebufferingTimeMs};t.prototype.publishResponseMetaData=function(e){if(e&&e.headers&&-1!==["init","media"].indexOf(e.requestType)){var t=e.headers;"TCP_HIT"===t["x-cache"]?this.cacheHitCount++:"TCP_MISS"===t["x-cache"]&&this.cacheMissCount++}};t.prototype._cancelGetDownload=function(){if(this._pendingGetDownloadPromise){this._pendingGetDownloadPromise.cancel();this._pendingGetDownloadPromise=null}};t.prototype._onIsLoadingChanged=function(e){this.isSeeking.peek()||(e?this.lastLoadingStartTime=Date.now():this.totalRebufferingTimeMs=this.totalRebufferingTimeMs+(Date.now()-this.lastLoadingStartTime))};t.prototype._onIsPlayingChanged=function(e){var t=this,n=this.videoStatus.peek();e?this.lastPlayStartTime=Date.now():this.totalPlayTimeMs=this.totalPlayTimeMs+(Date.now()-this.lastPlayStartTime);if(e&&n.isVisible){var r=this.url.peek(),i=n.error;this.url(null);i&&i.requiresNewUrl?this._getNewDownloadUrl(!1).done(function(e){t._reset(e,!0)}):this._reset(r,!0)}};t.prototype._computeItemKey=function(){var e=this.item();return e?e.key:null};t.prototype._computeHasError=function(){return this.videoStatus().isVisible};t.prototype._computeCanAdjustQuality=function(){return this.playbackType()===v.default.htmlDashling};t.prototype._computeShouldUseNativeControls=function(){return O.isIOS};t.prototype._computeCanvasType=function(){switch(this.playbackType()){case v.default.flashDash:case v.default.flashMp4:return b.default.flash;default:return b.default.html}};t.prototype._onItemChanged=function(e){if(e&&this._lastItemKey!==e.key){this._lastItemKey=e.key;this._reset(null)}};t.prototype._reset=function(e,t){var n=this.item.peek(),r=n&&n.thumbnail,i=null;r&&(i=s.format(r.url,r.width,r.height));this.cacheHitCount=0;this.cacheMissCount=0;this._cancelGetDownload();this.coverImageUrl(i);this.videoStatus({isVisible:!1,error:void 0});this.canPlay(!1);if(!t){this.isSeeking(!1);this.seekPercentage(0);this.position(0);this.duration(0);this.totalPlayTimeMs=0;this.totalRebufferingTimeMs=0;this.lastPlayStartTime=0;this.playbackSessionId=c.generate()}this.isLoading(!0);this.url(e)};t.prototype._onIsAdjustingVolumeChanged=function(e){e&&this.isMuted(!1)};t.prototype._getStreamingType=function(e){if(!this.disableTranscode()&&this._videoItemDataSource.isStreamingSupported(e)){if(k)return v.default.htmlDashling;if(C&&this._videoItemDataSource.isHlsPlaybackSupported())return v.default.htmlHls;if(0===L){this._evaluateFlashSupport();return v.default.flashPending}if(1===L)return v.default.flashPending;if(2===L)return v.default.flashDash}};t.prototype._getPlaybackType=function(e,t){if(!A)return v.default.none;var n=t[v.default.htmlMp4],r=this._policyAllowsNative(e),i=!n&&this._canPlayNative(e)&&r,s=this._shouldPreferNative(e),o=t[v.default.htmlDashling]||t[v.default.htmlHls]||t[v.default.flashDash];if(this._encryptedPlaybackRequested&&o&&o.error&&-1!==M.indexOf(o.error.type))return this.playbackType.peek();if(i&&s)return v.default.htmlMp4;var u=this._getStreamingType(e);if(!o&&u)return u;if(y.isFeatureEnabled(y.VideoAttemptFfmpegToMediaFoundationFallback)&&this.useBetaTranscode()&&o&&u===v.default.htmlDashling){this.useBetaTranscode(!1);return v.default.htmlDashlingMediaFoundationFallback}var a=n||t[v.default.htmlFallback];return i?v.default.htmlMp4:!a&&r?v.default.htmlFallback:u||r?u&&y.isFeatureEnabled(y.VideoModePreferStreamError)?u:this._getPlaybackType(e,{}):v.default.none};t.prototype._evaluateItemPlayability=function(){var e=this,t=this.item(),n=!(!t||t.did||!t.video&&!t.audio),r=v.default.none,i=this.videoStatus(),s=t&&0===t.size,o=i.error,u=!o||o.isRetriable,a=this.useBetaTranscode(),f=this._lastBetaSetting;this._lastBetaSetting=a;var l=this._errorsByType();!s&&n&&(r=this._getPlaybackType(t,l));if(this._encryptedPlaybackRequested&&l&&l[r]&&this.playbackType.peek()===r)this._getNewDownloadUrl(!1).done(function(t){e.url.peek()===t?e.setVideoStatus(l[r]):e._reset(t,!0)});else{if(y.isFeatureEnabled(y.VideoModePreferStreamError)){var c=l[r];if(c){this.setVideoStatus(c);return}}if(r===this.playbackType.peek()){if(i.isVisible&&!u){this.playbackType(v.default.none);return}if(t.key===this._lastItemKey&&this.url()&&a===f)return}if(s)this.setVideoStatus({statusMessage:m.default.errorEmptyFile,error:new h.VideoError({code:"FromMetadata",type:p.default.emptyFile,isExpected:!0,isRetriable:!1})});else if(n){if(r!==v.default.flashPending)if(r!==v.default.none){this.playbackType(r);var d=l[r];if(d){this.setVideoStatus(d);return}this._getNewDownloadUrl(!0).done(function(t){var n=r===v.default.htmlDashlingMediaFoundationFallback;e._reset(t,n)})}else{var g=D()||p.default.unsupportedBrowser;this.setVideoStatus({statusMessage:m.default.errorUnsupportedBrowser,error:new h.VideoError({code:"",type:g,isExpected:!0,isRetriable:!1})})}}else t&&!t.isPlaceholder&&this.setVideoStatus({statusMessage:m.default.errorUnsupportedFormat,error:new h.VideoError({code:"NotVideo",type:p.default.unsupportedFormat,isExpected:!0,isRetriable:!1})})}};t.prototype._evaluateFlashSupport=function(){var e=this;L=1;g.default.checkFlashSupport(S,function(t){if(!e.isDisposed){L=t?2:3;e._evaluateItemPlayability()}})};t.prototype._shouldPreferNative=function(e){var t,n=e.video,r=(void 0===n?{}:n).bitrate,i=void 0===r?void 0:r,s=(e.extension||"").toLowerCase();return!(!e.audio||".mp3"!==s)||(!!(i&&i<=3e6)||(!i&&".mp4"===e.extension&&e.size<=5242880||!(!(null===(t=e.photo)||void 0===t?void 0:t.isLivePhoto)||!y.isFeatureEnabled(y.EnableLivePhotoVideos))))};t.prototype._canPlayNative=function(e){var t=(e.extension||"").toLowerCase();if(e.audio&&".mp3"===t)return!0;if(T&&".webm"===t)return!0;var n=e?e.video:null;return n&&"H264"===n.fourCC&&x&&("PCM"!==n.audioFormat||N)||!1};t.prototype._policyAllowsNative=function(e){return!this._videoItemDataSource.isDownloadBlocked(e)};t.prototype._supportsDecryption=function(){var e=this.playbackType.peek();return(e===v.default.htmlDashling||e===v.default.htmlDashlingMediaFoundationFallback)&&r.default.supportsDecryption()};t.prototype._getNewDownloadUrl=function(e){var t=this;if(this._pendingGetDownloadPromise)return this._pendingGetDownloadPromise;this._encryptedPlaybackRequested=e&&this._supportsDecryption();var n=this._videoItemDataSource.getDownloadUrl({item:this.item.peek(),playbackType:this.playbackType.peek(),useBetaTranscode:this.useBetaTranscode.peek(),preferEncryption:this._encryptedPlaybackRequested});this._pendingGetDownloadPromise=this.trackPromise(n);return this._pendingGetDownloadPromise.then(function(e){t._pendingGetDownloadPromise=null;return e},function(e){t._pendingGetDownloadPromise=null;if(!i.default.isCanceled(e)){var n=e instanceof Error&&e,r={code:e.name,type:p.default.getDownloadUrlFailure,message:n&&n.message,isRetriable:!1,requiresNewUrl:!0};if(n instanceof l.ApiError){r.correlationId=n.correlationId;r.code=n.code||n.name;r.isExpected=n.isExpected}t.setVideoStatus({statusMessage:m.default.errorLoading,error:new h.VideoError(r)})}return i.default.reject(e)})};return t})(u.default);t.default=_;function D(){return A?x?k?void 0:p.default.mediaSourceUnsupported:p.default.h264Unsupported:p.default.html5VideoUnsupported}t.getMissingCapability=D;function P(e,t){try{var n=e.canPlayType(t);return n&&"no"!==n.toLowerCase()}catch(e){return!1}}});
define("@ms/dashling/lib/Dashling",["require","exports","tslib","./Settings","./StreamController","./DashlingEnums","./ManifestParser","@uifabric/utilities/lib/EventGroup","./Decryptor"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=0,l=(function(){function e(e){this.isDisposed=!1;this.settings=n.__assign(n.__assign({},r.defaultSettings),e||{});this._events=new u.EventGroup(this);this.reset()}e.supportsDecryption=function(){return a.hasCryptoSupport()};e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;this._events.dispose();this.reset();this._decryptor&&this._decryptor.dispose()}};e.prototype.load=function(e,t){this.reset();this._sessionIndex=++f;this.startTime=Date.now();this._setState(s.DashlingSessionState.initializing);this.videoElement=e;this._initializeManifest(t)};e.prototype.reset=function(){this.timeAtFirstCanPlay=null;this.startTime=null;this.lastError=null;this.streamController&&this.streamController.dispose();this.streamController=null;this._parser&&this._parser.dispose();this._parser=null;if(this.videoElement){this.settings.manifest=null;try{this.videoElement.pause()}catch(e){}}this.videoElement=null;this._mediaSource=null;this._setState(s.DashlingSessionState.idle)};e.prototype.resetStreams=function(){this.streamController&&this.streamController.reset()};e.prototype.getRemainingBuffer=function(){return this.streamController?this.streamController.getRemainingBuffer():0};e.prototype.getBufferRate=function(){return this.streamController?this.streamController.getBufferRate():0};e.prototype.getPlayingQuality=function(e){return this.streamController?this.streamController.getPlayingQuality(e):this.settings.targetQuality[e]};e.prototype.getBufferingQuality=function(e){return this.streamController?this.streamController.getBufferingQuality(e):this.settings.targetQuality[e]};e.prototype.getMaxQuality=function(e){var t=this.settings.manifest?this.settings.manifest.streams[e]:null;return t?t.qualities.length-1:0};e.prototype._setState=function(e,t,n,r,i){if(!this.isDisposed&&this.state!==e){this.state=e;this.lastErrorType=t;this.lastErrorMessage=n;this.lastHttpStatus=r;this.lastCorrelationId=i;this.lastError=t?t+" "+(n?"("+n+")":""):null;e===s.DashlingSessionState.error&&this.streamController&&this.streamController.dispose();this.timeAtFirstCanPlay||e!==s.DashlingSessionState.playing&&e!==s.DashlingSessionState.paused||(this.timeAtFirstCanPlay=Date.now()-this.startTime);this._events.raise("sessionstatechange",{state:e,errorType:t,errorMessage:n,httpStatus:r});if(this.videoElement)switch(e){case s.DashlingSessionState.initializing:case s.DashlingSessionState.buffering:u.EventGroup.raise(this.videoElement,"waiting",null);break;case s.DashlingSessionState.playing:u.EventGroup.raise(this.videoElement,"playing",null);break;case s.DashlingSessionState.error:case s.DashlingSessionState.disconnected:u.EventGroup.raise(this.videoElement,"error",null)}}};e.prototype._initializeMediaSource=function(e){var t=this,n=t._sessionIndex;try{var r=new MediaSource,i=function(){r.removeEventListener("sourceopen",i);if(t._sessionIndex===n){t._mediaSource=r;t._tryStart()}};r.addEventListener("sourceopen",i,!1);e.src=URL.createObjectURL(r)}catch(e){t._setState(s.DashlingSessionState.error,"mediaSourceInit")}};e.prototype._isDataEncrypted=function(){var e=this.settings&&this.settings.manifest&&this.settings.manifest.streams?this.settings.manifest.streams:null;if(e)for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.contentProtection&&r.contentProtection.keySystemUri)return!0}return!1};e.prototype._initializeManifest=function(e){var t=this,n=this._sessionIndex,r=function(e){if(t._sessionIndex===n&&t.state!==s.DashlingSessionState.error){t.settings.manifest=e;t._isDataEncrypted()?t._initializeDecryptor():t._initializeMediaSource(t.videoElement)}};if(this.settings.manifest)r(this.settings.manifest);else{(this._parser=new o.ManifestParser(this.settings)).parse(e,r,function(e,r,i,o){t._sessionIndex===n&&t._setState("networkDisconnected"===e?s.DashlingSessionState.disconnected:s.DashlingSessionState.error,e,r,i,o)})}};e.prototype._initializeDecryptor=function(){var e=this,t=this.settings&&this.settings.manifest&&this.settings.manifest.streams?this.settings.manifest.streams:null,n=function(e,n){for(var r=!1,s=0,o=Object.values(t);s<o.length;s++){var u=o[s];if(u.contentProtection&&u.contentProtection.keySystemUri===n.keySystemUri&&u.contentProtection.keyUri===n.keyUri&&!u.importedKey){u.importedKey=e;r=!0}}r&&i()},r=function(t){switch(t.step){case"keyfetch":e._setState(s.DashlingSessionState.error,"aesKeyFetchError",t.request.statusCode,t.request.httpStatus,t.request.correlationId);break;case"init":e._setState(s.DashlingSessionState.error,"webCryptoInitError",a.getDecryptorErrorString(t))}},i=function(){for(var n=0,r=Object.values(t);n<r.length;n++){var i=r[n];if(i.contentProtection&&!i.importedKey)return}e._initializeMediaSource(e.videoElement)},o=!1;if(t){var u=[];try{for(var f=function(e){if(e.contentProtection&&e.contentProtection.keyUri){if(!(u&&u.some(function(t){return t.keyUri===e.contentProtection.keyUri}))){l._decryptor||(l._decryptor=new a.Decryptor(l.settings));o=!0;l._decryptor.init(e.contentProtection,n,r);u.push(e.contentProtection)}}},l=this,c=0,h=Object.values(t);c<h.length;c++){f(h[c])}}catch(e){this._setState(s.DashlingSessionState.error,"webCryptoInitError");return}o||this._initializeMediaSource(this.videoElement)}};e.prototype._tryStart=function(){var e=this,t=this._mediaSource,n=this.videoElement,r=this.settings;if(!this.isDisposed&&this.state!==s.DashlingSessionState.error&&t&&n&&r.manifest){t.duration=r.manifest.mediaDuration;var o=new i.default(n,t,r,this._decryptor);this.streamController=o;this._events.on(o,"sessionstatechange",function(t){e._setState(t.state,t.errorType,t.errorMessage,t.httpStatus,t.correlationId)});o.start()}};return e})();t.default=l});
define("@ms/dashling/lib/Settings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultSettings={manifest:null,startTime:0,isABREnabled:!0,isRBREnabled:!1,targetQuality:{audio:2,video:2},abrLimitQuality:null,shouldAutoPlay:!0,logToConsole:!1,safeBufferSeconds:12,maxBufferSeconds:119.5,maxConcurrentRequests:{audio:4,video:6},maxSegmentLeadCount:{audio:1,video:5},defaultBandwidth:520,requestTimeout:3e4,maxRetries:3,delaysBetweenRetries:[200,1500,3e3],requestCacheThreshold:80,baseUrlOverride:null,preprocessRequest:null,getRequestParametersAsync:null,testConnectivity:null,missingSegmentThreshold:0,publishResponseMetaData:null}});
define("@ms/dashling/lib/StreamController",["require","exports","@uifabric/utilities/lib/EventGroup","./Async","./Stream","./MetricSet","./Utilities","./DashlingEnums"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;(function(e){e[e.closed=0]="closed";e[e.open=1]="open";e[e.ended=2]="ended"})(a||(a={}));var f=(function(){function e(e,t,i,o){this._events=new n.EventGroup(this);this._async=new r.default(this);this._mediaSource=t;this._settings=i;this._bufferRate=new s.MetricSet(3);this._appendedSeconds=0;this._requestTimerIds=[0,0];this.streams=[];this._appendIndex=0;this._nextRequestTimerId=0;this._seekingTimerId=0;this.stalls=0;this._lastCurrentTime=0;this._lastTimeBeforeSeek=0;this._startTime=0;this._videoElement=e;this._playbackMonitorId=0;this._canPlay=!0;this._timeAtStall=0;this._isDisposed=!1;this._decryptor=o;this._intializeVideoElement();this._initializeStreams(e,t,i);if(this.streams.length&&i&&i.startTime){var u=this.streams[0],a=u.fragments[0].time.lengthSeconds;this._appendIndex=Math.max(0,Math.min(u.fragments.length-1,Math.floor((i.startTime-.5)/a)))}}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._adjustPlaybackMonitor(!1);this._events.dispose();this._async.dispose();for(var e=0;this.streams&&e<this.streams.length;e++)this.streams[e].dispose();this._videoElement=null;this._mediaSource=null;this._decryptor=null}};e.prototype.start=function(){this._startTime=Date.now();this._setCanPlay(!1);this._loadNextFragment();this._adjustPlaybackMonitor(!0)};e.prototype.getPlayingQuality=function(e){if(!this._isDisposed)for(var t=0,n=this.streams;t<n.length;t++){var r=n[t];if(r.streamType===e){var i=this._videoElement.currentTime,s=Math.min(r.fragments.length-1,Math.floor(i/r.fragments[0].time.lengthSeconds)),o=r.fragments[s].qualityIndex;return o>=0?o:r.qualityIndex}}return 0};e.prototype.getBufferingQuality=function(e){if(!this._isDisposed)for(var t=0,n=this.streams;t<n.length;t++){var r=n[t];if(r.streamType===e)return r.qualityIndex}return 0};e.prototype.getBufferRate=function(){return this._bufferRate.average};e.prototype.getRemainingBuffer=function(e){var t=0;if(!this._isDisposed){var n=(this._settings.startTime||this._videoElement.currentTime)+(e||0),r=this._videoElement.buffered;!n&&r.length>0&&r.start(0)<1&&(n=r.start(0));for(var i=0;i<r.length;i++)if(n>=r.start(i)&&n<=r.end(i)){for(var s=r.end(i);++i<r.length&&r.start(i)-s<.06;)s=r.end(i);t=s-n;break}}return t};e.prototype.getTimeUntilUnderrun=function(e){var t=Number.MAX_VALUE;if(!this._isDisposed){var n=this._settings.startTime||Math.max(.5,this._videoElement.currentTime),r=this._settings.manifest.mediaDuration-n-.5,i=this.getRemainingBuffer(e),s=this.getBufferRate(),o=Math.min(1,Math.max(0,i/this._settings.safeBufferSeconds));if(r>i){(t=i+o*(i*s))>Math.min(r,.5*this._settings.maxBufferSeconds)&&(t=Number.MAX_VALUE)}}return t};e.prototype.reset=function(){this._onThrottledSeek(!0)};e.prototype._intializeVideoElement=function(){var e=this._videoElement;e&&this._events.onAll(e,{seeking:this._onVideoSeeking,error:this._onVideoError,play:this._onPauseStateChange,pause:this._onPauseStateChange,ended:this._onVideoEnded,ratechange:this._onVideoRateChange})};e.prototype._initializeStreams=function(e,t,n){var r=n&&n.manifest&&n.manifest.streams||null,s=[];if(r){r.audio&&s.push(new i.Stream("audio",t,e,n,this._decryptor));r.video&&s.push(new i.Stream("video",t,e,n,this._decryptor))}this.streams=s;for(var o=this._events,u=function(e){o.raise("sessionstatechange",e)},a=0,f=s;a<f.length;a++){var l=f[a];o.on(l,"sessionstatechange",u);l.initialize()}};e.prototype._loadNextFragment=function(){var e=this;if(!e._isDisposed){for(var t=function(t,n){if(!e._isDisposed){var r=e._requestTimerIds;r[t]&&e._async.clearTimeout(r[t]);r[t]=e._async.setTimeout(function(){r[t]=0;e._loadNextFragment()},n)}},n=e._getDownloadCandidates(),r=0;r<n.downloads.length;r++)for(var i=n.downloads[r],s=e.streams[r],o=0;o<i.length;o++){var a=i[o],f=s.fragments[a-1],l=f&&f.activeRequest,c=l&&l.state===u.DashlingRequestState.downloading?l:null,h=s.getRequestStaggerTime(),p=c?Date.now()-c.startTime:0;if(c&&!(p>=h)){t(r,h-p);break}s.load(a,function(){e._appendNextFragment()})}n.isAtMax&&t(0,300)}};e.prototype._appendNextFragment=function(){var e,t,n=this,r=n.streams;if(!n._isDisposed){var i=n._settings.startTime||n._videoElement.currentTime,s=n._mediaSource;if(r&&r.length&&s&&!l(s.readyState,a.closed)){for(;n._appendIndex<r[0].fragments.length;){var o=!0,f=!0;for(t=0;t<r.length;t++){e=r[t];o=o&&e.canAppend(n._appendIndex);var c=e.fragments[n._appendIndex].state;f=f&&(c===u.DashlingRequestState.appended&&!e.isMissing(n._appendIndex,i)||c===u.DashlingRequestState.endOfStream)}if(o){f=!1;for(t=0;t<r.length;t++){(e=r[t]).append(n._appendIndex,function(){n._appendNextFragment()});c=e.fragments[n._appendIndex].state;f=f&&(c===u.DashlingRequestState.appended||c===u.DashlingRequestState.endOfStream)}}if(!f)break;var h=n.streams[0].fragments[n._appendIndex];if(!h.activeRequest.hasUpdatedBufferRate){h.activeRequest.hasUpdatedBufferRate=!0;n._appendedSeconds+=h.time.lengthSeconds;var p=(Date.now()-n._startTime)/1e3;n._bufferRate.append(n._appendedSeconds/(p||.1))}n._appendIndex++;if(n._settings.startTime)try{n._videoElement.currentTime=n._settings.startTime;n._settings.startTime=0}catch(e){}n._checkCanPlay()}n._appendIndex===r[0].fragments.length&&l(s.readyState,a.open)&&s.endOfStream();n._loadNextFragment()}}};e.prototype._adjustPlaybackMonitor=function(e){var t=this;if(!e&&t._playbackMonitorId){t._async.clearTimeout(t._playbackMonitorId);t._playbackMonitorId=0}else e&&!t._playbackMonitorId&&(t._playbackMonitorId=t._async.setInterval(function(){t._checkCanPlay()},200))};e.prototype._checkCanPlay=function(){var e=this,t=e.getTimeUntilUnderrun(),n=e._videoElement,r=e._lastCurrentTime=n.currentTime;if(e._canPlay&&t<.1&&!e._timeAtStall){e._timeAtStall=e._lastCurrentTime;e._async.setTimeout(function(){var t=e._timeAtStall;e._timeAtStall=0;if(!e._isDisposed&&n.currentTime===t){e.stalls++;e._setCanPlay(!1)}},200)}if(!e._canPlay){if(t>e.streams[0].fragments[0].time.lengthSeconds&&e.getBufferRate()>1||t>e._settings.safeBufferSeconds)e._setCanPlay(!0);else if(e.getTimeUntilUnderrun(.5)>e._settings.safeBufferSeconds){n.currentTime=Math.min(r+.5,n.duration);e._setCanPlay(!0)}}e._events.raise("sessionstatechange",{state:e._canPlay?e._videoElement.paused?u.DashlingSessionState.paused:u.DashlingSessionState.playing:u.DashlingSessionState.buffering})};e.prototype._getDownloadCandidates=function(){var e=this._getCurrentFragmentRange(),t=[],n=0;if(e.start>-1){this._ensureStreamsUpdated(e);var r=this._getMissingFragmentIndex(e);if(r>=0){e.start=Math.max(e.start,r);for(var i=0;i<this.streams.length;i++){var s=this.streams[i],o=this._getDownloadableIndexes(s,e);t.push(o);n+=o.length}}}return{downloads:t,isAtMax:!n&&e.end>=0&&e.end<this.streams[0].fragments.length-1}};e.prototype._getCurrentFragmentRange=function(){var e=this._videoElement,t=this._settings.manifest.mediaDuration;if(t>0){var n=this._settings.startTime||e.currentTime,r=n+.005>=t,i=this.streams[0],s=i.fragments.length,o=i.fragments[0].time.lengthSeconds;if(!r){n>.5&&(n-=.5);return{start:Math.max(0,Math.min(s-1,Math.floor(n/o))),end:Math.max(0,Math.min(s-1,Math.ceil((n+this._settings.maxBufferSeconds)/o)))}}}return{start:-1,end:-1}};e.prototype._ensureStreamsUpdated=function(e){for(var t=this._videoElement.currentTime,n=0,r=this.streams;n<r.length;n++){var i=r[n];i.assessQuality();for(var s=e.start;s<=e.end;s++)if(i.isMissing(s,t)){var a=i.fragments[s];o.log("Missing fragment reset: stream="+i.streamType+"index="+s+" ["+a.time.startSeconds+"]",this._settings);i.fragments[s].state=u.DashlingRequestState.idle}}};e.prototype._getMissingFragmentIndex=function(e){for(var t=e.start;t<=e.end;t++)for(var n=0,r=this.streams;n<r.length;n++){if(r[n].fragments[t].state<=u.DashlingRequestState.idle)return t}return-1};e.prototype._getDownloadableIndexes=function(e,t){for(var n=[],r=Math.min(t.end,t.start+this._settings.maxSegmentLeadCount[e.streamType]),i=this._settings.maxConcurrentRequests[e.streamType]-e.getActiveRequestCount(),s=t.start;n.length<i&&s<=r;s++)e.fragments[s].state<=u.DashlingRequestState.idle&&n.push(s);return n};e.prototype._setCanPlay=function(e){if(this._canPlay!==e){this._canPlay=e;this._onVideoRateChange()}};e.prototype._onVideoSeeking=function(){this._lastTimeBeforeSeek||(this._lastTimeBeforeSeek=this._lastCurrentTime);this._seekingTimerId&&this._async.clearTimeout(this._seekingTimerId);this._setCanPlay(!1);this._settings.startTime=0;this._seekingTimerId=this._async.setTimeout(this._onThrottledSeek,300)};e.prototype._onThrottledSeek=function(e){if(!this._isDisposed){var t=this._videoElement.currentTime,n=Math.floor(Math.max(0,t-.5)/this.streams[0].fragments[0].time.lengthSeconds),r=this._videoElement.buffered,i=1===r.length&&r.start(0)<=Math.max(0,t-2)&&r.end(0)>t;o.log("Throttled seek: "+this._videoElement.currentTime,this._settings);this._seekingTimerId=0;this._lastTimeBeforeSeek=0;this._async.clearTimeout(this._nextRequestTimerId);this._nextRequestTimerId=0;var s=e||this._appendIndex<n,u=e||this._settings.manifest.mediaDuration>this._settings.maxBufferSeconds&&!i;this._appendIndex=n;o.log("Clearing buffer",this._settings);for(var a=0,f=this.streams;a<f.length;a++){var l=f[a];s&&l.abortAll();u&&l.clearBuffer()}this._appendNextFragment()}};e.prototype._onVideoError=function(){this._events.raise("sessionstatechange",{state:u.DashlingSessionState.error,errorType:"videoElementError",errorMessage:o.getVideoError(this._videoElement)})};e.prototype._onPauseStateChange=function(){this._adjustPlaybackMonitor(!this._videoElement.paused);this._checkCanPlay()};e.prototype._onVideoEnded=function(){this._events.raise("sessionstatechange",{state:u.DashlingSessionState.paused})};e.prototype._onVideoRateChange=function(){var e=this._canPlay?1:0,t=this._videoElement;t.playbackRate!==e&&(t.playbackRate=t.defaultPlaybackRate=e)};return e})();t.default=f;function l(e,t){return e===t||e===a[t]}});
define("@ms/dashling/lib/Async",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.clearTimeout,r=window.setTimeout,i=window.setInterval,s=(function(){function e(e){this._parent=e;this._throttleIds={};this._timeoutIds={}}e.prototype.dispose=function(){if(this._throttleIds){for(var e in this._throttleIds)n(this._throttleIds[e]);this._throttleIds=null}for(var e in this._timeoutIds)n(Number(e));this._timeoutIds=null};e.prototype.setTimeout=function(e,t){return this._setTimer(e,t,r)};e.prototype.setInterval=function(e,t){return this._setTimer(e,t,i)};e.prototype.clearTimeout=function(e){n(e);this._timeoutIds&&delete this._timeoutIds[e]};e.prototype.throttle=function(e,t,n){var i=this,s=this._throttleIds;s&&(s[t]||(s[t]=r(function(){e.apply(i._parent);delete s[t]},n)))};e.prototype._setTimer=function(e,t,n){var r=this;if(this._timeoutIds){var i;(i=n(function(){r._timeoutIds&&delete r._timeoutIds[i];e.apply(r._parent)},t))&&(this._timeoutIds[i]=i);return i}return 0};return e})();t.default=s});
define("@ms/dashling/lib/Stream",["require","exports","./RequestManager","./Request","@uifabric/utilities/lib/EventGroup","./Utilities","./Async","./MetricSet","./Storage","./DashlingEnums","./Decryptor"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(){function e(e,t,r,s,l){var c=s.manifest,h=c.streams[e];this._events=new i.EventGroup(this);this._async=new o.default(this);this._storage=new a.Storage("Dashling.Stream.");this.streamType=e;this.qualityIndex=Math.max(0,Math.min(h.qualities.length-1,s.targetQuality[e]));this.bufferRate=new u.MetricSet(5);this._startTime=Date.now();this._appendLength=0;this._appendTimeoutId=0;this._initRequestManager=new n.RequestManager(s);this.requestManager=new n.RequestManager(s);this._mediaSource=t;this._videoElement=r;this._settings=s;this._manifest=c;this._streamInfo=h;this._buffer=null;this._hasInitializedBuffer=!1;this._initSegments=[];this._isAppending=!1;this._isDisposed=!1;this._decryptor=l;var p=h.timeline.map(function(e,t){return{state:f.DashlingRequestState.idle,qualityIndex:-1,qualityId:"",requestType:"media",fragmentIndex:t,time:e,activeRequest:null,requests:[]}});this.fragments=p}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._events.dispose();this._async.dispose();this.requestManager.dispose();this._initRequestManager.dispose()}};e.prototype.initialize=function(){var e=this._streamInfo.mimeType+";codecs="+this._streamInfo.codecs,t=this._events;if(!this._buffer)try{s.log("Creating "+e+" buffer",this._settings);var n=this._buffer=this._mediaSource.addSourceBuffer(e);t.on(n,"error",function(n){t.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"sourceBufferError",errorMessage:"type="+e+" error="+n})})}catch(n){t.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"sourceBufferInit",errorMessage:"type="+e+" error="+n})}};e.prototype.abortAll=function(){this.requestManager.abortAll()};e.prototype.clearBuffer=function(){this._async.clearTimeout(this._appendTimeoutId);this._isAppending=!1;this.abortAll();try{this._buffer.remove(0,this._videoElement.duration)}catch(e){}for(var e=0,t=this.fragments;e<t.length;e++){var n=t[e];n.state!==f.DashlingRequestState.downloaded&&(n.state=f.DashlingRequestState.idle)}};e.prototype.canAppend=function(e){var t=this.fragments[e],n=t&&this._initSegments[t.qualityIndex],r=this._initSegments[this._streamInfo.qualities.length-1];return!!(t&&t.state===f.DashlingRequestState.downloaded&&n&&n.state>=f.DashlingRequestState.downloaded&&r&&r.state>=f.DashlingRequestState.downloaded)};e.prototype.append=function(e,t){var n=this,r=n.fragments,i=r[e],o=n._streamInfo.qualities.length-1,u=[],a=n._buffer,l=n._settings.missingSegmentThreshold;if(!n._isAppending&&i&&i.state===f.DashlingRequestState.downloaded){n._isAppending=!0;i.state=f.DashlingRequestState.appending;if(!this._hasInitializedBuffer){this._hasInitializedBuffer=!0;o>i.qualityIndex&&u.push(n._initSegments[o])}u.push(n._initSegments[i.qualityIndex]);u.push(i.activeRequest);c()}else i&&i.state===f.DashlingRequestState.endOfStream&&t(i);function c(){if(!n._isDisposed)if(a.updating)n._appendTimeoutId=n._async.setTimeout(c,10);else{var o=u[0];if(u.length){n._events.on(a,"updateend",p);try{h("started",o);a.appendBuffer(o.data)}catch(e){if(e.code===DOMException.QUOTA_EXCEEDED_ERR){s.log("Append failed due to quota exception; trying again momentarily");n._events.off(a);n._appendTimeoutId=setTimeout(c,500)}else d("sourceBufferAppendException",e)}}else n._appendTimeoutId=n._async.setTimeout(function(){if(!n._isDisposed){var s=i.activeRequest&&i.activeRequest.hasStreamEnded;i.state=s?f.DashlingRequestState.endOfStream:f.DashlingRequestState.appended;n._isAppending=!1;var o=e-r.length,u=n.isMissing(e,n._videoElement.currentTime);if(u&&o<l)d("sourceBufferAppendMissing","Buffer missing "+n._streamInfo.mimeType+" fragment at end-relative index "+o);else{u&&(i.state=f.DashlingRequestState.endOfStream);var a=(Date.now()-n._startTime)/1e3;n._appendLength+=i.time.lengthSeconds;n.bufferRate.append(n._appendLength/a);t(i)}}},30)}}function h(e,t){s.log("Append "+e+": "+n.streamType+" "+t.qualityId+" "+t.requestType+" "+(void 0!==t.fragmentIndex?"index "+t.fragmentIndex:""),n._settings)}function p(){if(!n._isDisposed){var e=u[0];n._events.off(a);e.timeAtAppended=Date.now()-e.startTime;e.state=f.DashlingRequestState.appended;e.clearDataAfterAppend&&(e.data=null);h("complete",e);u.shift();c()}}function d(t,r){var o="error="+(r=r||"")+" (quality="+i.qualityId+(void 0!==e?" index="+e:"")+")";i.state=f.DashlingRequestState.error;n._isAppending=!1;s.log("Append exception: "+o);n._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:t,errorMessage:o})}};e.prototype.getBufferRate=function(){return this.bufferRate.average||0};e.prototype.getActiveRequestCount=function(){return this.requestManager.getActiveRequestCount()};e.prototype.getRequestStaggerTime=function(){return Math.round(1400*this._estimateDownloadSeconds(this.qualityIndex))};e.prototype.isMissing=function(e,t){return this.fragments[e].state===f.DashlingRequestState.appended&&!this.isBuffered(e,t)};e.prototype.isBuffered=function(e,t){var n=this.fragments[e];if(n){var r=this._buffer.buffered,i=n.time,s=i.startSeconds,o=i.lengthSeconds,u=s<.3,a=s+o+.3>=this._manifest.mediaDuration,f=Math.max(t,s+(u?.8:.15)),l=s+o-(a?.8:.15);try{for(var c=0;c<r.length;c++)if(r.start(c)<=f&&r.end(c)>=l)return!0}catch(e){return!0}}return!1};e.prototype.canLoad=function(e){return this.fragments[e].state<=f.DashlingRequestState.idle};e.prototype.load=function(e,t){var n=this,i=this,o=i.fragments,u=o[e],a=function(t){for(var n=e+t,r=o.length;n<r;n++)o[n].state=f.DashlingRequestState.endOfStream},c=function(e){i._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"segmentDecryptionError",errorMessage:l.getDecryptorErrorString(e)})};if(u&&u.state<=f.DashlingRequestState.idle){u.state=f.DashlingRequestState.downloading;u.qualityIndex=i.qualityIndex;u.qualityId=this._streamInfo.qualities[u.qualityIndex].id;i._loadInitSegment(this.qualityIndex,t);var h=new r.Request({url:i._getUrl(u),fragmentIndex:e,requestType:"media",qualityIndex:u.qualityIndex,qualityId:u.qualityId,clearDataAfterAppend:!0,isArrayBuffer:!0,onSuccess:function(e){i._isDisposed||n._decryptResponseIfNeeded(e,function(){u.state=f.DashlingRequestState.downloaded;e.hasStreamEnded&&a(1);var n=Math.round(e.timeAtLastByte-e.timeAtFirstByte),r=e.timeAtLastByte-n;s.log("Download complete: "+e.qualityId+" "+e.requestType+" index: "+e.fragmentIndex+" waiting: "+r+"ms receiving: "+n,i._settings);t()},function(e){c(e)})},onError:function(e){if(!i._isDisposed)if(e.state===f.DashlingRequestState.disconnected){u.state=f.DashlingRequestState.idle;u.activeRequest=null;u.requests=[];i._events.raise("sessionstatechange",{state:f.DashlingSessionState.disconnected,errorTYpe:"mediaSegmentDownload",errorMessage:e.statusCode,httpStatus:e.httpStatus,correlationId:e.correlationId})}else if(e.isAborted){u.state=u.state===f.DashlingRequestState.endOfStream?u.state:f.DashlingRequestState.idle;u.activeRequest=null;u.requests=[]}else{u.state=f.DashlingRequestState.error;e.hasStreamEnded?a(0):i._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"mediaSegmentDownload",errorMessage:e.statusCode,httpStatus:e.httpStatus,correlationId:e.correlationId})}}},this._settings);u.activeRequest=h;u.requests.push(h);s.log("Download started: "+u.qualityId+" media index="+e+" time="+(Date.now()-i._startTime)+"ms stagger="+i.getRequestStaggerTime()+"ms",i._settings);i.requestManager.start(h)}};e.prototype.assessQuality=function(){var e=this,t=e._settings,n=e.requestManager.bytesPerSeconds.average,r=e._streamInfo,i=r.qualities.length-1;n?"video"===this.streamType&&this._storage.setItem("bytesPerSecond",String(n)):n=parseFloat(this._storage.getItem("bytesPerSecond"));if(t.isABREnabled&&n)if(t.isRBREnabled)e.qualityIndex=Math.round(Math.random()*i);else{for(var o=0,u="Quality check "+e.streamType+": bps="+Math.round(n),a=r.timeline[0].lengthSeconds,f=.4*a,l=Math.min(i,t.abrLimitQuality&&t.abrLimitQuality[e.streamType]||i),c=0;c<=l;c++){var h=e._estimateDownloadSeconds(c,0);u+=" "+c+"="+h.toFixed(2)+"s";h+f<a&&(o=c)}e._async.throttle(function(){s.log(u,e._settings)},"assess",1e3);e.qualityIndex=o}else e.qualityIndex=Math.min(i,t.targetQuality[e.streamType])};e.prototype._estimateDownloadSeconds=function(e,t){var n=this._streamInfo.qualities[e],r=this._streamInfo.timeline[t||0].lengthSeconds,i=n.bandwidth/8*r,s=this.requestManager.bytesPerSeconds.average;s?"video"===this.streamType&&this._storage.setItem("bytesPerSecond",String(s)):s=parseFloat(this._storage.getItem("bytesPerSecond"));return i/(s||this._settings.defaultBandwidth)};e.prototype._decryptResponseIfNeeded=function(e,t,n){this._decryptor&&this._streamInfo.importedKey?this._decryptor.decrypt(e.data,this._streamInfo.importedKey,this._streamInfo.contentProtection.iv,function(n){e.data=new Uint8Array(n);t()},function(e){n(e)}):t()};e.prototype._loadInitSegment=function(e,t){var n=this,i=this,o=i._streamInfo.qualities,u=o.length-1,a=o[e].id;e!==u&&i._loadInitSegment(u,t);if(!i._initSegments[e]){var c=i._initSegments[e]=new r.Request({url:this._getInitUrl(e),requestType:"init",qualityIndex:e,qualityId:a,isArrayBuffer:!0,onSuccess:function(e){i._isDisposed||n._decryptResponseIfNeeded(e,function(){e.state=f.DashlingRequestState.downloaded;s.log("Download complete: "+i.streamType+" "+e.qualityId+" "+e.requestType,i._settings);t(e)},function(e){t=e,i._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"segmentDecryptionError",errorMessage:l.getDecryptorErrorString(t)});var t})},onError:function(t){if(!i._isDisposed)if(t.state===f.DashlingRequestState.disconnected){i._initSegments[e]=void 0;i._events.raise("sessionstatechange",{state:f.DashlingSessionState.disconnected,errorTYpe:"mediaSegmentDownload",errorMessage:t.statusCode,httpStatus:t.httpStatus,correlationId:t.correlationId})}else if(t.isAborted)i._initSegments[e]=void 0;else{t.state=f.DashlingRequestState.error;i._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"initSegmentDownload",errorMessage:t.statusCode,httpStatus:t.httpStatus,correlationId:t.correlationId})}}},this._settings);s.log("Download started: "+i.streamType+" "+a+" init",i._settings);i._initRequestManager.start(c)}};e.prototype._getInitUrl=function(e){var t=this._streamInfo.initUrlFormat.replace("$RepresentationID$",this._streamInfo.qualities[e].id);return this._manifest.baseUrl+t};e.prototype._getUrl=function(e){var t=this._streamInfo.fragUrlFormat.replace("$RepresentationID$",e.qualityId).replace("$Time$",""+e.time.start);return this._manifest.baseUrl+t};return e})();t.Stream=c});
define("@ms/dashling/lib/RequestManager",["require","exports","./MetricSet","./DashlingEnums"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=(function(){function e(e){this._settings=e;this._activeRequests=Object.create(null);this.waitTimes=new n.MetricSet(20);this.receiveTimes=new n.MetricSet(20);this.bytesPerSeconds=new n.MetricSet(20);this._activeRequestCount=0}e.prototype.dispose=function(){this.abortAll()};e.prototype.getActiveRequestCount=function(){return this._activeRequestCount};e.prototype.abortAll=function(){var e=this._activeRequests;for(var t in e)e[t].dispose();this._activeRequests=Object.create(null)};e.prototype.start=function(e){var t=this;this._activeRequests[i++]=e;this._activeRequestCount++;e.start({onBandwidthUpdate:function(e){t.bytesPerSeconds.append(e)},onComplete:function(e){t._activeRequestCount--;if(e.state===r.DashlingRequestState.downloaded){if(!(e.timeAtLastByte<t._settings.requestCacheThreshold)){t.waitTimes.append(e.timeAtFirstByte);t.receiveTimes.append(e.timeAtLastByte)}}}})};return e})();t.RequestManager=s});
define("@ms/dashling/lib/MetricSet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.reset();this._max=e}e.prototype.append=function(e){var t=this.average,n=this.metricValues,r=n.push(e),i=(e-t)/r;r>this._max&&(i+=(t+i-n.shift())/(r-1));this.average+=i;this.min=Math.min(e,this.min);this.max=Math.max(e,this.max)};e.prototype.reset=function(){this.metricValues=[];this.average=this.min=this.max=0};return e})();t.MetricSet=n});
define("@ms/dashling/lib/DashlingEnums",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.sessionStateChange="sessionstatechange"})(t.DashlingEvent||(t.DashlingEvent={}));(function(e){e.mediaSourceInit="mediaSourceInit";e.manifestDownload="manifestDownload";e.initSegmentDownload="initSegmentDownload";e.mediaSegmentDownload="mediaSegmentDownload";e.manifestParse="manifestParse";e.videoElementError="videoElementError";e.sourceBufferInit="sourceBufferInit";e.sourceBufferAppendException="sourceBufferAppendException";e.sourceBufferError="sourceBufferError";e.sourceBufferAppendMissing="sourceBufferAppendMissing";e.networkDisconnected="networkDisconnected";e.aesKeyFetchError="aesKeyFetchError";e.webcryptoInitError="webCryptoInitError";e.segmentDecryptionError="segmentDecryptionError"})(t.DashlingError||(t.DashlingError={}));(function(e){e[e.disconnected=-2]="disconnected";e[e.error=-1]="error";e[e.idle=0]="idle";e[e.initializing=1]="initializing";e[e.buffering=2]="buffering";e[e.playing=4]="playing";e[e.paused=5]="paused"})(t.DashlingSessionState||(t.DashlingSessionState={}));(function(e){e[e.disconnected=-2]="disconnected";e[e.error=-1]="error";e[e.idle=0]="idle";e[e.downloading=1]="downloading";e[e.downloaded=2]="downloaded";e[e.endOfStream=3]="endOfStream";e[e.appending=4]="appending";e[e.appended=5]="appended";e[e.aborted=6]="aborted"})(t.DashlingRequestState||(t.DashlingRequestState={}));(function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED";e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK";e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE";e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED";e[e.MS_MEDIA_ERR_ENCRYPTED=5]="MS_MEDIA_ERR_ENCRYPTED"})(t.VideoElementError||(t.VideoElementError={}))});
define("@ms/dashling/lib/Request",["require","exports","./DashlingEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){this._options=e;this._settings=t;this.state=n.DashlingRequestState.idle;this.data=null;this.timeAtFirstByte=-1;this.timeAtLastByte=-1;this.statusCode="";this.progressEvents=[];this.bytesLoaded=0;this.bytesPerMillisecond=0;this.correlationId="";this.requestType=e.requestType;this.fragmentIndex=e.fragmentIndex;this.qualityIndex=e.qualityIndex;this.qualityId=e.qualityId;this.clearDataAfterAppend=e.clearDataAfterAppend;this.hasUpdatedBufferRate=!1;this.isAborted=!1;this._requestAttempt=0;this._requestUrl="";this._xhrType=XMLHttpRequest;this._responseHeaders=null}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;if(this._xhr){if(this.state===n.DashlingRequestState.downloading){this.state=n.DashlingRequestState.aborted;this.statusCode="aborted";this.isAborted=!0;this._xhr.abort();this._options.onError&&this._options.onError(this);this._complete()}this._xhr=null}if(this._retryTimeoutId){clearTimeout(this._retryTimeoutId);this._retryTimeoutId=null}this._onBandwidthUpdate=this._onComplete=null}};e.prototype.start=function(e){this._onBandwidthUpdate=e.onBandwidthUpdate;this._onComplete=e.onComplete;var t=this,r=t._options,i=r.url,s=r.isArrayBuffer,o=t._xhr=new t._xhrType;t._responseHeaders=null;var u=t._settings,a=function(e){var r=t.startTime=Date.now(),i=e.url,u=e.headers,a=e.body,f=e.useCredentials;t._requestUrl=i;t._requestAttempt++;o.open(a?"POST":"GET",i,!0);s&&(o.responseType="arraybuffer");if(u)for(var l=0,c=Object.keys(u);l<c.length;l++){var h=c[l];u[h]&&o.setRequestHeader(h,u[h])}f&&(o.withCredentials=!0);o.timeout=t._settings.requestTimeout;o.onreadystatechange=function(){!t._isDisposed&&o.readyState>0&&t.timeAtFirstByte<0&&(t.timeAtFirstByte=Date.now()-r)};o.onprogress=function(e){if(!t._isDisposed){t.progressEvents.push({timeFromStart:Date.now()-r,bytesLoaded:e.lengthComputable?e.loaded:-1});t._postProgress()}};o.onloadend=function(){t._isDisposed||t._processResult()};t.state=n.DashlingRequestState.downloading;o.send(a)};if(u.getRequestParametersAsync)u.getRequestParametersAsync(i).then(a,function(e){t.state=n.DashlingRequestState.error;t.statusCode=e.code||"getRequestParametersAsync";t.httpStatus=0;t.correlationId=e.correlationId;t._options.onError&&t._options.onError(t)});else{u.preprocessRequest&&(i=u.preprocessRequest(i));a({url:i,headers:{spo_access_token:this._options.token}})}};e.prototype._processResult=function(){var e=this._xhr,t=this.progressEvents,r=this._options.isArrayBuffer,i=this._settings;this._xhr=null;this.timeAtLastByte=Date.now()-this.startTime;if(e.status>=200&&e.status<=299){this.bytesLoaded=r?e.response.byteLength:e.responseText?e.responseText.length:0;e.onreadystatechange(null);this._postProgress();if(t.length>2){var s=t[t.length-1],o=t[0],u=s.timeFromStart-o.timeFromStart,a=s.bytesLoaded-o.bytesLoaded;this.bytesPerMillisecond=a/u;this.timeAtFirstByte=this.timeAtLastByte-this.bytesLoaded/this.bytesPerMillisecond}this.data=r?new Uint8Array(e.response):e.responseText;this.statusCode=String(e.status);this.state=n.DashlingRequestState.downloaded;var f=this._getResponseHeaders(e);this.timeAtLastByte>50&&i.publishResponseMetaData&&i.publishResponseMetaData({headers:f,requestType:this.requestType});this.correlationId=f["x-correlationid"];var l=f["x-errorcode"]||f["x-clienterrorcode"];l&&l.indexOf("EndOfStream")>-1&&(this.hasStreamEnded=!0);this._complete();this._options.onSuccess&&this._options.onSuccess(this)}else this._processError(e)};e.prototype._processError=function(e){var t=this,r=e.status,i=t._settings,s=!t.isAborted&&(r<400||r>406)&&t._requestAttempt<i.maxRetries,o=i.delaysBetweenRetries;if(s){var u=o[t._requestAttempt-1]||o[o.length-1];t._retryTimeoutId=window.setTimeout(function(){t.start({onBandwidthUpdate:t._onBandwidthUpdate,onComplete:t._onComplete})},u)}else{var a=t._options.isArrayBuffer?e.response:e.responseText;if(i.testConnectivity&&0===r&&!a){i.testConnectivity(t._requestUrl).then(function(){t._processTerminalError(e)},function(e){(function(e){t.state=n.DashlingRequestState.disconnected;t.statusCode=e||"disconnected";t.httpStatus=0;t._complete();t._options.onError&&t._options.onError(t)})(e.code)})}else t._processTerminalError(e)}};e.prototype._processTerminalError=function(e){var t=e.status,r=0===t&&this.timeAtLastByte>=this._settings.requestTimeout-100,i=this._getResponseHeaders(e),s=i["x-errorcode"]||i["x-clienterrorcode"],o=i["x-correlationid"];s&&s.indexOf("EndOfStream")>-1&&(this.hasStreamEnded=!0);this.state=n.DashlingRequestState.error;this.statusCode=this.isAborted?"aborted":r?"timeout":s||String(t);this.httpStatus=t;this.correlationId=o;this._complete();this._options.onError&&this._options.onError(this)};e.prototype._postProgress=function(){if(this._onBandwidthUpdate){var e=this.progressEvents;if(e.length>2){var t=e[e.length-1],n=e[0],r=t.bytesLoaded-n.bytesLoaded;if(r>1e4){var i=t.timeFromStart-n.timeFromStart;i>5&&this._onBandwidthUpdate(1e3*r/i)}}}};e.prototype._complete=function(){this._onComplete&&this._onComplete(this);this._onComplete=null;this._onBandwidthUpdate=null};e.prototype._getResponseHeaders=function(e){var t=this._responseHeaders;if(!t){this._responseHeaders=t={};try{for(var n=0,r=e.getAllResponseHeaders().split("\r\n");n<r.length;n++){var i=r[n],s=i.indexOf(":");s&&(t[i.slice(0,s)]=i.slice(s+1).trim())}}catch(e){}}return t};return e})();t.Request=r});
define("@ms/dashling/lib/Utilities",["require","exports","./DashlingEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.log=function(e,t){t&&!t.logToConsole||console.log(e)};t.getVideoError=function(e){var t=e.error;return t?n.VideoElementError[t.code]||String(t.code):""};t.stringToUint8Array=function(e){void 0===e&&(e="");for(var t=new Uint8Array(e.length),n=0;n<t.byteLength;n++)t[n]=e.charCodeAt(n);return t};t.uint8ArrayToString=function(e){var t="";if(!e)return t;for(var n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return t};t.hexStringToArrayBuffer=function(e){void 0===e&&(e="");var t=e,n=t.substr(2);t.length%2!=0&&(n="0"+n);for(var r=new Uint8Array(n.length/2),i=0;i<n.length;i+=2){var s=parseInt(n.substr(i,2),16);if(isNaN(s))throw new Error("Invalid hexString");r[i/2]=s}return r};"function"!=typeof Object.values&&(Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})})});
define("@ms/dashling/lib/Storage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t){this._prefix=e||"";this._useSessionStorage=!!t}e.prototype.getItem=function(e,t){e=this._prefix+e;try{return this._useSessionStorage?window.sessionStorage.getItem(e):window.localStorage.getItem(e)}catch(e){}return t};e.prototype.setItem=function(e,t){e=this._prefix+e;try{this._useSessionStorage?window.sessionStorage.setItem(e,t):window.localStorage.setItem(e,t)}catch(e){}};return e})();t.Storage=n});
define("@ms/dashling/lib/Decryptor",["require","exports","./RequestManager","./Request"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDecryptorErrorString=function(e){return e.details&&e.details.message};t.AES_ENVELOPE_SCHEME_ID="urn:mpeg:dash:sea:aes128-cbc:2013";t.hasCryptoSupport=function(){var e=window;return!(!e.crypto&&!e.msCrypto)};var i=(function(){function e(e){var t=window,r=t.crypto||t.msCrypto;if(!r)throw new Error("no crypto support");this._webCryptor=r.subtle||r.webkitSubtle;this._settings=e;this._requestManager=new n.RequestManager(e)}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._requestManager.dispose()}};e.prototype.init=function(e,n,i){var s=this;if(e.schemeIdUri!==t.AES_ENVELOPE_SCHEME_ID)throw new Error("unknown encryption scheme");var o=new r.Request({url:e.keyUri,requestType:"key",isArrayBuffer:!0,onSuccess:function(t){var r=s._webCryptor.importKey("raw",new Uint8Array(t.data),"aes-cbc",!1,["decrypt"]),o=function(t){t=r.result||t;n(t,e)},u=function(e){i({step:"init",details:e})};if("oncomplete"in r){var a=r;a.oncomplete=o;a.onerror=u}else r.then(function(e){o(e)},function(e){u(e)})},onError:function(e){i({step:"keyfetch",request:e})},token:this._settings.keyToken},this._settings);this._requestManager.start(o)};e.prototype.decrypt=function(e,t,n,r,i){var s={name:"aes-cbc",iv:n},o=this._webCryptor.decrypt(s,t,new Uint8Array(e)),u=function(e){e=o.result||e;r(e)},a=function(e){i({step:"decryption",details:e})};if("oncomplete"in o){var f=o;f.oncomplete=u;f.onerror=a;f.onabort=a}else o.then(function(e){u(e)},function(e){a(e)})};return e})();t.Decryptor=i});
define("@ms/dashling/lib/ManifestParser",["require","exports","./RequestManager","./Request","./DashlingEnums","./Manifest"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){this._parseIndex=0;this._settings=e;this._requestManager=new n.RequestManager(e)}e.prototype.dispose=function(){if(this._requestManager){this._requestManager.dispose();this._requestManager=null}};e.prototype.parse=function(e,t,n){var o=this,u=++this._parseIndex,a=new r.Request({url:e,requestType:"manifest",onSuccess:function(e){if(o._parseIndex===u)try{var r=s.fromRequest(e,o._settings);t(r)}catch(t){"object"==typeof t&&(t.data=""+e.data);n("manifestParse",t,e.httpStatus,e.correlationId)}},onError:function(e){o._parseIndex===u&&n(e.state===i.DashlingRequestState.disconnected?"networkDisconnected":"manifestDownload",e.statusCode,e.httpStatus,e.correlationId)}},this._settings);this._requestManager.start(a)};return e})();t.ManifestParser=o});
define("@ms/dashling/lib/Manifest",["require","exports","tslib","./Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e){var t=e.querySelector("ContentProtection"),n={schemeIdUri:"",keyUri:"",iv:void 0,keySystemUri:""};if(t){var i=t.querySelector("SegmentEncryption"),s=t.querySelector("KeySystem"),o=t.querySelector("CryptoPeriod");n.schemeIdUri=i.getAttribute("schemeIdUri");n.keyUri=o.getAttribute("keyUriTemplate");n.iv=r.hexStringToArrayBuffer(o.getAttribute("IV"));n.keySystemUri=s.getAttribute("keySystemUri");return n}return null}function s(e,t){for(var n=(new DOMParser).parseFromString(e,"text/xml"),r=t.baseUrlOverride||(function(e,t,n){var r=e.getElementsByTagName(t)[0],i=r&&r.childNodes[0];return i?i.nodeValue:n})(n,"BaseURL",""),s=(function(e){var t=0,n=e.slice(2),r=n.indexOf("H");if(r>-1){t+=60*Number(n.slice(0,r))*60;n=n.slice(r+1)}if((r=n.indexOf("M"))>-1){t+=60*Number(n.slice(0,r));n=n.slice(r+1)}(r=n.indexOf("S"))>-1&&(t+=Number(n.slice(0,r)));return t})(o(n.documentElement,"mediaPresentationDuration")),u={},a=n.querySelectorAll("AdaptationSet"),f=0;f<a.length;f++){var l=a[f];if(l){var c=i(l),h=l.querySelectorAll("S");if(!h||!h.length)throw"Missing timeline";for(var p=o(l,"contentType"),d=l.querySelectorAll("Representation"),v=l.querySelector("SegmentTemplate"),m=Number(o(v,"timescale")),g=[],y=[],b=0;b<d.length;b++){var w=d[b],E=o(w,"height"),S={id:o(w,"id"),bandwidth:Number(o(w,"bandwidth")),width:E&&Number(o(w,"width"))||0,height:E&&Number(E)||0};g.push(S)}for(var x=0,T=0;T<h.length;T++)for(var N=h[T],C=Number(o(N,"r"))||0,k=Number(o(N,"d")),L=0;L<=C;L++){y.push({start:x,startSeconds:x/m,length:k,lengthSeconds:k/m});x+=k}u[p]={streamType:p,mimeType:o(l,"mimeType"),codecs:o(l,"codecs"),initUrlFormat:o(v,"initialization"),fragUrlFormat:o(v,"media"),qualities:g,timeline:y};c&&(u[p].contentProtection={schemeIdUri:c.schemeIdUri,keyUri:c.keyUri,iv:c.iv,keySystemUri:c.keySystemUri})}}return{baseUrl:r,mediaDuration:s,streams:u}}t.fromText=s;t.fromRequest=function(e,t){return n.__assign(n.__assign({},s(e.data,t)),{request:e})};function o(e,t){return e.getAttribute(t)}});
define("@ms/odsp-shared/lib/models/store/KnockoutDataStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/models/store/BaseDataStore","../../base/BaseModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n=r.default.none);var s=e.call(this)||this;s.dataStore=new i.default(t,n);return s}t.prototype.persistBoolean=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e("true"===r);this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistNumber=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e(Number(r));this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistString=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e(r);this.subscribe(e,function(e){return n.setValue(t,e)})};t.prototype.setValue=function(e,t,n){this.dataStore.setValue(e,t,n)};t.prototype.getValue=function(e,t){return this.dataStore.getValue(e,t)};t.prototype.remove=function(e,t){this.dataStore.remove(e,t)};return t})(s.default);t.default=o});
define("odsp-next/controls/video/VideoError",["require","exports","tslib","@ms/utilities-error/lib/ApiError","./VideoErrorType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.type,s=void 0===r?i.default.unknown:r,o=t.isRetriable,u=void 0===o||o,a=t.requiresNewUrl,f=void 0!==a&&a;n.type=s;n.isRetriable=u;n.requiresNewUrl=f;return n}return t})(r.ApiError);t.VideoError=s});
define("odsp-next/controls/video/VideoErrorType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.none=0]="none";e[e.unknown=1]="unknown";e[e.unsupportedFormat=2]="unsupportedFormat";e[e.unsupportedBrowser=3]="unsupportedBrowser";e[e.getDownloadUrlFailure=4]="getDownloadUrlFailure";e[e.htmlElementDecode=5]="htmlElementDecode";e[e.htmlElementNetwork=6]="htmlElementNetwork";e[e.htmlElementAborted=7]="htmlElementAborted";e[e.htmlElementSrcNotSupported=8]="htmlElementSrcNotSupported";e[e.htmlElementOther=9]="htmlElementOther";e[e.htmlDashlingMediaSourceInit=10]="htmlDashlingMediaSourceInit";e[e.htmlDashlingManifestDownload=11]="htmlDashlingManifestDownload";e[e.htmlDashlingInitSegmentDownload=12]="htmlDashlingInitSegmentDownload";e[e.htmlDashlingMediaSegmentDownload=13]="htmlDashlingMediaSegmentDownload";e[e.htmlDashlingManifestParse=14]="htmlDashlingManifestParse";e[e.htmlDashlingVideoElementError=15]="htmlDashlingVideoElementError";e[e.htmlDashlingSourceBufferInit=16]="htmlDashlingSourceBufferInit";e[e.htmlDashlingSourceBufferAppendException=17]="htmlDashlingSourceBufferAppendException";e[e.htmlDashlingSourceBufferAppendMissing=18]="htmlDashlingSourceBufferAppendMissing";e[e.htmlDashlingWebCryptoInitError=19]="htmlDashlingWebCryptoInitError";e[e.htmlDashlingAesKeyFetchError=20]="htmlDashlingAesKeyFetchError";e[e.htmlDashlingSegmentDecryptionError=21]="htmlDashlingSegmentDecryptionError";e[e.htmlDashlingOther=22]="htmlDashlingOther";e[e.htmlOther=23]="htmlOther";e[e.flashLoadTimeout=24]="flashLoadTimeout";e[e.flashOther=25]="flashOther";e[e.throttled=26]="throttled";e[e.unsupportedCodec=27]="unsupportedCodec";e[e.emptyFile=28]="emptyFile";e[e.bitRateTooHigh=29]="bitRateTooHigh";e[e.html5VideoUnsupported=30]="html5VideoUnsupported";e[e.h264Unsupported=31]="h264Unsupported";e[e.mediaSourceUnsupported=32]="mediaSourceUnsupported"})(n=t.VideoErrorType||(t.VideoErrorType={}));t.default=n});
define("odsp-next/controls/video/PlaybackMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./logging/VideoLoad.event","./logging/VideoSession.event","./logging/VideoSessionEndReason","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f;(function(e){e.seeking="seeking";e.rebuffering="rebuffering";e.startup="startup"})(f||(f={}));var l=0,c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.context;n._context=r;n.createComputed(n._computeResetInstance);n.createBackgroundComputed(n._computeReportLoad).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n.createBackgroundComputed(n._computeReportSession).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});return n}t.prototype.dispose=function(){this._loadEvent&&this._reportLoadEnd({isDisposed:!0});this._sessionEvent&&this._reportSessionEnd({isDisposed:!0});e.prototype.dispose.call(this)};t.prototype._computeResetInstance=function(){this._context.itemKey();this._instanceNumber=++l;this._loadSequenceNumber=0;this._sessionSequenceNumber=0};t.prototype._computeReportLoad=function(){this._loadEvent?this._context.isLoading()||this._reportLoadEnd():this._context.isLoading()&&this._reportLoadStart()};t.prototype._computeReportSession=function(){this._sessionEvent?this._context.isPlaying()||this._reportSessionEnd():this._context.isPlaying()&&this._reportSessionStart()};t.prototype._reportLoadStart=function(){var e,t=this._context.item.peek(),r=t.audio,i=t.video;this._loadEvent=new s.default(n.__assign(n.__assign(n.__assign({name:"Video.Load",playbackType:this._context.playbackType.peek(),videoUseCdn:this._context.isPlaybackCDNEnabled.peek(),videoEnableEncyrption:this._context.isPlaybackEncryptionEnabled.peek(),fileExtension:(t.extension||"").toLowerCase(),fileDuration:(i||r).duration,playbackSessionId:this._context.playbackSessionId,reason:this._context.isSeeking.peek()?f.seeking:0===this._context.position.peek()&&0===this._context.getTotalPlayTimeMs()?f.startup:f.rebuffering},i?{fileBitrate:i.bitrate,width:i.width,height:i.height,audioFormat:i.audioFormat,fourCC:i.fourCC}:{}),{instance:this._instanceNumber,sequence:this._loadSequenceNumber}),(null===(e=t.photo)||void 0===e?void 0:e.isLivePhoto)&&a.isFeatureEnabled(a.EnableLivePhotoVideos)?{extraData:{isLivePhoto:!0}}:{}));this._loadSequenceNumber++};t.prototype._reportLoadEnd=function(e){var t,n=(void 0===e?{}:e).isDisposed,r=void 0!==n&&n,s=this._context.videoStatus.peek(),o=s.error,u=o&&o.type,a=o&&o.message,f=o&&o.stack,l=o&&o.data;t=r?i.ResultTypeEnum.ExpectedFailure:s.isVisible?i.ResultTypeEnum.Failure:i.ResultTypeEnum.Success;this._loadEvent.end({resultType:t,errorType:u,errorMessage:a,extraData:{VideoError_stack:f,VideoError_data:l}});this._loadEvent=null};t.prototype._reportSessionStart=function(){var e,t=this._context.item.peek(),r=t.audio,s=t.video,u=(t.extension||"").toLowerCase();this._sessionEvent=new o.default(n.__assign(n.__assign(n.__assign({name:"Video.Session",playbackType:this._context.playbackType.peek(),videoUseCdn:this._context.isPlaybackCDNEnabled.peek(),videoEnableEncyrption:this._context.isPlaybackEncryptionEnabled.peek(),fileExtension:u,fileDuration:(s||r).duration,playbackSessionId:this._context.playbackSessionId},s?{fileBitrate:s.bitrate,cameraMake:s.cameraMake,cameraModel:s.cameraModel,width:s.width,height:s.height,audioFormat:s.audioFormat,fourCC:s.fourCC}:{}),{quality:this._context.playingQuality.peek(),maxQuality:this._context.maxQuality.peek(),instance:this._instanceNumber,sequence:this._sessionSequenceNumber}),(null===(e=t.photo)||void 0===e?void 0:e.isLivePhoto)&&a.isFeatureEnabled(a.EnableLivePhotoVideos)?{extraData:{isLivePhoto:!0}}:{}));var f=s?"Video":"Audio";this._sessionQosEvent=new i.Qos({name:"ItemViewer."+f+".Session",extraData:{extension:u}});this._sessionSequenceNumber++};t.prototype._reportSessionEnd=function(e){var t,r,o=(void 0===e?{}:e).isDisposed,a=void 0!==o&&o,f=this._context,l=f.videoStatus.peek(),c=l.error,h=c&&c.code,p=c&&c.correlationId,d=c&&c.isExpected,v=c&&c.message,m=c&&c.type,g=c&&c.stack,y=c&&c.data,b=this._sessionQosEvent,w=b.data.extraData,E=p?n.__assign(n.__assign({},w),{CorrelationId:p}):w,S=m?s.VideoErrorType[m]:"";h&&(S+="."+h);if(a){t=i.ResultTypeEnum.ExpectedFailure;r=u.default.closed}else if(l.isVisible){t=i.ResultTypeEnum.Failure;r=u.default.failed}else{var x=f.position.peek()/f.duration.peek()>.99,T=!f.isPlaying.peek();t=i.ResultTypeEnum.Success;r=x?u.default.ended:T?u.default.paused:u.default.unknown}b.end({resultCode:S||u.default[r],resultType:d?i.ResultTypeEnum.ExpectedFailure:t,error:v,extraData:E});var N=0,C=0;if(this._context.isPlaybackCDNEnabled.peek()){N=this._context.cacheHitCount;C=this._context.cacheMissCount}this._sessionEvent.end({resultType:t,errorType:m,endReason:r,errorMessage:v,playTimeMs:this._context.getTotalPlayTimeMs(),rebufferingTimeMs:this._context.getTotalRebufferingTimeMs(),extraData:{VideoError_stack:g,VideoError_data:y},videoSegmentCacheHitCount:N,videoSegmentCacheMissCount:C});this._sessionEvent=null;this._sessionQosEvent=null;this._context.resetSessionTelemetry()};return t})(r.default);t.default=c});
define("odsp-next/controls/video/logging/VideoLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../VideoPlaybackType","../VideoErrorType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=i.VideoPlaybackType;t.VideoErrorType=s.VideoErrorType;t.ResultTypeEnum=o.ResultTypeEnum;t.VideoLoad=n.createPairedEvent({eventName:"VideoLoad,Qos,",shortEventName:"VideoLoad"},{playbackType:{typeRef:i.VideoPlaybackType,type:6},errorType:{typeRef:s.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,width:2,height:2,fourCC:1,audioFormat:1,videoUseCdn:3,videoEnableEncyrption:3,playbackSessionId:1,reason:1},r.Qos);t.default=t.VideoLoad});
define("odsp-next/controls/video/VideoPlaybackType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.none="none";e.flashDash="flashDash";e.flashMp4="flashMp4";e.flashPending="flashPending";e.htmlMp4="htmlMp4";e.htmlDashling="htmlDashling";e.htmlDashlingMediaFoundationFallback="htmlDashlingMediaFoundationFallback";e.htmlHls="htmlHls";e.htmlFallback="htmlFallback"})(n=t.VideoPlaybackType||(t.VideoPlaybackType={}));t.default=n});
define("odsp-next/controls/video/logging/VideoSession.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../VideoPlaybackType","../VideoErrorType","./VideoSessionEndReason","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=i.VideoPlaybackType;t.VideoErrorType=s.VideoErrorType;t.VideoSessionEndReason=o.VideoSessionEndReason;t.ResultTypeEnum=u.ResultTypeEnum;t.VideoSession=n.createPairedEvent({eventName:"VideoSession,Qos,",shortEventName:"VideoSession"},{playbackType:{typeRef:i.VideoPlaybackType,type:6},errorType:{typeRef:s.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,cameraMake:1,cameraModel:1,quality:2,maxQuality:2,width:2,height:2,fourCC:1,audioFormat:1,endReason:{typeRef:o.VideoSessionEndReason,type:6},videoUseCdn:3,videoEnableEncyrption:3,videoSegmentCacheHitCount:2,videoSegmentCacheMissCount:2,playTimeMs:2,rebufferingTimeMs:2,playbackSessionId:1},r.Qos);t.default=t.VideoSession});
define("odsp-next/controls/video/logging/VideoSessionEndReason",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.unknown=0]="unknown";e[e.closed=1]="closed";e[e.paused=2]="paused";e[e.ended=3]="ended";e[e.failed=4]="failed"})(n=t.VideoSessionEndReason||(t.VideoSessionEndReason={}));t.default=n});
define("odsp-next/utilities/flash/FlashHelper",["require","exports","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=(function(){function e(){}e.checkFlashSupport=function(t,n){i?n(e._isVersionAcceptable(t)):e._evaluateFlash(t,n)};e._evaluateFlash=function(t,s){var o,u=10,a=document.body;if(window.ActiveXObject)try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i=f?e._parseVersionString(f.Getletiable("$version")):[]}catch(e){i=[]}finally{l(e._isVersionAcceptable(t))}else{(o=n.default.ce("OBJECT")).style.position="absolute";o.style.left="99999px";o.setAttribute("type","application/x-shockwave-flash");a.appendChild(o);(function n(){var r;try{r=o.GetVariable("$version")}catch(e){}if(r){i=e._parseVersionString(r);l(e._isVersionAcceptable(t))}else if(u>0){u--;setTimeout(n,10)}else{a.removeChild(o);i=[];l(!1)}})()}function l(e){try{s(e)}catch(e){r.default.log(e)}}};e._parseVersionString=function(e){var t=(e||"").split(" "),n=t.length>1?t[1].split(","):"";return n.length>2?[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]:[]};e._isVersionAcceptable=function(e){return!(!e||3!==e.length||3!==i.length||!(i[0]>e[0]||i[0]===e[0]&&i[1]>e[1]||i[0]===e[0]&&i[1]===e[1]&&i[2]>=e[2]))};return e})();t.default=s});
define("odsp-next/controls/video/controls/canvas/VideoCanvasType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(){}e.flash="flash";e.html="html";return e})();t.default=n});
define("odsp-next/utilities/network/ConnectivityTester",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/utilities-error/lib/ApiError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._navigator=t.navigator||window.navigator}e.prototype.testConnectivity=function(e){return!1===this._navigator.onLine?Promise.reject(new r.ApiError({code:"Offline",message:"Device is offline",isExpected:!0})):Promise.resolve()};return e})();t.ConnectivityTester=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{})});
define("odsp-next/bindings/fullScreen/FullScreenBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/ui/FullScreen"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isMaximized=t.valueAccessor()||r.observable(!1);n.events.on(document,"fullscreenchange, webkitfullscreenchange, mozfullscreenchange, MSFullscreenChange",n._onFullScreenChanged);n.subscribe(n._isMaximized,n._onIsMaximizedChanged);return n}t.prototype._onIsMaximizedChanged=function(e){e?s.default.enterFullScreen():s.default.exitFullScreen()};t.prototype._onFullScreenChanged=function(){this._isMaximized(s.default.isFullScreen())};return t})(i.default);t.default=o});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanel",["require","exports","./PlaybackPanel.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PlaybackPanelViewModel","ODCItemVideoPlayer_css","../../../contextualMenu/ContextualMenu"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-playback-panel",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanel.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-PlaybackPanel">\x3c!--ko component:scrubBarComponent--\x3e\x3c!--/ko--\x3e<div class="od-PlaybackPanel-bottom"><span class="od-PlaybackPanel-timePlayed" data-bind="text:currentTime"></span><span class="od-PlaybackPanel-buttons"><button class="od-PlaybackPanel-button" data-bind="click:onPlayToggleClicked,attr:{\'aria-label\':labels.playPauseLabel,\'data-playstate\':playState},keyboard:{target:document,mappings:{Space:onPlayToggleClicked}}"><i class="ms-Icon" data-bind="class:playStateIcon"></i></button><div class="od-PlaybackPanel-volume" data-bind="dismiss:{isOpen:showVolumeMenu}"><button class="od-PlaybackPanel-button" data-bind="attr:{\'aria-label\':labels.volumeLabel},click:onVolumeClicked"><i class="ms-Icon" data-bind="class:volumeStateIcon"></i></button>\x3c!--ko if:showVolumeMenu--\x3e<div class="od-PlaybackPanel-volumeMenu" data-bind="component:volumeMenuComponent"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:showFullScreen--\x3e<button class="od-PlaybackPanel-button" data-bind="attr:{\'aria-label\':labels.fullScreenLabel},click:onMaximizedToggleClicked,keyboard:{target:document,mappings:{AltEnter:onMaximizedToggleClicked}}"><i class="ms-Icon" data-bind="class:maximizeStateIcon"></i></button>\x3c!--/ko--\x3e<div class="od-PlaybackPanel-gear" data-bind="dismiss:{isOpen:showContextMenu}"><button class="od-PlaybackPanel-button" data-bind="attr:{\'aria-label\':labels.gearLabel},visible:showSettings,click:onGearClicked"><i class="ms-Icon" data-bind="class:gearIcon"></i></button>\x3c!--ko if:showContextMenu--\x3e<div class="od-PlaybackPanel-gearMenu" data-bind="component:{name:\'ms-contextual-menu\',params:contextualMenuParams}"></div>\x3c!--/ko--\x3e</div></span><span class="od-PlaybackPanel-totalTime" data-bind="text:totalTime"></span></div></div>'});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanelViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling","../../../../bindings/keyboard/KeyboardBinding","../../../commands/CommandViewModel","../../../../bindings/contextMenu/ContextMenuAlignment","../../VideoPlayer.resx","../../../../bindings/dismiss/DismissBinding","../../actions/SetVideoQualityAction","../../actions/ToggleVideoABRAction","../../actions/ToggleVideoDiagnosticsAction","@ms/odsp-utilities/lib/string/TimeFormatter","../../resources/VideoResourceKeys","../scrubBar/ScrubBar","../volumeMenu/VolumeMenu","../../../../utilities/features/Features","../../actions/ToggleVideoTranscodeAction","../../actions/ToggleVideoBetaTranscodeAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(d.context);n.scrubBarComponent={name:v.default.tagName,params:{}};n.volumeMenuComponent={name:m.default.tagName,params:{}};n.addBindingHandlers({dismiss:f.default,keyboard:s.default});var r=n.observables;n.currentTime=r.pureCompute(n._computeCurrentTime);n.totalTime=r.pureCompute(n._computeTotalTime);n.percentVolume=r.pureCompute(n._computePercentVolume);n.showVolumeMenu=n.createObservable(!1);n.showContextMenu=n.createObservable(!1);n.contextualMenuParams=void 0;n.labels={fullScreenLabel:r.pureCompute(n._computeFullSreenLabel),gearLabel:a.default.qualityMenuHeader,playPauseLabel:r.pureCompute(n._computePlayPauseLabel),volumeLabel:a.default.volumeLabel};n.showFullScreen=r.pureCompute(n._computeShowFullScreen);n.playState=r.pureCompute(n._computePlayState);n.playStateIcon=r.pureCompute(n._computePlayStateIcon);n.volumeStateIcon=r.pureCompute(n._computeVolumeStateIcon);n.maximizeStateIcon=r.pureCompute(n._computeMaximizeStateIcon);n.showSettings=r.pureCompute(n._computeShowSettings);n.gearIcon=i.getIconClassName("Settings");n._allowBeta=g.isFeatureEnabled(g.UseAltTranscodeForDashManifests);return n}t.prototype.onPlayToggleClicked=function(e,t){this.context.isPlaying(!this.context.isPlaying.peek());return!1};t.prototype.onGearClicked=function(e,t){var r=this;if(!this.contextualMenuParams){var i=this.observables,s=[{value:1080,text:a.default.qualityMenu1080},{value:720,text:a.default.qualityMenu720},{value:480,text:a.default.qualityMenu480},{value:360,text:a.default.qualityMenu360},{value:240,text:a.default.qualityMenu240}],f=n.__spreadArrays(s.map(function(e){return new(r.managed(o.default))({text:e.text,isToggleable:!0,action:new(r.managed(l.default))({quality:e.value})})}),[new o.default({text:a.default.qualityMenuAuto,isToggleable:!0,hasLineBreakBefore:!0,action:new(this.managed(c.default))})]);if(this.context.canShowDiagnostics){f.push(new o.default({text:a.default.showDiagnostics,isToggleable:!0,action:new(this.managed(h.default))}),new o.default({text:a.default.forceNativePlayback,isToggleable:!0,action:new(this.managed(y.default))}));this._allowBeta&&f.push(new o.default({text:a.default.useBetaTranscoding,isToggleable:!0,action:new(this.managed(b.default))}))}this.contextualMenuParams={items:i.createArray(f),alignment:u.default.BottomCenter,allowHorizontalMenuNudging:!0,isOpen:this.showContextMenu,isBeakVisible:i.create(!1),target:t.target,anchorElement:t.target}}this.showContextMenu(!this.showContextMenu.peek());return!1};t.prototype.onVolumeClicked=function(e,t){this.showVolumeMenu(!this.showVolumeMenu.peek());return!1};t.prototype.onMaximizedToggleClicked=function(e,t){this.context.isMaximized(!this.context.isMaximized.peek());return!1};t.prototype.getMuteButtonClass=function(){var e=this.context.volume();return this.context.isMuted()?"VolumeDisabled":0===e?"Volume0":e<=.3?"Volume1":e<=.6?"Volume2":"Volume3"};t.prototype._computeShowSettings=function(){return this.context.canShowDiagnostics||this.context.canAdjustQuality()};t.prototype._computeFullSreenLabel=function(){return this.context.isMaximized()?a.default.exitFullScreenLabel:a.default.fullScreenLabel};t.prototype._computePlayPauseLabel=function(){return this.context.isPlaying()?a.default.pauseLabel:a.default.playLabel};t.prototype._computeShowFullScreen=function(){return!!this.context.item().video};t.prototype._computeCurrentTime=function(){return p.formatTime(1e3*this.context.position())};t.prototype._computeTotalTime=function(){var e=1e3*this.context.duration();return isNaN(e)?"":p.formatTime(e)};t.prototype._computePercentVolume=function(){return Math.round(100*this.context.volume())+"%"};t.prototype._computePlayState=function(){return this.context.isPlaying()?"Pause":"Play"};t.prototype._computePlayStateIcon=function(){return i.getIconClassName(this.playState())};t.prototype._computeVolumeStateIcon=function(){return i.getIconClassName(this.getMuteButtonClass())};t.prototype._computeMaximizeStateIcon=function(){return i.getIconClassName(this.context.isMaximized()?"BackToWindow":"FullScreen")};return t})(r.default);t.default=w});
define("odsp-next/controls/video/actions/SetVideoQualityAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetVideoQuality";n._context=n.resources.consume(o.context);n._quality=t.quality;return n}t.prototype.onExecute=function(e,t){this._context.desiredQuality(this._quality);this._context.isABREnabled(!1);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._context;if(!e.canAdjustQuality())return!1;e.maxQuality();return e.hasVideoQuality(this._quality)};t.prototype.onIsToggled=function(){var e=this._context;return this.isAvailable()&&this._quality===(e.isABREnabled()?e.playingQuality():e.desiredQuality())};return t})(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoABRAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoABR";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.isABREnabled();n&&this._context.desiredQuality(this._context.playingQuality());this._context.isABREnabled(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.isABREnabled()};return t})(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoDiagnosticsAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoDiagnostics";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){this._context.isDiagnosticsEnabled(!this._context.isDiagnosticsEnabled.peek());return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.isDiagnosticsEnabled()};return t})(r.default);t.default=u});
define("@ms/odsp-utilities/lib/string/TimeFormatter",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.formatTime=function(e){var t="",n=!1;if(e>=36e5){var r=Math.floor(e/36e5);e%=36e5;t+=r+":";n=!0}var i=Math.floor(e/6e4);e%=6e4;i<10&&n&&(t+="0");t+=i+":";var s=Math.floor(e/1e3);s<10&&(t+="0");return t+=s}});
define("odsp-next/controls/video/controls/scrubBar/ScrubBar",["require","exports","./ScrubBar.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ScrubBarViewModel","ODCItemVideoPlayer_css","../../../progressSpinnerFlat/ProgressSpinnerFlat"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-scrub-bar",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/video/controls/scrubBar/ScrubBar.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-ScrubBar" data-bind="keyboard:{mappings:{Left:onLeftKey,Right:onRightKey,preventDefault:true}},css:{\'od-ScrubBar--isLoading\':context.isPlaying()&&context.isLoading()}"><div data-bind="component:{name:\'ms-progressSpinnerFlat\'}"></div><div class="od-ScrubBar-bar" tabindex="0" data-bind="scrub:{value:context.seekPercentage,hoverValue:seekTooltipPercentage,isScrubbing:context.isScrubbing,isHovering:isHovering,clientX:seekTooltipLeft}"><div class="od-ScrubBar-fill" data-bind="foreach:context.bufferedRanges"><div class="od-ScrubBar-buffered" data-bind="style:{left:left,width:width}"></div></div><div class="od-ScrubBar-scrubArea"><div class="od-ScrubBar-thumb" data-bind="style:{width:percentPlayed}"></div></div></div><div class="od-ScrubBar-tooltip" data-bind="css:{\'od-ScrubBar-tooltip--isScrubbing\':isSeekTooltipVisible},text:seekTooltipTime,style:{left:seekTooltipLeft()+\'px\'}"></div></div>'});
define("odsp-next/controls/video/controls/scrubBar/ScrubBarViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/ScrubBinding","@ms/odsp-utilities/lib/string/TimeFormatter","../../../../bindings/keyboard/KeyboardBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(a.context);n.addBindingHandlers({scrub:s.default,keyboard:u.default});n.percentPlayed=n.createPureComputed(n._computePercentPlayed);n.seekTooltipPercentage=r.observable(0);n.isHovering=r.observable(!1);n.isSeekTooltipVisible=n.createPureComputed(n._computeTooltipVisible);n.seekTooltipTime=n.createPureComputed(n._computeSeekTooltipTime);n.seekTooltipLeft=r.observable(0);return n}t.prototype.onLeftKey=function(){this.context.seekPercentage(Math.max(0,this.context.seekPercentage.peek()-.05));return!1};t.prototype.onRightKey=function(){this.context.seekPercentage(Math.min(1,this.context.seekPercentage.peek()+.05));return!1};t.prototype._computePercentPlayed=function(){return(this.context.isSeeking()||this.context.isScrubbing()?100*this.context.seekPercentage():100*this.context.position()/this.context.duration())+"%"};t.prototype._computeSeekTooltipTime=function(){return o.formatTime(1e3*this.context.duration()*this.seekTooltipPercentage())};t.prototype._computeTooltipVisible=function(){return this.context.duration()&&this.isHovering()};return t})(i.default);t.default=f});
define("odsp-next/controls/video/bindings/ScrubBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._options=r;if(r.value||r.isScrubbing){n.events.on(n.element,"click",n._onMouseClick);n.events.on(n.element,"mousedown",n._onMouseDown);n.events.on(n.element,"touchstart",n._onTouchStart,!0)}(r.isHovering||r.isHovering||r.clientX)&&n.events.on(n.element,"mouseenter",n._onMouseEnter);return n}t.prototype._updateContainerRect=function(){var e=this.element.getBoundingClientRect();this._containerRect={left:e.left,top:e.top,width:e.width,height:e.height}};t.prototype._onTouchStart=function(e){e.touches&&e.touches.length&&this._onMouseDown(e.touches[0])};t.prototype._onTouchMove=function(e){e.touches&&e.touches.length&&this._onMouseMove(e.touches[0])};t.prototype._onMouseEnter=function(e){this._updateContainerRect();this.events.on(this.element,"mouseleave",this._onMouseLeave);this.events.on(window,"mousemove",this._onMouseMove);this.events.on(window,"touchmove",this._onTouchMove);this._onMouseMove(e);this._isHovering=!0};t.prototype._onMouseLeave=function(e){this._isHovering=!1;this.events.off(this.element,"mouseleave");if(!this._isScrubbing){this.events.off(window,"mousemove");this.events.off(window,"touchmove")}};t.prototype._onMouseDown=function(e){this._updateContainerRect();this.events.on(window,"mouseup",this._onMouseUp);this.events.on(window,"touchend",this._onMouseUp,!0);if(!this._isHovering){this.events.on(window,"mousemove",this._onMouseMove);this.events.on(window,"touchmove",this._onTouchMove,!0)}this._isScrubbing=!0;this._onMouseMove(e);return!1};t.prototype._onMouseMove=function(e){var t=e.clientX-this._containerRect.left,n=Math.min(1,Math.max(0,t/this._containerRect.width));this._hoverValue=n;this._clientX=t;this._isScrubbing&&(this._value=n);return!1};t.prototype._onMouseUp=function(){this.events.off(window,"mouseup");this.events.off(window,"touchend");this._isScrubbing=!1;if(!this._isHovering){this.events.off(window,"mousemove");this.events.off(window,"touchmove")}return!1};t.prototype._onMouseClick=function(e){this._onMouseDown(e);this._onMouseUp();return!1};Object.defineProperty(t.prototype,"_value",{set:function(e){this._options.value&&this._options.value(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isScrubbing",{get:function(){return!!this._options.isScrubbing&&this._options.isScrubbing.peek()},set:function(e){this._options.isScrubbing&&this._options.isScrubbing(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_hoverValue",{set:function(e){this._options.hoverValue&&this._options.hoverValue(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isHovering",{get:function(){return!!this._options.isHovering&&this._options.isHovering.peek()},set:function(e){this._options.isHovering&&this._options.isHovering(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_clientX",{set:function(e){this._options.clientX&&this._options.clientX(e)},enumerable:!0,configurable:!0});return t})(r.default);t.default=i});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenu",["require","exports","./VolumeMenu.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./VolumeMenuViewModel","ODCItemVideoPlayer_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-volume-menu",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenu.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko component:overlayComponent--\x3e<div role="slider" class="od-VolumeMenu" data-bind="keyboard:{mappings:{Left:onLeftKey,Right:onRightKey,preventDefault:true}}"><button class="od-VolumeMenu-button" data-bind="hasFocus:true,attr:{\'aria-label\':volumeLabel},click:onMuteToggleClicked"><i data-bind="class:icon"></i></button><div class="od-VolumeMenu-bar" tabindex="0" data-bind="scrub:{value:context.volume,isScrubbing:context.isAdjustingVolume}"><div class="od-VolumeMenu-scrubFill"></div><div class="od-VolumeMenu-scrubArea"><div class="od-VolumeMenu-scrubThumb" data-bind="style:{width:percentVolume}"></div></div></div><div class="od-VolumeMenu-volume" data-bind="text:volume"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenuViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling","../../../overlays/Overlay","../../../../bindings/dismiss/DismissBinding","../../bindings/ScrubBinding","../../VideoPlayer.resx","../../../../bindings/keyboard/KeyboardBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.overlayComponent={name:s.default.tagName,params:{alignToParent:!0}};n.context=n.resources.consume(l.context);n.addBindingHandlers({dismiss:o.default,scrub:u.default,keyboard:f.default});n.volume=n.createPureComputed(n._computeVolume);n.percentVolume=n.createPureComputed(n._computePercentVolume);n.volumeLabel=n.createComputed(n._computeVolumeLabel);n.icon=n.createPureComputed(n._computeIcon);return n}t.prototype.onLeftKey=function(){this.context.volume(Math.max(0,this.context.volume.peek()-.01));return!1};t.prototype.onRightKey=function(){this.context.volume(Math.min(1,this.context.volume.peek()+.01));return!1};t.prototype.onMuteToggleClicked=function(e,t){this.context.isMuted(!this.context.isMuted.peek());return!1};t.prototype.getMuteButtonClass=function(){var e=this.context.volume();return this.context.isMuted()?"VolumeDisabled":0===e?"Volume0":e<=.3?"Volume1":e<=.6?"Volume2":"Volume3"};t.prototype._computeVolume=function(){return Math.round(100*this.context.volume())};t.prototype._computePercentVolume=function(){return this.volume()+"%"};t.prototype._computeVolumeLabel=function(){return this.context.isMuted()?a.default.unmuteTooltip:a.default.muteTooltip};t.prototype._computeIcon=function(){return i.getIconClassName(this.getMuteButtonClass())};return t})(r.default);t.default=c});
define("odsp-next/controls/video/actions/ToggleVideoTranscodeAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideotranscode";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.disableTranscode.peek();this._context.disableTranscode(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.disableTranscode()};return t})(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoBetaTranscodeAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoBetatranscode";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.useBetaTranscode.peek();this._context.useBetaTranscode(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!this._context.disableTranscode()};t.prototype.onIsToggled=function(){return this.isAvailable()&&this._context.useBetaTranscode()};return t})(r.default);t.default=u});
define("odsp-next/controls/video/controls/canvas/VideoCanvas",["require","exports","./VideoCanvas.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./VideoCanvasViewModel","ODCItemVideoPlayer_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-videocanvas",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/video/controls/canvas/VideoCanvas.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-VideoCanvas">\x3c!--ko if:context.canvasType()===\'html\'--\x3e<div data-bind="htmlVideoContext:context"></div>\x3c!--/ko--\x3e\x3c!--ko if:context.canvasType()===\'flash\'--\x3e<div data-bind="flashVideoContext:context"></div>\x3c!--/ko--\x3e\x3c!--ko if:context.isDiagnosticsEnabled--\x3e<div data-bind="videoMonitor:context"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/video/controls/canvas/VideoCanvasViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./HtmlVideoContextBinding","./FlashVideoContextBinding","./VideoMonitorBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(u.context);n.addBindingHandlers({htmlVideoContext:i.default,flashVideoContext:s.default,videoMonitor:o.default});return n}return t})(r.default);t.default=a});
define("odsp-next/controls/video/controls/canvas/HtmlVideoContextBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../VideoPlayer.resx","../../VideoError","@ms/dashling/lib/Dashling","@ms/dashling/lib/ManifestParser","@ms/dashling/lib/Settings","@ms/dashling/lib/DashlingEnums","../../VideoPlaybackType","../../VideoErrorType","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../../utilities/features/Features","@ms/odsp-utilities/lib/uri/Uri","../../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y;(function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED";e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK";e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE";e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"})(y||(y={}));var b=window.VTTCue||window.TextTrackCue,w=0;function E(e,t){return(e&&e.streams&&e.streams[t]&&e.streams[t].qualities||[]).map(function(e){var t=e.id;return parseInt(/\D*(\d+)p/.exec(void 0===t?"":t)[1],10)}).filter(function(e){return!!e})}var S=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r=n.observables,i=n._context=n.valueAccessor();n._errors={};n.subscribe(i.url,n._onUrlChanged);r.backgroundCompute(n._computeVolume);r.backgroundCompute(n._computeIsMuted);n.subscribe(i.seekPercentage,n.async.debounce(n._onSeekPercentageChanged,100));n.subscribe(i.isScrubbing,n._onIsScrubbingChanged);n.subscribe(i.desiredQuality,n._onDesiredQualityChanged);n.subscribe(i.isABREnabled,n._onIsABREnabledChanged);n.subscribe(i.isPlaying,n._onIsPlayingChanged);n._onUrlChanged(i.url());n._onIsPlayingChanged(i.isPlaying.peek());return n}t.prototype.dispose=function(){this._disposeVideo();e.prototype.dispose.call(this)};t.prototype._disposeVideo=function(){if(this._dashling){this._context.dashling(null);this._dashling.dispose();this._dashling=null}var e=this._videoElement,t=this._errorTrack;if(t){this.events.off(t);this._errorTrack=void 0}this._errors={};if(e){this.events.off(e);try{e.pause();this.element.removeChild(e)}catch(e){}this._videoElement=void 0}};t.prototype._onErrorChange=function(){var e=this._errorTrack,t=e&&e.activeCues,n=t&&t[0];if(n){var r=this._errors[n.id];this._context.setVideoStatus(r)}};t.prototype._onUrlChanged=function(e){var t=this;if(this._videoElement)var n=this._videoElement.currentTime,r=Number(n.toFixed(5));this._disposeVideo();if(e){var i=this._videoElement=document.createElement("video");this.events.onAll(i,{loadstart:this._handleLoadStart,canplay:this._handleCanPlay,error:this._handleVideoElementError,ended:this._handleEnded,volumechange:this._handleVolumeChanged,play:this._handlePlay,pause:this._handlePause,waiting:this._handleWaiting,playing:this._handlePlaying,durationchange:this._handleBufferChange,ratechange:this._handleRateChange,timeupdate:this._handleBufferChange,progress:this._handleBufferChange});if("addTextTrack"in i&&b&&v.isFeatureEnabled(v.DeferVideoSegmentErrors)){var s=this._errorTrack=i.addTextTrack("metadata","segmenterror","");this.events.on(s,"cuechange",this._onErrorChange)}i.className="od-VideoCanvas-video";if(this._context.shouldUseNativeControls){this.events.on(i,"loadedmetadata",this._handleCanPlay);i.setAttribute("controls","");i.setAttribute("poster",this._context.coverImageUrl.peek()||"");i.setAttribute("preload","metadata")}else this._context.shouldAutoPlay&&i.setAttribute("autoplay","autoplay");if(this._context.playbackType()===c.default.htmlDashling||this._context.playbackType()===c.default.htmlDashlingMediaFoundationFallback)this.async.setTimeout(function(){var e=t._context.playbackType()===c.default.htmlDashlingMediaFoundationFallback?r:void 0;t._initializeDashling(e)},0);else{if(v.isFeatureEnabled(v.VideoSetQueryParamForNative)){var o=new m.default(e);o.setQueryParameter("App","OneDriveWebVideo");e=o.toString()}i.setAttribute("src",e)}this._computeVolume();this._computeIsMuted();this.element.appendChild(i);this._checkPlayState(!0)}};t.prototype._initializeDashling=function(e){var t=this,r=this._videoElement;if(r){var i=this._context,o=i.url.peek(),c=v.isFeatureEnabled(v.VideoABRQualityThrottle240)?240:v.isFeatureEnabled(v.VideoABRQualityThrottle360)?360:v.isFeatureEnabled(v.VideoABRQualityThrottle480)?480:v.isFeatureEnabled(v.VideoABRQualityThrottle720)?720:null;if(c){var p=new m.default(o);p.setQueryParameter("supportsDefaultQualityLimits","1");o=p.toString()}var d=f.defaultSettings;v.isFeatureEnabled(v.ChangeVideoAuth)&&(d.getRequestParametersAsync=i.getRequestParametersAsync.bind(i));new a.ManifestParser(d).parse(o,function(n){var s={manifest:n,isABREnabled:i.isABREnabled(),requestTimeout:4e4,startTime:e},o=E(n,"video"),a=o.length-1;if(c)for(var f=0;f<o.length;f++)if(o[f]>c){f>0&&(s.abrLimitQuality={video:f-1});break}var l=o.indexOf(i.desiredQuality());-1===l&&(l=a);s.targetQuality={audio:1,video:l};v.isFeatureEnabled(v.ChangeVideoAuth)&&(s.getRequestParametersAsync=i.getRequestParametersAsync.bind(i));v.isFeatureEnabled(v.VideoBasicConnectivityTest)&&(s.testConnectivity=i.testConnectivity.bind(i));i.isPlaybackCDNEnabled.peek()&&(s.publishResponseMetaData=i.publishResponseMetaData.bind(i));v.isFeatureEnabled(v.VideoEndOfStream)&&(s.missingSegmentThreshold=-2);i.isSeeking()&&i.duration()&&(s.startTime=i.duration()*i.seekPercentage());var h=t._dashling=new u.default(s);t._manifestQualityMap=null;h.load(r,i.url.peek());i.dashling(h)},function(e,r,i,o){var u={statusMessage:s.default.errorLoading,errorCode:"",errorType:h.default.htmlOther,errorMessage:void 0,isRetriable:!0,isExpected:!1,isDisconnected:!1,requiresNewUrl:!1,correlationId:""};u=n.__assign(n.__assign({},u),t._parseDashlingErrorData({state:"networkDisconnected"===e?l.DashlingSessionState.disconnected:l.DashlingSessionState.error,lastErrorType:e,lastErrorMessage:r,lastHttpStatus:i,lastCorrelationId:o,lastError:e?e+" "+(r?"("+r+")":""):null}));t._setError(n.__assign({},u))})}};t.prototype._onIsPlayingChanged=function(e){this._checkPlayState();if(e)this._updatePlaybackStateId||(this._updatePlaybackStateId=this.async.setInterval(this._updatePlaybackState,100));else{this.async.clearInterval(this._updatePlaybackStateId);this._updatePlaybackStateId=0}};t.prototype._onDesiredQualityChanged=function(e){var t=this._getManifestVideoQualities();if(t){this._dashling.settings.targetQuality.video=t.indexOf(e);this._dashling.settings.isABREnabled=!1;this._dashling.resetStreams()}};t.prototype._onIsABREnabledChanged=function(e){this._dashling&&(this._dashling.settings.isABREnabled=e)};t.prototype._computeVolume=function(){var e=this._context.volume(),t=this._videoElement;t&&(t.volume=e)};t.prototype._computeIsMuted=function(){var e=this._context.isMuted(),t=this._videoElement;t&&(t.muted=e)};t.prototype._onSeekPercentageChanged=function(e){var t=this._videoElement;if(t&&t.duration&&!this._context.videoStatus().isVisible){t.currentTime=e?e*t.duration:0;this._context.isSeeking(!0)}};t.prototype._onIsScrubbingChanged=function(e){this._onSeekPercentageChanged(this._context.seekPercentage());var t=this._videoElement;!e&&t&&this._context.position(t.currentTime)};t.prototype._handleLoadStart=function(e){this._context.isLoading(!0)};t.prototype._handleCanPlay=function(e){this._context.canPlay(!0)};t.prototype._parseDashlingErrorData=function(e){var t=e.state,n=e.lastErrorType,r=e.lastErrorMessage,i=e.lastHttpStatus,o=e.lastCorrelationId,u=e.lastError,a={};a.correlationId=o;var f=t===l.DashlingSessionState.disconnected;if(f||t===l.DashlingSessionState.error){a.errorMessage=u;var c=i,p=r;p&&(p instanceof Error?a.errorMessage=""+p.message:a.errorMessage=p);a.errorCode="number"==typeof c?c+"."+a.errorMessage:"";429===c&&(a.statusMessage=s.default.throttledErrorMessage);if(406===c){a.statusMessage=s.default.unsupportedCodecErrorMessage;a.isExpected=!0}var v=a.errorMessage&&a.errorMessage.toLowerCase();if(v&&v.indexOf("videoprocessing_bitratetoohigh")>-1){a.statusMessage=s.default.bitRateTooHighErrorMessage;a.isExpected=!0}if(v&&v.indexOf("fileempty")>-1){a.errorType=h.default.emptyFile;a.statusMessage=s.default.errorEmptyFile;a.isExpected=!0;return a}switch(n){case"initSegmentDownload":a.errorType=h.default.htmlDashlingInitSegmentDownload;break;case"manifestDownload":a.errorType=h.default.htmlDashlingManifestDownload;a.requiresNewUrl=!1;break;case"manifestParse":a.errorType=h.default.htmlDashlingManifestParse;break;case"mediaSegmentDownload":a.errorType=h.default.htmlDashlingMediaSegmentDownload;this._videoElement.buffered.length&&(a.statusMessage=s.default.errorSegment);a.requiresNewUrl=!1;break;case"mediaSourceInit":a.errorType=h.default.htmlDashlingMediaSourceInit;break;case"sourceBufferAppendException":a.errorType=h.default.htmlDashlingSourceBufferAppendException;a.statusMessage=s.default.errorSegment;break;case"sourceBufferAppendMissing":a.errorType=h.default.htmlDashlingSourceBufferAppendMissing;a.statusMessage=s.default.errorSegment;break;case"sourceBufferInit":a.errorType=h.default.htmlDashlingSourceBufferInit;break;case"videoElementError":break;case"networkDisconnected":a.isDisconnected=!0;a.statusMessage=s.default.errorNetwork;break;case"aesKeyFetchError":a.errorType=h.default.htmlDashlingAesKeyFetchError;a.requiresNewUrl=!0;a.isExpected=!1;break;case"webCryptoInitError":a.errorType=h.default.htmlDashlingWebCryptoInitError;a.requiresNewUrl=!0;a.isExpected=!0;break;case"segmentDecryptionError":a.errorType=h.default.htmlDashlingSegmentDecryptionError;a.isExpected=!1;a.requiresNewUrl=!0;break;default:a.errorType=h.default.htmlDashlingOther}if(this._context.isPlaybackCDNEnabled.peek()){d.default.log("Error occurred in CDN Encryption Flight enabled. ErrorType: "+a.errorType+" ErrorMessage: "+a.errorMessage+" ErrorCode: "+a.errorCode);a.requiresNewUrl=!0}if(f){a.isDisconnected=!0;a.statusMessage=s.default.errorNetwork}}return a};t.prototype._getDashlingErrorInfo=function(){var e=this._dashling;return this._parseDashlingErrorData({state:e.state,lastErrorType:e.lastErrorType,lastErrorMessage:e.lastErrorMessage,lastHttpStatus:e.lastHttpStatus,lastCorrelationId:e.lastCorrelationId,lastError:e.lastError})};t.prototype._handleVideoElementError=function(){var e=this._videoElement,t=this._dashling,r={statusMessage:s.default.errorLoading,errorCode:"",errorType:h.default.htmlOther,errorMessage:void 0,isRetriable:!0,isExpected:!1,isDisconnected:!1,requiresNewUrl:!1,correlationId:t&&t.lastCorrelationId},i=e&&e.error;r.errorCode=c.default[this._context.playbackType.peek()];if(i){var o=i.code;"string"==typeof o&&(o=y[o]);r.errorMessage=i.message||"";switch(o){case y.MEDIA_ERR_DECODE:r.errorType=h.default.htmlElementDecode;r.statusMessage=s.default.errorDecode;r.isRetriable=!1;r=n.__assign(n.__assign({},r),this._getDashlingErrorInfo());break;case y.MEDIA_ERR_NETWORK:r.errorType=h.default.htmlElementNetwork;r.statusMessage=s.default.errorNetwork;t?r=n.__assign(n.__assign({},r),this._getDashlingErrorInfo()):v.isFeatureEnabled(v.VideoBasicConnectivityTest)&&(r.isDisconnected=!1===navigator.onLine);break;case y.MEDIA_ERR_SRC_NOT_SUPPORTED:r.errorType=h.default.htmlElementSrcNotSupported;r.statusMessage=s.default.errorUnsupportedBrowser;r.isExpected=!0;break;case y.MEDIA_ERR_ABORTED:return;default:r.errorType=h.default.htmlElementOther}}else r=n.__assign(n.__assign({},r),this._getDashlingErrorInfo());this._setError(r)};t.prototype._setError=function(e){var t=new o.VideoError({code:e.errorCode,correlationId:e.correlationId,isExpected:e.isExpected||e.isDisconnected,isRetriable:e.isRetriable&&!e.isExpected,message:e.errorMessage,requiresNewUrl:e.requiresNewUrl,type:e.errorType}),n={statusMessage:e.statusMessage,error:t};this._tryDeferError(n)||this._context.setVideoStatus(n)};t.prototype._tryDeferError=function(e){try{var t=this._errorTrack;if(!t||!b)return!1;switch(e.error.type){case h.default.htmlDashlingMediaSegmentDownload:case h.default.htmlDashlingSourceBufferAppendException:case h.default.htmlDashlingSourceBufferAppendMissing:break;default:return!1}if(this._context.isLoading.peek()&&g.default.isActivated("63B207A3-C1E7-4D7C-BAEB-16FF56B406F1","07/01/2019","Rely on buffer for deferred segment errors"))return!1;for(var n=this._videoElement,r=n.currentTime,i=n.buffered,s=-1,o=0;o<i.length;o++){var u=i.end(o);if(i.start(o)<r){s=u;if(u>r)break}}if(s<=0)return!1;var a=""+ ++w,f=new b(Math.max(0,s-1),1e10,"");f.id=a;t.addCue(f);this._errors[a]=e;return!0}catch(e){d.default.log(e);return!1}};t.prototype._checkPlayState=function(e){var t=this,n=this._videoElement,r=!1,i=this._context;(e=e||!i.canPlay())||(this._stalePlayStateId=0);if(n){if(i.isPlaying()&&!i.isScrubbing()&&n.paused)if(e)r=!0;else{Math.abs(i.position()-i.duration())<.5&&(n.currentTime=0);p.default.resolve(n.play()).then(function(){},function(){i.isPlaying(!1)})}else i.isPlaying()&&!i.isScrubbing()||n.paused||(e?r=!0:n.pause());r&&!this._stalePlayStateId&&(this._stalePlayStateId=this.async.setTimeout(function(){t._stalePlayStateId=0;t._checkPlayState()},300))}};t.prototype._checkEndState=function(e){var t=this._videoElement,n=this._context;e||(this._staleEndStateId=0);if(t&&(!e||n.isPlaying())&&t.duration-t.currentTime<=.4)if(e)this._staleEndStateId||(this._staleEndStateId=this.async.setTimeout(this._checkEndState,400));else{n.position(n.duration());this._handleEnded(null)}};t.prototype._updatePlaybackState=function(){this._videoElement&&this._handleBufferChange()};t.prototype._getManifestVideoQualities=function(){if(!this._manifestQualityMap){var e=this._dashling,t=e&&e.settings,n=t&&t.manifest;if(n){var r=E(n,"video");0!==r.length&&(this._manifestQualityMap=r)}}return this._manifestQualityMap};t.prototype._updateDashlingState=function(){var e=this._dashling,t=this._context;e.settings.isABREnabled=t.isABREnabled();var n=this._getManifestVideoQualities();if(n){t.dashQualities(n);t.maxQuality(n[e.getMaxQuality("video")]);e.settings.isABREnabled?t.playingQuality(n[e.getPlayingQuality("video")]):t.playingQuality(n[e.getBufferingQuality("video")])}else t.maxQuality(0)};t.prototype._handleEnded=function(e){this._context.isPlaying(!1)};t.prototype._handleVolumeChanged=function(e){var t=this._videoElement;t&&this._context.volume(t.volume)};t.prototype._handlePlay=function(e){this._context.isPlaying(!0)};t.prototype._handlePause=function(e){this._context.isScrubbing()||this._context.isPlaying(!1)};t.prototype._handleWaiting=function(e){this._context.isLoading(!0);this._onErrorChange()};t.prototype._handlePlaying=function(e){this._context.isLoading(!1);this._context.isSeeking(!1);this._context.isPlaying(!0)};t.prototype._handleRateChange=function(){var e=this._videoElement.playbackRate;this._context.isLoading(e<.5)};t.prototype._handleBufferChange=function(){var e=this._videoElement,t=e.buffered,n=e.duration,i=this._context.bufferedRanges;this._checkPlayState(!0);this._checkEndState(!0);this._context.position(e.currentTime);this._context.duration(e.duration);if(n&&t){for(;i().length>t.length;)i.pop();for(var s=0;t&&s<t.length;s++){var o=i()[s],u=t.start(s),a=100*u/n+"%",f=100*(t.end(s)-u)/n+"%";if(o){o.left(a);o.width(f)}else i.push({left:r.observable(a),width:r.observable(f)})}}this._dashling&&this._updateDashlingState()};return t})(i.default);t.default=S});
define("odsp-next/controls/video/controls/canvas/FlashVideoContextBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/browser/PlatformDetection","../../VideoPlayer.resx","../../VideoError","../../VideoErrorType","../../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=0,c=new s.default,h={},p=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n._context=n.valueAccessor();n._isPlayerReady=r.observable(!1);n.subscribe(n._context.url,n._onUrlChanged);n.createBackgroundComputed(n._computeVolume);n.createBackgroundComputed(n._computeIsMuted);n.subscribe(n._context.seekPercentage,n.async.debounce(n._onSeekPercentageChanged,100));n.subscribe(n._context.isScrubbing,n._onIsScrubbingChanged);n.subscribe(n._context.isPlaying,n._onIsPlayingChanged);n._onUrlChanged();return n}t.prototype.dispose=function(){this._removeFlashPlayer();e.prototype.dispose.call(this)};t.prototype.handlePlaybackEvent=function(e,t){var n=this._playerElement;n||(n=this._playerElement=document.getElementById(this._playerId));this._isPlayerReady(!0);if(n)switch(e){case"onJavaScriptBridgeCreated":break;case"loadstart":this._context.isLoading(!0);this._loadTimeoutId=this.async.setTimeout(this._onLoadTimeout,1e4);break;case"error":this._context.setVideoStatus({statusMessage:o.default.errorLoading,error:new u.VideoError({code:"unspecified",type:a.default.flashOther})});break;case"emptied":this._context.canPlay(!0);break;case"durationchange":break;case"play":this._context.isPlaying(!0);break;case"pause":this._context.isPlaying(!1);break;case"loadedmetadata":this._loadTimeoutId&&this.async.clearTimeout(this._loadTimeoutId);this._context.canPlay(!0);break;case"seeking":this._context.isSeeking(!0);break;case"seeked":this._context.isSeeking(!1);this._context.isLoading(!1);break;case"timeupdate":this._loadTimeoutId&&this.async.clearTimeout(this._loadTimeoutId);this._context.position(t.currentTime);this._context.duration(t.duration);break;case"progress":var i=this._context.bufferedRanges,s=this._context.duration();if(s&&i){for(;i().length>t.buffered.length;)i.pop();for(var f=0;t.buffered&&f<t.buffered.length;f++){var l=i()[f],c=t.buffered._start[f],h=100*c/s+"%",p=100*(t.buffered._end[f]-c)/s+"%";if(l){l.left(h);l.width(p)}else i.push({left:r.observable(h),width:r.observable(p)})}}break;case"volumechange":break;case"complete":this._context.position(this._context.duration.peek());this._context.isPlaying(!1)}};t.prototype._onUrlChanged=function(){this._removeFlashPlayer();this._createFlashPlayer()};t.prototype._computeVolume=function(){var e=this._context.volume();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setVolume(e)}catch(e){}};t.prototype._computeIsMuted=function(){var e=this._context.isMuted();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setMuted(e)}catch(e){}};t.prototype._onSeekPercentageChanged=function(e){var t=this._context.duration();if(this._isPlayerReady()&&this._playerElement&&t&&!this._context.videoStatus().isVisible){try{this._playerElement.seek(e*t)}catch(e){}this._context.isSeeking(!0)}};t.prototype._onIsScrubbingChanged=function(e){this._onSeekPercentageChanged(this._context.seekPercentage())};t.prototype._onIsPlayingChanged=function(e){if(this._isPlayerReady()&&this._playerElement)try{e?this._playerElement.play2():this._playerElement.pause()}catch(e){}};t.prototype._createFlashPlayer=function(){if(this._context.url.peek()){var e=window.require.toUrl("odsp-media/flash/osmf.swf"),t=window.require.toUrl("odsp-media/flash/strobe.swf");if(!f.isFeatureEnabled(f.UseFlashVideoPlayerFromManifest)){var n=window.FilesConfig.imgBaseUrl||"";if(n){e=n+"flash/v1/osmf.swf";t=n+"flash/v1/strobe.swf"}}var r="",i=this._context;this._playerId="player-"+ ++l;var s=this._playerId;h[s]=this;var o="javascriptCallbackFunction=flashVideoCallback&autoPlay="+!!this._context.shouldAutoPlay+"&loop=false&controlBarMode=none&enableStageVideo=true&controlBarAutoHide=false&playButtonOverlay=false&id="+s+"&useHTML5=false&bufferingOverlay=false&src="+encodeURIComponent(i.url())+"&plugin_AdaptiveStreamingPlugin="+encodeURIComponent(e);r=c.isIE&&c.browserMajor<9?'<object id="'+s+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"><param name="movie" value="'+t+'" />':'<object id="'+s+'" name="'+s+'" type="application/x-shockwave-flash" data="'+t+'">';r+='<param name="allowfullscreen" value="false" /><param name="wmode" value="transparent" /><param name="bgcolor" value="000000"/><param name="allowscriptaccess" value="always"/><param name="flashvars" value="'+o+'" /></object>';this.element.innerHTML=r;this._playerElement=document.getElementById(s)}};t.prototype._removeFlashPlayer=function(){if(this._playerId){delete h[this._playerId];delete this._playerId;this._isPlayerReady(!1);var e=this._playerElement;this._playerElement=null;if(e)if(c.isIE){e.style.display="none";4===e.readyState?this._removeFlashPlayerIE(e):this.events.on(e,"readystatechange",this._onIEFlashPlayerReadyStateChange)}else try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){}}};t.prototype._removeFlashPlayerIE=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=null);e.parentNode&&e.parentNode.removeChild(e)};t.prototype._onIEFlashPlayerReadyStateChange=function(e){var t=e.target;if(4===t.readyState){this._removeFlashPlayerIE(t);this.events.off(t,"readystatechange",this._onIEFlashPlayerReadyStateChange)}};t.prototype._onLoadTimeout=function(){this._context.setVideoStatus({statusMessage:o.default.errorLoading,error:new u.VideoError({code:"timeout",type:a.default.flashLoadTimeout})})};return t})(i.default);t.default=p;window.flashVideoCallback=function(e,t,n){h[e]&&h[e].handlePlaybackEvent(t,n)}});
define("odsp-next/controls/video/controls/canvas/VideoMonitorBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/dashling/lib/DashlingMonitor","ODCItemVideoPlayer_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n._videoContext=n.valueAccessor();n.createBackgroundComputed(n._computeDashlingMonitor);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._disposeMonitor()};t.prototype._disposeMonitor=function(){if(this._dashlingMonitor){this._dashlingMonitor.dispose();this._dashlingMonitor=null;this.element.innerHTML=""}};t.prototype._computeDashlingMonitor=function(){var e=this._videoContext.dashling();this._disposeMonitor();if(e){this._dashlingMonitor=new i.default;this._dashlingMonitor.attachTo(this.element);this._dashlingMonitor.observe(e,e.videoElement)}};return t})(r.default);t.default=s});
define("@ms/dashling/lib/DashlingMonitor",["require","exports","./DashlingEnums","@uifabric/utilities/lib/EventGroup"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=(function(){function e(){var e=this;this._updateSeekBar=function(){var t=e,n=t._videoElement,r=t.subElements;if(n&&r){var i=100*n.currentTime/n.duration+"%";r.audioSeekBar.style.left=i;r.videoSeekBar.style.left=i}};this.id="DashMonitorView-"+i++;this.isActive=!1;this.isVisible=!0;this._dataContext=null;this._videoElement=null;this._interval=0;this._events=null;this._dashling=null;this.element=null;this.subElements=null;this.reset()}e.prototype.dispose=function(){if(this._interval){clearInterval(this._interval);this._interval=0}this._events&&this._events.dispose();this._videoElement&&(this._videoElement=null);this._dashling&&(this._dashling=null)};e.prototype.attachTo=function(e){var t=u("div");t.innerHTML=this.renderHtml();this.element?e.replaceChild(t.firstChild,this.element):e.appendChild(t.firstChild);this.activate()};e.prototype.observe=function(e,t){this._events&&this._events.dispose();this._events=new r.EventGroup(this);if(t){this._videoElement=t;this._events.onAll(t,{timeupdate:this._updateSeekBar,seeking:this._updateSeekBar})}if(e){this._dashling=e;this._events.on(e,"sessionstatechange",this._onSessionChanged);this._onSessionChanged()}};e.prototype.reset=function(){this._dataContext=this._createContext();this.element&&this.attachTo(this.element.parentElement)};e.prototype.setVisibility=function(e){if(e!==this.isVisible){this.isVisible=e;this.isActive&&this._update()}};e.prototype.setDataContext=function(e){this._dataContext=e;this._update()};e.prototype.renderHtml=function(){return'<div id="'+this.id+'" class="c-DashMonitor"><ul class="streamMetrics"></ul><div class="audio streamData"><span class="streamTitle">Audio</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="video streamData"><span class="streamTitle">Video</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="key"><div class="keyItem"><div class="keyBox waiting"></div><span>Waiting for response</span></div><div class="keyItem"><div class="keyBox downloading"></div><span>Receiving bytes</span></div><div class="keyItem"><div class="keyBox downloaded"></div><span>Downloaded</span></div><div class="keyItem"><div class="keyBox appending"></div><span>Appending</span></div><div class="keyItem"><div class="keyBox appended"></div><span>Appended</span></div><div class="keyItem"><div class="keyBox error"></div><span>Error</span></div></div>'};e.prototype.activate=function(){var e=this.element=o("#"+this.id);this.subElements={metrics:o(".streamMetrics",e),audioElement:o(".audio"),audioMetrics:o(".audio .streamMetrics",e),audioQualities:o(".audio .qualities",e),audioSeekBar:o(".audio .seekBar",e),videoElement:o(".video"),videoMetrics:o(".video .streamMetrics",e),videoQualities:o(".video .qualities",e),videoSeekBar:o(".video .seekBar",e),key:o(".key")};this.isActive=!0;this._update()};e.prototype.deactivate=function(){this.subElements=null;this.isActive=!1};e.prototype._onSessionChanged=function(){var e=this,t=e._dashling,r=t.state;if(r===n.DashlingSessionState.error||r===n.DashlingSessionState.idle){clearInterval(e._interval);e._interval=0;e.setDataContext(e._getStats(t))}else t.state>n.DashlingSessionState.idle&&!e._interval&&(e._interval=setInterval(function(){e.isVisible&&e.setDataContext(e._getStats(t))},100))};e.prototype._update=function(){var e=this._dataContext,t=void 0!==e.state&&!!this._dashling&&e.state!==n.DashlingSessionState.idle;if(this.isActive){var r=this.subElements;l(this.element,"isVisible",t&&this.isVisible);this._updateMetrics(r.metrics,e.metrics);var i=e&&e.streams,s=i&&i.audio||{},o=i&&i.video||{};l(r.audioElement,"isVisible",!(!s.metrics&&!s.qualities));l(r.videoElement,"isVisible",!(!o.metrics&&!o.qualities));l(r.key,"isVisible",!(!s.qualities&&!o.qualities));this._updateMetrics(r.audioMetrics,s.metrics);this._updateQualities(r.audioQualities,s.qualities);this._updateMetrics(r.videoMetrics,o.metrics);this._updateQualities(r.videoQualities,o.qualities)}};e.prototype._updateMetrics=function(e,t){l(e,"isVisible",!!t);if(t)for(var n=e._metricLookup=e._metricLookup||{},r=0;r<t.length;r++){var i=t[r],s=n[i.title];if(!s){(s=u("li")).innerHTML='<span class="metricTitle">'+i.title+'</span><span class="metricValue"></span>';o(".metricTitle",s).textContent=i.title;e.appendChild(s);s=n[i.title]=o(".metricValue",s)}s.parentElement.className=i?"hasValue":"";s.textContent=i.value}};e.prototype._updateQualities=function(e,t){l(e,"isVisible",!!t);if(t)for(var n=e._qualityRowLookup=e._qualityRowLookup||{},r=0;r<t.length;r++){var i=t[r];if(i){var s=n[r];if(!s){s=n[r]=u("div","row");u("div","rowHeader",i.title,s);u("div","rowFragments",null,s);s.qualityIndex=i.index;for(var a=e.firstElementChild;a;){if(i.index>Number(a.qualityIndex)){e.insertBefore(s,a);break}a=a.nextElementSibling}s.parentNode||e.appendChild(s)}this._updateFragments(o(".rowFragments",s),i.fragments)}}};e.prototype._updateFragments=function(e,t){l(e,"isVisible",!!t);if(t){for(var n=e._fragmentListLookup=e._fragmentListLookup||{},r={},i=this._dataContext.duration,s=0;s<t.length;s++){var o=t[s],a=n[o.index];if(a)delete n[o.index];else{(a=u("div","rowRequest",null,e)).style.left=100*o.start/i+"%";a.style.width=100*o.length/i+"%"}r[o.index]=a;a.className="rowRequest "+o.state}e._fragmentListLookup=r;for(var f in n)n[f]&&e.removeChild(n[f])}};e.prototype._createContext=function(){return{state:n.DashlingSessionState.idle,metrics:[],streams:{audio:null,video:null},duration:0}};e.prototype._getStats=function(e){var t=this._createContext(),r=e.streamController,i=e.settings.manifest;t.state=e.state;t.metrics.push({title:"State",value:n.DashlingSessionState[e.state]},{title:"Last error",value:e.lastError},{title:"Load",value:(e.timeAtFirstCanPlay||Date.now()-(e.startTime||0))+" ms"});if(i&&r){t.duration=i.mediaDuration;var s=r?r.getTimeUntilUnderrun():0;t.metrics.push({title:"Manifest",value:i&&i.request&&i.request.timeAtLastByte?i.request.timeAtLastByte+" ms":""},{title:"Stalls",value:String(r.stalls)||""},{title:"Recovery time",value:""},{title:"Stall chance",value:""},{title:"Buffer rate",value:a(e.getBufferRate(),2,2)+" s/s"},{title:"Buffer left",value:a(e.getRemainingBuffer(),2,2)+" s"},{title:"Time until stall",value:s<Number.MAX_VALUE?a(s,2,2)+" s":""});for(var o=0,u=r.streams;o<u.length;o++){var l=u[o],c=[],h=[];c.push({title:"Quality",value:String(l.qualityIndex)});var p=l.requestManager.waitTimes.average;c.push({title:"Avg wait",value:p?a(p,2)+" ms":null});p=l.requestManager.receiveTimes.average;c.push({title:"Avg receive",value:p?a(p,2)+" ms":null});p=l.requestManager.bytesPerSeconds.average;c.push({title:"Avg bandwidth",value:p?f(p):null});for(var d=0;d<l.fragments.length;d++){var v=l.fragments[d];if(v.activeRequest){var m=v.qualityIndex,g=h[m];g||(g=h[m]={title:v.qualityId,index:m,fragments:[]});var y=v.state===n.DashlingRequestState.downloading&&-1===v.activeRequest.timeAtFirstByte?"waiting":n.DashlingRequestState[v.state]||"";g.fragments.push({index:d,state:y,start:v.time.startSeconds,length:v.time.lengthSeconds})}}t.streams[l.streamType]={metrics:c,qualities:h}}}return t};return e})();t.default=s;function o(e,t){return(t||document).querySelector(e)}function u(e,t,n,r){var i=document.createElement(e);t&&(i.className=t);n&&(i.textContent=n);r&&r.appendChild(i);return i}function a(e,t,n){var r=String(parseFloat(e.toFixed(t)));if(n){r.indexOf(".")<0&&(r+=".");for(;r.indexOf(".")!==r.length-3;)r+="0"}return r}function f(e){var t=8*e;return t<1e3?t+" bps":t<1e6?a(t/1e3,2,2)+" kbps":a(t/1e6,2,2)+" mbps"}function l(e,t,n){if(e){var r=e.classList;void 0===n?r.toggle(t):n?r.add(t):r.remove(t)}}});
define("odsp-next/dataSources/videoItem/odc/VideoItemDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/auth/DomainAuthenticator","../../../controls/video/VideoPlaybackType","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../utilities/browser/WebViewDetector","../../url/odc/UrlHelpers"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(){function e(e,t){this._downloadDataSource=t.downloadDataSource;this._graphDataSource=t.graphDataSource;var n=t.platformDetection;this._redirectToHttp=n.isAndroid&&n.browserMajor<4;this.isOneDriveWinApp=f.isOneDriveWinApp()}e.prototype.isStreamingSupported=function(e){return!0};e.prototype.isHlsPlaybackSupported=function(){return!0};e.prototype.isDownloadBlocked=function(e){return!1};e.prototype.getDownloadUrl=function(e){var t,r,i=this,s=e.item;if((null===(t=s.photo)||void 0===t?void 0:t.isLivePhoto)&&a.isFeatureEnabled(a.EnableLivePhotoVideos)){if(!s.itemId)return n.default.reject(new Error("Item not available"));var o=l.getVroomBaseUrl()+"/drive/items/"+s.itemId+"/content?format=video";r=this._graphDataSource.getAuthenticationParams(s).then(function(e){return o+(e.access_token?"&access_token="+e.access_token:"")},function(e){return n.default.reject(e)})}else if(a.isFeatureEnabled(a.ChangeVideoAuth)){var u=s&&s.urls,f=u&&u.download;r=f?n.default.resolve(f.replace(/\?.+/g,"")):this._graphDataSource.getDownloadUrl(s,{useDirectEndpoint:!0})}else r=this._downloadDataSource.getDownloadUrl(s,{downloadType:2});return r.then(function(t){return i._buildVideoUrl(t,e.playbackType)})};e.prototype.getRequestParametersAsync=function(e,t){return this._downloadDataSource.getDownloadRequestParameters(e,{allowHeaders:!1,url:t.replace(/&access_token=[^&]+/g,"")})};e.prototype._buildVideoUrl=function(e,t){this._redirectToHttp&&0===e.toLowerCase().indexOf("https:")&&(e="http"+e.substr(5));e+="?";if(t===o.default.htmlDashling||t===o.default.flashDash){e+="&videoformat=dash&part=index";0}if(t===o.default.htmlDashling){e+="&pretranscode=0";e+="&transcodeahead=0"}else if(t===o.default.flashDash){e+="&pretranscode=0";e+="&.ism/manifest(format=mpd-time-csf)"}else if(t===o.default.htmlHls){e+="&videoformat=hls&part=index";0}else if(!this.isOneDriveWinApp)return s.default.authenticate(e).then(function(){return e});return e};return e})();t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c,{downloadDataSource:u.download,graphDataSource:u.graph,platformDetection:r.platformDetection})});
define('ODCItemVideoPlayer_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-ScrubBar{position:relative}.od-ScrubBar .ProgressSpinnerFlat{display:none}.od-ScrubBar--isLoading .ProgressSpinnerFlat{display:block;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:absolute;left:0;right:0;bottom:4px}.od-ScrubBar-content{overflow:hidden;position:relative}.od-ScrubBar-bar{height:26px;position:relative;cursor:pointer}.od-ScrubBar-bar:focus{outline:1px solid transparent;box-shadow:0 0 0 1px #767676 inset}.od-ScrubBar-scrubArea{height:100%;position:relative}.od-ScrubBar-thumb{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";height:2px;position:absolute;top:12px;left:0}.od-ScrubBar-thumb::after{content:'';position:absolute;top:-10px;right:-11px;width:18px;height:18px;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-radius:50px;border:2px solid "},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.od-ScrubBar-fill{top:12px;width:100%;height:2px;position:absolute;background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";box-shadow:0 0 1px rgba(255,255,255,.5);overflow:hidden;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}.od-ScrubBar-bar:hover .od-ScrubBar-fill::after{content:'';position:absolute;left:0;top:0;height:2px;right:0;background:rgba(255,255,255,.1)}.od-ScrubBar-buffered{position:absolute;left:0;top:0;height:2px;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}.od-ScrubBar-tooltip{position:absolute;pointer-events:none;min-width:30px;height:25px;line-height:25px;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";top:-22px;box-shadow:0 0 10px -3px;border-radius:1px;padding:0 8px;font-size:12px;text-align:center;transform:translate(-50%,50%);opacity:0}.od-ScrubBar-tooltip--isScrubbing{transition:transform .2s ease-out,opacity .2s linear;transform:translate(-50%,0);opacity:1}.od-ScrubBar-tooltip:before{content:'';position:absolute;width:10px;height:10px;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";bottom:-5px;left:50%;margin-left:-5px;transform:rotate(45deg)}"},{"rawString":".od-VolumeMenu{width:310px;height:56px;position:absolute;top:-56px;border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";opacity:.9}[dir=ltr] .od-VolumeMenu{left:-132px}[dir=rtl] .od-VolumeMenu{right:-132px}.od-VolumeMenu-button{width:40px;height:40px;margin:8px 4px;border:none;vertical-align:top;box-sizing:border-box;font-size:21px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:transparent;cursor:pointer}.od-VolumeMenu-button:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-VolumeMenu-button:active{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-VolumeMenu-volume{display:inline-block;vertical-align:top;line-height:58px;margin:0 8px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";width:26px}.od-VolumeMenu-bar{width:204px;height:30px;margin:13px 8px;display:inline-block;position:relative;cursor:pointer}.od-VolumeMenu-bar:focus{outline:1px solid transparent;box-shadow:0 0 0 1px #767676 inset}.od-VolumeMenu-scrubArea{height:100%;margin-right:10px;position:relative}.od-VolumeMenu-scrubThumb{background-color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":";height:10px;position:absolute;top:10px;left:0;border-radius:5px 0 0 5px;padding-left:5px}.od-VolumeMenu-scrubThumb::after{content:'';position:absolute;top:0;right:-5px;width:10px;height:10px;background-color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-radius:5px}.od-VolumeMenu-scrubFill{top:10px;width:100%;height:10px;position:absolute;background-color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";border-radius:5px;box-shadow:0 0 1px rgba(255,255,255,.5);overflow:hidden;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}.od-VolumeMenu-bar:hover .od-VolumeMenu-scrubFill::after{content:'';position:absolute;left:0;top:0;height:10px;right:0;background:rgba(255,255,255,.1);border-radius:5px}"},{"rawString":".od-VideoPanel{width:600px;height:400px;background:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";position:relative}.od-PlaybackPanel{padding:0 28px;white-space:nowrap;background-color:rgba(255,255,255,.75)}.od-PlaybackPanel-bottom{position:relative;height:50px}.od-PlaybackPanel-timePlayed{float:left;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PlaybackPanel-totalTime{float:right;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";font-size:14px}.od-PlaybackPanel-buttons{position:absolute;left:0;right:0;text-align:center}.od-PlaybackPanel-button{width:40px;height:40px;padding:0;margin:0 4px;border:none;box-sizing:border-box;font-size:21px;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:transparent;cursor:pointer}.od-PlaybackPanel-button:hover{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-PlaybackPanel-button:active{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-PlaybackPanel-volume{display:inline-block;position:relative}.od-PlaybackPanel-volumeMenu{position:absolute;top:0}.od-PlaybackPanel-gear{position:relative;display:inline}.od-PlaybackPanel-gearMenu{position:absolute;bottom:100%;margin-bottom:12px}[dir=ltr] .od-PlaybackPanel-gearMenu{left:50%}[dir=rtl] .od-PlaybackPanel-gearMenu{right:50%}.od-PlaybackPanel .ms-ContextualMenu{position:static}.md .od-PlaybackPanel-time,.sm .od-PlaybackPanel-time{width:40px}"},{"rawString":".od-VideoPlayer--isFullScreen{position:fixed;left:0;top:0;width:100%;height:100%;background:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-VideoPlayer-frame{border:none;height:100%;width:100%}.od-VideoPlayer-canvas,.od-VideoPlayer-status{position:absolute;top:0;left:0;right:0;bottom:0}.od-VideoPlayer-status{background-color:rgba(0,0,0,.8);color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";text-align:center;display:none}.od-VideoPlayer-status .od-VideoPlayer-statusContent .od-ButtonBar-main{float:none}.od-VideoPlayer-statusContent{position:absolute;top:50%;left:50%;right:-50%;transform:translate(-50%,-50%);padding:20px}.od-VideoPlayer--hasStatus .od-VideoPlayer-status{display:block}.od-VideoPlayer-debugText{color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";font-size:11px;padding:20px 0 0 0}.od-VideoPlayer-statusButton{width:100px;height:100px;line-height:100px;vertical-align:middle;padding:0;margin:20px;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-radius:50%;box-sizing:border-box;font-size:75px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";background-color:rgba(0,0,0,.5);cursor:pointer}.od-VideoPlayer-statusButton:before{font-size:42px;display:block}.od-VideoPlayer-statusButton:hover{background-color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-VideoPlayer-statusButton:active{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";border-color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":";color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-VideoPlayer .od-VideoCanvas-video{position:absolute;left:0;top:0;width:100%;height:100%}"},{"rawString":".c-DashMonitor{background:rgba(44,44,44,.7);position:absolute;top:-10px;left:0;right:0;min-height:15px;display:block;opacity:0;color:#aaa}.c-DashMonitor.isVisible{transition:opacity .2s linear,top .25s ease-out;top:0;opacity:1}.c-DashMonitor .key,.c-DashMonitor .streamData{display:none}.c-DashMonitor .isVisible{display:block}.c-DashMonitor .streamMetrics{list-style-type:none;padding:5px 5px 0 5px;margin:0}.c-DashMonitor .streamMetrics li{margin-right:5px;margin-bottom:5px;border:1px solid rgba(255,255,255,.5);background:#313131;overflow:hidden;vertical-align:top;font-size:11px;display:none}.c-DashMonitor .streamMetrics li.hasValue{display:inline-block}.c-DashMonitor .streamTitle{font-size:15px;display:inline-block;width:80px;text-align:right;float:left;margin-right:5px;line-height:30px}.c-DashMonitor .metricTitle{padding:3px 5px;display:inline-block;font-weight:700}.c-DashMonitor .metricValue{display:inline-block;padding:3px 5px;white-space:nowrap;background:#5f5f5f;color:#fff}.c-DashMonitor .row{line-height:15px;height:15px;padding-bottom:1px;position:relative;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1);margin-top:-1px;font-weight:700;font-size:9px;background:#222}.c-DashMonitor .traffic{position:relative}.c-DashMonitor .seekContainer{margin-left:3px}.c-DashMonitor .seekBar{position:absolute;top:0;left:0;width:2px;margin-left:-2px;background:rgba(255,255,255,.7);height:100%}.c-DashMonitor .rowHeader{position:absolute;width:80px;text-align:right}.c-DashMonitor .rowFragments,.c-DashMonitor .seekContainer{position:absolute;top:0;left:85px;right:0;bottom:0}.c-DashMonitor .rowRequest{position:absolute;top:2px;bottom:2px;border-radius:4px;box-shadow:inset -4px 0 7px 0 rgba(0,0,0,.6);min-width:5px}.c-DashMonitor .key{box-shadow:inset 0 8px 15px -10px rgba(0,0,0,.2);font-size:11px;padding:10px}.c-DashMonitor .keyItem{display:inline-block;margin-right:10px}.c-DashMonitor .keyBox{display:inline-block;position:relative;top:-1px;width:10px;height:10px;margin:0 5px;border:1px solid #888;vertical-align:middle}.c-DashMonitor .waiting{background:#adadad url(data:image/gif;base64,R0lGODlhBAAEAIAAANLS0paWliH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBkwAl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBURiaLBZACH5BAQFAAAALAAAAAAEAAQAAAIGBBKXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFDGBosVkAOw==)}.c-DashMonitor .downloading{background:#727272 url(data:image/gif;base64,R0lGODlhBAAEAIAAADZn96m++yH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBgQSl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBQxgaLFZACH5BAQFAAAALAAAAAAEAAQAAAIGTACXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFRGJosFkAOw==)}.c-DashMonitor .downloaded{background:#3747ff}.c-DashMonitor .appending{background:#85b98f}.c-DashMonitor .appended{background:#00bd24}.c-DashMonitor .error{background:#df4242}"},{"rawString":".od-VideoCanvas object,.od_videoCanvas video{position:absolute;left:0;top:0;width:100%;height:100%}"},{"rawString":".od-OneUpVideo-thumbnail--framed{display:block;width:200px;height:200px;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";z-index:0;box-shadow:0 2px 6px 2px rgba(1,1,0,.05);position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.od-OneUpVideo-thumbnail--framed:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.od-OneUpVideo-watermark{display:block;width:108px;height:108px;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}"}]);});