define("odsp-next/pages/photos/odc/Photos",["require","exports","./Photos.html","./PhotosViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCPhotos_css","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/list/AllPhotosList","../../../controls/list/AlbumsList","../../../controls/list/SingleAlbumList","../../../controls/list/TagsList","../../../controls/list/TagGrid"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-photos",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/pages/photos/odc/Photos.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko if:shouldShowPromotedPhotos--\x3e<div class="od-photos-promotedWrapper" data-bind="css:{\'od-photos-promotedWrapper--loaded\':haveDeferredControlsLoaded}">\x3c!--ko if:haveDeferredControlsLoaded--\x3e<div class="od-photos-promoted" data-bind="component:{name:\'od-promoted-photos\',params:promotedPhotosParams}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isBannerApplicable--\x3e<div class="od-photos-smartBanner" data-bind="component:{name:smartBannerTagName,params:{isVisible:isSmartBannerVisible}}"></div>\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:commandBarTransclusionContentParams}--\x3e<div data-bind="control:commandBarSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isOneUp--\x3e\x3c!--ko component:{name:oneUpOverlayTagName,params:{}}--\x3e\x3c!--ko control:oneUpSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/pages/photos/odc/PhotosViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./PhotosCommandSet","../../baseInnerPage/od/DataManagerPageViewModel","../../../bindings/clientRect/ClientRectBinding","../../../bindings/component/ControlBinding","../../../bindings/contextMenu/ContextMenuHelper","../../../bindings/element/ElementBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../controls/itemContent/album/AlbumItemContent.key","../../../controls/itemContent/albums/AlbumsContent.key","../../../controls/itemContent/albumsRoot/AlbumsRootItemContent.key","../../../controls/itemContent/folder/FolderItemContent","../../../controls/itemContent/onThisDay/OnThisDayItemContent.key","../../../controls/itemContent/photosRoot/PhotosRootItemContent","../../../controls/itemContent/tagsRoot/TagsRootItemContent.key","../../../controls/list/allphoto2/components/places/ItemsScopePlaces.key","../../../controls/list/allphoto2/components/albums/ItemsScopeAlbums.key","../../../utilities/browser/WebViewDetector","../../../controls/detailsPaneTransclusionContent/DetailsPaneTransclusionContent","../../../controls/list/allphoto2/PhotosItemsScopeItemContent.key","../../../controls/list/allphoto2/components/tagsGallery/ItemsScopeTagsGallery.key","../../../controls/itemsScope/CommandBar.key","../../../controls/list/layouts/LayoutType","../../../controls/overlays/oneUp/OneUpOverlay","../../../controls/smartBannerV2/SmartBannerV2","../../../controls/transclusion/content/TransclusionContent","../../../controls/commandBar/CommandBar.key","../../../dataSources/album/odc/AlbumDataSource","../../../dataSources/promotedPhotos/odc/PromotedPhotosDataSource","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../models/item/ItemHelper","../../../providers/dataManager/files/FilesDataManager","../../../providers/dataManager/mapper/AlbumsDataManagerMapper","../../../providers/dataManager/photos/PhotosDataManager","../../../providers/itemHistory/ItemHistoryProvider","../../../providers/promotedPhotos/PromotedPhotosProvider","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../../utilities/features/Features","../../../models/itemsScope/ItemsScopeFeature.key","../../../dataSources/url/odc/UrlHelpers","../../../dataSources/layout/ContentType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var K;(function(e){e[e.none=0]="none";e[e.allPhotos=1]="allPhotos";e[e.albums=2]="albums";e[e.autoAlbums=3]="autoAlbums";e[e.tags=4]="tags";e[e.places=5]="places";e[e.singleAlbum=6]="singleAlbum";e[e.singleTag=7]="singleTag";e[e.singlePlace=8]="singlePlace";e[e.search=9]="search";e[e.onThisDay=10]="onThisDay"})(K||(K={}));var Q=(function(t){n.__extends(o,t);function o(n){var s=t.call(this,n)||this;s.oneUpOverlayTagName=k.default.tagName;s.transclusionContentTagName=A.default.tagName;s.smartBannerTagName=L.default.tagName;s._isOneDriveWinApp=E.isOneDriveWinApp();s.addBindingHandlers({clientRect:u.default,element:l.default,scrollContainer:c.default,control:a.default});s._canMarqueeSelect=s.resources.consume(R.canUserSelect);var o=s.resources.consume(W.bundleLoader);s.haveDeferredControlsLoaded=o.getBundleInfo(1).isLoaded;o.queueBundle(1,function(){return r.default.resolve(new Promise(function(t,n){e(["../../../controls/promotedPhotos/PromotedPhotos"],t,n)}))});s.resources.expose(U.promotedPhotos,new(s.managed(_.default)));s.resources.expose(W.promotedPhotos,new(s.managed(q.default)));s.platform=s.resources.consume(i.platformDetection);s.resources.expose(W.itemHistory,new(s.managed(I.default)));s.detailsPaneSpecification=a.toSpecification(S.resourceKey,{});s.photoType=s.createPureComputed(s._computePhotoType,{deferEvaluation:!0});s._activePivot=s.createPureComputed(s._computeActivePivot,{deferEvaluation:!0});s.createComputed(function(){var e=s.layoutType();s.isSuiteNavHamburgerVisible();var t=s.responsiveUI;s.isTopBarHamburgerVisible((!s._isOneDriveWinApp||X.isFeatureEnabled(X.UseLeftNavInODApp))&&e!==C.SingleAlbum&&t.compareSize(t.formFactorSize(),"Large")>0)});X.isFeatureEnabled(X.UseLeftNavInODApp)||s.hideLeftNav(!0);s.createBackgroundComputed(s._computeUpdateCanMarqueeSelect).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});s._photoPage=s.observables.pureCompute(s._computePhotoPage);s.shouldShowPromotedPhotos=s.createPureComputed(s._computeShouldShowPromotedPhotos);s.commandBarSpecification=s.createPureComputed(s._computeCommandBarSpecification);s.promotedPhotosParams={};s.createComputed(s._computeIsSuiteNavHidden);s.createComputed(s._computeIsSearchHidden);s._photosItemsScopeItemProps=s.createPureComputed(s._computePhotosItemsScopeProps);s._placesItemsScopeItemProps=s.createPureComputed(function(){return{props:{}}});s._albumsItemsScopeItemProps=s.createPureComputed(function(){return{props:{child:function(e){return s.child(e)}}}});s._isItemsScopeInAllPhotosEnabled=s.resources.consume(V.isItemsScopeEnabledInAllPhotosPivotResourceKey);s._isItemsScopeInAllTagsEnabled=s.resources.consume(V.isItemsScopeEnabledInAllTagsPivotResourceKey);s._isItemsScopeInAllPlacesEnabled=s.resources.consume(V.isItemsScopeEnabledInAllPlacesPivotResourceKey);s._isItemsScopeInAllAlbumsEnabled=s.resources.consume(V.isItemsScopeEnabledInAllAlbumsPivotResourceKey);s._isItemsScopeInSingleAlbumEnabled=s.resources.consume(V.isItemsScopeEnabledInSingleAlbumViewResourceKey);s._isItemsScopeInSingleTagEnabled=s.resources.consume(V.isItemsScopeEnabledInSingleTagViewResourceKey);s._isItemsScopeInSinglePlaceEnabled=s.resources.consume(V.isItemsScopeEnabledInSinglePlaceViewResourceKey);s._isItemsScopeOnThisDayEnabled=s._isItemsScopeInAllPhotosEnabled&&X.isFeatureEnabled(X.UseItemsScopeInOnThisDay);X.isFeatureEnabled(X.UseItemsScopeInAllPhotosEnableGrid)||s.observables.backgroundCompute(function(){s.layoutType()===C.Grid&&s.layoutType(C.AllPhotos)});s.isOneUpForPhotosOnly(!0);return s}o.prototype.dispose=function(){t.prototype.dispose.call(this);this.isTopBarHamburgerVisible(!1);this.hideLeftNav(!1);this.isSearchHidden(!1);this.isSuiteNavHidden(!1);this.isCommandBarDarkTheme(!1);this.isOneUpForPhotosOnly(!1)};o.prototype.computeCurrentPageName=function(){var e=this._photoPage&&this._photoPage(),t=K[e||K.none];return"Photos-"+(""+t.substring(0,1).toUpperCase()+t.substring(1))};o.prototype.computeContentControl=function(){var e=t.prototype.computeContentControl.call(this);if(e)return e;var n=this.getContentControlParams();switch(this._photoPage()){case K.allPhotos:return this._isItemsScopeInAllPhotosEnabled?a.toSpecification(x.resourceKey,this._photosItemsScopeItemProps()):a.toSpecification(g.resourceKey,n);case K.singleTag:return this._isItemsScopeInSingleTagEnabled?a.toSpecification(x.resourceKey,this._photosItemsScopeItemProps()):a.toSpecification(g.resourceKey,n);case K.singlePlace:return this._isItemsScopeInSinglePlaceEnabled?a.toSpecification(x.resourceKey,this._photosItemsScopeItemProps()):a.toSpecification(g.resourceKey,n);case K.search:return a.toSpecification(v.resourceKey,n);case K.tags:return this._isItemsScopeInAllTagsEnabled?a.toSpecification(T.resourceKey,{props:{}}):a.toSpecification(y.resourceKey,n);case K.places:return this._isItemsScopeInAllPlacesEnabled?a.toSpecification(b.resourceKey,this._placesItemsScopeItemProps()):a.toSpecification(y.resourceKey,n);case K.albums:return this._isItemsScopeInAllAlbumsEnabled?a.toSpecification(w.resourceKey,this._albumsItemsScopeItemProps()):X.isFeatureEnabled(X.EnableEvokeAlignments)?a.toSpecification(p.resourceKey,n):a.toSpecification(d.resourceKey,n);case K.singleAlbum:return this._isItemsScopeInSingleAlbumEnabled?a.toSpecification(x.resourceKey,this._photosItemsScopeItemProps()):a.toSpecification(h.resourceKey,n);case K.onThisDay:return this._isItemsScopeOnThisDayEnabled?a.toSpecification(x.resourceKey,this._photosItemsScopeItemProps()):a.toSpecification(m.resourceKey,n)}};o.prototype.computeCreateDataManager=function(){var e,t=this.viewParams(),n=this.urlDataSource.getQueryType(t);if("photos"!==t.v)return null;switch(n){case P.default.Search:e=this._createFilesDataManager;break;default:e=this._createPhotosDataManager}return e};o.prototype.computeDataManagerMapper=function(){var e=this._photoPage(),n=this.viewParams(),r=this.dataManager();return X.isFeatureEnabled(X.EnableEvokeAlignments)&&e===K.albums&&n.tagFilter!==M.NEW_ALBUM_TAG?new(this.managed(j.default))({itemSet:this.unmappedItemSet,requiredRange:r.requiredRange}):t.prototype.computeDataManagerMapper.call(this)};o.prototype._computeIsSuiteNavHidden=function(){var e=this._photoPage();this.isSuiteNavHidden(e===K.singleAlbum&&!X.isFeatureEnabled(X.UseItemsScopeInSingleAlbum)||this._isOneDriveWinApp)};o.prototype._computeIsSearchHidden=function(){var e=this._photoPage();this.isSearchHidden(e===K.singleAlbum||this._isOneDriveWinApp)};o.prototype._createPhotosDataManager=function(){return new(this.managed(F.default))({requiredPageType:D.default.Photos})};o.prototype._createFilesDataManager=function(){return new(this.managed(B.default))({requiredPageType:D.default.Photos})};o.prototype._computePhotoType=function(){var e=this.viewParams();return this.urlDataSource.getPhotoType(e)};o.prototype._computeUpdateCanMarqueeSelect=function(){var e;switch(this.photoType()){case 2:case 3:e=!1;break;default:e=!0}this._canMarqueeSelect(e)};o.prototype._computeActivePivot=function(){var e=this.photoType();return 1===e||5===e?1:2===e||6===e?2:3===e||7===e?3:0===e?0:null};o.prototype._computeShouldShowPromotedPhotos=function(){return!this._isItemsScopeInAllPhotosEnabled&&X.isFeatureEnabled(X.PromotedPhotosContentEnabled)&&this._photoPage()===K.allPhotos};o.prototype._computePhotoPage=function(){var e=this.item(),t=this.viewParams(),n=this.urlDataSource.getKeyParams(e.key);return"search"===n.qt?K.search:"allmyphotos"===n.qt?n.tagFilter?K.singleTag:n.locationFilter?K.singlePlace:n.onThisDay?K.onThisDay:K.allPhotos:"tags"===n.id?K.tags:"places"===n.id?K.places:$.isAlbums(t)?K.albums:$.isSingleAlbum(t)?K.singleAlbum:K.none};o.prototype._computePhotosItemsScopeProps=function(){var e=this;this.layoutType();var t=this.viewParams(),n=this.urlDataSource.getLayoutContentType(t),r=this.dataManager.peek().getContextualQueryType(P.default.AllMyPhotos),i=(n||r)===J.GRID?C.Grid:C.AllPhotos,s=this.urlDataSource.getPhotoType(t);$.isAllMyPhotos(t)||i!==C.Grid||(i=C.AllPhotos);var o,u={layoutType:i,isMobile:this.platform.isMobile,child:function(t){return e.child(t)},photoType:s,isInFilePicker:!1};if(H.isAutoAlbum(this.item())){o={saveAutoAlbumAction:new(this.managed(this.actionMap.SaveAutoAlbumAction))({item:this.item}),discardAutoAlbumAction:new(this.managed(this.actionMap.DiscardAutoAlbumAction))({item:this.item})};u.footerProps=o}var a=this._photosItemsScopeItemProps.peek();return a&&a.props.layoutType===u.layoutType&&a.props.isMobile===u.isMobile&&a.props.photoType===u.photoType&&a.props.footerProps===o?a:{props:u}};o.prototype._computeCommandBarSpecification=function(){if(this._isItemsScopeInAllAlbumsEnabled&&this._photoPage()===K.albums){this.contextMenuHelper(null);return a.toSpecification(N.resourceKey,{props:{handleRenderComplete:function(e,t){t.unblockItemPageRender()}}})}var e={currentView:this._activePivot,photoType:this.photoType},t=new(this.managed(s.default))(e);this.resources.expose(z.listViewContextMenuHelper,new(this.managed(f.default))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));this.contextMenuHelper(new(this.managed(f.default))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"od-Photos",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));return a.toSpecification(O.resourceKey,{commandSet:t})};return o})(o.default);t.default=Q});
define("odsp-next/pages/photos/odc/PhotosCommandSet",["require","exports","tslib","knockout","../../../controls/commands/Command","../../../dataSources/url/odc/UrlHelpers","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/commands/SeparatorCommandSet","../../../controls/detailsPane/DetailsPaneId","../../../controls/detailsPane/IsDetailsPaneExpanded","../../../utilities/features/Features","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys","../../../resources/ODCResourceKeys","../../../controls/sharing/share/odc/Share.key","../../../dataSources/url/SearchTypeChecker","../../../utilities/icons/Icon","../../../controls/commands/Commands.resx","../../../controls/commands/PLTCommands.resx","../../../controls/photos/Photos.resx","../../../controls/operation/commands/OperationCommandBuilder","../../../controls/addToAlbum/AddToAlbum.resx","../../../controls/sharing/share/odc/CommandBuilder","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","../../../dataSources/base/vroom/VroomDataRequestor","../../files/FilesCommandSetHelper","../../../controls/list/layouts/LayoutType","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources;n._viewParams=r.consume(c.viewParams);n._urlDataSource=r.consume(p.urlDataSource);n._currentView=t.currentView;n._photoType=t.photoType;n._photoProvider=r.consume(h.photo);n._arePivotsHidden=n.createComputed(n._computeArePivotsHidden);n._hasSamsungSpecialFolder=n.observables.create(void 0);n.hideNewShareCommands=n.createPureComputed(n._computeHideNewShareCommands);n.hideOldShareCommand=n.createPureComputed(n._computeHideOldShareCommand);n._requestor=r.consume(T.resourceKey);n._isOneDriveXboxApp=k.isOneDriveXboxApp();n.filesCommandSetHelper=new(n.managed(N.default))({showLabels:n.responsiveUI.showLabels});n._buildCommands();l.isFeatureEnabled(l.SamsungGalleryFilter)&&n._checkSamsungFolderExists();return n}t.prototype._checkSamsungFolderExists=function(){var e=this;this.observables.backgroundCompute(function(){var t=e._viewParams(),n=e._urlDataSource.getPhotoType(t),r=e._hasSamsungSpecialFolder.peek();0===n&&void 0===r&&e._requestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){e._hasSamsungSpecialFolder(!0)}).catch(function(t){e._hasSamsungSpecialFolder(!1)})})};t.prototype._buildCommands=function(){var e=this,t=new(this.managed(this.actionMap.SaveAutoAlbumAction))({isHidden:!0}),n=[new(this.managed(i.CommandViewModel))({text:g.default.addToSharedList,renderLabel:2,icon:new m.default("Add"),action:new(this.managed(this.actionMap.AddToSharedListAction))})],u=[new(this.managed(S.default))({renderLabel:2,mode:x.Mode.share,itemsKey:d.shareResourceKey,text:g.default.Share,tooltip:g.default.ShareCommandTooltipV3,icon:new m.default("Share"),keys:["S"],engagementName:"newShareCommand",isHidden:this.hideNewShareCommands}).command,new(this.managed(i.CommandViewModel))({text:g.default.Share,isHidden:this.hideOldShareCommand,tooltip:g.default.ShareCommandTooltipV3,renderLabel:2,icon:new m.default("Share"),keys:["S"],action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.ShareByLinkAction)),saveAutoAlbumAction:t})})];n=n.concat(u);var c=[new(this.managed(i.CommandViewModel))({text:g.default.selectItems,renderLabel:2,icon:new m.default("CheckboxComposite"),action:new(this.managed(this.actionMap.ToggleSelectionModeAction)),isHidden:this.createPureComputed(function(){if(!e._isOneDriveXboxApp)return!1;var t=e._viewParams();return s.isAllTags(t)||s.isAllPlaces(t)})}),new(this.managed(i.CommandViewModel))({text:E.default.newAlbumPlaceholder,renderLabel:2,icon:new m.default("Add"),action:new(this.managed(this.actionMap.CreateAlbumAction)),isHidden:this.createObservable(l.isFeatureEnabled(l.EnableEvokeAlignments))}),new(this.managed(i.CommandViewModel))({text:g.default.AddToAlbum,renderLabel:2,icon:new m.default("Photo2Add"),action:new(this.managed(this.actionMap.AddToAlbumAction))}),new(this.managed(i.CommandViewModel))({text:g.default.addToBundle,icon:new m.default("Add"),renderLabel:2,action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.AddPhotosToAlbumAction)),saveAutoAlbumAction:t})}),new(this.managed(i.CommandViewModel))({text:g.default.editTags,renderLabel:2,icon:new m.default("Tag"),keys:["T"],action:l.isFeatureEnabled(l.EnableNewDetailsPane)?new(this.managed(this.actionMap.ShowTagsEditorAction)):new(this.managed(this.actionMap.EditTagsAction))}),new(this.managed(i.CommandViewModel))({text:g.default.Download,renderLabel:2,icon:new m.default("Download"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.DownloadAction)),saveAutoAlbumAction:t})}),new(this.managed(i.CommandViewModel))({text:g.default.setCoverPhotoTitle,renderLabel:2,icon:new m.default("Picture"),action:new(this.managed(this.actionMap.SetAlbumCoverPhotoAction))}),new(this.managed(i.CommandViewModel))({text:g.default.rotate,renderLabel:2,icon:new m.default("rotate"),action:new(this.managed(this.actionMap.RotateAction))({})}),new(this.managed(i.CommandViewModel))({text:g.default.DeleteItem,renderLabel:2,icon:new m.default("Delete"),action:new(this.managed(this.actionMap.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(i.CommandViewModel))({text:g.default.Remove,renderLabel:2,icon:new m.default("Cancel"),action:new(this.managed(this.actionMap.RemoveFromAlbumAction))}),new(this.managed(i.CommandViewModel))({text:g.default.Remove,renderLabel:2,icon:new m.default("Cancel"),action:new(this.managed(this.actionMap.RemoveTagFromItemAction))}),new(this.managed(i.CommandViewModel))({text:g.default.OrderPrints,icon:new m.default("Print"),renderLabel:2,action:new(this.managed(this.actionMap.OrderPrintsAction))}),new(this.managed(i.CommandViewModel))({text:g.default.viewInFolder,icon:new m.default("Folder"),action:new(this.managed(this.actionMap.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),new(this.managed(i.CommandViewModel))({text:g.default.Rename,renderLabel:2,icon:new m.default("Edit"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.RenameAction)),saveAutoAlbumAction:t}),keys:["F2"],automationId:"rename"}),new(this.managed(i.CommandViewModel))({text:g.default.Embed,icon:new m.default("Embed"),renderLabel:2,hasLineBreakAfter:!0,automationId:"embed",action:new(this.managed(this.actionMap.EmbedAction))}),new(this.managed(i.CommandViewModel))({text:g.default.saveAutoAlbum,icon:new m.default("Add"),renderLabel:2,action:new(this.managed(this.actionMap.SaveAutoAlbumAction))}),new(this.managed(i.CommandViewModel))({text:g.default.discardAutoAlbum,icon:new m.default("Delete"),renderLabel:2,action:new(this.managed(this.actionMap.DiscardAutoAlbumAction))}),this.overflowHostCommand,new(this.managed(w.default))({renderLabel:2}).command],h=this.createPureComputed(function(){var t=e.selection&&e.selection.selection().length||0;return e.responsiveUI.showLabels()?o.format(g.default.NumberSelected,t):t.toString()}),p=new(this.managed(i.CommandViewModel))({text:h,tooltip:g.default.showSelection,isHidden:this.selectionModeOff,icon:new m.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}),b=this.createPureComputed(function(){var t=e._photoType(),n=e.selectionModeOn();return 5!==t||n}),T=new(this.managed(i.CommandViewModel))({icon:new m.default("Cancel"),hasIconOnly:!0,isHidden:b,isDisabled:b,action:new(this.managed(this.actionMap.NavigationAction))({ignoreHistory:!1,url:this._urlDataSource.getAlbumsQueryUrl()}),keys:["AltUp"],location:4,text:g.default.Close,renderLabel:0}),k=new(this.managed(i.CommandViewModel))({text:g.default.setRootPhotosIdTitle,icon:new m.default("Settings"),renderLabel:2,requiredChildren:2,location:4,isHidden:this.createPureComputed(function(){var t=e.selectionModeOn();return v.isSearchType(e._urlDataSource.getQueryType(e._viewParams()))||t}),children:r.observableArray([new(this.managed(i.CommandViewModel))({text:g.default.setRootPhotosValueAll,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ROOT"}),isToggleable:!0}),new(this.managed(i.CommandViewModel))({text:g.default.setRootPhotosValuePhotos,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ALLPHOTOSFOLDER"}),isToggleable:!0}),new(this.managed(i.CommandViewModel))({text:g.default.setRootPhotosValueSamsungGallery,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"SAMSUNGFOLDER"}),isToggleable:!0,isHidden:this.observables.pureCompute(function(){return!e._hasSamsungSpecialFolder()})})])}),L=new(this.managed(i.CommandViewModel))({text:g.default.ViewGrid,tooltip:g.default.ViewGridCommandTooltip,icon:new m.default(N.default.gridIcon),isToggleable:!0,isHidden:this.createComputed(function(){return e.selectionModeOn()||!l.isFeatureEnabled(l.UseItemsScopeInAllPhotosEnableGrid)}),action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:C.Grid}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),A=new(this.managed(i.CommandViewModel))({text:g.default.ViewPhoto,tooltip:g.default.ViewPhotoCommandTooltip,icon:new m.default(N.default.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:C.AllPhotos}),automationId:"switchLayout",location:4}),O=new(this.managed(i.CommandViewModel))({renderLabel:0,icon:this.createComputed(function(){return e.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:r.observableArray([L,A]),automationId:"switchLayoutSwitcher",text:g.default.Views,tooltip:g.default.ViewsCommandTooltip}),M=this.resources,_=M.consume(a.resourceKey),D=M.consume(f.resourceKey),P=[p,k,O,T,new(this.managed(i.CommandViewModel))({text:g.default.Details,tooltip:y.default.DetailsPane,icon:new m.default("Info"),location:12,hasIconOnly:!0,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:_,ariaExpanded:D,renderLabel:0,keys:["I"],automationId:"showProperties"})],H=[n=this._makePivots(1).concat(n),c,P].map(function(t){return e.createObservable(t)});this.commandSets(H)};t.prototype._computeArePivotsHidden=function(){var e=this._photoType(),t=this.selectionModeOn();return 5===e||t};t.prototype._makePivots=function(e){var t=this._photoProvider.getAllPhotosSettings()(),n=[];n.push(new(this.managed(i.CommandViewModel))({text:b.default.allPhotosNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(0),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAllMyPhotosQueryUrl(t.rootId)}),location:3}));n.push(new(this.managed(i.CommandViewModel))({text:b.default.albumsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(1),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAlbumsQueryUrl()}),location:3}));l.isFeatureEnabled(l.EnableTagsInODC)&&n.push(new(this.managed(i.CommandViewModel))({text:b.default.tagsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(2),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getTagsQueryUrl()}),automationId:"showTags",location:3}));n.push(new(this.managed(i.CommandViewModel))({text:b.default.placesNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(3),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getPlacesQueryUrl()}),location:3}));n[n.length-1].isLastPivot=!0;return n};t.prototype._createComputedIsCurrentViewAndNotSearch=function(e){var t=this;return this.createPureComputed(function(){return t._isCurrentViewAndNotSearch(e)})};t.prototype._isCurrentViewAndNotSearch=function(e){var t=v.isSearchType(this._urlDataSource.getQueryType(this._viewParams()));return this._currentView()===e&&!t};t.prototype._computeHideNewShareCommands=function(){return!l.isFeatureEnabled(l.UseNewShareDialog)||k.isOneDriveWinApp()&&!l.isFeatureEnabled(l.UseNewShareDialogForWinApp)};t.prototype._computeHideOldShareCommand=function(){return l.isFeatureEnabled(l.UseNewShareDialog)&&(!k.isOneDriveWinApp()||l.isFeatureEnabled(l.UseNewShareDialogForWinApp))};return t})(u.default);t.default=L});
define("odsp-next/controls/itemContent/album/AlbumItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/albums/AlbumsContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumsContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/albumsRoot/AlbumsRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumsRootItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/onThisDay/OnThisDayItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OnThisDayItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent",["require","exports","./PhotosRootItemContent.html","./PhotosRootItemContentViewModel","../../../bindings/component/ControlBinding","ODCPhotos_css","../../list/AllPhotosList","../../emptyFolder/EmptyFolder","../../breadcrumbBar/BreadcrumbBar","../../scrollBarTooltip/ScrollBarTooltip"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-photos-root-item-content",template:n.default,viewModelType:r.default})});
define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContent.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-PhotosRootItemContent od-ItemContent" data-bind="css:{\'od-PhotosRootItemContent--hasGroupings\':hasGroupings}">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-PhotosRootItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<div class="od-PhotosRootItemContent-title od-ItemContent-title" data-bind="text:title"></div>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-PhotosRootItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item,getCrumbs:$component.getCrumbs.bind($component)}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-PhotosRootItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:layoutParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-PhotosRootItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e\x3c!--ko component:{name:scrollBarTooltipTagName,params:scrollBarTooltipParams}--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/itemContent/photosRoot/PhotosRootItemContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../emptyFolder/EmptyFolder","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","../../../resources/ProviderResourceKeys","../../scrollBarTooltip/ScrollBarTooltip","@ms/odsp-utilities/lib/object/ObjectUtil","../../../bindings/component/ControlBinding","../../breadcrumbBar/BreadcrumbBar","../../../models/itemSet/ItemSetMonitor","../../../models/item/OneDriveItem","../../../models/item/ItemType","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/tag/TagType","../../../utilities/tag/GroupPacker","../../list/layouts/LayoutType","../../../actions/toggleListLayout/ToggleListLayoutHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:l.default});r.breadcrumbBarTagName=c.default.tagName;r.emptyFolderControl=l.toSpecification(i.resourceKey,{});r.scrollBarTooltipTagName=a.default.tagName;r._itemSetMonitor=r.resources.consume(h.resourceKey);r.itemSet=r._itemSetMonitor.itemSet;r.itemSetSelectionModel=r.resources.consume(s.itemsSelection);r.contentRange=r.resources.consume(o.contentRange);r._photoProvider=r.resources.consume(u.photo);r.resources.expose(o.files.layoutType,r.createObservable(y.AllPhotos));r.layoutType=r.resources.consume(b.resolvedLayoutTypeResourceKey);r._dataManagerMapper=r.resources.consume(s.currentDataManagerMapper);r.listViewContextMenuHelper=r.resources.consume(o.listViewContextMenuHelper.optional);r.visibleItemRange=r.createObservable();r.visibleItemRange.equalityComparer=f.deepCompare;r._crumbs=r.createPureComputed(r._computeCrumbs);r.title=r.createPureComputed(function(){return r._getTagFilterString(r._itemSetMonitor.itemSet(),r._itemSetMonitor.name())});r.item=r._itemSetMonitor.item;r.showList=r.createPureComputed(function(){return!!r.layoutType()&&r._itemSetMonitor.hasItems()});r.showEmpty=r._itemSetMonitor.isEmpty;r.showBreadcrumb=r.createPureComputed(r._computeShowBreadcrumb);r.showTitle=r.createPureComputed(r._computeShowTitle);r.hasGroupings=r.createPureComputed(r._computeHasGroupings);r.scrollBarTooltipParams={listRange:r.contentRange,label:r.createPureComputed(r._computeScrollBarTooltipLabel)};r.layoutParams={itemSet:r.itemSet,selectionModel:r.itemSetSelectionModel,requiredRange:r.contentRange,visibleItemRange:r.visibleItemRange,enableMarqueeSelection:!0,contextMenuHelper:r.listViewContextMenuHelper,mode:0};return r}t.prototype.getCrumbs=function(e){function t(e,t){var n=new p.default(t);n.id=e;n.isDropEnabled=!1;n.isPlaceholder=!0;n.properties={};n.type=d.default.Folder;n.tagInfo={tagType:m.default.allPlaces};return n}var n=v.deserializeQuery(e.key);if(!n.locationFilter)return[];var r=n.locationFilter.split(g.ALLPLACES_GEOLOCATION_DELIMITER);delete n.locationFilter;for(var i=v.serializeQuery(n),s=!1,o=[];r.length>0;){var u=s,a=!s,f=r.join(g.ALLPLACES_GEOLOCATION_DELIMITER),l=i+"&locationFilter="+r.join(g.ALLPLACES_GEOLOCATION_HARDCODED),c=r.pop();if(0!==c.length){var h=t(f,l);o.push({key:h.key,url:"#"+h.key,name:c,showNextChevron:s,isDroppingTarget:this.createObservable(!1),item:h,isOverflow:!1,isNavItem:u,isStaticItem:a});s=!0}}return o};t.prototype._computeScrollBarTooltipLabel=function(){var e=this.visibleItemRange();if(e){var t=this._itemSetMonitor.itemSet(),n=Math.floor((e.end-e.start)/2)+e.start,r=this._dataManagerMapper().getOriginalItemIndexByMappedIndex(n),i=this._photoProvider.findMonthGroupingByIndex(t.key,r);return i&&i.name||""}return""};t.prototype._computeShowTitle=function(){var e=this._itemSetMonitor.item();return this._itemSetMonitor.hasName()&&!e.isRootFolder&&!this._crumbs().length};t.prototype._computeShowBreadcrumb=function(){return!!this._crumbs().length};t.prototype._computeCrumbs=function(){return this.getCrumbs(this._itemSetMonitor.item())};t.prototype._computeHasGroupings=function(){return!!(this._itemSetMonitor.itemSet().content().groupings||[]).length};t.prototype._getTagFilterString=function(e,t){var n=e.context;return n&&n.tagFilter?"#"+n.tagFilter:t};return t})(r.default);t.default=w});
define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltip",["require","exports","./ScrollBarTooltip.html","./ScrollBarTooltipViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"od-scroll-bar-tooltip",template:n.default,viewModel:r.default,synchronous:!0});t.default=s});
define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltip.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='\x3c!--ko scrollBarPosition:{containerClientRect:scrollContainerClientRect,position:scrollPosition,container:scrollContainer}--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!scrollContainerClientRect()&&!!scrollContainer()&&isVisible()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:true,parentElement:scrollContainer(),animation:{afterAdd:1,beforeRemove:267}}}--\x3e<div class="od-ScrollBarTooltip" data-bind="style:{top:top,left:left,right:right},drag:{isDragging:isDragging,mousePoint:mousePoint}"><span class="od-ScrollBarTooltip-displayText ms-font-m" data-bind="text:displayText"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/scrollBarTooltip/ScrollBarTooltipViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/css/VisibilityBinding","../../bindings/scrollBarPosition/ScrollBarPositionBinding","../overlays/Overlay","@ms/odsp-utilities/lib/locale/Locale","../../utilities/browser/ResponsiveUI","../../bindings/drag/DragBinding","@ms/odsp-utilities/lib/math/Point","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({scrollBarPosition:o.default,visibility:s.default,drag:l.default});n._platformDetection=n.resources.consume(p.platformDetection);n._scrollBarWidth=f.default.getScrollbarWidth();n.overlayTagName=u.default.tagName;n.scrollContainerClientRect=r.observable();n.scrollContainerClientRect.equalityComparer=h.deepCompare;n.scrollPosition=r.observable();n.scrollPosition.equalityComparer=h.deepCompare;n.scrollContainer=r.observable();var i=t.label,a=void 0===i?r.observable(""):i,d=t.isDragging,v=void 0===d?r.observable(!1):d;n._label=a;n.isDragging=v;n.mousePoint=r.observable(new c.default(0,0));n.isIdle=r.observable(!0);n.left=n.createComputed(n._computeLeft);n.right=n.createComputed(n._computeRight);n.top=n.createComputed(n._computeTop);n.displayText=n.createComputed(n._computeDisplayText);n.isVisible=n.createPureComputed(n._computeIsVisible);n.createComputed(n._computeUpdateScrollPositionOnDrag);n.createComputed(n._computeSuspendIdleOnScrollPosition);n.createComputed(n._computeGoIdle).extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}});return n}t.prototype._computeLeft=function(){return a.default.isRightToLeft?this._computeMarginOffset():null};t.prototype._computeRight=function(){return a.default.isRightToLeft?null:this._computeMarginOffset()};t.prototype._computeMarginOffset=function(){var e=0;this._platformDetection.isMac&&(e=f.default.MAC_SCROLL_BAR_WIDTH);return this._scrollBarWidth+4+e+"px"};t.prototype._computeDisplayText=function(){var e=this._label();return e||""};t.prototype._computeTop=function(){var e=this.scrollPosition(),t=this.scrollContainerClientRect();if(!e||!t)return"0";var n=t.height-40;return e.y*n+"px"};t.prototype._computeUpdateScrollPositionOnDrag=function(){if(this.isDragging()){var e=this.mousePoint(),t=this.scrollContainerClientRect(),n=e.y-t.top,r=t.height-40,i=new c.default(0,Math.max(0,Math.min(1,n/r)));this.scrollPosition(i)}};t.prototype._computeIsVisible=function(){return!!this._label()&&(!this.isIdle()||this.isDragging())};t.prototype._computeSuspendIdleOnScrollPosition=function(){this.scrollPosition();this.isIdle(!1)};t.prototype._computeGoIdle=function(){this.scrollPosition();this.isIdle()||this.isDragging()||this.isIdle(!0)};return t})(i.default);t.default=d});
define("odsp-next/bindings/scrollBarPosition/ScrollBarPositionBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout","../scrollContainer/ScrollContainerBinding","@ms/odsp-utilities/lib/math/Point","../clientRect/ClientRectBinding","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._container=s.getScrollContainer(n.element);var r=n.valueAccessor();n._position=i.observable();n._isUpdatingScrollPosition=!1;n.events.on(n._container,"scroll",n._updateScrollPosition);n.events.on(window,"resize",n._updateScrollPosition);n._updateScrollPosition();n._containerClientRect=i.observable();n._containerClientRect.equalityComparer=a.deepCompare;new(n.managed(u.default))({element:n._container,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{size:n._containerClientRect,includePosition:!0}}});if(r.position){n.createComputed(function(){return r.position(n._position())});n.subscribe(r.position,n._position)}r.containerClientRect&&n.createComputed(function(){return r.containerClientRect(n._containerClientRect())});r.container&&r.container(n._container);n.subscribe(n._position,n._onScrollPositionChanged);return n}t.prototype._updateScrollPosition=function(){var e=new o.default(this._container.scrollLeft/this._container.scrollWidth,this._container.scrollTop/this._container.scrollHeight);this._isUpdatingScrollPosition=!0;try{this._position(e)}finally{this._isUpdatingScrollPosition=!1}};t.prototype._onScrollPositionChanged=function(e){if(!this._isUpdatingScrollPosition){var t=this._container.scrollWidth,n=this._container.scrollHeight;this._container.scrollLeft=Math.max(0,Math.min(t,e.x*t));this._container.scrollTop=Math.max(0,Math.min(n,e.y*n))}};t.supportsVirtualElements=!0;return t})(r.default);t.default=f});
define("odsp-next/bindings/drag/DragBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/math/Point"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._isDragging=r.isDragging;n._mousePoint=r.mousePoint;n._initEvents();return n}t.prototype._onMouseDown=function(e){this._isDragging(!0)};t.prototype._onMouseUp=function(e){this._isDragging(!1);this._mousePoint(new i.default(e.clientX,e.clientY))};t.prototype._onMouseMove=function(e){this._isDragging.peek()&&this._mousePoint(new i.default(e.clientX,e.clientY))};t.prototype._onTouchStart=function(e){this._isDragging(!0)};t.prototype._onTouchEnd=function(e){this._isDragging(!1);this._mousePoint(new i.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY))};t.prototype._onTouchMove=function(e){if(this._isDragging.peek()){e.preventDefault();this._mousePoint(new i.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY))}};t.prototype._initEvents=function(){var e=document.body,t=this.element;this.events.on(t,"touchstart",this._onTouchStart,!0);this.events.on(t,"touchend",this._onTouchEnd,!0);this.events.on(document,"touchmove",this._onTouchMove,!0);this.events.on(t,"mousedown",this._onMouseDown);this.events.on(t,"mouseup",this._onMouseUp);this.events.on(e,"dragend",this._onMouseUp);this.events.on(e,"mousemove",this._onMouseMove);this.events.on(document,"mouseup",this._onMouseUp)};return t})(r.default);t.default=s});
define("odsp-next/controls/list/AllPhotosList",["require","exports","./List.html","knockout","./viewModels/AllPhotosListViewModel","ODCPhotos_css","../itemTile/ItemTile"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={tagName:"ms-all-photos-list",template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s);t.default=s});
define("odsp-next/controls/list/viewModels/AllPhotosListViewModel",["require","exports","tslib","./ListViewModel","../layouts/AllPhotosLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(i.default))(t));return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/AllPhotosLayout",["require","exports","tslib","./BaseGridLayout","../../allPhotosHeader/AllPhotosHeader","../../allPhotosMonthHeader/AllPhotosMonthHeader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.mode,i=void 0===r?0:r;n._mode=n.wrapObservable(i);return n}t.prototype.getInnerMargin=function(){return 2};t.prototype.getMinRowHeight=function(){switch(this.responsiveHelper.formFactorSize.peek()){case"Small":case"Medium":return 120;default:return 220}};t.prototype.getGroup=function(e){var t=this._itemSet.peek().content.peek(),n=t.groupings||[],r=t.items,i=0===this._mode.peek()?0:2;if(n&&n.length){for(var s=void 0,o=void 0,u=r[e].peek(),a=0,f=n;a<f.length;a++){var l=f[a];if(l.groupType===i){o=(s=l).groups;break}}if(!s||!o.length)return;return s.groupMap[s.itemToGroupMap[u.key]]}};t.prototype.getHeader=function(e,t,n){var r=null;if(t&&t.peek&&t.peek()){var o=this.getGroup(n);if(o&&this.currentGroup!==o){if((!this.currentGroup||this.currentGroup.latestPhotoTime.monthName!==o.latestPhotoTime.monthName||this.currentGroup.latestPhotoTime.year!==o.latestPhotoTime.year)&&1!==this._mode.peek()){var u=new Date(o.latestPhotoTime.isoDate).getFullYear(),a=s.default.tagName,f={resources:this.resources,headerText:o.latestPhotoTime.monthName+" "+u},l=this._shouldInlineHeadersLineBreak()?64:80;r={key:n+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:l,viewType:a,viewData:f,shouldLineBreak:!0,isHeader:!0};this.addToCurrentRow(r,!0)}var c,h,p,d=void 0;this.currentGroup=o;h=i.default.tagName;p={group:o,resources:this.resources,startIndex:n,mode:this._mode.peek()};c=this._shouldInlineHeadersLineBreak();d=40;0!==n||h||(d=0);r={key:n+"_header",cellIndex:this.cells.length,left:0,top:0,width:c?0:124,height:d,viewType:h,viewData:p,shouldLineBreak:c,aspectRatio:c?void 0:.55,isHeader:!0,shouldNotBeLastInRow:!0,isFixedWidth:!c};this.nextGroup=o}}return r};t.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);for(var t=this.getRowRangeForViewport(e),n=t.start,r=t.end,i=0,s=0,o=0;o<r;o++){var u=this.rows[o],a=u.cells.length-u.itemCellCount;o<=n&&(i+=a);o<r&&(s+=a)}if(this._shouldInlineHeadersLineBreak()){i=0;s=0}var f=this.rows[n],l=this.rows[r-1];return{start:n>=0?f.cells[0].cellIndex-i:-1,end:r>=0?l.cells[l.cells.length-1].cellIndex-s:-1}};t.prototype._shouldInlineHeadersLineBreak=function(){var e=this.responsiveHelper;return e.compareSize(e.formFactorSize.peek(),"Medium")<=0};return t})(r.default);t.default=o});
define("odsp-next/controls/allPhotosHeader/AllPhotosHeader",["require","exports","./AllPhotosHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllPhotosHeaderViewModel","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-all-photos-header",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/allPhotosHeader/AllPhotosHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-AllPhotosHeader" tabindex="0"><div class="od-AllPhotosHeader-date"><span class="od-AllPhotosHeader-month" data-bind="text:displayMonth,click:onClickDate"></span>\x3c!--ko if:displayDay--\x3e<span class="od-AllPhotosHeader-day ms-font-xxl" data-bind="text:displayDay,click:onClickDate"></span>\x3c!--/ko--\x3e\x3c!--ko if:displayYear--\x3e<span class="od-AllPhotosHeader-year ms-font-xxl" data-bind="text:displayYear"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:eventName--\x3e<div class="od-AllPhotosHeader-eventName ms-font-l ms-fontColor-neutralPrimary" data-bind="text:eventName"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShareAvailable--\x3e<a href="#" class="od-AllPhotosHeader-share od-Link ms-font-l" data-bind="text:shareText,click:onClickShare"></a>\x3c!--/ko--\x3e\x3c!--ko if:isCheckVisible--\x3e<span class="od-AllPhotosHeader-check" data-bind="click:onClickSelectAll,css:{\'is-selected\':areAllPhotosSelected,\'can-select\':isSelectAllAvailable},component:{name:itemCheckTagName}"></span>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/allPhotosHeader/AllPhotosHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../commands/Commands.resx","../itemCheck/ItemCheck","../../actions/base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.mode,a=void 0===r?0:r;n.itemCheckTagName=o.default.tagName;n._itemSetSelectionModel=n.resources.consume(i.itemsSelection);n._itemCommandHelper=new(n.managed(u.default));n._startIndex=t.startIndex;n._mode=a;n.displayMonth=0===n._mode?t.group.latestPhotoTime.monthName:"";n.displayDay=0===n._mode?t.group.latestPhotoTime.day:"";n.displayDate=0===n._mode?t.group.latestPhotoTime.longDate:"";n.displayYear=1===n._mode?t.group.latestPhotoTime.year:"";n.group=t.group;n.eventName=n.group&&n.group.location||"";n.shareText=s.default.Share;n._range=n.createPureComputed(n._computeRange,{deferEvaluation:!0});n._selectedCount=n.createPureComputed(n._computeSelectedCount,{deferEvaluation:!0});n.areAllPhotosSelected=n.createPureComputed(n._computeAreAllPhotosSelected,{deferEvaluation:!0});n.isSelectAllAvailable=n.createPureComputed(n._computeIsSelectAllAvailable,{deferEvaluation:!0});n.isCheckVisible=n.createPureComputed(n._computeIsCheckVisible,{deferEvaluation:!0});n._isShareSupported=n.createPureComputed(n._computeIsShareSupported,{deferEvaluation:!0});n.isShareAvailable=n.createPureComputed(n._computeIsShareAvailable,{deferEvaluation:!0});var f=n.resources.consume(i.actionMap);n._shareAction=new(n.managed(f.ShareByLinkAction));return n}t.prototype.onClickSelectAll=function(e,t){for(var n=this.areAllPhotosSelected.peek(),r=this._range.peek(),i=r.start;i<r.end;i++)this._itemSetSelectionModel.setIndexSelected(i,!n);t.stopPropagation();t.preventDefault();return!1};t.prototype.onClickShare=function(e,t){this._itemSetSelectionModel.clear();for(var n=this._range.peek(),r=n.start;r<n.end;r++)this._itemSetSelectionModel.setIndexSelected(r,!0);this._shareAction.isAvailable.peek()&&this._shareAction.execute(t);t.stopPropagation();t.preventDefault();return!1};t.prototype.onClickDate=function(e,t){return!1};t.prototype._computeRange=function(){var e,t,n=this._itemSetSelectionModel.itemSet.peek().content.peek().groupings||[],r=0===this._mode?0:2;if(n&&n.length)for(var i=0,s=n;i<s.length;i++){var o=s[i];if(o.groupType===r){t=o.groups;break}}if(t)for(var u=0,a=t;u<a.length;u++){var f=a[u];if(f.startIndex===this._startIndex){e=f;break}}return e&&e.keys?{start:e.startIndex,end:e.keys.length+e.startIndex}:{start:-1,end:0}};t.prototype._computeSelectedCount=function(){this._itemSetSelectionModel.selection();for(var e=this._range.peek(),t=0,n=e.start;n<e.end;n++)this._itemSetSelectionModel.isIndexSelected(n)&&t++;return t};t.prototype._computeAreAllPhotosSelected=function(){var e=this._selectedCount(),t=this._range.peek();return 0===this._itemSetSelectionModel.mode?e===t.end-t.start:e>0};t.prototype._computeIsShareAvailable=function(){var e=this._range.peek();return this._isShareSupported()&&(0===this._itemSetSelectionModel.mode||e.end-e.start==1)};t.prototype._computeIsCheckVisible=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0};t.prototype._computeIsSelectAllAvailable=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0};t.prototype._computeIsShareSupported=function(){var e=this._itemSetSelectionModel.itemSet().content().items,t=this._range.peek(),n=this.unwrapObservable(e[t.start]);return this._itemCommandHelper.isCommandSupported(n,a.share)};return t})(r.default);t.default=f});
define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeader",["require","exports","./AllPhotosMonthHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllPhotosMonthHeaderViewModel","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-all-photos-month-header",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-allPhotosMonthHeader"><div class="od-allPhotosMonthHeader-text" role="heading" aria-level="2" data-bind="text:headerText"></div></div>'});
define("odsp-next/controls/allPhotosMonthHeader/AllPhotosMonthHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.headerText=t.headerText;return n}return t})(r.default);t.default=i});
define("odsp-next/controls/itemContent/tagsRoot/TagsRootItemContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./TagsRootItemContent"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/list/allphoto2/components/places/ItemsScopePlaces.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ItemsScopePlaces",getModule:function(){return n.default.resolve(new Promise(function(t,n){e(["./ItemsScopePlaces"],t,n)}))},getExport:function(e){return e.knockoutResourceKey.local}})})})});
define("odsp-next/controls/list/allphoto2/components/albums/ItemsScopeAlbums.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ItemsScopeAlbums",getModule:function(){return n.default.resolve(new Promise(function(t,n){e(["./ItemsScopeAlbums"],t,n)}))},getExport:function(e){return e.knockoutResourceKey.local}})})})});
define("odsp-next/controls/list/allphoto2/PhotosItemsScopeItemContent.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./PhotosItemsScopeItemContent",getModule:function(){return n.default.resolve(new Promise(function(t,n){e(["./PhotosItemsScopeItemContent"],t,n)}))},getExport:function(e){return e.knockoutResourceKey.local}})})})});
define("odsp-next/controls/list/allphoto2/components/tagsGallery/ItemsScopeTagsGallery.key",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"./ItemsScopeTagsGallery",getModule:function(){return n.default.resolve(new Promise(function(t,n){e(["./ItemsScopeTagsGallery"],t,n)}))},getExport:function(e){return e.knockoutResourceKey.local}})})})});
define("odsp-next/controls/smartBannerV2/SmartBannerV2",["require","exports","./SmartBannerV2.html","./SmartBannerV2ViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-smart-bannerv2",template:n.default,viewModel:r.default});t.default=s});
define("odsp-next/controls/smartBannerV2/SmartBannerV2.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="SmartBannerV2" data-bind="dismiss:onCloseClick">\x3c!--ko if:isCloseVisible--\x3e<button class="SmartBanner-close" data-bind="click:onCloseButtonClick"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e<div class="SmartBanner-content"><div class="SmartBanner-icon" data-bind="css:{\'SmartBanner-useSquareIcon\':useSquareIcon}"><span class="ms-Icon ms-Icon--OneDrive" role="img" data-bind="icon:true"></span></div><div class="SmartBanner-text" data-bind="css:{\'SmartBanner-noTagline\':hideTagline}"><div class="SmartBanner-lead" data-bind="text:leadText"></div><div class="SmartBanner-tagline" data-bind="text:taglineText,visible:!hideTagline"></div></div><div class="SmartBanner-button"><button class="od-Button od-Button--primary" data-bind="click:onContentClick"><span class="od-Button-label" data-bind="text:buttonText"></span></button></div><div class="ms-clearfix"></div></div></div>'});
define("odsp-next/controls/smartBannerV2/SmartBannerV2ViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../bindings/dismiss/DismissBinding","@ms/odsp-shared/lib/base/ViewModel","../../models/store/ItemsStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../resources/DataSourceResourceKeys","./SmartBannerV2.resx","../../bindings/logClick/LogClickBinding","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:s.default});n._platformDetection=n.resources.consume(g.platformDetection);n._navigation=n.resources.consume(m.navigation);var i=n._navigation.viewParams;n._isTestHookEnabled=!!i.mobileupsell;n.buttonText=l.default.SmartBannerV2ButtonUseText;n.taglineText=l.default.SmartBannerV2TaglineText;n.leadText=l.default.SmartBannerV2LeadText;n.useSquareIcon=!1;if(n._platformDetection.isWinPhone){n.hideTagline=!0;n.taglineText="";n.leadText=l.default.SmartBannerV2LeadTextWP;n.useSquareIcon=!0}else if(n._platformDetection.isAndroid)n.hideTagline=!1;else{n.buttonText=l.default.SmartBannerV2ButtonText;n.hideTagline=!1}n._urlDataSource=n.resources.consume(f.url);n._dataStore=n.resources.consume(u.resourceKey);n._iosMobilePathDataSource=n.resources.isExposed(f.iosMobileAppPath)?n.resources.consume(f.iosMobileAppPath):null;n._isVisible=t.isVisible;n._updateIsVisibleBinding();n.isCloseVisible=r.observable(!0);n._storePath=t.useODCAdjustLink?"https://app.adjust.com/k8x1qd_mpo9r5":"https://app.adjust.com/xxf6jd_wkry4s_qxfx79";return n}t.prototype.onCloseButtonClick=function(){this._dismiss()};t.prototype.onCloseClick=function(){this.isCloseVisible.peek()||this._dismiss()};t.prototype.onContentClick=function(){var e=this,t=Date.now(),n=v.format(c.default.ENGAGEMENT_NAME_FORMAT,p.default[this._urlDataSource.getPageType()],d.default[this._urlDataSource.getQueryType()],h.default[h.default.SmartBannerV2_Click]);i.Engagement.logData({name:n.toLowerCase()});if(this._platformDetection.isIOS)this._navigation.navigateTo(this._storePath);else{this.async.setTimeout(function(){Date.now()-t<750&&e._navigation.navigateTo(e._storePath)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};t.prototype._dismiss=function(){this._isVisible(!1);this._dataStore.setValue(t.STORAGE_KEY,Date.now(),a.default.local);var e=v.format(c.default.ENGAGEMENT_NAME_FORMAT,p.default[this._urlDataSource.getPageType()],d.default[this._urlDataSource.getQueryType()],h.default[h.default.SmartBannerV2_Close]);i.Engagement.logData({name:e.toLowerCase(),extraData:{action:c.default.BINDING_ACTION}})};t.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource){e=!0;if(!this._isTestHookEnabled){var n=this._dataStore.getValue(t.STORAGE_KEY,a.default.local);if(n){n>this._getPromptWaitTimeMilli()&&(e=!1)}}}e&&i.Engagement.logData({name:"SmartBannerV2_View",currentPage:p.default[this._urlDataSource.getPageType()],extraData:{queryType:d.default[this._urlDataSource.getQueryType()]}});this._isVisible(e)};t.prototype._getPromptWaitTimeMilli=function(){return Date.now()-864e5};t.STORAGE_KEY="oneDriveSmartBannerVisible";return t})(o.default);t.default=y});
define("odsp-next/bindings/logClick/LogClickBinding",["require","exports","knockout","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/logClick/ClickContextKeyEnum","../../dataSources/url/PageType","../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){}e.init=function(t,a,f,l,c){var h,p,d=n.utils.unwrapObservable(a());if(d){h=d.logClickContext.contextKey;s.default[h]&&n.utils.registerEventHandler(t,e.BINDING_ACTION,function(){p=i.format(e.ENGAGEMENT_NAME_FORMAT,o.default[d.logClickContext.pageType],u.default[d.logClickContext.queryType],s.default[h]);r.Engagement.logData({name:p.toLowerCase(),extraData:{action:e.BINDING_ACTION}})});if(d.click){return n.bindingHandlers.click.init(t,function(){return d.click},f,l,c)}}};e.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}";e.BINDING_ACTION="click";return e})();t.default=a});
define("odsp-next/bindings/logClick/ClickContextKeyEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.SmartBannerV2_Close=0]="SmartBannerV2_Close";e[e.SmartBannerV2_Click=1]="SmartBannerV2_Click"})(n||(n={}));t.default=n});
define("odsp-next/dataSources/promotedPhotos/odc/PromotedPhotosDataSource",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../models/tag/TagType","../../../utilities/tag/GroupPacker","../../url/odc/UrlDataSource"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.extractSharedAlbumsFromItemSet=function(e){for(var t=this,n=[],r=0,i=e.content.peek().items;r<i.length;r++){var s=i[r],o=this.peekUnwrapObservable(s);o.isAlbum&&o.ownerId!==u.default.viewerId&&n.push(s)}return n.sort(function(e,n){return t.peekUnwrapObservable(n).dateSharedTime.getTime()-t.peekUnwrapObservable(e).dateSharedTime.getTime()})};t.prototype.getTagsAndPlaces=function(e,t){for(var n=[],r={},i=[],s={},o=0;o<100;o++){var u=e[o];if(!u)break;var a=u.peek(),f=a.tags&&a.tags.length>0,l=a.geoLocation&&a.geoLocation.hierarchyIndex;if(f&&l){Math.random()<.5?this._makeTagEntry(a,r,n,t):this._makePlaceEntry(a,s,i,t)}else f?this._makeTagEntry(a,r,n,t):l&&this._makePlaceEntry(a,s,i,t)}return{tags:n,places:i}};t.prototype._makePlaceEntry=function(e,t,n,r){var i=e.geoLocation,s=i&&i.hierarchyIndex;if(s&&e.thumbnail){var o=t[s];if(!o){var u=this._makePlace(i,r);o=t[s]=u;n.push(u)}var a=o.peek();a.folder.covers?a.folder.covers.push(e.thumbnail):a.folder.covers=[e.thumbnail];o(a)}};t.prototype._makeTagEntry=function(e,t,n,r){var i=e.tags[Math.floor(Math.random()*e.tags.length)],s=t[i.tag];if(!s){var o=this._makeTag(i,r);s=t[i.tag]=o;n.push(o)}var u=s.peek();u.folder.covers?u.folder.covers.push(e.thumbnail):u.folder.covers=[e.thumbnail];s(u)};t.prototype._makeTag=function(e,t){var n={count:0,localizedTag:e.localizedTag,tag:e.tag};return r.observable(o.createNewTagItem(s.default.allTags,n,null,t))};t.prototype._makePlace=function(e,t){return r.observable(o.createNewTagItem(s.default.allPlaces,null,e,t))};return t})(i.default);t.default=a});
define("odsp-next/providers/dataManager/mapper/AlbumsDataManagerMapper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../models/itemSet/ItemSet","../../../models/item/ItemHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.itemSet=t.itemSet;n._requiredRange=t.requiredRange;n.mappedRequiredRange=n.createObservable({start:0,end:0});n.mappedItemSet=n.createPureComputed(n._computeMappedItemSet,{deferEvaluation:!0});n.mappedItemSet.equalityComparer=i.objectStrictEquality;n.createBackgroundComputed(n._computeRequiredRange);n.createBackgroundComputed(n._computeMappedItemSetContent);return n}t.prototype.getOriginalItemIndexByMappedIndex=function(e){return this._indexMap?this._indexMap[e]:e};t.prototype.getNewMappedIndexByOldIndex=function(e){throw"Not implemented"};t.prototype._computeMappedItemSet=function(){var e=this.itemSet(),t=new s.default(e.key,e.context);t.item=e.item;t.content.peek().groupings=e.content.peek().groupings;t.schema=e.schema;t.isPlaceholder=e.isPlaceholder;t.content.peek().items=[];return t};t.prototype._computeRequiredRange=function(){var e=this.mappedRequiredRange(),t=0,n=0;if(this._indexMap){t=this._indexMap[e.start];n=this._indexMap[e.end]}var r={start:t,end:n};this._requiredRange(r)};t.prototype._computeMappedItemSetContent=function(){for(var e=this.itemSet(),t=e.content(),n=[],r=[],i=0;i<t.items.length;i++)if(t.items[i]){var s=t.items[i],u=s.peek();if(!o.isAutoAlbum(u)){n.push(s);r.push(i)}}else{n.push(void 0);r.push(i)}this._indexMap=r;this.mappedItemSet.peek().isPlaceholder=e.isPlaceholder;this.mappedItemSet.peek().content({items:n,groupings:t.groupings})};return t})(r.default);t.AlbumsDataManagerMapper=u;t.default=u});
define("odsp-next/providers/dataManager/photos/PhotosDataManager",["require","exports","tslib","../DataManager","../../album/AlbumProvider","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Semaphore","../../../controls/list/layouts/LayoutType","../../../models/tag/TagType","../../../dataSources/url/QueryType","../../../models/item/VirtualItemType","../../../utilities/features/Features","../../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._photoProvider=n.resources.consume(s.photo);n._albumProvider=n.resources.consume(i.resourceKey);n._tagProvider=n.resources.consume(s.tag);var r=n.viewParams.peek();if(r&&r.noRootId)n._allPhotosUserSettings=n.createObservable({rootId:"",isAscending:!1});else{n._allPhotosUserSettings=n._photoProvider.getAllPhotosSettings();n.createBackgroundComputed(n._computeAllPhotosSettings).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}n.createBackgroundComputed(n._markNewAutoAlbumAsSeen);n.createBackgroundComputed(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});return n}t.prototype.getDefaultLayoutForView=function(){var t=this.referenceItemSet(),n=this.layoutType.peek()||a.Grid;if(!t)return n;var r=t.context,i=t.item(),s=this.urlDataSource.getKeyParams(i.key);if(this._isGetItemRequest(r))if(i.isPlaceholder)switch(s.id){case"albums":n=a.Albums}else switch(i.virtualItemType){case c.default.Album:n=a.SingleAlbum;break;case c.default.AlbumRoot:n=a.Albums}else{switch(s.qt){case"allmyphotos":n=e.prototype.getDefaultLayoutForView.call(this)}switch(s.id){case"tags":case"places":n=a.TagGrid}}return n};t.prototype.isItemResolved=function(t){return e.prototype.isItemResolved.call(this,t)&&!!t.peek().itemFromServer};t.prototype.resolveIndices=function(e){for(var t=this,n=new u.default(6),r=this.itemSet.peek().content.peek().items,i=[],s=function(e){return function(){return t.itemProvider.getItem(e)}},a=0,f=e;a<f.length;a++){var l=r[f[a]];if(l&&l.peek()&&l.peek().key){var c={parentKey:l.peek().key,resultSetOptions:this.itemResultSetOptions};i.push(n.enqueue(s(c)))}}return o.default.all(i).then(function(){})};t.prototype.getOnThisDayContext=function(){var e=this.requiredRange.peek(),n=this._allPhotosUserSettings.peek().rootId,r=this.referenceRevision.peek(),i=this.currentItemKey.peek(),s=this.urlDataSource.getKeyParams(i),o=this.viewParams.peek(),u={parentKey:void 0,photoType:9,startIndex:e.start,endIndex:e.end,rootItemId:n,revision:r,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:s.locationFilter,tagFilter:s.tagFilter},a=new Date;a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);var f=a.toISOString(),l=!0,c=!1;try{l=f=new Date(Date.parse(o.onThisDay)).toISOString();c=!!o.highlights&&!!o.highlights}catch(e){}u.startDate=f;u.onThisDay=l;u.highlights=c;return u};t.prototype.getCurrentItemSetSync=function(e){var t;if(this._isGetItemRequest(e))t=this.itemProvider.getItemSync(e);else{switch(e.photoType){case 0:case 6:case 7:case 8:case 9:t=this._photoProvider.getAllPhotosSync(e);break;case 2:t=this._tagProvider.getAllTagsSync(e,f.default.allTags);break;case 3:t=this._tagProvider.getAllTagsSync(e,f.default.allPlaces);break;default:t=this.itemSet.peek()}}return t};t.prototype.getCurrentItemSet=function(e){var t;if(this._isGetItemRequest(e)){switch(this.urlDataSource.getKeyParams(e.parentKey).id){case"albums":default:t=this.itemProvider.getItem(e)}}else switch(e.photoType){case 0:case 6:case 7:case 8:t=this._photoProvider.getAllPhotosForPage(e);break;case 9:t=this._photoProvider.getOnThisDayPhotos(e);break;case 2:t=this._tagProvider.getAllTags(e);break;case 3:t=this._tagProvider.getAllPlaces(e);break;default:t=null}return t};t.prototype.computeCurrentContext=function(){var e,n=this.requiredRange(),r=this.viewParams(),i=this.referenceRevision(),s=this.urlDataSource.getPhotoType(r),o=this.currentItemKey();if(1===s){e={parentKey:o,queryType:l.default.AllMyPhotos,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r)}}else if(5===s){var u=this.urlDataSource.getFocusItemKey(),a=null;u&&this.focusItemIndexInItemSet()<0&&(a=u);e={parentKey:o,queryType:l.default.AllMyPhotos,startKey:a,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r),resultSetOptions:this.itemResultSetOptions}}else if(4===s)e=this._determineFaceContext();else{var f=this.urlDataSource.getKeyParams(o),c=void 0;"allmyphotos"!==f.qt||f.tagFilter||f.locationFilter||(c=this._allPhotosUserSettings().rootId);e=9===s?this.getOnThisDayContext():{parentKey:null,photoType:s,startIndex:n.start,endIndex:n.end,rootItemId:c,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:f.locationFilter,tagFilter:f.tagFilter}}return e};t.prototype._markNewAutoAlbumAsSeen=function(){var e=this.item();if(!h.isFeatureEnabled(h.EnableEvokeAlignments)&&e.properties.newTag&&e.properties.autoAlbumTag){var t=!1,n=this.viewParams();this.resources.consume(p.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===n.tagFilter&&(t=!0);this._albumProvider.markAutoAlbumAsSeen(e,t)}};t.prototype._determineFaceContext=function(){var e=this.requiredRange();return{startIndex:e.start,endIndex:e.end,parentKey:this.currentItemKey(),queryType:l.default.AllMyPhotos,sortField:"size",isAscending:!1,revision:this.referenceRevision()}};t.prototype._computeAllPhotosSettings=function(){var e=this._allPhotosUserSettings(),t=this.currentItemKey(),n=this.urlDataSource.getKeyParams(t),r=n.id,i=this.urlDataSource.getQueryType(n),s=!n.locationFilter&&!n.tagFilter;if(e&&r!==e.rootId&&i===l.default.AllMyPhotos&&s){n.id=e.rootId;this.navigation.navigateTo({url:this.urlDataSource.getItemUrl(this.urlDataSource.getKey(n),{viewParams:this.viewParams.peek()}),ignoreHistory:!0})}};t.prototype._computeRequestFocusItem=function(){var e,t=this.itemCacheToKOStoreDataSource();if(t)e=t.focusedKOItem();else{var n=this.focusItem();if(!n)return;e=n()}if(e&&!e.parentKey&&!e.isPlaceholder){var r=this.focusItemContext();this.trackPromise(this.itemProvider.getItem(r))}};t.prototype._isGetItemRequest=function(e){return!!e.parentKey};t.REQUEST_PAGE_SIZE=100;return t})(r.default);t.default=d});
define("odsp-next/providers/album/AlbumProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","../operation/OperationProvider","../item/ItemProvider","../../resources/ProviderResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/task/Task","../../dataSources/item/IGetWorkProgressContext","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-utilities/lib/resources/Resources","../../dataSources/album/odc/AlbumDataSource","../../models/item/ItemHelper","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._albumDataSource=n.albumDataSource;r._operationProvider=n.operationProvider;r._itemProvider=n.itemProvider;r._urlDataSource=n.urlDataSource;r._tagProvider=n.tagProvider;r._isSingleAlbumItemsScopeEnabled=r.resources.consume(b.isItemsScopeEnabledInSingleAlbumViewResourceKey);return r}t.prototype.addToAlbum=function(e){for(var t=this,n=new l.default,r=this.observables.createArray(e.items).map(function(r){var i=t._operationProvider.register({name:r.name,type:c.default.addItemsToAlbum,payloads:{addItemsToAlbum:{item:r,album:e.album}},iconName:r.iconName,batch:n});i.progress.maximum(1);i.progress.current(0);return i}),i=0,o=r();i<o.length;i++){o[i].state(f.default.started)}return this._albumDataSource.addToAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){if(!t._isSingleAlbumItemsScopeEnabled){t._itemProvider.invalidateItem(e.album.key);t._itemProvider.invalidateItem(t.getAlbumsParentKey())}for(var i=0,s=r();i<s.length;i++){var o=s[i];o.progress.current(1);o.state(f.default.completed)}return n},function(e){for(var t=0,n=r();t<n.length;t++){n[t].state(f.default.failed)}return s.default.wrapError(e)})};t.prototype.createAlbum=function(e,t){var n=this,r=[new h.default("createAlbum="+e.name,e.name)],i=e.keys;return this._albumDataSource.createAlbum(e.name,i).then(function(e){return n._getNewlyCreatedAlbum(e.id)}).then(function(e){r=e?r.map(function(t){return t.succeed(e)}):r.map(function(e){return e.fail(v.default.DefaultTitle)});t.update(r)},function(e){r=r.map(function(t){return t.fail(e.error)});t.update(r);return s.default.wrapError(e)})};t.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],n=0;n<e.length;n++)e[n].photo&&!e[n].video&&t.push(e[n].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)};t.prototype.removeFromAlbum=function(e){var t=this;return this._albumDataSource.removeFromAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){t._itemProvider.invalidateItem(t.getAlbumsParentKey());t._itemProvider.invalidateItem(e.album.key);return n},function(e){return s.default.wrapError(e)})};t.prototype.createAlbumFromFolder=function(e,n){for(var r=this,i=[new h.default("createAlbumFromFolder="+e.folder.id,e.folder.name)],o=0,u=i;o<u.length;o++){u[o].status=0}n.update(i);return this._albumDataSource.createAlbumFromFolder(e).then(function(e){return r._getNewlyCreatedAlbum(e.id)}).then(function(e){if(!e){var o=v.default.DefaultTitle;i=i.map(function(e){return e.fail(o)});n.update(i);return s.default.wrapError(o)}var u=null,a=function(){var s={type:p.IGetWorkProgressTypes.albumFolderExtraction};u&&(s.workItemIds=u);r._itemProvider.getWorkProgress(s).done(function(s){var o;s.progress&&s.progress.length&&(o=s.progress[0]);if(o&&o.status!==d.ITaskStatuses[d.ITaskStatuses.Completed]){u||(u=[o.id]);r.async.setTimeout(a,t.ASYNC_DELAY)}else{i=i.map(function(t){return t.succeed(e)});n.update(i)}},function(e){i=i.map(function(e){return e.fail(v.default.DefaultTitle)});n.update(i)})};r.async.setTimeout(a,t.ASYNC_DELAY)},function(e){var t=v.default.DefaultTitle,r=new Error(t);i=i.map(function(e){return e.fail(r)});n.update(i);return s.default.wrapError(r)})};t.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});return this._albumDataSource.getAlbumsParentKey(e)};t.prototype.setCoverPhoto=function(e,t){var n=this,r=this.getAlbumsParentKey(),i=[new h.default(r+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(s){n._itemProvider.invalidateItem(r);n._itemProvider.invalidateItem(e.album.key);i=i.map(function(e){return e.succeed(s.id)});t.update(i)},function(e){var n=new Error(e);i=i.map(function(e){return e.fail(n)});t.update(i);return s.default.wrapError(n)})};t.prototype.saveAutoAlbum=function(e,t,n){var r=this,i=e.album,o=i.properties.newTag,u=new h.default(i.key,i);if(!y.isAutoAlbum(i)){u=u.fail();n.update([u]);return s.default.wrap(void 0)}n.update([u]);return this._tagProvider.updateTags({items:[i],tagsToDelete:[o],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:g.NEW_ALBUM_TAG}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(i.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return s.default.wrapError(t)})};t.prototype.markAutoAlbumAsSeen=function(e,t){var n=e.properties.newTag,r=e.properties.autoAlbumTag;return n&&r?this._tagProvider.updateTags({items:[e],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){return e&&!e.error},function(e){return!1}):s.default.wrap(!1)};t.prototype.convertToAutoAlbum=function(e,t,n){var r=this,i=e.properties.newTag,o=e.properties.autoAlbumTag,u=new h.default(e.key,e);if(i){u=u.fail();n.update([u]);return s.default.wrap(void 0)}i={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"};o||(o={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"});return this._tagProvider.updateTags({items:[e],tagsToDelete:null,tagsToAdd:[o,i],rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(t){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:g.NEW_ALBUM_TAG}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(e.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return s.default.wrapError(t)})};t.prototype._getNewlyCreatedAlbum=function(e){var t=this.getAlbumsParentKey();this._itemProvider.invalidateItem(t);var n={parentKey:t,ownerId:this._urlDataSource.getOwnerId(t),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(n).then(function(t){for(var n=t.content.peek().items,r=n.length,i=0;i<r;i++){var s=n[i].peek();if(s.id===e)return s}})};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{operationProvider:o.resourceKey,itemProvider:u.resourceKey,albumDataSource:i.album,urlDataSource:i.url,tagProvider:a.tag});t.ASYNC_DELAY=5e3;t.ASYNC_RETRY_LIMIT=5;t.ASYNC_RETRY_DELAY=15e3;return t})(r.default);t.default=w;t.resourceKey=m.createResolvedResourceKey(e("module").id,w)});
define("odsp-next/providers/itemHistory/ItemHistoryProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.lastItem=r.observable(null);n._itemKeyToHistoryItem={};n._currentItemSet=n.resources.consume(s.currentItemSet);n.currentItem=n.createComputed(function(){var e=n._currentItemSet();return n.lastItem.peek()&&e.key===n.currentItem.peek().item.key?n.currentItem.peek():n._pushCurrentItemSet()},{deferEvaluation:!0});return n}t.prototype.getHistoryItemByKey=function(e){return this._itemKeyToHistoryItem[e]};t.prototype._pushCurrentItemSet=function(){var e=this._currentItemSet.peek();if(e){var t=this._itemKeyToHistoryItem[e.key],n={item:e,anchorItem:t&&t.anchorItem||r.observable(null)};this.lastItem(this.currentItem.peek());this._itemKeyToHistoryItem[e.key]=n;return this._itemKeyToHistoryItem[e.key]}};return t})(i.default);t.default=o});
define("odsp-next/providers/promotedPhotos/PromotedPhotosProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../album/AlbumProvider","../item/ItemProvider","../../dataSources/url/QueryType","../../utilities/features/Features","../../models/item/ItemHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._promotedPhotosDataSource=n.resources.consume(s.promotedPhotos);n._albumProvider=n.resources.consume(u.resourceKey);n._photoProvider=n.resources.consume(o.photo);n._itemProvider=n.resources.consume(a.resourceKey);n._urlDataSource=n.resources.consume(s.url);return n}t.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return l.isFeatureEnabled(l.EnableEvokeAlignments)&&c.isAutoAlbum(t)||!l.isFeatureEnabled(l.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})};t.prototype.getTagsAndPlaces=function(e){var t=this,n=this._photoProvider.getAllPhotosSync(e);return this._photoProvider.getAllPhotosForPage(e).then(function(){var r=n.content().items;return t._promotedPhotosDataSource.getTagsAndPlaces(r,e)})};t.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);t.setMilliseconds(0);var n={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},i=this._photoProvider.getAllPhotosSync(n),s=i.item,o=s.peek();return i.isPlaceholder||i.isExpired||o.isPlaceholder?this._photoProvider.getOnThisDayPhotos(n).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):o.folder.covers.length?r.default.wrap([s]):r.default.wrap([])};t.prototype.getSharedAlbums=function(){var e=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(f.default.SharedWithMe)}).then(function(t){return e._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(t)})};return t})(i.default);t.default=h});
define("odsp-next/controls/list/AlbumsList",["require","exports","./List.html","knockout","./viewModels/AlbumsListViewModel","./layouts/LayoutType","ODCPhotos_css","../itemTile/ItemTile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={tagName:s.Albums,template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(o.tagName)||r.components.register(o.tagName,o);t.default=o});
define("odsp-next/controls/list/viewModels/AlbumsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/AlbumsLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(i.default))(t));return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/AlbumsLayout",["require","exports","tslib","./GridLayout","../../autoAlbumHeader/AutoAlbumHeader","../../allPhotosMonthHeader/AllPhotosMonthHeader","../../../utilities/features/Features"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){t.isGrouped=!0;return e.call(this,t)||this}t.prototype.getMinRowHeight=function(){return o.isFeatureEnabled(o.EnableEvokeAlignments)?240:e.prototype.getMinRowHeight.call(this)};t.prototype.getItemAspectRatio=function(t){return o.isFeatureEnabled(o.EnableEvokeAlignments)?4/3:e.prototype.getItemAspectRatio.call(this,t)};t.prototype.getInnerMargin=function(){return 4};t.prototype.getGroup=function(e,t){if(!o.isFeatureEnabled(o.EnableEvokeAlignments)){var n=this._itemSet().content.peek().groupings||[];if(n&&n.length&&n[1]&&n[1].itemGroups)for(var r=0,i=n[1].itemGroups;r<i.length;r++){var s=i[r];if(s){var u=s.startIndex+s.count-1;if(s.startIndex<=e&&u>=e)return s}}}};t.prototype.getHeader=function(t,n,r){if(!o.isFeatureEnabled(o.EnableEvokeAlignments))return e.prototype.getHeader.call(this,t,n,r);var i=t&&t.peek&&t.peek(),u=n&&n.peek&&n.peek();if(i&&i.dateCreatedTime&&u&&u.dateCreatedTime&&i.dateCreatedTime.getFullYear()!==u.dateCreatedTime.getFullYear()){var a=u.dateCreatedTime.getFullYear(),f=s.default.tagName,l={resources:this.resources,headerText:""+a},c=this.isSmallWidthLayout?64:80;return{key:r+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:c,viewType:f,viewData:l,shouldLineBreak:!0,isHeader:!0}}};t.prototype.finalizeRow=function(t,n){var r=this._itemSet().content.peek().groupings;if(!o.isFeatureEnabled(o.EnableEvokeAlignments)&&r&&r.length){var i=this.currentRow,s=!1;if(i&&this.currentGroup&&this.currentGroup.state){var u=this.currentGroup.state.peek();u&&(s=u.isCollapsed&&!i.isHeader)}s?this.currentRow=null:e.prototype.finalizeRow.call(this,t,n)}else e.prototype.finalizeRow.call(this,t,n)};t.prototype.getHeaderDetails=function(e,t){var n=this,r="",s={group:null,cellsInGroup:null},o=20,u=this.responsiveHelper,a=u.formFactorSize.peek();if(e){r=i.default.tagName;s={startIndex:t,group:e,cellsInGroup:0,resources:this.resources,onToggle:function(){n.evaluateLayout(!0)}};o=u.compareSize(a,"XLarge")>=0?74:u.compareSize(a,"Small")>0?49:46}return{viewType:r,viewData:s,headerHeight:o}};return t})(r.default);t.default=u});
define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeader",["require","exports","./AutoAlbumHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AutoAlbumHeaderViewModel","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-auto-album-header",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="od-autoAlbumHeader"><div class="od-autoAlbumHeader-textWrapper" data-bind="click:onClickHeader"><div class="od-autoAlbumHeader-text ms-fontColor-neutralSecondary" data-bind="text:text"></div><div class="ms-Icon" data-bind="class:chevronClass"></div></div></div>'});
define("odsp-next/controls/autoAlbumHeader/AutoAlbumHeaderViewModel",["require","exports","tslib","./AutoAlbumHeader.resx","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.group=t.group;n._onToggle=t.onToggle;n.text=n.createPureComputed(n._computeText);n.chevronClass=n.createPureComputed(n._computeChevron);return n}t.prototype.onClickHeader=function(e,t){var n=this.group.state.peek().isCollapsed;this.group.state({isCollapsed:!n});this._onToggle();return!1};t.prototype._computeText=function(){return this.group.state().isCollapsed?r.default.ShowMoreAlbums:r.default.ShowLessAlbums};t.prototype._computeChevron=function(){return s.getIconClassName(this.group.state().isCollapsed?"ChevronDown":"ChevronUp")};return t})(i.default);t.default=o});
define("odsp-next/controls/list/TagsList",["require","exports","./List.html","knockout","./viewModels/TagsListViewModel","./layouts/LayoutType","ODCPhotos_css","../detailsRow/DetailsRow","../detailsHeader/DetailsHeader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={tagName:s.TagsList,template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(o.tagName)||r.components.register(o.tagName,o);t.default=o});
define("odsp-next/controls/list/viewModels/TagsListViewModel",["require","exports","tslib","./ListViewModel","../layouts/TagsListLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=new(r.managed(i.default))(t);r.initialize(s);return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/TagsListLayout",["require","exports","tslib","./DetailsLayout","../../../resources/ControlResourceKeys","knockout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:24}};t.prototype.isCheckSupported=function(){return!1};t.prototype.getHeaderCell=function(){return null};t.prototype.onRowInvoke=function(e){var t=this.resources.consume(i.itemsSelection);t.clear(!0);t.setItemSelected(s.dataFor(e.target).item,!0);e.stopPropagation();e.preventDefault();return!1};return t})(r.default);t.default=o});
define("odsp-next/controls/list/TagGrid",["require","exports","./List.html","knockout","./viewModels/TagGridViewModel","./layouts/LayoutType","ODCPhotos_css","../itemTile/ItemTile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={tagName:s.TagGrid,template:n.default,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};r.components.isRegistered(o.tagName)||r.components.register(o.tagName,o);t.default=o});
define("odsp-next/controls/list/viewModels/TagGridViewModel",["require","exports","tslib","./ListViewModel","../layouts/TagGridLayout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(i.default))(t));return r}return t})(r.default);t.default=s});
define("odsp-next/controls/list/layouts/TagGridLayout",["require","exports","tslib","./GridLayout","../../allTagsHeader/AllTagsHeader"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHeaderDetails=function(e){var t="",n={},r=20;if(e){var s=this.responsiveHelper,o=s.compareSize(s.formFactorSize.peek(),"XXLarge")>=0,u=o?37:28,a=o?22:14,f=o?12:0;t=i.default.tagName;n={group:e,cellsInGroup:0,resources:this.resources};r=u+a+f}return{viewType:t,viewData:n,headerHeight:r}};return t})(r.default);t.default=s});
define("odsp-next/controls/allTagsHeader/AllTagsHeader",["require","exports","./AllTagsHeader.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AllTagsHeaderViewModel","ODCPhotos_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-allTags-header",template:n.default,viewModel:i.default,synchronous:!0});t.default=s});
define("odsp-next/controls/allTagsHeader/AllTagsHeader.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="AllTagsHeader"><div class="AllTagsHeader-title">\x3c!--ko if:regionUrl--\x3e<a class="AllTagsHeader-regionLink" data-bind="text:header,attr:{href:regionUrl}"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:regionUrl--\x3e<span data-bind="text:header"></span>\x3c!--/ko--\x3e</div><div class="AllTagsHeader-subText" data-bind="text:subtext"></div></div>'});
define("odsp-next/controls/allTagsHeader/AllTagsHeaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.header=t.group.tagHeader.title;n.subtext=t.group.tagHeader.countSubtitle;n.regionUrl=t.group.tagHeader.regionUrl;return n}return t})(r.default);t.default=i});
define("odsp-next/controls/itemTile/ItemTileDeferred",["require","exports","./ItemTileAlbum.html","./ItemTileDiscoverCard.html","./ItemTileTag.html","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s.registerTemplate("ms-item-tile-album",n.default);s.registerTemplate("ms-item-tile-tag",i.default);s.registerTemplate("ms-item-tile-discover",r.default)});
define("odsp-next/controls/itemTile/ItemTileAlbum.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ItemTile-image" data-bind="component:{name:\'od-folder-cover-tile\',params:{item:item,imageRect:imageRect,pulseTarget:pulseTarget}}"></div><div class="ItemTile-dragDropIcon"></div><div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().name"></div><div class="ItemTile-childCount" data-bind="text:childCount"></div><div class="ItemTile-date" data-bind="text:dateText"></div></div>\x3c!--ko if:button--\x3e<button class="od-ItemTile-button" data-bind="attr:{title:button.title},click:onButtonClick"><span class="od-ItemTile-buttonIcon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:button.icon}}"></span></button>\x3c!--/ko--\x3e'});
define("odsp-next/controls/itemTile/ItemTileDiscoverCard.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ItemTile-discoverFileContainer">\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,desiredSize:imageRect,alignment:\'cover\',isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="ItemTile-fileIconContainer"><div class="ItemTile-fileIcon" data-bind="css:{\'ItemTile-fileIcon--thumbnail\':hasThumbnail(),\'ItemTile-fileIcon--noThumbnail\':!hasThumbnail()},component:{name:\'ms-file-type-icon\',params:{iconName:item().iconName,iconSize:iconSize(),desiredSize:desiredSize()}}"></div></div><div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().displayName"></div><div class="ItemTile-subText"><div class="ItemTile-entity-container"><img class="ItemTile-entity" data-bind="attr:{src:item().editorProfilePicUrl},visible:showPerson()"><div class="ItemTile-entity" data-bind="visible:!showPerson()"><i class="Icon-main ms-Icon" data-bind="icon:true,css:{\'ms-Icon--Chart\':item().viewersCount>1,\'ms-Icon--FavoriteStarFill\':!item().viewersCount}"></i></div></div><div class="ItemTile-longText" data-bind="text:subText"></div><div class="ItemTile-viewerCount ItemTile-entity-container" data-bind="visible:!showPerson()&&!!item().viewersCount"><i class="ms-Icon ms-Icon--View" data-bind="icon:true"></i><span data-bind="text:item().viewersCount"></span></div></div></div></div>'});
define("odsp-next/controls/itemTile/ItemTileTag.html",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default='<div class="ItemTile-image" data-bind="component:{name:\'od-folder-cover-tile\',params:{item:item,thumbnail:thumbnail,imageRect:imageRect,pulseTarget:pulseTarget}},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}"></div><div class="ItemTile-nameCover"><div class="ItemTile-tagText ms-fontWeight-regular"><div class="ItemTile-name" data-bind="text:item().name"></div>\x3c!--ko if:showTagCount&&tagCount()>0--\x3e<div class="ItemTile-tagCount" data-bind="text:tagCount"></div>\x3c!--/ko--\x3e</div></div>'});
define('ODCPhotos_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".od-ScrollBarTooltip{height:40px;background:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:absolute;padding:4px 10px;cursor:default;box-shadow:0 0 5px 0 "},{"theme":"blackTranslucent40","defaultValue":"rgba(0,0,0,.4)"},{"rawString":";border:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";box-sizing:border-box}.od-ScrollBarTooltip-displayText{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";line-height:30px}.od-OverlayHost-overlay .od-ScrollBarTooltip{transition:opacity 267ms linear,visibility 0s linear 267ms;opacity:0;visibility:hidden}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ScrollBarTooltip{transition-delay:0s,0s;opacity:1;visibility:inherit}"},{"rawString":"[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:48px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:48px}[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:54px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:54px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}.xlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list{padding-top:0}"},{"rawString":".od-AllPhotosHeader{width:100%;height:100%}.md .od-AllPhotosHeader,.sm .od-AllPhotosHeader{height:40px;line-height:40px}.od-AllPhotosHeader:hover .od-AllPhotosHeader-check{opacity:1}.lg .od-AllPhotosHeader::before,.xlg .od-AllPhotosHeader::before,.xxlg .od-AllPhotosHeader::before,.xxxlg .od-AllPhotosHeader::before,.xxxxlg .od-AllPhotosHeader::before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(0,0,0,.06)}.md .od-AllPhotosHeader-eventName,.sm .od-AllPhotosHeader-eventName{display:inline-block}[dir=ltr] .md .od-AllPhotosHeader-eventName,[dir=ltr] .sm .od-AllPhotosHeader-eventName{padding-left:10px}[dir=rtl] .md .od-AllPhotosHeader-eventName,[dir=rtl] .sm .od-AllPhotosHeader-eventName{padding-right:10px}.lg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-eventName{position:absolute;left:16px;right:16px;top:120px}html[dir=ltr] .lg .od-AllPhotosHeader-eventName,html[dir=ltr] .xlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-eventName{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-eventName,html[dir=rtl] .xlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-eventName{text-align:left}.od-AllPhotosHeader-month{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.md .od-AllPhotosHeader-month,.sm .od-AllPhotosHeader-month{font-size:17px;font-weight:300}.lg .od-AllPhotosHeader-month,.xlg .od-AllPhotosHeader-month,.xxlg .od-AllPhotosHeader-month,.xxxlg .od-AllPhotosHeader-month,.xxxxlg .od-AllPhotosHeader-month{font-size:15px;font-weight:400;font-weight:100}.lg .od-AllPhotosHeader-month::after,.xlg .od-AllPhotosHeader-month::after,.xxlg .od-AllPhotosHeader-month::after,.xxxlg .od-AllPhotosHeader-month::after,.xxxxlg .od-AllPhotosHeader-month::after{content:'\\A';white-space:pre}.lg .od-AllPhotosHeader-eventName,.lg .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-share{font-size:14px;font-weight:400}.md .od-AllPhotosHeader-check,.sm .od-AllPhotosHeader-check{top:10px;position:absolute}[dir=ltr] .md .od-AllPhotosHeader-check,[dir=ltr] .sm .od-AllPhotosHeader-check{right:0}[dir=rtl] .md .od-AllPhotosHeader-check,[dir=rtl] .sm .od-AllPhotosHeader-check{left:0}.md .od-AllPhotosHeader-check .ItemCheck,.sm .od-AllPhotosHeader-check .ItemCheck{display:inline-block}.lg .od-AllPhotosHeader-check,.xlg .od-AllPhotosHeader-check,.xxlg .od-AllPhotosHeader-check,.xxxlg .od-AllPhotosHeader-check,.xxxxlg .od-AllPhotosHeader-check{top:8px;position:absolute;opacity:0}[dir=ltr] .lg .od-AllPhotosHeader-check,[dir=ltr] .xlg .od-AllPhotosHeader-check,[dir=ltr] .xxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxxlg .od-AllPhotosHeader-check{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-check,[dir=rtl] .xlg .od-AllPhotosHeader-check,[dir=rtl] .xxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxxlg .od-AllPhotosHeader-check{left:16px}.od-AllPhotosHeader-check.is-selected{opacity:1}.od-AllPhotosHeader .od-AllPhotosHeader-share{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.md .od-AllPhotosHeader .od-AllPhotosHeader-share,.sm .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;top:0}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-right:15px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-left:15px}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{right:18px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{left:18px}.lg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;bottom:16px}[dir=ltr] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{right:16px}[dir=rtl] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{left:16px}.od-AllPhotosHeader .od-AllPhotosHeader-share:focus,.od-AllPhotosHeader .od-AllPhotosHeader-share:hover{color:"},{"theme":"themeDarker","defaultValue":"#004578"},{"rawString":"}.od-AllPhotosHeader .od-AllPhotosHeader-share:active{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.md .od-AllPhotosHeader-date,.sm .od-AllPhotosHeader-date{display:inline-block}.lg .od-AllPhotosHeader-date,.xlg .od-AllPhotosHeader-date,.xxlg .od-AllPhotosHeader-date,.xxxlg .od-AllPhotosHeader-date,.xxxxlg .od-AllPhotosHeader-date{position:absolute;top:40px}[dir=ltr] .lg .od-AllPhotosHeader-date,[dir=ltr] .xlg .od-AllPhotosHeader-date,[dir=ltr] .xxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-date,[dir=rtl] .xlg .od-AllPhotosHeader-date,[dir=rtl] .xxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{left:16px}html[dir=ltr] .lg .od-AllPhotosHeader-date,html[dir=ltr] .xlg .od-AllPhotosHeader-date,html[dir=ltr] .xxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-date,html[dir=rtl] .xlg .od-AllPhotosHeader-date,html[dir=rtl] .xxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{text-align:left}[dir=ltr] .md .od-AllPhotosHeader-day,[dir=ltr] .sm .od-AllPhotosHeader-day{margin-left:5px}[dir=rtl] .md .od-AllPhotosHeader-day,[dir=rtl] .sm .od-AllPhotosHeader-day{margin-right:5px}.lg .od-AllPhotosHeader-day,.xlg .od-AllPhotosHeader-day,.xxlg .od-AllPhotosHeader-day,.xxxlg .od-AllPhotosHeader-day,.xxxxlg .od-AllPhotosHeader-day{font-size:42px}"},{"rawString":".md .od-allPhotosMonthHeader,.sm .od-allPhotosMonthHeader{height:64px;line-height:64px}.lg .od-allPhotosMonthHeader,.xlg .od-allPhotosMonthHeader,.xxlg .od-allPhotosMonthHeader,.xxxlg .od-allPhotosMonthHeader,.xxxxlg .od-allPhotosMonthHeader{height:80px;line-height:80px}.od-allPhotosMonthHeader-text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block;font-size:21px;font-weight:100}[dir=ltr] .od-allPhotosMonthHeader-text{margin-right:15px}[dir=rtl] .od-allPhotosMonthHeader-text{margin-left:15px}.xlg .od-allPhotosMonthHeader-text,.xxlg .od-allPhotosMonthHeader-text,.xxxlg .od-allPhotosMonthHeader-text,.xxxxlg .od-allPhotosMonthHeader-text{font-size:28px;font-weight:100}"},{"rawString":".SmartBannerV2{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";min-height:80px;overflow:hidden;cursor:pointer;border-bottom:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";position:fixed;z-index:298;bottom:0;left:0;right:0;padding:10px;box-shadow:-7px 0 10px rgba(0,0,0,.22)}.SmartBannerV2 .SmartBanner-close{position:absolute;top:0;width:40px;text-align:center;line-height:40px;cursor:pointer;border:none;background-color:transparent;font-size:20px}[dir=ltr] .SmartBannerV2 .SmartBanner-close{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-close{left:0}.lg .SmartBannerV2 .SmartBanner-close,.xlg .SmartBannerV2 .SmartBanner-close,.xxlg .SmartBannerV2 .SmartBanner-close,.xxxlg .SmartBannerV2 .SmartBanner-close,.xxxxlg .SmartBannerV2 .SmartBanner-close{top:-5px;font-size:16px}[dir=ltr] .SmartBannerV2 .SmartBanner-content{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-content{left:0}.lg .SmartBannerV2 .SmartBanner-content,.xlg .SmartBannerV2 .SmartBanner-content,.xxlg .SmartBannerV2 .SmartBanner-content,.xxxlg .SmartBannerV2 .SmartBanner-content,.xxxxlg .SmartBannerV2 .SmartBanner-content{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button{padding-top:17px}.md .SmartBannerV2 .SmartBanner-content .SmartBanner-button,.sm .SmartBannerV2 .SmartBanner-content .SmartBanner-button{clear:both;padding-top:12px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:right}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:left}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";border-radius:5px;height:40px;width:40px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:right}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon.SmartBanner-useSquareIcon{border-radius:0}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:28px;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";margin:6px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:42px;margin:10px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{height:64px;width:64px}[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-left:10px}[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-right:10px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:right}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:14px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:17px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text.SmartBanner-noTagline .SmartBanner-lead{margin-top:7px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:12px;height:15px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:14px}"},{"rawString":".od-BasePage:not(.od-BasePage--hasSmartBanner) .od-photos-smartBanner{display:none}.od-photos-smartBanner .SmartBannerV2{position:absolute}.od-photos-promoted{position:relative}.md .od-photos-promoted,.sm .od-photos-promoted{margin-left:16px;margin-right:16px}.lg .od-photos-promoted,.xlg .od-photos-promoted,.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:32px;margin-right:32px}.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:48px;margin-right:48px}.od-photos-promoted .od-PromotedPhotos-title{margin-top:23px}.od-photos-promotedWrapper.od-photos-promotedWrapper--loaded{transition:height 467ms cubic-bezier(.1,.25,.75,.9);height:385px}.od-photos-promotedWrapper{overflow:hidden;height:0}"},{"rawString":".od-autoAlbumHeader-textWrapper{position:absolute;cursor:pointer}.xlg .od-autoAlbumHeader-textWrapper,.xxlg .od-autoAlbumHeader-textWrapper,.xxxlg .od-autoAlbumHeader-textWrapper,.xxxxlg .od-autoAlbumHeader-textWrapper{top:38px;font-size:14px;font-weight:400}.lg .od-autoAlbumHeader-textWrapper,.md .od-autoAlbumHeader-textWrapper,.sm .od-autoAlbumHeader-textWrapper{top:18px;font-size:14px;font-weight:400}.sm .od-autoAlbumHeader-textWrapper{top:20px;font-size:12px;font-weight:400}.od-autoAlbumHeader-text{display:inline-block}.xlg .od-autoAlbumHeader,.xxlg .od-autoAlbumHeader,.xxxlg .od-autoAlbumHeader,.xxxxlg .od-autoAlbumHeader{height:74px}.lg .od-autoAlbumHeader,.md .od-autoAlbumHeader,.sm .od-autoAlbumHeader{height:49px}.sm .od-autoAlbumHeader{height:46px}.od-autoAlbumHeader .ms-Icon{padding-bottom:2px;vertical-align:middle}"},{"rawString":".AllTagsHeader{position:relative;font-weight:100;white-space:nowrap;text-overflow:ellipsis}.xxlg .AllTagsHeader,.xxxlg .AllTagsHeader,.xxxxlg .AllTagsHeader{padding-top:22px;padding-bottom:12px;height:37px}.lg .AllTagsHeader,.md .AllTagsHeader,.sm .AllTagsHeader,.xlg .AllTagsHeader{padding-top:14px;height:28px}.AllTagsHeader-title,a.AllTagsHeader-regionLink{font-weight:100;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}html[dir=ltr] .AllTagsHeader-title,html[dir=ltr] a.AllTagsHeader-regionLink{float:left}html[dir=rtl] .AllTagsHeader-title,html[dir=rtl] a.AllTagsHeader-regionLink{float:right}[dir=ltr] .AllTagsHeader-title,[dir=ltr] a.AllTagsHeader-regionLink{margin-right:8px}[dir=rtl] .AllTagsHeader-title,[dir=rtl] a.AllTagsHeader-regionLink{margin-left:8px}.xxlg .AllTagsHeader-title,.xxlg a.AllTagsHeader-regionLink,.xxxlg .AllTagsHeader-title,.xxxlg a.AllTagsHeader-regionLink,.xxxxlg .AllTagsHeader-title,.xxxxlg a.AllTagsHeader-regionLink{font-size:28px;font-weight:100}.lg .AllTagsHeader-title,.lg a.AllTagsHeader-regionLink,.md .AllTagsHeader-title,.md a.AllTagsHeader-regionLink,.sm .AllTagsHeader-title,.sm a.AllTagsHeader-regionLink,.xlg .AllTagsHeader-title,.xlg a.AllTagsHeader-regionLink{font-size:21px;font-weight:100}.AllTagsHeader-subText{position:absolute;display:inline;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.xxlg .AllTagsHeader-subText,.xxxlg .AllTagsHeader-subText,.xxxxlg .AllTagsHeader-subText{bottom:16px}.lg .AllTagsHeader-subText,.md .AllTagsHeader-subText,.sm .AllTagsHeader-subText,.xlg .AllTagsHeader-subText{bottom:2px}"}]);});