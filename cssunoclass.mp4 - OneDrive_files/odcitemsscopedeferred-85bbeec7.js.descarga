define("@ms/items-view-addon-graph/lib/GraphAddonDeferred",["require","exports","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/controls/itemsCommandBarControl","@ms/items-view/lib/private/controls/itemsContextMenuControl","@ms/items-view/lib/private/addons/registerControlHandler","./handlers/controls/sharedWithMeRootItemContextMenu","./GraphAddonDataOnlyDeferred","./models/keys/SharedWithMeRootItemKeyFacet","./handlers/controls/sharedWithMeRootItemCommandBar","./models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/controls/sortedItemSetControl","./handlers/controls/sharedWithMeItemSet/sharedWithMeSortedItemSetControlHandler","@ms/items-view/lib/private/controls/openActionControl","@ms/items-view/lib/private/controls/groupedItemSetControl","./handlers/controls/sharedWithMeItemSet/sharedWithMeItemSetOpenActionControlHandler","./handlers/controls/sharedWithMeItemSet/sharedWithMeGroupedItemSetControlHandler","./handlers/controls/sharedWithMeItemSet/sharedWithMeUngroupedItemSetControlHandler","./models/keys/SharedWithMeGroupKeyFacets","./handlers/controls/grouping/groupBySharedByOpenActionControlHandler","./handlers/controls/grouping/groupByRelativeTimeOpenActionControlHandler","@ms/items-view/lib/private/operations/batch/asBatch","./models/keys/TopCollaboratorSetKeyFacet","@ms/items-view/lib/private/operations/getItemsOperation","./handlers/operations/people/getItemsOperationHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDeferred=n.createAddon(function(){return function(e){e(E.asBatch(function(){e(u.graphAddonDataOnlyDeferred);e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,r.itemsCommandBarControl)(f.sharedWithMeCommandBarControlHandler));e(s.registerControlHandler(a.sharedWithMeRootItemKeyFacet,i.itemsContextMenuControl)(o.sharedWithMeContextMenuControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,c.sortedItemSetControl)(h.sharedWithMeSortedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,p.openActionControl)(v.sharedWithMeItemSetOpenActionControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.groupedItemSetControl)(m.sharedWithMeGroupedItemSetControlHandler));e(s.registerControlHandler(l.sharedWithMeItemSetKeyFacet,d.unGroupedItemSetControl)(g.sharedWithMeUngroupedItemSetControlHandler));e(s.registerControlHandler(y.groupBySharedByKeyFacet,p.openActionControl)(b.groupBySharedByOpenActionControlHandler));e(s.registerControlHandler(y.groupByRelativeTimeKeyFacet,p.openActionControl)(w.groupByRelativeTimeOpenActionControlHandler));e(n.registerOperationHandler(S.topCollaboratorSetKeyFacet,x.getItemsOperation)(T.peopleGetItemsOperationHandler))}))}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeRootItemContextMenu",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/share/shareCommand","../../commands/addToOneDrive/addShortcutFromSharedWithMeCommand","../../commands/removeFromSharedListCommand"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function a(e,t){return{commands:u}}});
define("@ms/items-view-addon-graph/lib/commands/addToOneDrive/addShortcutFromSharedWithMeCommand",["require","exports","@ms/items-view/lib/private/models/Facet","react","../GraphCommands.resx","../../actions/addToOneDrive/AddToOneDriveAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addShortcutFromSharedWithMeCommand={action:r.createElement(s.AddToOneDriveAction,null),automationId:"addShortcutFromSharedWithMeCommand",title:i.default.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new n.Facet("AddShortcutFromSharedWithMe").id,name:i.default.AddShortcutFromSharedWithMe}});
define("@ms/items-view-addon-graph/lib/actions/addToOneDrive/AddToOneDriveAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view/lib/private/utilities/objects","@ms/items-view/lib/private/components/decorators/selectors","../../operations/addToOneDrive","@ms/items-view/lib/private/models/telemetry/getItemEngagement","../../controls/addToOneDriveActionControl","@ms/items-view/lib/private/store/actions/createActionCreator"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.createAsyncActionCreator(function(t){return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["../DeferredActions"],t,n)})];case 1:i=n.sent().addToOneDriveWithProgress;return[4,r(i(t))];case 2:return[2,n.sent()]}})})}}),d=s.createItemCacheComponent(function(e,t){var s=t.itemKey,a=t.addToOneDrive,h=void 0===a?f.addToOneDrive:a,p=o.getCurrentItemSetKey(e)||"";if(!s)return null;var d=e.dispatch,v=e.demandItemFacet(c.addToOneDriveActionControl,s),m=c.addToOneDriveActionControl.evaluate(v)(e,{itemKey:s,isAvailable:!1}).isAvailable;return r.createElement(i.Action,n.__assign({isAvailable:m,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e={itemSetKey:p};t=u.makeObject([s],function(){return e});return[4,d(h({items:t}))];case 1:n.sent();return[2]}})})}},l.getItemActionEngagement(e,{itemKey:s,engagement:{name:"AddToOneDrive_Folder",isIntentional:!0,extraData:{itemCount:1}}})))});t.ItemAddToOneDriveAction=s.connectToItemCache(function(){return{addToOneDrive:p}})(d);t.AddToOneDriveAction=a.withSelectedItems()(a.withCurrentItemAsFallback()(a.withExactlyOneItem()(t.ItemAddToOneDriveAction)))});
define("@ms/items-view-addon-graph/lib/operations/addToOneDrive",["require","exports","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/operations/progress"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveOperation=new n.Facet("addToOneDrive");t.addToOneDriveProgressKeyFacet=new r.ProgressKeyFacet("addToOneDrive");t.addToOneDrive=r.implementOperationWithProgress({operationTypeFacet:t.addToOneDriveOperation,progressKeyFacet:t.addToOneDriveProgressKeyFacet})});
define("@ms/items-view-addon-graph/lib/controls/addToOneDriveActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveActionControl=new n.ControlFacet("addToOneDriveActionControl")});
define("@ms/items-view-addon-graph/lib/commands/removeFromSharedListCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../actions/removeFromSharedList/RemoveFromSharedListAction","./GraphCommands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedListCommand={key:new r.Facet("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:o.default.removeFromSharedList,title:o.default.removeFromSharedListTooltip,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RemoveFromSharedListAction,null)),iconProps:{iconName:"Cancel"}}});
define("@ms/items-view-addon-graph/lib/actions/removeFromSharedList/RemoveFromSharedListAction",["require","exports","tslib","react","@ms/utilities-async/lib/cancel/CancelError","@ms/items-view/lib/private/components/withItemCache/WithItemCache","@ms/items-view/lib/private/components/confirmationDialog/ConfirmationDialog","@ms/items-view/lib/private/operations/progress","../../operations/removeItemsFromSharedList","@ms/items-view/lib/private/facets/ItemFacets","./RemoveFromSharedListBaseAction","./RemoveFromSharedList.resx","../../operations/RemoveFromSharedList.resx","../../operations/removeFromSharedList/removeFromSharedListProgressAddon","@ms/items-view/lib/private/components/decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.resolve,a=t.reject,f=t.onItemRemoved,l=t.itemKeys,p=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:u();return[4,f()];case 1:e.sent();return[2]}})})},d=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){a(new i.CancelError);return[2]})})};return r.createElement(s.WithItemCache,null,function(e){var t=e.itemCache,n=m(t,l),i=n.title,s=n.prompt;return r.createElement(o.ConfirmationDialog,{onCancel:d,onConfirm:p,yesText:h.default.removeFromSharedListConfirmButtonText,noText:c.default.removeFromSharedListCancelButtonText,defaultToYes:!0,title:i,prompt:s})})};return t})(r.PureComponent),m=function(e,t){if(t.length>1)return{title:c.default.itemsTitleWithAccess,prompt:c.default.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(f.folderFacet,t[0]);return{title:n?c.default.folderTitleWithAccess:c.default.fileTitleWithAccess,prompt:n?c.default.folderSubTextWithAccess:c.default.fileSubTextWithAccess}}return{title:"",prompt:""}},g=u.implementOperationWithProgress({operationTypeFacet:a.removeItemsFromSharedListOperation,progressKeyFacet:a.removeFromSharedListProgressKeyFacet,initializeBatch:function(){return p.removeFromSharedListProgressAddon}});t.RemoveFromSharedListAction=d.connectToItemCache(function(){return{removeFromSharedListWizard:v,removeItemsFromSharedList:g}})(l.RemoveFromSharedListBaseAction)});
define("@ms/items-view/lib/private/components/confirmationDialog/ConfirmationDialog",["require","exports","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Text","./ConfirmationDialog.resx","ODCItemsScopeDeferred_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.ConfirmationDialog_2;Object.defineProperty(t,"__esModule",{value:!0});t.ConfirmationDialog=function(e){var t=e.onConfirm,a=e.onCancel,f=e.defaultToYes,l=void 0!==f&&f,c=e.yesText,h=void 0===c?o.default.yes:c,p=e.noText,d=void 0===p?o.default.no:p,v=l?i.PrimaryButton:i.DefaultButton,m=l?i.DefaultButton:i.PrimaryButton;return n.createElement(r.Dialog,{dialogContentProps:{type:r.DialogType.close},onDismiss:a,hidden:!1,title:e.title,maxWidth:e.maxWidth},n.createElement(s.Text,{className:u.confirmTextLabel},e.prompt),n.createElement(r.DialogFooter,null,n.createElement(v,{"data-automationid":"confirmbutton",onClick:t},h),n.createElement(m,{"data-automationid":"cancelbutton",onClick:a,componentRef:function(e){e&&e.focus()}},d)))}});
define("@ms/items-view-addon-graph/lib/operations/removeItemsFromSharedList",["require","exports","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/operations/progress"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeItemsFromSharedListOperation=new n.Facet("removeItemsFromSharedList");t.removeFromSharedListProgressKeyFacet=new r.ProgressKeyFacet("removeItemsFromSharedList");t.removeItemsFromSharedList=r.implementOperationWithProgress({operationTypeFacet:t.removeItemsFromSharedListOperation,progressKeyFacet:t.removeFromSharedListProgressKeyFacet})});
define("@ms/items-view-addon-graph/lib/actions/removeFromSharedList/RemoveFromSharedListBaseAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view/lib/private/utilities/objects","@ms/items-view/lib/private/components/withAction/WithAction","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/components/decorators/selectors","../../controls/removeFromSharedListActionControl","../../operations/removeItemsFromSharedList","@ms/items-view/lib/private/models/telemetry/getItemEngagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRemoveFromSharedAction=i.createItemCacheComponent(function(e,t){var i=t.itemKeys,f=t.removeFromSharedListWizard,p=t.removeItemsFromSharedList,d=void 0===p?c.removeItemsFromSharedList:p,v=s.getCurrentItemSetKey(e)||"";if(0===i.length)return null;for(var m=i.length<=200,g=f,y=0,b=i;y<b.length;y++){var w=b[y],E=e.demandItemFacet(l.removeFromSharedActionListControl,w);l.removeFromSharedActionListControl.evaluate(E)(e,{itemKey:w,isAvailable:!1}).isAvailable||(m=!1)}var S=e.dispatch,x=function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e={itemSetKey:v};t=o.makeObject(i,function(){return e});return[4,S(d({items:t}))];case 1:n.sent();return[2]}})})},T=u.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{onItemRemoved:x,itemKeys:i}))});return r.createElement(a.Action,n.__assign({isAvailable:m,onExecute:T},h.getItemActionEngagement(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:i.length}}})))});t.RemoveFromSharedListBaseAction=f.withSelectedItems()(t.ItemRemoveFromSharedAction)});
define("@ms/items-view-addon-graph/lib/controls/removeFromSharedListActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromSharedActionListControl=new n.ControlFacet("removeFromShardListActionControl")});
define("@ms/items-view-addon-graph/lib/operations/removeFromSharedList/removeFromSharedListProgressAddon",["require","exports","tslib","@ms/utilities-strings/lib/index","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/controls/progressControl","@ms/items-view/lib/private/operations/progress","../RemoveFromSharedList.resx","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/addons/registerControlHandler","../removeItemsFromSharedList"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[i.ProgressPhase.started]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeStartedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.completed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeCompletedItemsTitle,u.default.removeCompletedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.failed]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c[i.ProgressPhase.canceled]=function(e){return r.formatToArray(r.getLocalizedCountValue(u.default.removeFailedItemsTitle,u.default.removeFailedItemsTitleIntervals,e)||"",e)},c);t.removeFromSharedListProgressAddon=a.createAddon(function(){return function(e){e(f.registerControlHandler(l.removeFromSharedListProgressKeyFacet,s.progressControl)(f.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r,i=o.getOverallSimpleProgressBreakdown(e,t),s=i.phase,u=i.count;r=h[s](u);return n.__assign({},r&&"item"!==t.format?{title:r}:{})}});
define("@ms/items-view-addon-graph/lib/GraphAddonDataOnlyDeferred",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/addons/registerControlHandler","./models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/operations/createFolder","@ms/items-view/lib/private/operations/deleteItems","@ms/items-view/lib/private/operations/renameItem","@ms/items-view/lib/private/operations/uploadItems","@ms/items-view/lib/private/controls/createFolderActionControl","@ms/items-view/lib/private/controls/renameActionControl","@ms/items-view/lib/private/controls/deleteActionControl","@ms/items-view/lib/private/controls/uploadItemsActionControl","@ms/items-view/lib/private/controls/downloadItemsActionControl","@ms/items-view/lib/private/controls/followItemActionControl","./handlers/operations/driveItem/createFolderOperationHandler","./handlers/operations/driveItem/deleteItemsOperationHandler","./handlers/operations/driveItem/renameItemOperationHandler","./handlers/operations/driveItem/uploadItemsOperationHandler","./handlers/controls/driveItem/createFolderActionControlHandler","./handlers/controls/driveItem/renameItemActionControlHandler","./handlers/controls/driveItem/deleteItemsActionControlHandler","./handlers/controls/driveItem/uploadItemsActionControlHandler","./handlers/controls/driveItem/downloadItemsActionControlHandler","./handlers/controls/driveItem/getDefaultShareLinkActionControlHandler","./handlers/controls/driveItem/followItemActionControlHandler","./handlers/controls/driveItem/permissionGrantActionControlHandler","@ms/items-view/lib/private/controls/getDefaultShareLinkActionControl","@ms/items-view/lib/private/controls/permissionInviteActionControl","./models/keys/DriveFollowedItemKeyFacet","./handlers/operations/driveItem/followItemOperationHandler","@ms/items-view/lib/private/operations/followItem/FollowFacet","@ms/items-view/lib/private/controls/itemsViewSearchControl","./handlers/controls/itemsViewSearchControl","./models/keys/DriveItemSetKeyFacet","./models/keys/SearchItemSetKeyFacet","@ms/items-view/lib/private/controls/filteredItemSetControl","./handlers/controls/driveItemSetFilteredItemSetControlHandler","@ms/items-view/lib/private/operations/moveCopy/moveCopyItemsOperation","./handlers/operations/driveItem/moveCopyItemsOperationHandler","@ms/items-view/lib/private/controls/createFolderDialogControl","./handlers/controls/driveItem/createFolderDialogControlHandler","@ms/items-view/lib/private/operations/configuration/readConfiguration","./models/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/pageLoad","@ms/utilities-async/lib/decorators/asModuleLoad","./models/keys/DriveActivityItemKeyFacet","@ms/items-view/lib/private/operations/getItemsOperation","./handlers/operations/driveActivityItem/getItemsOperationHandler","@ms/items-view/lib/private/operations/batch/asBatch","./operations/addToOneDrive","./handlers/operations/addToOneDrive/addToOneDriveOperationHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Z=V.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./handlers/operations/driveItem/deleteItemsBatchedOperationHandler"],t,n)})},{chunkName:"addon-graph-deferredoperations"});t.graphAddonDataOnlyDeferred=r.createAddon(function(){return function(e){var t=e(z.readConfiguration({useBatchedDeleteConfiguration:W.useBatchedDeleteConfigurationFacet})).useBatchedDeleteConfiguration;e(Q.asBatch(function(){e(i.registerControlHandler(H.driveItemSetKeyFacet,D.itemsViewSearchControl)(P.driveItemSearchControlHandler));e(i.registerControlHandler(B.searchItemSetKeyFacet,D.itemsViewSearchControl)(P.searchItemSearchControlHandler));e(i.registerControlHandler(H.driveItemSetKeyFacet,j.filteredItemSetControl)(F.driveItemSetFilteredItemSetControlHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,o.createFolderOperation)(m.driveItemCreateFolderOperationHandler));e(t?r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(X.waitForPageLoad())];case 1:t.sent();return[4,Z()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):r.registerOperationHandler(s.driveItemKeyFacet,u.deleteItemsOperation)(g.driveItemDeleteItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,a.renameItemOperation)(y.driveItemRenameItemOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,f.uploadItemsOperation)(b.driveItemUploadItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,I.moveCopyItemsOperation)(q.driveItemMoveCopyItemsOperationHandler));e(r.registerOperationHandler(s.driveItemKeyFacet,G.addToOneDriveOperation)(Y.addToOneDriveOperationHandler));e(i.registerControlHandler(s.driveItemKeyFacet,l.createFolderActionControl)(w.driveItemCreateFolderActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,R.createFolderDialogControl)(U.driveItemCreateFolderDialogControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,c.renameActionControl)(E.driveItemRenameItemActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,h.deleteActionControler)(S.driveItemDeleteItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,p.uploadItemsActionControl)(x.driveItemUploadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,L.shareLinkActionControl)(N.driveItemDefaultShareLinkControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,A.permissionInviteActionControl)(k.driveItemPermissionGrantControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,d.downloadItemsActionControlFacet)(T.driveItemDownloadItemsActionControlHandler));e(i.registerControlHandler(s.driveItemKeyFacet,v.followItemActionControl)(C.driveItemfollowItemActionControlHandler));e(r.registerOperationHandler(O.driveFollowedItemKeyFacet,_.followItemOperation)(M.driveItemFollowItemOperationHandler));e(r.registerOperationHandler($.driveActivityItemKeyFacet,J.getItemsOperation)(K.driveActivityItemGetItemsOperationHandler))}))}})});
define("@ms/items-view/lib/private/operations/createFolder",["require","exports","../models/Facet","../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderOperation=new n.Facet("createFolder");t.createFolder=r.implementOperation({operationTypeFacet:t.createFolderOperation})});
define("@ms/items-view/lib/private/operations/uploadItems",["require","exports","tslib","../store/actions/implementOperation","../models/Facet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsOperation=new i.Facet("uploadItems");t.uploadItems=r.implementOperation({operationTypeFacet:t.uploadItemsOperation});var s=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(r.ItemOperationError);t.UploadItemOperationError=s});
define("@ms/items-view/lib/private/controls/createFolderActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderActionControl=new n.ControlFacet("createFolderActionControl")});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/createFolderOperationHandler",["require","exports","tslib","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/facets/SetFacets","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/models/items/ItemResolver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.folders,l=r.driveItemKeyFacet.deserialize(t),c=l.endpoint,h=l.driveId,p=l.itemId,d=Object.keys(i)[0],v=i[d].progressItemKey,m=s.getDriveUrl(l);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=s.getDriveItemUrl(l)+"/children";g={name:d,folder:{},"@microsoft.graph.conflictBehavior":"rename"};h&&p&&(g.parentReference={driveId:h,id:p});return[4,e(s.getRawData({url:i,driveUrl:m,method:"POST",body:g,qosName:"createFolder",endpoint:c}))];case 1:y=T.sent();b=r.driveItemKeyFacet.serialize({endpoint:c,driveId:h,itemId:y.id});w=new f.ItemResolver;v&&w.resolveItems({items:(E={},E[v]=n.__assign({},o.createdItemFacet.pack({itemKey:b})),E)});w.invalidateItems({items:(S={},S[t]=[u.defaultChildItemSetFacet],S)});w.resolveItems({items:(x={},x[b]=n.__assign({},a.getDriveItemFacets({driveItem:y,parentFolderItemKey:t,endpoint:c})),x)});e(w.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/deleteItemsOperationHandler",["require","exports","tslib","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/ItemFacets"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=r.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:r=s.getDriveItemUrl(i);return[4,e(s.getRawData({url:r,method:"DELETE",qosName:"deleteItem",endpoint:i.endpoint}))];case 1:n.sent();e(o.invalidateItems({items:(a={},a[t]=[u.deletedFacet],a)}));return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/renameItemOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/store/actions/implementOperation","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/ErrorFacets","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/operations/readItem","@ms/items-view/lib/private/models/items/ItemResolver","@ms/odsp-graph/lib/models/error/Error"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,s=e.options.names,p=i.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:i=Object.keys(s)[0];d=s[i],v=d.newName,m=d.newExtension;g=o.getDriveItemUrl(p);y=o.getDriveUrl(p);b=e(l.readItem({fileName:u.fileNameFacet},t)).fileName;w="string"==typeof m?m:b&&b.extension||"";return[4,e(o.getRawData({url:g,driveUrl:y,method:"PATCH",body:{name:""+v+w},qosName:"renameItem",endpoint:p.endpoint})).then(function(r){var i,s,o=new c.ItemResolver;o.invalidateItems({items:(i={},i[t]=[u.displayNameFacet],i)});o.resolveItems({items:(s={},s[t]=n.__assign(n.__assign({},u.displayNameFacet.pack(r.name)),u.fileNameFacet.pack(f.getFileName(r.name||"",!!r.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof h.GraphError&&e.status===r.STATUS_CODE_ZERO)throw new r.ItemOperationError({facets:n.__assign({},a.offlineErrorFacet.pack({})),innerError:e});throw e})];case 1:E.sent();return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/uploadItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","./uploadDriveItem"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r(i.uploadDriveItem(e))];case 1:t=n.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/uploadDriveItem",["require","exports","tslib","@ms/odsp-graph/lib/services/upload/Uploader","@ms/odsp-graph/lib/services/upload/UploadService","@ms/odsp-graph/lib/services/upload/UploadWaiter","@ms/odsp-graph/lib/services/upload/UploadStateMachine","@ms/odsp-graph/lib/services/upload/ActivityBandwidthVerifier","../../../utilities/Data","../../../utilities/Auth","@ms/odsp-graph/lib/models/error/Error","../../../utilities/getDriveItemFacets","@uifabric/utilities/lib/Async","@ms/items-view/lib/private/store/middleware/RunOnceMiddleware","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/operations/uploadItems","@ms/items-view/lib/private/operations/readItem","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/FileSystemFacets","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/facets/SetFacets","@ms/odsp-utilities/lib/async/Promise","@ms/items-view/lib/private/utilities/async/CancelError","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/ErrorFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=p.asOnceOnly(function(){return new s.UploadWaiter({},{})}),L=p.asOnceOnly(function(e){var t=e(a.getDataRequestor).dataRequestor,s=(function(e){n.__extends(t,e);function t(t){return e.call(this,t,{performanceNow:u.performanceNow})||this}return t})(u.ActivityBandwidthVerifier),f=new i.UploadService({},{dataRequestor:t}),l=new o.UploadStateMachine({},{activityBandwidthVerifierType:s,uploadService:f});return new r.Uploader({},{uploadService:f,uploadStateMachine:l})}),A=0;t.uploadDriveItem=function(e){var t=this,r=e.itemKey,i=e.options.sourceEntries,s=d.driveItemKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId,f=Object.keys(i)[0],l=i[f],h=l.progressItemKey,p=l.conflictResolution,v=void 0===p?"fail":p;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,l,p,g,x,T,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:if(!(t=e(m.readItem({sourceFile:y.sourceFileFacet},f)).sourceFile))throw new Error("No source file for Graph upload.");i=a.getDriveItemUrl(s)+":";l=a.getDriveUrl(s);h&&e(b.resolveItems({items:(T={},T[h]=n.__assign({},w.progressSizeFacet.pack({total:t.size,current:0})),T)}));return[4,e(O({progressItemKey:h,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:v,endpoint:o}))];case 1:p=A.sent();g=d.driveItemKeyFacet.serialize({endpoint:o,driveId:u,itemId:p.id});x=new N.ItemResolver;h&&x.resolveItems({items:(C={},C[h]=n.__assign(n.__assign({},w.createdItemFacet.pack({itemKey:g})),E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t.size}})),C)});x.invalidateItems({items:(k={},k[r]=[S.defaultChildItemSetFacet],k)});x.resolveItems({items:(L={},L[g]=n.__assign({},c.getDriveItemFacets({driveItem:p,parentFolderItemKey:r,endpoint:o})),L)});return[2,{itemResolver:x,driveItem:p,itemKey:g}]}})})}};function O(e){var t=this,r=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,c,p,d,m,y,S,N,O,M;return n.__generator(this,function(_){switch(_.label){case 0:t=e(L);c=e(k);return[4,e(f.getSessionToken(u,o))];case 1:p=_.sent();d=new h.Async;m=0;y=d.debounce(function(t){var n;if(t>m){r&&e(b.resolveItems({items:(n={},n[r]=E.pack({progressSize:w.progressSizeFacet},{progressSize:{current:t}}),n)}));m=t}},300,{leading:!1});S=e(g.readItems(function(e){return e.demandItemFacet(w.cancelSourceFacet,r)}));N=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++A},accessToken:p,fileName:i.name,content:i,itemUrl:s,onProgress:y,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return c.wait(e)},select:"*,sharepointIds"});O=S?S.token.subscribe(function(){N.cancel()}):void 0;_.label=2;case 2:_.trys.push([2,4,5,6]);return[4,N];case 3:return[2,_.sent()];case 4:M=_.sent();if(x.default.isCanceled(M))throw new T.CancelError;throw new v.UploadItemOperationError({facets:n.__assign({},l.getErrorResolution(M,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return C.accessDeniedErrorFacet.pack({});case"nameAlreadyExists":case 409:return C.conflictErrorFacet.pack({supportsRename:!0})}})||E.pack({},{})),innerError:M});case 5:O&&O();d.dispose();return[7];case 6:return[2]}})})}}});
define("@ms/odsp-graph/lib/services/upload/Uploader",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,o=n.__rest(e,["conflictBehavior"]),u=o.qosData,a=new s.Qos({name:"VroomUploader.upload",extraData:u});return this._uploadState(o,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){a.end({resultType:s.ResultTypeEnum.Success});return e},function(e){a.end({resultType:r.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:e.message,resultCode:i.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},u),i.getQosExtraDataFromError(e))});return r.default.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,i=t.sessionUrl,s=t.item,o=t.error;if(s)return r.default.resolve(s);if(o){var u=void 0;i&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:i}).then(function(){},function(){}));return r.default.resolve(u).then(function(){return r.default.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e})();t.Uploader=o;t.default=o});
define("@ms/odsp-graph/lib/services/upload/UploadService",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,i=e.headers,o=e.allowCookies,u=e.accessToken,a=e.fileName,f=e.fileSize,l=e.lastModifiedDate,c=e.eTag,h=e.conflictBehavior,p=e.ignoreCookieAuth,d={item:n.__assign(n.__assign({},s(r)?{"@microsoft.graph.conflictBehavior":h}:{"@name.conflictBehavior":h}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=n.__assign(n.__assign(n.__assign(n.__assign({},c?{"If-Match":c}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),i);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(a)+":/"+(s(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:o,accessToken:u,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:n.__assign({conflictBehavior:h,fileSize:f},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,i=e.headers,s=e.sessionUrl,o=e.startByte,u=e.endByte,a=e.fileSize,f=e.content,l=e.timeout,c=e.onProgress,h=e.select,p=n.__assign({"Content-Range":"bytes "+o+"-"+Math.max(u-1,o)+"/"+a},i),d=!0,v=this._dataRequestor.send({path:s+(h?(s.indexOf("?")>-1?"&":"?")+"$select="+h:""),needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:p,postData:f,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&d&&c(o+e.loaded)},qosExtraData:n.__assign(n.__assign({},t),{startByte:o,endByte:u,fileSize:a})}),m=new r.default(function(){d=!1;v.cancel()});v.done(function(e){d=!1;m.complete(e)},function(e){d=!1;m.error(e)});return m.getPromise()};e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,o=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=s(r)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:n.__assign({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:n.__assign({},t)})};return e})();t.UploadService=i;function s(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}});
define("@ms/odsp-graph/lib/services/upload/UploadWaiter",["require","exports","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){var s=t.asyncType,o=void 0===s?n.default:s,u=t.eventGroupType,a=void 0===u?r.default:u,f=t.targetWindow,l=void 0===f?window:f,c=this._scope=new i.default;this._async=c.attach(new o(this));this._events=c.attach(new a(this));this._targetWindow=l}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.wait=function(e){var t,n=e.duration,r=e.allowWakeWhenOnline,i=void 0!==r&&r,u=this._async,a=this._events,f=this._targetWindow,l=new o.default(function(){u.clearTimeout(t)}),c=function(){i&&l.complete()};t=u.setTimeout(function(){l.complete()},n);a.on(f,"online",c);return l.getPromise().then(function(){a.off(f,"online",c)},function(e){a.off(f,"online",c);return s.default.reject(e)})};return e})();t.UploadWaiter=u});
define("@ms/odsp-graph/lib/services/upload/UploadStateMachine",["require","exports","tslib","../../models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=Math.pow(2,1/4),a=(function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,u=void 0===o||o,a=t.maximumFragmentSize,f=void 0===a?62914560:a;this._shouldCancelOnCompleteFailure=u;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=f}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.createSession",extraData:o});return this._uploadService.createSession({qosData:o,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(a){return s._handleCreateSessionErrorState(e,s._getState(t,{error:a})).then(function(e){e.error?u.end({resultType:i.ResultTypeEnum.Failure,error:a.message,resultCode:r.getResultCodeFromError(a),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(a))}):u.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getStatus",extraData:o});return this._uploadService.getStatus({qosData:o,sessionUrl:t.sessionUrl}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var s=this,o=e.qosData,u=e.content.size,a=this._getNextRange({fileSize:u,nextExpectedRanges:t.nextExpectedRanges}),f=new i.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(a&&a.start<u?t.allowStreaming?this._uploadStreamState({nextRange:a},e,t):this._uploadFragmentState({nextRange:a},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return s._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?f.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(t),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(t))}):f.end({resultType:i.ResultTypeEnum.Success});return e});f.end({resultType:i.ResultTypeEnum.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return s.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,s){var a=this,f=e.nextRange,l=t.onProgress,c=t.headers,h=t.content,p=t.content.size,d=t.qosData,v=t.select,m=s.sessionUrl,g=s.speed,y=void 0===g?1/8:g,b=f.start,w=f.end;l&&l(b);var E,S,x=this._getFragmentSize(y),T=Math.min(b+x,w),N=new o.default(function(){E&&E.cancel()}),C=y>1/1920?6e4:3e5,k=new this._activityBandwidthVerifierType({timeout:C,totalBytes:T-b}),L=new i.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign(n.__assign({},d),{startByte:b,endByte:T,fileSize:p,speed:y,fragmentSize:x})});(E=this._uploadService.uploadFragment({qosData:d,headers:c,sessionUrl:m,startByte:b,endByte:T,fileSize:p,content:h.slice(b,T),timeout:C,select:v,onProgress:function(e){S=e;if(y>1/1920&&!k.doesActivityHaveRemainingCapacity(e-b)){L.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign(n.__assign({},d),{lastByte:e})});N.complete(a._getState(s,{speed:Math.max(.5*y,1/1920),nextExpectedRanges:void 0}));E&&E.cancel()}l&&l(e)}}).then(function(e){l&&l(T);L.end({resultType:i.ResultTypeEnum.Success});return s=a._isItem(e)?a._getState(s,{item:e}):a._getState(s,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(k.didActivityHaveExtraCapacity()?y*u:y,1)})},function(e){L.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},d),r.getQosExtraDataFromError(e)),{lastByte:S})});return a._getState(s,{error:e})})).done(function(e){N.complete(e)});return N.getPromise()};e.prototype._uploadStreamState=function(e,t,s){var u=this,a=e.nextRange,f=t.headers,l=t.onProgress,c=t.content,h=t.content.size,p=t.qosData,d=s.sessionUrl,v=a.start,m=a.end,g=Math.min(m-v,this._maximumFragmentSize),y=v+g;l&&l(v);var b,w=new o.default(function(){b&&b.cancel()}),E=new i.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign(n.__assign({},p),{startByte:v,endByte:y,fileSize:h,fragmentSize:g})});(b=this._uploadService.uploadFragment({qosData:p,headers:f,sessionUrl:d,startByte:v,endByte:y,fileSize:h,content:c.slice(v,y),timeout:864e5,onProgress:function(e){l&&l(e)}}).then(function(e){l&&l(y);E.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges})},function(e){E.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign(n.__assign({},p),r.getQosExtraDataFromError(e)),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:a},t,u._getState(s,{error:e}))})).done(function(e){w.complete(e)});return w.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var s=this,o=e.qosData,u=e.onProgress;u&&u(e.content.size);var a=new i.Qos({name:"VroomUploader.commit",extraData:o});return this._uploadService.commit({qosData:o,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){a.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{item:e})},function(e){return s._handleCommitErrorState(s._getState(t,{error:e})).then(function(t){a.end({resultType:t.error?i.ResultTypeEnum.Failure:i.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return s.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.cancelSession",extraData:o});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{sessionUrl:void 0})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?s.default.resolve(n._getState(t,{allowStreaming:!1})):s.default.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return s.default.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getItemIfCompleted",extraData:o});return this._uploadService.getItem({qosData:o,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){u.end({resultType:i.ResultTypeEnum.Success});return e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?s._getState(t,{item:n,error:void 0}):s._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},o),r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,i=r.getErrorResolution(n,t);void 0===i&&(i=s.default.resolve(e));return i};e.prototype._promptForConflictBehaviorState=function(e,t,o){var u=this,a=t.onPromptForConfictBehavior,f=t.qosData,l=new i.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:f});return s.default.resolve().then(function(){return a(e)}).then(function(e){l.end({resultType:i.ResultTypeEnum.Success,extraData:f});return u._getState(o,{error:void 0,conflictBehavior:e})},function(t){l.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign(n.__assign({},f),r.getQosExtraDataFromError(t))});return u._getState(o,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,o=e.allowWakeWhenOnline,u=t.onWait,a=t.qosData,f=new i.Qos({name:"VroomUploader.wait",extraData:a});return s.default.resolve(u({duration:n,allowWakeWhenOnline:o})).then(function(){f.end({resultType:i.ResultTypeEnum.Success})},function(e){f.end({resultType:s.default.isCanceled(e)?i.ResultTypeEnum.Success:i.ResultTypeEnum.Failure,error:e&&e.message,resultCode:r.getResultCodeFromError(e)});return s.default.reject(e)})};e.prototype._getState=function(e,t){return n.__assign(n.__assign({},e),t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=62914560*e;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e})();t.UploadStateMachine=a});
define("@ms/odsp-graph/lib/services/upload/ActivityBandwidthVerifier",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=(function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e})();t.ActivityBandwidthVerifier=n});
define("@ms/items-view/lib/private/facets/FileSystemFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.entryBatchFacet=new n.Facet("entryBatch");t.sourceFileFacet=new n.Facet("sourceFile")});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/createFolderActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../../utilities/hasPermission"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canCreateFolderFacet,n)}}}})});
define("@ms/items-view-addon-graph/lib/utilities/hasPermission",["require","exports","tslib","../models/facets/SharedFacet","../models/facets/CommandsFacets","../models/keys/CommandsItemKeyFacet","../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","@ms/items-view/lib/private/facets/DocumentFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canAddToOneDriveFacet=new u.ComputedItemFacet("addToOneDrive",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.addToOneDriveFacet}))});t.canCreateFolderFacet=new u.ComputedItemFacet("canCreateFolder",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createFolderFacet}))});t.canCreateLinkFacet=new u.ComputedItemFacet("canCreateLink",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.createLinkFacet}))});t.canDeleteFacet=new u.ComputedItemFacet("canDelete",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.deleteFacet}))});t.canDownloadFacet=new u.ComputedItemFacet("canDownload",function(e,t){return!e.demandItemFacet(a.oneNoteFacet,t.itemKey)&&f(e,n.__assign(n.__assign({},t),{commandFacet:i.downloadFacet}))});t.canInviteFacet=new u.ComputedItemFacet("canInvite",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.inviteFacet}))});t.canMoveFacet=new u.ComputedItemFacet("canMove",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.moveFacet}))});t.canUseOfficeLensFacet=new u.ComputedItemFacet("canUseOfficeLens",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.officeLensFacet}))});t.canRenameFacet=new u.ComputedItemFacet("canRename",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.renameFacet}))});t.canUploadFacet=new u.ComputedItemFacet("canUpload",function(e,t){return f(e,n.__assign(n.__assign({},t),{commandFacet:i.uploadFacet}))});function f(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(o.driveItemKeyFacet,n);if(!i)return!1;var u=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,s.commandsItemKeyFacet.serialize({endpoint:u,driveId:a}));return!!f&&!!f.roles&&l(e,{itemKey:n,oneOfRequiredRoles:f.roles})}t.hasPermission=f;function l(e,t){var n=t.itemKey;return c(e,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:p(e,n)})}t.hasRequiredItemRole=l;function c(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1}t.hasRequiredRole=c;function h(e,t){var n=e.demandItemFacet(r.sharedFacet,t);return!n||!n.effectiveRoles||!n.owner}t.isOwner=h;function p(e,t){if(h(e,t))return["read","write","owner"];var n=e.demandItemFacet(r.sharedFacet,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}t.getEffectiveItemRoles=p});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/renameItemActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/utilities/fileSystem/nameValidator","../../../utilities/hasPermission"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canRenameFacet,n),validator:r.nameValidator}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/deleteItemsActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../../utilities/hasPermission"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canDeleteFacet,n)}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/uploadItemsActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../../utilities/hasPermission"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canUploadFacet,n)}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/downloadItemsActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","../../../utilities/hasPermission","@ms/odsp-graph/lib/models/error/Error","@ms/items-view/lib/private/store/actions/implementOperation","@ms/items-view/lib/private/facets/ErrorFacets","@ms/odsp-graph/lib/models/error/Error"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDownloadItemsActionControlHandler=r.createControlHandler()(h);function h(){return function(e){return p}}t.getDownloadItemActionControlHandler=h;function p(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(o.folderFacet,r))return{};var h=e.demandItemFacet(i.driveItemKeyFacet,r),p=h?s.getDriveItemUrl(h):void 0,d=h?s.getDriveUrl(h):void 0,v=h&&h.endpoint||"";return{isAvailable:e.demandItemFacet(u.canDownloadFacet,r),getDownloadData:p&&d?function(){return(function(e){var t=this,r=e.itemUrl,i=e.driveUrl,o=e.endpoint;return function(u){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,u(s.getRawData({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:t=n.sent();if(!(h=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:h}];case 2:if((p=n.sent())instanceof a.GraphError){d=c.getErrorResolution(p,function(e,t){switch(e){case"unauthenticated":case 401:return l.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return l.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return l.accessDeniedErrorFacet.pack({});default:return l.offlineErrorFacet.pack({})}});throw new f.ItemOperationError({innerError:p,facets:d})}throw p;case 3:return[2]}})})}})({itemUrl:p,driveUrl:d,endpoint:v})}:void 0}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/getDefaultShareLinkActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDefaultShareLinkControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getDefaultShareLinkActionControlHandler=o;function u(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=e.driveItem))return[3,2];i=s.getDriveItemUrl(t)+"/invite";o=s.getDriveUrl(t);return[4,r(s.getRawDataWithCache({url:i,driveUrl:o,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(u=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:u.value[0].link.webUrl,scope:u.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:o})}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/followItemActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemfollowItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(){return{}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/permissionGrantActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPermissionGrantControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getPermissionGrantActionControlHandler=o;function u(e,t){var r=t.itemKey,o=t.link,u=t.recipients,a=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h,p,d,v;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,o=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");u=t.endpoint;f=btoa(i);a="u!"+f.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");l=o.map(function(e){return{email:e}});c={recipients:l,roles:["read"]};h=u.replace("v1.0","beta");p=h+"/shares/"+a+"/permission/grant";return[4,r(s.getRawDataWithCache({url:p,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:c}))];case 1:d=n.sent();v=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:v}]}})})}})({driveItem:a,link:o,recipients:u})}}}});
define("@ms/items-view/lib/private/controls/getDefaultShareLinkActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareLinkActionControl=new n.ControlFacet("getDefaultShareLinkActionControl")});
define("@ms/items-view/lib/private/controls/permissionInviteActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteActionControl=new n.ControlFacet("permissionInviteActionControl")});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/followItemOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/DriveFollowedItemKeyFacet","../../../models/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/configuration/readConfiguration","@ms/items-view/lib/private/operations/getItems","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/facets/ProgressFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemFollowItemOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,p=r.isFollowed,d=r.progressItemKey,v=u.driveFollowedItemKeyFacet.deserialize(t),m=v.driveItemKey,g=m.itemId,y=void 0===g?"":g,b=i.getDriveUrl(m);return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,g,w,E,S,x,T,N;return n.__generator(this,function(C){switch(C.label){case 0:t=e(f.readConfiguration({saveForLaterGraphEndpoint:a.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint;r=new o.ItemResolver;g=u.driveFollowedItemKeyFacet.serialize(v);w=t||m.endpoint;d&&e(l.resolveItems({items:(x={},x[d]=n.__assign({},h.sourceItemFacet.pack({itemKey:c.driveItemKeyFacet.serialize(m)})),x)}));E=p?{url:w+"/drives/"+m.driveId+"/items/"+y+"/follow",method:"POST",qosName:"followItem"}:{url:w+"/drives/"+m.driveId+"/following/"+y,method:"DELETE",qosName:"unfollowItem"};C.label=1;case 1:C.trys.push([1,3,,4]);return[4,e(i.getRawData({url:E.url,driveUrl:b,method:E.method,qosName:E.qosName,endpoint:w}))];case 2:C.sent();r.invalidateItems({items:(T={},T[g]=[s.isFollowedFacet],T)});r.resolveItems({items:(N={},N[g]=n.__assign({},s.isFollowedFacet.pack(p||void 0)),N)});e(r.execute());return[3,4];case 3:S=C.sent();throw new Error(S.message);case 4:return[2]}})})}})});
define("@ms/items-view/lib/private/controls/itemsViewSearchControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewSearchControl=new n.ControlFacet("itemsViewSearchControl")});
define("@ms/items-view-addon-graph/lib/handlers/controls/itemsViewSearchControl",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../models/keys/DriveItemSetKeyFacet","../../models/keys/SearchItemSetKeyFacet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e,t){return s.searchItemSetKeyFacet.serialize(n.__assign(n.__assign({},{driveItemKey:e.driveItemKey}),t?{searchTerm:t}:{searchTerm:void 0}))}t.driveItemSearchControlHandler=r.createControlHandler()(u);t.searchItemSearchControlHandler=r.createControlHandler()(u);function u(){return function(e){return function(e,t){var n,r=t.itemKey,u=e.demandItemFacet(i.driveItemSetKeyFacet,r);if(u)n=function(e){return u?o(u,e):void 0};else{var a=e.demandItemFacet(s.searchItemSetKeyFacet,r);n=function(e){return a?o(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItemSetFilteredItemSetControlHandler",["require","exports","tslib","../../models/keys/DriveItemSetKeyFacet","../../models/keys/SearchItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/models/itemSets/filters/itemExtensionFilterHandler","@ms/items-view/lib/private/models/itemSets/filters/itemTypeFilterHandler"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetFilteredItemSetControlHandler=s.createControlHandler()(function(){return function(e){return a}});function a(e,t){var s=t.handlers,a=t.itemKey,f=e.demandItemFacet(r.driveItemSetKeyFacet,a),l=e.demandItemFacet(i.searchItemSetKeyFacet,a);if(s&&(f||l)){for(var c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===u.itemPhotoTypeFilterHandler.key)c.push("photo");else if(d.key===u.itemVideoTypeFilterHandler.key)c.push("video");else if(d.key===u.itemFolderTypeFilterHandler.key)c.push("folder");else if(d.key===u.itemOneNoteFilterHandler.key)c.push("onenote");else if(d.key===u.itemNonPhotoTypeFilterHandler.key)c.push("!photo");else if(d.key===u.itemNonVideoTypeFilterHandler.key)c.push("!video");else if(d.key===u.itemNonFolderTypeFilterHandler.key)c.push("!folder");else if(d.key===u.itemNonOneNoteFilterHandler.key)c.push("!onenote");else{var v=o.getExtensionFilterFromFilterHandler(d);v&&c.push(v)}}if(f)return{itemKey:r.driveItemSetKeyFacet.serialize(n.__assign(n.__assign({},f),{extFilters:c}))}}return{}}});
define("@ms/items-view/lib/private/operations/moveCopy/moveCopyItemsOperation",["require","exports","tslib","../../models/Facet","../../store/actions/implementOperation","../progress"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItemsOperation=new r.Facet("moveCopyItems");t.moveCopyItemsProgressKeyFacet=new s.ProgressKeyFacet("moveCopyItems");var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(i.ItemOperationError);t.MoveCopyItemOperationError=o});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/moveCopyItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/store/actions/implementOperation","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/operations/moveCopy/moveCopyItemsOperation","@ms/items-view/lib/private/facets/ErrorFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data","@ms/items-view/lib/private/operations/readItems","@ms/odsp-graph/lib/models/error/Error","@ms/items-view/lib/private/facets/SetFacets","../../../utilities/UrlConstants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemMoveCopyItemsOperationHandler=r.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,m=Object.keys(r)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var g,y,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:if(!e(h.readItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)})))throw new Error("Source item does not have a driveItem key");g=r[m],y=g.isMove,b=g.conflictBehavior,w=g.progressItemKey;E=l.driveItemKeyFacet.deserialize(t);return[4,e(s.demandItems(function(e){return e.demandItemFacet(l.driveItemKeyFacet,m)}))];case 1:if(!(S=M.sent()))throw new Error("Unable to get metadata for destination item.");x=c.getDriveItemUrl(S);T=c.getDriveUrl(S);N=S.endpoint;M.label=2;case 2:M.trys.push([2,4,,5]);return[4,e(c.getRawData({url:x+(y?"":"/copy"),driveUrl:T,method:y?"PATCH":"POST",body:{parentReference:{id:E.itemId||v.ROOT_ITEM_ID,driveId:E.driveId||""},"@microsoft.graph.conflictBehavior":b},qosName:y?"moveItem":"copyItem",endpoint:N}))];case 3:C=M.sent();(k=new f.ItemResolver).invalidateItems({items:(A={},A[m]=y?[a.parentFolderItemFacet,a.deletedFacet]:[],A[t]=[d.defaultChildItemSetFacet],A)});w&&!y&&C.name&&k.resolveItems({items:(O={},O[w]=n.__assign({},a.displayNameFacet.pack(C.name)),O)});e(k.execute());return[3,5];case 4:if((L=M.sent())instanceof p.GraphError&&L.status===i.STATUS_CODE_ZERO)throw new o.MoveCopyItemOperationError({innerError:L,facets:n.__assign({},u.httpStatusErrorFacet.pack(L.status))});throw L;case 5:return[2]}})})}})});
define("@ms/items-view/lib/private/controls/createFolderDialogControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderDialogControl=new n.ControlFacet("createFolderDialogControl")});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/createFolderDialogControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/utilities/fileSystem/nameValidator"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderDialogControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){return{validator:r.nameValidator}}}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/addToOneDrive/addToOneDriveOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/store/actions/implementOperation","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/DriveItemKeyFacet","../../../models/facets/SPIdsFacet","@ms/odsp-graph/lib/models/error/Error","../../../models/keys/SharedWithMeItemSetKeyFacet","../../../handlers/operations/addToOneDrive/addToOneDriveHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveOperationHandler=o.createSingleItemOperationHandler()(function(e){var t=e.itemKey,o=e.options.itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:if(!l.sharedWithMeItemSetKeyFacet.matches(o))throw new r.ItemOperationError({code:"invalidItemSetForAddToOneDrive"});h=l.sharedWithMeItemSetKeyFacet.deserialize(o).driveItemKey.endpoint;p=e(i.readItems(function(e){return e.demandItemFacet(s.fileNameFacet,t)}));d=e(i.readItems(function(e){return e.demandItemFacet(a.sharepointIdsFacet,t)}));v=e(i.readItems(function(e){return e.demandItemFacet(u.driveItemKeyFacet,t)}));if(!(h&&p&&v&&d))throw new r.ItemOperationError({code:"missingItemInfoForAddToOneDrive"});return[4,e(c.getDriveResponse("GetDriveInfo",h))];case 1:m=n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,e(c.getAddToOneDriveResponse(p.name,m.id,d,"AddToOneDrive_SWM",h))];case 3:n.sent();return[3,5];case 4:if(!((g=n.sent())instanceof f.GraphError))throw g;c.addToOneDriveErrorHandle(g);return[3,5];case 5:return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/addToOneDrive/addToOneDriveHelper",["require","exports","@ms/items-view/lib/private/store/actions/implementOperation","@ms/items-view/lib/private/facets/ErrorFacets","../../../models/facets/GraphErrorFacet","../../../utilities/Data","@ms/odsp-graph/lib/models/error/Error","../../../models/keys/DriveItemKeyFacet"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveResponse=function(e,t){var n=t+"/me/drive";return s.getRawData({url:n,qosName:e,method:"GET",endpoint:t})};t.getAddToOneDriveResponse=function(e,t,n,r,i){var o=i.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{sharepointIds:{listId:n.listId,listItemUniqueId:n.listItemUniqueId,siteId:n.siteId,siteUrl:n.siteUrl,webId:n.webId}},"@microsoft.graph.conflictBehavior":"rename"};return s.getRawData({url:o,qosName:r,method:"POST",body:u,endpoint:i})};t.addToOneDriveErrorHandle=function(e,t,s){var a=o.getErrorResolution(e,function(n,o){var a=e.response,f=a&&a.error;if(f){var l=f["@error.fixItItemIds"],c=f["@error.fixItWebUrl"],h=f["@error.fixItItemName"],p=[];if(l&&t&&s)for(var d=0,v=l;d<v.length;d++){var m=v[d],g=u.driveItemKeyFacet.serialize({endpoint:t,driveId:s,itemId:m});p.push(g)}switch(n){case"unauthenticated":case 401:return r.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return r.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return r.accessDeniedErrorFacet.pack({});case"shortcutAlreadyExists":return i.shortcutExistedAlreadyFacet.pack({existShortcutUrl:c,existShortcutName:h});case"nestedDescendantShortcutExists":return i.nestedDescendantShortcutExistsFacet.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return i.nestedAscendantShortcutExistsFacet.pack({existShortcutUrl:c,existShortcutName:h});default:return r.offlineErrorFacet.pack({})}}});throw new n.ItemOperationError({innerError:e,facets:a})}});
define("@ms/items-view-addon-graph/lib/models/facets/GraphErrorFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shortcutExistedAlreadyFacet=new n.Facet("shortcutExistedAlready");t.nestedDescendantShortcutExistsFacet=new n.Facet("nestedDescendantShortcutExists");t.nestedAscendantShortcutExistsFacet=new n.Facet("nestedAscendantShortcutExists")});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeRootItemCommandBar",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/share/shareCommand","../../commands/addToOneDrive/addShortcutFromSharedWithMeCommand","../../commands/removeFromSharedListCommand","../../commands/addToOneDrive/removeShortcutFromSWMCommand"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return f}});t.default=t.sharedWithMeCommandBarControlHandler;var a=[r.openCommand,i.shareCommand,i.copyLinkCommand,s.addShortcutFromSharedWithMeCommand,u.removeShortcutFromSharedWithMeCommand,o.removeFromSharedListCommand];function f(e,t){return{commands:a}}});
define("@ms/items-view-addon-graph/lib/commands/addToOneDrive/removeShortcutFromSWMCommand",["require","exports","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","@ms/items-view/lib/private/models/Facet","react","../GraphCommands.resx","../../actions/addToOneDrive/RemoveFromOneDriveAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeShortcutFromSharedWithMeCommand={action:i.createElement(n.ShowOnlyWithSelection,null,i.createElement(o.RemoveFromOneDriveAction,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:s.default.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new r.Facet("RemoveShortcutFromSWM").id,name:s.default.RemoveShortcutFromSWM}});
define("@ms/items-view-addon-graph/lib/actions/addToOneDrive/RemoveFromOneDriveAction",["require","exports","tslib","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/telemetry/getItemEngagement","@ms/items-view/lib/private/store/actions/createActionCreator","@ms/items-view/lib/private/utilities/objects","react","../../controls/removeFromOneDriveActionControl"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=i.createItemCacheComponent(function(e,t){var i=e.dispatch,u=t.itemKeys,c=t.removeFromOneDrive;if(!u.length)return null;for(var h=0,p=u;h<p.length;h++){var d=p[h],v=e.demandItemFacet(l.removeFromOneDriveActionControl,d);if(!l.removeFromOneDriveActionControl.evaluate(v)(e,{isAvailable:!1,itemKey:d}).isAvailable)return null}var m=s.getCurrentItemSetKey(e);return f.createElement(r.Action,n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e={currentItemSetKey:m};return[4,i(c({items:a.makeObject(u,function(){return e})}))];case 1:t.sent();return[2]}})})}},o.getItemActionEngagement(e,{engagement:{isIntentional:!0,name:"A2OD_RemoveFromOneDrive",privacyClassification:"requiredService"},itemKey:u[0]})))}),h=s.withSelectedItems()(c),p=u.createAsyncActionCreator(function(t){return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["../DeferredActions"],t,n)})];case 1:i=n.sent().removeFromOneDriveWithProgress;return[4,r(i(t))];case 2:return[2,n.sent()]}})})}});t.RemoveFromOneDriveAction=i.connectToItemCache(function(){return{removeFromOneDrive:p}})(h)});
define("@ms/items-view-addon-graph/lib/controls/removeFromOneDriveActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromOneDriveActionControl=new n.ControlFacet("removeFromOneDriveActionControl",{})});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeItemSet/sharedWithMeSortedItemSetControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/SharedWithMeItemSetKeyFacet","../../../components/columns/ColumnKeys","@ms/items-view/lib/private/components/columns/columnKeys"],function(e,t,n,r,i,s,o){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0});var a=((u={})[o.DISPLAY_NAME_COLUMN_KEY]=!0,u[o.NAME_AND_PATH_COLUMN_KEY]=!0,u[s.SHARED_BY_COLUMN_KEY]=!0,u[s.DATE_SHARED_COLUMN_KEY]=!0,u[s.ITEM_ACTIVITY_COLUMN_KEY]=!0,u);t.sharedWithMeSortedItemSetControlHandler=r.createControlHandler()(function(){return function(e){return f}});function f(e,t){var r=t.itemSetKey,o=t.handler,u=o.columnKey,f=o.isAscending;if(!a[u])return{};var l=e.demandItemFacet(i.sharedWithMeItemSetKeyFacet,r);if(!l)return{};var c=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[u];return c?{newItemSetKey:i.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},l),{sortBy:c,isAscending:f}))}:{}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeItemSet/sharedWithMeItemSetOpenActionControlHandler",["require","exports","tslib","../../../models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler","../openActionControl","../../../models/keys/SharedWithMeRootItemKeyFacet"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetOpenActionControlHandler=i.createControlHandler()(function(){return function(e){return function(e,t){var i=t.itemKey,u=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i),a=u&&u.driveItemKey.endpoint,f=a&&s.getStageItemOverride(e,{parentItemKey:o.sharedWithMeRootItemKeyFacet.serialize({endpoint:a}),stageItem:t.stageItem});return n.__assign({},f?{stageItem:f}:{})}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeItemSet/sharedWithMeGroupedItemSetControlHandler",["require","exports","tslib","../../../models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler","../../../components/columns/ColumnKeys"],function(e,t,n,r,i,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});var u=((o={})[s.SHARED_BY_COLUMN_KEY]=!0,o[s.DATE_SHARED_COLUMN_KEY]=!0,o);t.sharedWithMeGroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return a}});function a(e,t){var i=t.itemSetKey,o=t.handler.columnKey;if(!u[o])return{};var a=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);if(!a)return{};var f=s.DEFAULT_COLUMN_KEYS_TO_FIELD_NAMES[o];return f?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},a),{groupBy:f}))}:{}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeItemSet/sharedWithMeUngroupedItemSetControlHandler",["require","exports","tslib","../../../models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeUngroupedItemSetControlHandler=i.createControlHandler()(function(){return function(e){return s}});function s(e,t){var i=t.itemSetKey,s=e.demandItemFacet(r.sharedWithMeItemSetKeyFacet,i);return s?{newItemSetKey:r.sharedWithMeItemSetKeyFacet.serialize(n.__assign(n.__assign({},s),{groupBy:void 0}))}:{}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/grouping/groupBySharedByOpenActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupBySharedByOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/grouping/groupByRelativeTimeOpenActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupByRelativeTimeOpenActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/people/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/TopCollaboratorSetKeyFacet","@ms/items-view/lib/private/operations/configuration/readConfiguration","../../../models/facets/ConfigurationFacets","../../../utilities/Data","../../../models/keys/TopCollaboratorItemKeyFacet","@ms/items-view/lib/private/operations/resolveItems","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/PersonFacets","@ms/items-view/lib/private/facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.peopleGetItemsOperationHandler=i.createSingleItemOperationHandler()(function(e){var t=this,i=e.itemKey;return function(d){return n.__awaiter(t,void 0,void 0,function(){var t,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:t=new r.ItemResolver;v=d(o.readConfiguration({graphEndpoint:u.graphEndpointConfigurationFacet})).graphEndpoint;m=s.topCollaboratorSetKeyFacet.deserialize(i);g=v||m.endpoint;y=g+"/me/people/";return[4,d(a.getRawData({url:y,qosName:"getTopCollaborator",endpoint:g}))];case 1:b=O.sent();w=[];for(E=0,S=b.value;E<S.length;E++){x=S[E];T=x.id,N=x.displayName,C=x.userPrincipalName;k=f.topCollaboratorItemKeyFacet.serialize({id:T});d(l.resolveItems({items:(L={},L[k]=n.__assign(n.__assign({},c.displayNameFacet.pack(N)),h.emailFacet.pack(C)),L)}));w.push(k)}t.resolveItems({items:(A={},A[e.itemKey]=n.__assign({},p.childItemsFacet.pack({itemKeys:w})),A)});d(t.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/TopCollaboratorItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorItemKeyFacet=new n.KeyFacet("topCollaboratorItemKeyFacet",{id:n.stringPart()})});
define("@ms/items-view/lib/private/components/itemSetTilesList/ItemSetTilesList",["require","exports","tslib","react","../decorators/withResponsiveMode","./hooks/useItemSetTileCells","./InjectableItemSetTilesList","@uifabric/experiments/lib/TilesList"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return r.createElement(u.TilesList,n.__assign({},e))};t.ItemSetTilesList=i.withResponsiveMode()(function(e){var t=s.useItemSetTileCells(e);return r.createElement(o.InjectableItemSetTilesList,n.__assign({},e,t,{onRenderTilesList:a}))});t.ItemSetTilesList.displayName="ItemSetTilesList"});
define("@ms/items-view/lib/private/components/itemSetTilesList/hooks/useItemSetTileCells",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","../../itemPage/ItemPage","../../../controls/childItemsControl","../../../facets/SetFacets","../../../facets/GroupFacets","../../../facets/DemandFacets","../../../facets/ItemFacets","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","../../../controls/itemSetTilesListControl","../../../facets/MediaFacets","../../../utilities/objects","../../itemSetList/ItemSetSelectionContext","../ItemTileCell","../HeaderTileCell","../../../models/itemCache/bindItemCacheSelectorToProps","../../../hooks/useItemCacheSelector","../../../controls/itemSetPagingControl","office-ui-fabric-react/lib/Selection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIZES={small:{tileDefaultHeight:135,tileDefaultWidth:138,documentGroupTileMargin:12,photoGroupTileMargin:8,groupMargin:40},large:{tileDefaultHeight:171,tileDefaultWidth:176,documentGroupTileMargin:8,photoGroupTileMargin:8,groupMargin:40}};t.useItemSetTileCells=function(e){var t=e.itemKey,n=e.doNotRenderShimmerTile,r=e.responsiveMode,i=e.layoutSupportsRandomAccess;return b.useItemCacheSelector(y.bindItemCacheSelectorToProps(S,e),[t,n,r,i])};function S(e,r){var i=r.itemKey,s=r.doNotRenderShimmerTile,p=void 0!==s&&s,d=r.responsiveMode,v=void 0===d?c.ResponsiveMode.large:d,y=r.layoutSupportsRandomAccess,b=e.demandItemFacet(w.itemSetPagingControl,r.itemKey),E=w.itemSetPagingControl.evaluate(b)(e,{setItemKey:r.itemKey}),S=E.totalItemCount,O=E.getPageKey,M=E.pageSize,_=y&&!!S&&void 0!==O,D=e.demandItemFacet(u.childItemsFacet,i),P=e.demandItemFacet(a.mediaGroupFacet,i),H=e.demandItemFacet(o.childItemsControl,i),B=o.childItemsControl.evaluate(H)(e,{itemKey:i,itemKeys:D&&D.itemKeys}).itemKeys,j=v>c.ResponsiveMode.large?"large":"small",F=t.SIZES[j],I=k(j),q=e.demandItemFacet(h.itemSetTilesListControl,i),R={mode:2,spacing:F.photoGroupTileMargin},U={mode:"large"===j?1:3,marginBottom:F.groupMargin,spacing:F.documentGroupTileMargin,minRowHeight:F.tileDefaultHeight},z=h.itemSetTilesListControl.evaluate(q)(e,{itemSetKey:i,itemKeys:B,responsiveMode:v,tileRenderer:m.ItemTileCell,disableMarqueeSelection:!1,grid:n.__assign(n.__assign({},U),P?R:{})}),W=z.tileRenderer,X=z.groupControlHandler,V=z.tileControlHandler,$=z.grid,J=z.disableMarqueeSelection,K=[],Q=[],G=[],Y=!0,Z=0,ee=!0;if(B){for(var te=0,ne=B;te<ne.length;te++){var re=ne[te],ie=_&&void 0===re;if(ie||e.demandItemFacet(u.pageFacet,re,{suppressGetItems:!0})){G.push({key:ie?Z.toString():re,content:{key:re,setKey:i,index:-1,tileSize:j,tileMode:"document",enableRandomAccess:_},desiredSize:I,onRenderCell:N});ie&&Z++}else if(e.demandItemFacet(a.isGroupFacet,re,{suppressGetItems:!0})){if(G.length>0){K.push(n.__assign({key:"",items:G},$));G=[]}var se=A(e,{itemKey:re}),oe=se.itemKeys;se.isResolved||(ee=!1);se.hasContent||(Y=!1);var ue=e.demandItemFacet(a.mediaGroupFacet,re)||P,ae=h.itemSetTilesListGroupControl.evaluate(X)(e,{groupKey:re,itemKeys:oe,tileRenderer:W,headerRenderer:g.HeaderTileCell,tileControlHandler:V,showHeader:!!e.demandItemFacet(l.displayNameFacet,re),grid:n.__assign(n.__assign({},$),ue?R:{})}),fe=ae.tileRenderer,le=ae.headerRenderer,ce=ae.tileControlHandler,he=ae.showHeader,pe=ae.grid;he&&le&&K.push({key:re,content:{key:re,index:-1,setKey:i,tileSize:j,tileMode:"document",headerRenderer:le},onRenderCell:T});for(var de=[],ve=0,me=oe;ve<me.length;ve++){var ge=me[ve];Q.push({key:ge});var ye=h.itemSetTilesListTileControl.evaluate(ce)(e,{itemKey:ge,desiredSize:ue&&L(e,{itemKey:ge})||I,tileMode:ue?"media":"document"}),be=ye.desiredSize,we=ye.tileMode;e.demandItemFacet(u.pageFacet,ge,{suppressGetItems:!0})?de.push({key:re,content:{key:re,setKey:i,index:-1,tileSize:j,tileMode:"document"},desiredSize:be,onRenderCell:N}):de.push({key:ge,content:{key:ge,index:Z,tileSize:j,tileMode:we,setKey:i,tileRenderer:fe},desiredSize:be,onRenderCell:x});Z++}var Ee=n.__assign({key:re,items:de},pe);K.push(Ee)}else{Q.push({key:re});var Se=h.itemSetTilesListTileControl.evaluate(V)(e,{itemKey:re,desiredSize:P&&L(e,{itemKey:re})||I,tileMode:P?"media":"document"}),xe=(be=Se.desiredSize,Se.tileMode);G.push({key:re,content:{key:re,index:Z,tileSize:j,tileMode:xe,setKey:i,tileRenderer:W},desiredSize:be,onRenderCell:x});Z++}}G.length>0&&K.push(n.__assign({key:"",items:G},$))}var Te=[],Ne=e.isItemFacetResolved(u.childItemsFacet,i)&&ee||!!e.demandItemFacet(f.errorFacet,i,{suppressGetItems:!0});Ne||B&&0!==B.length&&Y||Te.push(n.__assign(n.__assign({key:"",items:[{key:"",content:{key:"",setKey:i,index:Z,tileSize:j,tileMode:P?"media":"document"},desiredSize:k(j),onRenderCell:C,isPlaceholder:!0}]},U),{isPlaceholder:!0}));return{setKey:i||"",items:Te.length>0?p?[]:Te:K,selectionItems:Q,isDataReadyForLayout:Ne,getPageKey:O,pageSize:M,disableMarqueeSelection:J}}function x(e){var t=e.item,n=t.tileRenderer,i=t.key,s=t.setKey,o=t.index,u=t.tileMode,a=t.tileSize,f=e.item,l=e.finalSize,c=e.position.column;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{role:"gridcell","aria-colindex":c+1,contentSize:l,itemKey:i,itemSetKey:s,tileSize:a,itemTileMode:u,isSelectable:e&&e.mode!==E.SelectionMode.none&&e.canSelectItem(f),selectionIndex:o,selection:e})}):null}function T(e){var t=e.item,n=t.headerRenderer,i=t.key;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(e){return r.createElement(n,{itemKey:i,selection:e})}):null}function N(e){var t=e.item,n=e.finalSize;return t.enableRandomAccess?null:r.createElement(s.ItemPage,{itemKey:t.key,layout:"tile",contentSize:n})}function C(e){var t=e.finalSize;return r.createElement(i.ShimmerTile,{contentSize:t,itemName:!0,itemActivity:!0,itemThumbnail:!0,role:"presentation"})}function k(e){var n=t.SIZES[e];return{width:n.tileDefaultWidth,height:n.tileDefaultHeight}}function L(e,t){var n=e.demandItemFacet(p.thumbnailFacet,t.itemKey)||e.demandItemFacet(p.dimensionsFacet,t.itemKey);return n&&d.pickObject(n,["width","height"])}function A(e,t){var n=!0,r=!0,i=e.demandItemFacet(u.childItemsFacet,t.itemKey),s=e.demandItemFacet(f.errorFacet,t.itemKey,{suppressGetItems:!0});if(!e.isItemFacetResolved(u.childItemsFacet,t.itemKey)&&!s){i||(r=!1);n=!1}for(var l=i&&i.itemKeys||[],c=e.demandItemFacet(o.childItemsControl,t.itemKey),h=[],p=0,d=o.childItemsControl.evaluate(c)(e,{itemKeys:l,itemKey:t.itemKey}).itemKeys;p<d.length;p++){var v=d[p];if(e.demandItemFacet(a.isGroupFacet,v,{suppressGetItems:!0})){var m=A(e,{itemKey:v}),g=m.itemKeys,y=m.isResolved,b=m.hasContent;h.push.apply(h,g);b||(r=!1);y||(n=!1)}else h.push(v)}return{itemKeys:h,isResolved:n,hasContent:r}}});
define("@ms/items-view/lib/private/components/itemSetList/ItemSetSelectionContext",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CONTEXT=n.createContext(void 0);t.SET_SIZE_CONTEXT=n.createContext(0)});
define("@ms/items-view/lib/private/components/itemSetTilesList/ItemTileCell",["require","exports","tslib","react","../itemTile/ItemTile","../defaultDropZone/DefaultDropZone","../withAction/WithAction","../actions/defaultClick/DefaultClickAction","../decorators/withActionInvoker","../decorators/connectToItemCache","../../hooks/useShallowMemo","../../models/KeyFacet","../../models/itemCache/ComputedItemFacet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=new c.KeyFacet("itemTile",{itemKey:c.stringPart(),itemIndex:c.numberPart()}),d={defaultClickActionElement:null,dragDropElement:null};function v(e){var t=e.performanceData,u=n.__rest(e,["performanceData"]),f=l.useShallowMemo(function(){return u},u),c=l.useShallowMemo(function(){return t},t),h=c.defaultClickActionElement;return o.useAction(h,r.useCallback(function(e){return(function(e){var t=e.invokeActionStateProps,o=e.performanceData,u=e.tileProps,f=o.dragDropElement,l=u.itemKey,c=u.selectionIndex,h=t.isAvailable;a.useInvokeAction(n.__assign(n.__assign({},t),{itemKey:l,index:c}));var p=r.useMemo(function(){return r.createElement(i.ItemTile,n.__assign({role:"listitem",invokeSelection:h,href:h?"javascript:;":void 0},u))},[u,h]);return r.useMemo(function(){return s.renderChildrenWithDropZoneElement(p,f)},[p,f])})({invokeActionStateProps:e,performanceData:c,tileProps:f})},[c,f]))[1]}var m=new h.ComputedItemFacet("itemTileData",function(e,t){var n=e.demandItemFacet(p,t.itemKey);if(n){var i=n.itemIndex,a=n.itemKey;return{defaultClickActionElement:o.evaluateAction(e,r.createElement(u.ItemDefaultClickAction,{itemKey:a})),dragDropElement:f.evaluateItemCacheComponent(e,r.createElement(s.ItemDefaultDropZone,{itemKey:a,layoutMode:"absolute",enableDrag:!0,itemIndex:i}))}}});t.ItemTileCell=f.createItemCacheComponent(function(e,t){var i=t.itemKey,s=t.selectionIndex,o=e.demandItemFacet(m,p.serialize({itemIndex:s,itemKey:i}))||d;return r.createElement(v,n.__assign({},t,{performanceData:o}))});t.ItemTileCell.displayName="ItemTileCell"});
define("@ms/items-view/lib/private/components/itemTile/ItemTile",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","@uifabric/experiments/lib/FolderCover","@uifabric/experiments/lib/components/signals/Signals","../fields/baseText/BaseTextField","ODCItemsScopeDeferred_css","../itemFileTypeIcon/ItemFileTypeIcon","../fields/signal/SignalIcon","../../controls/itemAriaLabelControl","../../models/items/AriaHelper","../itemThumbnail/ItemThumbnail","../withItemCache/WithItemCache","@uifabric/utilities/lib/css","@ms/items-view-utilities/lib/locale/Locale","../../facets/ItemFacets","../../facets/GroupFacets","../../facets/MediaFacets","../fileHoverCard/getItemHoverCard","../../controls/itemTileControl","../../facets/ConfigurationFacets","../fields/date/DateRenderer","../../facets/DocumentFacets","../decorators/connectToItemCache","../../utilities/performance","../../utilities/performance","../../utilities/tilesListPerformance"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";a=a.ItemTile_8;Object.defineProperty(t,"__esModule",{value:!0});var A={small:{iconSize:48},large:{iconSize:64}},O=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=(e.itemKey,e.className),s=n.__rest(e,["itemKey","className"]);return r.createElement(i.Tile,n.__assign({},s,{className:v.css(a.defaultTile,t)}))};return t})(r.PureComponent),M=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onThumbnailLoad=function(){n.setState({thumbnailLoaded:!0})};n._onThumbnailError=function(){n.setState({thumbnailFailed:!0})};n.state={};return n}t.prototype.render=function(){var e=this,t=this.props,M=t.itemKey,D=t.className,P=t.itemTileMode,H=void 0===P?"document":P,B=t.background,j=t.foreground,F=n.__rest(t,["itemKey","className","itemTileMode","background","foreground"]),I=this.props,q=I.tileSize,R=void 0===q?"large":q,U=I.selectionIndex,z=this.state,W=z.thumbnailLoaded,X=z.thumbnailFailed;return r.createElement(d.WithItemCache,null,function(t){var d,P=t.itemCache;C.mark("ItemTile.render("+U+")");var I=k.now(),q=P.demandItem({displayName:g.displayNameFacet,dateModified:g.dateModifiedFacet,folder:g.folderFacet,oneNote:T.oneNoteFacet,isGroup:y.isGroupFacet,count:y.countFacet,isShared:g.isSharedFacet},M),z=q.displayName,V=q.folder,$=q.oneNote,J=q.isGroup,K=q.count,Q=q.isShared,G=P.demandItemFacet(E.itemTileControl,M),Y=E.itemTileControl.evaluate(G)(P,{itemKey:M,itemName:r.createElement(u.BaseText,{className:a.name,"data-automationid":"name",text:z||"",title:z||""}),itemActivity:r.createElement(x.DateRenderer,{itemKey:M}),tileAs:O,enableItemHoverCard:!0}),Z=Y.tileAs,ee=Y.itemName,te=Y.itemActivity,ne=Y.enableItemHoverCard,re=l.getLifeCycleSignals(P,M,1,!0),ie=re&&re.map(function(e){return e.signal}),se=P.isItemFacetResolved(b.thumbnailFacet,M),oe=se?P.demandItemFacet(b.thumbnailFacet,M):void 0,ue=P.demandItemFacet(c.itemAriaLabelControl,M),ae=h.getRowAriaLabel(P,{itemKey:M}),fe=c.itemAriaLabelControl.evaluate(ue)(P,{itemKey:M,itemAriaLabel:ae}).itemAriaLabel,le=P.demandItemFacet(S.enableFluentIconsFacet,S.configurationItemKey),ce=h.getRowCheckboxAriaLabel(P,{itemKey:M}),he=N.evaluateItemCacheComponent(P,ee),pe=N.evaluateItemCacheComponent(P,te),de=r.createElement(Z,n.__assign({itemKey:M,className:v.css(a.tile,D,(d={},d[a.hideThumbnail]=!W||!!X,d[a.hideFileTypeIcon]=!!W||!!oe&&!X,d)),itemName:he?r.createElement(o.SignalField,{signalsFieldMode:"compact",before:ie},he):null,ariaLabel:fe,toggleSelectionAriaLabel:ce,"data-automationid":"ItemTile",itemActivity:pe?r.createElement(o.SignalField,null,pe):null},F,{showForegroundFrame:!("document"!==H||V&&!$),showBackgroundFrame:"media"===H,hideForeground:!!oe&&!W&&!X,hideBackground:!!oe&&!W,foreground:r.createElement("div",null)})),ve=i.getTileLayout(de),me=ve.foregroundSize,ge=void 0===me?{width:0,height:0}:me,ye=ve.backgroundSize,be=void 0===ye?{width:0,height:0}:ye,we=[],Ee=[];if(V&&!$||J){var Se=P.demandItemFacet(E.folderCoverSignalControl,M),xe=E.folderCoverSignalControl.evaluate(Se)(P,{itemKey:M,signalData:e._getFolderCoverSignalData(Q)}).signalData,Te=xe&&xe.signal,Ne=r.createElement(s.FolderCover,{key:"folder",className:a.folderCover,folderCoverSize:e.props.tileSize,folderCoverType:"default",metadata:K?K.toLocaleString(m.Locale.language):K,signal:Te,isFluent:le}),Ce=s.getFolderCoverLayout(Ne).contentSize;we.push(s.renderFolderCoverWithLayout(Ne,{children:K?r.createElement("span",{className:a.blankFolderCover,style:{width:Ce.width+"px",height:Ce.height+"px"}}):null}))}else if(X||se&&!W&&!oe)se&&W||we.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:M,className:a.fileTypeIcon,preferAppIcon:!1,size:A[R].iconSize})));else{"media"===H?Ee.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:M,className:a.thumbnail,desiredSize:be,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad}))):we.push(N.evaluateItemCacheComponent(P,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:M,className:a.thumbnail,desiredSize:ge,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad})));we.push(N.evaluateItemCacheComponent(P,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:M,className:W?a.tileAppIcon:a.fileTypeIcon,size:W?16:A[R].iconSize,preferAppIcon:!!W})))}var ke=N.evaluateItemCacheComponent(P,i.renderTileWithLayout(de,{foreground:j||null===j?j:we.length>0?we:null,background:B||null===B?B:Ee.length>0?Ee:null})),Le=ne&&w.getItemHoverCard(P,{itemKey:M}),Ae=k.now(),Oe=Ae-I;L.tilesSelectorTime.add(Oe);return r.createElement(r.Fragment,null,Le?N.evaluateItemCacheComponent(P,r.createElement(Le,{itemKey:M},ke)):ke,r.createElement(_,{renderStartTime:Ae}))})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemKey!==this.props.itemKey&&this.setState({thumbnailLoaded:!1,thumbnailFailed:!1})};t.prototype._getFolderCoverSignalData=function(e){return{signal:e?r.createElement(o.SharedSignal,null):null,key:e?"shared":""}};return t})(r.PureComponent);t.ItemTile=M;function _(e){var t=k.now()-e.renderStartTime;L.tilesRenderTime.add(t);return null}});
define("@uifabric/experiments/lib/FolderCover",["require","exports","tslib","./components/FolderCover/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/FolderCover/index",["require","exports","tslib","./FolderCover","./initializeFolderCovers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@uifabric/experiments/lib/components/FolderCover/FolderCover",["require","exports","tslib","react","../../Utilities","ODCItemsScopeDeferred_css","office-ui-fabric-react/lib/Icon"],function(e,t,n,r,i,s,u){"use strict";var o=s.Signal_4;s=s.FolderCover_5;Object.defineProperty(t,"__esModule",{value:!0});var a=s,f=o,l=4,c={small:{width:72-2*l,height:44-2*l},large:{width:112-2*l,height:72-2*l}},h={small:{default:{back:"folderCoverSmallDefaultBack",front:"folderCoverSmallDefaultFront"},media:{back:"folderCoverSmallMediaBack",front:"folderCoverSmallMediaFront"}},large:{default:{back:"folderCoverLargeDefaultBack",front:"folderCoverLargeDefaultFront"},media:{back:"folderCoverLargeMediaBack",front:"folderCoverLargeMediaFront"}}},p=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,s=t.folderCoverSize,o=void 0===s?"large":s,l=t.folderCoverType,c=void 0===l?"default":l,p=t.hideContent,d=void 0!==p&&p,v=t.metadata,m=t.signal,g=t.children,y=(t.isFluent,n.__rest(t,["folderCoverSize","folderCoverType","hideContent","metadata","signal","children","isFluent"])),b=h[o][c],w=r.createElement("span",{className:i.css("ms-FolderCover-metadata",a.metadata)},v),E=r.createElement("span",{className:i.css("ms-FolderCover-signal",a.signal,f.isFluent)},m);return r.createElement("div",n.__assign({},y,{className:i.css(a.root,(e={},e["ms-FolderCover--isSmall "+a.isSmall]="small"===o,e["ms-FolderCover--isLarge "+a.isLarge]="large"===o,e["ms-FolderCover--isDefault "+a.isDefault]="default"===c,e["ms-FolderCover--isMedia "+a.isMedia]="media"===c,e["ms-FolderCover--hideContent "+a.hideContent]=d,e["ms-FolderCover--isFluent "+a.isFluent]=!0,e))}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-back",a.back),iconName:b.back}),this._renderChildren({children:g}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-front",a.front),iconName:b.front}),r.createElement(r.Fragment,null,w,E))};t.prototype._renderChildren=function(e){var t=e.children,n="function"==typeof t?t(d(this.props)):t;return n?r.createElement("span",{className:i.css("ms-FolderCover-content",a.content)},r.createElement("span",{className:i.css("ms-FolderCover-frame",a.frame)},n)):null};return t})(r.Component);t.FolderCover=p;t.getFolderCoverLayout=function(e){return d(e.props)};function d(e){var t=e.folderCoverSize,r=void 0===t?"large":t;return{contentSize:n.__assign({},c[r])}}t.renderFolderCoverWithLayout=function(e,t){var i=e.type;return r.createElement(i,n.__assign({},e.props,t))}});
define("@ms/items-view/lib/private/components/itemThumbnail/ItemThumbnail",["require","exports","tslib","react","../../controls/itemThumbnailControl","@uifabric/utilities/lib/css","@uifabric/utilities/lib/math","ODCItemsScopeDeferred_css","../../facets/MediaFacets","../../models/images/ImageByUrlKeyFacet","../../facets/ItemFacets","../../operations/images/ImageAddon","../../components/decorators/connectToItemCache","../itemCacheInitializer/ItemCacheInitializer","../../facets/DemandFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";u=u.ItemThumbnail_6;Object.defineProperty(t,"__esModule",{value:!0});var v=p.createItemCacheInitializer(function(e){return function(t){e.previousProps||t(c.imageAddon)}});function m(e){var t=e.error,n=e.onError;r.useEffect(function(){n&&n({})},[t,n]);return null}t.ItemThumbnail=h.createItemCacheComponent(function(e,t){var c,h,p,y,b=t.itemKey,w=t.desiredSize,E=t.className,S=t.onError,x=t.onLoad,T=t.fitMode,N=void 0===T?"contain":T,C=e.isItemFacetResolved(a.thumbnailFacet,b),k=C?e.demandItemFacet(a.thumbnailFacet,b):void 0;if(!C||k){var L=e.demandItemFacet(i.itemThumbnailControl,b),A=i.itemThumbnailControl.evaluate(L)(e,{itemKey:b,originalImage:k,desiredSize:w,thumbnail:k}).thumbnail;if(A&&A.url){var O=f.imageByUrlKeyFacet.serialize({url:A.url});c=e.demandItemFacet(l.openUrlFacet,O);h=e.demandItemFacet(a.dimensionsFacet,O);p=e.demandItemFacet(d.errorFacet,O,{suppressGetItems:!0});if(!c&&!p)return r.createElement(v,null)}}if(!c&&!p)return null;if(p)return r.createElement(m,{error:p,onError:S});g(h)&&g(w)&&(y=o.fitContentToBounds({boundsSize:w,contentSize:h,mode:N}));return r.createElement(r.Fragment,null,r.createElement(v,null),r.createElement("img",n.__assign({alt:"",className:s.css(u.image,E),src:c,onLoad:x,onError:S},y?{style:{width:y.width+"px",height:y.height+"px"}}:{})))});t.ItemThumbnail.displayName="ItemThumbnail";function g(e){return!!e&&e.width>0&&e.height>0}});
define("@ms/items-view/lib/private/components/itemCacheInitializer/ItemCacheInitializer",["require","exports","react","../../utilities/components/RenderProps","../../hooks/useShallowMemo","../../hooks/useItemCacheSelector","../../hooks/usePreviousValue","../../hooks/useEventHandler"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemCacheInitializer=function(e,t){return function(a){var f=i.useShallowMemo(function(){return a},a),l=o.usePreviousValue(f),c=s.useItemCacheDispatch(),h=u.useEventHandler(function(){t&&c(t({props:a}))});n.useEffect(function(){e&&c(e({props:f,previousProps:l}))},[f]);n.useEffect(function(){return h},[]);return r.renderChildrenWithProps(a.children,{})}}});
define("@ms/items-view/lib/private/utilities/tilesListPerformance",["require","exports","./PerformanceCounter"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tilesRenderCount=n.createPerformanceCounter("itemTiles.render.count");t.tilesRenderTime=n.createPerformanceCounter("itemTiles.render",{dependentCounter:t.tilesRenderCount});t.tilesSelectorCount=n.createPerformanceCounter("itemTiles.selectStoreData.count");t.tilesSelectorTime=n.createPerformanceCounter("itemTiles.selectStoreData",{dependentCounter:t.tilesSelectorCount})});
define("@ms/items-view/lib/private/components/itemSetTilesList/HeaderTileCell",["require","exports","react","../decorators/connectToItemCache","../../facets/ItemFacets"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HeaderTileCell=r.connectToItemCache(function(e,t){return{text:e.demandItemFacet(i.displayNameFacet,t.itemKey)||""}})(function(e){return n.createElement("div",null,n.createElement("h3",null,e.text))})});
define("@ms/items-view/lib/private/components/itemSetTilesList/InjectableItemSetTilesList",["require","exports","tslib","react","office-ui-fabric-react/lib/MarqueeSelection","../decorators/withLayoutRenderComplete","ODCItemsScopeDeferred_css","@uifabric/utilities/lib/dom/findElementRecursive","../itemSetList/ItemSetSelectionContext"],function(e,t,n,r,i,s,o,u,a){"use strict";o=o.ItemSetTilesList_2;Object.defineProperty(t,"__esModule",{value:!0});var f=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.selection,s=r.selectionItems;i&&i.setItems(s,!0);return n}t.prototype.render=function(){var e=this.props,t=e.selection,s=e.selectionMode,u=(e.ref,e.disableMarqueeSelection),f=e.ariaLabel,p=(e.selectionItems,e.onRenderTilesList),d=e.enterModalSelectionOnTouch,v=n.__rest(e,["selection","selectionMode","ref","disableMarqueeSelection","ariaLabel","selectionItems","onRenderTilesList","enterModalSelectionOnTouch"]),m=p(n.__assign({className:o.root,"aria-label":f,role:"grid",onRenderRoot:c,onRenderRow:h},v)),g=t?r.createElement(i.SelectionZone,{selection:t,selectionMode:s,onItemInvoked:this.props.onItemInvoked,onItemContextMenu:this.props.onItemContextMenu,disableAutoSelectOnInputElements:!0,enterModalOnTouch:d,enableTouchInvocationTarget:!0},r.createElement(a.SELECTION_CONTEXT.Provider,{value:t},m)):m;return t?u?g:r.createElement(i.MarqueeSelection,{selection:t,onShouldStartSelection:l},g):m};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.selection,n=e.selectionItems;t&&t.setItems(n,e.setKey!==this.props.setKey||!e.setKey)};return t})(r.PureComponent);t.InjectableItemSetTilesList=s.withLayoutRenderComplete({qosName:"Tiles"})(f);function l(e){return!u.findElementRecursive(e.target,function(e){return null!==e.getAttribute("data-selection-index")})}function c(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{"aria-colcount":e.columnCount,"aria-rowcount":e.rowCount})})):null}function h(e,t){return e&&t?t(n.__assign(n.__assign({},e),{divProps:n.__assign(n.__assign({},e.divProps),{role:"row"})})):null}});
define("@ms/items-view/lib/private/components/DeferredComponents",["require","exports","tslib","./actions/showMalwareDetected/MalwareDetectedDialog","./progress/panel/ProgressPanel","./itemsContextMenu/ItemsContextMenu","./itemsContextMenu/ActionContextMenu","./uploader/Uploader"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("@ms/items-view/lib/private/components/actions/showMalwareDetected/MalwareDetectedDialog",["require","exports","tslib","react","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","../../../utilities/async/CancelError","./MalwareDetectedMessage.resx","../../scope/actions/strings.resx","office-ui-fabric-react/lib/Styling","../../withAction/WithAction","../../actions/download/DownloadAction","@ms/utilities-react/lib/hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MalwareDetectedDialog=function(e){var t=this,m=e.itemKey,g=e.resolve,y=e.reject,b=r.useState(!1),w=b[0],E=b[1],S=d.useEventHandler(function(){y(new a.CancelError)}),x=c.getTheme();return r.createElement(h.WithAction,{action:r.createElement(p.ItemDownloadAction,{itemKeys:[m]})},function(e){var a=e.isAvailable,c=e.execute,h=a?function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);E(!0);return[4,c()];case 1:t.sent();g();return[3,3];case 2:e=t.sent();y(e);return[3,3];case 3:return[2]}})})}:void 0,p=a?f.default.malwareDetectedAllowDownloadMessage:f.default.malwareDetectedMessage;return w?null:r.createElement(o.Dialog,{hidden:!1,onDismiss:S,title:f.default.malwareDetectedDialogHeader,closeButtonAriaLabel:f.default.closeButtonAriaLabel,type:o.DialogType.close,styles:v,dialogContentProps:{styles:function(){return{title:{color:x.semanticColors.errorText,fontWeight:"500"}}}}},r.createElement(s.Label,null,i.formatToArray(p,r.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},f.default.malwareDetectedLearnMore))),r.createElement(o.DialogFooter,null,h?r.createElement(u.DefaultButton,{onClick:h},f.default.malwareDialogDownload):null,r.createElement(u.DefaultButton,{onClick:S,primary:!0},l.default.cancelActionText)))})};function v(){return{main:{maxWidth:"450px !important"}}}});
define("@ms/items-view/lib/private/components/progress/panel/ProgressPanel",["require","exports","react","office-ui-fabric-react/lib/Panel","../../../operations/progress","../ProgressStrings.resx","../list/ProgressList","../../withItemCache/WithItemCache","../../../utilities/objects","../../../facets/SetFacets","../../../facets/ProgressFacets","../../../hooks/useEventHandler","../../../controls/progressPanelControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=[];t.ProgressPanel=function(e){var t=e.resolve,d=n.useState(!0),v=d[0],m=d[1],g=c.useEventHandler(function(){m(!1)}),y=n.useCallback(function(e){var u=e.itemCache,c=e.dispatch,d=u.demandItemFacet(f.childItemsFacet,i.progressRootItemKey),m=d&&d.itemKeys||p,y=m.filter(function(e){var t=i.getOverallProgressPhase(u,{itemKey:e});return t===l.ProgressPhase.completed||t===l.ProgressPhase.canceled}),b=u.demandItemFacet(h.progressPanelControl,i.progressRootItemKey),w=h.progressPanelControl.evaluate(b)(u,{itemKeys:m,panelAs:r.Panel}).panelAs;return n.createElement(w,{isOpen:v,headerText:s.default.progressTitle,isLightDismiss:!0,onDismiss:g,onDismissed:function(){c(i.expireProgressItems({items:a.makeObject(y,function(){return!0})}));t()},closeButtonAriaLabel:s.default.progressCloseActionText},n.createElement(o.ProgressList,{itemKeys:m}))},[v,t]);return n.createElement(u.WithItemCache,null,y)}});
define("@ms/items-view/lib/private/components/progress/list/ProgressList",["require","exports","react","@uifabric/experiments/lib/TilesList","../itemTile/ProgressItemTile","ODCItemsScopeDeferred_css","../ProgressStrings.resx","@uifabric/utilities/lib/css","../../../facets/ProgressFacets","../../../facets/SetFacets","../../../operations/progress","../../../controls/progressListControl","../../decorators/connectToItemCache","../../itemSetList/ItemSetSelectionContext"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";s=s.ProgressList_3;Object.defineProperty(t,"__esModule",{value:!0});var d=n.createContext(void 0),v=function(){var e=n.createRef();n.useEffect(function(){e&&e.current&&e.current.focus()});return n.createElement("p",{ref:e,tabIndex:-1},o.default.progressNoItemsMessage)};t.ProgressList=h.createItemCacheComponent(function(e,t){for(var i=t.itemKeys,o=t.groupsOnly,u=t.role,h=[],g=e.demandItemFacet(c.progressListControl,void 0),b=c.progressListControl.evaluate(g)(e,{}).groupControlHandler,w=function(t){if(l.getOverallProgressPhase(e,{itemKey:t})===a.ProgressPhase.expired)return"continue";var n=function(r,i){h.push({key:r,content:{itemKey:r,index:h.length},onRender:0===i?m:y});if(!(o&&i>=1)){var s,u=e.demandItemFacet(c.progressListGroupControl,t),l=e.demandItemFacet(f.childItemsFacet,r),p=l&&l.itemKeys;p&&(s=p.filter(function(t){return!e.demandItemFacet(a.progressAggregationOnlyFacet,t)}));var d=c.progressListGroupControl.evaluate(u,b)(e,{itemKey:r,childItemKeys:s,maxChildItemCount:void 0}).maxChildItemCount;if(s)for(var v=0,g="number"==typeof d?s.slice(0,d):s;v<g.length;v++){var w=g[v];n(w,i+1)}}};n(t,0)},E=0,S=i;E<S.length;E++){w(S[E])}return h.length>0?n.createElement(p.SET_SIZE_CONTEXT.Provider,{value:h.length},n.createElement(d.Provider,{value:u},n.createElement(r.TilesList,{className:s.root,items:h,role:u}))):n.createElement(v,null)});function m(e){var t=e.itemKey,r=e.index;return n.createElement(g,{itemKey:t,index:r})}function g(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.group),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"group"}))}function y(e){var t=e.itemKey,r=e.index;return n.createElement(b,{itemKey:t,index:r})}function b(e){var t=e.itemKey,r=e.index,o=n.useContext(p.SET_SIZE_CONTEXT),a=n.useContext(d);return n.createElement("div",{className:u.css(s.item),role:a?"presentation":"listitem","aria-posinset":a?void 0:r+1,"aria-setsize":a?void 0:o},n.createElement(i.ProgressItemTile,{itemKey:t,format:"item"}))}});
define("@ms/items-view/lib/private/components/progress/itemTile/ProgressItemTile",["require","exports","tslib","react","@uifabric/utilities/lib/css","ODCItemsScopeDeferred_css","office-ui-fabric-react/lib/ProgressIndicator","../../withItemCache/WithItemCache","../../../controls/progressControl","../../itemFileTypeIcon/ItemFileTypeIcon","../../../operations/progress","office-ui-fabric-react/lib/components/Button/IconButton/IconButton","@ms/utilities-strings/lib/index","../ProgressStrings.resx","../../../facets/ProgressFacets","../../../facets/ItemFacets","../../../facets/DemandFacets","../../withAction/WithAction","../actions/cancel/CancelProgressAction","../actions/expire/ExpireProgressAction","../../../utilities/async/CancelError","../../actionCommandButtonStrip/ActionCommandButtonStrip","../../decorators/withControlHandler","../../../controls/selectedItemsControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";s=s.ProgressItemTile_3;var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=[],k=((T={})[d.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericStartedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericCompletedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T),L=((N={})[d.ProgressPhase.created]=p.default.genericCreatedDescription,N[d.ProgressPhase.canceled]=p.default.genericCanceledDescription,N[d.ProgressPhase.completed]=p.default.genericCompletedDescription,N),A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t,n=this.props,u=n.icon,a=n.actions,f=n.cancel,l=n.description,c=n.title,h=c?r.createElement("div",{className:i.css(s.title)},c):c,p=l?r.createElement("div",{className:i.css(s.description)},l):l;return r.createElement("div",{className:i.css(s.tile,(e={},e[s.hasIcon]=!!u,e[s.error]=!!this.props.error,e))},u?r.createElement("span",{className:i.css(s.icon,(t={},t[s.hasProgress]=!this.props.progressHidden,t))},this.props.icon):null,r.createElement("div",{className:i.css(s.progress)},r.createElement(o.ProgressIndicator,{label:h,description:p,percentComplete:this.props.percentComplete,progressHidden:this.props.progressHidden})),a?r.createElement("div",{className:i.css(s.actions)},a):null,f?r.createElement("span",{className:i.css(s.cancel)},f):null)};return t})(r.PureComponent);t.ProgressTile=A;var O=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.itemKey,s=t.format;return r.createElement(u.WithItemCache,null,function(t){var o=t.itemCache,u=(t.dispatch,o.demandItemFacet(d.sourceItemFacet,i)),h=u&&u.itemKey,T=o.demandItemFacet(v.displayNameFacet,i)||o.demandItemFacet(v.displayNameFacet,h),N=o.demandItemFacet(m.errorFacet,i),O=o.demandItemFacet(a.progressControl,i),M=l.getItemCountsByProgressPhase(o,{itemKey:i}),_=l.getOverallSimpleProgressBreakdown(o,{itemKey:i}),D=_.phase,P=_.count,H=l.getOverallProgressPhase(o,{itemKey:i}),B=o.demandItemFacet(d.overallProgressSizeFacet,i),j=B?0!==B.total?B.current/B.total:void 0:D!==d.ProgressPhase.started?1:void 0,F=a.progressControl.evaluate(O)(o,n.__assign(n.__assign({itemKey:e.props.itemKey,title:T||k[D](P),description:N&&!w.isCancel(N)?N.message:L[H]},j?{percentComplete:j}:{}),{itemCountsByPhase:M,format:s,commands:C})),I=F.title,q=F.description,R=F.percentComplete,U=F.commands,z="started"===D?r.createElement(y.CancelProgressAction,null):"failed"===D?r.createElement(b.ExpireProgressAction,null):null,W="started"===D||"failed"===D&&"number"==typeof R&&R<1;return r.createElement(S.ControlHandlerProvider,{controlHandlers:x.selectedItemsControl.pack(function(e,t){return{itemKeys:[i]}})},r.createElement(g.WithAction,{action:z},function(e){var t=e.execute,n=e.isAvailable?function(){t().catch(function(){})}:void 0;return r.createElement(A,{title:I,description:q,percentComplete:R,error:N&&!w.isCancel(N)?N:void 0,progressHidden:!W,icon:"item"===s?r.createElement(f.ItemFileTypeIcon,{itemKey:h,size:48}):void 0,cancel:n?r.createElement(c.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:"started"===D?p.default.progresslistCancelButtonAriaLabel:p.default.progresslistRemoveButtonAriaLabel,onClick:n}):void 0,actions:U.length>0?r.createElement(E.ActionCommandButtonStrip,{commands:U}):void 0})}))})};return t})(r.PureComponent);t.ProgressItemTile=O});
define("@ms/items-view/lib/private/components/progress/actions/cancel/CancelProgressAction",["require","exports","tslib","react","../../../../operations/progress/cancelProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemCancelProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"started"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.cancelProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.CancelProgressAction=a.withSelectedItems()(t.ItemCancelProgressAction)});
define("@ms/items-view/lib/private/operations/progress/cancelProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelProgressItemsOperation=new n.Facet("cancelProgressItemsOperation");t.cancelProgressItems=r.implementOperation({operationTypeFacet:t.cancelProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/actions/expire/ExpireProgressAction",["require","exports","tslib","react","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../../facets/GroupFacets","../../../decorators/selectors","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemExpireProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){var n=e.demandItemFacet(u.isGroupFacet,t),r=o.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase;return n&&"failed"===r}),f=e.dispatch;return r.createElement(s.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(o.expireProgressItems({items:i.makeObject(a,function(){return!0})}));return[2]})})},isAvailable:a.length>0})});t.ExpireProgressAction=a.withSelectedItems()(t.ItemExpireProgressAction)});
define("@ms/items-view/lib/private/components/actionCommandButtonStrip/ActionCommandButtonStrip",["require","exports","react","office-ui-fabric-react/lib/Button","@uifabric/experiments/lib/LayoutGroup","@uifabric/utilities/lib/componentAs/composeComponentAs","../commandSet/CommandSet","ODCItemsScopeDeferred_css","../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.CommandButton_8;Object.defineProperty(t,"__esModule",{value:!0});t.ActionCommandButtonStrip=a.createItemCacheComponent(function(e,t){var f=t.commands;return a.evaluateItemCacheComponent(e,n.createElement(o.CommandSet,{commands:f},function(e){var t=e.menuItems;return n.createElement(i.LayoutGroup,{direction:"horizontal"},t.map(function(e){var t=e.onClick,i=t?function(){t()}:void 0,o=e.commandBarButtonAs,a=o?s.composeComponentAs(o,r.DefaultButton):r.DefaultButton;return n.createElement(a,{className:u.commandButton,key:e.key,onClick:i},e.name)}))}))})});
define("@uifabric/experiments/lib/LayoutGroup",["require","exports","tslib","./components/LayoutGroup/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/LayoutGroup/index",["require","exports","tslib","./LayoutGroup"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/LayoutGroup/LayoutGroup",["require","exports","tslib","react","office-ui-fabric-react/lib/Styling","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._getJustify=function(e){return"end"===e?"flex-end":"center"===e?"center":"flex-start"};return t}t.prototype.render=function(){var e=this.props,t=e.children,o=e.direction,u=e.layoutGap,a=e.justify,f=s.getNativeProps(this.props,s.divProperties),l=r.Children.count(t),c=r.Children.map(t,function(e,t){var n=t===l-1;return r.createElement("div",{className:i.mergeStyles("ms-LayoutGroup-item","horizontal"===o&&!n&&{marginRight:u+"px"},"vertical"===o&&!n&&{marginBottom:u+"px"},"fill"===a&&{flexBasis:"0",flexGrow:1})},e)});return r.createElement("div",n.__assign({},f,{className:i.mergeStyles("ms-LayoutGroup",{display:"flex",flexDirection:"horizontal"===o?"row":"column",justifyContent:this._getJustify(a)})}),c)};t.defaultProps={layoutGap:8,direction:"vertical",justify:"start"};return t})(r.Component);t.LayoutGroup=o});
define("@ms/items-view/lib/private/controls/progressListControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressListGroupControl=new n.ControlFacet("progressListGroupControl",{});t.progressListControl=new n.ControlFacet("progressListControl",{groupControlHandler:n.childControlOption(t.progressListGroupControl)})});
define("@ms/items-view/lib/private/controls/progressPanelControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressPanelControl=new n.ControlFacet("progressPanelControl",{panelAs:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/itemsContextMenu/ItemsContextMenu",["require","exports","tslib","react","../decorators/selectors","../decorators/connectToItemCache","./ActionContextMenu","../../controls/itemsContextMenuControl","../commands/new/newCommand","../commands/open/openCommand","../commands/upload/uploadCommand","../commands/share/shareCommand","../commands/download/downloadCommand","../commands/rename/renameCommand","../commands/delete/deleteCommand","../telemetry/TelemetryProvider","../../utilities/components/Props","../../models/itemsScope/getCurrentItemKey","../commands/follow/followCommand","../../utilities/arrays","../../utilities/performance"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=[a.newCommand,f.openCommand,l.uploadCommand,c.shareCommand,c.copyLinkCommand,y.followCommand,h.downloadCommand,d.deleteCommand,p.renameCommand],S=v.createTelemetryProvider({withContext:{component:"ContextMenu"}});t.ItemsContextMenu=m.wrapWithParent(S)(s.createItemCacheComponent(function(e,t){t.isOpen&&w.mark("ItemsContextMenu.render");var s=g.getCurrentItemKey(e),a=i.getCurrentItemSetKey(e),f=t.commands,l=void 0===f?[]:f,c=e.demandItemFacet(u.itemsContextMenuControl,s),h=u.itemsContextMenuControl.evaluate(c)(e,{itemKey:s||"",itemSetKey:a,commands:E,preserveIcons:t.preserveIcons}),p=h.commands,d=h.onMenuOpened,v=h.contextMenuAs,m=h.preserveIcons;return r.createElement(o.ActionContextMenu,n.__assign({},t,{commands:b.concat(p,l),onMenuOpened:d,contextMenuAs:v,preserveIcons:m}))}));t.ItemsContextMenu.displayName="ItemsContextMenu"});
define("@ms/items-view/lib/private/components/itemsContextMenu/ActionContextMenu",["require","exports","tslib","react","office-ui-fabric-react/lib/ContextualMenu","../commandSet/CommandSet","../../utilities/arrays","./cleanContextMenuItems","../decorators/connectToItemCache","@uifabric/utilities/lib/componentAs/composeComponentAs"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NO_ITEMS=[];t.ActionContextMenu=a.createItemCacheComponent(function(e,a){var l=a.items,c=void 0===l?t.NO_ITEMS:l,h=a.directionalHint,p=void 0===h?i.DirectionalHint.rightTopEdge:h,d=a.isBeakVisible,v=void 0!==d&&d,m=a.isOpen,g=a.contextMenuAs,y=n.__rest(a,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),b=g?f.composeComponentAs(g,i.ContextualMenu):i.ContextualMenu;return r.createElement(s.CommandSet,{commands:a.commands},function(e){var t=e.menuItems,i=o.concat(c,u.cleanContextMenuItems(t,a));return m?r.createElement(b,n.__assign({},y,{items:i,directionalHint:p,isBeakVisible:v})):null})})});
define("@ms/items-view/lib/private/components/itemsContextMenu/cleanContextMenuItems",["require","exports","tslib","./ActionContextMenu.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cleanContextMenuItems=function e(t,i){var s=i.target,o=i.preserveIcons,u=void 0!==o&&o;return t.map(function(t){var o=t.subMenuProps,a=t.onClick,f=t.hasLaunchTarget,l=n.__rest(t,["subMenuProps","onClick","hasLaunchTarget"]);return n.__assign(n.__assign({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?r.default.More:t.name,icon:void 0,iconProps:u?t.iconProps:void 0,subMenuProps:o?n.__assign(n.__assign({},o),{items:e(o.items,i)}):void 0,onClick:f&&a?function(e){e&&s&&(s instanceof Event?e.target=s.target:s instanceof Element&&(e.target=s));a(e)}:a})})}});
define("@ms/items-view/lib/private/components/commands/new/newCommand",["require","exports","../createFolder/createFolderCommand","office-ui-fabric-react/lib/ContextualMenu","../Commands.resx","../createDocument/createDocumentCommand","./newCommandKey"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newCommand={key:o.newCommandKey,automationId:"newCommand",name:i.default.Create,title:i.default.CreateCommandAriaLabel,engagement:{name:"newCommand",isIntentional:!0},iconProps:{iconName:"CalculatorAddition"},subMenuProps:{items:[n.createFolderCommand,{name:"-",key:"divider_1",itemType:r.ContextualMenuItemType.Divider},s.createWordCommand,s.createExcelCommand,s.createPowerPointCommand,s.createOneNoteCommand,s.createExcelSurveyCommand,s.createFormForExcelCommand,s.createVisioCommand]}}});
define("@ms/items-view/lib/private/components/commands/createFolder/createFolderCommand",["require","exports","react","../../../models/Facet","../../actions/createFolder/CreateFolderAction","../getCommandIconProps","../../scope/commands/commands.resx","../../selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderCommand={key:new r.Facet("createFolder").id,automationId:"createFolderCommand",name:o.default.CreateFolder,ariaLabel:o.default.CreateFolder,action:n.createElement(u.HideWithSelection,null,n.createElement(i.CreateFolderAction,null)),iconProps:s.getCommandIconProps({size:16,type:2})}});
define("@ms/items-view/lib/private/components/actions/createFolder/CreateFolderAction",["require","exports","tslib","../../base/actions/createFolder/CreateFolderAction","../../decorators/connectToItemCache","../../../utilities/components/Async"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./CreateFolderWizard"],t,n)})];case 1:return[2,t.sent().CreateFolderWizard]}})})});t.ItemCreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.ItemCreateFolderAction);t.CreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.CreateFolderAction);t.CreatePersistentFolderAction=i.connectToItemCache(function(){return{createFolderWizard:o}})(r.PersistentCreateFolderAction)});
define("@ms/items-view/lib/private/components/base/actions/createFolder/CreateFolderAction",["require","exports","tslib","react","../../../decorators/selectors","../../../../controls/createFolderActionControl","../../../../facets/ItemFacets","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache","../../../withAction/WithAction","../../../action/Action","../../../../utilities/components/Async"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=c.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./CreateFolderDialog"],t,n)})];case 1:return[2,t.sent().CreateFolderDialog]}})})});t.ItemCreateFolderAction=a.createItemCacheComponent(function(e,t){var i=t.itemKey,a=t.createFolderWizard;if(!i)return null;var c=!0,p=e.demandItemFacet(o.folderFacet,i),d=e.demandItemFacet(s.createFolderActionControl,i),v=s.createFolderActionControl.evaluate(d)(e,{itemKey:i,isAvailable:!1,createFolderWizard:a}),m=v.isAvailable,g=v.createFolderWizard;m||(c=!1);var y=f.renderComponentOnExecute(function(e){return r.createElement(h,n.__assign({},e,{isAvailable:c&&!!p,itemKey:i,createFolderWizard:g}))});return r.createElement(l.Action,n.__assign({isAvailable:c,onExecute:y},u.getItemActionEngagement(e,{itemKey:i,engagement:{name:"CreateFolder",isIntentional:!0}})))});t.CreateFolderAction=i.withOnlyCurrentItem()(t.ItemCreateFolderAction);t.PersistentCreateFolderAction=i.withCurrentItem()(t.ItemCreateFolderAction)});
define("@ms/items-view/lib/private/components/commands/getCommandIconProps",["require","exports","tslib","@uifabric/file-type-icons/lib/index","ODCItemsScopeDeferred_css"],function(e,t,n,r,i){"use strict";i=i.Commands_0;Object.defineProperty(t,"__esModule",{value:!0});t.getCommandIconProps=function(e){return n.__assign(n.__assign({},r.getFileTypeIconProps(e)),{className:i.newDocumentCommandIcon})}});
define("@ms/items-view/lib/private/components/commands/createDocument/createDocumentCommand",["require","exports","react","../../scope/commands/commands.resx","../../../models/Facet","../../../operations/createDocument/DocumentType","../../actions/createDocument/CreateDocumentAction","../getCommandIconProps","../../selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createWordCommand={key:new i.Facet("createWord").id,automationId:"createWordCommand",name:r.default.CreateWord,ariaLabel:r.default.CreateWord,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Word})),iconProps:u.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new i.Facet("createExcel").id,automationId:"createExcelCommand",name:r.default.CreateExcel,ariaLabel:r.default.CreateExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Excel})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new i.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:r.default.CreatePowerPoint,ariaLabel:r.default.CreatePowerPoint,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.PowerPoint})),iconProps:u.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new i.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:r.default.CreateOneNote,ariaLabel:r.default.CreateOneNote,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.OneNote})),iconProps:u.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new i.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:r.default.CreateExcelSurvey,ariaLabel:r.default.CreateExcelSurvey,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelSurvey})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createFormForExcelCommand={key:new i.Facet("createFormForExcel").id,automationId:"createFormForExcelCommand",name:r.default.CreateFormForExcel,ariaLabel:r.default.CreateFormForExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelForm})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createVisioCommand={key:new i.Facet("createVisio").id,automationId:"createVisioCommand",name:r.default.CreateVisio,ariaLabel:r.default.CreateVisio,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Visio})),iconProps:u.getCommandIconProps({extension:"vsdx",size:16})}});
define("@ms/items-view/lib/private/components/actions/createDocument/CreateDocumentAction",["require","exports","tslib","react","../../../operations/createDocument/DocumentType","../../../facets/ItemFacets","../../../controls/createDocumentActionControl","../../decorators/selectors","../../decorators/connectToItemCache","../../action/Action","../../../models/telemetry/getItemEngagement","../../withAction/WithAction","../../../utilities/components/Async"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./DocumentCreator"],t,n)})];case 1:return[2,t.sent().DocumentCreator]}})})});t.ItemCreateDocumentAction=a.createItemCacheComponent(function(e,t){var u=t.itemKey,a=t.documentType,h=u&&e.demandItemFacet(s.folderFacet,u),d=e.demandItemFacet(o.createDocumentActionControl,u),v=o.createDocumentActionControl.evaluate(d)(e,{itemKey:u,documentType:a,isAvailable:!1}).isAvailable,m=c.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,t))});return r.createElement(f.Action,n.__assign({isAvailable:v&&!!h,onExecute:m},l.getItemActionEngagement(e,{itemKey:u,engagement:{name:"CreateDocument",isIntentional:!0,extraData:{documentType:i.DocumentType[a]}}})))});t.CreateDocumentAction=u.withOnlyCurrentItem()(t.ItemCreateDocumentAction);t.CreatePersistentDocumentAction=u.withCurrentItem()(t.ItemCreateDocumentAction)});
define("@ms/items-view/lib/private/components/commands/new/newCommandKey",["require","exports","../../../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newCommandKey=n.getNextId("newCommand")});
define("@ms/items-view/lib/private/components/commands/upload/uploadCommand",["require","exports","./uploadFileCommand","./uploadFolderCommand","../Commands.resx","@ms/utilities-browser/lib/PlatformDetection","./uploadCommandKey"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new s.PlatformDetection;t.uploadCommand={key:o.uploadCommandKey,automationId:"uploadCommand",name:i.default.Upload,ariaLabel:i.default.Upload,title:i.default.UploadCommandTooltip,iconProps:{iconName:"upload"},action:u.isFolderUploadSupported?void 0:n.uploadFileCommand.action,subMenuProps:u.isFolderUploadSupported?{items:[n.uploadFileCommand,r.uploadFolderCommand]}:void 0}});
define("@ms/items-view/lib/private/components/commands/upload/uploadFileCommand",["require","exports","react","../../../models/Facet","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../actions/upload/UploadFileAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand={key:new r.Facet("uploadFile").id,automationId:"uploadFileCommand",name:i.default.UploadFile,ariaLabel:i.default.UploadFile,action:n.createElement(s.HideWithSelection,null,n.createElement(o.UploadFileAction,null))}});
define("@ms/items-view/lib/private/components/actions/upload/UploadFileAction",["require","exports","./UploadAction","../../fileSystemDialog/FileSystemDialog","@ms/utilities-browser/lib/PlatformDetection","../../decorators/connectToItemCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new i.PlatformDetection,u=s.connectToItemCache(function(){return{type:"file"}})(r.FileSystemDialog),a=s.createItemCacheComponent(function(e,t){return null});t.UploadFileAction=o.isHtml5FileUploadSupported?s.connectToItemCache(function(){return{fileSelector:u}})(n.UploadAction):a});
define("@ms/items-view/lib/private/components/fileSystemDialog/FileSystemDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../../utilities/fileSystem/FileEntries","ODCItemsScopeDeferred_css"],function(e,t,n,r,i,s,o){"use strict";o=o.FileSystemDialog_6;Object.defineProperty(t,"__esModule",{value:!0});var u={inputElement:null,files:void 0,hasNothingHappened:!1},a=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onInputRef=function(e){r.setState({inputElement:e})};r._onInputChange=function(e){var t=e.target,n=t["test-files"]||t.files,i=[];if(n)for(var s=0,o=n.length;s<o;s++)i.push(n[s]);r.setState({files:i})};r._onNothingHappened=function(){r.setState(function(e){return n.__assign(n.__assign({},e),{hasNothingHappened:!e.files})})};r.state=u;r._events=new i.EventGroup(r);r._async=new i.Async(r);return r}t.prototype.render=function(){return r.createElement("input",{className:o.input,"data-automationid":"directory"===this.props.type?"commandFolderInput":"commandFileInput",type:"file",ref:this._onInputRef,multiple:!0,onChange:this._onInputChange})};t.prototype.componentDidMount=function(){this._onStateChanged(u)};t.prototype.componentDidUpdate=function(e,t){this._onStateChanged(t)};t.prototype.componentWillUnmount=function(){this._events.dispose();this._async.dispose()};t.prototype._onStateChanged=function(e){var t=this.state,n=t.files,r=t.inputElement,i=t.hasNothingHappened,o=this.props,u=o.onContinue,a=o.onCancel;if(!e.files&&n){u(s.buildEntriesFromFileList(n))}else if(!e.hasNothingHappened&&i)a();else if(!e.inputElement&&r){"directory"===this.props.type&&(r.webkitdirectory=!0);this._async.setTimeout(this._onNothingHappened,36e5);r.click()}};return t})(r.PureComponent);t.FileSystemDialog=a});
define("@ms/items-view/lib/private/components/commands/upload/uploadFolderCommand",["require","exports","react","../../../models/Facet","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../actions/upload/UploadFolderAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand={key:new r.Facet("uploadFolder").id,automationId:"uploadFolderCommand",name:i.default.UploadFolder,ariaLabel:i.default.UploadFolder,action:n.createElement(s.HideWithSelection,null,n.createElement(o.UploadFolderAction,null))}});
define("@ms/items-view/lib/private/components/actions/upload/UploadFolderAction",["require","exports","./UploadAction","../../fileSystemDialog/FileSystemDialog","@ms/utilities-browser/lib/PlatformDetection","../../decorators/connectToItemCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.createItemCacheComponent(function(e,t){return null}),u=new i.PlatformDetection,a=s.connectToItemCache(function(){return{type:"directory"}})(r.FileSystemDialog);t.UploadFolderAction=u.isFolderUploadSupported?s.connectToItemCache(function(){return{fileSelector:a}})(n.UploadAction):o});
define("@ms/items-view/lib/private/components/commands/upload/uploadCommandKey",["require","exports","../../../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadCommandKey=n.getNextId("upload")});
define("@ms/items-view/lib/private/components/commands/follow/followCommand",["require","exports","tslib","react","../../actions/follow/FollowAction","../Commands.resx","./followCommandKey"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){return e?s.default.RemoveFromSaved:s.default.SaveForLater};t.followCommand={key:o.followCommandKey,automationId:"followCommand",action:r.createElement(i.FollowAction,null),name:s.default.SaveForLater,postProcess:function(e){return n.__assign(n.__assign({},e),{name:e.iconOnly?void 0:u(e.actionState.isToggled)})},commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled,s="boolean"==typeof i&&u(i)||void 0;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"SingleBookmarkSolid":"SingleBookmark"},name:e.iconOnly?void 0:s,text:e.iconOnly?void 0:s,title:s,ariaLabel:s})):null}}});
define("@ms/items-view/lib/private/components/commands/follow/followCommandKey",["require","exports","../../../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.followCommandKey=n.getNextId("follow")});
define("@ms/items-view/lib/private/components/uploader/Uploader",["require","exports","tslib","react","../../utilities/async/CancelError","../../operations/uploadItems/uploadEntries","../../operations/uploadItems/UploadProgressAddon","../../operations/uploadItems/FileEntryAddon","../../hooks/usePreviousValue","../../hooks/useEventHandler","../../hooks/useItemCacheSelector"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Uploader=function(e){var t=this,c=e.resolve,h=e.reject,p=e.entries,d=e.itemKey,v=e.onUploadStarted,m=e.onUploadCompleted,g=e.onUploadFailed,y=e.onItemQueued,b=e.onItemUploaded,w=e.onItemFailed,E=r.useState(!1),S=E[0],x=E[1],T=r.useState(!1),N=T[0],C=T[1],k=r.useState(),L=k[0],A=k[1],O=r.useState(!1),M=O[0],_=O[1],D=r.useRef(),P=D.current||(D.current=new i.CancelSource);r.useLayoutEffect(function(){return function(){P.dispose();D.current=void 0}},[]);var H=a.usePreviousValue(N),B=a.usePreviousValue(L),j=a.usePreviousValue(M),F=l.useItemCacheDispatch(),I=f.useEventHandler(function(e){v&&v(e)}),q=f.useEventHandler(function(e){m&&m(e)}),R=f.useEventHandler(function(e){g&&g(e)}),U=f.useEventHandler(function(e){y&&y(e)}),z=f.useEventHandler(function(e){b&&b(e)}),W=f.useEventHandler(function(e){w&&w(e)}),X=f.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:x(!0);n.label=1;case 1:n.trys.push([1,3,,4]);F(o.uploadProgressAddon);e=F(u.createEntryBatch({entries:p})).itemKey;return[4,F(s.uploadEntryBatch({parentItemKey:d,sourceEntryKey:e,callbacks:{onEntryBatchCreated:I,onEntryBatchFailed:R,onEntryBatchUploaded:q,onItemFailed:W,onItemUploaded:z,onItemQueued:U},cancelToken:P.token}))];case 2:n.sent();if(P.token.isCanceled())return[2];_(!0);return[3,4];case 3:t=n.sent();if(P.token.isCanceled())return[2];i.isCancel(t)?C(!0):A(t);return[3,4];case 4:return[2]}})})});r.useLayoutEffect(function(){M&&!j?c():L&&!B?h(L):N&&!H?h(new i.CancelError):S||X()},[S,N,L,M]);return null}});
define("@ms/items-view/lib/private/operations/uploadItems/uploadEntries",["require","exports","tslib","../demandItems","../observeItems","../../facets/SetFacets","../../store/actions/createActionCreator","../../facets/ItemFacets","../uploadItems","../createFolder","../../facets/ProgressFacets","../../store/actions/implementOperation","../progress","../getItems","../../utilities/Graft","../../models/Facet","../../facets/GroupFacets","../../utilities/async/CancelError","../../utilities/async/all","../readItems","../../facets/FileSystemFacets","../../facets/DemandFacets","./UploadProgressKeyFacet","../pruneItems","../logQoS","./UploadFacets","../../models/icons/getTelemetrySafeFileExtension","@ms/telemetry-manager/lib/utilities/getQosEndSchemaFromError","@ms/telemetry-manager/lib/utilities/mergeQosEndSchema"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=0;var O=function(){},M={onItemQueued:O,onItemUploaded:O,onItemFailed:O,onEntryBatchCreated:O,onEntryBatchUploaded:O,onEntryBatchFailed:O};t.uploadEntryBatch=function e(t){var r=this,i=t.parentItemKey,s=t.sourceEntryKey,o=t.callbacks,u=void 0===o?M:o,a=t.options,f=void 0===a?{}:a;return function(o){return n.__awaiter(r,void 0,void 0,function(){var r,a,l,c,p,d;return n.__generator(this,function(n){switch(n.label){case 0:o(h.progressAddon);r=++A;a={operation:e};o(x.registerItemDemands({owner:a,items:(d={},d[s]={},d)}));l=new g.CancelSource;t.cancelToken&&t.cancelToken.subscribe(l.cancel);return[4,o(P({sourceEntryKey:s}))];case 1:c=n.sent();return[4,o(c({parentItemKey:i,cancelToken:l.token,callbacks:u,options:f,uploadId:r}))];case 2:p=n.sent().completed;n.label=3;case 3:n.trys.push([3,,5,6]);return[4,p];case 4:n.sent();return[3,6];case 5:l.dispose();o(x.removeItemDemands({owner:a}));return[7];case 6:return[2]}})})}};function _(e){var t=this,r=e.sourceEntryKey,i=e.cancelToken,o=e.onReceiveChildUploader,u=S.getUploadProgressKey(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={operation:_};e(x.registerItemDemands({owner:t,items:(a={},a[u]={},a)}));c.label=1;case 1:c.trys.push([1,,3,4]);e(p.resolveItems({items:(f={},f[u]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),f)}));return[4,e(D({itemKey:r,cancelToken:i,onReceiveChildKey:function(t){return n.__awaiter(l,void 0,void 0,function(){var r,a,f;return n.__generator(this,function(l){switch(l.label){case 0:i.throwIfCanceled();r=S.getUploadProgressKey(t);e(p.resolveItems({items:(f={},f[r]=n.__assign({},s.parentItemFacet.pack({itemKey:u})),f[u]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([r],function(e){return e})}}),f)}));a=o;return[4,e(P({sourceEntryKey:t}))];case 1:return[4,a.apply(void 0,[l.sent()])];case 2:l.sent();return[2]}})})}}))];case 2:c.sent();return[3,4];case 3:e(x.removeItemDemands({owner:t}));return[7];case 4:return[2]}})})}}function D(e){var t=this,o=e.itemKey,u=e.cancelToken,a=e.onReceiveChildKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,l=this;return n.__generator(this,function(c){switch(c.label){case 0:t={};return[4,e(r.demandItems(function(e){var t=e.demandItemFacet(s.defaultChildItemSetFacet,o);return t&&t.itemKey}))];case 1:return(f=c.sent())?[4,e(i.observeItemsUntilResolved(function(e){u&&u.throwIfCanceled();var t=e.demandItemFacet(s.childItemsFacet,f),n=[];if(t)for(var r=0,i=t.itemKeys;r<i.length;r++){var o=i[r];e.isItemFacetResolved(s.pageFacet,o)?e.demandItemFacet(s.childItemsFacet,o):n.push(o)}return n},function(e){return n.__awaiter(l,void 0,void 0,function(){var r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:r=0,i=e;n.label=1;case 1:return r<i.length?(s=i[r])in t?[3,3]:[4,a(s)]:[3,4];case 2:n.sent();t[s]=!0;n.label=3;case 3:r++;return[3,1];case 4:return[2]}})})}))]:[2];case 2:c.sent();return[2]}})})}}function P(e){var t=this,i=e.sourceEntryKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return e.demandItemFacet(w.entryBatchFacet,i)}))];case 1:return t.sent()?[2,H(i)]:[4,e(r.demandItems(function(e){return e.demandItemFacet(u.folderFacet,i)}))];case 2:return t.sent()?[2,B(i)]:[2,j(i)]}})})}}function H(e){var t=this;return o.createAsyncActionCreator(function(r){var i=r.parentItemKey,o=r.callbacks,u=r.options,a=r.uploadId,f=S.getUploadProgressKey(e);return function(c){var b,w,E=new g.CancelSource;r.cancelToken.subscribe(E.cancel);var S={operation:H};c(x.registerItemDemands({owner:{},items:(b={},b[f]={},b)}));c(p.resolveItems({items:(w={},w[h.progressRootItemKey]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([f],function(e){return e})}}),w[f]=n.__assign(n.__assign(n.__assign(n.__assign({},m.isGroupFacet.pack(!0)),l.cancelSourceFacet.pack(E)),l.sourceItemFacet.pack({itemKey:e})),l.destinationItemFacet.pack({itemKey:i})),w)}));var T=n.__awaiter(t,void 0,void 0,function(){var t,r,s=this;return n.__generator(this,function(f){switch(f.label){case 0:t=[];r=[];return[4,c(_({sourceEntryKey:e,cancelToken:E.token,onReceiveChildUploader:function(e){return n.__awaiter(s,void 0,void 0,function(){var s,f,l;return n.__generator(this,function(n){E.token.throwIfCanceled();s=c(e({parentItemKey:i,cancelToken:E.token,callbacks:o,options:u,uploadId:a})),f=s.started,l=s.completed;t.push(f);r.push(l);return[2]})})}}))];case 1:f.sent();return[2,{startedWork:t,completedWork:r}]}})}),N=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,T];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),C=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,T];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),k=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:e=c(F({uploadProgressKey:f,uploadId:a,qosName:"Uploader.uploadBatch"}));o.onEntryBatchCreated({progressItemKey:f});n.label=1;case 1:n.trys.push([1,,3,4]);return[4,c(h.trackItemProgress({progressItemKey:f,started:N,completed:C,onStarted:function(e){},onCompleted:function(t){o.onEntryBatchUploaded({progressItemKey:f});c(e({error:t.error}))},onFailed:function(t){o.onEntryBatchFailed({error:t.error||new Error("No error reported from batch upload."),progressItemKey:f});c(e({error:t.error}))}}))];case 2:n.sent();return[3,4];case 3:c(p.resolveItems({items:(t={},t[f]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));c(x.removeItemDemands({owner:S}));return[7];case 4:return[2]}})});return{started:N,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([C,k])];case 1:e.sent();return[2]}})})}}})}function B(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,a=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var A={operation:B};N(x.registerItemDemands({owner:A,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!0)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var O=N((function(e){var t=this;return function(i){var s=e.sourceEntryKey,o=e.parentItemKey,a=e.cancelToken,h=S.getUploadProgressKey(s),d=n.__awaiter(t,void 0,void 0,function(){var e,t,d,v,m,g,y,w,E,S=this;return n.__generator(this,function(x){switch(x.label){case 0:return[4,i(r.demandItems(function(e){return e.demandItemFacet(u.fileNameFacet,s)}))];case 1:if(!(e=x.sent()))throw new Error("Invalid folder name.");t={folders:(y={},y[e.name]={progressItemKey:h},y)};i(p.resolveItems({items:(w={},w[h]=n.__assign({},f.createFolderOperation.pack(t)),w)}));d=i(c.startOperation({operationTypeFacet:f.createFolderOperation,items:(E={},E[o]=t,E)})),v=d.started,m=d.completed;g=a.subscribe(function(){var e;i(c.cancelOperation({operationTypeFacet:f.createFolderOperation,items:(e={},e[o]=t,e)}))});n.__awaiter(S,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,v];case 1:e.sent();g();return[2]}})});return[2,{started:v,itemCreated:n.__awaiter(S,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,m];case 1:n.sent();e=i(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,h)}));if(!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}})})}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),itemCreated:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token})),M=O.started,D=O.itemCreated,P=n.__awaiter(t,void 0,void 0,function(){var t,r,i,s=this;return n.__generator(this,function(u){switch(u.label){case 0:return[4,D];case 1:t=u.sent();r=[M];i=[];return[4,N(_({sourceEntryKey:e,cancelToken:L.token,onReceiveChildUploader:function(e){return n.__awaiter(s,void 0,void 0,function(){var s,u,f;return n.__generator(this,function(n){s=N(e({parentItemKey:t,cancelToken:L.token,callbacks:o,options:a,uploadId:w})),u=s.started,f=s.completed;r.push(u);i.push(f);return[2]})})}}))];case 2:u.sent();return[2,{startedWork:r,completedWork:i}]}})}),H=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,P];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),j=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=y.waitForAll;return[4,P];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})}),I=n.__awaiter(t,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(i){switch(i.label){case 0:e=N(F({uploadProgressKey:T,uploadId:w,qosName:"Uploader.createFolder"}));o.onItemQueued({progressItemKey:T});i.label=1;case 1:i.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:H,completed:n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,D];case 1:e.sent();return[2]}})}),onStarted:function(e,t){t&&t(e)},onCompleted:function(t,n){n&&n(t);o.onItemUploaded({progressItemKey:T});N(e({error:t.error}))},onFailed:function(t,n){n&&n(t);o.onItemFailed({progressItemKey:T});N(e({error:t.error}))}}))];case 2:i.sent();return[3,4];case 3:N(p.resolveItems({items:(t={},t[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),t)}));L.dispose();N(x.removeItemDemands({owner:A}));return[7];case 4:return[2]}})}),q=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=N(F({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFolder"}));return[4,N(h.trackItemProgress({progressItemKey:T,started:H,completed:j,onStarted:function(e,t){},onCompleted:function(t,n){N(e({error:t.error}))},onFailed:function(t,n){N(e({error:t.error}))}}))];case 1:t.sent();return[2]}})});return{started:H,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([j,I,q])];case 1:e.sent();return[2]}})})}}})}function j(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,f=i.options,w=i.uploadId,T=S.getUploadProgressKey(e);return function(N){var C,k,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var A=N(F({uploadProgressKey:T,uploadId:w,qosName:"Uploader.uploadFile"}));if(N(b.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,T)})))return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};var O={operation:j};N(x.registerItemDemands({owner:O,items:(C={},C[T]={},C[e]={},C)}));N(p.resolveItems({items:(k={},k[T]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},E.errorFacet.pack(void 0)),l.progressPhaseFacet.pack(l.ProgressPhase.created)),m.isGroupFacet.pack(!1)),l.destinationItemFacet.pack({itemKey:s})),l.sourceItemFacet.pack({itemKey:e})),l.cancelSourceFacet.pack(L)),k)}));var M=N((function(e){var t=this,i=e.sourceEntryKey,s=e.parentItemKey,o=e.cancelToken,f=e.options,h=S.getUploadProgressKey(i);return function(e){var d,v={sourceEntries:(d={},d[i]=n.__assign({progressItemKey:h},f),d)},m=n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return{fileSize:e.demandItemFacet(u.fileSizeFacet,i),fileName:e.demandItemFacet(u.fileNameFacet,i)}}))];case 1:return[4,t.sent()];case 2:return[2,t.sent()]}})}),g=n.__awaiter(t,void 0,void 0,function(){var t,r,i,u,f,d,g,y=this;return n.__generator(this,function(b){switch(b.label){case 0:return[4,m];case 1:void 0!==(t=b.sent().fileSize)&&e(p.resolveItems({items:(d={},d[h]=n.__assign({},l.progressSizeFacet.pack({total:t,current:0})),d)}));r=e(c.startOperation({operationTypeFacet:a.uploadItemsOperation,items:(g={},g[s]=v,g)})),i=r.started,u=r.completed;f=o.subscribe(function(){var t;e(c.cancelOperation({operationTypeFacet:a.uploadItemsOperation,items:(t={},t[s]=v,t)}))});n.__awaiter(y,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,i];case 1:e.sent();f();return[2]}})});return[2,{started:i,completed:u}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,g];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,g];case 1:return[4,e.sent().completed];case 2:e.sent();return[2]}})})}}})({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token,options:f})),_=M.started,D=M.completed,P=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:o.onItemQueued({progressItemKey:T});t.label=1;case 1:t.trys.push([1,,3,4]);return[4,N(h.trackItemProgress({progressItemKey:T,started:_,completed:D,onStarted:function(e,t){t&&t(e)},onCompleted:function(e,t){t&&t(e);o.onItemUploaded({progressItemKey:T});N(A({error:e.error}))},onFailed:function(e,t){t&&t(e);o.onItemFailed({progressItemKey:T});N(A({error:e.error}))}}))];case 2:t.sent();return[3,4];case 3:N(p.resolveItems({items:(e={},e[T]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));L.dispose();N(x.removeItemDemands({owner:O}));return[7];case 4:return[2]}})});return{started:_,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y.waitForAll([D,P])];case 1:e.sent();return[2]}})})}}})}function F(e){var t=e.qosName,r=e.uploadProgressKey,i=e.uploadId;return function(e){var s=e(T.logQoS({name:t}));return function(t){var o=t.error;return function(){var t=e(b.readItems(function(e){var t=e.demandItemFacet(l.sourceItemFacet,r),n=t&&t.itemKey,i=e.demandItemFacet(u.folderFacet,n),s=e.demandItemFacet(w.entryBatchFacet,n);return{entryBatch:s,folder:i,fileName:e.demandItemFacet(u.fileNameFacet,n),uploadStats:i||s?e.demandItemFacet(N.uploadStatsProgressFacet,r):void 0,progressSize:e.demandItemFacet(N.overallUploadProgressSizeFacet,r)}})),a=t.entryBatch,f=t.folder,c=t.fileName,h=t.uploadStats,p=t.progressSize,d=C.getTelemetrySafeFileExtension(c&&c.extension),v=a?"Batch":f?"Folder":"File",m=p?p.total:0,g=p?p.current:0;e(s(L.mergeQosEndSchema(k.getQosEndSchemaFromError(o),{extraData:n.__assign(n.__assign({uploadId:i,totalBytes:m,uploadedBytes:g,objectType:v},a?{}:{extension:d}),h?{"count.file.started":h.file.started,"count.file.completed":h.file.completed,"count.file.failed":h.file.failed,"count.file.canceled":h.file.canceled,"count.folder.started":h.folder.started,"count.folder.completed":h.folder.completed,"count.folder.failed":h.folder.failed,"count.folder.canceled":h.folder.canceled}:{})})))}}}}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressKeyFacet",["require","exports","../../models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=new n.KeyFacet("uploadProgress",{sourceEntryKey:n.stringPart()});t.getUploadProgressKey=function(e){return t.uploadProgressKeyFacet.serialize({sourceEntryKey:e})}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadFacets",["require","exports","tslib","../../facets/ProgressFacets","../../facets/SetFacets","../../facets/ItemFacets","../../models/itemCache/ComputedItemFacet","../../facets/FileSystemFacets"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadStatsProgressFacet=new o.ComputedItemFacet("uploadStats",function(e,n){var o,c={file:a(),folder:a(),extensions:{}},h=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(h)for(var p=0,d=h.itemKeys;p<d.length;p++){var v=d[p],m=e.demandItemFacet(t.uploadStatsProgressFacet,v);if(m){f(c.file,m.file);f(c.folder,m.folder);l(c.extensions,m.extensions)}}var g=e.demandItemFacet(r.sourceItemFacet,n.itemKey),y=g&&g.itemKey;if(y){var b=e.demandItemFacet(s.folderFacet,y),w=e.demandItemFacet(r.progressPhaseFacet,n.itemKey),E=r.getSimpleProgessPhase(w||r.ProgressPhase.expired),S=r.getItemCountsBySimpleProgressPhase(E);if(e.demandItemFacet(u.entryBatchFacet,y));else if(b)f(c.folder,S);else{f(c.file,S);var x=e.demandItemFacet(s.fileNameFacet,y),T=x&&x.extension||"unknown";l(c.extensions,((o={})[T]=S,o))}}return c});t.overallUploadProgressSizeFacet=new o.ComputedItemFacet("overallUploadProgressSize",function(e,n){var o=e.demandItemFacet(r.progressSizeFacet,n.itemKey);if(o)return o;var u=e.demandItemFacet(i.childItemsFacet,n.itemKey);if(u){for(var a={total:0,current:0},f=0,l=u.itemKeys;f<l.length;f++){var c=l[f],h=e.demandItemFacet(t.overallUploadProgressSizeFacet,c);if(!h)return;a.total+=h.total;a.current+=h.current}return a}var p=e.demandItemFacet(r.sourceItemFacet,n.itemKey);if(p){var d=e.demandItemFacet(s.fileSizeFacet,p.itemKey);if("number"!=typeof d)return;return{total:d,current:e.demandItemFacet(r.createdItemFacet,n.itemKey)?d:0}}});function a(e){var t={started:0,completed:0,canceled:0,failed:0};if(e){t.started+=e.started;t.completed+=e.completed;t.failed+=e.failed;t.canceled+=e.canceled}return t}function f(e,t){e.started+=t.started;e.completed+=t.completed;e.failed+=t.failed;e.canceled+=t.canceled}function l(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var s=i[r],o=t[s];s in e?f(e[s],o):e[s]=n.__assign({},o)}}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressAddon",["require","exports","tslib","react","../../addons/registerOperationHandler","../../store/actions/implementOperation","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../../components/uploader/UploadStrings.resx","../../components/progress/ProgressStrings.resx","../../operations/getItems","@ms/items-view-utilities/lib/string/DriveSpaceHelper","../../operations/progress","../../facets/ProgressFacets","../../facets/ItemFacets","../../facets/FileSystemFacets","../readItems","../../components/itemLink/ItemLink","../../operations/progress/cancelProgressItems","../../components/progress/commands/retry/retryProgressCommand","../progress/retryProgressItems","../../components/progress/commands/replace/replaceProgressCommand","../../components/progress/commands/rename/renameProgressCommand","../progress/resolveProgressItems","../../models/Facet","../../facets/ErrorFacets","../../facets/DemandFacets","./UploadProgressKeyFacet","./uploadEntries","./UploadProgressErrorKeyFacet","../../facets/ConfigurationFacets","../../models/configuration/getConfiguration","./UploadFacets","../progress/handlers/createCancelProgressItemsOperationHandler","../../controls/uploadProgressControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){"use strict";var B,j;Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=L.uploadProgressKeyFacet;t.getUploadProgressKey=L.getUploadProgressKey;var F=((B={})[d.ProgressPhase.started]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},B[d.ProgressPhase.completed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},B[d.ProgressPhase.failed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},B[d.ProgressPhase.canceled]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},B),I=((j={})[d.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(y.ItemLink,{key:"link",itemKey:n}))},j[d.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(y.ItemLink,{key:"link",itemKey:n}))},j[d.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(y.ItemLink,{key:"link",itemKey:n}))},j[d.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(y.ItemLink,{key:"link",itemKey:n}))},j);t.uploadProgressAddon=i.createAddon(function(){return function(e){e(i.registerOperationHandler(L.uploadProgressKeyFacet,c.getItemsOperation)(i.createSingleItemOperationHandler()(U)));e(o.registerControlHandler(L.uploadProgressKeyFacet,u.progressControl)(o.createControlHandler()(q)));e(i.registerOperationHandler(L.uploadProgressKeyFacet,b.cancelProgressItemsOperation)(P.createCancelProgressItemsOperationHandler(L.uploadProgressKeyFacet)));e(i.registerOperationHandler(L.uploadProgressKeyFacet,E.retryProgressItemsOperation)(i.createSingleItemOperationHandler()(z)));e(i.registerOperationHandler(L.uploadProgressKeyFacet,T.resolveProgressItemsOperation)(i.createSingleItemOperationHandler()(W)))}});function q(){return function(e){return R}}function R(e,t){var r,i=e.demandItemFacet(d.sourceItemFacet,t.itemKey),o=e.demandItemFacet(m.entryBatchFacet,i&&i.itemKey);r=i&&!o?(function(e,t){var r,i=_.getConfiguration(e,{enableNewConflictUploadErrorStrings:M.enableNewConflictUploadErrorStringsConfigurationFacet}).enableNewConflictUploadErrorStrings,o=e.demandItemFacet(D.overallUploadProgressSizeFacet,t.itemKey),u=o?o.total>0?o.current/o.total:1:void 0,a=p.getOverallProgressPhase(e,t),c=e.demandItemFacet(v.folderFacet,t.sourceItemKey);a===d.ProgressPhase.completed&&o?r=h.default.getDisplayString(o.total):c?a!==d.ProgressPhase.created&&a!==d.ProgressPhase.started||(r=X(o)||l.default.genericStartedIndeterminateDescription):a===d.ProgressPhase.started?r=X(o):a===d.ProgressPhase.created&&(r=l.default.genericCreatedDescription);var m,g=e.demandItemFacet(k.errorFacet,t.itemKey),y=[];if(g)if(g instanceof s.ItemOperationError){var b=N.unpack({conflict:C.conflictErrorFacet,retry:C.retryErrorFacet,offline:C.offlineErrorFacet,accessDenied:C.accessDeniedErrorFacet,invalidName:C.invalidNameErrorFacet,emptyFolder:C.emptyFolderUnsupportedFacet,overQuota:C.overQuotaErrorFacet,lockMismatch:C.lockMismatchErrorFacet,authFailure:C.authFailureErrorFacet,folderUpload:C.folderUploadUnsupportedFacet,targetFolder:C.targetFolderErrorFacet,malware:C.malwareErrorFacet,throttle:C.throttleErrorFacet},g.facets),E=b.conflict,T=b.retry,L=b.offline,A=b.accessDenied,P=b.invalidName,H=b.emptyFolder,B=b.overQuota,j=b.lockMismatch,F=b.authFailure,I=b.folderUpload,q=b.targetFolder,R=b.malware,U=b.throttle;if(E){r=i?f.default.newConflictUploadWithoutRenameErrorText:f.default.conflictUploadWithoutRenameErrorText;y.push(i?S.addNewVersionProgressCommand:S.replaceProgressCommand);if(E.supportsRename){r=i?f.default.newConflictUploadErrorText:f.default.conflictUploadErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"conflict+rename"});y.push(x.renameProgressCommand)}else m=O.uploadProgressErrorKeyFacet.serialize({type:"conflict"})}else if(A){r=f.default.accessDeniedUploadErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"accessDenied"})}else if(P){r=f.default.invalidNameUploadErrorText;y.push(x.renameProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"invalidName"})}else if(H||I){r=f.default.folderUploadNotSupported;m=O.uploadProgressErrorKeyFacet.serialize({type:"folderUpload"})}else if(B){r=f.default.overQuotaSharedFolderUploadErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"overQuota"})}else if(j){r=f.default.lockMismatchUploadErrorText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"lockMismatch"})}else if(F){r=f.default.authFailureUploadErrorText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"authFailure"})}else if(q){r=f.default.targetFolderMissingUploadErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"targetFolder"})}else if(R){r=f.default.malwareDetectedUploadErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"malware"})}else if(U){r=f.default.throttledUploadErrorText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"throttle"})}else if(L){r=f.default.disconnectedUploadText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"offline"})}else if(!T){r=g.message||f.default.generalUploadNoRetryErrorText;m=O.uploadProgressErrorKeyFacet.serialize({type:"noRetry"})}if(T){r=f.default.generalUploadErrorText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"retry"})}}else{r=g.message||f.default.generalUploadErrorText;y.push(w.retryProgressCommand);m=O.uploadProgressErrorKeyFacet.serialize({type:"unknown"})}return n.__assign(n.__assign(n.__assign({percentComplete:u},m?{errorKey:m}:{}),r?{description:r}:{}),{commands:y})})(e,{itemKey:t.itemKey,sourceItemKey:i.itemKey}):(function(e,t){var r,i,s=e.demandItemFacet(D.overallUploadProgressSizeFacet,t.itemKey),o=s?s.total>0?s.current/s.total:1:void 0,u=e.demandItemFacet(d.destinationItemFacet,t.itemKey),a=u&&u.itemKey,f=p.getOverallSimpleProgressBreakdown(e,t),c=f.phase,v=f.count;c===d.ProgressPhase.completed&&s?r=h.default.getDisplayString(s.total):c===d.ProgressPhase.started&&(r=X(s)||l.default.genericStartedIndeterminateDescription);i="group"===t.format&&a?I[c]({count:v,itemKey:a}):F[c]({count:v});return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),r?{description:r}:{}),{percentComplete:o})})(e,t);var u=e.demandItemFacet(H.uploadProgressControl,t.itemKey),a=H.uploadProgressControl.evaluate(u)(e,{itemKey:t.itemKey,commands:r.commands,description:r.description}),c=a.description,g=a.commands,y=void 0===g?[]:g;return n.__assign(n.__assign(n.__assign({},r),{commands:y}),c?{description:c}:{})}function U(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}}function z(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:t=e(g.readItems(function(e){return{sourceItem:e.demandItemFacet(d.sourceItemFacet,r),destinationItem:e.demandItemFacet(d.destinationItemFacet,r)}})),i=t.sourceItem,s=t.destinationItem;o=i&&i.itemKey;u=s&&s.itemKey;if(!o)throw new Error("No source entry to retry.");if(!u)throw new Error("No parent item to retry.");return[4,e(A.uploadEntryBatch({sourceEntryKey:o,parentItemKey:u}))];case 1:n.sent();return[2]}})})}}function W(e){var t=this,r=e.itemKey,i=e.options;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=e(g.readItems(function(e){return{sourceItem:e.demandItemFacet(d.sourceItemFacet,r),destinationItem:e.demandItemFacet(d.destinationItemFacet,r)}})),s=t.sourceItem,o=t.destinationItem;u=s&&s.itemKey;a=o&&o.itemKey;if(!u)throw new Error("No source entry to retry.");if(!a)throw new Error("No parent item to retry.");return[4,e(A.uploadEntryBatch({sourceEntryKey:u,parentItemKey:a,options:i}))];case 1:n.sent();return[2]}})})}}function X(e){return e&&e.total>0?a.format(l.default.genericStartedByteProgressDescription,h.default.getDisplayString(e.current),h.default.getDisplayString(e.total)):void 0}});
define("@ms/items-view/lib/private/components/itemLink/ItemLink",["require","exports","react","../withItemCache/WithItemCache","../withAction/WithAction","office-ui-fabric-react/lib/Link","../actions/defaultClick/DefaultClickAction","../../facets/ItemFacets","../../models/itemsScope/getCurrentItemKey","../../models/items/haveSameParentItem"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemLink=function(e){var t=e.itemKey;return n.createElement(r.WithItemCache,null,function(r){var l,c=r.itemCache;if(e.children)l=e.children;else{var h=c.demandItemFacet(u.displayNameFacet,t);l=h}var p=a.getCurrentItemKey(c),d=f.haveSameParentItem(c,{itemKey1:t,itemKey2:p})?null:n.createElement(o.ItemDefaultClickAction,{itemKey:t});return n.createElement(i.WithAction,{action:d},function(e){var t=e.isAvailable,r=e.execute,i=t?function(){r().catch(function(){})}:void 0;return i?n.createElement(s.Link,{onClick:i},l):n.createElement("span",null,l)})})}});
define("@ms/items-view/lib/private/models/items/haveSameParentItem",["require","exports","./getItemKey","./getPreferredItemKey"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.haveSameParentItem=function(e,t){var i=n.getItemKey(e,{itemKey:t.itemKey1}),s=n.getItemKey(e,{itemKey:t.itemKey2});return r.getPreferredItemKey(e,{itemKey:i})===r.getPreferredItemKey(e,{itemKey:s})}});
define("@ms/items-view/lib/private/components/progress/commands/retry/retryProgressCommand",["require","exports","react","../../actions/retry/RetryProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressCommand={key:new i.Facet("retryProgressCommand").id,name:s.default.progressRetryActionText,action:n.createElement(r.RetryProgressAction,null)}});
define("@ms/items-view/lib/private/components/progress/actions/retry/RetryProgressAction",["require","exports","tslib","react","../../../../operations/progress/retryProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){f(i.retryProgressItems({items:s.makeObject(a,function(){return{}})}));return[2]})})},isAvailable:a.length>0})});t.RetryProgressAction=a.withSelectedItems()(t.ItemRetryProgressAction)});
define("@ms/items-view/lib/private/operations/progress/retryProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressItemsOperation=new n.Facet("retryProgressItemsOperation");t.retryProgressItems=r.implementOperation({operationTypeFacet:t.retryProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/commands/replace/replaceProgressCommand",["require","exports","react","../../actions/resolve/ResolveProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressReplaceActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})};t.addNewVersionProgressCommand={key:new i.Facet("addNewVersionProgressCommand").id,name:s.default.progressAddNewVersionActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})}});
define("@ms/items-view/lib/private/components/progress/actions/resolve/ResolveProgressAction",["require","exports","tslib","react","../../../../operations/progress/resolveProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemResolveProgressAction=f.createItemCacheComponent(function(e,t){var a=t.itemKeys,f=t.conflictResolution,l=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),c=e.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){c(i.resolveProgressItems({items:s.makeObject(l,function(){return{conflictResolution:f}})}));return[2]})})},isAvailable:l.length>0})});t.ResolveProgressAction=a.withSelectedItems()(t.ItemResolveProgressAction)});
define("@ms/items-view/lib/private/operations/progress/resolveProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveProgressItemsOperation=new n.Facet("resolveProgressItemsOperation");t.resolveProgressItems=r.implementOperation({operationTypeFacet:t.resolveProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/commands/rename/renameProgressCommand",["require","exports","react","../../actions/resolve/ResolveProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressRenameActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"rename"})}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressErrorKeyFacet",["require","exports","../../models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressErrorKeyFacet=new n.KeyFacet("uploadProgress",{type:n.stringPart()})});
define("@ms/items-view/lib/private/operations/progress/handlers/createCancelProgressItemsOperationHandler",["require","exports","tslib","../../../addons/registerOperationHandler","../../readItems","../../../models/items/ItemResolver","../../../facets/ProgressFacets","../../../models/Facet","../../../facets/DemandFacets","../../../utilities/Graft","../../../facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createCancelProgressItemsOperationHandler=function(e){return r.createBatchedItemsOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,c,h;return n.__generator(this,function(p){t=r(i.readItems(function(t){var r=new s.ItemResolver,i=[];function c(e){var s,h=t.demandItemFacet(o.cancelSourceFacet,e);h&&i.push(h);r.resolveItems({items:(s={},s[e]=n.__assign(n.__assign({},h?{}:n.__assign({},o.progressPhaseFacet.pack(o.ProgressPhase.canceled))),u.pack({error:a.errorFacet},{error:new f.Delete})),s)});var p=t.demandItemFacet(l.childItemsFacet,e);if(p)for(var d=0,v=p.itemKeys;d<v.length;d++){c(v[d])}}for(var h in e.items)Object.prototype.hasOwnProperty.call(e.items,h)&&c(h);return{itemResolver:r,sourcesToCancel:i}}));r(t.itemResolver.execute());for(c=0,h=t.sourcesToCancel;c<h.length;c++)h[c].cancel();return[2]})})}})}});
define("@ms/items-view/lib/private/operations/uploadItems/FileEntryAddon",["require","exports","tslib","../../operations/getItems","../../operations/resolveItems","../../operations/clearItems","../../operations/deleteItems","../../models/KeyFacet","../../models/AutoKeyFacet","../../models/Facet","../../addons/registerOperationHandler","../../facets/SetFacets","../../facets/ItemFacets","../../operations/readItems","../../models/items/ItemResolver","../../models/items/PageHelpers","../../facets/FileSystemFacets","../batch/asBatch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=new a.AutoKeyFacet("batch");var b=new u.KeyFacet("batchChildren",{batch:u.subKeyPart(y)}),w=new u.KeyFacet("fileEntry",{batch:u.subKeyPart(y),index:u.numberPart(),path:u.stringPart()}),E=new u.KeyFacet("fileEntryChildren",{fileEntry:u.subKeyPart(w)}),S=new u.KeyFacet("fileEntryDirectoryPage",{fileEntryChildren:u.subKeyPart(E),startIndex:u.numberPart()}),x=new f.Facet("entry"),T=new f.Facet("rootEntries"),N=new f.Facet("directoryPage");t.fileEntryAddon=l.createAddon(function(){return function(e){e(g.asBatch(function(){e(i.supportFacets({keyFacet:y,facets:[c.defaultChildItemSetFacet]}));e(i.supportFacets({keyFacet:b,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:w,facets:[h.displayNameFacet,c.defaultChildItemSetFacet,m.sourceFileFacet,h.fileSizeFacet,h.fileNameFacet,h.folderFacet,h.parentFolderItemFacet,h.dateModifiedFacet]}));e(i.supportFacets({keyFacet:E,facets:[c.childItemsFacet]}));e(i.supportFacets({keyFacet:S,facets:[c.childItemsFacet]}));e(l.registerOperationHandler(y,r.getItemsOperation)(l.createSingleItemOperationHandler()(C)));e(l.registerOperationHandler(b,r.getItemsOperation)(l.createSingleItemOperationHandler()(k)));e(l.registerOperationHandler(w,r.getItemsOperation)(l.createSingleItemOperationHandler()(L)));e(l.registerOperationHandler(E,r.getItemsOperation)(l.createSingleItemOperationHandler()(A)));e(l.registerOperationHandler(S,r.getItemsOperation)(l.createSingleItemOperationHandler()(O)));e(l.registerOperationHandler(y,o.deleteItemsOperation)(l.createSingleItemOperationHandler()(M)))}))}});t.createEntryBatch=function(e){return function(r){var s;r(t.fileEntryAddon);var o=y.serializeNext();r(i.resolveItems({items:(s={},s[o]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),T.pack(e.entries)),s)}));return{itemKey:o}}};function C(e){var t=this,r=e.itemKey,s=y.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(o){e(p.readItems(function(e){return e.demandItemFacet(T,r)}))&&e(i.resolveItems({items:(t={},t[r]=n.__assign(n.__assign({},m.entryBatchFacet.pack({})),c.defaultChildItemSetFacet.pack({itemKey:b.serialize({batch:s})})),t)}));return[2]})})}}function k(e){var t=this,r=e.itemKey,i=b.deserialize(r).batch,s=y.serialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f,l,h,v,m,g;return n.__generator(this,function(y){if(t=e(p.readItems(function(e){return e.demandItemFacet(T,s)}))){o=new d.ItemResolver;u=[];a=0;for(f=0,l=t;f<l.length;f++){h=l[f];v=w.serialize({batch:i,index:a,path:h.name});o.resolveItems({items:(m={},m[v]=n.__assign({},x.pack(h)),m)});u.push(v);a++}o.resolveItems({items:(g={},g[r]=n.__assign({},c.childItemsFacet.pack({itemKeys:u})),g)});e(o.execute())}return[2]})})}}function L(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u;return n.__generator(this,function(a){switch(a.label){case 0:if(!(t=e(p.readItems(function(e){return e.demandItemFacet(x,r)}))))return[3,2];e(i.resolveItems({items:(o={},o[r]=n.__assign(n.__assign(n.__assign({},h.displayNameFacet.pack(t.name)),2===t.type?n.__assign(n.__assign(n.__assign({},h.folderFacet.pack({})),h.fileNameFacet.pack({name:t.name,extension:""})),c.defaultChildItemSetFacet.pack({itemKey:E.serialize({fileEntry:w.deserialize(r)})})):n.__assign(n.__assign({},c.defaultChildItemSetFacet.pack(void 0)),h.folderFacet.pack(void 0))),1===t.type?n.__assign({},h.fileNameFacet.pack(_(t.name))):{}),o)}));return 1!==t.type&&0!==t.type?[3,2]:[4,t.getFile()];case 1:s=a.sent();e(i.resolveItems({items:(u={},u[r]=n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},h.fileNameFacet.pack(_(s.name))),h.folderFacet.pack(void 0)),h.fileSizeFacet.pack(s.size)),h.dateModifiedFacet.pack(s.lastModified)),m.sourceFileFacet.pack(s)),u)}));a.label=2;case 2:return[2]}})})}}function A(e){var t=this,r=e.itemKey,i=E.deserialize(r),s=i.fileEntry,o=w.serialize(s);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,l,m,g,y,b,E,T,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return(t=e(p.readItems(function(e){return e.demandItemFacet(x,w.serialize(s))})))&&2===t.type?[4,t.getEntries()]:[3,2];case 1:u=O.sent();a=new d.ItemResolver;f=u.entries,l=u.getEntries;m=[];g=0;for(y=0,b=f;y<b.length;y++){E=b[y];T=w.serialize(n.__assign(n.__assign({},s),{index:g,path:s.path+"/"+E.name}));a.resolveItems({items:(k={},k[T]=n.__assign(n.__assign({},x.pack(E)),h.parentFolderItemFacet.pack({itemKey:o})),k)});m.push(T);g++}if(l){C=S.serialize({fileEntryChildren:i,startIndex:g});a.merge(v.resolveNewPage({itemKey:C}).itemResolver);a.resolveItems({items:(L={},L[C]=n.__assign({},N.pack(u)),L)});m.push(C)}a.resolveItems({items:(A={},A[r]=n.__assign(n.__assign({},c.childItemsFacet.pack({itemKeys:m})),c.parentItemFacet.pack({itemKey:o})),A)});e(a.execute());O.label=2;case 2:return[2]}})})}}function O(e){var t=this,r=e.itemKey,i=S.deserialize(r),s=i.fileEntryChildren,o=i.startIndex,u=s.fileEntry,a=w.serialize(u);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,f,l,c,m,g,y,b,T,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:return(t=e(p.readItems(function(e){return e.demandItemFacet(N,r)})))&&t.getEntries?[4,t.getEntries()]:[3,2];case 1:i=A.sent();f=new d.ItemResolver;l=i.entries,c=i.getEntries;m=[];for(g=0,y=l;g<y.length;g++){b=y[g];T=w.serialize(n.__assign(n.__assign({},u),{path:u.path+"/"+b.name}));f.resolveItems({items:(k={},k[T]=n.__assign(n.__assign({},x.pack(b)),h.parentFolderItemFacet.pack({itemKey:a})),k)});m.push(T)}if(c){C=S.serialize({fileEntryChildren:s,startIndex:o+l.length});f.merge(v.resolveNewPage({itemKey:C}).itemResolver);f.resolveItems({items:(L={},L[C]=n.__assign({},N.pack(i)),L)});m.push(C)}f.merge(v.resolveExistingPage({itemKey:r,itemSetKey:E.serialize(s),childItemKeys:m}).itemResolver);e(f.execute());A.label=2;case 2:return[2]}})})}}function M(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){e(s.clearItems({items:e(p.readItems(function(e){for(var t,n={},i=[r];t=i.pop();){n[t]=!0;var s=e.demandItemFacet(c.defaultChildItemSetFacet,t),o=s&&s.itemKey;o&&(n[o]=!0);var u=e.demandItemFacet(c.childItemsFacet,o),a=u&&u.itemKeys;a&&i.push.apply(i,a)}return n}))}));return[2]})})}}function _(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}});
define("@ms/items-view/lib/private/components/actions/DeferredActions",["require","exports","tslib","../progress/callout/ProgressCallout","./createFolder/CreateFolderWizard","../base/actions/createFolder/CreateFolderDialog","./createDocument/DocumentCreator","./delete/DeleteActionExecutor","./rename/RenameActionExecutor","./launchMoveCopyPicker/LaunchMoveCopyPickerWizard"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t)});
define("@ms/items-view/lib/private/components/progress/callout/ProgressCallout",["require","exports","tslib","react","office-ui-fabric-react/lib/Callout","@uifabric/utilities/lib/componentAs/composeComponentAs","office-ui-fabric-react/lib/FocusTrapZone","ODCItemsScopeDeferred_css","../../../utilities/objects","../../decorators/withControlHandler","../../../controls/progressListControl","../list/ProgressList","office-ui-fabric-react/lib/components/Button/ActionButton/ActionButton","../ProgressStrings.resx","../../../operations/progress","../../decorators/connectToItemCache","../../../facets/ProgressFacets","../../../hooks/useItemCacheSelector","../../../hooks/useEventHandler","../../../hooks/usePreviousValue","../../../controls/progressCalloutControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";u=u.ProgressCallout_7;Object.defineProperty(t,"__esModule",{value:!0});function E(e){var t=r.useState(!0),i=t[0],s=t[1];r.useEffect(function(){var e=setTimeout(function(){s(!1)},0);return function(){clearTimeout(e)}},[]);return r.createElement(o.FocusTrapZone,n.__assign({},e,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disabled:i}),e.children)}function S(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:u.progressList,role:"presentation"},r.createElement(f.ControlHandlerProvider,{controlHandlers:l.progressListControl.pack(x)},r.createElement(c.ProgressList,{itemKeys:e.itemKeys,role:"presentation"}))),e.showViewAll?r.createElement("div",{className:u.viewAllButton,role:"presentation"},r.createElement(h.ActionButton,{onClick:e.onViewAllClick},p.default.progressViewAllActionText)):null)}t.ProgressCallout=v.connectToItemCache(function(e,t){var n=t.finishedItemKeys.filter(function(t){var n=d.getOverallProgressPhase(e,{itemKey:t});return n===m.ProgressPhase.completed||n===m.ProgressPhase.canceled}),r=e.demandItemFacet(w.progressCalloutControl,d.progressRootItemKey);return{contentAs:w.progressCalloutControl.evaluate(r)(e,{contentAs:S}).contentAs,itemKeysToExpire:n}})(function(e){var t=e.isExecuting,n=e.finishedItemKeys,o=e.target,f=e.doNotExpire,l=e.onDismiss,c=e.onViewAll,h=e.itemKeysToExpire,p=r.useState(!0),v=p[0],m=p[1],w=g.useItemCacheDispatch(),x=r.useMemo(function(){return a.makeObject(n||[],function(){return!0})},[n]),T=b.usePreviousValue(x);r.useEffect(function(){if(!t){for(var e=T||{},r=!1,i=0,s=n;i<s.length;i++){s[i]in e||(r=!0)}r&&m(!1)}},[t,n]);var N=r.useMemo(function(){return n.slice(-1)},[n]),C=b.usePreviousValue(N);r.useEffect(function(){if(C){var e=C[0];e&&(e in x||m(!0))}},[x]);r.useEffect(function(){if(v){f||w(d.expireProgressItems({items:a.makeObject(h,function(){return!0})}));l()}},[v,l]);var k=y.useEventHandler(function(e){e&&e.stopPropagation();c&&c(e)}),L=function(){m(!0)};if(t||v||!n.length)return null;var A=e.contentAs!==S?s.composeComponentAs(e.contentAs,S):S;return r.createElement(i.Callout,{target:o,role:"alert","aria-live":"assertive",directionalHint:i.DirectionalHint.bottomCenter,onDismiss:L,isBeakVisible:!1},r.createElement(E,{className:u.callout,role:"presentation"},r.createElement(A,{itemKeys:N,onViewAllClick:k,onCalloutDismiss:L,showViewAll:n.length>1})))});function x(e,t){return{groupControlHandler:T}}function T(e,t){return(t.childItemKeys?t.childItemKeys.length:0)>3?{maxChildItemCount:0}:{}}});
define("@ms/items-view/lib/private/components/actions/createFolder/CreateFolderWizard",["require","exports","tslib","react","../../../utilities/async/CancelError","../../nameDialog/NameDialog","../../scope/actions/createDocument/DocumentCreator.resx","./CreateFolder.resx","@ms/utilities-strings/lib/index","../../accessibility/alert/Alert","../../../hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderWizard=function(e){var t=this,c=e.resolve,h=e.reject,p=e.onCreateFolder,d=e.maxLength,v=e.title,m=e.validator,g=r.useState(),y=g[0],b=g[1],w=l.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return p?[4,p(e)]:[3,2];case 1:t.sent();t.label=2;case 2:b(e.name);return[2]}})})}),E=l.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){h(new i.CancelError);return[2]})})});return y?r.createElement(f.Alert,{onStart:c},a.format(u.default.createFolderCompletedFormat,y)):r.createElement(s.NameDialog,{nameFieldAriaLabel:o.default.FolderNamePlaceholder,onContinue:w,onCancel:E,title:v||o.default.CreateFolder,maxLength:d,continueText:o.default.CreateCommit,name:"",placeHolder:o.default.FolderNamePlaceholder,validator:m})}});
define("@ms/items-view/lib/private/components/nameDialog/NameDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","ODCItemsScopeDeferred_css","./NameDialog.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";a=a.NameDialog_8;Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onNameRef=function(e){r._textField=e;r._focusOnTextfield()};r._onNameChanged=function(e,t){void 0===t&&(t="");var n=r.props.validator;r.setState({name:t,errorMessage:n?n(t):void 0})};r._onClickAction=function(){return n.__awaiter(r,void 0,void 0,function(){var e,t,r=this;return n.__generator(this,function(n){switch(n.label){case 0:this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({name:this.state.name})];case 2:n.sent();return[3,5];case 3:t=n.sent();e=t;this._isDisposed||this.setState({errorMessage:e&&e.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1},function(){e&&r._focusOnTextfield()});return[7];case 5:return[2]}})})};r._onKeyPress=function(e){13===e.which&&r._onClickAction()};r.state={name:r.props.name};return r}t.prototype.render=function(){var e=this.state,t=e.name,n=e.errorMessage,l=e.showSpinner,c=this.props,h=c.continueText,p=void 0===h?f.default.continue:h,d=c.cancelText,v=c.onCancel,m=c.placeHolder,g=c.maxLength,y=c.fileExtensionText,b=c.isMultiline,w=c.cols;return r.createElement(s.Dialog,{dialogContentProps:{type:s.DialogType.close},hidden:!1,title:this.props.title,onDismiss:v},r.createElement("div",{className:a.nameDialogContent},r.createElement(o.TextField,{ariaLabel:m,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,placeholder:m,maxLength:g,onKeyPress:this._onKeyPress,multiline:b,cols:w}),y&&r.createElement("span",{className:a.nameDialogContentFileExtension},y)),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!t||!!n||l,onClick:this._onClickAction,"data-automation-id":p},p),d&&r.createElement(u.DefaultButton,{onClick:v},d),l&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:a.nameDialogSpinner})))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype._focusOnTextfield=function(){if(this._textField){this._textField.focus();this._textField.select()}};return t})(r.PureComponent);t.NameDialog=function(e){return r.createElement(l,n.__assign({},e))}});
define("@ms/items-view/lib/private/components/base/actions/createFolder/CreateFolderDialog",["require","exports","tslib","react","../../../../controls/createFolderDialogControl","../../../../operations/createFolder","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateFolderDialog=o.createItemCacheComponent(function(e,t){var o=t.createFolderWizard,u=n.__rest(t,["createFolderWizard"]),a=u.itemKey,f=e.demandItemFacet(i.createFolderDialogControl,a),l=i.createFolderDialogControl.evaluate(f)(e,{itemKey:a,validator:void 0}),c=l.validator,h=l.maxLength,p=l.title,d=e.dispatch;return r.createElement(o,n.__assign({},u,{onCreateFolder:function(e){var t=e.name;return n.__awaiter(void 0,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d(s.createFolder({items:(e={},e[a]={folders:(r={},r[t]={},r)},e)}))];case 1:n.sent();return[2]}})})},validator:c,maxLength:h,title:p}))})});
define("@ms/items-view/lib/private/components/actions/createDocument/DocumentCreator",["require","exports","tslib","react","./DocumentCreatorHelper","../../../operations/createDocument/DocumentType","../../scope/actions/createDocument/DocumentCreator.resx","../../../models/AutoKeyFacet","../../decorators/asAutoAction","../defaultClick/DefaultClickAction","../../nameDialog/NameDialog","../../../utilities/async/CancelError","../../../operations/createDocument","../../../controls/targetWindowControl","../../decorators/withControlHandler","../../decorators/connectToItemCache","../../../controls/documentCreatorControl","../../../controls/createDocumentActionControl","@ms/utilities-react/lib/hooks/useEventHandler","../../../hooks/useItemCacheSelector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=new u.AutoKeyFacet("newDocument");function E(){return w.serializeNext()}var S=a.asAutoAction()(f.ItemDefaultClickAction);function x(e){var t=this,s=e.itemKey,u=e.resolve,a=e.reject,f=e.askForFileName,v=e.documentType,m=e.openWindow,g=e.templateItemKey,w=e.validator,x=r.useState(null),T=x[0],N=x[1],C=r.useState(f),k=C[0],L=C[1],A=r.useState(E)[0],O=r.useState(!1),M=O[0],_=O[1],D=b.useItemCacheDispatch(),P=r.useCallback(function(e,t){return!t.targetWindow&&T?{targetWindow:T}:{}},[T]),H=y.useEventHandler(function(){_(!0);u()}),B=y.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:t=e.name;r=m({});N(r);return!f||f&&t?[4,D(h.createDocument({items:(i={},i[s]={documentType:v,newDocumentKey:A,targetWindow:r,fileName:t,templateItemKey:g},i)}))]:[3,2];case 1:n.sent();n.label=2;case 2:L(!1);return[2]}})})}),j=y.useEventHandler(function(){a(new c.CancelError)});r.useLayoutEffect(function(){k||B({name:void 0})},[]);return k?r.createElement(l.NameDialog,{title:i.getDialogTitle(v,o.default)||"",name:"",placeHolder:o.default.NewNamePlaceholder,fileExtensionText:i.getDocExtension(v),onContinue:B,onCancel:j,continueText:o.default.CreateCommit,validator:w}):M?null:r.createElement(d.ControlHandlerProvider,{controlHandlers:p.targetWindowControl.pack(P)},r.createElement(S,{onComplete:H,itemKey:A}))}t.createDocumentExecutor=function(e,t,n,r){var i,s=t.itemCacheDispatch,o=t.itemKey,u=t.documentType,a=t.askForFileName,f=t.templateItemKey,l=e.newDocumentKey;return!a||a&&n?s(h.createDocument({items:(i={},i[o]={documentType:u,newDocumentKey:l,targetWindow:r,fileName:n,templateItemKey:f},i)})):Promise.resolve()};t.DocumentCreator=v.createItemCacheComponent(function(e,t){var i=t.itemKey,o=t.documentType,u=o===s.DocumentType.OneNote||o===s.DocumentType.ExcelSurvey||o===s.DocumentType.ExcelForm,a=e.demandItemFacet(m.documentCreatorControl,i),f=m.documentCreatorControl.evaluate(a)(e,{itemKey:i,documentType:o,openWindow:T}),l=e.demandItemFacet(g.createDocumentActionControl,i),c=g.createDocumentActionControl.evaluate(l)(e,{itemKey:i,documentType:o,openWindow:T});return r.createElement(x,n.__assign({},t,{validator:c.validator||f.validator,askForFileName:u||c.askForFileName||f.askForFileName,openWindow:c.openWindow||f.openWindow}))});function T(e){return window.open(e.url||"","_blank")}});
define("@ms/items-view/lib/private/operations/createDocument",["require","exports","../models/Facet","../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentOperation=new n.Facet("createDocument");t.createDocument=r.implementOperation({operationTypeFacet:t.createDocumentOperation});t.createCustomDocumentOperation=new n.Facet("createCustomDocument");t.createCustomDocument=r.implementOperation({operationTypeFacet:t.createCustomDocumentOperation})});
define("@ms/items-view/lib/private/controls/documentCreatorControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.documentCreatorControl=new n.ControlFacet("documentCreator")});
define("@ms/items-view/lib/private/components/actions/delete/DeleteActionExecutor",["require","exports","tslib","react","@ms/utilities-async/lib/cancel/CancelError","../../withItemCache/WithItemCache","../../scope/actions/strings.resx","../../../models/items/ItemStrings.resx","../../../models/configuration/getConfiguration","../../../facets/ConfigurationFacets","../../../facets/ItemFacets","../../warningDialog/WarningDialog","../../confirmationDialog/ConfirmationDialog","../../../operations/deleteItems","../../../operations/progress","../../../operations/deleteItems/DeleteProgressAddon","@ms/utilities-react/lib/hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DeleteWizard=function(e){var t=this,p=e.resolve,d=e.reject,v=e.onDelete,g=e.defaultToDelete,y=void 0===g||g,b=e.deleteWizardStrings,w=e.itemKeys,E=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:p();return[4,v()];case 1:e.sent();return[2]}})})}),S=m.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){d(new i.CancelError);return[2]})})}),x=r.useCallback(function(e){var t=e.itemCache,n=a.getConfiguration(t,{enableDeleteCancelConfirmationStrings:f.enableDeleteCancelConfirmationStringsConfigurationFacet}).enableDeleteCancelConfirmationStrings,i=void 0===n||n,s=1===w.length&&w.some(function(e){var n=t.demandItemFacet(l.isCheckedOutFacet,e);return!!(n&&n.byOther)}),p=w.length>=1&&w.some(function(e){return!!t.demandItemFacet(l.isSharedFacet,e)&&!1})?o.default.deleteSharedConfirmPrefixText+" ":"";return s?r.createElement(c.WarningDialog,{onCancel:S,cancelText:o.default.cancelActionText,title:u.default.checkedOutOrLockedWarningTitle,prompt:u.default.checkedOutOrLockedWarning}):r.createElement(h.ConfirmationDialog,{onCancel:S,onConfirm:E,yesText:i?b.confirmButtonText:void 0,noText:i?o.default.cancelActionText:void 0,defaultToYes:y,title:b.confirmTitle,prompt:[p,p?" ":"",b.confirmText]})},[w,b,y]);return r.createElement(s.WithItemCache,null,x)};t.deleteItemsWithProgress=d.implementOperationWithProgress({operationTypeFacet:p.deleteItemsOperation,progressKeyFacet:p.deleteProgressKeyFacet,initializeBatch:function(){return v.deleteProgressAddon}})});
define("@ms/items-view/lib/private/components/warningDialog/WarningDialog",["require","exports","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Label"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WarningDialog=function(e){var t=e.title,o=e.prompt,u=e.cancelText,a=e.onCancel;return n.createElement(r.Dialog,{onDismiss:a,hidden:!1,title:t,maxWidth:e.maxWidth},n.createElement(s.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(i.PrimaryButton,{onClick:a,componentRef:function(e){e&&e.focus()}},u)))}});
define("@ms/items-view/lib/private/operations/deleteItems/DeleteProgressAddon",["require","exports","tslib","react","../../addons/registerOperationHandler","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../progress","./DeleteStrings.resx","../../facets/ProgressFacets","../../components/itemLink/ItemLink","../deleteItems","../../facets/SetFacets","../../facets/ItemFacets","../progress/retryProgressItems","../progress/handlers/createRetryProgressItemsOperationHandler","../../store/actions/implementOperation","../../facets/ErrorFacets","../../models/Facet","../../facets/DemandFacets","../../models/configuration/getConfiguration","../../facets/ConfigurationFacets","../../components/progress/commands/retry/retryForceDeleteProgressCommand"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";var T,N;Object.defineProperty(t,"__esModule",{value:!0});var C=((T={})[l.ProgressPhase.started]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.completed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.failed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T[l.ProgressPhase.canceled]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},T),k=((N={})[l.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsDestinationTitle,f.default.deleteStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsDestinationTitle,f.default.deleteCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N[l.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},N);t.deleteProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.deleteProgressKeyFacet,o.progressControl)(s.createControlHandler()(L)));e(i.registerOperationHandler(h.deleteProgressKeyFacet,v.retryProgressItemsOperation)(m.createRetryProgressItemsOperationHandler(h.deleteProgressKeyFacet,h.deleteItemsOperation)))}});function L(){return function(e){return A}}function A(e,t){var r,i,s,o=a.getOverallSimpleProgressBreakdown(e,t),u=o.phase,c=o.count,h=(function(e,t){var n=void 0,r=e.demandItemFacet(p.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(l.sourceItemFacet,o),a=u&&u.itemKey,f=e.demandItemFacet(d.parentFolderItemFacet,a),c=f&&f.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n})(e,t),v=e.demandItemFacet(w.errorFacet,t.itemKey),m=E.getConfiguration(e,{enableOverrideDeleteFileLocks:S.enableOverrideDeleteFileLocksFacet}).enableOverrideDeleteFileLocks;v&&v instanceof g.ItemOperationError&&(r=b.unpack({fileLocked:y.fileLockedErrorFacet},v.facets));var T=[];if("group"===t.format&&h)i=k[u]({count:c,itemKey:h});else{i=C[u]({count:c});if(m&&u===l.ProgressPhase.failed&&r){s=f.default.fileLockedConfirmDeleteText;T.push(x.retryForceDeleteCommand)}}return n.__assign(n.__assign(n.__assign({},i&&"item"!==t.format?{title:i}:{}),s&&"summary"!==t.format?{description:s}:{}),{commands:T})}});
define("@ms/items-view/lib/private/operations/progress/handlers/createRetryProgressItemsOperationHandler",["require","exports","tslib","../../../store/actions/implementOperation","../../../addons/registerOperationHandler","../../readItems","../../../models/items/ItemResolver","../../../models/Facet","../../../facets/DemandFacets","../../../utilities/Graft","../../../facets/ProgressFacets","../../progress","../../../facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createRetryProgressItemsOperationHandler=function(e,t){return i.createBatchedItemsOperationHandler()(function(e){var i=this;return function(p){return n.__awaiter(i,void 0,void 0,function(){var i,d,v,m,g,y,b,w,E,S,x;return n.__generator(this,function(T){switch(T.label){case 0:i=p(s.readItems(function(r){var i={operationTypeFacet:t,items:{}},s=new o.ItemResolver;function p(e){var o,d=r.demandItemFacet(l.sourceItemFacet,e),v=d&&d.itemKey,m=r.demandItemFacet(t,e),g=c.getOverallSimpleProgressBreakdown(r,{itemKey:e}).phase;if(v&&m&&"failed"===g){i.items[v]=n.__assign(n.__assign({},m),{progressItemKey:e});s.resolveItems({items:(o={},o[e]=n.__assign({},u.pack({error:a.errorFacet},{error:new f.Delete})),o)})}var y=r.demandItemFacet(h.childItemsFacet,e);if(y)for(var b=0,w=y.itemKeys;b<w.length;b++){p(w[b])}}for(var d=0,v=Object.keys(e.items);d<v.length;d++){p(v[d])}return{itemResolver:s,operationPayload:i}}));p(i.itemResolver.execute());d=p(r.startOperation(i.operationPayload)),v=d.completed,m=d.items;for(g=0,y=Object.keys(m);g<y.length;g++){b=y[g];w=m[b],E=w.started,S=w.completed;(x=i.operationPayload.items[b].progressItemKey)&&p(c.trackItemProgress({progressItemKey:x,started:E,completed:S}))}return[4,v];case 1:T.sent();return[2]}})})}})}});
define("@ms/items-view/lib/private/components/progress/commands/retry/retryForceDeleteProgressCommand",["require","exports","react","../../../../models/Facet","../../actions/retry/RetryDeleteWithBreakLockProgressAction","../../../../operations/deleteItems/DeleteStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryForceDeleteCommand={key:new r.Facet("forceDeleteCommand").id,name:s.default.deleteConfirmButtonText,action:n.createElement(i.RetryDeleteWithBreakLockProgressAction,null)}});
define("@ms/items-view/lib/private/components/progress/actions/retry/RetryDeleteWithBreakLockProgressAction",["require","exports","tslib","react","../../../../operations/progress/retryProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors","../../../../operations/resolveItems","../../../../operations/deleteItems","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemRetryDeleteWithBreakLockProgressAction=h.createItemCacheComponent(function(e,t){var a=t.itemKeys,h=a.filter(function(t){return"failed"===u.getOverallSimpleProgressBreakdown(e,{itemKey:t}).phase}),p=e.dispatch;return r.createElement(o.Action,n.__assign({onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){p(f.resolveItems({items:s.makeObject(h,function(){return l.deleteItemsOperation.pack({breakLock:!0})})}));p(i.retryProgressItems({items:s.makeObject(h,function(){return{}})}));return[2]})})},isAvailable:h.length>0},c.getItemActionEngagement(e,{itemKey:a[0],engagement:{name:"ForceDeleteWithBreakLock",isIntentional:!0}})))});t.RetryDeleteWithBreakLockProgressAction=a.withSelectedItems()(t.ItemRetryDeleteWithBreakLockProgressAction)});
define("@ms/items-view/lib/private/components/actions/rename/RenameActionExecutor",["require","exports","tslib","react","@ms/utilities-async/lib/cancel/CancelError","../../scope/actions/strings.resx","./RenameAction.resx","./RenameDialog","../../../operations/renameItem","../../../operations/progress","../../../operations/renameItem/RenameProgressAddon","@ms/utilities-react/lib/hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameWizard=function(e){var t=this,a=e.resolve,f=e.reject,l=e.onRename,h=e.lockedWarningMessage,p=e.title,d=e.validator,v=e.fileExtensionText,m=e.oldName,g=e.nameFieldAriaLabel,y=c.useEventHandler(function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:a();return l?[4,l(e)]:[3,2];case 1:t.sent();t.label=2;case 2:return[2]}})})}),b=c.useEventHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){f(new i.CancelError);return[2]})})}),w=p||s.default.Rename;return r.createElement(u.RenameDialog,{onContinue:y,onCancel:b,placeHolder:o.default.newNamePlaceholder,title:w,continueText:s.default.RenameCommit,name:m,validator:d,fileExtensionText:v,lockedWarningMessage:h,warningDialogCancelText:s.default.cancelActionText,cancelText:s.default.cancelActionText,nameFieldAriaLabel:g})};t.renameItemWithProgress=f.implementOperationWithProgress({operationTypeFacet:a.renameItemOperation,progressKeyFacet:a.renameProgressKeyFacet,initializeBatch:function(){return l.renameProgressAddon}})});
define("@ms/items-view/lib/private/components/actions/rename/RenameDialog",["require","exports","tslib","react","../../nameDialog/NameDialog","../../warningDialog/WarningDialog","../../keyboard/KeyboardZone"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameDialog=function(e){var t=e.lockedWarningMessage,u=e.warningDialogCancelText,a=e.onCancel,f=e.title;return t?r.createElement(s.WarningDialog,{cancelText:u,title:f,prompt:t,onCancel:a}):r.createElement(o.KeyboardZone,null,r.createElement(i.NameDialog,n.__assign({},e)))}});
define("@ms/items-view/lib/private/components/keyboard/KeyboardZone",["require","exports","react","./KeyboardContext","../../utilities/components/RenderProps","@uifabric/utilities/lib/EventGroup"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0;t.KeyboardZone=function(e){var t=e.isDefault,s=void 0!==t&&t,u=n.useState(""+ ++o)[0],f=n.useContext(r.KEYBOARD_CONTEXT),l=n.useRef(),c=l.current||s&&f.keyboardManager||(l.current=new r.KeyboardManager({isDefault:!1,id:u,parent:f.keyboardManager})),h=a(c),p=h.isActive,d=h.isChildActive;n.useEffect(function(){return function(){if(!s){c.setIsActive(!1);c.dispose()}}},[]);var v=n.useMemo(function(){return{keyboardManager:c}},[c]);return n.createElement("div",{"data-keyboard-zone-id":u},n.createElement(r.KEYBOARD_CONTEXT.Provider,{value:v},i.renderChildrenWithProps(e.children,{isActive:p,isChildActive:d})))};t.WithKeyboardZone=function(e){var t=u(),n=t.isActive,r=t.isChildActive;return i.renderChildrenWithProps(e.children,{isActive:n,isChildActive:r})};function u(){return a(n.useContext(r.KEYBOARD_CONTEXT).keyboardManager)}t.useKeyboardZone=u;function a(e){var t=n.useState(function(){return e.getIsActive()}),r=t[0],i=t[1],o=n.useState(function(){return e.hasActiveChildren()}),u=o[0],a=o[1];n.useEffect(function(){var t=new s.EventGroup(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:r,isChildActive:u}}});
define("@ms/items-view/lib/private/operations/renameItem/RenameProgressAddon",["require","exports","tslib","../../addons/registerOperationHandler","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../progress","./RenameStrings.resx","../../facets/ProgressFacets","../renameItem"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0});var h=((c={})[f.ProgressPhase.started]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameStartedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.completed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameCompletedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.failed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.canceled]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c);t.renameProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(l.renameProgressKeyFacet,s.progressControl)(i.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.phase,s=r.count,o=h[i](s);return n.__assign({},o&&"item"!==t.format?{title:o}:{})}});
define("@ms/items-view/lib/private/components/actions/launchMoveCopyPicker/LaunchMoveCopyPickerWizard",["require","exports","tslib","react","office-ui-fabric-react/lib/Panel","office-ui-fabric-react/lib/Button","../../itemsScope/ItemsScope","../../picker/ItemsPicker","../../itemsBreadcrumb/ItemsBreadcrumbBeta","../../itemsLayoutGroup/ItemsLayoutGroup","../../layouts/DetailsLayout","../../../utilities/async/CancelError","../../action/Action","../../withAction/WithAction","@uifabric/experiments/lib/LayoutGroup","../../picker/actions/PickerCompleteAction","../../picker/actions/PickerFailAction","../moveCopy/MoveCopyAction","../../../store/actions/createActionCreator","./LaunchMoveCopyPickerAction.resx","@ms/utilities-strings/lib/index","../../../controls/itemSetColumnsControl","../../columns/fileTypeIcon/fileTypeIconColumn","../../columns/displayName/displayNameColumn","../../decorators/withControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPickerWizard=function(e){var t=this,S=e.resolve,x=e.reject,C=e.itemKey,k=e.itemKeys,L=e.isMove,A=r.useState(!0),O=A[0],M=A[1],_=r.useMemo(function(){return o.createInitializer(function(){},C)},[C]),D=r.useCallback(function(e){var i=e.itemKeys;if(1!==i.length)return null;var s=i[0];return r.createElement(p.WithAction,{action:r.createElement(g.ItemMoveCopyAction,{itemKeys:k,itemKey:s,isMove:L})},function(e){var i=e.isAvailable,s=e.execute;return r.createElement(h.Action,{isAvailable:i,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);M(!1);return[4,s(e)];case 1:n.sent();S();return[3,3];case 2:t=n.sent();x(t);return[3,3];case 3:return[2]}})})}})})},[]),P=r.useMemo(function(){return u.createPickerFailAction(y.createAsyncActionCreator(function(e){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){x(e.error);return[2]})})}}))},[]),H=w.format(w.getLocalizedCountValue(L?b.default.MovePanelTitleFormat:b.default.CopyPanelTitleFormat,L?b.default.MovePanelTitleIntervals:b.default.CopyPanelTitleIntervals,k.length)||"",k.length),B=r.useCallback(function(){return r.createElement(d.LayoutGroup,{direction:"horizontal"},r.createElement(p.WithAction,{action:r.createElement(v.PickerCompleteAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.PrimaryButton,{disabled:!t,onClick:function(){n()}},L?b.default.MovePanelSelectActionText:b.default.CopyPanelSelectActionText)}),r.createElement(p.WithAction,{action:r.createElement(m.PickerCancelAction,null)},function(e){var t=e.isAvailable,n=e.execute;return r.createElement(s.DefaultButton,{disabled:!t,onClick:function(){n()}},b.default.MoveCopyPanelCancelActionText)}))},[]),j=r.useMemo(function(){return n.__assign({},E.itemSetColumnsControl.pack(N))},[]);return r.createElement(o.ItemsScope,{initializer:_},r.createElement(u.ItemsPicker,{itemMode:"folders",selectionMode:"pick",commandMode:"none",completeAction:D,failAction:P},r.createElement(i.Panel,{headerText:H,isOpen:O,onDismiss:function(){return x(new c.CancelError)},isLightDismiss:!0,onRenderFooterContent:B},r.createElement(a.ItemsBreadcrumbBeta,null),r.createElement(T.ControlHandlerProvider,{controlHandlers:j},r.createElement(f.ItemsLayoutGroup,null,r.createElement(l.DetailsLayout,null))))))};function N(e,t){return{columns:[S.fileTypeIconColumn,x.displayNameColumn]}}});
define("@ms/items-view/lib/private/components/picker/ItemsPicker",["require","exports","tslib","react","../decorators/withControlHandler","./PickerContext","../action/Action","../withItemCache/WithItemCache","../../controls/defaultClickActionControl","../actions/defaultClick/handlers/open","../../controls/itemSetSelectionControl","../../controls/filteredItemSetControl","../../models/itemSets/filters/itemTypeFilterHandler","../../controls/currentItemSetControl","./actions/defaultClickActionHandlers/completePicker","../commands/new/newCommand","../commands/createFolder/createFolderCommand","../commands/upload/uploadCommand","../commands/showProgress/showProgressCommand","../commands/switchLayout/switchLayoutCommand","../../controls/itemsCommandBarControl","../../controls/itemsContextMenuControl","../../controls/itemHeroCommandsControl","../decorators/connectToItemCache","../commands/clearSelection/clearSelectionCommand","../commands/shortcuts/navigateUpShortcut","../commands/sort/sortCommand"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=[],L=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t})(r.PureComponent),A=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t})(r.PureComponent);t.createPickerCompleteAction=function(e){var t=this;return x.connectToItemCache(function(r,i){var s=i.itemKeys;return{onExecute:(function(r){return function(i){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r(e({itemKeys:i}))];case 1:t.sent();return[2]}})})}}})(r.dispatch)(s)}})(o.Action)};t.createPickerFailAction=function(e){var t=this;return x.connectToItemCache(function(r,i){var s=i.error;return{onExecute:(function(r){return function(i){return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r(e({error:i}))];case 1:t.sent();return[2]}})})}}})(r.dispatch)(s)}})(o.Action)};t.ItemsPicker=function(e){var t=e.filters,o=void 0===t?k:t,v=e.selectionMode,m=void 0===v?"single":v,g=e.itemMode,y=void 0===g?"files":g,b=e.commandMode,x=void 0===b?"safe-write":b,T=e.completeAction,N=void 0===T?L:T,C=e.failAction,_=void 0===C?A:C,D=e.children,P=r.useCallback(function(e,t){return{handlers:n.__spreadArrays([f.openDefaultClickActionHandler],"pick"===m?[d.completePickerDefaultClickActionHandler]:[])}},[m]),H=r.useCallback(function(e,t){var r=t.itemKey;if(o.length<=0||!r)return{};var i=e.demandItemFacet(c.filteredItemSetControl,r);return{itemKey:c.filteredItemSetControl.evaluate(i)(e,{itemKey:r,handlers:n.__spreadArrays(o,[h.itemFolderTypeFilterHandler])}).itemKey}},[o]),B=r.useCallback(function(e,t){return"pick"===m?{selectionMode:"none",canSelectItem:function(){return!1}}:{selectionMode:m,canSelectItem:function(e,t){return O(e,n.__assign(n.__assign({},t),{itemMode:y,filters:o}))}}},[m,y,o]),j=r.useCallback(function(e,t){var r=t.commands,i=t.farCommands,s=t.overflowCommands,o=t.shortcutCommands;return"all"===x?{}:n.__assign(n.__assign(n.__assign(n.__assign({},r?{commands:M(r,x)}:{}),i?{farCommands:M(i,x)}:{}),s?{overflowCommands:M(s,x)}:{}),o?{shortcutCommands:M(o,x)}:{})},[x]),F=r.useCallback(function(e,t){var r=t.commands;return"all"===x?{}:n.__assign({},r?{commands:M(r,x)}:{})},[x]),I=r.useCallback(function(e,t){var r=t.commands;return"all"===x?{}:n.__assign({},r?{commands:M(r,x)}:{})},[x]),q=r.useCallback((function(e,t,i){return function(s){var o=s.itemKeys,a=r.useCallback(function(u){for(var a=u.itemCache,f=0,l=o;f<l.length;f++){if(!O(a,{itemKey:l[f],filters:e,itemMode:t}))return null}return r.createElement(i,n.__assign({},s))},[o]);return r.createElement(u.WithItemCache,null,a)}})(o,y,N),[o,y,N]),R=r.useCallback((function(e){return function(t){return r.createElement(e,n.__assign({},t))}})(_),[_]),U=r.useMemo(function(){return n.__assign(n.__assign(n.__assign(n.__assign(n.__assign(n.__assign({},a.defaultClickActionControl.pack(P)),l.itemSetSelectionControl.pack(B)),p.currentItemSetControl.pack(H)),w.itemsCommandBarControl.pack(j)),E.itemsContextMenuControl.pack(F)),S.itemHeroCommandsControl.pack(I))},[P,B,H,j,F,I]);return r.useMemo(function(){return r.createElement(s.PICKER_CONTEXT.Provider,{value:{completeAction:q,failAction:R}},r.createElement(i.ControlHandlerProvider,{controlHandlers:U},D))},[q,R,U,D])};function O(e,t){var n=t.filters,r=t.itemMode;if("folders"===r){if(!h.itemFolderTypeFilterHandler.filter(e,t))return!1}else if("files"===r&&!h.itemNonFolderTypeFilterHandler.filter(e,t))return!1;if(!n||0===n.length)return!0;for(var i=0,s=n;i<s.length;i++){if(s[i].filter(e,t))return!0}return!1}function M(e,t){if("all"===t)return e;for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];if(o.key===v.newCommand.key){var u=o.subMenuProps&&o.subMenuProps.items;u&&r.push(n.__assign(n.__assign({},o),{subMenuProps:n.__assign(n.__assign({},o.subMenuProps),{items:M(u,t)})}))}else o.key===m.createFolderCommand.key||o.key===g.uploadCommand.key?"safe-write"===t&&r.push(o):o.key!==y.showProgressCommand.key&&o.key!==b.switchLayoutCommand.key&&o.key!==T.clearSelectionCommand.key&&o.key!==N.navigateUpShortcut.key&&o.key!==C.sortCommandKey||r.push(o)}return r}});
define("@ms/items-view/lib/private/components/picker/PickerContext",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PICKER_CONTEXT=n.createContext(void 0)});
define("@ms/items-view/lib/private/components/picker/actions/defaultClickActionHandlers/completePicker",["require","exports","react","../../../../models/Facet","../../../../facets/ItemFacets","../PickerCompleteAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.completePickerDefaultClickActionHandler={key:new r.Facet("completePickerDefaultClickActionHandler").id,evaluate:function(e,t){return{action:e.demandItemFacet(i.folderFacet,t.itemKey)?void 0:n.createElement(s.ItemPickerCompleteAction,{itemKeys:[t.itemKey]})}}}});
define("@ms/items-view/lib/private/components/picker/actions/PickerCompleteAction",["require","exports","tslib","react","../PickerContext","../../decorators/selectors"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKeys;return r.createElement(i.PICKER_CONTEXT.Consumer,null,function(t){if(!t)return null;var n=t.completeAction;return r.createElement(n,{itemKeys:e})})};return t})(r.PureComponent);t.ItemPickerCompleteAction=o;t.PickerCompleteAction=s.withSelectedItems()(s.withCurrentItemAsFallback()(o))});
define("@ms/items-view/lib/private/components/commands/showProgress/showProgressCommand",["require","exports","react","../../../models/Facet","../../actions/showProgress/ShowProgressAction","../../progress/commandButton/ProgressCommandButton","../Commands.resx","../../keyboard/KeyboardMap.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.showProgressCommand={key:new r.Facet("progress").id,automationId:"showProgressCommand",action:n.createElement(i.ShowProgressAction,null),shortcutProps:{keySequences:["G"],content:u.default.showActionDetailsDesc},title:o.default.ShowProgressCommandAriaLabel,ariaLabel:o.default.ShowProgressCommandAriaLabel,commandBarButtonAs:s.ProgressCommandButton}});
define("@ms/items-view/lib/private/components/actions/showProgress/ShowProgressAction",["require","exports","tslib","react","../../action/Action","../../../operations/progress","../../../facets/SetFacets","../../../facets/ProgressFacets","../../../utilities/components/Async","../../decorators/afterPageLoad","../../itemCacheInitializer/ItemCacheInitializer","../../withAction/WithAction","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=f.afterPageLoad()(a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../DeferredComponents"],t,n)})];case 1:return[2,t.sent().ProgressPanel]}})})})),d=l.createItemCacheInitializer(function(){return s.progressAddon});t.ShowProgressAction=h.createItemCacheComponent(function(e,t){var n=e.demandItemFacet(o.childItemsFacet,s.progressRootItemKey),a=!1,f=n&&n.itemKeys;if(f)for(var l=0,h=f;l<h.length;l++){var v=h[l];if(s.getOverallProgressPhase(e,{itemKey:v})!==u.ProgressPhase.expired){a=!0;break}}var m=c.renderComponentOnExecute(p);return r.createElement(d,null,r.createElement(i.Action,{isAvailable:a,onExecute:m}))})});
define("@ms/items-view/lib/private/components/progress/commandButton/ProgressCommandButton",["require","exports","tslib","react","react-dom","../../../controls/progressControl","../../../operations/progress","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Layer","ODCItemsScopeDeferred_css","../ProgressStrings.resx","@ms/utilities-strings/lib/index","../../../utilities/objects","../../decorators/connectToItemCache","../../../facets/ProgressFacets","../../../facets/SetFacets","@uifabric/utilities/lib/Async","../../../controls/progressCommandControl","../../withItemCache/WithItemCache","../../decorators/afterPageLoad","../../../utilities/components/Async","office-ui-fabric-react/lib/ResizeGroup"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";f=f.ProgressCommandButton_7;var S;Object.defineProperty(t,"__esModule",{value:!0});var x=b.afterPageLoad()(w.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/DeferredActions"],t,n)})];case 1:return[2,t.sent().ProgressCallout]}})})})),T={started:"Sync",completed:"CheckMark",failed:"StatusErrorFull",canceled:"Sync"},N=((S={})[d.ProgressPhase.started]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericStartedItemsTitle,l.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.completed]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericCompletedItemsTitle,l.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.failed]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericFailedItemsTitle,l.default.genericFailedItemsTitleIntervals,e)||"",e)},S[d.ProgressPhase.canceled]=function(e){return c.format(c.getLocalizedCountValue(l.default.genericFailedItemsTitle,l.default.genericFailedItemsTitleIntervals,e)||"",e)},S),C=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={status:t.status,percentComplete:t.percentComplete};n._async=new m.Async(n);n._updateStatus=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},500,{leading:!1,trailing:!0});n._updatePercentComplete=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},1e4,{leading:!1,trailing:!0});return n}t.prototype.render=function(){var e=this.state,t=e.status,n=e.percentComplete;return r.createElement(a.Layer,null,r.createElement("span",{className:f.accessibleStatus,role:"status","aria-live":"polite","aria-atomic":"true"},t," ",(function(e){if("number"==typeof e)return c.formatWithLocalizedCountValue(l.default.percentCompletedDescription,l.default.percentCompletedDescriptionIntervals,Math.round(100*e));return l.default.genericStartedIndeterminateDescription})(n)))};t.prototype.componentDidUpdate=function(e){e.status!==this.props.status?this._updateStatus():e.percentComplete!==this.props.percentComplete&&this._updatePercentComplete()};t.prototype.componentWillUnmount=function(){this._async.dispose()};return t})(r.PureComponent);var k=p.connectToItemCache()(function(e){var t=e.finishedPinnedItemKeys,n=e.finishedHiddenItemKeys,i=e.itemCacheDispatch,u=(function(e,t){var n=r.useRef(),i=n.current;n.current=e;var s=r.useRef(),o=r.useState({})[1];e!==i&&e&&(s.current=e);r.useEffect(function(){if(e){var n=setTimeout(function(){s.current=void 0;o({})},t);return function(){clearTimeout(n)}}},[e]);return s.current})((function(e){var t=r.useRef(),n=t.current;t.current=e;var i=r.useRef(),s=i.current||(i.current={}),o=r.useRef(),u=o.current;if(e!==n){for(var a=void 0,f={},l=0,c=e;l<c.length;l++){var h=c[l];f[h]=!0;s[h]||(a=h)}i.current=f;(a||u&&!f[u])&&(o.current=a)}return o.current})(t),3e3),a=r.useRef();a.current=e.doNotExpire;var f=u||e.currentItemKey,l=r.useRef(),c=l.current;l.current=u;r.useEffect(function(){var e;c&&!a.current&&i(o.expireProgressItems({items:(e={},e[c]=!0,e)}))},[u]);r.useEffect(function(){n.length>0&&!a.current&&i(o.expireProgressItems({items:h.makeObject(n,function(){return!0})}))},[n]);var p=r.useCallback(function(t){var n,i,u,a=t.itemCache;if(f){var l=a.demandItemFacet(s.progressControl,f),c=o.getItemCountsByProgressPhase(a,{itemKey:f}),h=o.getOverallSimpleProgressBreakdown(a,{itemKey:f}),p=h.phase,d=h.count,v=s.progressControl.evaluate(l)(a,{itemKey:f,itemCountsByPhase:c,title:N[p](d),percentComplete:(n=c,i=n.created+n.started+n.completed+n.failed,u=n.completed+n.failed,i>0?u/i:void 0),showTitle:!0,format:"summary"}),m=v.title,g=v.percentComplete,y=v.showTitle;return r.createElement(r.Fragment,null,y?r.createElement("div",null,m):null,e.isMeasured?null:r.createElement(C,{status:m,percentComplete:g}))}return null},[f]);return r.createElement(y.WithItemCache,null,p)}),L=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onDismiss=function(){n.setState({doNotExpire:!1})};n._onClick=function(e){n.setState({doNotExpire:!0});var t=n.props.onClick;t&&t(e)};n.state={root:null,doNotExpire:!1};return n}t.prototype.render=function(){var e,t=this.props,i=t.iconName,s=t.isStarted,o=t.finishedCalloutProgressItemKeys,a=t.finishedPinnedProgressItemKeys,l=t.finishedHiddenProgressItemKeys,c=(t.children,t.defaultRender),h=(t.progressTitle,t.progressPercentComplete,n.__rest(t,["iconName","isStarted","finishedCalloutProgressItemKeys","finishedPinnedProgressItemKeys","finishedHiddenProgressItemKeys","children","defaultRender","progressTitle","progressPercentComplete"])),p=this.state.root;return c?r.createElement(c,n.__assign({},h,{onClick:this._onClick,iconProps:{iconName:i,className:u.css((e={},e[f.created]=s,e))}}),r.createElement(k,{isMeasured:this.context.isMeasured,currentItemKey:this.props.currentItemKey,doNotExpire:this.state.doNotExpire,finishedPinnedItemKeys:a,finishedHiddenItemKeys:l}),p?r.createElement(x,{target:p,onViewAll:this._onClick,onDismiss:this._onDismiss,isExecuting:this.props.isExecuting,doNotExpire:this.state.doNotExpire,finishedItemKeys:o}):null):null};t.prototype.componentDidMount=function(){this.context.isMeasured||this.setState({root:i.findDOMNode(this)})};t.contextType=E.MeasuredContext;return t})(r.PureComponent);t.ProgressCommandButton=p.connectToItemCache(function(e,t){for(var n=t.actionState,r=e.demandItemFacet(v.childItemsFacet,o.progressRootItemKey),i=r&&r.itemKeys||[],s=void 0,u=[],a=[],f=[],l=e.demandItemFacet(g.progressCommandControl,void 0),c=g.progressCommandControl.evaluate(l)(e,{}).summaryControlHandler,h=0,p=i;h<p.length;h++){var m=p[h],y=o.getOverallProgressPhase(e,{itemKey:m}),b=e.demandItemFacet(g.progressCommandSummaryControl,m),w=g.progressCommandSummaryControl.evaluate(b,c)(e,{itemKey:m,reportMode:g.ProgressSummaryReportMode.callout}).reportMode;switch(y){case d.ProgressPhase.created:case d.ProgressPhase.started:s=m;break;case d.ProgressPhase.completed:w===g.ProgressSummaryReportMode.callout?a.push(m):w===g.ProgressSummaryReportMode.pin?f.push(m):u.push(m);break;case d.ProgressPhase.failed:a.push(m);break;case d.ProgressPhase.canceled:case d.ProgressPhase.expired:}}var E=o.getOverallSimpleProgressBreakdown(e,{itemKey:o.progressRootItemKey}).phase;return{iconName:T[E]||"Sync",isStarted:"started"===E,currentItemKey:s,finishedCalloutProgressItemKeys:a,finishedPinnedProgressItemKeys:f,finishedHiddenProgressItemKeys:u,isExecuting:!!n&&n.executingCount>0}})(L)});
define("@ms/items-view/lib/private/components/commands/switchLayout/switchLayoutCommand",["require","exports","tslib","react","../../actions/switchLayout/SwitchLayoutAction","../../layouts/DetailsLayoutTypeFacet","../../layouts/TilesLayoutTypeFacet","../Commands.resx","./switchLayoutCommandKey"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.switchLayoutCommand={key:a.switchLayoutCommandKey,automationId:"switchLayoutCommand",title:u.default.SwitchLayoutCommandLabel,ariaLabel:u.default.SwitchLayoutCommandLabel,iconProps:{iconName:"tiles"},postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&(t.filter(function(e){return e.checked})[0]||t[0]);return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:r.iconProps}:{})},subMenuProps:{items:[{key:a.detailsListCommandKey,automationId:"detailsListCommand",name:u.default.ViewList,title:u.default.ViewListCommandTooltip,action:r.createElement(i.SwitchLayoutAction,{layoutType:s.detailsLayoutType,ariaLabel:u.default.ViewListAriaLabel}),iconProps:{iconName:"list"}},{key:a.compactDetailsListCommandKey,automationId:"compactDetailsListCommand",name:u.default.ViewCompactList,title:u.default.ViewCompactListCommandTooltip,action:r.createElement(i.SwitchLayoutAction,{layoutType:s.compactDetailsLayoutType,ariaLabel:u.default.ViewCompactListAriaLabel}),iconProps:{iconName:"alignleft"}},{key:a.tilesListCommandKey,automationId:"tilesListCommand",name:u.default.ViewGrid,title:u.default.ViewGridCommandTooltip,action:r.createElement(i.SwitchLayoutAction,{layoutType:o.tilesLayoutType,ariaLabel:u.default.ViewGridAriaLabel}),iconProps:{iconName:"viewall"}}]}}});
define("@ms/items-view/lib/private/components/actions/switchLayout/SwitchLayoutAction",["require","exports","tslib","react","../../../facets/ScopeFacets","../../decorators/connectToItemCache","../../../models/itemsScope/getItemsScope","../../action/Action","../../decorators/selectors","../../../models/telemetry/getItemEngagement","../../../facets/DemandFacets","../../../models/itemsScope/getCurrentLayout","../../accessibility/alert/Alert","../../../controls/switchLayoutActionControl","../../layouts/getItemsViewLayoutsContext","../../../models/itemsScope/getCurrentLayout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SwitchLayoutAction=s.createItemCacheComponent(function(e,t){var s=t.layoutType,m=t.ariaLabel,g=o.getItemsScope(e).itemsScopeItemKey;if(!g)return null;var y=a.getCurrentItemSetKey(e,g);if(!y)return null;var b=!1,w=d.getItemsViewLayoutsContext(e);if(w){b=!(E=w&&w.availableLayouts)||!!E.get(s)}else{var E;b=!(E=e.demandItemFacet(i.availableLayoutsFacet,g))||!!E&&!!E[s.id]}var S=!!e.demandItemFacet(l.errorFacet,y,{suppressGetItems:!0}),x=e.dispatch,T=c.getPreferredLayout(e,{itemsScopeItemKey:g}).setPreferredLayout;if(!T)return null;if(S)return null;var N=e.demandItemFacet(p.switchLayoutActionControl,y),C=p.switchLayoutActionControl.evaluate(N)(e,{itemsScopeItemKey:g,layoutType:s,isAvailable:b}),k=C.isAvailable,L=C.onSwitchLayout,A=v.getCurrentLayout(e,{itemsScopeItemKey:g})===s,O=f.logItemEngagementOnExecute(e,{onExecute:h.alertOnExecute(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(e){x(T({itemsScopeItemKey:g,layoutType:s}));L&&x(L({itemsScopeItemKey:g,layoutType:s}));return[2]})})},m),itemKey:a.getItemKey(e,{itemKey:y}),engagement:{name:"SwitchLayout",isIntentional:!0,extraData:{layoutType:s.name}}});return r.createElement(u.Action,{isAvailable:!!k&&!A,isToggled:A,onExecute:O})})});
define("@ms/items-view/lib/private/components/commands/switchLayout/switchLayoutCommandKey",["require","exports","../../../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.switchLayoutCommandKey=n.getNextId("switchLayout");t.detailsListCommandKey=n.getNextId("detailsList");t.compactDetailsListCommandKey=n.getNextId("compactDetailsList");t.tilesListCommandKey=n.getNextId("tilesList")});
define("@ms/items-view/lib/private/components/commands/clearSelection/clearSelectionCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/clearSelection/ClearSelectionAction","../../selectionVisibility/SelectionVisibility","./ClearSelectionCommand.resx","@ms/utilities-strings/lib/index","../../../models/itemsScope/getSelectedItemKeys","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=l.createItemCacheComponent(function(e,t){var i=t.defaultRender,s=n.__rest(t,["defaultRender"]),o=f.getSelectedItemKeys(e);return i?r.createElement(i,n.__assign({},s,{text:a.formatWithLocalizedCountValue(u.default.ClearSelectionCommandText,u.default.ClearSelectionCommandTextIntervals,o.length),ariaLabel:a.formatWithLocalizedCountValue(u.default.ClearSelectionCommandAriaLabel,u.default.ClearSelectionCommandAriaLabelIntervals,o.length)})):null});t.clearSelectionCommand={key:new i.Facet("clearSelectionCommand").id,iconProps:{iconName:"Clear"},shortcutProps:{content:u.default.ClearSelectionShortcutDesc,keySequences:["CtrlD"]},action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(s.ClearSelectionAction,null)),commandBarButtonAs:c}});
define("@ms/items-view/lib/private/components/actions/clearSelection/ClearSelectionAction",["require","exports","tslib","react","../../action/Action","../../../operations/selectItems","../../decorators/connectToItemsScope","../../decorators/connectToItemCache","../../../models/itemsScope/getSelectedItemKeys","../../../operations/getItems","../../../facets/ScopeFacets"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ClearSelectionAction=u.createItemCacheComponent(function(e,t){var u=o.getItemsScope(e).itemsScopeItemKey;if(!u)return null;var c=e.demandItemFacet(l.isSelectionModalFacet,u);if(0===a.getSelectedItemKeys(e).length&&!c)return null;var h=e.dispatch;return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){c&&h(f.resolveItems({items:(e={},e[u]=n.__assign({},l.isSelectionModalFacet.pack(void 0)),e)}));h(s.clearSelection({itemsScopeItemKey:u}));return[2]})})},engagement:{name:"ClearSelection",isIntentional:!0}})})});
define("@ms/items-view/lib/private/components/commands/shortcuts/navigateUpShortcut",["require","exports","react","../../keyboard/KeyboardMap.resx","../../../models/Facet","../../actions/navigateUp/NavigateUpAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateUpShortcut={key:new i.Facet("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:r.default.altUpDesc},action:n.createElement(s.NavigateUpAction,null)}});
define("@ms/items-view/lib/private/components/actions/navigateUp/NavigateUpAction",["require","exports","react","../../../facets/ItemFacets","../open/OpenAction","../../decorators/selectors","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.createItemCacheComponent(function(e,t){var s=t.itemKey,o=e.demandItemFacet(r.parentFolderItemFacet,s),u=o&&o.itemKey;return n.createElement(i.ItemOpenAction,{itemKey:u})});t.NavigateUpAction=s.withOnlyCurrentItem()(u)});
define("@ms/items-view/lib/private/components/commands/sort/sortCommand",["require","exports","react","office-ui-fabric-react/lib/ContextualMenu","../Commands.resx","../../decorators/selectors","../../actions/sort/SortAction","../../decorators/withColumnSelector","../../../controls/sortedItemSetControl","../../../models/itemCache/ComputedItemFacet","../../../models/Facet"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortCommandKey=l.getNextId("sortCommand");var c=new f.ComputedItemFacet("sortedColumn",function(e,t){for(var n=t.itemKey,r=u.getItemSetColumnOverrides(e,{itemKey:n}).columns,i=void 0===r?u.DEFAULT_COLUMNS:r,s=e.demandItemFacet(a.sortedItemSetControl,n),o=0,f=i;o<f.length;o++){var l=f[o];if(n===a.sortedItemSetControl.evaluate(s)(e,{itemSetKey:n,handler:{columnKey:l.key,isAscending:!0}}).newItemSetKey)return{columnKey:l.key,isAscending:!0,name:l.name};if(n===a.sortedItemSetControl.evaluate(s)(e,{itemSetKey:n,handler:{columnKey:l.key,isAscending:!1}}).newItemSetKey)return{columnKey:l.key,isAscending:!1,name:l.name}}}),h=function(e,t){var n=t?i.default.SortAscending:i.default.SortDescending;return i.default.SortedBy+" "+e+", "+n};t.buildSortCommand=function(e,f){void 0===f&&(f={});var l=i.default.Sort;f.hasOwnProperty("name")&&(l=f.name);var p=[],d=s.getCurrentItemSetKey(e);if(d){var v=u.getItemSetColumnOverrides(e,{itemKey:d}).columns,m=void 0===v?u.DEFAULT_COLUMNS:v,g=e.demandItemFacet(c,d);if(g){for(var y=e.demandItemFacet(a.sortedItemSetControl,d),b=0,w=m;b<w.length;b++){var E=w[b];a.sortedItemSetControl.evaluate(y)(e,{itemSetKey:d,handler:{columnKey:E.key,isAscending:g.isAscending}}).newItemSetKey&&p.push({key:"sort"+E.key,automationId:"sort"+E.key,name:E.name,ariaLabel:E.name,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:E.key,isAscending:g.isAscending,ariaLabel:h(E.name,g.isAscending)})})}p.push({name:"-",key:"divider_1",itemType:r.ContextualMenuItemType.Divider});p.push({key:"sortAsc",automationId:"sortAsc",name:i.default.SortAscending,ariaLabel:i.default.SortAscending,title:i.default.SortAscendingCommandTooltip,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:g.columnKey,isAscending:!0,ariaLabel:h(g.name,!0)})});p.push({key:"sortDesc",automationId:"sortDesc",name:i.default.SortDescending,ariaLabel:i.default.SortDescending,title:i.default.SortDescendingCommandTooltip,action:n.createElement(o.ItemSortAction,{itemKey:d,columnKey:g.columnKey,isAscending:!1,ariaLabel:h(g.name,!1)})})}}return{key:t.sortCommandKey,automationId:"sortCommand",name:l,ariaLabel:l,title:i.default.SortCommandTooltip,iconProps:{iconName:"SortLines"},subMenuProps:{items:p}}}});
define("@ms/items-view/lib/private/components/picker/actions/PickerFailAction",["require","exports","react","../PickerContext","../../../utilities/async/CancelError"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e){var t=e.error,i=n.useContext(r.PICKER_CONTEXT);if(!i)return null;var s=i.failAction;return n.createElement(s,{error:t})}t.PickerFailAction=s;t.PickerCancelAction=function(e){var t=new i.CancelError({message:"The picker was canceled by the user."});return n.createElement(s,{error:t})}});
define("@ms/items-view/lib/private/operations/DeferredOperations",["require","exports","tslib","./uploadItems/FileEntryAddon","./moveCopy/moveCopyItems","./demandItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("@ms/items-view/lib/private/operations/moveCopy/moveCopyItems",["require","exports","tslib","../../store/actions/implementOperation","./moveCopyItemsOperation","../../store/actions/createActionCreator","../progress","../../models/items/ItemResolver","../../facets/ProgressFacets","../../models/Facet","../../facets/SetFacets","../../utilities/Graft","../../facets/GroupFacets","../../utilities/async/all","./MoveCopyProgressAddon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyItems=s.createAsyncActionCreator(function(e){return function(t){return n.__awaiter(void 0,void 0,void 0,function(){var s,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F;return n.__generator(this,function(I){switch(I.label){case 0:s=[];t(d.moveCopyProgressAddon);for(v=0,m=Object.keys(e.items);v<m.length;v++){g=m[v];y=e.items[g];b=o.progressBatchKeyFacet.serializeNext();w=i.moveCopyItemsProgressKeyFacet.serializeBatchKey(b);E=[];S=new u.ItemResolver;for(x=0,T=Object.keys(y);x<T.length;x++){k=T[x];L=((D={})[k]=y[k],D);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);S.resolveItems({items:(P={},P[A]=n.__assign(n.__assign(n.__assign(n.__assign({},a.sourceItemFacet.pack({itemKey:k})),a.destinationItemFacet.pack({itemKey:g})),f.pack({options:i.moveCopyItemsOperation},{options:L})),a.progressPhaseFacet.pack(a.ProgressPhase.created)),P)});E.push(A)}S.resolveItems({items:(H={},H[o.progressRootItemKey]=f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch([w],function(e){return e})}}),H[w]=n.__assign(n.__assign({},f.pack({childItems:l.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch(E,function(e){return e})}})),h.isGroupFacet.pack(!0)),H)});t(S.execute());for(N=0,C=Object.keys(y);N<C.length;N++){k=C[N];L=((B={})[k]=y[k],B);A=i.moveCopyItemsProgressKeyFacet.serializeTaskKey(b,k,L);O=t(r.startOperation({operationTypeFacet:i.moveCopyItemsOperation,items:(j={},j[g]=(F={},F[k]=n.__assign(n.__assign({},y[k]),{progressItemKey:A}),F),j)})),M=O.completed,_=O.items;t(o.trackItemProgress(n.__assign({progressItemKey:A,progressSize:1},_[g])));s.push(M)}}return[4,p.waitForAll(s)];case 1:I.sent();return[2]}})})}})});
define("@ms/items-view/lib/private/operations/moveCopy/MoveCopyProgressAddon",["require","exports","tslib","../../addons/registerOperationHandler","../../addons/registerControlHandler","../../controls/progressControl","./moveCopyItemsOperation","../../facets/ItemFacets","../progress","./MoveCopyStrings.resx","../../facets/ProgressFacets","../../facets/SetFacets","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p,d;Object.defineProperty(t,"__esModule",{value:!0});var v=((p={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveStartedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveCompletedItemsTitle,f.default.moveCompletedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.moveFailedItemsTitle,f.default.moveFailedItemsTitleIntervals,e)||"",e)},p),m=((d={})[l.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyStartedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyCompletedItemsTitle,f.default.copyCompletedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d[l.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(f.default.copyFailedItemsTitle,f.default.copyFailedItemsTitleIntervals,e)||"",e)},d);t.moveCopyProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(o.moveCopyItemsProgressKeyFacet,s.progressControl)(i.createControlHandler()(g)))}});function g(){return function(e){return y}}function y(e,t){var r,i=t.itemKey;if("item"===t.format){(l=e.demandItemFacet(o.moveCopyItemsOperation,i))&&(r=e.demandItemFacet(u.displayNameFacet,i))}else{var s=e.demandItemFacet(c.childItemsFacet,i),f=s&&s.itemKeys;if(f&&f[0]){var l;if(l=e.demandItemFacet(o.moveCopyItemsOperation,f[0])){var h=l[Object.keys(l)[0]].isMove,p=a.getOverallSimpleProgressBreakdown(e,t),d=p.phase,g=p.count;r=h?v[d](g):m[d](g)}}}return n.__assign({},r?{title:r}:{})}});
define("@ms/telemetry-addon-aria/lib/AriaWrapper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aria=e("@ms/aria-private")});
define("odsp-next/actions/itemsScope/DefaultClickAction",["require","exports","tslib","./base/CreateItemsScopeItemActionFromKnockout","../../resources/ControlResourceKeys","../../base/BaseAction","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.actionMap);n._action=new(n.managed(r.DefaultClickAction))(t);n._item=t.item;return n}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!(!e||e.isPlaceholder)&&this._action.isAvailable()};t.prototype.onExecute=function(e){return this._action.execute(e)};return t})(s.default);t.DefaultClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(i.actionMap),r=o.default.isActivated("9FCD7B65-390C-4C59-9913-FC1D9D8D79E1","9/9/2019","Restore original DefaultClickAction behavior thanks to deferred execution")?u:n.DefaultClickAction;return new(e.injected(r,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})});
define("odsp-next/actions/itemsScope/base/CreateItemsScopeItemActionFromKnockout",["require","exports","./CreateItemsScopeActionFromKnockout","../../../controls/base/react/WithKnockoutStoreItem"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeItemActionFromKnockout=function(e,t){void 0===t&&(t={});var i=n.createItemsScopeActionFromKnockout(e,t);return r.withKnockoutStoreItem(function(e){return{item:e}})(i)}});
define("odsp-next/actions/itemsScope/base/CreateItemsScopeActionFromKnockout",["require","exports","tslib","react","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/components/action/Action","../../../controls/base/react/WithResources","../../../controls/base/react/WithKnockoutComputed","../../base/ItemSelectionHelper","../../base/itemsScope/ItemSelectionHelper","../../../utilities/killSwitch/KillSwitch","../../../controls/knockoutContentShim/WithKnockoutResourceScope"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=e("module").id;t.createItemsScopeActionFromKnockout=function(e,t){void 0===t&&(t={});function n(n){return r.createElement(c.WithKnockoutResourceScope,null,r.createElement(p,{createKnockoutAction:e,options:t,actionProps:n}))}return l.default.isActivated("DB243761-5E52-4E84-8204-175D856F50DE","9/4/2019","Always use ItemCache selection shim for actions")?n:o.withChildResources(function(e){e.exposeFactory(a.typeResourceKey,new i.AliasResourceFactory(f.typeResourceKey))},{owner:h})(n)};function p(e){var t=this,i=e.createKnockoutAction,a=e.options,f=e.actionProps,l=a.isToggleable,c=void 0!==l&&l,h=a.isExecutorOnly,p=void 0!==h&&h,d=o.useResourceScope(),v=r.useRef(),m=v.current||(v.current=i(d,f));r.useEffect(function(){return function(){m.dispose()}},[]);var g=u.useObservableValue(!!p||m.isAvailable),y=u.useObservableValue(c?m.isToggled:void 0);return r.createElement(s.ActionBase,{isAvailable:g,onExecute:function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,m.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:y})}});
define("odsp-next/controls/base/react/WithKnockoutStoreItem",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","./WithKnockoutComputed","../../../models/itemsScope/facets/KnockoutStoreItemFacet"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withKnockoutStoreItem=function(e){return function(t){var u=t;return i.connectToItemCache(function(e,t){return{storeItem:e.demandItemFacet(o.knockoutStoreItemFacet,t.itemKey)}})(function(t){var i=t.storeItem,o=s.useObservableValue(i),a=s.useObservable(o);return r.createElement(u,n.__assign({},t,e(a,t)))})}};t.withKnockoutStoreItems=function(){return function(e){var t=e;return i.connectToItemCache(function(e,t){return{items:t.itemKeys.map(function(t){return e.demandItemFacet(o.knockoutStoreItemFacet,t)})}})(t)}}});
define("odsp-next/actions/itemsScope/LaunchMoveCopyPanelAction",["require","exports","tslib","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/itemsScope/LaunchMoveCopyPanelActionControl","../../models/itemsScope/facets/OdspNextAppFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.withSelectedItems()(i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/LaunchMoveCopyPanelAction"],t,n)})];case 1:return[2,t.sent().LaunchMoveCopyPanelAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var r=e.demandItemFacet(s.launchMoveCopyPanelActionControl,o.odspNextAppItemKey);return!!s.launchMoveCopyPanelActionControl.evaluate(r)(e,t).isAvailable}))});
define("@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction",["require","exports","tslib","react","@ms/items-view/lib/private/utilities/components/Async","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/decorators/asAutoAction","@ms/items-view/lib/private/components/withAction/WithAction"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDeferredOnExecuteAction=function(e,t,a){var f=o.asAutoAction({timeout:3e3})(i.asAsync(e));return s.createItemCacheComponent(function(e,i){var s=t(e,i),o=a&&a(e,i),l=u.renderComponentOnExecute(function(e){var t=e.resolve,s=e.reject,o=e.onExecuteProps;return r.createElement(f,n.__assign({},i,{onComplete:t,onError:s,onExecuteProps:o}))});return r.createElement(u.ActionBase,{onExecute:l,isAvailable:s,isToggled:o})})}});
define("odsp-next/actions/itemsScope/deferredActionExecutors/LaunchMoveCopyPanelAction",["require","exports","../../../resources/ControlResourceKeys","../base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMoveCopyPanelAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.LaunchMoveCopyPanelAction))({isMove:t.isMove})})});
define("odsp-next/actions/itemsScope/PreviewAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PreviewAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PreviewAction))})});
define("odsp-next/actions/itemsScope/ToggleInfoPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../utilities/features/Features"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!0,allowMultiSelect:i.isFeatureEnabled(i.SPListBulkEditItemProperties)})},{isToggleable:!0})});
define("odsp-next/controls/itemsScope/CommandBar",["require","exports","tslib","react","@ms/items-view/lib/private/components/itemsCommandBar/ItemsCommandBar","@ms/items-view/lib/private/components/decorators/withControlHandler","@ms/items-view/lib/private/controls/itemsCommandBarControl","../../bindings/component/ReactControlBinding","office-ui-fabric-react/lib/Fabric","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","../operation/commands/OperationCommandBuilder","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/scope/Scope","../commands/react/ReactCommandManager","./CurrentItemsScope","@ms/items-view/lib/private/utilities/performance","../../models/itemsScope/ItemsScopeManager.key","./ActionControlHandlers","./ExtendedCommandBarControl","../../models/itemsScope/facets/OdspNextAppFacets","@ms/items-view/lib/private/facets/ItemFacets","../FabricIconsDeferred","ODCItemsScopeDeferred_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S={commands:[],farCommands:[],overflowCommands:[]},x=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemsCommandBarControlHandler=function(e,t){var n=t.itemKey;if(!e.isItemFacetResolved(E.displayNameFacet,n))return S;var r=e.demandItemFacet(b.extendedCommandBarControl,w.odspNextAppItemKey);return r?b.extendedCommandBarControl.evaluate(r)(e,t):S};r._scope=new p.default;var i=r._scope.attach(new(r.context.dependencies.resources.injected(c.default))({renderLabel:1})).command;r._observables=r._scope.attach(new r.context.dependencies.observablesFactoryType({owner:r}));r._reactCommandManager=r._scope.attach(new r.context.dependencies.reactCommandManagerType({commandSet:{commands:r._observables.createArray([i])}}));r.state={farItems:r._reactCommandManager.commandBarItems.peek().farItems};r._itemsScopeManager=n.dependencies.itemsScopeManager;r._controlHandlers=o.itemsCommandBarControl.pack(r._itemsCommandBarControlHandler);return r}t.prototype.componentDidMount=function(){var e=this;this._observables.subscribe(this._reactCommandManager.commandBarItems,function(t){e.setState({farItems:n.__spreadArrays(t.farItems)})});this.props.handleRenderComplete(m.now(),this._itemsScopeManager)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.actionControlHandlers,o=this.state.farItems,u=r.createElement(n,null,r.createElement(s.ControlHandlerProvider,{controlHandlers:this._controlHandlers},r.createElement(t,null,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"block",width:"100%"}},r.createElement(i.ItemsCommandBar,{farItems:o}))))));return r.createElement(a.Fabric,null,u)};t.contextTypes=f.RESOLVED_COMPONENT_CONTEXT_TYPES;return t})(r.PureComponent);t.ItemsScopeCommandBar=x;t.resourceKey=f.createResolvedComponentTypeResourceKey(e("module").id,x,{resources:l.resourceScopeKey,observablesFactoryType:h.observablesFactoryTypeResourceKey,reactCommandManagerType:d.typeResourceKey,currentItemsScope:v.resourceKey.local,itemsScopeManager:g.resourceKey,actionControlHandlers:y.resourceKey});t.knockoutResourceKey=u.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-command-bar",name:e("module").id+".knockout"})});
define("@ms/items-view/lib/private/components/itemsCommandBar/ItemsCommandBar",["require","exports","tslib","react","../decorators/selectors","../decorators/connectToItemCache","../actionCommandBar/ActionCommandBar","../../controls/itemsCommandBarControl","../commands/new/newCommand","../commands/open/openCommand","../commands/upload/uploadCommand","../commands/share/shareCommand","../commands/download/downloadCommand","../commands/rename/renameCommand","../commands/delete/deleteCommand","../commands/showProgress/showProgressCommand","../commands/switchLayout/switchLayoutCommand","../commands/clearSelection/clearSelectionCommand","../commands/enterSelection/enterSelectionCommand","../../utilities/arrays","../../utilities/components/Props","../telemetry/TelemetryProvider","../decorators/afterPageLoad","../commands/follow/followCommand","../../models/itemsScope/getCurrentItemKey","../decorators/connectToItemsScope","../../facets/DemandFacets","../commands/sort/sortCommand","../../utilities/performance","@uifabric/utilities/lib/componentAs/composeComponentAs","../../utilities/performance","office-ui-fabric-react/lib/ResizeGroup","../../utilities/commandBarPerformance","../commands/switchLayout/switchLayoutCommand.v2","../layouts/getItemsViewLayoutsContext"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=[a.newCommand,l.uploadCommand,f.openCommand,c.shareCommand,c.copyLinkCommand,h.downloadCommand,x.followCommand,d.deleteCommand,p.renameCommand],B=[y.enterSelectionCommand],j=[],F=[],I=E.createTelemetryProvider({withContext:{component:"CommandBar"}});t.ItemsCommandBar=w.wrapWithParent(I)(S.withPageLoad()(s.connectToItemCache(function(e,t){var n=O.now(),r=T.getCurrentItemKey(e),s=i.getCurrentItemSetKey(e),o=N.getItemsScope(e).itemsScopeItemKey,a=!!e.demandItemFacet(C.errorFacet,o,{suppressGetItems:!0}),f=t.commands,l=void 0===f?F:f,c=t.overflowCommands,h=void 0===c?F:c,p=t.farCommands,d=void 0===p?F:p,m=t.shortcutCommands,y=void 0===m?F:m,w=t.buttonAs,E=w?A.composeComponentAs(w,q):q;try{if(t.hasPageLoaded&&!a){L.mark("ItemsCommandBar.render");var S=e.demandItemFacet(u.itemsCommandBarControl,r),x=[g.clearSelectionCommand,v.showProgressCommand,k.buildSortCommand(e),U(e)],M=u.itemsCommandBarControl.evaluate(S)(e,{itemKey:r||"",itemSetKey:s,commands:H,farCommands:x,overflowCommands:B,shortcutCommands:j}),D=M.commands,P=M.overflowCommands,I=M.farCommands,R=M.shortcutCommands;return{commands:b.concat(D,l),overflowCommands:b.concat(P,h),farCommands:b.concat(I,d),shortcutCommands:b.concat(R,y),buttonAs:E}}return{}}finally{var z=O.now()-n;_.itemsCommandBarSelectorTime.add(z)}})(o.ActionCommandBar)));t.ItemsCommandBar.displayName="ItemsCommandBar";function q(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]),s=r.useContext(M.MeasuredContext).isMeasured,o=O.now();return r.createElement(r.Fragment,null,t?r.createElement(t,n.__assign({},i)):null,r.createElement(R,{renderStartTime:o,isMeasured:s}))}function R(e){var t=O.now()-e.renderStartTime;(e.isMeasured?_.commandBarButtonsStagingTime:_.commandBarButtonsRenderTime).add(t);return null}function U(e){return P.getItemsViewLayoutsContext(e)?D.buildSwitchLayoutCommand(e):m.switchLayoutCommand}});
define("@ms/items-view/lib/private/components/commands/enterSelection/enterSelectionCommand",["require","exports","react","../../../models/Facet","../../actions/enterSelection/EnterSelectionAction","../../selectionVisibility/SelectionVisibility","./EnterSelectionCommand.resx","../../platformVisibility/PlatformVisibility"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.enterSelectionCommand={key:r.getNextId("enterSelectionCommand"),name:o.default.EnterSelectionCommandText,iconProps:{iconName:"CheckboxComposite"},action:n.createElement(u.ShowOnlyOnMobile,null,n.createElement(s.HideWithSelection,null,n.createElement(i.EnterSelectionAction,null)))}});
define("@ms/items-view/lib/private/components/actions/enterSelection/EnterSelectionAction",["require","exports","tslib","react","../../decorators/connectToItemCache","../../../models/itemsScope/getItemsScope","../../../facets/ScopeFacets","../../action/Action","../../../operations/resolveItems"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EnterSelectionAction=i.createItemCacheComponent(function(e,t){var i=s.getItemsScope(e).itemsScopeItemKey;if(!i)return null;if(e.demandItemFacet(o.isSelectionModalFacet,i))return null;var f=e.dispatch;return r.createElement(u.Action,{onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e;return n.__generator(this,function(t){f(a.resolveItems({items:(e={},e[i]=n.__assign({},o.isSelectionModalFacet.pack(!0)),e)}));return[2]})})},engagement:{name:"EnterSelection"}})})});
define("@ms/items-view/lib/private/components/platformVisibility/PlatformVisibility",["require","exports","../decorators/connectToItemCache","@ms/utilities-browser/lib/PlatformDetection"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new r.PlatformDetection;t.PlatformVisibility=n.createItemCacheComponent(function(e,t){var n=t.allowOnPlatform,r=t.children;return n(e,{platformDetection:i})&&r||null});t.ShowOnlyOnMobile=n.connectToItemCache(function(){return{allowOnPlatform:s}})(t.PlatformVisibility);t.HideOnMobile=n.connectToItemCache(function(){return{allowOnPlatform:o}})(t.PlatformVisibility);function s(e,t){return t.platformDetection.isMobile}function o(e,t){return!t.platformDetection.isMobile}});
define("@ms/items-view/lib/private/utilities/commandBarPerformance",["require","exports","./PerformanceCounter"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandBarButtonsRenderCount=n.createPerformanceCounter("commandBarButtons.render.count");t.commandBarButtonsRenderTime=n.createPerformanceCounter("commandBarButtons.render",{dependentCounter:t.commandBarButtonsRenderCount});t.commandBarButtonsStagingCount=n.createPerformanceCounter("commandBarButtons.stageMeasurement.count");t.commandBarButtonsStagingTime=n.createPerformanceCounter("commandBarButtons.stageMeasurement",{dependentCounter:t.commandBarButtonsStagingCount});t.itemsCommandBarSelectorCount=n.createPerformanceCounter("commandBar.selectStoreData.count");t.itemsCommandBarSelectorTime=n.createPerformanceCounter("commandBar.selectStoreData",{dependentCounter:t.itemsCommandBarSelectorCount})});
define("@ms/items-view/lib/private/components/commands/switchLayout/switchLayoutCommand.v2",["require","exports","tslib","react","../Commands.resx","./switchLayoutCommandKey","../../layouts/getItemsViewLayoutsContext","../../../components/actions/switchLayout/SwitchLayoutAction"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.buildSwitchLayoutCommand=function(e){var t=o.getItemsViewLayoutsContext(e),a=t&&t.availableLayouts,f=[];a&&a.forEach(function(e){var t=e.layoutType,i=e.command;f.push(n.__assign(n.__assign({},e.command),{key:t.id,action:r.createElement(u.SwitchLayoutAction,{layoutType:t,ariaLabel:i.ariaLabel})}))});return{key:s.switchLayoutCommandKey,automationId:"switchLayoutCommand",title:i.default.SwitchLayoutCommandLabel,ariaLabel:i.default.SwitchLayoutCommandLabel,iconProps:{iconName:"tiles"},postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:r.iconProps}:{})},subMenuProps:{items:f}}}});
define("odsp-next/controls/itemsScope/od/ItemsContextMenuController",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view-addon-photos/lib/models/keys/AlbumsRootKeyFacet","../../commands/itemsScope/AddPhotosToAlbumCommand","@ms/items-view/lib/private/components/commands/share/shareCommand","@ms/items-view/lib/private/components/commands/rename/renameCommand","../ItemsScopeCommands","office-ui-fabric-react/lib/ContextualMenu"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return f}});function f(e,t){var n=t.itemKey;if(r.albumsRootKeyFacet.matches(n)){var f={name:"-",key:"divider_1",itemType:a.ContextualMenuItemType.Divider},l={name:"-",key:"divider_2",itemType:a.ContextualMenuItemType.Divider};return{contextMenuOverride:[{command:s.shareCommand,followupCommands:[f,i.addPhotosToAlbumCommand]},{command:o.renameCommand,followupCommands:[l,u.detailsMenuCommand]}]}}return{contextMenuOverride:void 0}}});
define("odsp-next/controls/commands/itemsScope/AddPhotosToAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/AddPhotosToAlbumAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addPhotosToAlbumCommand={key:new r.Facet("addPhotosToAlbum").id,name:s.default.addToBundle,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.AddPhotosToAlbumAction,null)),iconProps:{iconName:"Add"}}});
define("odsp-next/actions/itemsScope/AddPhotosToAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddPhotosToAlbumAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap),r=new(e.injected(t.SaveAutoAlbumAction))({isHidden:!0});return new(e.injected(t.ImplicitSaveAutoAlbumAction))({action:new(e.injected(t.AddPhotosToAlbumAction)),saveAutoAlbumAction:r})})});
define("odsp-next/controls/itemsScope/ItemsScopeCommands",["require","exports","tslib","react","../commands/Commands.resx","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../actions/itemsScope/EditNewMenuAction","../../actions/itemsScope/AddToQuickLaunchAction","../../actions/itemsScope/OpenInOfficeOnlineAction","../../actions/itemsScope/OpenInOfficeClientAction","../../actions/itemsScope/ReportAbuseAction","../../actions/itemsScope/MakeHomePageAction","../../actions/itemsScope/RotateAction","../../actions/itemsScope/OrderPrintsAction","../../actions/itemsScope/EmbedAction","../../actions/itemsScope/SurveyActions","../../actions/itemsScope/CreateDocumentAction","../../actions/itemsScope/ListActions","../../actions/itemsScope/MoreAction","../../actions/itemsScope/MountPointActions","../../actions/itemsScope/LaunchFormatViewPaneAction","../../actions/itemsScope/ApproveRejectAction","@ms/items-view-addon-sp/lib/commands/NewDocumentTemplateCommands","@ms/items-view/lib/private/components/commands/getCommandIconProps","../../actions/itemsScope/NavigateToQueryRootAction","../../dataSources/url/QueryType","../../utilities/sharing/SharingHelper","@ms/items-view/lib/private/components/scope/commands/commands.resx","@ms/items-view/lib/private/facets/CommandFacets","@ms/items-view/lib/private/components/commands/open/openCommand","./spo/ItemsScopePLTCommands","../commands/itemsScope/CaptureVersionCommand","../commands/itemsScope/DetailsCommand","../commands/itemsScope/DetailsMenuCommand","../commands/itemsScope/FiltersPaneCommand","../commands/itemsScope/MoveToCommand","../commands/itemsScope/CopyToCommand","../commands/itemsScope/RunModelCommand","../commands/itemsScope/lightSpeed/FullscreenCommand","../commands/itemsScope/AddToOneDriveCommand","../commands/itemsScope/QuickEditCommand","../commands/itemsScope/CancelEditCommand","../commands/itemsScope/PreviewCommand","../commands/itemsScope/WorkflowCommand","../commands/itemsScope/ComplianceDetailsCommand","../commands/itemsScope/PublishCommand","../commands/itemsScope/UnPublishCommand","../commands/itemsScope/CancelPublishCommand","../commands/itemsScope/CreateShortcutCommand","../commands/itemsScope/OpenInPowerBICommand","../commands/itemsScope/OpenInTextEditorCommand","../commands/itemsScope/OpenInExplorerCommand","../commands/itemsScope/OpenInSharePointCommand","../commands/itemsScope/TeamChannelCommand","../commands/itemsScope/UploadFileCommand","../commands/itemsScope/UploadFolderCommand","../commands/itemsScope/FileRequestCommand","../commands/itemsScope/ManageAccessCommand"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var se={iconName:void 0,styles:{root:{display:"none!important"}}};t.alertMeCommand=M.alertMeCommand;t.manageAlertCommand=M.manageAlertCommand;t.versionHistoryCommand=M.versionHistoryCommand;t.powerAppsCommand=M.powerAppsCommand;t.aibuilderCommand=M.aibuilderCommand;t.captureVersionCommand=_.captureVersionCommand;t.detailsCommand=D.detailsCommand;t.detailsMenuCommand=P.detailsMenuCommand;t.filtersPaneCommand=H.filtersPaneCommand;t.moveToCommand=B.moveToCommand;t.copyToCommand=j.copyToCommand;t.runModelCommand=F.runModelCommand;t.fullscreenCommand=I.fullscreenCommand;t.addToOneDriveCommand=q.addToOneDriveCommand;t.quickEditCommand=R.quickEditCommand;t.cancelEditCommand=U.cancelEditCommand;t.copyFieldCommand={key:new s.Facet("CopyField").id,name:i.default.CopyField,action:r.createElement(y.CopyFieldAction,null),hasLaunchTarget:!0};t.EditItemCommand={key:new s.Facet("EditProperties").id,name:i.default.editProperties,action:r.createElement(y.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties"};t.ViewItemCommand={key:new s.Facet("ViewProperties").id,name:i.default.Open,action:r.createElement(y.ViewItemAction,null)};t.CommentItemCommand={key:new s.Facet("Comment").id,name:i.default.commentCommandText,action:r.createElement(y.ViewItemAction,{preferredSection:"comments"}),iconProps:{iconName:"Comment"}};t.bulkEditDocumentPropertyCommand={key:new s.Facet("bulkEditDocumentProperties").id,name:i.default.viewProperties,action:r.createElement(y.EditItemAction,{isBulkEdit:!0}),iconProps:{iconName:"Edit"}};t.ViewDocumentPropertyCommand={key:new s.Facet("ViewProperties").id,name:i.default.viewProperties,action:r.createElement(y.ViewItemAction,null),iconProps:{iconName:"Edit"}};t.makeHomePageCommand={key:new s.Facet("MakeHomePage").id,name:i.default.MakeHomepage,action:r.createElement(h.MakeHomePageAction,null),iconProps:{iconName:"Home"}};t.rotateCommand={key:new s.Facet("rotate").id,name:i.default.rotate,action:r.createElement(p.RotateAction,null),iconProps:{iconName:"rotate"}};t.orderPrintsCommand={key:new s.Facet("orderPrints").id,name:i.default.OrderPrints,action:r.createElement(d.OrderPrintsAction,null),iconProps:{iconName:"Print"}};t.embedCommand={key:new s.Facet("embed").id,automationId:"embed",name:i.default.Embed,action:r.createElement(v.EmbedAction,null),iconProps:{iconName:"Embed"}};t.createMountPointCommand={key:new s.Facet("createMountPoint").id,automationId:"createMountPoint",name:i.default.CreateMountPoint,action:r.createElement(w.CreateMountPointAction,null),iconProps:{iconName:"FabricFolderLink"}};t.removeMountPointCommand={key:new s.Facet("removeMountPoint").id,name:i.default.RemoveMountPoint,action:r.createElement(w.RemoveMountPointAction,null),iconProps:{iconName:"Cancel"}};t.reportAbuseCommand={key:new s.Facet("reportAbuse").id,name:i.default.reportAbuse,action:r.createElement(c.ReportAbuseAction,null),iconProps:{iconName:"EditNote"}};t.approveRejectCommand={key:new s.Facet("ApproveReject").id,name:i.default.ApproveReject,action:r.createElement(S.ApproveRejectAction,null),iconProps:se};t.previewCommand=z.previewCommand;t.WorkflowCommand=W.workflowCommand;t.ComplianceDetailsCommand=X.complianceDetailsCommand;t.EditRenditionsCommand={key:new s.Facet("EditRenditions").id,name:i.default.EditRenditions,action:r.createElement(b.EditRenditionsAction,null)};t.PublishCommand=V.publishCommand;t.UnPublishCommand=$.unPublishCommand;t.CancelPublishCommand=J.cancelPublishCommand;t.CreateShortcutCommand=K.createShortcutCommand;t.createWordCommand={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:L.default.CreateWord,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateWordAction,null)),iconProps:T.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:L.default.CreateExcel,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:L.default.CreatePowerPoint,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreatePowerPointAction,null)),iconProps:T.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:L.default.CreateOneNote,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateOneNoteAction,null)),iconProps:T.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:L.default.CreateExcelSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateExcelSurveyAction,null)),iconProps:T.getCommandIconProps({extension:"xlsx",size:16})};t.createTextFileCommand={key:new s.Facet("createTextFile").id,name:i.default.CreateText,action:r.createElement(o.HideWithSelection,null,r.createElement(g.CreateTextFileAction,null)),iconProps:T.getCommandIconProps({extension:"txt",size:16})};t.shareSurveyCommand={key:new s.Facet("shareSurvey").id,name:i.default.shareSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ShareSurveyAction,null)),iconProps:se};t.viewSurveyCommand={key:new s.Facet("viewSurvey").id,name:i.default.viewSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.ViewSurveyAction,null)),iconProps:se};t.editSurveyCommand={key:new s.Facet("editSurvey").id,name:i.default.editSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(m.EditSurveyAction,null)),iconProps:se};t.surveyCommand={key:new s.Facet("survey").id,name:"Survey",subMenuProps:{items:[t.shareSurveyCommand,t.viewSurveyCommand,t.editSurveyCommand]},iconProps:se};t.OpenInPowerBICommand=Q.openInPowerBICommand;t.AddToQuickLaunchCommand={key:new s.Facet("AddToQuickLaunch").id,name:i.default.AddToQuickLaunch,action:r.createElement(a.AddToQuickLaunch,null),iconProps:{iconName:"Pin"}};t.OpenInTextEditorCommand=G.openInTextEditorCommand;t.OpenInExplorerCommand=Y.openInExplorerCommand;t.OpenInSharePointCommand=Z.openInSharePointCommand;t.openInOfficeOnlineCommand={key:new s.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",name:"##Localized_OpenInOfficeOnline##",action:r.createElement(f.OpenInOfficeOnlineAction,null),facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.openInOfficeClientCommand={key:new s.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",name:"##Localized_OpenInOfficeClient##",action:r.createElement(l.OpenInOfficeClientAction,null),facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.openFileCommand={key:O.openCommand.key,automationId:O.openCommand.automationId,name:"##Localized_Open##",subMenuProps:{items:[t.openInOfficeOnlineCommand,t.openInOfficeClientCommand]},facets:n.__assign({},A.isReadonlyFacet.pack(!0))};t.launchFormatViewPaneCommand={key:new s.Facet("LaunchFormatViewPane").id,name:i.default.FormatView,action:r.createElement(o.HideWithSelection,null,r.createElement(E.LaunchFormatViewPaneAction,null)),iconProps:se,automationId:"launchFormatViewPaneCommand"};t.EditNewMenuCommand={key:x.editNewMenuKey,name:i.default.editNewMenu,action:r.createElement(o.HideWithSelection,null,r.createElement(u.EditNewMenuAction,null)),iconProps:{iconName:"Edit"}};t.TeamChannelCommand=ee.teamChannelCommand;t.UploadFileCommand=te.uploadFileCommand;t.UploadFolderCommand=ne.uploadFolderCommand;t.FileRequestCommand=re.fileRequestCommand;t.ManageAccessCommand=ie.manageAccessCommand;t.NavigateToSharedWithMeCommand={key:new s.Facet("NavigateToSharedWithMe").id,name:k.isShareByWithYouEnabled()?i.default.SharedWithYou:i.default.SharedWithMe,title:k.isShareByWithYouEnabled()?i.default.SharedWithYou:i.default.SharedWithMe,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedWithMe}),isPermanent:!0};t.NavigateToSharedByMeCommand={key:new s.Facet("NavigateToSharedByMe").id,name:k.isShareByWithYouEnabled()?i.default.SharedByYou:i.default.SharedByMe,title:k.isShareByWithYouEnabled()?i.default.SharedByYou:i.default.SharedByMe,action:r.createElement(N.NavigateToQueryRootAction,{queryType:C.default.SharedByMe}),isPermanent:!0}});
define("odsp-next/actions/itemsScope/EditNewMenuAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/itemsScope/getItemsScope","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Facets","../../models/itemsScope/facets/CurrentItemsScopeFacets","../../utilities/features/Features","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/EditNewMenuAction"],t,n)})];case 1:return[2,t.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(c.spItemKeyFacet,n),i=r&&e.demandItemFacet(h.listFacet,c.spListKeyFacet.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})),d=l.getPageContextFromItemCache(e,n),v=e.demandItemFacet(u.permissionsFacet,n),m=o.default.hasItemPermission({permissions:v},o.default.editListItems),g=s.getItemsScope(e).itemsScopeItemKey,y=e.demandItemFacet(a.currentViewParamsFacet,g);return f.isFeatureEnabled(f.NewDocumentTemplates)&&!!d&&!d.isAnonymousGuestUser&&!(y&&y.q)&&m&&!(i&&i.templateType===p.ListTemplateType.webPageLibrary)}return!1}))});
define("@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper",["require","exports","../../controls/itemPageContextControl"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPageContextFromItemCache=function(e,t){var r=e.demandItemFacet(n.itemPageContextControl,t);return n.itemPageContextControl.evaluate(r)(e,{itemKey:t}).pageContext}});
define("@ms/items-view-addon-sp/lib/controls/itemPageContextControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemPageContextControl=new n.ControlFacet("itemPageContext")});
define("odsp-next/actions/itemsScope/AddToQuickLaunchAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunch=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AddToQuickLaunchAction"],t,n)})];case 1:return[2,t.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(s.fileNameFacet,n),i=e.demandItemFacet(o.officeAppFacet,n),a=e.demandItemFacet(u.spItemKeyFacet,n);return!!r&&".aspx"===r.extension&&!i&&!!a&&-1!==a.listFullUrl.toLowerCase().indexOf("sitepages")}return!1})))});
define("odsp-next/actions/itemsScope/OpenInOfficeOnlineAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeOnlineAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeOnlineAction))})});
define("odsp-next/actions/itemsScope/OpenInOfficeClientAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeClientAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeClientAction))})});
define("odsp-next/actions/itemsScope/ReportAbuseAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReportAbuseAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ReportAbuseAction))})});
define("odsp-next/actions/itemsScope/MakeHomePageAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Keys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=s.withSelectedItems()(s.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/MakeHomepageAction"],t,n)})];case 1:return[2,t.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spItemKeyFacet,n),s=r&&e.demandItemFacet(o.listFacet,f.spListKeyFacet.serialize(r)),l=e.demandItem({permissions:o.permissionsFacet,isCheckedOut:i.isCheckedOutFacet},n),c=l.permissions,h=l.isCheckedOut,p=a.default.hasItemPermission({permissions:c},a.default.manageWeb);return!!s&&s.templateType===u.default.webPageLibrary&&p&&!!h&&!h.byYou}return!1})))});
define("odsp-next/actions/itemsScope/RotateAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RotateAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RotateAction))})});
define("odsp-next/actions/itemsScope/OrderPrintsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OrderPrintsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OrderPrintsAction))})});
define("odsp-next/actions/itemsScope/EmbedAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EmbedAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EmbedAction))})});
define("odsp-next/actions/itemsScope/SurveyActions",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:1})});t.ViewSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:2})});t.EditSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:3})})});
define("odsp-next/actions/itemsScope/CreateDocumentAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","@ms/odsp-datasources/lib/interfaces/list/DocumentType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return function(t){var r=t.consume(n.actionMap);return new(t.injected(r.CreateDocumentAction))({docType:e})}};t.CreateWordAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Word));t.CreateExcelAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Excel));t.CreatePowerPointAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.PowerPoint));t.CreateOneNoteAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.OneNote));t.CreateExcelSurveyAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.ExcelSurvey));t.CreateTextFileAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Text))});
define("odsp-next/actions/itemsScope/ListActions",["require","exports","tslib","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","../../utilities/features/Features","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CopyFieldAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.CopyFieldAction))});function p(e,t){var n=u.getPageContextFromItemCache(e,t),r=e.demandItemFacet(f.spItemKeyFacet,t),i=r&&f.spListKeyFacet.serialize(r),s=i&&e.demandItemFacet(l.listFacet,i),o=s&&s.templateType===a.default.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:s}}t.EditItemAction=s.withSelectedItems()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/EditItemAction"],t,n)})];case 1:return[2,t.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1||!c.isFeatureEnabled(c.SPBulkEditItemCommand)&&n.length>1)return!1;var r=p(e,n[0]),i=r.isAvailable,s=r.listContext;if(!i)return!1;if(c.isFeatureEnabled(c.SPBulkEditItemCommand)&&s&&s.isDocumentLibrary&&n.length<=1)return!1;for(var o=0,u=n;o<u.length;o++){var a=u[o],f=e.demandItemFacet(l.permissionsFacet,a);if(!(i=h.default.hasItemPermission({permissions:f},h.default.editListItems)))break}return!!i}));t.ViewItemAction=s.withSelectedItems()(s.withExactlyOneItem()(o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/ViewItemAction"],t,n)})];case 1:return[2,t.sent().ViewItemAction]}})})},function(e,t){var n,r=t.itemKey,i=t.preferredSection;if(!r)return!1;var s=p(e,r),o=s.isAvailable,u=s.listContext;return"comments"===i?o&&(null===(n=u)||void 0===n?void 0:n.templateType)===a.default.genericList:o})))});
define("odsp-next/actions/itemsScope/MoreAction",["require","exports","tslib","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","./ComplianceDetailsAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(s,t);t.WorkflowAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.WorkflowAction))});t.EditRenditionsAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.EditRenditionsAction))});t.PublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.PublishAction))});t.UnPublishAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:0})});t.CancelApprovalAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:1})})});
define("odsp-next/actions/itemsScope/ComplianceDetailsAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComplianceDetailsAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/ComplianceDetailsAction"],t,n)})];case 1:return[2,t.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({isFolder:s.folderFacet,permissions:o.permissionsFacet,spItem:a.spItemKeyFacet},n),i=r.isFolder,c=r.permissions,h=r.spItem,p=h&&a.spListKeyFacet.serialize(h),d=e.demandItemFacet(f.listFacet,p);if(!!d&&d.templateType===l.ListTemplateType.mySiteDocumentLibrary)return!1;var v=u.default.hasItemPermission({permissions:c},u.default.viewVersions);return!i&&v}return!1})))});
define("odsp-next/actions/itemsScope/MountPointActions",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateMountPointAction))});t.RemoveMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RemoveMountPointAction))})});
define("odsp-next/actions/itemsScope/LaunchFormatViewPaneAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=i.withCurrentItemSet()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/LaunchFormatViewPaneAction"],t,n)})];case 1:return[2,t.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(o.spFolderItemSetKeyFacet,n),i=r&&o.spListKeyFacet.serialize(r),f=e.demandItemFacet(u.listFacet,i);if(!!f&&f.templateType===a.ListTemplateType.mySiteDocumentLibrary)return!1;if(r&&r.viewKey){var l=o.spViewKeyFacet.serialize(r.viewKey);if(e.demandItemFacet(s.currentDerivedViewFacet,l))return!0}}return!1}))});
define("odsp-next/actions/itemsScope/ApproveRejectAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ApproveRejectAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ApproveRejectAction))})});
define("@ms/items-view-addon-sp/lib/commands/NewDocumentTemplateCommands",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editNewMenuKey=new n.Facet("editNewMenu").id});
define("odsp-next/actions/itemsScope/NavigateToQueryRootAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/DataSourceResourceKeys","../../providers/item/ItemProvider"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToQueryRootAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),o=e.consume(s.resourceKey),u=e.consume(i.url);return new(e.injected(r.OpenAction))({item:o.getItemSync({parentKey:u.getRootItemKey(t.queryType)}).item,openRelation:2})})});
define("odsp-next/controls/itemsScope/spo/ItemsScopePLTCommands",["require","exports","../../commands/itemsScope/AlertMeCommand","../../commands/itemsScope/ManageAlertCommand","../../commands/itemsScope/VersionHistoryCommand","../../commands/itemsScope/PowerAppsCommand","../../commands/itemsScope/AIBuilderCommand","../../commands/itemsScope/PowerBICommand"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand=n.alertMeCommand;t.manageAlertCommand=r.manageAlertCommand;t.versionHistoryCommand=i.versionHistoryCommand;t.powerAppsCommand=s.powerAppsCommand;t.aibuilderCommand=o.aibuilderCommand;t.powerBICommand=u.powerBICommand});
define("odsp-next/controls/commands/itemsScope/AlertMeCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/AlertAction","../PLTCommands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand={key:new r.Facet("AlertMe").id,name:s.default.Alert,action:n.createElement(i.AlertMeAction,null),iconProps:{iconName:"Ringer"},automationId:"alertMe"}});
define("odsp-next/actions/itemsScope/AlertAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../dataSources/url/odb/ItemUrlHelper","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/base/react/WithResources"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=l.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AlertAction"],t,n)})];case 1:return[2,t.sent().AlertAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),l=e.demandItemFacet(u.permissionsFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&a.PermissionMask.hasItemPermission({permissions:l},a.PermissionMask.createAlerts)))return!1;var c=r&&r.consume(o.resourceKey.optional);if(c){var h=e.demandItemFacet(f.canonicalUrlFacet,n);if(c.getUrlParts({path:h}).isCrossDomain)return!1}return!0}),p=i.withSelectedItems()(i.withCurrentItemAsFallback()(i.withExactlyOneItem()(h)));t.AlertMeAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e})};t.ManageAlertAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e,manageAlerts:!0})}});
define("odsp-next/controls/commands/itemsScope/ManageAlertCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/AlertAction","../PLTCommands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAlertCommand={key:new r.Facet("ManageAlert").id,name:s.default.ManageAlert,action:n.createElement(i.ManageAlertAction,null),iconProps:{iconName:"EditNote"}}});
define("odsp-next/controls/commands/itemsScope/VersionHistoryCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/VersionHistoryAction","../PLTCommands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.versionHistoryCommand={key:new r.Facet("VersionHistory").id,name:s.default.ShowVersionHistory,action:n.createElement(i.VersionHistoryAction,null),iconProps:{iconName:"StackIndicator"}}});
define("odsp-next/actions/itemsScope/VersionHistoryAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../dataSources/url/odb/ItemUrlHelper","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/base/react/WithResources","@ms/items-view-addon-sp/lib/dataSource/Keys","../../utilities/features/PLTFeatures","@ms/items-view/lib/private/facets/DocumentFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=c.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/VersionHistoryAction"],t,n)})];case 1:return[2,t.sent().VersionHistoryAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),c=e.demandItemFacet(u.permissionsFacet,n),h=e.demandItemFacet(a.itemComplianceStatusFacet,n),m=e.demandItemFacet(l.malwareDetectedFacet,n),g=!!i&&!i.isEmailAuthenticationGuestUser&&f.PermissionMask.hasItemPermission({permissions:c},f.PermissionMask.viewVersions)&&3!==h&&4!==h;if(m||!g)return!1;var y=e.demandItemFacet(p.spItemKeyFacet,n),b=y&&p.spListKeyFacet.serialize(y),w=e.demandItemFacet(u.listFacet,b),E=!(!w||!w.enableVersions&&!w.isModerated);if(!E)return!1;var S=r&&r.consume(o.resourceKey.optional);if(S){var x=e.demandItemFacet(l.canonicalUrlFacet,n);if(S.getUrlParts({path:x}).isCrossDomain)return!1}var T=e.demandItemFacet(l.folderFacet,n),N=e.demandItemFacet(u.documentSetFacet,n),C=e.demandItemFacet(v.oneNoteFacet,n),k=e.demandItemFacet(u.listItemIdFacet,n),L=d.isFeatureEnabled(d.DocumentSetsModernView)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites)&&k;return E=!T&&!C||!(!L||!N)}),g=i.withSelectedItems()(i.withExactlyOneItem()(m));t.VersionHistoryAction=function(){var e=h.useResourceScope();return r.createElement(g,{resources:e})}});
define("@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet",["require","exports","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","../../utilities/item/pageContextHelper","@ms/items-view/lib/private/facets/ItemFacets","../../dataSource/Facets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemComplianceStatusFacet=new n.ComputedItemFacet("itemComplianceStatus",function(e,t){var n=t.itemKey,o=r.getPageContextFromItemCache(e,n),u=o&&o.blockDownloadsExperienceEnabled,a=o&&o.viewOnlyExperienceEnabled;if(u||a){var f=void 0;u&&e.demandItemFacet(i.openUrlFacet,n)&&e.demandItemFacet(s.officeAppFacet,n)?f=4:u&&!e.demandItemFacet(i.folderFacet,n)?f=3:a&&(f=4);return f}})});
define("odsp-next/controls/commands/itemsScope/PowerAppsCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/PowerAppActions","../PLTCommands.resx","../../../utilities/features/PLTFeatures"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={key:new r.Facet("CustomizeListForms").id,name:o.default.CustomizeListForms,engagement:{name:"LaunchCustomizePowerAppForm",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.CustomizeFormsNavigationAction,null))},f={key:new r.Facet("CreateAppView").id,name:o.default.CreateAppView,engagement:{name:"LaunchCreatePowerAppPanel",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.LaunchCreateAppViewPanelAction,null))},l={key:new r.Facet("SeeAllApps").id,name:o.default.SeeAllAppsLabel,engagement:{name:"LaunchSeeAllPowerApps",isIntentional:!0},action:n.createElement(i.HideWithSelection,null,n.createElement(s.SeeAllAppsAction,null))};t.powerAppsCommand={key:new r.Facet("PowerApps").id,name:u.isFeatureEnabled(u.PowerAppsIncludeSpace)?o.default.AppViewsCommandLabel_WithSpace:o.default.AppViewsCommandLabel,iconProps:{iconName:"PowerApps2Logo"},engagement:{name:"PowerAppsMainMenu",isIntentional:!0},subMenuProps:{items:[f,l,a]}}});
define("odsp-next/actions/itemsScope/PowerAppActions",["require","exports","tslib","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../utilities/features/PLTFeatures","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){var n=t.itemKey;if(!n)return!1;var r=i.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.isFeatureEnabled(s.PowerApps)&&!r.disableAppViews}t.CustomizeFormsNavigationAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().CustomizeFormsNavigationAction]}})})},function(e,t){var n=t.itemKey,r=s.isFeatureEnabled(s.PowerAppListForms)&&s.isFeatureEnabled(s.PowerApps),i=!!n&&r;if(!i)return!1;var f=e.demandItemFacet(o.spItemKeyFacet,n),l=f&&o.spListKeyFacet.serialize(f),c=e.demandItemFacet(u.listFacet,l);if(!c||!c.id)return!1;var h=!(!c.permissions||!c.permissions.manageLists),p=c.isDocumentLibrary,d=Number(c.templateType)===a.ListTemplateType.genericList;return i=s.isFeatureEnabled(s.PowerappsCustomizationOnDocLibs)?(p||d)&&h:!p&&d&&h}));t.LaunchCreateAppViewPanelAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().LaunchCreateAppViewPanelAction]}})})},function(e,t){var n=t.itemKey,r=!!n&&l(e,t);if(r){var i=e.demandItemFacet(o.spItemKeyFacet,n),s=i&&o.spListKeyFacet.serialize(i),a=e.demandItemFacet(u.listFacet,s);r=!(!(a&&a.permissions&&a.permissions.manageLists)||a.isDocumentLibrary)}return r}));t.SeeAllAppsAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().SeeAllAppsAction]}})})},l))});
define("odsp-next/controls/commands/itemsScope/AIBuilderCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/AIBuilderAction","../PLTCommands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={key:new r.Facet("CreateAIBuilderModel").id,name:o.default.CreateAIBuilderModel,action:n.createElement(i.HideWithSelection,null,n.createElement(s.CreateAIBuilderModelAction,null))},a={key:new r.Facet("ViewAIBuilderModelDetails").id,name:o.default.ViewAIBuilderModelDetails,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelDetailsAction,null))},f={key:new r.Facet("GotoAIBuilder").id,name:o.default.GotoAIBuilder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.ViewAIBuilderModelsAction,null))};t.aibuilderCommand={key:new r.Facet("AIBuilder").id,name:o.default.AIBuilderCommandLabel,iconProps:{iconName:"HomeGroup"},subMenuProps:{items:[u,a,f]}}});
define("odsp-next/actions/itemsScope/AIBuilderAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/items-view-addon-sp/lib/dataSource/Keys","../../utilities/aibuilder/AIBuilderHelper","./LaunchCreateAIBModelPanelAction","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.isAvailable,s="https://"+l.getAIBuilderRunTimeHost()+"/aibuilder/default-environment/models?template=SharePointFormProcessing";return r.createElement(i.Action,{isAvailable:t,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open(s,"_blank");return[2]})})}})};return t})(r.PureComponent),v=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.isModelApplied,n=e.permissions,i=h.default.hasItemPermission({permissions:n},h.default.manageLists),s=p.default.isActivated("FAEE08B0-697A-4B92-AA71-74ED9A366CA7","6/23/2020","Check permission for create form processing model menu")?!t:!t&&i;return r.createElement(r.Fragment,null,s&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent),m=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.isModelApplied;return r.createElement(r.Fragment,null,e&&r.createElement(c.LaunchCreateAIBModelPanelAction,null))};return t})(r.PureComponent);function g(e){var t,n=s.getCurrentItemSetKey(e),r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),i=r&&f.spListKeyFacet.serialize(r),o=e.demandItemFacet(u.listFacet,i),a=r?r.webAbsoluteUrl:"",l=null===(t=r)||void 0===t?void 0:t.listFullUrl;return{viewId:r&&r.viewKey?r.viewKey.viewId:void 0,webAbsoluteUrl:a,list:o,listFullUrl:l,isPredictionModelApplied:!!o&&!!o.flags2&&8192==(8192&o.flags2),permissions:l?e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:l,webAbsoluteUrl:a})):void 0}}t.ViewAIBuilderModelsAction=o.connectToItemCache(function(e){var t=g(e).list;return{isAvailable:!!t&&!!t.isDocumentLibrary&&t.templateType!==a.ListTemplateType.webPageLibrary&&t.templateType!==a.ListTemplateType.mySiteDocumentLibrary}})(d);t.CreateAIBuilderModelAction=o.connectToItemCache(function(e){var t=g(e);return{isModelApplied:t.isPredictionModelApplied,permissions:t.permissions}})(v);t.ViewAIBuilderModelDetailsAction=o.connectToItemCache(function(e){return{isModelApplied:g(e).isPredictionModelApplied}})(m)});
define("odsp-next/utilities/aibuilder/AIBuilderHelper",["require","exports","../features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAIBuilderRunTimeHost=function(){var e="make.powerapps.com";n.isFeatureEnabled(n.PreviewAIBuilder)?e="make.preview.powerapps.com":n.isFeatureEnabled(n.PowerAppsAndAndProcessSimpleTestEnvironment)&&(e="make.test.powerapps.com");return e}});
define("odsp-next/actions/itemsScope/LaunchCreateAIBModelPanelAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/wizardAction/WizardAction","@ms/items-view/lib/private/utilities/async/CancelError","../../controls/base/react/WithResources","@ms/utilities-react/lib/decorators/asAsync","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../controls/aiBuilderPanel/CreateAIBModelPanel"],t,n)})];case 1:return[2,t.sent().default]}})})});t.LaunchCreateAIBModelPanelAction=i.createItemCacheComponent(function(e){var t,n,i=f.getCurrentItemSetKey(e),a=e.demandItemFacet(l.spFolderItemSetKeyFacet,i),d=a&&l.spListKeyFacet.serialize(a),v=e.demandItemFacet(c.listFacet,d),m=a?a.webAbsoluteUrl:"",g=(null===(t=a)||void 0===t?void 0:t.listFullUrl)?a.listFullUrl:"",y=(null===(n=v)||void 0===n?void 0:n.id)?v.id.replace("{","").replace("}",""):"",b=!!(g&&m&&y&&v&&v.isDocumentLibrary&&v.templateType!==h.ListTemplateType.webPageLibrary&&v.templateType!==h.ListTemplateType.mySiteDocumentLibrary),w=!!v&&!!v.flags2&&8192==(8192&v.flags2);return r.createElement(s.WizardAction,{engagement:{isIntentional:!0,name:w?"ViewFormProcessingModelPanelOpen":"CreateFormProcessingModelPanelOpen",currentPage:"DocumentLibraryPage"},isAvailable:b},u.withResources()(function(e){var t=e.reject,n=e.resolve;return r.createElement(p,{resources:e.resources,onDismiss:function(){t(new o.CancelError)},onComplete:function(e){e&&n()},createModelContext:{webAbsoluteUrl:m,listId:y,listFullUrl:g,isPredictionModelApplied:w}})}))})});
define("@ms/items-view/lib/private/components/wizardAction/WizardAction",["require","exports","../../utilities/components/RenderProps","../decorators/connectToItemCache","../action/Action","../withAction/WithAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WizardAction=r.connectToItemCache(o("local"))(i.Action);t.BackgroundAction=r.connectToItemCache(o("global"))(i.Action);t.HeadlessAction=r.connectToItemCache(o("headless"))(i.Action);function o(e){return function(t,r){var i=r.children;return{onExecute:s.renderComponentOnExecute(function(e){return n.renderChildrenWithProps(i,e)},{scope:e})}}}});
define("odsp-next/controls/commands/itemsScope/PowerBICommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","@ms/items-view-addon-sp/lib/actions/PowerBIAction","../PLTCommands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.powerBICommand={key:new r.Facet("PowerBI").id,name:o.default.PowerBICommandLabel,iconProps:{iconName:"PowerBILogo16"},action:n.createElement(i.HideWithSelection,null,n.createElement(s.PowerBIAction,null))}});
define("@ms/items-view-addon-sp/lib/actions/PowerBIAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/components/withAction/WithAction","@ms/items-view/lib/private/utilities/async/CancelError","@ms/items-view/lib/private/utilities/components/Async","../utilities/item/pageContextHelper","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/telemetry/getItemEngagement"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=a.asAsync(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../components/powerBI/PowerBIPanel"],t,n)})];case 1:return[2,t.sent().PowerBIPanel]}})})});t.PowerBIAction=l.withCurrentItemSet()(i.createItemCacheComponent(function(e,t){var i=t.itemKey,a=f.getPageContextFromItemCache(e,i);if(!a)return null;var l=c.getItemActionEngagement(e,{itemKey:i,engagement:{name:"LaunchPowerBIPanel",isIntentional:!0}}),p=o.renderComponentOnExecute(function(e){return r.createElement(h,{pageContext:a,onDismiss:function(){e.reject(new u.CancelError)}})});return r.createElement(s.Action,n.__assign({onExecute:p},l))}))});
define("odsp-next/controls/commands/itemsScope/CaptureVersionCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/CaptureVersionAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.captureVersionCommand={key:new r.Facet("CaptureVersion").id,name:s.default.CaptureVersion,action:n.createElement(i.CaptureVersionAction,null),iconProps:{iconName:"StackIndicator"}}});
define("odsp-next/actions/itemsScope/CaptureVersionAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/components/withAction/WithAction","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../controls/commands/Commands.resx","../../dataSources/url/odb/ItemUrlHelper","@uifabric/utilities/lib/Async","@ms/items-view-addon-sp/lib/components/IFrameDialog/IFrameDialog","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/models/telemetry/getItemEngagement","../../controls/base/react/WithResources","@ms/items-view-addon-sp/lib/dataSource/Keys","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=g.createItemCacheComponent(function(e,t){var s=t.itemKey,l=t.resources,g=e.demandItemFacet(p.listItemIdFacet,s),b=u.getPageContextFromItemCache(e,s),S=b?b.layoutsUrl:"",T=b&&b.listId||"",N=(b?b.webAbsoluteUrl:"")+"/"+S+"/CreateDocSetVersion.aspx?"+h.serializeQuery({list:T,ID:g||"",IsDlg:1}),C=(function(e,t){var n=t.itemKey,r=t.resources;if(!n||!r)return!1;var i=u.getPageContextFromItemCache(e,n),s=e.demandItemFacet(p.permissionsFacet,n),o=e.demandItemFacet(d.itemComplianceStatusFacet,n);if(!i||i.isEmailAuthenticationGuestUser||!v.PermissionMask.hasItemPermission({permissions:s},v.PermissionMask.editListItems)||3===o||4===o)return!1;var a=e.demandItemFacet(w.spItemKeyFacet,n),l=a&&w.spListKeyFacet.serialize(a),c=e.demandItemFacet(p.listFacet,l),h=!!c&&!!c.enableVersions;if(!h)return!1;var g=r.consume(f.resourceKey.optional);if(g){var y=e.demandItemFacet(m.canonicalUrlFacet,n);if(g.getUrlParts({path:y}).isCrossDomain)return!1}var b=e.demandItemFacet(p.documentSetFacet,n),S=e.demandItemFacet(p.listItemIdFacet,n),x=E.isFeatureEnabled(E.DocumentSetsModernView)&&E.isFeatureEnabled(E.UseItemsScopeInTeamSites)&&S;return h=!(!x||!b)})(e,{itemKey:s,resources:l}),k=o.renderComponentOnExecute(function(e){return r.createElement(c.IFrameDialog,{url:N,heightOffset:.7,dialogContentProps:{title:a.default.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:x})});return r.createElement(i.Action,n.__assign({isAvailable:C,onExecute:k},y.getItemActionEngagement(e,{itemKey:s,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function x(e){new l.Async(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var T=s.withSelectedItems()(s.withExactlyOneItem()(S));t.CaptureVersionAction=function(){var e=b.useResourceScope();return r.createElement(T,{resources:e})}});
define("@ms/items-view-addon-sp/lib/components/IFrameDialog/IFrameDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Spinner","ODCItemsScopeDeferred_css"],function(e,t,n,r,i,s,o,u){"use strict";u=u.IFrameDialog_9;Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,a=t.url,f=(t.heightOffset,n.__rest(t,["url","heightOffset"])),l=this.state.isIFrameLoaded;return r.createElement(s.Dialog,n.__assign({className:u.IFrameDialog,hidden:!this.state.isOpen,type:s.DialogType.close},f),r.createElement(i.FocusZone,null,!l&&r.createElement(o.Spinner,{size:o.SpinnerSize.large}),r.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:a,style:{display:l?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(r.Component);t.IFrameDialog=a});
define("odsp-next/controls/commands/itemsScope/DetailsCommand",["require","exports","tslib","react","../../../actions/itemsScope/ToggleInfoPaneAction","../../knockoutContentShim/WithKnockoutResourceScope","./DetailsCommandBaseWithoutAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommand=n.__assign(n.__assign({},o.detailsCommandBaseWithoutAction),{action:r.createElement(s.WithKnockoutResourceScope,null,r.createElement(i.ToggleInfoPaneAction,null))})});
define("odsp-next/controls/commands/itemsScope/DetailsCommandBaseWithoutAction",["require","exports","tslib","@ms/items-view/lib/private/models/Facet","react","../PLTCommands.resx","../../base/react/WithResources","../../detailsPane/DetailsPaneId"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommandBaseWithoutAction={key:new r.Facet("Details").id,automationId:"detailsPane",iconProps:{iconName:"Info"},title:s.default.DetailsPane,ariaLabel:s.default.DetailsPane,shortcutProps:{content:s.default.DetailsPane,keySequences:["I"]},commandBarButtonAs:function(e){var t=e.defaultRender,r=o.useResourceScope().consume(u.resourceKey),s=e.actionState,a=s&&s.isToggled;return t?i.createElement(t,n.__assign({},e,{"aria-controls":r,"aria-expanded":!!a})):null}}});
define("odsp-next/controls/commands/itemsScope/DetailsMenuCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/ShowInfoPaneAction","../Commands.resx","../PLTCommands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsMenuCommand={key:new r.Facet("Details").id,name:s.default.Details,ariaLabel:o.default.DetailsPane,action:n.createElement(i.ShowInfoPaneAction,null)}});
define("odsp-next/actions/itemsScope/ShowInfoPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})});
define("odsp-next/controls/commands/itemsScope/FiltersPaneCommand",["require","exports","tslib","react","../../../actions/itemsScope/ToggleFiltersPaneAction","./FiltersPaneCommandBaseWithoutAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommand=n.__assign(n.__assign({},s.filtersPaneCommandBaseWithoutAction),{action:r.createElement(i.ToggleFiltersPaneAction,null)})});
define("odsp-next/actions/itemsScope/ToggleFiltersPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowFiltersAction))},{isToggleable:!0})});
define("odsp-next/controls/commands/itemsScope/FiltersPaneCommandBaseWithoutAction",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../PLTCommands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filtersPaneCommandBaseWithoutAction={key:new i.Facet("FiltersPane").id,automationId:"filtersPane",title:s.default.FiltersPane,ariaLabel:s.default.FiltersPane,iconProps:{iconName:"Filter"},commandBarButtonAs:function(e){var t=e.actionState&&e.actionState.isToggled,i=e.defaultRender;return i?r.createElement(i,n.__assign({},e,{"aria-expanded":!!t})):null}}});
define("odsp-next/controls/commands/itemsScope/MoveToCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/LaunchMoveCopyPanelAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveToCommand={key:new r.Facet("MoveTo").id,name:o.default.Move,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!0})),iconProps:{iconName:"FabricMoveToFolder"}}});
define("odsp-next/controls/commands/itemsScope/CopyToCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/LaunchMoveCopyPanelAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToCommand={key:new r.Facet("CopyTo").id,name:o.default.Copy,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.LaunchMoveCopyPanelAction,{isMove:!1})),iconProps:{iconName:"Copy"}}});
define("odsp-next/controls/commands/itemsScope/RunModelCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/RunModelCommandAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.runModelCommand={key:new r.Facet("AutoClassify").id,name:o.default.RunModelText,title:o.default.RunModelToolTip,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.RunModelAction,null)),iconProps:{iconName:"Play"}}});
define("odsp-next/actions/itemsScope/RunModelCommandAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","../../controls/base/react/WithResources","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/action/Action","@ms/items-view/lib/private/facets/ItemFacets","../../resources/SPOResourceKeys","../../dataSources/contentCenter/spo/ContentCenterDataSource","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../providers/operation/OperationProvider","../../models/operation/OperationType","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/item/OneDriveItem","@ms/odsp-utilities/lib/icons/IconSelector","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=o.createItemCacheComponent(function(e,t){var i,s,o=t.resources;if(!o)return null;var x=t.itemKeys;x=x.filter(function(t){return!e.demandItemFacet(a.folderFacet,t)});var T=o&&o.consume(f.listContext)||{},N=T.listUrl,C=T.listTemplateType,k=E.getCurrentItemSetKey(e),L=e.demandItemFacet(w.spFolderItemSetKeyFacet,k),A=L&&w.spListKeyFacet.serialize(L),O=e.demandItemFacet(S.listFacet,A),M=o&&o.consume(l.resourceKey),_=o&&o.consume(f.pageContext)||{},D=_.webAbsoluteUrl,P=_.webServerRelativeUrl,H=x.map(function(t){var n,r,i=new m.default(t),s=e.demandItem({fileName:a.fileNameFacet,openUrl:a.openUrlFacet},t),o=s.fileName,u=s.openUrl;i.name=(null===(n=o)||void 0===n?void 0:n.name)||"";i.extension=(null===(r=o)||void 0===r?void 0:r.extension)||"";i.displayName=""+i.name+i.extension;i.openUrl=u||"";return i}),B=x&&x.length>0&&C!==c.default.contentCenterSampleLibrary&&!!O&&!!O.flags2&&4096==(4096&O.flags2)&&!!(null===(s=null===(i=O)||void 0===i?void 0:i.permissions)||void 0===s?void 0:s.manageLists);return r.createElement(u.Action,{isAvailable:B,onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:e=(function(){var e=new v.default,t=o.consume(h.resourceKey),n=H.map(function(n){var r=t.register({name:n.displayName||"",iconName:g.getIconNameFromItem({type:y.default.File,extension:n.extension}),type:p.default.runModelOnItems,payloads:{runModelOnItems:{item:n}},batch:e,progress:{minimum:0,maximum:1,current:0}});r.progress.maximum(1);r.progress.current(0);return r});n.forEach(function(e){e.state(d.default.started)});return n})();t=(function(){var e=[];H.forEach(function(t){var n,r={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData"},Type:"AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",TargetSiteUrl:D,TargetWebServerRelativeUrl:P,TargetServerRelativeUrl:((null===(n=L)||void 0===n?void 0:n.rootFolder)||N)+"/"+t.displayName};e.push(r)});return e})();return[4,null===(r=M)||void 0===r?void 0:r.runModel(t).then(function(t){e.forEach(function(e){if(t.has(e.name)){e.progress.current(1);e.state(d.default.completed)}else e.state(d.default.failed)})}).catch(function(t){var n,r;b.default.log("[ccui] fetching content type failed "+(null===(r=null===(n=t)||void 0===n?void 0:n.message)||void 0===r?void 0:r.value));e.forEach(function(e){e.state(d.default.failed)})})];case 1:n.sent();return[2]}})})}})}),T=i.withSelectedItems()(x);t.RunModelAction=function(){var e=s.useResourceScope();return r.createElement(T,{resources:e})}});
define("odsp-next/dataSources/contentCenter/spo/ContentCenterDataSource",["require","exports","tslib","../../url/odb/ApiUrlHelper","../../base/odb/DataSource","@ms/odsp-utilities/lib/resources/Resources","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-datasources/lib/dataSources/base/DataBatchOperationHelper","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r.extractFileName=function(e){var t=e.split("/");return t[t.length-1]};r._apiUrlHelper=n.apiUrlHelper;r._navigation=n.navigation;r._pageContext=n.pageContext;return r}t.prototype.getWebFields=function(e){var t=e+"/_api/web/fields?$select=Id,Title&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')";return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getSiteContentTypes=function(e,t,n,r){void 0===r&&(r="Intelligent Document Content Types");var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;r&&(t=t.filter(function(e){return e.group===r}));return t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.getColumnsForSiteContentType=function(e,t,n,r){var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes/"+r+"/columnLinks";return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return a.default.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})};t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})};t.prototype.createOrUpdateModel=function(e,t,n,r,i){void 0===i&&(i="Intelligent Document Content Types");var s={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:r,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(s),method:"POST"})};t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl);t.push(this._pageContext.layoutsUrl);t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)};t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome&modelUniqueId="+e,n=[];n.push(this._pageContext.webAbsoluteUrl);n.push(this._pageContext.layoutsUrl);n.push("training.aspx");var r=n.join("/")+t;this._navigation.navigateTo({url:r,frameId:"_blank"})};t.prototype.runModelBatchRequest=function(e,t,n,r){var i=this;if(!r)return Promise.reject("failed");for(var s=a.default.generate(),o="multipart/mixed; boundary=batch_"+s,u=[],c=Math.ceil(r().length/30),h=0;h<c;h++){var p=r().slice(30*h,30*(h+1)),d=this.getConvertedData(p,e,s);u.push(this.dataRequestor.getData({url:f.DataBatchOperationHelper.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:this.getDataSourceName()+"."+n,additionalPostData:d,method:"POST",contentType:o}).then(function(e){return f.DataBatchOperationHelper.getBatchResponseText(e)}).catch(function(e){var t,n;l.default.log("[ccui] fetching content type failed "+(null===(n=null===(t=e)||void 0===t?void 0:t.message)||void 0===n?void 0:n.value));Promise.reject(e)}))}return Promise.all(u).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n,r,s;if((null===(n=null===(t=e=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.Created)&&(null===(s=null===(r=e)||void 0===r?void 0:r.d)||void 0===s?void 0:s.TargetServerRelativeUrl))return i.extractFileName(e.d.TargetServerRelativeUrl)}))})};t.prototype.getConvertedData=function(e,t,n){void 0===t&&(t="");void 0===n&&(n="");if(!e)return e;var r=f.DataBatchOperationHelper.defaultBatchAcceptData,i=[],s=[],o=[],u=f.DataBatchOperationHelper.defaultBatchRequestPostData,a=1;e.forEach(function(e){o.push(""+a++);i.push(t);s.push(JSON.stringify(e))});return f.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",u,s,r)};t.dependencies={pageContext:o.pageContext,apiUrlHelper:r.resourceKey,navigation:u.navigation};return t})(i.default);t.default=c;t.resourceKey=s.createResolvedResourceKey(e("module").id,c)});
define("odsp-next/controls/commands/itemsScope/lightSpeed/FullscreenCommand",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../../PLTCommands.resx","../../../../experiments/splightspeed/actions/FullscreenAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullscreenCommand={action:o.FullscreenAction,automationId:"expandCollapseList",key:new i.Facet("FullscreenMode").id,commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"BackToWindow":"FullScreen"},title:i?s.default.collapseContent:s.default.expandContent})):null}}});
define("odsp-next/experiments/splightspeed/actions/FullscreenAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","../context/SPOAppContextProvider","../../../resources/SPOResourceKeys","../../../utilities/list/FullscreenListHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FullscreenAction=s.createComponentWithSPOAppContext([s.ContextKeys.pageControls,s.ContextKeys.resources])(function(e){var t=e.pageControls,a=e.resources,f=t.isFullscreen,l=a.consume(u.resourceKey);return r.createElement(i.Action,{isToggled:f,engagement:{isIntentional:!0,name:f?"FullscreenListOff":"FullscreenListOn"},onExecute:function(){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){t=a.consume(o.pageContext);(r=t&&t.listUrl)&&l.setFullscreenToStorage(!f,r);e.handleContextDataChange(((i={})[s.ContextKeys.pageControls]={isFullscreen:!f},i));return[2]})})}})})});
define("odsp-next/experiments/splightspeed/context/SPOAppContextProvider",["require","exports","tslib","@ms/items-view/lib/private/utilities/Graft","@ms/utilities-objects/lib/areShallowEqual","react","../utilities/browser/ResponsiveUI","./ContextKeys","./SPOAppContextItems","./SPOAppContextHandler"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=u;var l=s.createContext({}),c=(function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._isDisposed=!1;r._handleContextChange=function(e){if(!r._isDisposed){var t=r.state,i=t.contextData,s=t.handleContextDataChange,o=p(i,e);if(!o)return null;r.setState({contextData:o,handleContextDataChange:s},function(){r._contextHandler.notifyUpdate(n.__assign({},o))})}};r._contextHandler=t.resources.consume(f.resourceKey);r._setContextInitState();return r}t.prototype.componentDidMount=function(){this._contextHandler.registerContextChangeHandler(this._handleContextChange);this._contextHandler.notifyUpdate(n.__assign({},this.state.contextData))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this._stopListener&&this._stopListener()};t.prototype.render=function(){return s.createElement(l.Provider,{value:this.state},this.props.children)};t.prototype._setContextInitState=function(){var e=this,t=this.props.resources,r=t.consume(o.resourceKey);this._stopListener=r.listen(function(t){var r;e._handleContextChange(((r={})[u.responsiveUIMetrics]=n.__assign({},t),r))});this.state={contextData:a.createSPOAppContextData(t),handleContextDataChange:this._handleContextChange}};return t})(s.PureComponent);t.SPOAppContextProvider=c;function h(e,t){for(var n=t.contextData,r={handleContextDataChange:t.handleContextDataChange},i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=n[u].data;r[u]=a;i.push(a)}return{pickedContext:r,contextDeps:i}}t.pickContextItems=h;t.createComponentWithSPOAppContext=function(e){return function(t){return function(r){var i=s.useContext(l),o=h(e,i),u=o.pickedContext,a=o.contextDeps,f=t;return s.useMemo(function(){return s.createElement(f,n.__assign({},u,r))},n.__spreadArrays(a,[r]))}}};function p(e,t){var n={},s=!1;for(var o in t){var u=e[o],f=u.data,l=t[o],c=void 0;switch(u.updateMethod){case a.ContextItemUpdateMethod.READONLY:throw'Read-only SPOAppContextItem "'+o+'" cannot be updated';case a.ContextItemUpdateMethod.REPLACE:c=l;break;case a.ContextItemUpdateMethod.PATCH:default:c=r.graft(f,l)}if(i.areShallowDifferent(f,c)){s=!0;n[o]={data:new r.ReplacePatch(c)};u.onChange&&u.onChange(f,c)}}return s?r.graft(e,n):null}t.createNewContextData=p});
define("odsp-next/experiments/splightspeed/utilities/browser/ResponsiveUI",["require","exports","tslib","@ms/odsp-utilities/lib/events/EventGroup","../../dataSources/base/Listenable","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},u={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0};t.breakpointsResourceKey=new s.ResourceKey({name:e("module").id+".breakpoints",factory:new s.ConstantResourceFactory(u)});var a=(function(e){n.__extends(i,e);function i(t,n){var i=e.call(this)||this;i._onContainerResize=function(e){var t=i._containerElement,n=document.body,r=document.documentElement,s=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,o=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight,a=i._computeFormFactorSize(i._breakpoints,s),f=i._computeCssClass(a),l=i._computeShowLabels(a),c=i._computeIsHamburgerVisible(s),h={DEFAULT_BREAKPOINTS:u,MAC_SCROLL_BAR_WIDTH:8,windowWidth:s,windowHeight:o,formFactorSize:a,showLabels:l,isHamburgerVisible:c,cssClass:f};i.setData(h)};var s=t.containerElement,o=void 0===s?window:s,a=n.breakpoints;i._containerElement=o;i._breakpoints=a;i._event=new r.default(i);i._event.on(i._containerElement,"resize, orientationchange",i._onContainerResize);i._onContainerResize();return i}Object.defineProperty(i.prototype,"metrics",{get:function(){return this.readData()},enumerable:!0,configurable:!0});i.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};i.determineWindowSize=function(e,t){void 0===t&&(t=u);if(0===e)return"Medium";for(var n in u)if(e<t[n])return n};i.determineCssClass=function(e){return o[e]};i.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};i.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};i.prototype._computeFormFactorSize=function(e,t){return this._containerElement===window?i.determineWindowSize(t,e):"Medium"};i.prototype._computeCssClass=function(e){return i.determineCssClass(e)};i.prototype._computeShowLabels=function(e){return this.compareSize(e,"Medium")>0};i.prototype._computeIsHamburgerVisible=function(e){return e<u.Large};i.dependencies={breakpoints:t.breakpointsResourceKey};return i})(i.Listenable);t.ResponsiveUI=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a)});
define("odsp-next/experiments/splightspeed/dataSources/base/Listenable",["require","exports","@ms/items-view/lib/private/utilities/Graft"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._listeners=[]}e.prototype.readData=function(){return this._data};e.prototype.listen=function(e){var t=this;this._listeners.indexOf(e)<0&&this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);n>=0&&t._listeners.splice(n,1)}};e.prototype.setData=function(e){this._data=this._data||{};var t=n.graft(this._data,e);this._data=t;for(var r=0,i=this._listeners;r<i.length;r++){(0,i[r])(this._data)}};e.prototype.refresh=function(){};return e})();t.Listenable=r});
define("odsp-next/experiments/splightspeed/context/ContextKeys",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.legacyMode="legacyMode";t.viewParams="viewParams";t.responsiveUIMetrics="responsiveUIMetrics";t.itemsScopeCurrentItemKey="itemsScopeCurrentItemKey";t.resources="resources";t.paneControls="paneControls";t.pageControls="pageControls";t.hotMainComponent="hotMainComponent"});
define("odsp-next/experiments/splightspeed/context/SPOAppContextItems",["require","exports","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/graft/Graft","../../../resources/ControlResourceKeys","../../../resources/ControlResourceKeys","../models/itemsScope/ItemsScopeHelper","../resources/itemsScope/ItemsScopeKeys","../utilities/browser/ResponsiveUI","./ContextKeys","../../../utilities/list/FullscreenListHelper","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.READONLY=0]="READONLY";e[e.REPLACE=1]="REPLACE";e[e.PATCH=2]="PATCH"})(h=t.ContextItemUpdateMethod||(t.ContextItemUpdateMethod={}));t.createSPOAppContextData=function(e){var t=e.consume(o.resourceKey),p=e.consume(n.navigation),d={name:f.legacyMode,updateMethod:h.REPLACE,data:!1},v={name:f.viewParams,data:p.viewParams,updateMethod:h.REPLACE,onChange:function(n,o){e.consume(i.originalViewParams)&&r.default(e.consume(i.originalViewParams),o);var u=e.consume(s.viewParams.optional);u&&u(o);t.updateViewParams(o)}};!c.default.isActivated("755D4075-3A26-4A5E-82ED-51702CAA4E54","05/05/20","initialize currentViewParamsFacet when create createSPOAppContextData")&&v.data&&t.updateViewParams(v.data);var m=e.consume(a.resourceKey),g={name:f.responsiveUIMetrics,updateMethod:h.PATCH,data:m.metrics},y={name:f.resources,updateMethod:h.READONLY,data:e},b={name:f.itemsScopeCurrentItemKey,data:e.consume(u.resourceKey).currentItemKey,updateMethod:h.REPLACE,onChange:function(n,r){if(r!==n){e.consume(u.resourceKey).currentItemKey=r;t.openItem(r)}}},w={name:f.paneControls,updateMethod:h.PATCH,data:{isLeftNavExpanded:!1,isRightPaneExpanded:!1,isInfoPaneExpanded:!1,isFiltersPaneExpanded:!1,isColumnCustomizationPaneExpanded:!1,isO365FlexPaneVisible:!1,isTipsNTricksPaneVisible:!1}},E=e.consume(l.resourceKey.optional),S=!c.default.isActivated("E6C29515-A1B5-472F-9759-B19A2BE8C623","02/11/20","Get fullscreen list setting from local storage")&&E&&E.getFullscreenFromStorage();return{legacyMode:d,viewParams:v,responsiveUIMetrics:g,resources:y,itemsScopeCurrentItemKey:b,paneControls:w,pageControls:{name:f.pageControls,updateMethod:h.PATCH,data:{canUserSelect:!0,isSuiteNavHamburgerVisible:m.metrics.isHamburgerVisible,isFullscreen:!!S}},hotMainComponent:{name:f.hotMainComponent,updateMethod:h.REPLACE,data:void 0}}}});
define("odsp-next/experiments/splightspeed/models/itemsScope/ItemsScopeHelper",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../itemCache/ItemCacheStore","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/operations/blockItemPage","../../../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/items-view/lib/private/utilities/Graft","@ms/items-view/lib/private/models/Facet","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/async/Async","../../resources/itemsScope/ItemsScopeKeys","../../../../models/itemsScope/ItemsScopeAddonHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=new h.default,m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.openActionControlHandler=function(e,t){throw new Error("Not Implemented")};r._itemsScopeItemKey=n.itemsScopeKeys.itemKey;r._itemCacheStore=n.itemCacheStore;r._itemCacheStore.dispatch(u.blockItemPage());return r}t.prototype.unblockItemPageRender=function(){var e=this;this._itemCacheStore.dispatch(s.readItems(function(e){return u.itemPageIsBlocked(e)}))&&v.setTimeout(function(){return e._itemCacheStore.dispatch(u.unblockItemPage())},0)};t.prototype.updateViewParams=function(e){var t;(0,this._itemCacheStore.dispatch)(o.resolveItems({items:(t={},t[this._itemsScopeItemKey]=l.pack({viewParams:a.currentViewParamsFacet},{viewParams:new f.MirrorPatch(e)}),t)}))};t.prototype.openItem=function(e){var t=this._itemCacheStore.dispatch,n=this._nextOpenItem;if(n){this._nextOpenItem=void 0;t(n)}else t(d.openItemWithAddon({itemsScopeItemKey:this._itemsScopeItemKey,currentItemKey:e}))};t.dependencies=n.__assign(n.__assign({},c.default.dependencies),{itemsScopeKeys:p.resourceKey,itemCacheStore:i.resourceKey});return t})(c.default);t.ItemsScopeHelper=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});
define("odsp-next/experiments/splightspeed/models/itemCache/ItemCacheStore",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/store/createStore","@ms/odsp-utilities/lib/resources/Resources","../../../../models/itemsScope/controls/ItemKeyToStoreKeyControl","../../../../models/itemsScope/controls/ViewParamsToItemKeyControl","../../../../models/itemsScope/facets/OdspNextAppFacets","../../../../models/itemsScope/ItemsScopeAddon.key","../../../../models/itemsScope/ItemsScopeKeyConverter.key","../../../../resources/SPOResourceKeys","../../../../models/itemCache/ItemCacheConfiguration.key","../../../../models/itemCache/ItemCacheConfiguration","../../../../models/itemsScope/KnockoutStoreItemControlHandler","../../../../models/itemsScope/controls/KnockoutStoreItemControl","@ms/items-view/lib/private/operations/batch/asBatch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=new i.ResourceKey({name:e("module").id+".oneItemCacheInstance",factory:{dependencies:{},create:function(e){var t={created:!1};return{instance:t,disposible:t}}}}),g={resources:i.resourceScopeKey,itemsScopeKeyConverter:f.resourceKey,itemCacheConfiguration:c.resourceKey,webConfiguration:h.webConfigurationResourceKey,oneItemCacheInstance:m,pageContext:l.pageContext,itemsScopeAddon:a.resourceKey,knockoutStoreItemControlHandler:p.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:g,create:function(e){var t=e.itemsScopeKeyConverter,i=e.itemCacheConfiguration,a=e.webConfiguration,f=e.oneItemCacheInstance,l=e.itemsScopeAddon,c=e.knockoutStoreItemControlHandler;if(f.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");f.created=!0;var h=r.createItemCacheStore({configuration:a});h.dispatch(v.asBatch(function(){h.dispatch(i);h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,s.itemKeyToStoreKeyControl)(n.createControlHandler()(function(){return function(){return t.itemKeyToStoreKeyControlHandler}})));h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,o.viewParamsToItemKeyControl)(n.createControlHandler()(function(){return function(){return t.viewParamsToItemKeyControlHandler}})));h.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,d.knockoutStoreItemControl)(n.createControlHandler()(function(){return c})))}));h.dispatch(l);return{instance:h,disposable:h}}}})});
define("odsp-next/experiments/splightspeed/resources/itemsScope/ItemsScopeKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view/lib/private/components/itemsScope/ItemsScope","../../models/itemCache/ItemCacheStore","@ms/items-view/lib/private/operations/readItems","../../../../dataSources/url/odb/ItemUrlHelper","../../../../resources/SPOResourceKeys","../../../../models/itemsScope/ItemsScopeKeyConverter.key","../../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemUrlHelper:a.resourceKey,pageContext:f.pageContext,itemsScopeKeyConverter:l.resourceKey,viewParams:c.originalViewParams,itemCacheStore:o.resourceKey},create:function(e){var t=e.itemUrlHelper,n=e.pageContext,o=e.itemsScopeKeyConverter,a=e.viewParams,f=e.itemCacheStore,l=t.getUrlParts(),c=f.dispatch(u.readItems(function(e){var t=o.viewParamsToItemKeyControlHandler(e,{viewParams:a,isNavigation:!0}).itemKey,s=e.demandItemFacet(r.spFolderItemSetKeyFacet,t)||{webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:l.fullListUrl||"",rootFolder:""};return{currentItemKey:t||"",pageContextKey:i.spPageContextKeyFacet.serialize(s)}})),h=c.currentItemKey,p=c.pageContextKey,d={itemKey:s.getNextItemsScopeItemKey(),currentItemKey:h,pageContextKey:p};return{instance:d,disposable:d}}}});t.itemsScopeItemKeyResourceKey=new n.ResourceKey({name:e("module").id+".itemsScopeItemKey",factory:{dependencies:{itemsScopeKeys:t.resourceKey},create:function(e){return{instance:e.itemsScopeKeys.itemKey}}}})});
define("odsp-next/utilities/list/FullscreenListHelper",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/SPOResourceKeys"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.setFullscreenToStorage=function(e,t){if(window&&window.localStorage)try{var n=localStorage&&localStorage.getItem("sp-fullscreen-list");if(n){var r=JSON.parse(n);e?r[t]=!0:delete r[t];localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))}else this._setInitialFullscreenToStorage(e,t)}catch(n){this._setInitialFullscreenToStorage(e,t)}};e.prototype.getFullscreenFromStorage=function(){var e=this._pageContext&&this._pageContext.listUrl,t=localStorage&&localStorage.getItem("sp-fullscreen-list"),n=!1;if(t&&e)try{n=!!JSON.parse(t)[e]}catch(e){}return n};e.prototype._setInitialFullscreenToStorage=function(e,t){var n,r=((n={})[t]=e,n);localStorage.setItem("sp-fullscreen-list",JSON.stringify(r))};e.dependencies={pageContext:r.pageContext};return e})();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i)});
define("odsp-next/experiments/splightspeed/context/SPOAppContextHandler",["require","exports","tslib","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/resources/Resources","./ContextKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=s;var o=(function(){function e(){this._events=new r.default(this);this._events.declare("contextUpdated")}e.prototype.registerContextChangeHandler=function(e){this._handleContextDataChange=e};e.prototype.update=function(e){this._handleContextDataChange&&this._handleContextDataChange(e)};e.prototype.onUpdated=function(e){this._events.on(this,"contextUpdated",e)};e.prototype.offUpdated=function(e){this._events.off(this,"contextUpdated",e)};e.prototype.notifyUpdate=function(e){this._contextData=e;this._events.raise("contextUpdated",e)};e.prototype.getContext=function(){return n.__assign({},this._contextData)};e.prototype.dispose=function(){this._events.dispose()};return e})();t.SPOAppContextHandler=o;t.resourceKey=new i.ResourceKey({name:e("module").id+"s",factory:new i.SimpleResourceFactory(o)})});
define("odsp-next/controls/commands/itemsScope/AddToOneDriveCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","office-ui-fabric-react/lib/Icon","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/AddToOneDriveAction","../Commands.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveCommand={key:new r.Facet("AddToOneDrive").id,name:u.default.CreateMountPoint,action:n.createElement(s.ShowOnlyWithSelection,null,n.createElement(o.AddToOneDriveAction,null)),iconProps:{iconType:i.IconType.Image,imageProps:{src:window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg"),width:"16px",height:"16px"}}}});
define("odsp-next/actions/itemsScope/AddToOneDriveAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/base/react/WithResources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AddToOneDriveAction"],t,n)})];case 1:return[2,t.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(s.folderFacet,n)}),f=i.withSelectedItems()(i.withExactlyOneItem()(a));t.AddToOneDriveAction=function(){var e=u.useResourceScope();return r.createElement(f,{resources:e})}});
define("odsp-next/controls/commands/itemsScope/QuickEditCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/QuickEditAction","../Commands.resx","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.quickEditCommand={key:new r.Facet("QuickEdit").id,name:s.default.EditAll,action:n.createElement(o.HideWithSelection,null,n.createElement(i.LaunchQuickEditAtion,null)),iconProps:{iconName:"Edit"}}});
define("odsp-next/actions/itemsScope/QuickEditAction",["require","exports","tslib","react","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/models/itemsScope/getItemsScope","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/utilities-browser/lib/PlatformDetection","@ms/items-view/lib/private/facets/SetFacets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../resources/SPOResourceKeys","../../utilities/features/Features","../../models/schema/spo/SchemaHelper","../../controls/base/react/WithResources","../../models/itemSet/ItemSetQueryType","../../dataSources/url/QueryType","../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/odsp-datasources/lib/utilities/caml/CamlUtilities"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=new l.PlatformDetection;var S=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/QuickEditAction"],t,n)})];case 1:return[2,t.sent().LaunchQuickEditAction]}})})},function(e,t){if(d.isFeatureEnabled(d.showQuickEditFeature)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites))return!1;if(E.isMobile)return!1;var n=t.itemKey;if(n){var r=e.demandItemFacet(f.spFolderItemSetKeyFacet,n);if(r){var i=f.spListKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),o=e.demandItemFacet(u.listFacet,i);if((function(e,t,n){if(n&&n.isDocumentLibrary){var r=e.demandItemFacet(c.schemaFacet,t),i=[];if(r&&r.columnKeys)for(var s=0,o=r.columnKeys;s<o.length;s++){var a=o[s],f=e.demandItemFacet(u.internalNameFacet,a);f&&i.push({internalName:f})}return v.isOutOfTheBoxList(i,!0)}return!1})(e,n,o))return!1;var l=f.spPageContextKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),m=e.demandItemFacet(u.spPageContextFacet,l);if(m&&m.isAnonymousGuestUser)return!1;if(o&&o.templateType===h.default.mySiteDocumentLibrary)return!1;var S=void 0;if(!t.resources)return!1;if(!(S=t.resources.isExposed(p.inplaceEditorUrl)?t.resources.consume(p.inplaceEditorUrl):null))return!1;var x=e.demandItemFacet(f.spFolderItemSetKeyFacet,n),T=void 0,N=void 0;if(x&&x.viewKey){var C=f.spViewKeyFacet.serialize(x.viewKey);if((N=e.demandItemFacet(u.currentDerivedViewFacet,C))&&N.baseViewXml){T=(new DOMParser).parseFromString(N.baseViewXml,"text/xml").getElementsByTagName("ViewStyle")}}var k=s.getItemsScope(e).itemsScopeItemKey,L=e.demandItemFacet(b.currentViewParamsFacet,k),A=e.demandItemFacet(u.permissionsFacet,f.spItemKeyFacet.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl})),O=a.default.hasItemPermission({permissions:A},a.default.editListItems),M=g.getQueryType(e,n),_=e.demandItemFacet(c.childItemsFacet,n),D=!1;if(_&&_.itemKeys)for(var P=0,H=_.itemKeys;P<H.length;P++){var B=H[P];f.spItemGroupKeyFacet.matches(B)&&(D=!0)}return M===y.default.Files&&!D&&!!o&&!!o.allowGridMode&&!!N&&!!N.id&&!!T&&0===T.length&&!(L&&L.needsAttentionView)&&O&&(!S||!S())&&!(function(e,t){if(e&&e.listBaseTemplate&&h.isPromotedLinksList(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=w.xmlToDom(t.baseViewXml);if("1"===w.getAttr(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1})(m,N)}}return!1}),x=o.withCurrentItemSet()(S);t.LaunchQuickEditAtion=function(){var e=m.useResourceScope();return r.createElement(x,{resources:e})}});
define("odsp-next/models/schema/spo/SchemaHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["DocIcon","LinkFilename","_shareHeroCommand","_calloutInvoker","Modified","Editor"];t.isOutOfTheBoxList=function(e,t){if(e.length===n.length){for(var r=0;r<n.length;r++){var i=n[r];if(!(t&&"_shareHeroCommand"===i||"_calloutInvoker"===i)&&e[r].internalName!==i)return!1}return!0}return!1}});
define("odsp-next/models/itemSet/ItemSetQueryType",["require","exports","@ms/items-view-addon-graph/lib/models/keys/RecentRootItemKeyFacet","@ms/items-view-addon-sp/lib/dataSource/Keys","../../dataSources/url/QueryType","@ms/odsp-graph/lib/utilities/media/MediaUtils","@ms/odsp-graph/lib/models/item/IItemTypeFilter","@uifabric/file-type-icons/lib/FileTypeIconMap"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQueryType=function(e,t){var a=e.demandItemFacet(r.spWebKeyFacet,t),f=e.demandItemFacet(r.spLibrariesItemSetKeyFacet,t),l=e.demandItemFacet(n.recentRootItemKeyFacet,t),c=e.demandItemFacet(r.spItemKeyFacet,t),h=e.demandItemFacet(r.spFolderItemSetKeyFacet,t);if(a)return i.default.Files;if(f)return i.default.DocumentLibraries;if(l)return i.default.Recent;if(c)return i.default.Files;if(h){if(h.extFilters){return s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(h.extFilters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap})?i.default.Photos:i.default.Files}return i.default.Files}return i.default.Files}});
define("odsp-next/controls/commands/itemsScope/CancelEditCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/CancelEditAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelEditCommand={key:new r.Facet("CancelEdit").id,name:s.default.cancelEdit,action:n.createElement(i.LaunchCancelEditAtion,null),iconProps:{iconName:"CheckMark"}}});
define("odsp-next/actions/itemsScope/CancelEditAction",["require","exports","tslib","react","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../resources/SPOResourceKeys","../../controls/base/react/WithResources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/CancelEditAction"],t,n)})];case 1:return[2,t.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var r=n.consume(s.inplaceEditorUrl.optional);return!(!r||!r())}return!1});t.LaunchCancelEditAtion=function(){var e=o.useResourceScope();return r.createElement(u,{resources:e})}});
define("odsp-next/controls/commands/itemsScope/PreviewCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/PreviewAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewCommand={key:new r.Facet("Preview").id,name:s.default.Preview,automationId:"Preview",action:n.createElement(i.PreviewAction,null)}});
define("odsp-next/controls/commands/itemsScope/WorkflowCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/MoreAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.workflowCommand={key:new r.Facet("Workflow").id,name:s.default.Workflow,action:n.createElement(i.WorkflowAction,null),automationId:"workflow"}});
define("odsp-next/controls/commands/itemsScope/ComplianceDetailsCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/MoreAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.complianceDetailsCommand={key:new r.Facet("ComplianceDetails").id,name:s.default.ComplianceDetails,action:n.createElement(i.ComplianceDetailsAction,null),automationId:"complianceDetails"}});
define("odsp-next/controls/commands/itemsScope/PublishCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/MoreAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishCommand={key:new r.Facet("Publish").id,name:s.default.Publish,action:n.createElement(i.PublishAction,null)}});
define("odsp-next/controls/commands/itemsScope/UnPublishCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/MoreAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.unPublishCommand={key:new r.Facet("UnPublish").id,name:s.default.UnPublish,action:n.createElement(i.UnPublishAction,null)}});
define("odsp-next/controls/commands/itemsScope/CancelPublishCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/MoreAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelPublishCommand={key:new r.Facet("CancelApproval").id,name:s.default.CancelApproval,action:n.createElement(i.CancelApprovalAction,null)}});
define("odsp-next/controls/commands/itemsScope/CreateShortcutCommand",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/CreateShortcutAction","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createShortcutCommand={key:new i.Facet("Link").id,name:u.default.CreateShortcut,action:r.createElement(o.HideWithSelection,null,r.createElement(s.CreateShortcutAction,null)),iconProps:{iconName:"Globe"}};t.createPersistentShortcutCommand=n.__assign(n.__assign({},t.createShortcutCommand),{action:r.createElement(s.CreatePersistentShortcutAction,null)})});
define("odsp-next/actions/itemsScope/CreateShortcutAction",["require","exports","tslib","react","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/itemsScope/getItemsScope","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","../../utilities/features/Features","../../models/itemSet/ItemSetQueryType","../../dataSources/url/QueryType","../../controls/base/react/WithResources","../../providers/item/ShortcutProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=i.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/CreateShortcutAction"],t,n)})];case 1:return[2,t.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!r||!n)return!1;var i=e.demandItemFacet(f.spItemKeyFacet,n);if(i){if(r.consume(d.resourceKey.optional)){var p=f.spPageContextKeyFacet.serialize({listFullUrl:i.listFullUrl,webAbsoluteUrl:i.webAbsoluteUrl}),v=e.demandItemFacet(a.permissionsFacet,n),m=u.default.hasItemPermission({permissions:v},u.default.insertListItems),g=e.demandItemFacet(a.spPageContextFacet,p),y=o.getItemsScope(e).itemsScopeItemKey,b=s.getCurrentItemSetKey(e,y);if(b){var w=c.getQueryType(e,b);return!!g&&!g.isAnonymousGuestUser&&!g.isEmailAuthenticationGuestUser&&l.isFeatureEnabled(l.ShortcutLink)&&l.isFeatureEnabled(l.SpListNext)&&m&&w===h.default.Files}}}return!1}),m=s.withOnlyCurrentItem()(v),g=s.withCurrentItem()(v);t.CreateShortcutAction=function(){var e=p.useResourceScope();return r.createElement(m,{resources:e})};t.CreatePersistentShortcutAction=function(){var e=p.useResourceScope();return r.createElement(g,{resources:e})}});
define("odsp-next/controls/commands/itemsScope/OpenInPowerBICommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/OpenInPowerBIAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInPowerBICommand={key:new r.Facet("OpenInPowerBI").id,name:s.default.OpenInPowerBI,action:n.createElement(i.OpenInPowerBIAction,null),iconProps:{iconName:"PowerBILogo16"}}});
define("odsp-next/actions/itemsScope/OpenInPowerBIAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet","@ms/items-view/lib/private/models/itemsScope/getItemsScope","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view-addon-sp/lib/dataSource/Facets","../../utilities/features/Features","../../models/itemSet/ItemSetQueryType","../../models/item/ItemHelper","../../dataSources/url/odb/UrlRouting"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=o.withSelectedItems()(o.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/OpenInPowerBIAction"],t,n)})];case 1:return[2,t.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var r=e.demandItem({fileName:s.fileNameFacet,itemStatus:u.itemComplianceStatusFacet,openUrl:s.openUrlFacet,permissions:l.permissionsFacet},n),v=r.fileName,m=r.itemStatus,g=r.openUrl,y=r.permissions,b=f.default.hasItemPermission({permissions:y},f.default.openItems),w=a.getItemsScope(e).itemsScopeItemKey,E=o.getCurrentItemSetKey(e,w);if(E){var S=h.getQueryType(e,E);return c.isFeatureEnabled(c.EnablePowerBIIngegration)&&!!v&&!!v.extension&&!!g&&(p.GetDocumentTypeFromExtension(v.extension)===i.DocumentType.Excel||".csv"===v.extension.toLowerCase())&&4!==m&&3!==m&&b&&!d.isRecycleBin(S)}}return!1})))});
define("odsp-next/dataSources/url/odb/UrlRouting",["require","exports","tslib","@ms/odsp-utilities/lib/navigation/AddressParser","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/sp-resource-path","../PageType","../QueryType","../../../utilities/killSwitch/KillSwitch","../../../utilities/features/PLTFeatures","./GetQueryType"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getKeyParams=r.deserializeQuery;t.getQueryType=c.getQueryType;t.getItemQueryParams=function(e){var t=e.defaultRootItemId,n=e.viewParams,i=e.listUrl,o=e.viewId,u=e.key,l=r.deserializeQuery(u);delete l.u;var h=s.extend({},n);delete h.id;delete h.RootFolder;delete h.view;delete h.q;delete h.listurl;delete h.typeFilters;s.extend(h,l);delete h.parent;delete h.parentview;delete h.p;delete h.sharedLibraryCreated;if(l.id===t){delete h.id;delete h.RootFolder}h.listurl===n.listurl&&c.getQueryType(l)===a.default.Files&&(o||"").replace("{","").replace("}","")!==h.viewid||delete h.viewid;if(!f.default.isActivated("B18F1E9C-10C2-4D06-A126-19459E1894C9","06/25/2019","remove uncessary view params to improve prefetch")&&h.newTargetListUrl===i){delete h.newTargetListUrl;delete h.viewpath}return h};t.getCurrentItemKey=function(e){var t,r=e.viewParams,i=e.itemKeyParams,s=n.__assign(n.__assign(n.__assign({},i),r),!r.id&&r.RootFolder?((t={}).id=r.RootFolder,t):{}),o=s.parent,u=s.parentview;if(o||u){delete s.id;o&&(s.id=o);if(u){s.view=u;delete s.listurl}delete s.parent;delete s.parentview}return h(n.__assign(n.__assign({},e),{itemKeyParams:s}))};function h(e){var t=e.defaultRootItemId,n=e.groupId,r=e.listUrl,i=e.itemKeyParams,s=e.getViewParams,o=s?s():e.viewParams;(i.listurl===r||f.default.isActivated("9FA9EFD3-16F5-4D1D-AAC3-8DB2472C33D7","6/19/2020","Only assign list URL for OneDrive if not present")&&!r&&n&&!o.newTargetListUrl)&&delete i.listurl;i.newTargetListUrl&&delete i.newTargetListUrl;return p(i,t)}t.getKey=h;function p(e,t){var n,r=Number(e.view)||a.default.Files,s=((n={}).id=e.id||t||"",n.listurl=e.listurl||"",n.view=""+(r||""),n.q=e.q||"",n.typeFilters=e.typeFilters||"",n.userFilters=e.userFilters||"",n.dateFilter=e.dateFilter||"",n.u=e.u||"",n);return i.serializeQuery(s,void 0,!0)}t.getKeyFromQueryParams=p;function d(e){var t,n=e.parent,r=e.parentview;if(n||r){(t={}).id=e.id;t.listurl=e.listurl;r&&(t.view=e.view)}return t?i.serializeQuery(t,void 0,!0):""}t.getFocusItemKey=d;t.getPageType=function(e,t){var n=Number(e.p);switch(n){case u.default.FilePicker:case u.default.TextFileEditor:case u.default.Error:case u.default.Share:case u.default.Embed:case u.default.Restore:case u.default.Settings:case u.default.MobileAppUpsell:case u.default.FileRequest:return n}return d(e)&&t?u.default.OneUp:u.default.Files};t.getRemoteItemFromViewParam=function(e){var t=JSON.parse(e);return{mountPoint:t.mp,remoteSpFolderById:t.rsf,remoteSpItem:t.rsi}};t.saveRemoteItemToViewParam=function(e){var t={mp:e.mountPoint,rsf:e.remoteSpFolderById,rsi:e.remoteSpItem};return JSON.stringify(t)};t.getRootItemKey=function(e,t){var r;return h(n.__assign({itemKeyParams:(r={},r.view=e,r)},t))};t.isRecycleBin=function(e){return e===a.default.RecycleBin||e===a.default.SecondStageRecycleBin};t.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host};t.getSearchQueryUrl=function(e){var t,n,r,s,o=e.query,u=e.baseItemViewParams,f=a.default.Search.toString(),c="",h="";if((l.isFeatureEnabled(l.CSIOdbScopedSearch)||l.isFeatureEnabled(l.CSIOdbNotMyFiles3S))&&(f=(null===(n=u)||void 0===n?void 0:n.view)||a.default.Search.toString())===a.default.SearchOdbScope.toString()){c=(null===(r=u)||void 0===r?void 0:r.id)||"";h=(null===(s=u)||void 0===s?void 0:s.listurl)||""}return"#"+i.serializeQuery(((t={}).view=f,t.q=o,t.id=c,t.listurl=h,t),void 0,!0)};t.getQueryParamValue=function(e){return e.q};t.getFiltersFromViewParams=function(e){var t=e.typeFilters&&e.typeFilters.split(","),n=e.dateFilter&&e.dateFilter.split(","),r=e.userFilters&&e.userFilters.split(";#"),i=[];t&&i.push({type:"fileName",values:t});n&&i.push({type:"dateShared",values:n});r&&i.push({type:"sharedByName",values:r});return i};t.getSortFromViewParams=function(e){return{sortField:e.sortField||"",isAscending:!("true"!==e.isAscending)}};t.getGroupFromViewParams=function(e){return{groupField:e.groupBy||""}};t.getExpandRowLimitFromViewParams=function(e){var t=e.rowLimit;return t?Number(t):0};t.isCurrentItemOnRemoteSite=function(e){var t=e.listurl;return!!t&&!!new o.SPResourcePath(t).authority}});
define("odsp-next/dataSources/url/odb/GetQueryType",["require","exports","../QueryType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQueryType=function(e,t){void 0===t&&(t=!1);var r=e.view;!r&&t&&(r=e.parentview);return r?Number(r):n.default.Files}});
define("odsp-next/controls/commands/itemsScope/OpenInTextEditorCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/OpenInTextEditorAction","../Commands.resx","../../knockoutContentShim/WithKnockoutResourceScope"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommand={key:new r.Facet("OpenInTextEditor").id,name:s.default.OpenInTextEditor,action:n.createElement(o.WithKnockoutResourceScope,null,n.createElement(i.OpenInTextEditorAction,null)),iconProps:{iconName:"Edit"}}});
define("odsp-next/actions/itemsScope/OpenInTextEditorAction",["require","exports","react","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/models/itemsScope/getSelectedItemKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.OpenInTextEditorAction))});t.OpenInTextEditorAction=s.createItemCacheComponent(function(e){return 0===o.getSelectedItemKeys(e).length?null:n.createElement(u,null)})});
define("odsp-next/controls/commands/itemsScope/OpenInExplorerCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/OpenInExplorerAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={iconName:void 0,styles:{root:{display:"none!important"}}};t.openInExplorerCommand={key:new r.Facet("OpenInExplorer").id,name:s.default.OpenInExplorer,action:n.createElement(i.OpenInExplorerAction,null),iconProps:o}});
define("odsp-next/actions/itemsScope/OpenInExplorerAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/odsp-utilities/lib/browser/PlatformDetection"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=new f.default;t.OpenInExplorerAction=i.withCurrentItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/OpenInExplorerAction"],t,n)})];case 1:return[2,t.sent().OpenInExplorerAction]}})})},function(e,t){var n=t.itemKey,r=e.demandItemFacet(o.spItemKeyFacet,n);if(!r)return!1;var i=o.spListKeyFacet.serialize(r),f=e.demandItemFacet(s.listFacet,i);if(!f)return!1;if(!f.isDocumentLibrary)return!1;if(f.templateType===a.default.webPageLibrary)return!1;var c=u.getPageContextFromItemCache(e,n);return!!c&&(!c.viewOnlyExperienceEnabled&&!c.blockDownloadsExperienceEnabled&&l.isIE)}))});
define("odsp-next/controls/commands/itemsScope/OpenInSharePointCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/OpenInSharePointAction","../PLTCommands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInSharePointCommand={key:new r.Facet("OpenInSharePoint").id,name:o.default.OpenInSharePoint,action:n.createElement(i.HideWithSelection,null,n.createElement(s.OpenInSharePointAction,null)),iconProps:{iconName:"SharepointLogo"}}});
define("odsp-next/actions/itemsScope/OpenInSharePointAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../utilities/browser/WebViewDetector","../../utilities/iframe/IframeHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/OpenInSharePointAction"],t,n)})];case 1:return[2,t.sent().OpenInSharePointAction]}})})},function(e,t){var n=i.isTeamsWebView(),r=s.isCrossOrigin();return n||r})});
define("odsp-next/controls/commands/itemsScope/TeamChannelCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/TeamChannelAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.teamChannelCommand={key:new r.Facet("TeamChannel").id,name:s.default.Channel,action:n.createElement(i.TeamChannelAction,null),iconProps:{iconName:"TeamsLogo"}}});
define("odsp-next/actions/itemsScope/TeamChannelAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/itemsScope/getItemsScope","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","../../controls/banner/teamChannelBanner/TeamChannelBannerHelper","../../utilities/browser/WebViewDetector","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/TeamChannelAction"],t,n)})];case 1:return[2,t.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,r=s.getItemsScope(e).itemsScopeItemKey,c=i.getCurrentItemSetKey(e,r),h=e.demandItemFacet(u.spFolderItemSetKeyFacet,c),p=e.demandItemFacet(u.spItemKeyFacet,n);if(!h)return!1;if(!l.default.isActivated("1739891D-4D4D-458D-8561-2506E1685479","06/22/2020","special logic for teams file app")&&f.isTeamsWebView())return!1;var d=u.spItemKeyFacet.serialize({itemId:p?p.itemId:"",listFullUrl:h.listFullUrl,rootFolder:h.rootFolder,webAbsoluteUrl:h.webAbsoluteUrl}),v=e.demandItemFacet(o.progIdFacet,d)||"";return a.isTeamChannelBannerEnabled()&&a.isProgIdTeamChannelFolder(v)})))});
define("odsp-next/controls/banner/teamChannelBanner/TeamChannelBannerHelper",["require","exports","../../../utilities/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isTeamChannelFolder=function(e){var t=!!e&&!!e.folder,n=e&&e.properties.ProgId;return r()&&t&&i(n)};function r(){return n.isFeatureEnabled(n.TeamChannelFolder)}t.isTeamChannelBannerEnabled=r;function i(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}t.isProgIdTeamChannelFolder=i});
define("odsp-next/controls/commands/itemsScope/UploadFileCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/UploadAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand={key:new r.Facet("UploadFile").id,name:o.default.UploadFile,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFileAction,null))}});
define("odsp-next/actions/itemsScope/UploadAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/handlers/controls/uploadItemsActionControl","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/utilities-browser/lib/PlatformDetection"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.PlatformDetection;t.UploadFileAction=i.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/UploadAction"],t,n)})];case 1:return[2,t.sent().UploadFileAction]}})})},function(e,t){return u.isHtml5FileUploadSupported&&r.getIsUploadItemsActionAvailable(e,t)}));t.UploadFolderAction=i.withOnlyCurrentItem()(s.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/UploadAction"],t,n)})];case 1:return[2,t.sent().UploadFolderAction]}})})},function(e,t){return u.isFolderUploadSupported&&r.getIsUploadItemsActionAvailable(e,t)}))});
define("@ms/items-view-addon-sp/lib/handlers/controls/uploadItemsActionControl",["require","exports","./spItemUploadItemsActionControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIsUploadItemsActionAvailable=n.getIsUploadItemsActionAvailable});
define("@ms/items-view-addon-sp/lib/handlers/controls/spItemUploadItemsActionControlHandler",["require","exports","tslib","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","../../dataSource/Keys","../../dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","../../operations/projectUploadedItemsForItemSet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsActionControlHandler=u.createControlHandler()(function(){var t=this;return function(r){return function(i,s){var o=p(i,s),u=c.getCurrentItemSetKey(i);return{isAvailable:o,onItemUploaded:function(e){return function(){var t=e.progressItemKey,n=r(a.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,t)})),i=n&&n.itemKey;i&&r(h.projectUploadedItemForItemSet({itemSetKey:u,itemKey:i}))}},onUploadStarted:function(i){return function(){n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["./spFolderItemSet/spProjectedUploadedItemSetControlHandler"],t,n)})];case 1:t=n.sent().spProjectedUploadedItemSetAddon;r(t);return[2]}})});r(h.createUploadProjectionForItemSet({itemSetKey:u}))}},onUploadCompleted:function(){return function(){r(h.completeUploadProjectionForItemSet({itemSetKey:u}))}}}}}});function p(e,t){var n=t.itemKey;if(!n)return!1;var u=void 0,a=void 0,l=e.demandItemFacet(i.spItemGroupKeyFacet,n),c=e.demandItemFacet(i.spItemKeyFacet,n);if(l){if(l.itemSetKey){var h=l.itemSetKey;u=i.spListKeyFacet.serialize(h);var p=e.demandItemFacet(f.parentItemFacet,i.spFolderItemSetKeyFacet.serialize(h));p&&p.itemKey&&(a=e.demandItemFacet(s.permissionsFacet,p.itemKey))}}else if(c){u=i.spListKeyFacet.serialize(c);a=e.demandItemFacet(s.permissionsFacet,n)}var d=r.PermissionMask.insertListItems,v=r.PermissionMask.hasItemPermission({permissions:a},d);if(v){var m=u&&e.demandItemFacet(s.listFacet,u);v=!!m&&!!m.isDocumentLibrary&&m.templateType!==o.ListTemplateType.webPageLibrary}return v}t.getIsUploadItemsActionAvailable=p});
define("@ms/items-view-addon-sp/lib/operations/projectUploadedItemsForItemSet",["require","exports","tslib","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/models/configuration/getConfiguration","../dataSource/Facets","../dataSource/Keys","@ms/items-view/lib/private/operations/resolveItems","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/utilities/Graft"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createUploadProjectionForItemSet=function(e){var t=e.itemSetKey;return function(e){var f;if(e(r.readItems(function(e){var t=i.getConfiguration(e,{isProjectedUploadedItemSetFeatureEnabled:s.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetFeatureEnabled;return void 0!==t&&t}))){var l=e(r.readItems(function(e){return e.demandItemFacet(o.spFolderItemSetKeyFacet,t)}));if(l){var c=o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:l});e(u.resolveItems({items:(f={},f[c]=n.__assign({},a.childItemsFacet.pack({itemKeys:[]})),f)}))}}}};t.projectUploadedItemForItemSet=function(e){var t=this,h=e.itemKey,p=e.itemSetKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g;return n.__generator(this,function(n){if(e(r.readItems(function(e){var t=i.getConfiguration(e,{isProjectedUploadedItemSetFeatureEnabled:s.enableProjectedUploadedItemSetConfigurationFacet}).isProjectedUploadedItemSetFeatureEnabled;return void 0!==t&&t}))){t=e(r.readItems(function(e){return e.demandItemFacet(o.spFolderItemSetKeyFacet,p)}));if(h){d=e(r.readItems(function(e){var t=e.demandItemFacet(f.parentFolderItemFacet,h);if(t&&t.itemKey){var n=e.demandItemFacet(o.spItemKeyFacet,t.itemKey);return n&&n.rootFolder}}));if(t&&d===t.rootFolder){v=[];m=o.spProjectedUploadedItemSetKeyFacet.serialize({itemSetKey:t});v.push(h);e(u.resolveItems({items:(g={},g[m]=l.pack({childItems:a.childItemsFacet},{childItems:{itemKeys:new c.ArrayConcatIfNotMatchKeyPatch(v,function(e){return e})}}),g)}))}}}return[2]})})}};t.completeUploadProjectionForItemSet=function(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}}});
define("odsp-next/controls/commands/itemsScope/UploadFolderCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/UploadAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand={key:new r.Facet("UploadFolder").id,name:o.default.UploadFolder,action:n.createElement(i.HideWithSelection,null,n.createElement(s.UploadFolderAction,null))}});
define("odsp-next/controls/commands/itemsScope/FileRequestCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/FileRequestAction","../Commands.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileRequestCommand={key:new r.Facet("FileRequest").id,name:s.default.CreateFileRequest,action:n.createElement(i.FileRequestAction,null),iconProps:{iconName:"FileRequest"}}});
define("odsp-next/actions/itemsScope/FileRequestAction",["require","exports","tslib","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../utilities/killSwitch/KillSwitch","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view/lib/private/facets/ItemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileRequestAction=i.withSelectedItems()(i.withExactlyOneItem()(r.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/CreateFileRequestAction"],t,n)})];case 1:return[2,t.sent().CreateFileRequestAction]}})})},function(e,t){var n=t.itemKey,r=e.demandItemFacet(o.spItemKeyFacet,n);if(!r)return!1;var i=l.getCurrentItemSetKey(e);if(!e.demandItemFacet(o.spFolderItemSetKeyFacet,i)&&!f.default.isActivated("07a8a4f1-bb71-4166-9a57-94afe649189e","02/28/2020","Show Request files action only in Files view"))return!1;if(e.demandItemFacet(s.mountPointFacet,n))return!1;if(!e.demandItemFacet(c.folderFacet,n))return!1;var h=o.spListKeyFacet.serialize(r),p=e.demandItemFacet(s.listFacet,h);if(!p)return!1;if(p.templateType!==a.default.mySiteDocumentLibrary&&!f.default.isActivated("54638CBE-3322-47EB-B3BC-96645317201E","04/13/2020","Folder in ODB shared library could show file request command"))return!1;var d=u.getPageContextFromItemCache(e,n);return!!d&&(!!d.isSiteOwner&&(!d.isEmailAuthenticationGuestUser&&((!d.farmSettings||!d.farmSettings.ExternalService_filerequestenable||"0"!==d.farmSettings.ExternalService_filerequestenable)&&!(!f.default.isActivated("43A2AE6C-6893-4A99-A4BE-2996D6C2FF4C","03/27/2020","Show Request files action only if anonymous sharing is enabled and folder edit sharing is enabled, too.")&&(!d.isShareByLinkEnabled||0!==d.FolderAnonymousLinkPermission&&5!==d.FolderAnonymousLinkPermission)))))})))});
define("odsp-next/controls/commands/itemsScope/ManageAccessCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/ManageAccessAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.manageAccessCommand={key:new r.Facet("ManageAccess").id,name:o.default.ManageAccess,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(s.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"}}});
define("odsp-next/actions/itemsScope/ManageAccessAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ManageAccessAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPermissionsAction))})});
define("odsp-next/controls/itemsScope/od/ItemsCommandBarController",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../ItemsScopeCommands","../../commands/itemsScope/AddPhotosToAlbumCommand","../../commands/itemsScope/AddToAlbumCommand","../../commands/itemsScope/CreateAlbumCommand","../../commands/itemsScope/DiscardAutoAlbumCommand","../../commands/itemsScope/EditTagsCommand","../../commands/itemsScope/NavigateToCommands","../../commands/itemsScope/NavigateToCommands","../../commands/itemsScope/NavigateToCommands","../../commands/itemsScope/NavigateToCommands","../../commands/itemsScope/PhotosScopeCommand","../../commands/itemsScope/PhotosViewToggleCommand","../../commands/itemsScope/RemoveFromAlbumCommand","../../commands/itemsScope/RemoveTagFromItemCommand","../../commands/itemsScope/SaveAutoAlbumCommand","../../commands/itemsScope/SetAlbumCoverPhotoCommand","../../commands/itemsScope/ViewInFolderCommand","@ms/items-view/lib/private/components/commands/delete/deleteCommand","@ms/items-view/lib/private/components/commands/download/downloadCommand","@ms/items-view/lib/private/components/commands/new/newCommand","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/rename/renameCommand","@ms/items-view/lib/private/components/commands/share/shareCommand","@ms/items-view/lib/private/components/commands/switchLayout/switchLayoutCommand","@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/keys/AlbumsRootKeyFacet","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return M}});function M(e,t){var r=t.itemKey,d=t.commands,v=t.farCommands,x=t.overflowCommands;return L.photosRootItemSetKeyFacet.matches(r)?{commands:n.__spreadArrays([c.getNavigateToAllPhotosCommand(!0),l.getNavigateToAlbumsCommand(!1)],O.isFeatureEnabled(O.EnableTagsInODC)?[p.getNavigateToTagsCommand(!1)]:[],[h.getNavigateToPlacesCommand(!1),u.createAlbumCommand,o.addToAlbumCommand,s.addPhotosToAlbumCommand,f.editTagsCommand,S.downloadCommand,b.setAlbumCoverPhotoCommand,i.rotateCommand,E.deleteCommand,m.removeFromAlbumCommand,g.removeTagFromItemCommand,i.orderPrintsCommand,w.viewInFolderCommand,N.renameCommand,i.embedCommand,y.saveAutoAlbumCommand,a.discardAutoAlbumCommand]),farCommands:B(v),overflowCommands:P(x)}:A.albumsRootKeyFacet.matches(r)?{commands:n.__spreadArrays([c.getNavigateToAllPhotosCommand(!1),l.getNavigateToAlbumsCommand(!0)],O.isFeatureEnabled(O.EnableTagsInODC)?[p.getNavigateToTagsCommand(!1)]:[],[h.getNavigateToPlacesCommand(!1),C.shareCommand,s.addPhotosToAlbumCommand,S.downloadCommand,E.deleteCommand,N.renameCommand]),farCommands:j(v),overflowCommands:P(x)}:{commands:_(d),farCommands:D(v),overflowCommands:P(x)}}t.itemsCommandBarControlHandler=M;function _(e){void 0===e&&(e=[]);for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(s.key===x.newCommand.key)t.push(H(s));else if(s.key===T.openCommand.key){t.push(i.surveyCommand);t.push(i.openFileCommand);t.push(i.OpenInTextEditorCommand)}else if(s.key===E.deleteCommand.key)t.push(s,i.createMountPointCommand,i.removeMountPointCommand,i.moveToCommand,i.copyToCommand);else if(s.key===N.renameCommand.key){t.push(s);t.push(i.rotateCommand,i.orderPrintsCommand,i.embedCommand,i.versionHistoryCommand,i.reportAbuseCommand)}else t.push(s)}return t}function D(e){void 0===e&&(e=[]);return n.__spreadArrays(e,[i.detailsCommand])}function P(e){void 0===e&&(e=[]);return n.__spreadArrays(e)}function H(e){if(e.key!==x.newCommand.key)return e;var t=e;e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&(t=n.__assign(n.__assign({},e),{subMenuProps:n.__assign(n.__assign({},e.subMenuProps),{items:n.__spreadArrays(e.subMenuProps.items,[i.createWordCommand,i.createExcelCommand,i.createPowerPointCommand,i.createOneNoteCommand,i.createExcelSurveyCommand,i.createTextFileCommand])})}));return t}function B(e){void 0===e&&(e=[]);for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];if(s.key===k.switchLayoutCommand.key){t.push(d.photosScopeCommand);t.push(v.photosViewToggleCommand)}else t.push(s)}t.push(i.detailsCommand);return t}function j(e){void 0===e&&(e=[]);return n.__spreadArrays(e,[i.detailsCommand])}});
define("odsp-next/controls/commands/itemsScope/AddToAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/AddToAlbumAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToAlbumCommand={key:new r.Facet("addToAlbum").id,name:s.default.AddToAlbum,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.AddToAlbumAction,null)),iconProps:{iconName:"Photo2Add"}}});
define("odsp-next/actions/itemsScope/AddToAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToAlbumAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddToAlbumAction))})});
define("odsp-next/controls/commands/itemsScope/CreateAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../Commands.resx","../../../actions/itemsScope/CreateAlbumAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createAlbumCommand={key:new r.Facet("createAlbum").id,name:i.default.createAlbumFromFolder,action:n.createElement(s.CreateAlbumAction,null),iconProps:{iconName:"Add"}}});
define("odsp-next/actions/itemsScope/CreateAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateAlbumAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateAlbumAction))})});
define("odsp-next/controls/commands/itemsScope/DiscardAutoAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../Commands.resx","../../../actions/itemsScope/DiscardAutoAlbumAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.discardAutoAlbumCommand={key:new r.Facet("discardAutoAlbumCommand").id,name:i.default.discardAutoAlbum,action:n.createElement(s.DiscardAutoAlbumAction,null),iconProps:{iconName:"Delete"}}});
define("odsp-next/actions/itemsScope/DiscardAutoAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DiscardAutoAlbumAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.DiscardAutoAlbumAction))({item:t.item})})});
define("odsp-next/controls/commands/itemsScope/EditTagsCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/EditTagsAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editTagsCommand={key:new r.Facet("editTags").id,name:s.default.editTags,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.EditTagsAction,null)),iconProps:{iconName:"Tag"},shortcutProps:{keySequences:["T"],content:""}}});
define("odsp-next/actions/itemsScope/EditTagsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditTagsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditTagsAction))})});
define("odsp-next/controls/commands/itemsScope/NavigateToCommands",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../photos/Photos.resx","../../../actions/itemsScope/NavigateToAlbumsAction","../../../actions/itemsScope/NavigateToAllMyPhotosAction","../../../actions/itemsScope/NavigateToTagsAction","../../../actions/itemsScope/NavigateToLocationsAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNavigateToAllPhotosCommand=function(e){return{key:new r.Facet("navigateToAllPhotos").id,name:s.default.allPhotosNavLink,action:n.createElement(i.HideWithSelection,null,n.createElement(u.NavigateToAllMyPhotosAction,null)),postProcess:function(t){return l(t,e)}}};t.getNavigateToAlbumsCommand=function(e){return{key:new r.Facet("navigateToAlbums").id,name:s.default.albumsNavLink,action:n.createElement(i.HideWithSelection,null,n.createElement(o.NavigateToAlbumsAction,null)),postProcess:function(t){return l(t,e)}}};t.getNavigateToTagsCommand=function(e){return{key:new r.Facet("navigateToTags").id,name:s.default.tagsNavLink,action:n.createElement(i.HideWithSelection,null,n.createElement(a.NavigateToTagsAction,null)),postProcess:function(t){return l(t,e)}}};t.getNavigateToPlacesCommand=function(e){return{key:new r.Facet("navigateToPlaces").id,name:s.default.placesNavLink,action:n.createElement(i.HideWithSelection,null,n.createElement(f.NavigateToLocationsAction,null)),postProcess:function(t){return l(t,e)}}};function l(e,t){e.className=e.className+" is-pivot";t&&(e.className=e.className+" is-current-view");return e}});
define("odsp-next/actions/itemsScope/NavigateToAlbumsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/ODCResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToAlbumsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap),r=e.consume(i.urlDataSource);return new(e.injected(t.NavigationAction))({url:r.getAlbumsQueryUrl(),forceNavigation:!0})})});
define("odsp-next/actions/itemsScope/NavigateToAllMyPhotosAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/ODCResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToAllMyPhotosAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap),r=e.consume(i.urlDataSource),o=e.consume(s.photo).getAllPhotosSettings()();return new(e.injected(t.NavigationAction))({url:r.getAllMyPhotosQueryUrl(o.rootId),forceNavigation:!0})})});
define("odsp-next/actions/itemsScope/NavigateToTagsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/ODCResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToTagsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap),r=e.consume(i.urlDataSource);return new(e.injected(t.NavigationAction))({url:r.getTagsQueryUrl(),forceNavigation:!0})})});
define("odsp-next/actions/itemsScope/NavigateToLocationsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/ODCResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToLocationsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap),r=e.consume(i.urlDataSource);return new(e.injected(t.NavigationAction))({url:r.getPlacesQueryUrl(),forceNavigation:!0})})});
define("odsp-next/controls/commands/itemsScope/PhotosScopeCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../Commands.resx","../../../actions/itemsScope/SetPhotosRootAction","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new r.Facet("photosScopeRootCommand").id,a=new r.Facet("photosScopeAllPhotosCommand").id,f=new r.Facet("photosScopeSamsungGalleryCommand").id,l={key:u,name:i.default.setRootPhotosValueAll,action:n.createElement(o.HideWithSelection,null,n.createElement(s.SetPhotosRootAction,{rootId:"ROOT"})),iconProps:{hidden:!0}},c={key:a,name:i.default.setRootPhotosValuePhotos,action:n.createElement(o.HideWithSelection,null,n.createElement(s.SetPhotosRootAction,{rootId:"ALLPHOTOSFOLDER"})),iconProps:{hidden:!0}},h={key:f,name:i.default.setRootPhotosValueSamsungGallery,action:n.createElement(o.HideWithSelection,null,n.createElement(s.SetPhotosRootAction,{rootId:"SAMSUNGFOLDER"})),iconProps:{hidden:!0}};t.photosScopeCommand={key:new r.Facet("photosViewToggleCommand").id,iconProps:{iconName:"Settings"},title:i.default.setRootPhotosIdTitle,name:i.default.setRootPhotosIdTitle,subMenuProps:{isBeakVisible:!1,items:[l,c,h]}}});
define("odsp-next/actions/itemsScope/SetPhotosRootAction",["require","exports","knockout","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view-addon-photos/lib/models/facets/SamsungFolderConfigurationFacet","@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/keys/SamsungFolderConfigurationKeyFacet"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.createItemsScopeActionFromKnockout(function(e,t){var i=e.consume(r.actionMap),s=new(e.injected(i.SetPhotosRootAction))({rootId:t.rootId}),o=n.pureComputed(function(){return t.isAvailable});s.isAvailable=o;return s},{isToggleable:!0});t.SetPhotosRootAction=s.withCurrentItemSet()(o.connectToItemCache(function(e,t){var n=!0;if("SAMSUNGFOLDER"===t.rootId&&a.photosRootItemSetKeyFacet.matches(t.itemKey)){var r=a.photosRootItemSetKeyFacet.deserialize(t.itemKey).photosRootKeyPart,i=f.samsungFolderConfigurationKeyFacet.serialize({photosRootItemSetKeyPart:r}),s=e.demandItemFacet(u.samsungFolderConfigurationFacet,i);n=!!s&&s.isAvailable}return{rootId:t.rootId,isAvailable:n}})(l))});
define("odsp-next/controls/commands/itemsScope/PhotosViewToggleCommand",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../Commands.resx","../../list/layouts/LayoutType","../../../actions/itemsScope/ToggleListLayoutAction","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosViewTogglePhotoflowCommand={key:new i.Facet("photosViewTogglePhotoflowCommand").id,name:s.default.ViewPhoto,action:r.createElement(a.HideWithSelection,null,r.createElement(u.ToggleListLayoutAction,{layoutType:o.AllPhotos})),iconProps:{iconName:"ViewAll"},automationId:"switchLayout"};t.photosViewToggleGridCommand={key:new i.Facet("photosViewToggleGridCommand").id,name:s.default.ViewGrid,action:r.createElement(a.HideWithSelection,null,r.createElement(u.ToggleListLayoutAction,{layoutType:o.Grid})),iconProps:{iconName:"LargeGrid"},engagement:{name:"ViewGrid"},automationId:"switchLayout"};t.photosViewToggleCommand={key:new i.Facet("photosViewToggleCommand").id,iconOnly:!0,subMenuProps:{isBeakVisible:!1,items:[t.photosViewToggleGridCommand,t.photosViewTogglePhotoflowCommand]},name:s.default.ViewPhotoCommandTooltip,automationId:"switchLayoutSwitcher",postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign(n.__assign(n.__assign({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),r?{iconProps:r.iconProps}:{})}}});
define("odsp-next/actions/itemsScope/ToggleListLayoutAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleListLayoutAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ToggleListLayoutAction))({layoutType:t.layoutType,clearContextualFilter:t.clearContextualFilter,strictAvailability:t.strictAvailability})},{isToggleable:!0})});
define("odsp-next/controls/commands/itemsScope/RemoveFromAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/RemoveFromAlbumAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromAlbumCommand={key:new r.Facet("removeFromAlbum").id,name:s.default.Remove,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.RemoveFromAlbumAction,null)),iconProps:{iconName:"Cancel"}}});
define("odsp-next/actions/itemsScope/RemoveFromAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RemoveFromAlbumAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.RemoveFromAlbumAction))({item:t.item,userInvokedItem:!0})})});
define("odsp-next/controls/commands/itemsScope/RemoveTagFromItemCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/RemoveTagFromItemAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeTagFromItemCommand={key:new r.Facet("removeTagFromItem").id,name:s.default.Remove,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.RemoveTagFromItemAction,null)),iconProps:{iconName:"Cancel"}}});
define("odsp-next/actions/itemsScope/RemoveTagFromItemAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RemoveTagFromItemAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.RemoveTagFromItemAction))({item:t.item,userInvokedItem:!0})})});
define("odsp-next/controls/commands/itemsScope/SaveAutoAlbumCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../Commands.resx","../../../actions/itemsScope/SaveAutoAlbumAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.saveAutoAlbumCommand={key:new r.Facet("saveAutoAlbumCommand").id,name:i.default.saveAutoAlbum,action:n.createElement(s.SaveAutoAlbumAction,null),iconProps:{iconName:"Add"}}});
define("odsp-next/actions/itemsScope/SaveAutoAlbumAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SaveAutoAlbumAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.SaveAutoAlbumAction))({item:t.item,isHidden:!1})})});
define("odsp-next/controls/commands/itemsScope/SetAlbumCoverPhotoCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/SetAlbumCoverPhotoAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setAlbumCoverPhotoCommand={key:new r.Facet("setAlbumCoverPhoto").id,name:s.default.setCoverPhotoTitle,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.SetAlbumCoverPhotoAction,null)),iconProps:{iconName:"Picture"}}});
define("odsp-next/actions/itemsScope/SetAlbumCoverPhotoAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SetAlbumCoverPhotoAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.SetAlbumCoverPhotoAction))({item:t.item,userInvokedItem:!0})})});
define("odsp-next/controls/commands/itemsScope/ViewInFolderCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../Commands.resx","../../../actions/itemsScope/ViewInFolderAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.viewInFolderCommand={key:new r.Facet("viewInFolder").id,name:s.default.viewInFolder,action:n.createElement(i.ShowOnlyWithSelection,null,n.createElement(o.ViewInFolderAction,null)),iconProps:{iconName:"Folder"},automationId:"viewInFolder"}});
define("odsp-next/actions/itemsScope/ViewInFolderAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeItemActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ViewInFolderAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var r=e.consume(n.actionMap);return new(e.injected(r.ViewInFolderAction))({item:t.item,userInvokedItem:!0})})});
define("odsp-next/models/itemsScope/od/OneDriveItemControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-graph/lib/models/facets/DriveItemResponseFacet","@ms/items-view/lib/private/facets/ItemFacets","../facets/KnockoutStoreIdentityFacet","../../../dataSources/item/od/ItemCacheToKOStoreCommands","../../../dataSources/base/vroom/ItemResultProcessor","@ms/odsp-utilities/lib/graft/Graft","@ms/items-view/lib/private/utilities/Graft"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{itemCacheToKOStoreCommands:a.resourceKey,itemResultProcessor:f.resourceKey},create:function(e){var t=e.itemCacheToKOStoreCommands,i=e.itemResultProcessor,a=function(e,r){var a=r.itemKey,f=r.key,h=r.item,p=e.demandItemFacet(s.driveItemResponseFacet,a);if(!h||!p)return{item:h};if(p.remoteItem){var d=p.remoteItem,v=n.__rest(p,["remoteItem"]);p=c.graft(d,v)}var m=(function(e){var t=e.itemCache,n=e.itemKey,r=t.demandItemFacet(o.parentFolderItemFacet,n);if(!r)return;var i=t.demandItemFacet(u.knockoutStoreIdentityFacet,r.itemKey);if(i)return i.key})({itemCache:e,itemKey:a}),g=i.buildItemFromServerResponse({itemFromServer:p,key:f,parentKey:m}),y=(function(e){var t=e.itemCache,n=e.itemKey,r=e.itemCacheToKOStoreCommands.getCommandStates(t,{itemKey:n}),i={};for(var s in r)0!==r[s]&&(i[s]=""+r[s]);return i})({itemCache:e,itemKey:a,itemCacheToKOStoreCommands:t});return{item:c.graft(l.default(h,g),{properties:{commandsSupported:new c.ReplacePatch(y)}})}};return{instance:r.createControlHandler()(function(){return function(e){return a}})}}}})});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreCommands",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../dataSources/item/odc/SkyApiCommands","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-graph/lib/models/facets/DriveItemResponseFacet","../../../utilities/mime/MimeHelper","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-graph/lib/utilities/hasPermission","@ms/items-view/lib/private/facets/DocumentFacets","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.HAS_PERMISSION=1]="HAS_PERMISSION"})(h||(h={}));var p,d={XLSX:1,XLSM:1,XLSB:1,XLS:1,ODS:1,ONE:2,PPTX:3,PPSX:3,PPT:3,PPS:3,POT:3,PPTM:3,POTM:3,POTX:3,PPSM:3,ODP:3,PPA:3,PPAM:3,DOCX:4,DOCM:4,DOC:4,DOTX:4,DOT:4,DOTM:4,ODT:4,VSDX:5,VSDM:5,VSSX:5,VSSM:5,VSTX:5,VSTM:5,VDW:5,VSD:5,VSS:5,VST:5,VSW:5,VDX:5,VSX:5,VTX:5,MPP:6,MPT:6,PUB:7};(function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.CAN_MULTI_SHARE_COMMAND_STATE=1]="CAN_MULTI_SHARE_COMMAND_STATE";e[e.CAN_SHARE_COMMAND_STATE=2]="CAN_SHARE_COMMAND_STATE"})(p||(p={}));var v=["PSD","PSB"],m=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._userInfoProvider=n.userInfoProvider;return r}t.prototype.getCommandStates=function(e,t){var n,r=t.itemKey,s=e.demandItemFacet(o.driveItemResponseFacet,r),c=e.demandItemFacet(a.fileNameFacet,r),m=f.hasRequiredItemRole(e,{itemKey:r,oneOfRequiredRoles:["write","owner"]}),g=!!e.demandItemFacet(a.folderFacet,r),y=(c.extension||"").toUpperCase(),b=!!d[y]&&d[y]<=4,w={itemKey:r,driveItemResponse:s,fileName:c.name,fileExtension:"."===y[0]?y.substring(1):y,canEdit:m,canDelete:e.demandItemFacet(f.canDeleteFacet,r),canRename:e.demandItemFacet(f.canRenameFacet,r),canMove:e.demandItemFacet(f.canMoveFacet,r),canUpload:e.demandItemFacet(f.canUploadFacet,r),canDownload:e.demandItemFacet(f.canDownloadFacet,r),isOneNote:!!e.demandItemFacet(l.oneNoteFacet,r),isFolder:g,isOwner:f.isOwner(e,r),isRoot:!!s.root,hasItems:g&&(s.folder||s.remoteItem.folder).childCount>0,isPhoto:!!s.photo,isVideo:!!s.video,isAuthenticated:this._userInfoProvider.isAuthenticated(),isMountPoint:!!s.remoteItem,isBundle:!1,isWacViewEnabled:b,isSharerFolder:!1,isRestricted:!1,isPanorama:!1,isMounted:!1,canCreateOfficeDocument:!0,ownerUsesODF:!1,isBadgerUser:!1,isAdmin:!1,isUserRoleFromViewToken:!1};return(n={})[i.abdicatePermissions]=h.NO_PERMISSION,n[i.addCoverPhoto]=h.NO_PERMISSION,n[i.applyOfficeLens]=h.NO_PERMISSION,n[i.addTag]=h.NO_PERMISSION,n[i.addToAlbum]=h.NO_PERMISSION,n[i.addToSharedList]=h.NO_PERMISSION,n[i.changeExpiration]=h.NO_PERMISSION,n[i.comment]=h.NO_PERMISSION,n[i.copy]=(function(e){var t=e.canMove,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isMountPoint,o=e.isRoot,u=e.isSharerFolder,a=e.isBundle;return!n||!t||u||a||o||!r&&!i||s?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.createExcel]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(w),n[i.createExcelSurvey]=(function(e){var t=e.canEdit,n=e.canCreateOfficeDocument,r=e.ownerUsesODF;return t&&n&&!r?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.createFolder]=h.NO_PERMISSION,n[i.createMountPoint]=(function(e){var t=e.canEdit,n=e.isFolder,r=e.isBundle,i=e.isMounted,s=e.isMountPoint,o=e.isOwner;return!t||!n||r||i||s||o?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.createOneNote]=w.canCreateOfficeDocument?h.HAS_PERMISSION:h.NO_PERMISSION,n[i.createPowerPoint]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(w),n[i.createWord]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(w),n[i.defaultClick]=(function(e){var t=e.fileExtension,n=e.isRestricted,r=e.isOwner,i=e.isPhoto,s=e.isVideo,o=e.isFolder;if(n&&!r&&!i&&!s)return 50;if(o)return 1;var a=u.canOpenInMonaco(t),f=-1!==v.indexOf(t);if(i||s||a)return 1;if(f)return 1;return 4})(w),n[i.deleteCommand]=(function(e){var t=e.canDelete,n=e.isOwner,r=e.isRestricted,i=e.isMountPoint,s=e.isMounted;return r&&!n||!t||i||!n&&!s?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.download]=(function(e){var t=e.canDownload,n=e.isOneNote,r=e.isFolder,i=e.isOwner,s=e.isRoot,o=e.isSharerFolder,u=e.isRestricted,a=e.hasItems,f=!s&&a;return u&&!i||!t||n||o||r&&!f?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.editSurvey]=h.NO_PERMISSION,n[i.embed]=(function(e){var t=e.isAuthenticated,n=e.isRoot,r=e.isBundle;return!t||n||r?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.emptyRecycleBin]=h.NO_PERMISSION,n[i.modifyCaption]=(function(e){var t=e.canEdit,n=e.isAuthenticated,r=e.isRoot;return n&&t&&!r?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.move]=(function(e){var t=e.canMove,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isMountPoint,o=e.isRoot;return n&&t&&!o&&(r||i)&&!s?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.openInOffice]=(function(e){var t=e.canEdit,n=e.isBadgerUser,r=e.isAdmin,i=e.isUserRoleFromViewToken,s=e.fileExtension;if(t&&!n&&!r&&!i){var o=d[s];if(o)return o}return h.NO_PERMISSION})(w),n[i.playAudio]=h.NO_PERMISSION,n[i.rearrange]=h.NO_PERMISSION,n[i.removeCoverPhoto]=h.NO_PERMISSION,n[i.removeFromAlbum]=h.NO_PERMISSION,n[i.removeFromRecent]=h.NO_PERMISSION,n[i.removeMountPoint]=(function(e){var t=e.canEdit,n=e.isMounted,r=e.isMountPoint;return t&&n&&r?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.rename]=(function(e){var t=e.canRename,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isRoot;return n&&t&&!s&&(r||i)?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.removeOfficeLens]=h.NO_PERMISSION,n[i.reportAbuse]=(function(e){var t=e.isAuthenticated,n=e.isRestricted,r=e.isOwner,i=e.isAdmin;return!t||n||r||i?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.requestReview]=h.NO_PERMISSION,n[i.restore]=h.NO_PERMISSION,n[i.restoreAll]=h.NO_PERMISSION,n[i.rotate]=(function(e){var t=e.canEdit,n=e.driveItemResponse,r=e.isAuthenticated,i=e.isPhoto,s=!!n.file&&n.file.mimeType&&"image/jpeg"===n.file.mimeType.toLowerCase();return r&&i&&t&&s?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.share]=(function(e){var t=e.canEdit,n=e.isAuthenticated,r=e.isRestricted,i=e.isOwner,s=e.isBundle,o=e.isRoot;if(!n||r&&!i||!t||o)return p.NO_PERMISSION;return s?p.CAN_SHARE_COMMAND_STATE:p.CAN_MULTI_SHARE_COMMAND_STATE})(w),n[i.shareSurvey]=h.NO_PERMISSION,n[i.upload]=(function(e){var t=e.canUpload,n=e.isAuthenticated,r=e.isBundle;return n&&t&&!r?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.viewInBrowser]=(function(e){return e.isWacViewEnabled?h.HAS_PERMISSION:h.NO_PERMISSION})(w),n[i.viewOriginal]=(function(e){var t=e.isRestricted,n=e.isOwner,r=e.isPanorama;return t&&!n||r?h.NO_PERMISSION:h.HAS_PERMISSION})(w),n[i.viewSurvey]=h.NO_PERMISSION,n[i.viewVersions]=h.NO_PERMISSION,n};t.dependencies=n.__assign(n.__assign({},r.default.dependencies),{userInfoProvider:c.userInfo});return t})(r.default);t.default=m;t.resourceKey=s.createResolvedResourceKey(e("module").id,m)});
define("odsp-next/controls/itemsScope/odc/CreateDocumentActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/operations/createDocument/DocumentType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=!0;switch(t.documentType){case r.DocumentType.Word:case r.DocumentType.Excel:case r.DocumentType.ExcelSurvey:case r.DocumentType.PowerPoint:case r.DocumentType.OneNote:case r.DocumentType.Prague:case r.DocumentType.Bohemia:case r.DocumentType.ExcelForm:case r.DocumentType.Visio:n=!1}return{isAvailable:n,askForFileName:!1,validator:function(){}}}}})});
define("odsp-next/controls/itemsScope/DesktopAppDownloader",["require","exports","tslib","react","@ms/items-view/lib/private/hooks/useItemCacheSelector","../base/react/WithResources","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/ItemFacets","../../providers/winApp/communication/WinAppCommunicator.key","../../models/winApp/communication/IWinAppCommunicator"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DesktopAppDownloader=function(e){var t=this,l=e.resolve,c=e.reject,h=i.useItemCacheDispatch(),p=s.useResourceScope();r.useLayoutEffect(function(){n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,d,v;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,e.getDownloadData()];case 1:t=n.sent();r=e.itemKeys[0];i=h(o.readItems(function(e){return e.demandItemFacet(u.displayNameFacet,r)}));return[4,p.consumeAsync(a.resourceKey)];case 2:s=n.sent();d={command:"Download",type:f.WinAppDownloadType.DownloadSingleFile,downloadUrl:t.url,zipFileName:i,postBody:JSON.stringify({})};if("POST"===t.method){d.postBody=JSON.stringify({request:t.postData});d.zipFileName=t.postData.zipFileName;d.type=f.WinAppDownloadType.DownloadMultiFile}s.sendCommand({command:JSON.stringify({DownloadCommand:d})});l();return[3,4];case 3:v=n.sent();c(v);return[3,4];case 4:return[2]}})})},[]);return null}});
define("odsp-next/controls/itemsScope/DownloaderWithRecents",["require","exports","tslib","react","@ms/items-view/lib/private/operations/readItems","../../resources/ProviderResourceKeys","../../models/itemsScope/facets/OneDriveItemFacet","../../utilities/features/Features","@ms/items-view/lib/private/hooks/useItemCacheSelector","../base/react/WithResources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DownloaderWithRecents=function(e){var t=this,l=e.defaultRender,c=n.__rest(e,["defaultRender"]),h=e.itemKeys,p=a.useItemCacheDispatch(),d=f.useResourceScope();r.useLayoutEffect(function(){if(u.isFeatureEnabled(u.WriteMruSignalWhenMediaDownloaded)){var e=p(i.readItems(function(e){return h.map(function(t){return e.demandItemFacet(o.oneDriveItemFacet,t)})}));n.__awaiter(t,void 0,void 0,function(){var t,r,i,o,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,d.consumeAsync(s.mruRecent.optional)];case 1:if(!(t=n.sent()))return[3,3];r=[];for(i=0,o=e;i<o.length;i++)(u=o[i])&&r.push(t.recordDocumentView(u));return[4,Promise.all(r)];case 2:n.sent();n.label=3;case 3:return[2]}})})}},[]);return l?r.createElement(l,n.__assign({},c)):null}});
define("odsp-next/controls/itemsScope/UserHoverCardLauncher",["require","exports","react","office-ui-fabric-react/lib/Utilities","../../controls/personaCard/EasyLpc","@ms/items-view/lib/private/facets/PersonFacets","../../utilities/features/PLTFeatures","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/operations/pageLoad"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=o.isFeatureEnabled(o.PeopleCardsReactComponent),l=o.isFeatureEnabled(o.PeopleCardsOnLoki),c=r.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":l||f});t.UserHoverCard=u.connectToItemCache(function(e,t){var n=t.personKey,r=t.user,i=a.getPageLoadBarrier(e),o=r||e.demandItem({email:s.emailFacet,sip:s.sipFacet},n);return{pageLoadBarrier:i,identifier:o.email||o.sip}})(function(e){var t=e.pageLoadBarrier,r=e.identifier,s=e.children,o=n.createElement("span",{className:c},s);return n.createElement(i.EasyLpc,{pageLoadBarrier:t,personaType:"User",identifier:r,loggingData:{name:"UserRenderer.LPC.Click"},placeHolder:o},o)})});
define("odsp-next/controls/itemPicker/itemsScope/ItemsPicker",["require","exports","tslib","react","@ms/items-view/lib/private/components/picker/ItemsPicker","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../../bindings/component/ReactControlBinding","@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/controls/hoverCardCommandsControl","@ms/items-view/lib/private/controls/shareActionControl","@ms/items-view/lib/private/components/decorators/withControlHandler"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){return{addMetadataAction:null,checkInAction:null,policyTipAction:null,publishNowAction:null,showDetailsPane:null,showFeedbackPane:null,showFileAnalytics:null,showKeyPointsPane:null,undoCheckOutAction:null}}function c(e,t){return{isAvailable:!1}}var h=(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(f.ControlHandlerProvider,{controlHandlers:n.__assign(n.__assign({},u.hoverCardCommandsControl.pack(l)),a.shareActionControl.pack(c))},r.createElement(i.ItemsPicker,n.__assign({},this.props)))};t.contextTypes=n.__assign({},s.RESOLVED_COMPONENT_CONTEXT_TYPES);return t})(r.PureComponent);t.ItemsPicker=h;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,h,{});t.knockoutResourceKey=o.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker",name:e("module").id+".knockout"})});
define("@ms/items-view/lib/private/components/reactDragDrop/DragDropHook",["require","exports","tslib","react","office-ui-fabric-react/lib/Layer","@ms/utilities-react-drag-drop/lib/drag-drop-context-provider/DragDropContextProviderWrapper","@ms/utilities-react-drag-drop/lib/drop-target/DropTargetWrapper","@ms/utilities-react-drag-drop/lib/drag-source/DragSourceWrapper","./DragLayerPreview","@ms/utilities-react-drag-drop/lib/drag-drop/DragDropWrapper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropTargetHook=function(e){return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(o.DropTargetHookWrapper,n.__assign({},e)))};t.DragSourceHook=function(e){var t=e.dragSourceKey,i=e.type;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(u.DragSourceHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i},r.createElement(a.DragLayerPreview,null)))};t.DragDropHook=r.memo(function(e){var t=e.dragDropKey,i=e.dragType;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(f.DragDropHookWrapper,n.__assign({},e)),e.showDefaultDragPreview?null:r.createElement(u.DragLayerHookWrapper,{dragSourceKey:t,type:i,as:l,getItemStyles:c},r.createElement(a.DragLayerPreview,null)))});var l=r.forwardRef(function(e,t){return r.createElement(i.Layer,null,r.createElement("div",{className:e.className,ref:t},e.children))});function c(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}});
define("@ms/utilities-react-drag-drop/lib/drag-drop-context-provider/DragDropContextProviderWrapper",["require","exports","react","../backends/odsp-react-dnd-html5-backend","react-dnd","./../Constants"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragDropContextProviderWrapper=function(e){switch(e.backend){case s.Backend.HTML5Backend:default:return n.createElement(i.DndProvider,{backend:r.odspReactDndHTML5Backend},e.children)}}});
define("@ms/utilities-react-drag-drop/lib/backends/odsp-react-dnd-html5-backend",["require","exports","react-dom","react-dnd-html5-backend"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={handleTopDragStart:"dragStartSourceIds",handleTopDragOver:"dragOverTargetIds",handleTopDragEnter:"dragEnterTargetIds",handleTopDrop:"dropTargetIds"};t.odspReactDndHTML5Backend=function(e){var t=r.default(e),s=function(e){if(!i[e])return"continue";var n=t[e];t[e]=function(r){var s=t[i[e]];s&&s.length&&n(r)}};for(var o in i)s(o);var u=t.actions,a=function(e){if(Object.prototype.hasOwnProperty.call(u,e)){var t=u[e];u[e]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.unstable_batchedUpdates(function(){t.apply(void 0,e)})}}};for(var f in u)a(f);return t}});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define('react-dnd-html5-backend',[],t):"object"==typeof exports?exports["react-dnd-html5-backend"]=t():e["react-dnd-html5-backend"]=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE="__NATIVE_FILE__",t.URL="__NATIVE_URL__",t.TEXT="__NATIVE_TEXT__"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.memoize=function(e){var t=null;return function(){return null==t&&(t=e()),t}},t.without=function(e,t){return e.filter(function(e){return e!==t})},t.union=function(e,t){var r=new Set,n=function(e){return r.add(e)};e.forEach(n),t.forEach(n);var o=[];return r.forEach(function(e){return o.push(e)}),o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.isFirefox=n.memoize(function(){return/firefox/i.test(navigator.userAgent)}),t.isSafari=n.memoize(function(){return Boolean(window.safari)})},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(4)),a=o(r(0));t.NativeTypes=a;var s=r(13);t.getEmptyImage=s.getEmptyImage;t.default=function(e,t){return new i.default(e,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(5)),s=r(2),u=r(6),d=r(8),c=i(r(0)),f=r(12),g=function(){function e(e,t){var r=this;this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.getSourceClientOffset=function(e){return u.getNodeClientOffset(r.sourceNodes.get(e))},this.endDragNativeItem=function(){r.isDraggingNativeItem()&&(r.actions.endDrag(),r.registry.removeSource(r.currentNativeHandle),r.currentNativeHandle=null,r.currentNativeSource=null)},this.isNodeInDocument=function(e){return r.document&&r.document.body&&document.body.contains(e)},this.endDragIfSourceWasRemovedFromDOM=function(){var e=r.currentDragSourceNode;r.isNodeInDocument(e)||r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragStartCapture=function(){r.clearCurrentDragSourceNode(),r.dragStartSourceIds=[]},this.handleTopDragStart=function(e){if(!e.defaultPrevented){var t=r.dragStartSourceIds;r.dragStartSourceIds=null;var n=u.getEventClientOffset(e);r.monitor.isDragging()&&r.actions.endDrag(),r.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:r.getSourceClientOffset,clientOffset:n});var o=e.dataTransfer,i=d.matchNativeItemType(o);if(r.monitor.isDragging()){if(o&&"function"==typeof o.setDragImage){var a=r.monitor.getSourceId(),s=r.sourceNodes.get(a),c=r.sourcePreviewNodes.get(a)||s;if(c){var f=r.getCurrentSourcePreviewNodeOptions(),g={anchorX:f.anchorX,anchorY:f.anchorY},l={offsetX:f.offsetX,offsetY:f.offsetY},p=u.getDragPreviewOffset(s,c,n,g,l);o.setDragImage(c,p.x,p.y)}}try{o.setData("application/json",{})}catch(e){}r.setCurrentDragSourceNode(e.target),r.getCurrentSourcePreviewNodeOptions().captureDraggingState?r.actions.publishDragSource():setTimeout(function(){return r.actions.publishDragSource()},0)}else if(i)r.beginDragNativeItem(i);else{if(o&&!o.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}},this.handleTopDragEndCapture=function(){r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragEnterCapture=function(e){if(r.dragEnterTargetIds=[],r.enterLeaveCounter.enter(e.target)&&!r.monitor.isDragging()){var t=e.dataTransfer,n=d.matchNativeItemType(t);n&&r.beginDragNativeItem(n)}},this.handleTopDragEnter=function(e){var t=r.dragEnterTargetIds;(r.dragEnterTargetIds=[],r.monitor.isDragging())&&(r.altKeyPressed=e.altKey,s.isFirefox()||r.actions.hover(t,{clientOffset:u.getEventClientOffset(e)}),t.some(function(e){return r.monitor.canDropOnTarget(e)})&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(){r.dragOverTargetIds=[]},this.handleTopDragOver=function(e){var t=r.dragOverTargetIds;if(r.dragOverTargetIds=[],!r.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));r.altKeyPressed=e.altKey,r.actions.hover(t||[],{clientOffset:u.getEventClientOffset(e)}),(t||[]).some(function(e){return r.monitor.canDropOnTarget(e)})?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())):r.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(e){r.isDraggingNativeItem()&&e.preventDefault(),r.enterLeaveCounter.leave(e.target)&&r.isDraggingNativeItem()&&r.endDragNativeItem()},this.handleTopDropCapture=function(e){r.dropTargetIds=[],e.preventDefault(),r.isDraggingNativeItem()&&r.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer),r.enterLeaveCounter.reset()},this.handleTopDrop=function(e){var t=r.dropTargetIds;r.dropTargetIds=[],r.actions.hover(t,{clientOffset:u.getEventClientOffset(e)}),r.actions.drop({dropEffect:r.getCurrentDropEffect()}),r.isDraggingNativeItem()?r.endDragNativeItem():r.endDragIfSourceWasRemovedFromDOM()},this.handleSelectStart=function(e){var t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new f.OptionsReader(t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new a.default(this.isNodeInDocument)}return Object.defineProperty(e.prototype,"window",{get:function(){return this.options.window},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.options.document},enumerable:!0,configurable:!0}),e.prototype.setup=function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}},e.prototype.teardown=function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))},e.prototype.connectDragPreview=function(e,t,r){var n=this;return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,t),function(){n.sourcePreviewNodes.delete(e),n.sourcePreviewNodeOptions.delete(e)}},e.prototype.connectDragSource=function(e,t,r){var n=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,r);var o=function(t){return n.handleDragStart(t,e)},i=function(e){return n.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",o),t.addEventListener("selectstart",i),function(){n.sourceNodes.delete(e),n.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",o),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}},e.prototype.connectDropTarget=function(e,t){var r=this,n=function(t){return r.handleDragEnter(t,e)},o=function(t){return r.handleDragOver(t,e)},i=function(t){return r.handleDrop(t,e)};return t.addEventListener("dragenter",n),t.addEventListener("dragover",o),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",n),t.removeEventListener("dragover",o),t.removeEventListener("drop",i)}},e.prototype.addEventListeners=function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))},e.prototype.removeEventListeners=function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))},e.prototype.getCurrentSourceNodeOptions=function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return n({dropEffect:this.altKeyPressed?"copy":"move"},t||{})},e.prototype.getCurrentDropEffect=function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect},e.prototype.getCurrentSourcePreviewNodeOptions=function(){var e=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions.get(e);return n({anchorX:.5,anchorY:.5,captureDraggingState:!1},t||{})},e.prototype.isDraggingNativeItem=function(){var e=this.monitor.getItemType();return Object.keys(c).some(function(t){return c[t]===e})},e.prototype.beginDragNativeItem=function(e){this.clearCurrentDragSourceNode(),this.currentNativeSource=d.createNativeDragSource(e),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])},e.prototype.setCurrentDragSourceNode=function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout(function(){return t.window&&t.window.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)},1e3)},e.prototype.clearCurrentDragSourceNode=function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.window&&(this.window.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)},e.prototype.handleDragStart=function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))},e.prototype.handleDragEnter=function(e,t){this.dragEnterTargetIds.unshift(t)},e.prototype.handleDragOver=function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)},e.prototype.handleDrop=function(e,t){this.dropTargetIds.unshift(t)},e}();t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=function(){function e(e){this.entered=[],this.isNodeInDocument=e}return e.prototype.enter=function(e){var t=this,r=this.entered.length;return this.entered=n.union(this.entered.filter(function(r){return t.isNodeInDocument(r)&&(!r.contains||r.contains(e))}),[e]),0===r&&this.entered.length>0},e.prototype.leave=function(e){var t=this.entered.length;return this.entered=n.without(this.entered.filter(this.isNodeInDocument),e),t>0&&0===this.entered.length},e.prototype.reset=function(){this.entered=[]},e}();t.default=o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),i=n(r(7)),a=1;function s(e){var t=e.nodeType===a?e:e.parentElement;if(!t)return null;var r=t.getBoundingClientRect(),n=r.top;return{x:r.left,y:n}}t.getNodeClientOffset=s,t.getEventClientOffset=function(e){return{x:e.clientX,y:e.clientY}},t.getDragPreviewOffset=function(e,t,r,n,a){var u,d,c="IMG"===(u=t).nodeName&&(o.isFirefox()||!document.documentElement.contains(u)),f=s(c?e:t),g={x:r.x-f.x,y:r.y-f.y},l=e.offsetWidth,p=e.offsetHeight,h=n.anchorX,v=n.anchorY,m=function(e,t,r,n){var i=e?t.width:r,a=e?t.height:n;return o.isSafari()&&e&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:a}}(c,t,l,p),D=m.dragPreviewWidth,y=m.dragPreviewHeight,T=a.offsetX,E=a.offsetY,w=0===E||E;return{x:0===T||T?T:new i.default([0,.5,1],[g.x,g.x/l*D,g.x+D-l]).interpolate(h),y:w?E:(d=new i.default([0,.5,1],[g.y,g.y/p*y,g.y+y-p]).interpolate(v),o.isSafari()&&c&&(d+=(window.devicePixelRatio-1)*y),d)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=e.length,n=[],o=0;o<r;o++)n.push(o);n.sort(function(t,r){return e[t]<e[r]?-1:1});var i,a,s=[],u=[],d=[];for(o=0;o<r-1;o++)i=e[o+1]-e[o],a=t[o+1]-t[o],u.push(i),s.push(a),d.push(a/i);var c=[d[0]];for(o=0;o<u.length-1;o++){var f=d[o],g=d[o+1];if(f*g<=0)c.push(0);else{i=u[o];var l=u[o+1],p=i+l;c.push(3*p/((p+l)/f+(p+i)/g))}}c.push(d[d.length-1]);var h,v=[],m=[];for(o=0;o<c.length-1;o++){h=d[o];var D=c[o],y=1/u[o];p=D+c[o+1]-h-h;v.push((h-D-p)*y),m.push(p*y*y)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=v,this.c3s=m}return e.prototype.interpolate=function(e){var t=this,r=t.xs,n=t.ys,o=t.c1s,i=t.c2s,a=t.c3s,s=r.length-1;if(e===r[s])return n[s];for(var u,d=0,c=a.length-1;d<=c;){var f=r[u=Math.floor(.5*(d+c))];if(f<e)d=u+1;else{if(!(f>e))return n[u];c=u-1}}var g=e-r[s=Math.max(0,c)],l=g*g;return n[s]+o[s]*g+i[s]*l+a[s]*g*l},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(11);t.createNativeDragSource=function(e){return new o.NativeDragSource(n.nativeTypesConfig[e])},t.matchNativeItemType=function(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(n.nativeTypesConfig).filter(function(e){return n.nativeTypesConfig[e].matchesTypes.some(function(e){return t.indexOf(e)>-1})})[0]||null}},function(e,t,r){"use strict";var n,o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(0)),a=r(10);t.nativeTypesConfig=((n={})[i.FILE]={exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items}},matchesTypes:["Files"]},n[i.URL]={exposeProperties:{urls:function(e,t){return a.getDataFromDataTransfer(e,t,"").split("\n")}},matchesTypes:["Url","text/uri-list"]},n[i.TEXT]={exposeProperties:{text:function(e,t){return a.getDataFromDataTransfer(e,t,"")}},matchesTypes:["Text","text/plain"]},n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDataFromDataTransfer=function(e,t,r){var n=t.reduce(function(t,r){return t||e.getData(r)},"");return null!=n?n:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.config=e,this.item={},Object.keys(this.config.exposeProperties).forEach(function(e){Object.defineProperty(t.item,e,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \""+e+'" until the drop event.'),null}})})}return e.prototype.mutateItemByReadingDataTransfer=function(e){var t=this,r={};e&&Object.keys(this.config.exposeProperties).forEach(function(n){r[n]={value:t.config.exposeProperties[n](e,t.config.matchesTypes)}}),Object.defineProperties(this.item,r)},e.prototype.canDrag=function(){return!0},e.prototype.beginDrag=function(){return this.item},e.prototype.isDragging=function(e,t){return t===e.getSourceId()},e.prototype.endDrag=function(){},e}();t.NativeDragSource=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.globalContext=e}return Object.defineProperty(e.prototype,"window",{get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){if(this.window)return this.window.document},enumerable:!0,configurable:!0}),e}();t.OptionsReader=n},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyImage=function(){return n||((n=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),n}}])});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define('react-dnd',["react"],t):"object"==typeof exports?exports["react-dnd"]=t(require("react")):e["react-dnd"]=t(e.React)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=10)}([function(e,t,r){"use strict";e.exports=function(e,t,r,n,o,i,a,u){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,o,i,a,u],d=0;(s=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}}},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_COORDS="dnd-core/INIT_COORDS",t.BEGIN_DRAG="dnd-core/BEGIN_DRAG",t.PUBLISH_DRAG_SOURCE="dnd-core/PUBLISH_DRAG_SOURCE",t.HOVER="dnd-core/HOVER",t.DROP="dnd-core/DROP",t.END_DRAG="dnd-core/END_DRAG"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e},t.noop=function(){},t.isPlainObject=function(e){if(!function(e){return"object"==typeof e&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(e,t,r){return t.split(".").reduce(function(e,t){return e&&e[t]?e[t]:r||null},e)},t.without=function(e,t){return e.filter(function(e){return e!==t})},t.isString=function(e){return"string"==typeof e},t.isObject=function(e){return"object"==typeof e},t.xor=function(e,t){var r=new Map,n=function(e){return r.set(e,r.has(e)?r.get(e)+1:1)};e.forEach(n),t.forEach(n);var o=[];return r.forEach(function(e,t){1===e&&o.push(t)}),o},t.intersection=function(e,t){return e.filter(function(e){return t.indexOf(e)>-1})}},function(e,t,r){"use strict";function n(e){return e&&e.prototype&&"function"==typeof e.prototype.render}function o(e){return e&&e.$$typeof&&"Symbol(react.forward_ref)"===e.$$typeof.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDecoratedComponent=function(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t},t.isClassComponent=n,t.isRefForwardingComponent=o,t.isRefable=function(e){return n(e)||o(e)},t.checkDecoratorArguments=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n]}},function(e,t){e.exports=function(e,t,r,n){var o=r?r.call(n,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var u=Object.prototype.hasOwnProperty.bind(t),s=0;s<i.length;s++){var c=i[s];if(!u(c))return!1;var d=e[c],f=t[c];if(!1===(o=r?r.call(n,d,f,c):void 0)||void 0===o&&d!==f)return!1}return!0}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(39)),i=n(r(41)),a=n(r(42)),u=n(r(43)),s=n(r(44));!function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(2)),t.default=function(e){return{beginDrag:o.default(e),publishDragSource:i.default(e),hover:a.default(e),drop:u.default(e),endDrag:s.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ADD_SOURCE="dnd-core/ADD_SOURCE",t.ADD_TARGET="dnd-core/ADD_TARGET",t.REMOVE_SOURCE="dnd-core/REMOVE_SOURCE",t.REMOVE_TARGET="dnd-core/REMOVE_TARGET",t.addSource=function(e){return{type:t.ADD_SOURCE,payload:{sourceId:e}}},t.addTarget=function(e){return{type:t.ADD_TARGET,payload:{targetId:e}}},t.removeSource=function(e){return{type:t.REMOVE_SOURCE,payload:{sourceId:e}}},t.removeTarget=function(e){return{type:t.REMOVE_TARGET,payload:{targetId:e}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTarget=function(e,t,r){var n=r.getRegistry(),o=n.addTarget(e,t);return[o,function(){return n.removeTarget(o)}]},t.registerSource=function(e,t,r){var n=r.getRegistry(),o=n.addSource(e,t);return[o,function(){return n.removeSource(o)}]}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(31)),n(r(58)),n(r(65))},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1)),i=r(32);t.DndContext=o.createContext({dragDropManager:void 0}),t.createDndContext=function(e,t,r,n){return{dragDropManager:i.createDragDropManager(e,t,r,n)}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(11);t.useDragDropManager=function(){var e=o.useContext(a.DndContext).dragDropManager;return i.default(null!=e,"Expected drag drop context"),e}},function(e,t,r){"use strict";(function(e,n){var o,i=r(30);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(i.a)(o);t.a=a}).call(this,r(12),r(36)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(t.HandlerRole||(t.HandlerRole={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return null===t?null===e:Array.isArray(e)?e.some(function(e){return e===t}):e===t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strictEquality=function(e,t){return e===t},t.areCoordsEqual=function(e,t){return!e&&!t||!(!e||!t)&&e.x===t.x&&e.y===t.y},t.areArraysEqual=function(e,r,n){if(void 0===n&&(n=t.strictEquality),e.length!==r.length)return!1;for(var o=0;o<e.length;++o)if(!n(e[o],r[o]))return!1;return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.NONE=[],t.ALL=[],t.NONE.__IS_NONE__=!0,t.ALL.__IS_ALL__=!0,t.areDirty=function(e,r){return e!==t.NONE&&(e===t.ALL||void 0===r||n.intersection(r,e).length>0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(20);t.useMonitorOutput=function(e,t,r){var i=o.useCollector(e,t,r),a=i[0],u=i[1];return n.useLayoutEffect(function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(u,{handlerIds:[t]})},[e,u]),a}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(6)),i=r(1);t.useCollector=function(e,t,r){var n=i.useState(function(){return t(e)}),a=n[0],u=n[1],s=i.useCallback(function(){var n=t(e);o.default(a,n)||(u(n),r&&r())},[a,e,r]);return i.useLayoutEffect(s,[]),[a,s]}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=!1,a=!1,u=function(){function e(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}return e.prototype.receiveHandlerId=function(e){this.sourceId=e},e.prototype.getHandlerId=function(){return this.sourceId},e.prototype.canDrag=function(){o.default(!i,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return i=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{i=!1}},e.prototype.isDragging=function(){if(!this.sourceId)return!1;o.default(!a,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return a=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{a=!1}},e.prototype.subscribeToStateChange=function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)},e.prototype.isDraggingSource=function(e){return this.internalMonitor.isDraggingSource(e)},e.prototype.isOverTarget=function(e,t){return this.internalMonitor.isOverTarget(e,t)},e.prototype.getTargetIds=function(){return this.internalMonitor.getTargetIds()},e.prototype.isSourcePublic=function(){return this.internalMonitor.isSourcePublic()},e.prototype.getSourceId=function(){return this.internalMonitor.getSourceId()},e.prototype.subscribeToOffsetChange=function(e){return this.internalMonitor.subscribeToOffsetChange(e)},e.prototype.canDragSource=function(e){return this.internalMonitor.canDragSource(e)},e.prototype.canDropOnTarget=function(e){return this.internalMonitor.canDropOnTarget(e)},e.prototype.getItemType=function(){return this.internalMonitor.getItemType()},e.prototype.getItem=function(){return this.internalMonitor.getItem()},e.prototype.getDropResult=function(){return this.internalMonitor.getDropResult()},e.prototype.didDrop=function(){return this.internalMonitor.didDrop()},e.prototype.getInitialClientOffset=function(){return this.internalMonitor.getInitialClientOffset()},e.prototype.getInitialSourceClientOffset=function(){return this.internalMonitor.getInitialSourceClientOffset()},e.prototype.getSourceClientOffset=function(){return this.internalMonitor.getSourceClientOffset()},e.prototype.getClientOffset=function(){return this.internalMonitor.getClientOffset()},e.prototype.getDifferenceFromInitialOffset=function(){return this.internalMonitor.getDifferenceFromInitialOffset()},e}();t.DragSourceMonitorImpl=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(23)),i=r(24),a=n(r(6)),u=function(){function e(e){var t=this;this.hooks=o.default({dragSource:function(e,r){t.dragSourceOptions=r||null,i.isRef(e)?t.dragSourceRef=e:t.dragSourceNode=e,t.reconnectDragSource()},dragPreview:function(e,r){t.dragPreviewOptions=r||null,i.isRef(e)?t.dragPreviewRef=e:t.dragPreviewNode=e,t.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}return e.prototype.receiveHandlerId=function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())},Object.defineProperty(e.prototype,"connectTarget",{get:function(){return this.dragSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragSourceOptions",{get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragPreviewOptions",{get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e},enumerable:!0,configurable:!0}),e.prototype.reconnect=function(){this.reconnectDragSource(),this.reconnectDragPreview()},e.prototype.reconnectDragSource=function(){var e=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();e&&this.disconnectDragSource();var t=this.dragSource;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)):this.lastConnectedDragSource=t)},e.prototype.reconnectDragPreview=function(){var e=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();e&&this.disconnectDragPreview();var t=this.dragPreview;this.handlerId&&t&&e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))},e.prototype.didHandlerIdChange=function(){return this.lastConnectedHandlerId!==this.handlerId},e.prototype.didConnectedDragSourceChange=function(){return this.lastConnectedDragSource!==this.dragSource},e.prototype.didConnectedDragPreviewChange=function(){return this.lastConnectedDragPreview!==this.dragPreview},e.prototype.didDragSourceOptionsChange=function(){return!a.default(this.lastConnectedDragSourceOptions,this.dragSourceOptions)},e.prototype.didDragPreviewOptionsChange=function(){return!a.default(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)},e.prototype.disconnectDragSource=function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)},e.prototype.disconnectDragPreview=function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)},Object.defineProperty(e.prototype,"dragSource",{get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragPreview",{get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current},enumerable:!0,configurable:!0}),e}();t.SourceConnector=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(61);function i(e){return function(t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),!n.isValidElement(t)){var i=t;return e(i,r),i}var a=t;!function(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors.You can either wrap "+t+" into a <div>, or turn it into a drag source or a drop target itself.")}}(a);var u=r?function(t){return e(t,r)}:e;return o.cloneWithRef(a,u)}}t.default=function(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{var o=i(n);t[r]=function(){return o}}}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRef=function(e){return null!==e&&"object"==typeof e&&e.hasOwnProperty("current")}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(6)),i=n(r(23)),a=r(24),u=function(){function e(e){var t=this;this.hooks=i.default({dropTarget:function(e,r){t.dropTargetOptions=r,a.isRef(e)?t.dropTargetRef=e:t.dropTargetNode=e,t.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}return Object.defineProperty(e.prototype,"connectTarget",{get:function(){return this.dropTarget},enumerable:!0,configurable:!0}),e.prototype.reconnect=function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)},e.prototype.receiveHandlerId=function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())},Object.defineProperty(e.prototype,"dropTargetOptions",{get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e},enumerable:!0,configurable:!0}),e.prototype.didHandlerIdChange=function(){return this.lastConnectedHandlerId!==this.handlerId},e.prototype.didDropTargetChange=function(){return this.lastConnectedDropTarget!==this.dropTarget},e.prototype.didOptionsChange=function(){return!o.default(this.lastConnectedDropTargetOptions,this.dropTargetOptions)},e.prototype.disconnectDropTarget=function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)},Object.defineProperty(e.prototype,"dropTarget",{get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current},enumerable:!0,configurable:!0}),e}();t.TargetConnector=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=!1,a=function(){function e(e){this.targetId=null,this.internalMonitor=e.getMonitor()}return e.prototype.receiveHandlerId=function(e){this.targetId=e},e.prototype.getHandlerId=function(){return this.targetId},e.prototype.subscribeToStateChange=function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)},e.prototype.canDrop=function(){if(!this.targetId)return!1;o.default(!i,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return i=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{i=!1}},e.prototype.isOver=function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)},e.prototype.getItemType=function(){return this.internalMonitor.getItemType()},e.prototype.getItem=function(){return this.internalMonitor.getItem()},e.prototype.getDropResult=function(){return this.internalMonitor.getDropResult()},e.prototype.didDrop=function(){return this.internalMonitor.didDrop()},e.prototype.getInitialClientOffset=function(){return this.internalMonitor.getInitialClientOffset()},e.prototype.getInitialSourceClientOffset=function(){return this.internalMonitor.getInitialSourceClientOffset()},e.prototype.getSourceClientOffset=function(){return this.internalMonitor.getSourceClientOffset()},e.prototype.getClientOffset=function(){return this.internalMonitor.getClientOffset()},e.prototype.getDifferenceFromInitialOffset=function(){return this.internalMonitor.getDifferenceFromInitialOffset()},e}();t.DropTargetMonitorImpl=a},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(1)),c=u(r(6)),d=u(r(0)),f=u(r(28)),l=r(10),p=(r(3),r(69)),h=r(5);t.default=function(e){var t=e.DecoratedComponent,r=e.createHandler,n=e.createMonitor,a=e.createConnector,u=e.registerHandler,g=e.containerDisplayName,y=e.getType,v=e.collect,b=e.options.arePropsEqual,O=void 0===b?c.default:b,m=t,D=t.displayName||t.name||"Component",_=function(e){function f(t){var r=e.call(this,t)||this;return r.decoratedRef=s.createRef(),r.handleChange=function(){var e=r.getCurrentState();c.default(e,r.state)||r.setState(e)},r.disposable=new p.SerialDisposable,r.receiveProps(t),r.dispose(),r}return o(f,e),f.prototype.getHandlerId=function(){return this.handlerId},f.prototype.getDecoratedComponentInstance=function(){return d.default(this.decoratedRef.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.decoratedRef.current},f.prototype.shouldComponentUpdate=function(e,t){return!O(e,this.props)||!c.default(t,this.state)},f.prototype.componentDidMount=function(){this.disposable=new p.SerialDisposable,this.currentType=void 0,this.receiveProps(this.props),this.handleChange()},f.prototype.componentDidUpdate=function(e){O(this.props,e)||(this.receiveProps(this.props),this.handleChange())},f.prototype.componentWillUnmount=function(){this.dispose()},f.prototype.receiveProps=function(e){this.handler&&(this.handler.receiveProps(e),this.receiveType(y(e)))},f.prototype.receiveType=function(e){if(this.handlerMonitor&&this.manager&&this.handlerConnector&&e!==this.currentType){this.currentType=e;var t=u(e,this.handler,this.manager),r=t[0],n=t[1];this.handlerId=r,this.handlerMonitor.receiveHandlerId(r),this.handlerConnector.receiveHandlerId(r);var o=this.manager.getMonitor().subscribeToStateChange(this.handleChange,{handlerIds:[r]});this.disposable.setDisposable(new p.CompositeDisposable(new p.Disposable(o),new p.Disposable(n)))}},f.prototype.dispose=function(){this.disposable.dispose(),this.handlerConnector&&this.handlerConnector.receiveHandlerId(null)},f.prototype.getCurrentState=function(){return this.handlerConnector?v(this.handlerConnector.hooks,this.handlerMonitor,this.props):{}},f.prototype.render=function(){var e=this;return s.createElement(l.DndContext.Consumer,null,function(t){var r=t.dragDropManager;return e.receiveDragDropManager(r),"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(function(){return e.handlerConnector.reconnect()}),s.createElement(m,i({},e.props,e.getCurrentState(),{ref:h.isRefable(m)?e.decoratedRef:null}))})},f.prototype.receiveDragDropManager=function(e){void 0===this.manager&&(d.default(void 0!==e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",D,D),void 0!==e&&(this.manager=e,this.handlerMonitor=n(e),this.handlerConnector=a(e.getBackend()),this.handler=r(this.handlerMonitor,this.decoratedRef)))},f.DecoratedComponent=t,f.displayName=g+"("+D+")",f}(s.Component);return f.default(_,t)}},function(e,t,r){"use strict";var n=r(67),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},u={};function s(e){return n.isMemo(e)?a:u[e.$$typeof]||o}u[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var c=Object.defineProperty,d=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,l=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(h){var o=p(r);o&&o!==h&&e(t,o,n)}var a=d(r);f&&(a=a.concat(f(r)));for(var u=s(t),g=s(r),y=0;y<a.length;++y){var v=a[y];if(!(i[v]||n&&n[v]||g&&g[v]||u&&u[v])){var b=l(r,v);try{c(t,v,b)}catch(e){}}}return t}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidType=function e(t,r){return"string"==typeof t||"symbol"==typeof t||!!r&&Array.isArray(t)&&t.every(function(t){return e(t,!1)})}},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(11)),n(r(56)),n(r(57))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(15)),n(r(33))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(34));t.createDragDropManager=function(e,t,r,n){var i=new o.default(n),a=e(i,t,r);return i.receiveBackend(a),i}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(35),i=n(r(37)),a=n(r(7)),u=n(r(49)),s=n(r(51));var c=function(){function e(e){var t=this;void 0===e&&(e=!1),this.isSetUp=!1,this.handleRefCountChange=function(){var e=t.store.getState().refCount>0;t.backend&&(e&&!t.isSetUp?(t.backend.setup(),t.isSetUp=!0):!e&&t.isSetUp&&(t.backend.teardown(),t.isSetUp=!1))};var r=function(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return o.createStore(i.default,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(e);this.store=r,this.monitor=new u.default(r,new s.default(r)),r.subscribe(this.handleRefCountChange)}return e.prototype.receiveBackend=function(e){this.backend=e},e.prototype.getMonitor=function(){return this.monitor},e.prototype.getBackend=function(){return this.backend},e.prototype.getRegistry=function(){return this.monitor.registry},e.prototype.getActions=function(){var e=this,t=this.store.dispatch;var r=a.default(this);return Object.keys(r).reduce(function(n,o){var i,a=r[o];return n[o]=(i=a,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=i.apply(e,r);void 0!==o&&t(o)}),n},{})},e.prototype.dispatch=function(e){this.store.dispatch(e)},e}();t.default=c},function(e,t,r){"use strict";r.r(t),r.d(t,"__DO_NOT_USE__ActionTypes",function(){return i}),r.d(t,"applyMiddleware",function(){return y}),r.d(t,"bindActionCreators",function(){return f}),r.d(t,"combineReducers",function(){return c}),r.d(t,"compose",function(){return g}),r.d(t,"createStore",function(){return u});var n=r(14),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function a(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,r){var o;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(u)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var s=e,c=t,d=[],f=d,l=!1;function p(){f===d&&(f=d.slice())}function h(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),f.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var r=f.indexOf(e);f.splice(r,1)}}}function y(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,c=s(c,e)}finally{l=!1}for(var t=d=f,r=0;r<t.length;r++){(0,t[r])()}return e}return y({type:i.INIT}),(o={dispatch:y,subscribe:g,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,y({type:i.REPLACE})}})[n.a]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(h())}return r(),{unsubscribe:t(r)}}})[n.a]=function(){return this},e},o}function s(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function c(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var a,u=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,o={},i=0;i<u.length;i++){var c=u[i],d=r[c],f=e[c],l=d(f,t);if(void 0===l){var p=s(c,t);throw new Error(p)}o[c]=l,n=n||l!==f}return n?o:e}}function d(e,t){return function(){return t(e.apply(this,arguments))}}function f(e,t){if("function"==typeof e)return d(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=d(o,t))}return r}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){l(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return h({},r,{dispatch:n=g.apply(void 0,i)(r.dispatch)})}}}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(38)),a=o(r(45)),u=o(r(46)),s=o(r(47)),c=o(r(48)),d=r(4);t.default=function(e,t){return void 0===e&&(e={}),{dirtyHandlerIds:s.default(e.dirtyHandlerIds,{type:t.type,payload:n(n({},t.payload),{prevTargetIds:d.get(e,"dragOperation.targetIds",[])})}),dragOffset:i.default(e.dragOffset,t),refCount:u.default(e.refCount,t),dragOperation:a.default(e.dragOperation,t),stateId:c.default(e.stateId)}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(17),a={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};t.default=function(e,t){void 0===e&&(e=a);var r=t.payload;switch(t.type){case o.INIT_COORDS:case o.BEGIN_DRAG:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case o.HOVER:return i.areCoordsEqual(e.clientOffset,r.clientOffset)?e:n(n({},e),{clientOffset:r.clientOffset});case o.END_DRAG:case o.DROP:return a;default:return e}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(40),a=r(4),u=r(2),s={type:u.INIT_COORDS,payload:{clientOffset:null,sourceClientOffset:null}};t.default=function(e){return function(t,r){void 0===t&&(t=[]),void 0===r&&(r={publishSource:!0});var n=r.publishSource,c=void 0===n||n,d=r.clientOffset,f=r.getSourceClientOffset,l=e.getMonitor(),p=e.getRegistry();e.dispatch(i.setClientOffset(d)),function(e,t,r){o.default(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){o.default(r.getSource(e),"Expected sourceIds to be registered.")})}(t,l,p);var h=function(e,t){for(var r=null,n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}(t,l);if(null!==h){var g=null;d&&(function(e){o.default("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(f),g=f(h)),e.dispatch(i.setClientOffset(d,g));var y=p.getSource(h).beginDrag(l,h);!function(e){o.default(a.isObject(e),"Item must be an object.")}(y),p.pinSource(h);var v=p.getSourceType(h);return{type:u.BEGIN_DRAG,payload:{itemType:v,item:y,sourceId:h,clientOffset:d||null,sourceClientOffset:g||null,isSourcePublic:!!c}}}e.dispatch(s)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.setClientOffset=function(e,t){return{type:n.INIT_COORDS,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(e){return function(){if(e.getMonitor().isDragging())return{type:n.PUBLISH_DRAG_SOURCE}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=n(r(16)),a=r(2);t.default=function(e){return function(t,r){var n=(void 0===r?{}:r).clientOffset;!function(e){o.default(Array.isArray(e),"Expected targetIds to be an array.")}(t);var u=t.slice(0),s=e.getMonitor(),c=e.getRegistry();return function(e,t,r){o.default(t.isDragging(),"Cannot call hover while not dragging."),o.default(!t.didDrop(),"Cannot call hover after drop.");for(var n=0;n<e.length;n++){var i=e[n];o.default(e.lastIndexOf(i)===n,"Expected targetIds to be unique in the passed array.");var a=r.getTarget(i);o.default(a,"Expected targetIds to be registered.")}}(u,s,c),function(e,t,r){for(var n=e.length-1;n>=0;n--){var o=e[n],a=t.getTargetType(o);i.default(a,r)||e.splice(n,1)}}(u,c,s.getItemType()),function(e,t,r){e.forEach(function(e){var n=r.getTarget(e);n.hover(t,e)})}(u,s,c),{type:a.HOVER,payload:{targetIds:u,clientOffset:n||null}}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(0)),a=r(2),u=r(4);t.default=function(e){return function(t){void 0===t&&(t={});var r=e.getMonitor(),o=e.getRegistry();!function(e){i.default(e.isDragging(),"Cannot call drop while not dragging."),i.default(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(r),function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(r).forEach(function(s,c){var d=function(e,t,r,n){var o=r.getTarget(e),a=o?o.drop(n,e):void 0;return function(e){i.default(void 0===e||u.isObject(e),"Drop result must either be an object or undefined.")}(a),void 0===a&&(a=0===t?{}:n.getDropResult()),a}(s,c,o,r),f={type:a.DROP,payload:{dropResult:n(n({},t),d)}};e.dispatch(f)})}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(2);t.default=function(e){return function(){var t=e.getMonitor(),r=e.getRegistry();!function(e){o.default(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var n=t.getSourceId();return r.getSource(n,!0).endDrag(t,n),r.unpinSource(),{type:i.END_DRAG}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(8),a=r(4),u={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};t.default=function(e,t){void 0===e&&(e=u);var r=t.payload;switch(t.type){case o.BEGIN_DRAG:return n(n({},e),{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case o.PUBLISH_DRAG_SOURCE:return n(n({},e),{isSourcePublic:!0});case o.HOVER:return n(n({},e),{targetIds:r.targetIds});case i.REMOVE_TARGET:return-1===e.targetIds.indexOf(r.targetId)?e:n(n({},e),{targetIds:a.without(e.targetIds,r.targetId)});case o.DROP:return n(n({},e),{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case o.END_DRAG:return n(n({},e),{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);t.default=function(e,t){switch(void 0===e&&(e=0),t.type){case n.ADD_SOURCE:case n.ADD_TARGET:return e+1;case n.REMOVE_SOURCE:case n.REMOVE_TARGET:return e-1;default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(8),i=r(17),a=r(18),u=r(4);t.default=function(e,t){switch(void 0===e&&(e=a.NONE),t.type){case n.HOVER:break;case o.ADD_SOURCE:case o.ADD_TARGET:case o.REMOVE_TARGET:case o.REMOVE_SOURCE:return a.NONE;case n.BEGIN_DRAG:case n.PUBLISH_DRAG_SOURCE:case n.END_DRAG:case n.DROP:default:return a.ALL}var r=t.payload,s=r.targetIds,c=void 0===s?[]:s,d=r.prevTargetIds,f=void 0===d?[]:d,l=u.xor(c,f);if(!(l.length>0)&&i.areArraysEqual(c,f))return a.NONE;var p=f[f.length-1],h=c[c.length-1];return p!==h&&(p&&l.push(p),h&&l.push(h)),l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e=0),e+1}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=n(r(16)),a=r(50),u=r(18),s=function(){function e(e,t){this.store=e,this.registry=t}return e.prototype.subscribeToStateChange=function(e,t){var r=this;void 0===t&&(t={handlerIds:void 0});var n=t.handlerIds;o.default("function"==typeof e,"listener must be a function."),o.default(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var i=this.store.getState().stateId;return this.store.subscribe(function(){var t=r.store.getState(),o=t.stateId;try{o===i||o===i+1&&!u.areDirty(t.dirtyHandlerIds,n)||e()}finally{i=o}})},e.prototype.subscribeToOffsetChange=function(e){var t=this;o.default("function"==typeof e,"listener must be a function.");var r=this.store.getState().dragOffset;return this.store.subscribe(function(){var n=t.store.getState().dragOffset;n!==r&&(r=n,e())})},e.prototype.canDragSource=function(e){if(!e)return!1;var t=this.registry.getSource(e);return o.default(t,"Expected to find a valid source."),!this.isDragging()&&t.canDrag(this,e)},e.prototype.canDropOnTarget=function(e){if(!e)return!1;var t=this.registry.getTarget(e);if(o.default(t,"Expected to find a valid target."),!this.isDragging()||this.didDrop())return!1;var r=this.registry.getTargetType(e),n=this.getItemType();return i.default(r,n)&&t.canDrop(this,e)},e.prototype.isDragging=function(){return Boolean(this.getItemType())},e.prototype.isDraggingSource=function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return o.default(t,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&(this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e))},e.prototype.isOverTarget=function(e,t){if(void 0===t&&(t={shallow:!1}),!e)return!1;var r=t.shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),o=this.getItemType();if(o&&!i.default(n,o))return!1;var a=this.getTargetIds();if(!a.length)return!1;var u=a.indexOf(e);return r?u===a.length-1:u>-1},e.prototype.getItemType=function(){return this.store.getState().dragOperation.itemType},e.prototype.getItem=function(){return this.store.getState().dragOperation.item},e.prototype.getSourceId=function(){return this.store.getState().dragOperation.sourceId},e.prototype.getTargetIds=function(){return this.store.getState().dragOperation.targetIds},e.prototype.getDropResult=function(){return this.store.getState().dragOperation.dropResult},e.prototype.didDrop=function(){return this.store.getState().dragOperation.didDrop},e.prototype.isSourcePublic=function(){return this.store.getState().dragOperation.isSourcePublic},e.prototype.getInitialClientOffset=function(){return this.store.getState().dragOffset.initialClientOffset},e.prototype.getInitialSourceClientOffset=function(){return this.store.getState().dragOffset.initialSourceClientOffset},e.prototype.getClientOffset=function(){return this.store.getState().dragOffset.clientOffset},e.prototype.getSourceClientOffset=function(){return a.getSourceClientOffset(this.store.getState().dragOffset)},e.prototype.getDifferenceFromInitialOffset=function(){return a.getDifferenceFromInitialOffset(this.store.getState().dragOffset)},e}();t.default=s},function(e,t,r){"use strict";function n(e,t){return{x:e.x+t.x,y:e.y+t.y}}function o(e,t){return{x:e.x-t.x,y:e.y-t.y}}Object.defineProperty(t,"__esModule",{value:!0}),t.add=n,t.subtract=o,t.getSourceClientOffset=function(e){var t=e.clientOffset,r=e.initialClientOffset,i=e.initialSourceClientOffset;return t&&r&&i?o(n(t,i),r):null},t.getDifferenceFromInitialOffset=function(e){var t=e.clientOffset,r=e.initialClientOffset;return t&&r?o(t,r):null}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(52)),i=n(r(0)),a=r(8),u=n(r(54)),s=r(15),c=r(55);function d(e){switch(e[0]){case"S":return s.HandlerRole.SOURCE;case"T":return s.HandlerRole.TARGET;default:i.default(!1,"Cannot parse handler ID: "+e)}}function f(e,t){var r=e.entries(),n=!1;do{var o=r.next(),i=o.done;if(o.value[1]===t)return!0;n=i}while(!n);return!1}var l=function(){function e(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}return e.prototype.addSource=function(e,t){c.validateType(e),c.validateSourceContract(t);var r=this.addHandler(s.HandlerRole.SOURCE,e,t);return this.store.dispatch(a.addSource(r)),r},e.prototype.addTarget=function(e,t){c.validateType(e,!0),c.validateTargetContract(t);var r=this.addHandler(s.HandlerRole.TARGET,e,t);return this.store.dispatch(a.addTarget(r)),r},e.prototype.containsHandler=function(e){return f(this.dragSources,e)||f(this.dropTargets,e)},e.prototype.getSource=function(e,t){return void 0===t&&(t=!1),i.default(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)},e.prototype.getTarget=function(e){return i.default(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)},e.prototype.getSourceType=function(e){return i.default(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)},e.prototype.getTargetType=function(e){return i.default(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)},e.prototype.isSourceId=function(e){return d(e)===s.HandlerRole.SOURCE},e.prototype.isTargetId=function(e){return d(e)===s.HandlerRole.TARGET},e.prototype.removeSource=function(e){var t=this;i.default(this.getSource(e),"Expected an existing source."),this.store.dispatch(a.removeSource(e)),o.default(function(){t.dragSources.delete(e),t.types.delete(e)})},e.prototype.removeTarget=function(e){i.default(this.getTarget(e),"Expected an existing target."),this.store.dispatch(a.removeTarget(e)),this.dropTargets.delete(e),this.types.delete(e)},e.prototype.pinSource=function(e){var t=this.getSource(e);i.default(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t},e.prototype.unpinSource=function(){i.default(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null},e.prototype.addHandler=function(e,t,r){var n=function(e){var t=u.default().toString();switch(e){case s.HandlerRole.SOURCE:return"S"+t;case s.HandlerRole.TARGET:return"T"+t;default:throw new Error("Unknown Handler Role: "+e)}}(e);return this.types.set(n,t),e===s.HandlerRole.SOURCE?this.dragSources.set(n,r):e===s.HandlerRole.TARGET&&this.dropTargets.set(n,r),n},e}();t.default=l},function(e,t,r){"use strict";var n=r(53),o=[],i=[],a=n.makeRequestCallFromTimer(function(){if(i.length)throw i.shift()});function u(e){var t;(t=o.length?o.pop():new s).task=e,n(t)}function s(){this.task=null}e.exports=u,s.prototype.call=function(){try{this.task.call()}catch(e){u.onerror?u.onerror(e):(i.push(e),a())}finally{this.task=null,o[o.length]=this}}},function(e,t,r){"use strict";(function(t){function r(e){o.length||(n(),!0),o[o.length]=e}e.exports=r;var n,o=[],i=0,a=1024;function u(){for(;i<o.length;){var e=i;if(i+=1,o[e].call(),i>a){for(var t=0,r=o.length-i;t<r;t++)o[t]=o[t+i];o.length-=i,i=0}}o.length=0,i=0,!1}var s,c,d,f=void 0!==t?t:self,l=f.MutationObserver||f.WebKitMutationObserver;function p(e){return function(){var t=setTimeout(n,0),r=setInterval(n,50);function n(){clearTimeout(t),clearInterval(r),e()}}}"function"==typeof l?(s=1,c=new l(u),d=document.createTextNode(""),c.observe(d,{characterData:!0}),n=function(){s=-s,d.data=s}):n=p(u),r.requestFlush=n,r.makeRequestCallFromTimer=p}).call(this,r(12))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.default=function(){return n++}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0));t.validateSourceContract=function(e){o.default("function"==typeof e.canDrag,"Expected canDrag to be a function."),o.default("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),o.default("function"==typeof e.endDrag,"Expected endDrag to be a function.")},t.validateTargetContract=function(e){o.default("function"==typeof e.canDrop,"Expected canDrop to be a function."),o.default("function"==typeof e.hover,"Expected hover to be a function."),o.default("function"==typeof e.drop,"Expected beginDrag to be a function.")},t.validateType=function e(t,r){r&&Array.isArray(t)?t.forEach(function(t){return e(t,!1)}):o.default("string"==typeof t||"symbol"==typeof t,r?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}},function(e,t,r){"use strict";(function(e){var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(1)),a=r(1),u=r(11);t.DndProvider=a.memo(function(t){var r=t.children,o=n(t,["children"]),a="manager"in o?{dragDropManager:o.manager}:function(t,r,n,o){void 0===r&&(r=void 0!==e?e:window);var i=r;i[s]||(i[s]=u.createDndContext(t,r,n,o));return i[s]}(o.backend,o.context,o.options,o.debugMode);return i.createElement(u.DndContext.Provider,{value:a},r)});var s=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__")}).call(this,r(12))},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1));t.DragPreviewImage=o.memo(function(e){var t=e.connect,r=e.src;if("undefined"!=typeof Image){var n=new Image;n.src=r,n.onload=function(){return t(n)}}return null}),t.DragPreviewImage.displayName="DragPreviewImage"},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(59)),n(r(62)),n(r(64))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(19),u=r(60);t.useDrag=function(e){var t=o.useRef(e);t.current=e,i.default(null!=e.item,"item must be defined"),i.default(null!=e.item.type,"item type must be defined");var r=u.useDragSourceMonitor(),n=r[0],s=r[1];u.useDragHandler(t,n,s);var c=a.useMonitorOutput(n,t.current.collect||function(){return{}},function(){return s.reconnect()}),d=o.useMemo(function(){return s.hooks.dragSource()},[s]),f=o.useMemo(function(){return s.hooks.dragPreview()},[s]);return o.useLayoutEffect(function(){s.dragSourceOptions=t.current.options||null,s.reconnect()},[s]),o.useLayoutEffect(function(){s.dragPreviewOptions=t.current.previewOptions||null,s.reconnect()},[s]),[c,d,f]}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(9),u=r(13),s=r(21),c=r(22);t.useDragSourceMonitor=function(){var e=u.useDragDropManager();return[o.useMemo(function(){return new s.DragSourceMonitorImpl(e)},[e]),o.useMemo(function(){return new c.SourceConnector(e.getBackend())},[e])]},t.useDragHandler=function(e,t,r){var n=u.useDragDropManager(),s=o.useMemo(function(){return{beginDrag:function(){var r=e.current,n=r.begin,o=r.item;if(n){var a=n(t);return i.default(null==a||"object"==typeof a,"dragSpec.begin() must either return an object, undefined, or null"),a||o||{}}return o||{}},canDrag:function(){return"boolean"==typeof e.current.canDrag?e.current.canDrag:"function"!=typeof e.current.canDrag||e.current.canDrag(t)},isDragging:function(r,n){var o=e.current.isDragging;return o?o(t):n===r.getSourceId()},endDrag:function(){var n=e.current.end;n&&n(t.getItem(),t),r.reconnect()}}},[]);o.useLayoutEffect(function(){var o=a.registerSource(e.current.item.type,s,n),i=o[0],u=o[1];return t.receiveHandlerId(i),r.receiveHandlerId(i),u},[])}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0));function a(e,t){"function"==typeof e?e(t):e.current=t}t.cloneWithRef=function(e,t){var r=e.ref;return i.default("string"!=typeof r,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),r?o.cloneElement(e,{ref:function(e){a(t,e),r&&a(r,e)}}):o.cloneElement(e,{ref:t})}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(19),u=r(63);t.useDrop=function(e){var t=o.useRef(e);t.current=e,i.default(null!=e.accept,"accept must be defined");var r=u.useDropTargetMonitor(),n=r[0],s=r[1];u.useDropHandler(t,n,s);var c=a.useMonitorOutput(n,t.current.collect||function(){return{}},function(){return s.reconnect()}),d=o.useMemo(function(){return s.hooks.dropTarget()},[s]);return o.useLayoutEffect(function(){s.dropTargetOptions=e.options||null,s.reconnect()},[e.options]),[c,d]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(13),a=r(25),u=r(26);t.useDropTargetMonitor=function(){var e=i.useDragDropManager();return[n.useMemo(function(){return new u.DropTargetMonitorImpl(e)},[e]),n.useMemo(function(){return new a.TargetConnector(e.getBackend())},[e])]},t.useDropHandler=function(e,t,r){var a=i.useDragDropManager(),u=n.useMemo(function(){return{canDrop:function(){var r=e.current.canDrop;return!r||r(t.getItem(),t)},hover:function(){var r=e.current.hover;r&&r(t.getItem(),t)},drop:function(){var r=e.current.drop;if(r)return r(t.getItem(),t)}}},[t]);n.useLayoutEffect(function(){var n=o.registerTarget(e.current.accept,u,a),i=n[0],s=n[1];return t.receiveHandlerId(i),r.receiveHandlerId(i),s},[t,r])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(13),i=r(20);t.useDragLayer=function(e){var t=o.useDragDropManager().getMonitor(),r=i.useCollector(t,e),a=r[0],u=r[1];return n.useEffect(function(){return t.subscribeToOffsetChange(u)}),n.useEffect(function(){return t.subscribeToStateChange(u)}),a}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(66)),n(r(71)),n(r(73))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(3),a=r(5),u=n(r(27)),s=r(9),c=r(21),d=r(22),f=r(29),l=n(r(70));t.DragSource=function(e,t,r,n){void 0===n&&(n={}),a.checkDecoratorArguments("DragSource","type, spec, collect[, options]",e,t,r,n);var p=e;"function"!=typeof e&&(o.default(f.isValidType(e),'Expected "type" provided as the first argument to DragSource to be a string, or a function that returns a string given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',e),p=function(){return e}),o.default(i.isPlainObject(t),'Expected "spec" provided as the second argument to DragSource to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',t);var h=l.default(t);return o.default("function"==typeof r,'Expected "collect" provided as the third argument to DragSource to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',r),o.default(i.isPlainObject(n),'Expected "options" provided as the fourth argument to DragSource to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',r),function(e){return u.default({containerDisplayName:"DragSource",createHandler:h,registerHandler:s.registerSource,createConnector:function(e){return new d.SourceConnector(e)},createMonitor:function(e){return new c.DragSourceMonitorImpl(e)},DecoratedComponent:e,getType:p,collect:r,options:n})}}},function(e,t,r){"use strict";e.exports=r(68)},function(e,t,r){"use strict";
/** @license React v16.8.6
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,u=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,d=n?Symbol.for("react.context"):60110,f=n?Symbol.for("react.async_mode"):60111,l=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,h=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case f:case l:case a:case s:case u:case h:return e;default:switch(e=e&&e.$$typeof){case d:case p:case c:return e;default:return t}}case y:case g:case i:return t}}}function b(e){return v(e)===l}t.typeOf=v,t.AsyncMode=f,t.ConcurrentMode=l,t.ContextConsumer=d,t.ContextProvider=c,t.Element=o,t.ForwardRef=p,t.Fragment=a,t.Lazy=y,t.Memo=g,t.Portal=i,t.Profiler=s,t.StrictMode=u,t.Suspense=h,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===l||e===s||e===u||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===g||e.$$typeof===c||e.$$typeof===d||e.$$typeof===p)},t.isAsyncMode=function(e){return b(e)||v(e)===f},t.isConcurrentMode=b,t.isContextConsumer=function(e){return v(e)===d},t.isContextProvider=function(e){return v(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return v(e)===p},t.isFragment=function(e){return v(e)===a},t.isLazy=function(e){return v(e)===y},t.isMemo=function(e){return v(e)===g},t.isPortal=function(e){return v(e)===i},t.isProfiler=function(e){return v(e)===s},t.isStrictMode=function(e){return v(e)===u},t.isSuspense=function(e){return v(e)===h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=function(){function e(e){this.isDisposed=!1,this.action=n.isFunction(e)?e:n.noop}return e.isDisposable=function(e){return e&&n.isFunction(e.dispose)},e._fixup=function(t){return e.isDisposable(t)?t:e.empty},e.create=function(t){return new e(t)},e.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)},e.empty={dispose:n.noop},e}();t.Disposable=o;var i=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isDisposed=!1,this.disposables=e}return e.prototype.add=function(e){this.isDisposed?e.dispose():this.disposables.push(e)},e.prototype.remove=function(e){var t=!1;if(!this.isDisposed){var r=this.disposables.indexOf(e);-1!==r&&(t=!0,this.disposables.splice(r,1),e.dispose())}return t},e.prototype.clear=function(){if(!this.isDisposed){for(var e=this.disposables.length,t=new Array(e),r=0;r<e;r++)t[r]=this.disposables[r];this.disposables=[];for(r=0;r<e;r++)t[r].dispose()}},e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var e=this.disposables.length,t=new Array(e),r=0;r<e;r++)t[r]=this.disposables[r];this.disposables=[];for(r=0;r<e;r++)t[r].dispose()}},e}();t.CompositeDisposable=i;var a=function(){function e(){this.isDisposed=!1}return e.prototype.getDisposable=function(){return this.current},e.prototype.setDisposable=function(e){var t=this.isDisposed;if(!t){var r=this.current;this.current=e,r&&r.dispose()}t&&e&&e.dispose()},e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var e=this.current;this.current=void 0,e&&e.dispose()}},e}();t.SerialDisposable=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=(r(3),r(5)),a=["canDrag","beginDrag","isDragging","endDrag"],u=["beginDrag"],s=function(){function e(e,t,r){var n=this;this.props=null,this.beginDrag=function(){if(n.props)return n.spec.beginDrag(n.props,n.monitor,n.ref.current)},this.spec=e,this.monitor=t,this.ref=r}return e.prototype.receiveProps=function(e){this.props=e},e.prototype.canDrag=function(){return!!this.props&&(!this.spec.canDrag||this.spec.canDrag(this.props,this.monitor))},e.prototype.isDragging=function(e,t){return!!this.props&&(this.spec.isDragging?this.spec.isDragging(this.props,this.monitor):t===e.getSourceId())},e.prototype.endDrag=function(){this.props&&this.spec.endDrag&&this.spec.endDrag(this.props,this.monitor,i.getDecoratedComponent(this.ref))},e}();t.default=function(e){return Object.keys(e).forEach(function(t){o.default(a.indexOf(t)>-1,'Expected the drag source specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',a.join(", "),t),o.default("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])}),u.forEach(function(t){o.default("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])}),function(t,r){return new s(e,t,r)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(3),a=r(9),u=r(29),s=r(25),c=r(26),d=r(5),f=n(r(27)),l=n(r(72));t.DropTarget=function(e,t,r,n){void 0===n&&(n={}),d.checkDecoratorArguments("DropTarget","type, spec, collect[, options]",e,t,r,n);var p=e;"function"!=typeof e&&(o.default(u.isValidType(e,!0),'Expected "type" provided as the first argument to DropTarget to be a string, an array of strings, or a function that returns either given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',e),p=function(){return e}),o.default(i.isPlainObject(t),'Expected "spec" provided as the second argument to DropTarget to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',t);var h=l.default(t);return o.default("function"==typeof r,'Expected "collect" provided as the third argument to DropTarget to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',r),o.default(i.isPlainObject(n),'Expected "options" provided as the fourth argument to DropTarget to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',r),function(e){return f.default({containerDisplayName:"DropTarget",createHandler:h,registerHandler:a.registerTarget,createMonitor:function(e){return new c.DropTargetMonitorImpl(e)},createConnector:function(e){return new s.TargetConnector(e)},DecoratedComponent:e,getType:p,collect:r,options:n})}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=(r(3),r(5)),a=["canDrop","hover","drop"],u=function(){function e(e,t,r){this.props=null,this.spec=e,this.monitor=t,this.ref=r}return e.prototype.receiveProps=function(e){this.props=e},e.prototype.receiveMonitor=function(e){this.monitor=e},e.prototype.canDrop=function(){return!this.spec.canDrop||this.spec.canDrop(this.props,this.monitor)},e.prototype.hover=function(){this.spec.hover&&this.spec.hover(this.props,this.monitor,i.getDecoratedComponent(this.ref))},e.prototype.drop=function(){if(this.spec.drop)return this.spec.drop(this.props,this.monitor,this.ref.current)},e}();t.default=function(e){return Object.keys(e).forEach(function(t){o.default(a.indexOf(t)>-1,'Expected the drop target specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',a.join(", "),t),o.default("function"==typeof e[t],"Expected %s in the drop target specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target",t,t,e[t])}),function(t,r){return new u(e,t,r)}}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(1)),c=u(r(6)),d=u(r(28)),f=u(r(0)),l=r(10),p=r(3),h=r(5);t.DragLayer=function(e,t){return void 0===t&&(t={}),h.checkDecoratorArguments("DragLayer","collect[, options]",e,t),f.default("function"==typeof e,'Expected "collect" provided as the first argument to DragLayer to be a function that collects props to inject into the component. ',"Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer",e),f.default(p.isPlainObject(t),'Expected "options" provided as the second argument to DragLayer to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer',t),function(r){var n=r,a=t.arePropsEqual,u=void 0===a?c.default:a,p=n.displayName||n.name||"Component",g=function(t){function a(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCurrentlyMounted=!1,e.ref=s.createRef(),e.handleChange=function(){if(e.isCurrentlyMounted){var t=e.getCurrentState();c.default(t,e.state)||e.setState(t)}},e}return o(a,t),a.prototype.getDecoratedComponentInstance=function(){return f.default(this.ref.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.ref.current},a.prototype.shouldComponentUpdate=function(e,t){return!u(e,this.props)||!c.default(t,this.state)},a.prototype.componentDidMount=function(){this.isCurrentlyMounted=!0,this.handleChange()},a.prototype.componentWillUnmount=function(){this.isCurrentlyMounted=!1,this.unsubscribeFromOffsetChange&&(this.unsubscribeFromOffsetChange(),this.unsubscribeFromOffsetChange=void 0),this.unsubscribeFromStateChange&&(this.unsubscribeFromStateChange(),this.unsubscribeFromStateChange=void 0)},a.prototype.render=function(){var e=this;return s.createElement(l.DndContext.Consumer,null,function(t){var r=t.dragDropManager;return void 0===r?null:(e.receiveDragDropManager(r),e.isCurrentlyMounted?s.createElement(n,i({},e.props,e.state,{ref:h.isRefable(n)?e.ref:null})):null)})},a.prototype.receiveDragDropManager=function(e){if(void 0===this.manager){this.manager=e,f.default("object"==typeof e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",p,p);var t=this.manager.getMonitor();this.unsubscribeFromOffsetChange=t.subscribeToOffsetChange(this.handleChange),this.unsubscribeFromStateChange=t.subscribeToStateChange(this.handleChange)}},a.prototype.getCurrentState=function(){if(!this.manager)return{};var t=this.manager.getMonitor();return e(t,this.props)},a.displayName="DragLayer("+p+")",a.DecoratedComponent=r,a}(s.Component);return d.default(g,r)}}}])});
define("@ms/utilities-react-drag-drop/lib/drop-target/DropTargetWrapper",["require","exports","tslib","react","react","react-dnd","react-dom"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.injectDropTargetProps=function(e,t){var r={drop:function(t,n,r){var i=String(n.getItemType());if(i&&e[i]){var s=e[i];if(s&&s.onDropHandler)return s.onDropHandler({draggedItem:n.getItem(),dragSourceKey:n.getItem().dragSourceKey,dropTargetKey:t.dropTargetKey,dragItemType:i,didDrop:n.didDrop()})}return{dropTargetKey:t.dropTargetKey}},hover:function(t,n,r){var i,s=String(n.getItemType());if(r&&s&&e[s]){var u=e[s];i=o.findDOMNode(r);var a=n.getClientOffset();return u&&u.onHoverHandler?u.onHoverHandler({hoveredOnItemKey:t.dropTargetKey,dragItemType:s,componentNode:i,draggedItem:n.getItem(),clientOffset:a?{x:a.x,y:a.y}:null}):void 0}}};return s.DropTarget(Object.keys(e),r,function(e,r,i){return n.__assign(n.__assign({},t(r)),{connectDropTarget:e.dropTarget()})})};t.withDropTargetWrapper=function(e){return(function(t){n.__extends(i,t);function i(e){return t.call(this,e)||this}i.prototype.render=function(){var t=this.props.connectDropTarget,i=e,s=r.createElement("div",null,r.createElement(i,n.__assign({},this.props)));if(t){var o=t(s);if(o)return o}return s};return i})(r.PureComponent)};t.getDropTargetHandlers=function(e,t){return{onDropHandler:e,onHoverHandler:t}};function u(e){var t=e.acceptType,n=e.dropTargetKey,r=e.handlers,i=r.onDropHandler,s=r.onHoverHandler,o=r.canDropHandler;return{accept:t,drop:function(e,t){i&&i({draggedItem:e,dragSourceKey:e.dragSourceKey,dropTargetKey:n,dragItemType:String(t.getItemType()),didDrop:t.didDrop()});return{dropTargetKey:n}},hover:function(e,t){if(s){var r=t.getClientOffset();s({hoveredOnItemKey:n,dragItemType:String(t.getItemType()),draggedItem:t.getItem(),clientOffset:r?{x:r.x,y:r.y}:null})}},canDrop:function(e,t){return!!o&&o({draggedItem:e,dragItemType:String(t.getItemType())})},collect:function(e){return{isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0}),canDrop:e.canDrop(),didDrop:e.didDrop(),itemType:String(e.getItemType())}}}}t.useDropSpec=u;t.DropTargetHookWrapper=function(e){var t=e.hookCallback,n=u(e),o=s.useDrop(n),a=o[0],f=o[1];i.useEffect(function(){f&&t({collectedProps:a,connectDropTarget:f})},[a,f]);return e.children?r.createElement(r.Fragment,null,e.children):null}});
define("@ms/utilities-react-drag-drop/lib/drag-source/DragSourceWrapper",["require","exports","tslib","react","react","react-dnd","react-dnd-html5-backend","office-ui-fabric-react/lib/Icon","ODCItemsScopeDeferred_css","@uifabric/utilities/lib/css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";a=a.DragSourceWrapper_8;Object.defineProperty(t,"__esModule",{value:!0});t.injectDragSourceProps=function(e,t){var r={beginDrag:function(e,t,n){if(!e)throw new Error("DragSourceWrapper component Props should not be null or undefined");var r={dragSourceKey:e.dragSourceKey};return e.onBeginDrag?e.onBeginDrag(r):r},endDrag:function(e,t,n){e&&e.onEndDrag&&e.onEndDrag({dragSourceKey:e.dragSourceKey,dropResult:t.getDropResult(),didDrop:t.didDrop(),draggedItem:t.getItem()})}};return s.DragSource(e,r,function(e,r,i){return n.__assign(n.__assign({},t(r)),{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:r.isDragging()})})};t.withDragSourceWrapper=function(e){return(function(t){n.__extends(i,t);function i(e){return t.call(this,e)||this}i.prototype.render=function(){var t,i=this.props,s=i.connectDragSource,o=i.isDragging,l=i.connectDragPreview,c=i.dragHintIconClassName,h=i.dragStartRootOverrideClassName,p=i.dragPreviewElementRef,d=i.dragHintIconName,v=e;if(s){t=s(r.createElement("div",{className:f.css(a.msRoot,o?h||a.msDragStart:"")},r.createElement(u.Icon,{iconName:d||"GripperBarVertical",className:f.css(c||a.msDragIcon,o?a.isVisible:"")}),r.createElement("div",{className:a.msDragSrouceContainer},r.createElement(v,n.__assign({},this.props)))));l&&l(p&&p.current?p.current:t,{captureDraggingState:!0})}return t||r.createElement("div",null,r.createElement(v,n.__assign({},this.props)))};return i})(r.PureComponent)};function l(e){var t=e.dragSourceKey,n=e.type,r=e.handlers,i=r.onBeginHandler,s=r.onEndHandler,o=r.canDragHandler;return{item:{dragSourceKey:t,type:n},collect:function(e){return{isDragging:e.isDragging(),canDrag:e.canDrag()}},begin:function(e){if(i)return i({draggedItem:e.getItem(),dragItemType:String(e.getItemType())})},end:function(e,t){s&&s({draggedItem:t.getItem(),dragItemType:String(t.getItemType())})},canDrag:function(e){return!!o&&o({draggedItem:e.getItem(),dragItemType:String(e.getItemType())})}}}t.useDragSpec=l;t.DragSourceHookWrapper=function(e){var t=e.hookCallback,n=e.showDefaultDragPreview,u=l(e),a=s.useDrag(u),f=a[0],c=a[1],h=a[2];i.useEffect(function(){c&&t({collectedProps:f,connectDragSource:c})},[f,c,h]);i.useEffect(function(){h&&!n&&h(o.getEmptyImage(),{captureDraggingState:!0})},[]);return e.children?r.createElement(r.Fragment,null,e.children):null};t.DragLayerHookWrapper=function(e){var t=e.dragSourceKey,n=void 0===t?"":t,o=e.type,u=void 0===o?"":o,f=e.children,l=e.as,h=void 0===l?"div":l,p=e.getItemStyles,d=void 0===p?c:p,v=s.useDragLayer(function(e){return{isDragging:e.isDragging(),item:e.getItem(),itemType:String(e.getItemType()),initialOffset:e.getInitialClientOffset(),currentOffset:e.getClientOffset(),initialSourceOffset:e.getInitialSourceClientOffset(),currentSourceOffset:e.getSourceClientOffset()}}),m=i.useRef(null),g=v.isDragging,y=v.item,b=v.itemType,w=v.initialOffset,E=v.currentOffset,S=v.initialSourceOffset,x=v.currentSourceOffset;if(!g||!y||y.dragSourceKey!==n||b!==u)return null;var T=d(w,E,S,x,m.current),N=f?r.cloneElement(f,{draggedItem:y}):null;return r.createElement(h,{className:a.dragLayerRoot,ref:m},r.createElement("div",{style:T},N))};function c(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+(a-=n.x)+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}});
define("@ms/items-view/lib/private/components/reactDragDrop/DragLayerPreview",["require","exports","react","@ms/utilities-strings/lib/index","@uifabric/file-type-icons/lib/index","./DragDropWrapper.resx","ODCItemsScopeDeferred_css","../itemFileTypeIcon/ItemFileTypeIcon","../../controls/dragLayerPreviewControl","../withItemCache/WithItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";o=o.DragLayerPreview_5;Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){var t=e.draggedItem,a=t.dragSourceKey,f=t.itemKeys,l=void 0===f?[]:f,c=l[0]||a,h=l.length>0?l.length:a?1:0,p="",d=null;if(h<1)return null;p=r.format(r.getLocalizedCountValue(s.default.dragMoveItemsPreviewText,s.default.dragMoveItemsPreviewTextIntervals,h)||"",h);d=1===h?n.createElement(u.ItemFileTypeIcon,{itemKey:c,size:20,className:o.dragPreviewIcon}):n.createElement(u.FileTypeIcon,{type:i.FileIconType.genericFile,size:20,className:o.dragPreviewIcon});return p?n.createElement("div",{className:o.dragPreviewRoot},d||null,n.createElement("span",{className:o.dragPreviewText},p)):null};t.DragLayerPreview=n.memo(function(e){var t=e.draggedItem,r=n.useCallback(function(e){var r=e.itemCache;if(!t)return null;var i=t.dragSourceKey,s=t.itemKeys,o=s||[i],u=r.demandItemFacet(a.dragLayerPreviewControl,i),f=a.dragLayerPreviewControl.evaluate(u)(r,{itemKeys:o,dragLayerPreviewRenderer:l}).dragLayerPreviewRenderer;return n.createElement(f,{draggedItem:t})},[t?t.dragSourceKey:void 0]);return n.createElement(f.WithItemCache,null,r)})});
define("@ms/items-view/lib/private/controls/dragLayerPreviewControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dragLayerPreviewControl=new n.ControlFacet("dragLayerPreviewControl",{dragLayerPreviewRenderer:r.defaultRenderComponentOption()})});
define("@ms/utilities-react-drag-drop/lib/drag-drop/DragDropWrapper",["require","exports","react","react","react-dnd","../drag-source/DragSourceWrapper","../drop-target/DropTargetWrapper","react-dnd-html5-backend"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragDropHookWrapper=function(e){var t=e.dragDropKey,a=e.dragType,f=e.acceptType,l=e.showDefaultDragPreview,c=e.hookCallback,h=e.handlers,p=!!h.canDragHandler,d=s.useDragSpec({dragSourceKey:t,type:a,handlers:h}),v=i.useDrag(d),m=v[0],g=v[1],y=v[2];r.useEffect(function(){p&&y&&!l&&y(u.getEmptyImage(),{captureDraggingState:!0})},[p,y,l]);var b=o.useDropSpec({acceptType:f,dropTargetKey:t,handlers:h}),w=i.useDrop(b),E=w[0],S=w[1];r.useEffect(function(){c({collectedDragProps:m,collectedDropProps:E,connectDragSource:g,connectDropTarget:S})},[m,E,g,y,S]);return e.children?n.createElement(n.Fragment,null,e.children):null}});
define("@ms/items-view/lib/private/components/itemAutoRefresh/ItemAutoRefresh",["require","exports","react","../decorators/selectors","../decorators/connectToItemCache","../../controls/itemAutoRefreshControl"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e.subscribe;n.useLayoutEffect(function(){return t()},[t]);return null}t.ItemAutoRefresh=i.createItemCacheComponent(function(e,t){var r=t.itemKey,i=e.demandItemFacet(s.itemAutoRefreshControl,r),u=s.itemAutoRefreshControl.evaluate(i)(e,{itemKey:r,itemSubscriber:null}),a=u.isAvailable,f=u.itemSubscriber,l=u.subscribe;return a?f||(l?n.createElement(o,{subscribe:l}):null):null});t.CurrentItemAutoRefresh=r.withCurrentItemSet()(t.ItemAutoRefresh)});
define("@ms/items-view/lib/private/controls/itemAutoRefreshControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAutoRefreshControl=new n.ControlFacet("itemAutoRefreshControl")});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../models/store/ItemsStore","../../../providers/item/ItemProvider","@ms/items-view/lib/private/models/items/getItemSetKey","../../../models/itemsScope/facets/OneDriveItemFacet","../../../models/itemCache/ItemCacheObservable","@ms/items-view/lib/private/facets/SetFacets","../../../models/itemsScope/ItemsScopeManager.key","../../../models/item/OneDriveItem","../../../models/itemSet/ItemSet","../../../models/item/ItemType","@ms/items-view/lib/private/facets/ScopeFacets","@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/facets/GroupToCountFacets","@ms/items-view-addon-photos/lib/models/keys/AllGroupToCountsItemKeyFacet","@ms/items-view-addon-photos/lib/models/keys/GroupKeyFacet","@ms/items-view-addon-photos/lib/models/keys/GroupPageKeyFacet","../../../dataSources/url/QueryType","./ItemCacheToKOUtils","../../../dataSources/url/odc/UrlRouting","../../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","@ms/items-view-addon-photos/lib/util/neighboringPageResolver","../../../pages/files/UseItemCacheData.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=[],O={defc:"1"},M={suppressGetItems:!0},_=(function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._store=n.itemsStore;r._itemsScopeItemKeyToKOItemKeyMap={};r._itemProvider=n.itemProvider;r._useItemCacheData=r.resources.consume(L.resourceKey);var i=n.itemCacheObservablesFactory;r._itemsScopeManager=n.itemsScopeManager;r._childKOItems=r.addDisposable(i.pureCompute(function(e){return r._computeChildKOItems(e)}));r._childKOItems.equalityComparer=s.objectStrictEquality;r.koItem=r.addDisposable(i.pureCompute(function(e){return r._computeKOItem(e)}));r.koItem.equalityComparer=s.objectStrictEquality;r.koItemSet=r.addDisposable(i.pureCompute(function(e){return r._computeKOItemSet(e)}));r.koItemSet.equalityComparer=s.objectStrictEquality;r.focusedKOItem=r.addDisposable(i.pureCompute(function(e){return r._computeFocusedKOItem(e)}));r.focusedKOItem.equalityComparer=s.objectStrictEquality;r._selectedItemKeys=r.addDisposable(i.pureCompute(function(e){return r._computeSelectedItemKeys(e)}));r._selectedItemKeys.equalityComparer=s.objectStrictEquality;r.selectedKOItemKeys=r.observables.pureCompute(r._computeSelectedKOItemKeys);return r}t.prototype._computeKOItem=function(e){var t=this._getCurrentItemSetKey(e),n=e.demandItemFacet(c.parentItemFacet,t),r=n&&n.itemKey,i=e.demandItemFacet(f.oneDriveItemFacet,r);if(i&&r)this._itemsScopeItemKeyToKOItemKeyMap[r]=i.key;else{var s=new p.default;s.type=v.default.Folder;if(g.photosRootItemSetKeyFacet.matches(t)){var o=g.photosRootItemSetKeyFacet.deserialize(t),u=o.filter,a=o.filterType;s.type=v.default.Shortcut;s.isRootFolder=!0;s.key=this.createKoItemKey(u,a);s.queryType=S.default.AllMyPhotos;s.properties.commandsSupported=O;s.isPlaceholder=!0}i=s}return i};t.prototype._computeChildKOItems=function(e){var t=this._getCurrentItemSetKey(e),n=[];t&&(g.photosRootItemSetKeyFacet.matches(t)?this._useItemCacheData()&&this._computeResolvedPhotosChildKOItems(e,t,n):this._computeResolvedChildKOItems(e,t,n));return n};t.prototype._computeResolvedChildKOItems=function(e,t,n){var r=e.demandItemFacet(c.childItemsFacet,t);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(f.oneDriveItemFacet,o);if(u){n.push(u);this._itemsScopeItemKeyToKOItemKeyMap[o]=u.key}}};t.prototype._computeResolvedPhotosChildKOItems=function(e,t,n){var r,i=e.demandItemFacet(c.childItemsFacet,t,M);if(g.photosRootItemSetKeyFacet.matches(t)){var s=b.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:g.photosRootItemSetKeyFacet.deserialize(t)});r=e.demandItemFacet(y.allGroupToCountsFacet,s,M)}var o=0;if(i&&r)for(var u=0,a=i.itemKeys;u<a.length;u++){var f=a[u];if(w.groupKeyFacet.matches(f)){if(e.isItemFacetResolved(c.childItemsFacet,f)){var l=e.demandItemFacet(c.childItemsFacet,f,M);if(l)for(var h=0,p=l.itemKeys;h<p.length;h++){var d=p[h];if(E.groupPageKeyFacet.matches(d)){var v=e.demandItemFacet(E.groupPageKeyFacet,d,M);if(v)for(var m=0;m<v.count;m++)n.push(void 0)}else{var S=x.demandResolvedAllPhotoRecord(e,d);if(S){n.indexOf(S)<0&&!this._itemsScopeItemKeyToKOItemKeyMap[d]&&(this._itemsScopeItemKeyToKOItemKeyMap[d]=S.key);n.push(S)}}}}else{var T=r[o];for(m=0;m<T.count;m++)n.push(void 0)}o++}}};t.prototype._computeSelectedItemKeys=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=e.demandItemFacet(m.selectedItemsFacet,t);return n&&n.itemKeys||[]};t.prototype._computeSelectedKOItemKeys=function(){var e=this._itemsScopeItemKeyToKOItemKeyMap;this.koItemSet();return this._selectedItemKeys().map(function(t){return e[t]})};t.prototype._computeKOItemSet=function(e){var t=this.koItem();if(t.key){this._store.setItem(t,t.key);var n=t.key,r=this._itemProvider.getItemSync({parentKey:n}),i=this._getAndStoreChildKOItems(),s=this._getCurrentItemSetKey(e),o=void 0;if(g.photosRootItemSetKeyFacet.matches(s)){var u=b.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:g.photosRootItemSetKeyFacet.deserialize(s)});o=e.demandItemFacet(y.allGroupsTotalCountFacet,u,M)}this._updateItemSet(r,i,o);return r}var a=new d.default;a.item=this.observables.create(t);return a};t.prototype._computeFocusedKOItem=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=this._getCurrentItemSetKey(e);if(g.photosRootItemSetKeyFacet.matches(n)){var r=e.demandItemFacet(N.currentViewParamsFacet,t,M);if(r&&(r.parId||r.parQt||r.parCid)){var i=g.photosRootItemSetKeyFacet.deserialize(n).photosRootKeyPart,s=C.driveItemKeyFacet.serialize({endpoint:i.endpoint,driveId:i.driveId,itemId:r.id}),o=x.demandResolvedAllPhotoRecord(e,s);k.resolveNeighboringPages(e,n,s,3);return o}}};t.prototype._getAndStoreChildKOItems=function(){var e=this;return this._childKOItems().map(function(t){if(t){e._store.setItem(t,t.key);return e._store.getItem(t.key)}})};t.prototype._updateItemSet=function(e,t,n){e.isPlaceholder=!1;var r=n||t.length,i=new Array(r),s=0;t.forEach(function(e){return i[s++]=e});e.content({items:i,groupings:A});this._store.setItemSet(e.key,e)};t.prototype._getCurrentItemSetKey=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=e.demandItemFacet(m.currentItemFacet,t),r=n&&n.itemKey;return a.getItemSetKey(e,{itemKey:r})};t.prototype.createKoItemKey=function(e,t){var n,r="root",i="",s="";"folder"===t&&(r=e);"tag"===t&&(i=e);"place"===t&&(s=e);return T.getKey(((n={}).id=r,n.qt="allmyphotos",n.tagFilter=i,n.locationFilter=s,n.onThisDay=!1,n))};t.dependencies=n.__assign(n.__assign({},i.default.dependencies),{itemsStore:o.resourceKey,itemProvider:u.resourceKey,itemCacheObservablesFactory:l.resourceKey,itemsScopeManager:h.resourceKey});return t})(i.default);t.default=_;t.resourceKey=r.createResolvedResourceKey(e("module").id,_)});
define("odsp-next/dataSources/item/od/ItemCacheToKOUtils",["require","exports","tslib","../../photo/odc/GetOneDriveItemWithSupportedCommands","../../../models/itemsScope/facets/OneDriveItemFacet","../../../dataSources/url/QueryType","../../../models/item/ItemType","@ms/items-view/lib/private/facets/MediaFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-photos/lib/models/facets/PhotoLocationFacet","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","@ms/items-view-addon-graph/lib/models/facets/GraphThumbnailSetFacet","../../../utilities/features/Features","../../../dataSources/item/odc/SkyApiCommands"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.demandResolvedAllPhotoRecord=function(e,t){var d,v=function(n){return e.demandItemFacet(n,t,{suppressGetItems:!0})},m=v(i.oneDriveItemFacet);if(m){var g,y=r.getOneDriveItemWithSupportedCommands(m),b=void 0,w=void 0;g=v(u.dimensionsFacet);var E=v(u.livePhotoFacet);E&&(null===(d=y.properties)||void 0===d?void 0:d.commandsSupported)&&delete y.properties.commandsSupported[p.rotate];var S=v(u.photoFacet);if(S){(b=n.__assign({height:g?g.height:0,width:g?g.width:0},E?{isLivePhoto:!0}:{})).cameraMake=v(u.cameraMakeFacet);b.cameraModel=v(u.cameraModelFacet);b.focalLength=v(u.cameraFocalLengthFacet);b.focalRatio=v(u.cameraFNumberFacet);b.iso=v(u.cameraIsoFacet);var x=v(u.cameraExposureFacet);if(x){b.exposureDenominator=x.denominator;b.exposureNumerator=x.numerator}}var T=v(u.videoFacet);if(T){w={height:g?g.height:0,width:g?g.width:0};var N=v(u.videoAudioFacet);if(N){w.audioBitsPerSample=N.bitsPerSample;w.audioSamplesPerSecond=N.samplesPerSecond;w.audioChannels=N.channels;w.audioFormat=N.format}w.bitrate=v(u.bitRateFacet);w.duration=v(u.durationFacet);w.frameRate=v(u.frameRateFacet);w.fourCC=v(u.fourCCFacet)}h.isFeatureEnabled(h.EnableLivePhotoVideos)&&E&&(w=n.__assign({height:b?b.height:0,width:b?b.width:0,fourCC:"H264"},w));S||T||(b={height:g?g.height:0,width:g?g.width:0});var C=void 0,k=v(c.graphThumbnailSetFacet);if(k){var L=void 0;if(L=Array.isArray(k)?k[0]:k){C={url:(function(e){var t="",n=e.lastIndexOf("width="),r=e.lastIndexOf("cropmode="),i=e.indexOf("&",r);i=i>0?i:e.length;t+=e.slice(0,n);t+="width={0}&height={1}&cropmode=center";return t+=e.slice(i)})(L.large.url),height:g?g.height:L.large.height,width:g?g.width:L.large.width}}}var A,O=v(a.fileNameFacet);A=O?O.extension:void 0;var M=void 0,_=v(a.parentFolderItemFacet);if(_&&_.itemKey&&l.driveItemKeyFacet.matches(_.itemKey)){M=l.driveItemKeyFacet.deserialize(_.itemKey).driveId}var D=void 0,P=v(f.photoLocationFacet);P&&(D=n.__assign({},P));var H=void 0,B=v(u.dateTakenFacet),j=void 0,F=v(a.dateModifiedFacet);B&&(H=new Date(B));F&&(j=new Date(F));return n.__assign(n.__assign({},y),{queryType:s.default.AllMyPhotos,thumbnail:C,extension:A,ownerId:M,photo:b,type:o.default.Media,geoLocation:D,video:w,sharingRole:0,dateTakenTime:H||y.dateTakenTime,dateModifiedTime:j||y.dateModifiedTime})}}});
define("@ms/items-view-addon-photos/lib/util/neighboringPageResolver",["require","exports","../models/facets/PhotoToGroupFacet","@ms/items-view/lib/private/facets/SetFacets","../models/facets/PreviousItemFacet","../models/facets/NextItemFacet","../models/keys/GroupPageKeyFacet","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../models/keys/PhotoToGroupKeyFacet","../models/keys/PhotosRootItemSetKeyFacet"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveNeighboringPages=function(e,t,l,c){var h;if(u.driveItemKeyFacet.matches(l)&&f.photosRootItemSetKeyFacet.matches(t)){var p=u.driveItemKeyFacet.deserialize(l),d=f.photosRootItemSetKeyFacet.deserialize(t);h=a.photoToGroupKeyFacet.serialize({driveItemKeyPart:p,photosRootItemSetKeyPart:d})}var v=e.demandItemFacet(n.photoToGroupFacet,h);if(v){var m=v.itemKey,g=c||1,y=e.demandItemFacet(r.childItemsFacet,m),b=y?y.itemKeys.length:0;if(y&&b>0){for(var w=-1,E=0;E<b&&w<0;E++)y.itemKeys[E]===l&&(w=E);if(w>=0){if(0===w||w-g<0){var S=e.demandItemFacet(i.previousItemFacet,m);if(S){var x=e.demandItemFacet(r.childItemsFacet,S.itemKey);if(x)for(var T=x.itemKeys.length,N=1;N<g;N++){var C=x.itemKeys[T-N];o.groupPageKeyFacet.matches(C)&&!e.isItemFacetResolved(r.childItemsFacet,C)&&e.demandItemFacet(r.childItemsFacet,C)}}}if(w===b-1||w+g>=b){var k=e.demandItemFacet(s.nextItemFacet,m);if(k){var L=e.demandItemFacet(r.childItemsFacet,k.itemKey);if(L)for(N=0;N<g-1;N++){var A=L.itemKeys[N];o.groupPageKeyFacet.matches(A)&&!e.isItemFacetResolved(r.childItemsFacet,A)&&e.demandItemFacet(r.childItemsFacet,A)}}}for(N=1;N<g;N++){var O=y.itemKeys[w+N];o.groupPageKeyFacet.matches(O)&&!e.isItemFacetResolved(r.childItemsFacet,O)&&e.demandItemFacet(r.childItemsFacet,O)}for(N=1;N<g;N++){var M=y.itemKeys[w-N];o.groupPageKeyFacet.matches(M)&&!e.isItemFacetResolved(r.childItemsFacet,M)&&e.demandItemFacet(r.childItemsFacet,M)}}}}}});
define("odsp-next/controls/itemsScope/odc/DefaultClickActionControlHandler",["require","exports","react","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/components/actions/defaultClick/handlers/open","../DefaultClickActionHandler","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/models/itemsScope/getItemsScope","../../../models/itemsScope/facets/CurrentItemsScopeFacets","../../../models/itemsScope/facets/KnockoutStoreIdentityFacet","../../../dataSources/url/odc/UrlRouting","../../../dataSources/url/PageType","@ms/items-view-addon-graph/lib/models/facets/VaultFacet","../../../actions/itemsScope/OpenAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d={resources:r.resourceScopeKey};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:d,create:function(e){var t=e.resources,r={key:new o.Facet("vaultActionHandler").id,evaluate:function(e,r){var i=r.itemKey,s=u.getItemsScope(e).itemsScopeItemKey,o=e.demandItemFacet(a.currentViewParamsFacet,s),d=o&&l.getPageType(o)||c.default.Files,v=d===c.default.FilePicker||d===c.default.FolderPicker,m=e.demandItemFacet(h.vaultFacet,i);return{action:e.demandItemFacet(f.knockoutStoreNavigationIdentityFacet,i)&&m&&(m.isLocked||v)?n.createElement(p.OpenAction,{itemKey:r.itemKey,resources:t}):void 0}}};return{instance:function(e,t){var n=t.handlers;if(n){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===i.openDefaultClickActionHandler.key){o.push(r);o.push(f);o.push(s.defaultClickActionHandler)}else o.push(f)}return{handlers:o}}return{}}}}}})});
define("odsp-next/controls/itemsScope/DefaultClickActionHandler",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../models/itemsScope/facets/KnockoutStoreIdentityFacet"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=s.createDeferredOnExecuteAction(function(){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/itemsScope/DefaultClickAction"],t,n)})];case 1:return[2,t.sent().DefaultClickAction]}})})},function(){return!0});t.defaultClickActionHandler={key:new i.Facet("defaultClickHandler").id,evaluate:function(e,t){return{action:e.demandItemFacet(o.knockoutStoreNavigationIdentityFacet,t.itemKey)?r.createElement(u,{itemKey:t.itemKey}):void 0}}}});
define("odsp-next/actions/itemsScope/OpenAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","../../providers/bundleLoader/PageLoadMonitor"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.state={DeferredClickHandler:void 0};n._resources=e.resources;return n}o.prototype.render=function(){var e=this.state.DeferredClickHandler;return e?r.createElement(e,{itemKey:this.props.itemKey}):r.createElement(i.ActionBase,{isAvailable:!0,isToggled:!1})};o.prototype.componentDidMount=function(){this._loadDeferredClickhandler()};o.prototype._loadDeferredClickhandler=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._resources.consume(s.resourceKey).waitForPLT()];case 1:n.sent();return[4,new Promise(function(t,n){e(["./DefaultClickAction"],t,n)})];case 2:t=n.sent().DefaultClickAction;this.setState({DeferredClickHandler:t});return[2]}})})};return o})(r.Component);t.OpenAction=o});
define("odsp-next/controls/itemsScope/odc/LaunchMoveCopyPanelActionControlHandler",["require","exports","@ms/items-view/lib/private/models/itemsScope/getItemsScope","../../../models/itemsScope/facets/CurrentItemsScopeFacets","../../../dataSources/url/odc/UrlRouting"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.launchMoveCopyPanelActionControlHandler=function(e,t){var s=t.isMove,o=n.getItemsScope(e).itemsScopeItemKey,u=e.demandItemFacet(r.currentViewParamsFacet,o);return!s&&u&&i.getAuthKeyParamValue(u)?{isAvailable:!1}:{isAvailable:!0}}});
define("odsp-next/dataSources/itemInvalidator/odc/ItemInvalidator",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../models/itemCache/ItemCacheStore","@ms/items-view/lib/private/models/items/getItemSetKey","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/operations/invalidateItems","../../../models/itemsScope/ItemsScopeCurrentItemKey.key","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../../url/odc/UrlRouting","../../url/odc/UrlHelpers"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(){function e(e,t){void 0===e&&(e={});var n=t.itemCacheStore;this._itemCacheStore=n;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey}e.prototype.invalidateItemSet=function(e){var t;this._itemCacheStore.dispatch(u.invalidateItems({items:(t={},t[e]=[f.childItemsFacet],t)}))};e.prototype.invalidateCurrentItemSet=function(){var e=this._itemsScopeCurrentItemKey.peek(),t=this._itemCacheStore.dispatch(o.readItems(function(t){return i.getItemSetKey(t,{itemKey:e})}));t&&this.invalidateItemSet(t)};e.prototype.invalidateItems=function(e){var t=this._getItemKeyFromKOKey(e);this._invalidateFolderItems(t)};e.prototype.refreshItemsInCurrentItemSet=function(e){};e.prototype.invalidateGroups=function(e){};e.prototype.invalidateCurrentFolderItems=function(){var e=this._itemsScopeCurrentItemKey.peek(),t=this._itemCacheStore.dispatch(o.readItems(function(t){return t.demandItemFacet(s.parentItemFacet,e)}));t&&t.itemKey&&this._invalidateFolderItems(t.itemKey)};e.prototype._invalidateFolderItems=function(e){var t;this._itemCacheStore.dispatch(u.invalidateItems({items:(t={},t[e]=[s.defaultChildItemSetFacet],t)}))};e.prototype._getItemKeyFromKOKey=function(e){var t=c.getKeyParams(e),n=t.id,r=t.cid,i=h.getVroomBaseUrl();return l.driveItemKeyFacet.serialize({endpoint:i,driveId:r,itemId:n})};e.dependencies={itemCacheStore:r.resourceKey,itemsScopeCurrentItemKey:a.resourceKey};return e})();t.ItemInvalidator=p;t.resourceKey=n.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/dataSources/item/itemsScope/KnockoutStoreGetItemsOperationHandler",["require","exports","tslib","../../../models/itemsScope/facets/KnockoutStoreItemFacet","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/store/actions/implementOperation","../ItemTaskObserver","../../../resources/DataSourceResourceKeys","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/operations/readItems","../../../models/itemsScope/facets/KnockoutStoreIdentityFacet","../../../models/itemsScope/facets/OneDriveItemFacet","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/ErrorFacets","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{urlDataSource:a.url,itemTaskObserverType:u.resourceKey},create:function(e){var t=e.urlDataSource,i=e.itemTaskObserverType;return{instance:s.createSingleItemOperationHandler({maxParallelOperationCount:30,mergeForSameItemKey:!0})(function(e){var s=this,a=r.odspNextStoreKeyFacet.deserialize(e.itemKey).itemKey;return function(y){return n.__awaiter(s,void 0,void 0,function(){var s,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:if(!(s=y(c.readItems(function(e){return e.demandItemFacet(h.knockoutStoreIdentityFacet,a)}))))return[3,5];b=s.key;w=t.getKeyParams(b);E=t.getQueryType(w);(S=new i).update([new u.Task(b).succeed({item:{key:b,queryType:E}})]);M.label=1;case 1:M.trys.push([1,3,,4]);return[4,y(l.demandItems(function(e){return e.demandItemFacet(p.oneDriveItemFacet,a)}))];case 2:x=M.sent();S.update([new u.Task(b).succeed({item:x})]);return[3,4];case 3:T=M.sent();N=0;C="";k="";T instanceof Error&&(k=T.message);T instanceof g.ApiError&&(C=T.code);T instanceof o.ItemOperationError&&(m.itemNotFoundErrorFacet.unpack(T.facets)||m.accessDeniedErrorFacet.unpack(T.facets)?N=2:m.authFailureErrorFacet.unpack(T.facets)&&(N=1));S.update([new u.Task(b).succeed({item:{error:{type:N,data:{errorCode:C,errorTitle:k}}}})]);return[3,4];case 4:S.flush();M.label=5;case 5:(L=new f.ItemResolver).resolveItems({items:n.__assign(n.__assign({},a?(A={},A[a]=n.__assign({},d.getInvalidationFacet().forFacet(v.displayNameFacet).thenInvalidate(e.itemKey,r.createdStoreItemFacet).pack()),A):{}),(O={},O[e.itemKey]=n.__assign({},r.createdStoreItemFacet.pack(void 0)),O))});y(L.execute());return[2]}})})}})}}}})});
define("odsp-next/utilities/albums/itemsScope/AlbumsInvalidator",["require","exports","tslib","../../../models/itemsScope/ItemsScopeManager.key","../../../models/itemCache/ItemCacheStore","../../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view-addon-photos/lib/models/keys/AlbumSetKeyFacet","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../../dataSources/url/odc/UrlHelpers"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemCacheStore=n.itemCacheStore;r._itemsScopeManager=n.itemsScopeManager;return r}t.prototype.invalidate=function(){var e,t=this._itemsScopeManager.itemsScopeItemKey,n=this._itemCacheStore.dispatch(o.readItems(function(e){var n=e.demandItemFacet(s.currentViewParamsFacet,t);return f.albumSetKeyFacet.serialize({albumsRootKeyPart:{driveId:n&&n.cid||"",endpoint:h.getVroomBaseUrl()},groupType:"all"})}));this._itemCacheStore.dispatch(a.invalidateItems({items:(e={},e[n]=[u.childItemsFacet],e)}))};t.dependencies=n.__assign(n.__assign({},l.default.dependencies),{itemsScopeManager:r.resourceKey,itemCacheStore:i.resourceKey});return t})(l.default);t.default=p;t.resourceKey=c.createResolvedResourceKey(e("module").id,p)});
define('ODCItemsScopeDeferred_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".confirmTextLabel_932a0943{font-weight:400}\n"},{"rawString":".root_738e2004{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.root_738e2004,.root_738e2004.isSmall_738e2004{width:72px;height:52px}.root_738e2004.isLarge_738e2004{width:112px;height:80px}.front_738e2004{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.back_738e2004{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.content_738e2004{position:absolute;left:4px;right:4px;bottom:4px;top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.hideContent_738e2004 .content_738e2004{opacity:0}.isFluent_738e2004 .content_738e2004{top:12px}.frame_738e2004{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;max-width:100%;max-height:100%;-webkit-box-shadow:0 1px 3px 2px rgba(1,1,0,.06);box-shadow:0 1px 3px 2px rgba(1,1,0,.06);background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";min-width:32px;min-height:32px}.metadata_738e2004{display:block;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:400;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:relative}html[dir=ltr] .metadata_738e2004{margin-right:8px}html[dir=rtl] .metadata_738e2004{margin-left:8px}html[dir=ltr] .metadata_738e2004{text-align:right}html[dir=rtl] .metadata_738e2004{text-align:left}.isFluent_738e2004 .metadata_738e2004{color:#bf5712}html[dir=ltr] .isFluent_738e2004 .metadata_738e2004{text-align:left}html[dir=rtl] .isFluent_738e2004 .metadata_738e2004{text-align:right}.metadata_738e2004,.metadata_738e2004.isSmall_738e2004{font-size:12px;margin-bottom:1px}html[dir=ltr] .metadata_738e2004,html[dir=ltr] .metadata_738e2004.isSmall_738e2004{margin-left:4px}html[dir=rtl] .metadata_738e2004,html[dir=rtl] .metadata_738e2004.isSmall_738e2004{margin-right:4px}.isLarge_738e2004 .metadata_738e2004{font-size:14px;margin-bottom:4px}html[dir=ltr] .isLarge_738e2004 .metadata_738e2004{margin-left:8px}html[dir=rtl] .isLarge_738e2004 .metadata_738e2004{margin-right:8px}.signal_738e2004{display:block;position:relative;margin-bottom:8px}html[dir=ltr] .signal_738e2004{margin-left:8px}html[dir=rtl] .signal_738e2004{margin-right:8px}html[dir=ltr] .signal_738e2004{margin-right:4px}html[dir=rtl] .signal_738e2004{margin-left:4px}.isFluent_738e2004 .signal_738e2004 :first-child{color:#bf5712}.signal_738e2004,.signal_738e2004.isSmall_738e2004{font-size:16px;margin-bottom:1px}.isLarge_738e2004 .signal_738e2004{font-size:16px;margin-bottom:4px}html[dir=ltr] .isLarge_738e2004 .signal_738e2004{margin-right:7px}html[dir=rtl] .isLarge_738e2004 .signal_738e2004{margin-left:7px}"},{"rawString":".tile_dbcfafb0.hideFileTypeIcon_dbcfafb0 .fileTypeIcon_dbcfafb0,.tile_dbcfafb0.hideFileTypeIcon_dbcfafb0 .tileAppIcon_dbcfafb0{display:none}.tile_dbcfafb0.hideThumbnail_dbcfafb0 .thumbnail_dbcfafb0{display:none}.defaultTile_dbcfafb0 .ms-Tile-foreground>*{pointer-events:none}.defaultTile_dbcfafb0 .ms-Tile-background>*{pointer-events:none}.folderCover_dbcfafb0{margin:3px}.thumbnail_dbcfafb0{display:inline-block}.thumbnailNotResolved_dbcfafb0{display:none}.fileTypeIcon_dbcfafb0{margin:16px}.name_dbcfafb0{display:inline;max-width:100%}.blankFolderCover_dbcfafb0{background:"},{"theme":"itemTileBlankFolderCoverColor","defaultValue":"#fff"},{"rawString":";display:inline-block}.tileAppIcon_dbcfafb0{position:absolute;bottom:0;margin:4px}[dir='ltr'] .tileAppIcon_dbcfafb0{left:0px}[dir='rtl'] .tileAppIcon_dbcfafb0{right:0px}\n"},{"rawString":".image_3c2f3354{display:block}\n"},{"rawString":".root_6ee83368{display:block}\n"},{"rawString":".tile_93bac6ae{display:block;position:relative;padding-bottom:8px}[dir='ltr'] .tile_93bac6ae{padding-right:40px}[dir='rtl'] .tile_93bac6ae{padding-left:40px}.tile_93bac6ae.hasIcon_93bac6ae{min-height:60px}[dir='ltr'] .tile_93bac6ae.hasIcon_93bac6ae{padding-left:56px}[dir='rtl'] .tile_93bac6ae.hasIcon_93bac6ae{padding-right:56px}.title_93bac6ae{display:inline;white-space:pre-line}.icon_93bac6ae{position:absolute;width:48px;display:block}[dir='ltr'] .icon_93bac6ae{left:0}[dir='rtl'] .icon_93bac6ae{right:0}.icon_93bac6ae.hasProgress_93bac6ae{top:8px}.progress_93bac6ae{display:block}.error_93bac6ae .progress_93bac6ae .ms-ProgressIndicator-itemProgress{display:none}.description_93bac6ae{font-size:12px}.error_93bac6ae .description_93bac6ae{color:#a80000}.actions_93bac6ae{display:block;margin:8px 0 20px 0}.cancel_93bac6ae{position:absolute;display:block;top:0;width:32px;font-size:14px}[dir='ltr'] .cancel_93bac6ae{right:0}[dir='rtl'] .cancel_93bac6ae{left:0}\n"},{"rawString":".commandButton_f5a298fe{font-size:14px}\n"},{"rawString":".root_b735bfac{overflow-x:hidden}.group_b735bfac{margin:14px 0}.item_b735bfac{margin:0}\n"},{"rawString":".newDocumentCommandIcon_d510269e{height:16px;width:16px}.newDocumentCommandIcon_d510269e img{line-height:normal;display:block}#obf-TPromptContainer:focus{outline:1px solid #605e5c}#obf-TFormRating{color:#333333}#obf-TFormComment{background-color:#fff}\n"},{"rawString":".input_b5c7e836{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".callout_3562201b{min-width:315px}[dir='ltr'] .callout_3562201b{padding-left:12px}[dir='rtl'] .callout_3562201b{padding-right:12px}[dir='ltr'] .callout_3562201b{padding-right:4px}[dir='rtl'] .callout_3562201b{padding-left:4px}.progressList_3562201b{display:block}.viewAllButton_3562201b{display:block}.accessibleStatus_3562201b{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".nameDialogContent_74c88a19{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nameDialogContent_74c88a19 .ms-TextField{width:100%}.nameDialogContent_74c88a19 .ms-TextField .ms-TextField-errorMessage{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}.nameDialogContentFileExtension_74c88a19{padding:10px 5px 0;-ms-flex-item-align:start;align-self:flex-start}.nameDialogSpinner_74c88a19{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"},{"rawString":".created_f68838c6{-webkit-animation:spin_f68838c6 1100ms infinite linear;animation:spin_f68838c6 1100ms infinite linear}@-webkit-keyframes spin_f68838c6{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin_f68838c6{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.closeButton_f68838c6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.accessibleStatus_f68838c6{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"},{"rawString":".isFluent .od-TopBar-commandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot{position:relative;border-bottom:2px solid transparent;color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot .ms-Button-label:after{transition:all .1s ease-in-out}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:active{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover .ms-Button-label:after{width:100%;left:0}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label{font-weight:600}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label:after{content:'';display:block;position:absolute;left:8px;border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";bottom:-2px;width:calc(100% - (8px + 8px))}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:active,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{border-bottom:2px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{font-weight:600}[dir=ltr] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-left:24px}.od-TopBar-commandBar .ms-CommandBar button.is-toggled{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";color:"},{"theme":"black","defaultValue":"#000000"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";background-color:inherit;transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled:hover{background-color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:active{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":";background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}"},{"rawString":".IFrameDialog_c468f1cb .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_c468f1cb iframe{border:none;width:100%}\n"},{"rawString":".msDragStart_21749ec5{background-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.msDragStart_21749ec5 .msDragSourceWrapperLinkDragIcon_21749ec5{opacity:1}.msDragIcon_21749ec5{opacity:0;position:absolute;top:0px;color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":";z-index:1;padding-top:8px;margin-left:0px}.msDragSrouceContainer_21749ec5{padding-left:16px}.isVisible_21749ec5{opacity:1}.msRoot_21749ec5{-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);cursor:pointer}.msRoot_21749ec5:focus,.msRoot_21749ec5:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.msRoot_21749ec5:focus i[data-icon-name=\"GripperBarVertical\"],.msRoot_21749ec5:hover i[data-icon-name=\"GripperBarVertical\"]{opacity:1}.dragLayerRoot_21749ec5{position:absolute;pointer-events:none;z-index:100;left:0;top:0}\n"},{"rawString":".dragPreviewRoot_c818975e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);pointer-events:none}.dragPreviewIcon_c818975e{margin:5px;height:20px;width:20px}[dir='ltr'] .dragPreviewText_c818975e{margin-right:5px}[dir='rtl'] .dragPreviewText_c818975e{margin-left:5px}\n"}]);return {ConfirmationDialog_2:{confirmTextLabel:'confirmTextLabel_932a0943'},ItemTile_8:{tile:'tile_dbcfafb0',hideFileTypeIcon:'hideFileTypeIcon_dbcfafb0',fileTypeIcon:'fileTypeIcon_dbcfafb0',tileAppIcon:'tileAppIcon_dbcfafb0',hideThumbnail:'hideThumbnail_dbcfafb0',thumbnail:'thumbnail_dbcfafb0',defaultTile:'defaultTile_dbcfafb0',folderCover:'folderCover_dbcfafb0',thumbnailNotResolved:'thumbnailNotResolved_dbcfafb0',name:'name_dbcfafb0',blankFolderCover:'blankFolderCover_dbcfafb0'},FolderCover_5:{root:'root_738e2004',isSmall:'isSmall_738e2004',isLarge:'isLarge_738e2004',front:'front_738e2004',back:'back_738e2004',content:'content_738e2004',hideContent:'hideContent_738e2004',isFluent:'isFluent_738e2004',frame:'frame_738e2004',metadata:'metadata_738e2004',signal:'signal_738e2004'},Signal_4:{signal:'signal_3bddfae0',dark:'dark_3bddfae0',selected:'selected_3bddfae0'},ItemThumbnail_6:{image:'image_3c2f3354'},ItemSetTilesList_2:{root:'root_6ee83368'},ProgressList_3:{root:'root_b735bfac',group:'group_b735bfac',item:'item_b735bfac'},ProgressItemTile_3:{tile:'tile_93bac6ae',hasIcon:'hasIcon_93bac6ae',title:'title_93bac6ae',icon:'icon_93bac6ae',hasProgress:'hasProgress_93bac6ae',progress:'progress_93bac6ae',error:'error_93bac6ae',description:'description_93bac6ae',actions:'actions_93bac6ae',cancel:'cancel_93bac6ae'},CommandButton_8:{commandButton:'commandButton_f5a298fe'},Commands_0:{newDocumentCommandIcon:'newDocumentCommandIcon_d510269e'},FileSystemDialog_6:{input:'input_b5c7e836'},ProgressCallout_7:{callout:'callout_3562201b',progressList:'progressList_3562201b',viewAllButton:'viewAllButton_3562201b',accessibleStatus:'accessibleStatus_3562201b'},NameDialog_8:{nameDialogContent:'nameDialogContent_74c88a19',nameDialogContentFileExtension:'nameDialogContentFileExtension_74c88a19',nameDialogSpinner:'nameDialogSpinner_74c88a19'},ProgressCommandButton_7:{created:'created_f68838c6',spin:'spin_f68838c6',closeButton:'closeButton_f68838c6',accessibleStatus:'accessibleStatus_f68838c6'},IFrameDialog_9:{IFrameDialog:'IFrameDialog_c468f1cb'},DragSourceWrapper_8:{msDragStart:'msDragStart_21749ec5',msDragSourceWrapperLinkDragIcon:'msDragSourceWrapperLinkDragIcon_21749ec5',msDragIcon:'msDragIcon_21749ec5',msDragSrouceContainer:'msDragSrouceContainer_21749ec5',isVisible:'isVisible_21749ec5',msRoot:'msRoot_21749ec5',dragLayerRoot:'dragLayerRoot_21749ec5'},DragLayerPreview_5:{dragPreviewRoot:'dragPreviewRoot_c818975e',dragPreviewIcon:'dragPreviewIcon_c818975e',dragPreviewText:'dragPreviewText_c818975e'}}});